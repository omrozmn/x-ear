openapi: 3.0.3
info:
  title: X-Ear CRM API (auto-generated)
  version: 0.0.0-auto
  description: X-Ear CRM API for managing patients, devices, appointments, sales,
    and more
  contact:
    name: X-Ear Web App Support
    email: support@x-ear.com
    url: https://x-ear.com/support
servers:
- url: http://localhost:5003
tags:
- name: Appointments
  description: Appointment management operations
- name: Auth
  description: Authentication and password management operations
- name: Automation
  description: Automation and workflow operations
- name: Campaigns
  description: Marketing campaign operations
- name: Communications
  description: Communication templates and messaging operations
- name: Config
  description: Configuration management
- name: Dashboard
  description: Dashboard and analytics operations
- name: Devices
  description: Device management operations
- name: Health
  description: Health check operations
- name: Inventory
  description: Inventory management operations
- name: Invoices
  description: Invoice management operations
- name: Notifications
  description: Notification operations
- name: Ocr
  description: OCR and document processing operations
- name: Patients
  description: Patient management operations
- name: Payments
  description: Payment record management operations
- name: Timeline
  description: Patient timeline operations
- name: Products
  description: Product management operations
- name: Promissory-notes
  description: Promissory note management operations
- name: Reports
  description: Reporting operations
- name: Roles
  description: Role and permission management operations
- name: Sales
  description: Sales management operations
- name: Settings
  description: Application settings operations
- name: Sgk
  description: SGK (Social Security) operations
- name: Sms
  description: SMS operations
- name: Suppliers
  description: Supplier management operations
- name: Subscriptions
  description: Subscription and plan management operations
- name: Entities
  description: Entity extraction operations
- name: Extract_patient
  description: Patient extraction from documents
- name: Init-db
  description: Database initialization operations
- name: Initialize
  description: Service initialization operations
- name: Process
  description: Document processing operations
- name: Similarity
  description: Document similarity operations
- name: Swagger.html
  description: Swagger UI operations
- name: Register-phone
  description: Phone registration operations
- name: Verify-registration-otp
  description: Registration OTP verification operations
- name: Users
  description: User management operations
- name: Pricing-preview
  description: Pricing preview operations
- name: Product-suppliers
  description: Product supplier relationship operations
- name: Openapi.yaml
  description: OpenAPI specification serving operations
paths:
  /api/appointments:
    get:
      summary: Get list of appointments
      operationId: appointments_get_appointments
      tags:
      - Appointments
      parameters:
      - name: page
        in: query
        required: false
        schema:
          type: integer
          default: 1
        description: Page number for pagination
      - name: per_page
        in: query
        required: false
        schema:
          type: integer
          default: 20
          minimum: 1
          maximum: 200
        description: Number of items per page (max 200)
      - name: patient_id
        in: query
        required: false
        schema:
          type: string
        description: Filter by patient ID
      - name: date_from
        in: query
        required: false
        schema:
          type: string
          format: date
        description: Filter appointments from this date
      - name: date_to
        in: query
        required: false
        schema:
          type: string
          format: date
        description: Filter appointments to this date
      - name: status
        in: query
        required: false
        schema:
          type: string
          enum:
          - SCHEDULED
          - CONFIRMED
          - IN_PROGRESS
          - COMPLETED
          - CANCELLED
          - NO_SHOW
          - RESCHEDULED
        description: Filter by appointment status
      - name: branch_id
        in: query
        required: false
        schema:
          type: string
        description: Filter by branch ID
      responses:
        '200':
          description: Success
    post:
      summary: Create a new appointment
      operationId: appointments_create_appointment
      tags:
      - Appointments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                patient_id:
                  type: string
                  description: Patient ID
                date:
                  type: string
                  format: date
                  description: Appointment date
                time:
                  type: string
                  format: time
                  description: Appointment time
                duration:
                  type: integer
                  description: Duration in minutes
                  default: 30
                type:
                  type: string
                  description: Appointment type
                notes:
                  type: string
                  description: Additional notes
              required:
              - patient_id
              - date
              - time
      responses:
        '201':
          description: Appointment created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Appointment'
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/communications/messages:
    get:
      summary: Get list of communication messages (SMS and Email)
      operationId: communications_list_messages
      tags:
      - Communications
      parameters:
      - name: page
        in: query
        required: false
        schema:
          type: integer
          default: 1
        description: Page number for pagination
      - name: per_page
        in: query
        required: false
        schema:
          type: integer
          default: 20
          maximum: 100
        description: Number of items per page (max 100)
      - name: type
        in: query
        required: false
        schema:
          type: string
          enum:
          - sms
          - email
        description: Filter by message type
      - name: status
        in: query
        required: false
        schema:
          type: string
        description: Filter by message status
      - name: patient_id
        in: query
        required: false
        schema:
          type: string
        description: Filter by patient ID
      - name: campaign_id
        in: query
        required: false
        schema:
          type: string
        description: Filter by campaign ID
      - name: date_from
        in: query
        required: false
        schema:
          type: string
          format: date-time
        description: Filter messages from this date
      - name: date_to
        in: query
        required: false
        schema:
          type: string
          format: date-time
        description: Filter messages to this date
      - name: search
        in: query
        required: false
        schema:
          type: string
        description: Search in message content, phone number, or email
      responses:
        '200':
          description: List of communication messages
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CommunicationMessage'
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      page:
                        type: integer
                      perPage:
                        type: integer
                      totalPages:
                        type: integer
                  timestamp:
                    type: string
                    format: date-time
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/communications/templates:
    get:
      summary: List Communication Templates
      operationId: communications_list_templates
      tags:
      - Communications
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      - name: type
        in: query
        schema:
          type: string
      - name: category
        in: query
        schema:
          type: string
      - name: is_active
        in: query
        schema:
          type: string
      - name: search
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CommunicationTemplate'
                  meta:
                    type: object
    post:
      summary: Create Communication Template
      operationId: communications_create_template
      tags:
      - Communications
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommunicationTemplateCreateBody'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommunicationTemplate'
  /api/communications/templates/{template_id}:
    get:
      summary: Get Communication Template
      operationId: communications_get_template
      tags:
      - Communications
      parameters:
      - name: template_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommunicationTemplate'
    put:
      summary: Update Communication Template
      operationId: communications_update_template
      tags:
      - Communications
      parameters:
      - name: template_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommunicationTemplateCreateBody'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommunicationTemplate'
    delete:
      summary: Delete Communication Template
      operationId: communications_delete_template
      tags:
      - Communications
      parameters:
      - name: template_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/communications/stats:
    get:
      summary: Get communication analytics and statistics
      operationId: communications_get_stats
      tags:
      - Communications
      responses:
        '200':
          description: Communication statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      stats:
                        type: object
                        description: Overall statistics (sent, delivered, failed,
                          etc.)
                      timeSeries:
                        type: array
                        items:
                          type: object
                          properties:
                            date:
                              type: string
                              format: date
                            sms:
                              type: integer
                            email:
                              type: integer
                      channels:
                        type: array
                        items:
                          type: object
                          properties:
                            channel:
                              type: string
                            count:
                              type: integer
                      templates:
                        type: array
                        items:
                          type: object
                          description: Template usage statistics
                      campaigns:
                        type: array
                        items:
                          type: object
                          description: Campaign performance data
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/appointments/{appointment_id}:
    delete:
      summary: DELETE /api/appointments/{appointment_id}
      operationId: appointments_delete_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
      description: Delete an existing appointment by its unique identifier
  /api/appointments/{appointment_id}/cancel:
    post:
      summary: POST /api/appointments/{appointment_id}/cancel
      operationId: appointments_cancel_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Cancel an appointment and optionally provide cancellation reason
  /api/appointments/{appointment_id}/complete:
    post:
      summary: POST /api/appointments/{appointment_id}/complete
      operationId: appointments_complete_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Mark an appointment as completed and add completion notes
  /api/appointments/{appointment_id}/reschedule:
    post:
      summary: POST /api/appointments/{appointment_id}/reschedule
      operationId: appointments_reschedule_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Reschedule an existing appointment to a new date and time
  /api/appointments/availability:
    get:
      summary: GET /api/appointments/availability
      operationId: appointments_get_availability
      tags:
      - Appointments
      responses:
        '200':
          description: Success
      description: Get available appointment slots for scheduling
  /api/appointments/list:
    get:
      summary: GET /api/appointments/list
      operationId: appointments_list_appointments
      tags:
      - Appointments
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Appointment'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
      description: Retrieve a list of appointments with optional filtering
  /api/automation/backup:
    post:
      summary: Trigger system backup
      operationId: automation_trigger_backup
      tags:
      - Automation
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Trigger automated system backup process
  /api/automation/logs:
    get:
      summary: Get automation logs
      operationId: automation_get_automation_logs
      tags:
      - Automation
      responses:
        '200':
          description: Success
      description: Retrieve logs from automated processes and tasks
  /api/automation/sgk/process:
    post:
      summary: Trigger SGK document processing
      operationId: automation_trigger_sgk_processing
      tags:
      - Automation
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Trigger automated SGK document processing workflow
  /api/automation/status:
    get:
      summary: Get automation system status
      operationId: automation_get_automation_status
      tags:
      - Automation
      responses:
        '200':
          description: Success
      description: Retrieve status information
  /api/campaigns:
    get:
      summary: Get Campaigns
      tags:
      - Campaigns
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      - name: status
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Campaign'
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      page:
                        type: integer
                      perPage:
                        type: integer
                      totalPages:
                        type: integer
    post:
      summary: Create Campaign
      tags:
      - Campaigns
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              - messageTemplate
              properties:
                name:
                  type: string
                description:
                  type: string
                targetSegment:
                  type: string
                  enum:
                  - all
                  - filter
                  - excel
                targetCriteria:
                  type: object
                messageTemplate:
                  type: string
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Campaign'
  /api/dashboard:
    get:
      summary: Get dashboard data
      operationId: dashboard_get_dashboard_data
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalPatients:
                    type: integer
                    description: Total number of patients
                  totalDevices:
                    type: integer
                    description: Total number of devices
                  totalAppointments:
                    type: integer
                    description: Total number of appointments
                  totalSales:
                    type: number
                    format: float
                    description: Total sales amount
                  recentAppointments:
                    type: array
                    items:
                      $ref: '#/components/schemas/Appointment'
                    description: Recent appointments
                  recentSales:
                    type: array
                    items:
                      $ref: '#/components/schemas/Sale'
                    description: Recent sales
                  monthlyStats:
                    type: object
                    properties:
                      patients:
                        type: integer
                      appointments:
                        type: integer
                      sales:
                        type: number
                        format: float
                    description: Monthly statistics
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve dashboard overview data including statistics and recent
        activities
  /api/campaigns/{campaign_id}/send:
    post:
      summary: Send Campaign
      tags:
      - Campaigns
      parameters:
      - name: campaign_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                senderId:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/config/turnstile:
    get:
      summary: GET /api/config/turnstile
      operationId: registration_get_turnstile_config
      tags:
      - Config
      responses:
        '200':
          description: Success
      description: Retrieve turnstile information
  /api/dashboard/charts/patient-distribution:
    get:
      summary: Get patient distribution chart data
      operationId: dashboard_patient_distribution
      tags:
      - Dashboard
      responses:
        '200':
          description: Patient distribution data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        category:
                          type: string
                        count:
                          type: integer
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve patient distribution data for dashboard charts
  /api/dashboard/charts/patient-trends:
    get:
      summary: GET /api/dashboard/charts/patient-trends
      operationId: dashboard_patient_trends
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
      description: Retrieve patient-trends information
  /api/dashboard/charts/revenue-trends:
    get:
      summary: GET /api/dashboard/charts/revenue-trends
      operationId: dashboard_revenue_trends
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
      description: Retrieve revenue-trends information
  /api/dashboard/kpis:
    get:
      summary: GET /api/dashboard/kpis
      operationId: dashboard_get_kpis
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
      description: Retrieve kpis information
  /api/dashboard/recent-activity:
    get:
      summary: GET /api/dashboard/recent-activity
      operationId: dashboard_recent_activity
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
      description: Retrieve recent-activity information
  /api/devices:
    get:
      summary: Get list of devices
      operationId: devices_get_devices
      tags:
      - Devices
      parameters:
      - name: page
        in: query
        required: false
        schema:
          type: integer
          default: 1
        description: Page number for pagination
      - name: per_page
        in: query
        required: false
        schema:
          type: integer
          default: 20
          minimum: 1
          maximum: 200
        description: Number of items per page (max 200)
      - name: search
        in: query
        required: false
        schema:
          type: string
        description: Search term for filtering devices
      - name: brand
        in: query
        required: false
        schema:
          type: string
        description: Filter by device brand
      - name: category
        in: query
        required: false
        schema:
          type: string
        description: Filter by device category
      - name: status
        in: query
        required: false
        schema:
          type: string
          enum:
          - IN_STOCK
          - ASSIGNED
          - TRIAL
          - DEFECTIVE
          - LOST
          - RETURNED
        description: Filter by device status
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Device'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve a list of devices with optional filtering and pagination
    post:
      summary: Create a new device
      operationId: devices_create_device
      tags:
      - Devices
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Device'
      description: Register a new hearing aid device in the system
  /api/devices/{device_id}:
    delete:
      summary: Delete a device
      operationId: devices_delete_device
      tags:
      - Devices
      parameters:
      - name: device_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
      description: Remove a device from the system
  /api/devices/{device_id}/stock-update:
    post:
      summary: Update device stock levels (simplified).
      description: "This endpoint is intentionally permissive for tests \u2014 real\
        \ inventory logic\nshould live in a dedicated inventory table/service."
      operationId: devices_update_device_stock
      tags:
      - Devices
      parameters:
      - name: device_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/devices/brands:
    get:
      summary: Get available device brands
      operationId: devices_get_device_brands
      tags:
      - Devices
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: string
                    description: List of brand names
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve brands information
    post:
      summary: Create a new device brand
      operationId: devices_create_device_brand
      tags:
      - Devices
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              properties:
                name:
                  type: string
                  description: Brand name
      responses:
        '201':
          description: Brand created successfully
        '400':
          description: Invalid request data
        '409':
          description: Brand already exists
        '500':
          description: Internal server error
      description: Create a new device brand
  /api/devices/categories:
    get:
      summary: Get available device categories
      operationId: devices_get_device_categories
      tags:
      - Devices
      responses:
        '200':
          description: Success
      description: Retrieve categories information
    post:
      summary: Create a new device category
      operationId: devices_create_device_category
      tags:
      - Devices
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              properties:
                name:
                  type: string
                  description: Category name
      responses:
        '201':
          description: Category created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      name:
                        type: string
                  message:
                    type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
        '400':
          description: Bad request
        '409':
          description: Category already exists
        '500':
          description: Internal server error
      description: Create a new device category
  /api/devices/low-stock:
    get:
      summary: Get devices with low stock levels
      operationId: devices_get_low_stock_devices
      tags:
      - Devices
      responses:
        '200':
          description: Success
      description: Retrieve low-stock information
  /api/health:
    get:
      summary: Health endpoint exposing overall status and DB read/write check results.
      description: Returns 200 when read+write ok, 503 when write fails, and 500 when
        other errors occur.
      operationId: health_check
      tags:
      - Health
      responses:
        '200':
          description: Success
  /api/inventory:
    get:
      summary: Get all inventory items with optional filtering
      operationId: inventory_get_all_inventory
      tags:
      - Inventory
      parameters:
      - name: category
        in: query
        schema:
          type: string
      - name: search
        in: query
        schema:
          type: string
      - name: lowStock
        in: query
        schema:
          type: boolean
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/InventoryItem'
                      total:
                        type: integer
                      page:
                        type: integer
                      perPage:
                        type: integer
                      totalPages:
                        type: integer
  /api/inventory/{item_id}:
    get:
      summary: Get a single inventory item by ID
      operationId: inventory_get_inventory_item
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/InventoryItem'
        '404':
          description: Inventory item not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve a single inventory item by its ID
    delete:
      summary: Delete an inventory item
      operationId: inventory_delete_inventory_item
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
      description: Remove an item from inventory
    put:
      summary: Update an inventory item
      operationId: inventory_update_inventory_item
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InventoryItem'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/InventoryItem'
  /api/inventory/{item_id}/activity:
    get:
      summary: Get activity log for an inventory item
      operationId: inventory_get_inventory_activities
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
      description: Retrieve activity information
  /api/inventory/{item_id}/assign:
    post:
      summary: Assign inventory item to a patient (reduces stock)
      operationId: inventory_assign_to_patient
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new assign
  /api/inventory/{item_id}/serials:
    post:
      summary: Add serial numbers to an inventory item
      operationId: inventory_add_serial_numbers
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new serials
  /api/inventory/low-stock:
    get:
      summary: Get all items with low stock levels
      operationId: inventory_get_low_stock_items
      tags:
      - Inventory
      responses:
        '200':
          description: Success
      description: Retrieve low-stock information
  /api/inventory/stats:
    get:
      summary: Get inventory statistics
      operationId: inventory_get_inventory_stats
      tags:
      - Inventory
      responses:
        '200':
          description: Success
      description: Get inventory statistics including low stock alerts
  /api/inventory/categories:
    get:
      summary: Get all inventory categories
      operationId: inventory_get_categories
      tags:
      - Inventory
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: string
                    description: List of category names
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Get list of all available inventory categories
    post:
      summary: Create new inventory category
      operationId: inventory_create_category
      tags:
      - Inventory
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Category name to create
              required:
              - name
      responses:
        '201':
          description: Category created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      category:
                        type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Category already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Create a new inventory category
  /api/invoices:
    get:
      summary: List invoices with filters and pagination
      operationId: invoices_list
      tags:
      - Invoices
      parameters:
      - name: page
        in: query
        required: false
        schema:
          type: integer
          default: 1
      - name: limit
        in: query
        required: false
        schema:
          type: integer
          default: 50
      - name: status
        in: query
        required: false
        schema:
          type: string
          description: Comma-separated list of statuses (draft,sent,approved,rejected,cancelled)
      - name: type
        in: query
        required: false
        schema:
          type: string
          description: Comma-separated list of types (sale,purchase,return)
      - name: customerId
        in: query
        required: false
        schema:
          type: string
      - name: issueDateFrom
        in: query
        required: false
        schema:
          type: string
          format: date
      - name: issueDateTo
        in: query
        required: false
        schema:
          type: string
          format: date
      responses:
        '200':
          description: Invoices retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        invoice_number:
                          type: string
                        status:
                          type: string
                        type:
                          type: string
                        items:
                          type: array
                          items:
                            type: object
                  total:
                    type: integer
                  page:
                    type: integer
                  limit:
                    type: integer
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create a new invoice
      operationId: invoices_create_invoice
      tags:
      - Invoices
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                patientId:
                  type: string
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      description:
                        type: string
                      quantity:
                        type: integer
                      unitPrice:
                        type: number
                      total:
                        type: number
                totalAmount:
                  type: number
                taxAmount:
                  type: number
                discountAmount:
                  type: number
              required:
              - patientId
              - items
              - totalAmount
      responses:
        '201':
          description: Invoice created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoice_id:
                        type: string
                      invoice_number:
                        type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Create a new invoice for a patient
  /api/invoices/{invoice_id}:
    get:
      summary: Get invoice by ID
      operationId: invoices_get_invoice
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoice_id:
                        type: string
                      invoice_number:
                        type: string
                      patientId:
                        type: string
                      items:
                        type: array
                        items:
                          type: object
                      totalAmount:
                        type: number
                      taxAmount:
                        type: number
                      discountAmount:
                        type: number
                      created_at:
                        type: string
                        format: date-time
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Invoice not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve an invoice by its ID
    delete:
      summary: Delete invoice by ID
      operationId: invoices_delete_invoice
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      message:
                        type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Invoice not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Delete an invoice by its ID
  /api/invoices/{invoice_id}/pdf:
    get:
      summary: Generate invoice PDF
      operationId: invoices_generate_invoice_pdf
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice PDF generated successfully
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        '404':
          description: Invoice not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Generate and download a PDF for the specified invoice
  /api/invoices/{invoice_id}/issue:
    post:
      summary: "Issue invoice (finalize and prepare for G\u0130B)"
      operationId: invoices_issue
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice issued successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      message:
                        type: string
                      invoice_number:
                        type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Invoice not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: "Issue invoice (finalize draft and prepare for G\u0130B submission)"
  /api/invoices/{invoice_id}/send-to-gib:
    post:
      summary: "Send invoice to G\u0130B"
      operationId: invoices_send_to_gib
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: "Invoice sent to G\u0130B successfully"
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      message:
                        type: string
                      gib_response:
                        type: object
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Invoice not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: "Send the invoice to G\u0130B (Turkish Revenue Administration)"
  /api/notifications:
    get:
      summary: Get Notifications
      tags:
      - Notifications
      parameters:
      - name: user_id
        in: query
        required: true
        schema:
          type: string
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'
                  meta:
                    type: object
  /api/notifications/{notification_id}:
    delete:
      summary: DELETE /api/notifications/{notification_id}
      operationId: notifications_delete_notification
      tags:
      - Notifications
      parameters:
      - name: notification_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
      description: Delete a specific notification
  /api/notifications/{notification_id}/read:
    put:
      summary: Mark Notification Read
      tags:
      - Notifications
      parameters:
      - name: notification_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
  /api/notifications/stats:
    get:
      summary: Get Notification Stats
      tags:
      - Notifications
      parameters:
      - name: user_id
        in: query
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      total:
                        type: integer
                      unread:
                        type: integer
  /api/ocr/process:
    post:
      summary: POST /api/ocr/process
      operationId: sgk_process_ocr
      tags:
      - Ocr
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new process
  /api/openapi.yaml:
    get:
      summary: Serve the canonical OpenAPI contract for frontend/back-end sync and
        respond to CORS preflight.
      description: 'Returns CORS headers so the static Swagger UI served from a different
        origin (e.g. localhost:8080)

        can fetch the YAML without browser CORS errors.'
      operationId: serve_openapi_yaml
      tags:
      - Openapi.yaml
      responses:
        '200':
          description: Success
  /api/patients:
    get:
      summary: Get list of patients
      operationId: patients_get_patients
      tags:
      - Patients
      x-storage-keys:
      - key: PATIENTS_DATA
        description: Cached patient list data
        type: array
      - key: PATIENT_SEARCH_FILTERS
        description: User's search filter preferences
        type: object
      - key: PATIENT_PAGINATION_STATE
        description: Current pagination state
        type: object
      - key: PATIENT_SORT_PREFERENCES
        description: User's sorting preferences
        type: object
      - key: PATIENT_VIEW_MODE
        description: List/grid view mode preference
        type: string
      - key: PATIENT_SELECTED_COLUMNS
        description: User's column visibility preferences
        type: array
      parameters:
      - name: page
        in: query
        required: false
        schema:
          type: integer
          default: 1
        description: Page number for pagination
      - name: per_page
        in: query
        required: false
        schema:
          type: integer
          default: 20
          minimum: 1
          maximum: 200
        description: Number of items per page (max 200)
      - name: cursor
        in: query
        required: false
        schema:
          type: string
        description: Cursor for cursor-based pagination (for large datasets)
      - name: search
        in: query
        required: false
        schema:
          type: string
        description: Search term for filtering patients
      - name: status
        in: query
        required: false
        schema:
          type: string
          enum:
          - ACTIVE
          - INACTIVE
          - LEAD
          - TRIAL
          - CUSTOMER
        description: Filter by patient status
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Patient'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve a list of patients with optional filtering and pagination
    post:
      summary: POST /api/patients
      operationId: patients_create_patient
      tags:
      - Patients
      x-storage-keys:
      - key: PATIENT_FORM_VALIDATION_STATE
        description: Form validation state and errors
        type: object
      - key: PATIENT_FORM_DRAFT
        description: Draft form data for auto-save
        type: object
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Patient'
      description: Register a new patient with personal and medical information
  /api/patients/{patient_id}:
    get:
      summary: GET /api/patients/{patient_id}
      operationId: patients_get_patient
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Patient'
        '404':
          description: Patient not found
      description: Retrieve a single patient by ID
    put:
      summary: PUT /api/patients/{patient_id}
      operationId: patients_update_patient
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatientCreate'
      responses:
        '200':
          description: Patient updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Patient'
        '400':
          description: Bad Request
        '404':
          description: Patient not found
      description: Update an existing patient record
    delete:
      summary: DELETE /api/patients/{patient_id}
      operationId: patients_delete_patient
      tags:
      - Patients
      x-storage-keys:
      - key: PATIENT_DETAILS_TAB
        description: Active tab in patient details view
        type: string
      - key: PATIENT_BULK_ACTIONS_STATE
        description: Bulk actions selection state
        type: object
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
      description: Remove a patient record from the system
  /api/patients/{patient_id}/assign-devices-extended:
    post:
      summary: POST /api/patients/{patient_id}/assign-devices-extended
      operationId: sales_assign_devices_extended
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new assign-devices-extended
  /api/patients/{patient_id}/devices:
    get:
      summary: Get all devices assigned to a specific patient
      operationId: patients_get_patient_devices
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Device'
                  meta:
                    type: object
                    properties:
                      patientId:
                        type: string
                      patientName:
                        type: string
                      deviceCount:
                        type: integer
                  timestamp:
                    type: string
                    format: date-time
      description: Get all devices assigned to a specific patient
  /api/patients/{patient_id}/ereceipts:
    post:
      summary: POST /api/patients/{patient_id}/ereceipts
      operationId: patient_subresources_create_patient_ereceipt
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new ereceipts
  /api/patients/{patient_id}/ereceipts/{ereceipt_id}:
    delete:
      summary: DELETE /api/patients/{patient_id}/ereceipts/{ereceipt_id}
      operationId: patient_subresources_delete_patient_ereceipt
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: ereceipt_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
      description: Delete {ereceipt_id}
  /api/patients/{patient_id}/hearing-tests:
    post:
      summary: POST /api/patients/{patient_id}/hearing-tests
      operationId: patient_subresources_add_patient_hearing_test
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new hearing-tests
  /api/patients/{patient_id}/hearing-tests/{test_id}:
    delete:
      summary: DELETE /api/patients/{patient_id}/hearing-tests/{test_id}
      operationId: patient_subresources_delete_patient_hearing_test
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: test_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
      description: Delete {test_id}
  /api/patients/{patient_id}/notes:
    post:
      summary: POST /api/patients/{patient_id}/notes
      operationId: patient_subresources_create_patient_note
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new notes
  /api/patients/{patient_id}/notes/{note_id}:
    delete:
      summary: DELETE /api/patients/{patient_id}/notes/{note_id}
      operationId: patient_subresources_delete_patient_note
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: note_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
      description: Delete {note_id}
  /api/patients/{patient_id}/promissory-notes:
    get:
      summary: Get all promissory notes for a patient
      operationId: payments_get_patient_promissory_notes
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/sales:
    get:
      summary: GET /api/patients/{patient_id}/sales
      operationId: sales_get_patient_sales
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Sale'
      description: Retrieve sales information
  /api/patients/{patient_id}/sgk-documents:
    get:
      summary: GET /api/patients/{patient_id}/sgk-documents
      operationId: sgk_get_patient_sgk_documents
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
      description: Retrieve sgk-documents information
  /api/patients/{patient_id}/timeline:
    get:
      summary: Get timeline events for a patient
      description: Retrieves all timeline events for a specific patient, including
        events from both custom data and activity logs
      operationId: timeline_get_patient_timeline
      tags:
      - Timeline
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Timeline events retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        patientId:
                          type: string
                        type:
                          type: string
                        title:
                          type: string
                        description:
                          type: string
                        timestamp:
                          type: string
                          format: date-time
                        user:
                          type: string
                        source:
                          type: string
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      patient_id:
                        type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Patient not found
        '500':
          description: Internal server error
    post:
      summary: Add a new timeline event for a patient
      description: Creates a new timeline event for a specific patient and logs it
        to both custom data and activity logs
      operationId: timeline_add_timeline_event
      tags:
      - Timeline
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - type
              - title
              properties:
                type:
                  type: string
                  description: Event type (e.g., 'appointment', 'sale', 'note', 'device_assigned')
                title:
                  type: string
                  description: Event title
                description:
                  type: string
                  description: Event description
                details:
                  type: object
                  description: Additional event details
                timestamp:
                  type: string
                  format: date-time
                  description: Event timestamp (defaults to current time)
                date:
                  type: string
                  description: Event date in DD.MM.YYYY format
                time:
                  type: string
                  description: Event time in HH:MM format
                user:
                  type: string
                  description: User who created the event (defaults to 'system')
                icon:
                  type: string
                  description: FontAwesome icon class (defaults to 'fa-circle')
                color:
                  type: string
                  description: Event color (defaults to 'blue')
                category:
                  type: string
                  description: Event category (defaults to 'general')
      responses:
        '201':
          description: Timeline event created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      patientId:
                        type: string
                      type:
                        type: string
                      title:
                        type: string
                      description:
                        type: string
                      timestamp:
                        type: string
                        format: date-time
                  timestamp:
                    type: string
                    format: date-time
        '400':
          description: Bad request - missing required fields
        '404':
          description: Patient not found
        '500':
          description: Internal server error
  /api/patients/{patient_id}/timeline/{event_id}:
    delete:
      summary: Delete a timeline event
      description: Removes a specific timeline event from a patient's timeline
      operationId: timeline_delete_timeline_event
      tags:
      - Timeline
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: event_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Timeline event deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Patient or timeline event not found
        '500':
          description: Internal server error
  /api/patients/{patient_id}/activities:
    post:
      summary: Log an activity for a patient (alias for timeline event)
      description: Alternative endpoint for adding timeline events, provides the same
        functionality as POST /api/patients/{patient_id}/timeline
      operationId: timeline_log_patient_activity
      tags:
      - Timeline
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - type
              - title
              properties:
                type:
                  type: string
                title:
                  type: string
                description:
                  type: string
                details:
                  type: object
      responses:
        '201':
          description: Activity logged successfully
        '400':
          description: Bad request
        '404':
          description: Patient not found
        '500':
          description: Internal server error
  /api/patients/bulk_upload:
    post:
      summary: Accept a multipart/form-data CSV file containing patients and upsert
        them into the DB.
      description: 'This endpoint is intentionally forgiving: it returns a summary
        of created/updated rows

        and reports per-row errors without aborting the entire batch.

        Authentication is optional for uploads in many workflows; we still log the
        actor when present.'
      operationId: patients_bulk_upload_patients
      tags:
      - Patients
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/export:
    get:
      summary: Export patients as CSV. Only admin users are allowed to perform exports.
      description: 'Supports optional query params: status, segment, q (search term).'
      operationId: patients_export_patients_csv
      tags:
      - Patients
      responses:
        '200':
          description: Success
  /api/patients/search:
    get:
      summary: GET /api/patients/search
      operationId: patients_search_patients
      tags:
      - Patients
      responses:
        '200':
          description: Success
      description: Retrieve search information
  /api/pricing-preview:
    post:
      summary: POST /api/pricing-preview
      operationId: sales_pricing_preview
      tags:
      - Pricing-preview
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new pricing-preview
  /api/product-suppliers/{ps_id}:
    delete:
      summary: Delete a product-supplier relationship
      operationId: suppliers_delete_product_supplier
      tags:
      - Product-suppliers
      parameters:
      - name: ps_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
      description: Delete {ps_id}
  /api/products/{product_id}/suppliers:
    post:
      summary: Add a supplier to a product
      operationId: suppliers_add_product_supplier
      tags:
      - Products
      parameters:
      - name: product_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new suppliers
  /api/promissory-notes:
    post:
      summary: Create multiple promissory notes
      operationId: payments_create_promissory_notes
      tags:
      - Promissory-notes
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/promissory-notes/{note_id}:
    patch:
      summary: Update a promissory note
      operationId: payments_update_promissory_note
      tags:
      - Promissory-notes
      parameters:
      - name: note_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
  /api/promissory-notes/{note_id}/collect:
    post:
      summary: Collect payment for a promissory note (full or partial)
      operationId: payments_collect_promissory_note
      tags:
      - Promissory-notes
      parameters:
      - name: note_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/register-phone:
    post:
      summary: POST /api/register-phone
      operationId: registration_register_phone
      tags:
      - Register-phone
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new register-phone
  /api/reports/appointments:
    get:
      summary: GET /api/reports/appointments
      operationId: reports_report_appointments
      tags:
      - Reports
      responses:
        '200':
          description: Success
      description: Retrieve appointments information
  /api/reports/campaigns:
    get:
      summary: Kampanya raporu
      operationId: reports_report_campaigns
      tags:
      - Reports
      responses:
        '200':
          description: Success
      description: Retrieve campaigns information
  /api/reports/financial:
    get:
      summary: Mali rapor
      operationId: reports_report_financial
      tags:
      - Reports
      responses:
        '200':
          description: Success
      description: Retrieve financial information
  /api/reports/overview:
    get:
      summary: "Genel rapor \xF6zeti"
      operationId: reports_report_overview
      tags:
      - Reports
      responses:
        '200':
          description: Success
      description: Retrieve overview information
  /api/reports/patients:
    get:
      summary: Hasta analizi raporu
      operationId: reports_report_patients
      tags:
      - Reports
      responses:
        '200':
          description: Success
      description: Retrieve patients information
  /api/reports/revenue:
    get:
      summary: GET /api/reports/revenue
      operationId: reports_report_revenue
      tags:
      - Reports
      responses:
        '200':
          description: Success
      description: Retrieve revenue information
  /api/sales:
    get:
      summary: GET /api/sales
      operationId: sales_list_sales
      tags:
      - Sales
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Sale'
      description: Retrieve a list of all sales
    post:
      summary: POST /api/sales
      operationId: sales_create_sale
      tags:
      - Sales
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Sale'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Create a new sale
  /api/sales/{sale_id}:
    get:
      summary: GET /api/sales/{sale_id}
      operationId: sales_get_sale
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Sale'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Get sale details by ID
    put:
      summary: PUT /api/sales/{sale_id}
      operationId: sales_update_sale
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Sale'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Update sale information
    delete:
      summary: DELETE /api/sales/{sale_id}
      operationId: sales_delete_sale
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: No Content
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Delete a sale
  /api/sales/{sale_id}/payment-plan:
    post:
      summary: POST /api/sales/{sale_id}/payment-plan
      operationId: sales_create_sale_payment_plan
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentRecord'
      description: Create new payment-plan
  /api/sales/{sale_id}/promissory-notes:
    get:
      summary: Get all promissory notes for a specific sale
      operationId: payments_get_sale_promissory_notes
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/sales/{sale_id}/invoice:
    post:
      summary: Create invoice for sale
      operationId: sales_create_sale_invoice
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                invoice_type:
                  type: string
                  enum:
                  - standard
                  - proforma
                additional_notes:
                  type: string
      responses:
        '201':
          description: Invoice created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoice_id:
                        type: string
                      invoice_number:
                        type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Sale not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Create an invoice for the specified sale
    get:
      summary: Get invoice for sale
      operationId: sales_get_sale_invoice
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoice_id:
                        type: string
                      invoice_number:
                        type: string
                      sale_id:
                        type: string
                      items:
                        type: array
                        items:
                          type: object
                      total_amount:
                        type: number
                      tax_amount:
                        type: number
                      created_at:
                        type: string
                        format: date-time
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Sale or invoice not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve the invoice for the specified sale
  /api/sales/{sale_id}/invoice/pdf:
    get:
      summary: Generate sale invoice PDF
      operationId: sales_generate_sale_invoice_pdf
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Sale invoice PDF generated successfully
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        '404':
          description: Sale or invoice not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Generate and download a PDF for the specified sale invoice
  /api/settings:
    put:
      summary: Update system settings
      operationId: update_settings
      tags:
      - Settings
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
      description: Update settings information
  /api/sgk/documents:
    post:
      summary: POST /api/sgk/documents
      operationId: sgk_upload_sgk_document
      tags:
      - Sgk
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new documents
  /api/sgk/documents/{document_id}:
    delete:
      summary: DELETE /api/sgk/documents/{document_id}
      operationId: sgk_delete_sgk_document
      tags:
      - Sgk
      parameters:
      - name: document_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
      description: Delete {document_id}
  /api/sms/monitoring:
    get:
      summary: GET /api/sms/monitoring
      operationId: sms_monitoring
      tags:
      - Sms
      responses:
        '200':
          description: Success
      description: Retrieve monitoring information
  /api/suppliers:
    get:
      summary: Get list of suppliers
      operationId: suppliers_get_suppliers
      tags:
      - Suppliers
      parameters:
      - name: page
        in: query
        required: false
        schema:
          type: integer
          default: 1
        description: Page number for pagination
      - name: per_page
        in: query
        required: false
        schema:
          type: integer
          default: 20
        description: Number of items per page
      - name: search
        in: query
        required: false
        schema:
          type: string
        description: Search term for filtering suppliers
      - name: status
        in: query
        required: false
        schema:
          type: string
          enum:
          - ACTIVE
          - INACTIVE
          - PENDING
        description: Filter by supplier status
      - name: category
        in: query
        required: false
        schema:
          type: string
        description: Filter by supplier category
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Supplier'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve a list of suppliers with optional filtering and pagination
    post:
      summary: Create a new supplier
      operationId: suppliers_create_supplier
      tags:
      - Suppliers
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Supplier'
      description: Register a new supplier with contact and business information
  /api/suppliers/{supplier_id}:
    delete:
      summary: Delete a supplier (soft delete by setting is_active=False)
      operationId: suppliers_delete_supplier
      tags:
      - Suppliers
      parameters:
      - name: supplier_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
      description: Remove a supplier from the system
  /api/suppliers/{supplier_id}/products:
    get:
      summary: Get all products for a specific supplier
      operationId: suppliers_get_supplier_products
      tags:
      - Suppliers
      parameters:
      - name: supplier_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
      description: Get list of products available from a specific supplier
  /api/suppliers/stats:
    get:
      summary: Get supplier statistics
      operationId: suppliers_get_supplier_stats
      tags:
      - Suppliers
      responses:
        '200':
          description: Success
      description: Get supplier statistics including order history
  /api/verify-registration-otp:
    post:
      summary: POST /api/verify-registration-otp
      operationId: registration_verify_registration_otp
      tags:
      - Verify-registration-otp
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new verify-registration-otp
  /api/users:
    get:
      summary: GET /api/users
      operationId: users_list_users
      tags:
      - Users
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
      description: Retrieve a list of all users
    post:
      summary: POST /api/users
      operationId: users_create_user
      tags:
      - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Create a new user
  /api/users/{user_id}:
    get:
      summary: GET /api/users/{user_id}
      operationId: users_get_user
      tags:
      - Users
      parameters:
      - name: user_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Get user details by ID
    put:
      summary: PUT /api/users/{user_id}
      operationId: users_update_user
      tags:
      - Users
      parameters:
      - name: user_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Update user information
    delete:
      summary: DELETE /api/users/{user_id}
      operationId: users_delete_user
      tags:
      - Users
      parameters:
      - name: user_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: No Content
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Delete a user
  /api/users/me:
    put:
      summary: Update My Profile
      operationId: users_update_me
      tags:
      - Users
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                username:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/User'
  /api/auth/lookup-phone:
    post:
      summary: Lookup phone number by username/email/phone
      operationId: auth_lookup_phone
      tags:
      - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - identifier
              properties:
                identifier:
                  type: string
                  description: Username, email, or phone number
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  maskedPhone:
                    type: string
                  isPhoneInput:
                    type: boolean
        '400':
          description: Bad Request
        '404':
          description: User not found
      description: Lookup masked phone by user identifier (username/email/phone)
  /api/auth/forgot-password:
    post:
      summary: Request password reset OTP
      operationId: auth_forgot_password
      tags:
      - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - identifier
              - captcha_token
              properties:
                identifier:
                  type: string
                  description: Phone number
                captcha_token:
                  type: string
                  description: CAPTCHA token
      responses:
        '200':
          description: OTP sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Bad Request
        '404':
          description: User not found
        '500':
          description: Failed to send SMS
      description: Send password reset OTP to user's phone
  /api/auth/send-verification-otp:
    post:
      summary: Send phone verification OTP
      operationId: auth_send_verification_otp
      tags:
      - Auth
      security:
      - BearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                phone:
                  type: string
                  description: Phone number (optional, updates user's phone)
      responses:
        '200':
          description: OTP sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Bad Request
        '404':
          description: User not found
        '500':
          description: Failed to send SMS
      description: Send verification OTP to authenticated user's phone (requires pre-auth
        token)
  /api/auth/verify-otp:
    post:
      summary: Verify OTP code
      operationId: auth_verify_otp
      tags:
      - Auth
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - otp
              properties:
                otp:
                  type: string
                  description: 6-digit OTP code
                identifier:
                  type: string
                  description: Phone/username/email (for forgot-password flow, optional
                    if authenticated)
      responses:
        '200':
          description: OTP verified successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  access_token:
                    type: string
                  refreshToken:
                    type: string
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          description: Invalid or expired OTP
      description: Verify OTP and complete authentication or password reset flow
  /api/auth/reset-password:
    post:
      summary: Reset password with OTP
      operationId: auth_reset_password
      tags:
      - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - identifier
              - otp
              - newPassword
              properties:
                identifier:
                  type: string
                  description: Phone number
                otp:
                  type: string
                  description: 6-digit OTP code
                newPassword:
                  type: string
                  description: New password (min 6 characters)
      responses:
        '200':
          description: Password reset successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Invalid request or OTP
        '404':
          description: User not found
      description: Reset user password using verified OTP
  /api/roles:
    get:
      summary: List all roles
      operationId: roles_list_roles
      tags:
      - Roles
      security:
      - BearerAuth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Role'
      description: Get all system roles (admin only)
    post:
      summary: Create new role
      operationId: roles_create_role
      tags:
      - Roles
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              properties:
                name:
                  type: string
                description:
                  type: string
                isSystem:
                  type: boolean
                  default: false
      responses:
        '201':
          description: Role created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad Request
        '409':
          description: Role already exists
      description: Create a new role (admin only)
  /api/roles/{role_id}:
    put:
      summary: Update role
      operationId: roles_update_role
      tags:
      - Roles
      security:
      - BearerAuth: []
      parameters:
      - name: role_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
      responses:
        '200':
          description: Role updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad Request
        '404':
          description: Role not found
        '409':
          description: Role name already exists
      description: Update an existing role (admin only)
    delete:
      summary: Delete role
      operationId: roles_delete_role
      tags:
      - Roles
      security:
      - BearerAuth: []
      parameters:
      - name: role_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Role deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '403':
          description: Cannot delete system role
        '404':
          description: Role not found
      description: Delete a role (admin only, cannot delete system roles)
  /api/roles/{role_id}/permissions:
    post:
      summary: Add permission to role
      operationId: roles_add_permission
      tags:
      - Roles
      security:
      - BearerAuth: []
      parameters:
      - name: role_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - permission
              properties:
                permission:
                  type: string
      responses:
        '200':
          description: Permission added
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad Request
        '404':
          description: Role or permission not found
        '409':
          description: Permission already assigned
      description: Add a permission to a role (admin only)
  /api/roles/{role_id}/permissions/{permission_id}:
    delete:
      summary: Remove permission from role
      operationId: roles_remove_permission
      tags:
      - Roles
      security:
      - BearerAuth: []
      parameters:
      - name: role_id
        in: path
        required: true
        schema:
          type: string
      - name: permission_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Permission removed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Role'
        '404':
          description: Role, permission not found or not assigned
      description: Remove a permission from a role (admin only)
  /api/payment-records:
    post:
      summary: Create payment record
      operationId: payments_create_payment_record
      tags:
      - Payments
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - patient_id
              - amount
              - payment_method
              properties:
                patient_id:
                  type: string
                  description: Patient ID
                sale_id:
                  type: string
                  description: Associated sale ID (optional)
                promissory_note_id:
                  type: string
                  description: Associated promissory note ID (optional)
                amount:
                  type: number
                  description: Payment amount
                payment_date:
                  type: string
                  format: date-time
                  description: Payment date (defaults to now)
                due_date:
                  type: string
                  format: date-time
                  description: Due date (optional)
                payment_method:
                  type: string
                  enum:
                  - cash
                  - credit_card
                  - bank_transfer
                  - check
                  description: Payment method
                payment_type:
                  type: string
                  enum:
                  - payment
                  - refund
                  default: payment
                  description: Payment type
                reference_number:
                  type: string
                  description: Payment reference number
                notes:
                  type: string
                  description: Additional notes
                branchId:
                  type: string
                  description: Branch ID
      responses:
        '201':
          description: Payment record created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/PaymentRecord'
                  message:
                    type: string
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
      description: Create a new payment record
  /api/sms/documents/upload:
    post:
      summary: Upload SMS Document to S3
      operationId: sms_upload_document
      tags:
      - Sms
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required:
              - file
              - documentType
              properties:
                file:
                  type: string
                  format: binary
                documentType:
                  type: string
                  enum:
                  - contract
                  - id_card
                  - residence
                  - tax_plate
                  - activity_cert
                  - signature_circular
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      type:
                        type: string
                      filename:
                        type: string
                      size:
                        type: integer
  /api/sms/documents/{document_type}:
    delete:
      summary: Delete SMS integration document
      operationId: sms_delete_document
      tags:
      - SMS
      security:
      - BearerAuth: []
      parameters:
      - name: document_type
        in: path
        required: true
        schema:
          type: string
          enum:
          - contract
          - id_card
          - residence
          - signature
      responses:
        '200':
          description: Document deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '404':
          description: Document not found
        '500':
          description: Delete failed
      description: Delete an uploaded SMS integration document (admin only)
  /api/subscriptions/current:
    get:
      summary: Get current subscription details
      operationId: subscriptions_get_current
      tags:
      - Subscriptions
      security:
      - BearerAuth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenant:
                        type: object
                        description: Tenant information
                      plan:
                        type: object
                        description: Current plan details
                      isExpired:
                        type: boolean
                      daysRemaining:
                        type: integer
        '404':
          description: User or tenant not found
      description: Get current tenant subscription and plan details
  /entities:
    post:
      summary: Extract entities from image using OCR
      operationId: ocr_extract_entities
      tags:
      - Entities
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Create new entities
  /extract_patient:
    post:
      summary: Extract patient name from image using OCR
      operationId: ocr_extract_patient_name
      tags:
      - Extract_patient
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Extract patient name from document image using OCR
  /health:
    get:
      summary: Health check endpoint (moved from app.py)
      operationId: ocr_health_check
      tags:
      - Health
      responses:
        '200':
          description: Success
      description: Health check for OCR service availability
  /init-db:
    post:
      summary: Initialize database and create tables
      operationId: ocr_init_database
      tags:
      - Init-db
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Initialize OCR service database and create required tables
  /initialize:
    post:
      summary: Initialize NLP/OCR service
      operationId: ocr_initialize_nlp_endpoint
      tags:
      - Initialize
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Initialize NLP/OCR processing service
  /process:
    post:
      summary: Process document with OCR
      operationId: ocr_process_document
      tags:
      - Process
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Process document using OCR to extract text and data
  /similarity:
    post:
      summary: Calculate similarity between two images using OCR text
      operationId: ocr_calculate_similarity
      tags:
      - Similarity
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
      description: Calculate similarity between documents using OCR text analysis
  /swagger.html:
    get:
      summary: Serve the static Swagger UI page from the repository `public/` folder.
      description: 'This helps local development: visit http://<backend-host>:<port>/swagger.html
        so the

        Swagger UI and `/api/openapi.yaml` are on the same origin and no CORS overrides
        are needed.'
      operationId: serve_swagger_ui
      tags:
      - Swagger.html
      responses:
        '200':
          description: Success
  /api/suppliers/{supplier_id}/invoices:
    get:
      summary: Get supplier purchase invoices (incoming and outgoing)
      operationId: suppliers_get_supplier_invoices
      tags:
      - Suppliers
      parameters:
      - name: supplier_id
        in: path
        required: true
        schema:
          type: string
      - name: page
        in: query
        required: false
        schema:
          type: integer
          default: 1
      - name: per_page
        in: query
        required: false
        schema:
          type: integer
          default: 20
          minimum: 1
          maximum: 200
      - name: type
        in: query
        required: false
        schema:
          type: string
          enum:
          - incoming
          - outgoing
          - all
          default: all
      - name: start_date
        in: query
        required: false
        schema:
          type: string
          format: date-time
      - name: end_date
        in: query
        required: false
        schema:
          type: string
          format: date-time
      responses:
        '200':
          description: Supplier invoices retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoices:
                        type: array
                        items:
                          $ref: '#/components/schemas/PurchaseInvoice'
                      pagination:
                        type: object
                        properties:
                          page:
                            type: integer
                          perPage:
                            type: integer
                          total:
                            type: integer
                          totalPages:
                            type: integer
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Supplier not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve purchase invoices for the specified supplier
  /api/suppliers/suggested:
    get:
      summary: Get suggested suppliers (pending approval)
      operationId: suppliers_get_suggested_suppliers
      tags:
      - Suppliers
      responses:
        '200':
          description: Suggested suppliers retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      suggestedSuppliers:
                        type: array
                        items:
                          $ref: '#/components/schemas/SuggestedSupplier'
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Retrieve a list of suggested suppliers based on incoming invoices
  /api/suppliers/suggested/{suggested_id}/accept:
    post:
      summary: Accept suggested supplier and create/link supplier record
      operationId: suppliers_accept_suggested_supplier
      tags:
      - Suppliers
      parameters:
      - name: suggested_id
        in: path
        required: true
        schema:
          type: string
      - name: Idempotency-Key
        in: header
        required: true
        schema:
          type: string
      responses:
        '201':
          description: Suggested supplier accepted and supplier created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      supplier:
                        $ref: '#/components/schemas/Supplier'
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '200':
          description: Suggested supplier linked to existing supplier
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      supplier:
                        $ref: '#/components/schemas/Supplier'
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Accept a suggested supplier and create or link to a supplier by
        tax number
  /api/suppliers/suggested/{suggested_id}:
    delete:
      summary: Reject a suggested supplier
      operationId: suppliers_reject_suggested_supplier
      tags:
      - Suppliers
      parameters:
      - name: suggested_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Suggested supplier rejected
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      message:
                        type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
        '404':
          description: Suggested supplier not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      description: Reject and mark a suggested supplier as rejected
  /api/birfatura/sync-invoices:
    post:
      summary: Sync invoices from BirFatura
      operationId: birfatura_sync_invoices
      tags:
      - BirFatura
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                start_date:
                  type: string
                  format: date-time
                end_date:
                  type: string
                  format: date-time
      responses:
        '200':
          description: Success
        '401':
          description: Unauthorized
        '500':
          description: Internal Server Error
  /api/EFatura/Create:
    post:
      summary: "Create invoice in draft mode (not sent to G\u0130B yet)"
      operationId: birfatura_create_invoice
      tags:
      - BirFatura
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Invoice data for creation
      responses:
        '200':
          description: Invoice created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  Success:
                    type: boolean
                  Message:
                    type: string
                  Result:
                    type: object
                    properties:
                      id:
                        type: string
                      invoiceId:
                        type: string
        '502':
          description: Bad Gateway (provider error)
          content:
            application/json:
              schema:
                type: object
                properties:
                  Success:
                    type: boolean
                  Message:
                    type: string
  /api/EFatura/Retry/{invoice_id}:
    post:
      summary: "Retry sending a failed invoice to G\u0130B"
      operationId: birfatura_retry_invoice
      tags:
      - BirFatura
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice retry successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  Success:
                    type: boolean
                  Message:
                    type: string
        '502':
          description: Bad Gateway (provider error)
          content:
            application/json:
              schema:
                type: object
                properties:
                  Success:
                    type: boolean
                  Message:
                    type: string
  /api/EFatura/Cancel/{invoice_id}:
    post:
      summary: "Cancel an invoice (send cancellation to G\u0130B)"
      operationId: birfatura_cancel_invoice
      tags:
      - BirFatura
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  description: Cancellation reason
      responses:
        '200':
          description: Invoice cancellation successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  Success:
                    type: boolean
                  Message:
                    type: string
                  Reason:
                    type: string
        '502':
          description: Bad Gateway (provider error)
          content:
            application/json:
              schema:
                type: object
                properties:
                  Success:
                    type: boolean
                  Message:
                    type: string
  /api/sms/audiences:
    get:
      summary: List Target Audiences
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TargetAudience'
    post:
      summary: Create Target Audience
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              - sourceType
              properties:
                name:
                  type: string
                sourceType:
                  type: string
                  enum:
                  - excel
                  - filter
                filePath:
                  type: string
                totalRecords:
                  type: integer
                filterCriteria:
                  type: object
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TargetAudience'
  /api/sms/audiences/upload:
    post:
      summary: Upload Audience Excel
      tags:
      - Sms
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TargetAudience'
  /api/sms/config:
    get:
      summary: Get SMS Provider Configuration
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/SMSProviderConfig'
    put:
      summary: Update SMS Provider Configuration
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                apiUsername:
                  type: string
                apiPassword:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSProviderConfig'
  /api/users/me/password:
    post:
      summary: Change Password
      operationId: users_change_password
      tags:
      - Users
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - currentPassword
              - newPassword
              properties:
                currentPassword:
                  type: string
                newPassword:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/sms/headers:
    get:
      summary: List SMS Headers
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SMSHeaderRequest'
    post:
      summary: Request SMS Header
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - headerText
              - headerType
              properties:
                headerText:
                  type: string
                headerType:
                  type: string
                documents:
                  type: array
                  items:
                    type: string
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSHeaderRequest'
  /api/sms/packages:
    get:
      summary: List SMS Packages
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SMSPackage'
  /api/sms/credit:
    get:
      summary: Get Tenant SMS Credit
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantSMSCredit'
  /api/sms/documents/{documentType}/download:
    get:
      summary: Get presigned URL for document download
      operationId: sms_download_document
      tags:
      - Sms
      parameters:
      - name: documentType
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  url:
                    type: string
  /api/sms/documents/{documentType}:
    delete:
      summary: Delete SMS Document
      operationId: sms_delete_document
      tags:
      - Sms
      parameters:
      - name: documentType
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/admin/sms/packages:
    get:
      summary: Admin List SMS Packages
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/SMSPackage'
    post:
      summary: Admin Create SMS Package
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              - smsCount
              - price
              properties:
                name:
                  type: string
                description:
                  type: string
                smsCount:
                  type: integer
                price:
                  type: number
                currency:
                  type: string
                isActive:
                  type: boolean
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSPackage'
  /api/admin/sms/packages/{pkg_id}:
    put:
      summary: Admin Update SMS Package
      tags:
      - Sms
      parameters:
      - name: pkg_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                smsCount:
                  type: integer
                price:
                  type: number
                isActive:
                  type: boolean
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSPackage'
  /api/admin/sms/headers:
    get:
      summary: Admin List SMS Headers
      tags:
      - Sms
      parameters:
      - name: status
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/SMSHeaderRequest'
  /api/activity-logs:
    get:
      summary: Get Activity Logs
      tags:
      - Admin
      parameters:
      - name: entity_type
        in: query
        schema:
          type: string
      - name: entity_id
        in: query
        schema:
          type: string
      - name: user_id
        in: query
        schema:
          type: string
      - name: limit
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ActivityLog'
                  count:
                    type: integer
  /api/affiliate/register:
    post:
      summary: Register Affiliate
      tags:
      - Affiliate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AffiliateRegisterRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Affiliate'
  /api/affiliate/login:
    post:
      summary: Login Affiliate
      tags:
      - Affiliate
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AffiliateLoginRequest'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Affiliate'
  /api/affiliate/me:
    get:
      summary: Get Affiliate Profile
      tags:
      - Affiliate
      parameters:
      - name: affiliate_id
        in: query
        required: true
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Affiliate'
  /api/affiliate/{affiliate_id}:
    patch:
      summary: Update Affiliate IBAN
      tags:
      - Affiliate
      parameters:
      - name: affiliate_id
        in: path
        required: true
        schema:
          type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - iban
              properties:
                iban:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Affiliate'
  /api/affiliate/list:
    get:
      summary: List Affiliates
      tags:
      - Affiliate
      parameters:
      - name: skip
        in: query
        schema:
          type: integer
      - name: limit
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Affiliate'
  /api/admin/sms/headers/{header_id}/status:
    put:
      summary: Admin Update SMS Header Status
      tags:
      - Sms
      parameters:
      - name: header_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - status
              properties:
                status:
                  type: string
                  enum:
                  - pending
                  - approved
                  - rejected
                rejectionReason:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSHeaderRequest'
components:
  schemas:
    Patient:
      type: object
      properties:
        id:
          type: string
          description: Unique patient identifier
        tcNumber:
          type: string
          description: Turkish citizenship number
        identityNumber:
          type: string
          description: Identity number
        firstName:
          type: string
          description: Patient's first name
        lastName:
          type: string
          description: Patient's last name
        phone:
          type: string
          description: Patient's phone number
        email:
          type: string
          format: email
          description: Patient's email address
        birthDate:
          type: string
          format: date
          description: Patient's birth date
        gender:
          type: string
          enum:
          - M
          - F
          description: Patient's gender
        addressCity:
          type: string
          description: Patient's city
        addressDistrict:
          type: string
          description: Patient's district
        addressFull:
          type: string
          description: Patient's full address
        status:
          type: string
          enum:
          - ACTIVE
          - INACTIVE
          - LEAD
          - TRIAL
          - CUSTOMER
          description: Patient status
        segment:
          type: string
          description: Patient segment
        acquisitionType:
          type: string
          description: How patient was acquired
        conversionStep:
          type: string
          description: Patient conversion step
        referredBy:
          type: string
          description: Who referred the patient
        priorityScore:
          type: integer
          description: Patient priority score
        tags:
          type: array
          items:
            type: string
          description: Patient tags
        sgkInfo:
          type: object
          description: SGK information
        customData:
          type: object
          description: Custom patient data
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
      - tcNumber
      - firstName
      - lastName
      - phone
    PatientCreate:
      type: object
      properties:
        tcNumber:
          type: string
          description: Turkish citizenship number
        identityNumber:
          type: string
          description: Identity number
        firstName:
          type: string
          description: Patient's first name
        lastName:
          type: string
          description: Patient's last name
        phone:
          type: string
          description: Patient's phone number
        email:
          type: string
          format: email
          description: Patient's email address
        birthDate:
          type: string
          format: date
          description: Patient's birth date
        gender:
          type: string
          enum:
          - M
          - F
          description: Patient's gender
        addressCity:
          type: string
          description: Patient's city
        addressDistrict:
          type: string
          description: Patient's district
        addressFull:
          type: string
          description: Patient's full address
        status:
          type: string
          enum:
          - ACTIVE
          - INACTIVE
          - LEAD
          - TRIAL
          - CUSTOMER
          description: Patient status
        segment:
          type: string
          description: Patient segment
        acquisitionType:
          type: string
          description: How patient was acquired
        conversionStep:
          type: string
          description: Patient conversion step
        referredBy:
          type: string
          description: Who referred the patient
        priorityScore:
          type: integer
          description: Patient priority score
        tags:
          type: array
          items:
            type: string
          description: Patient tags
        sgkInfo:
          type: object
          description: SGK information
        customData:
          type: object
          description: Custom patient data
      required:
      - tcNumber
      - firstName
      - lastName
      - phone
    Role:
      type: object
      properties:
        id:
          type: string
          description: Unique role identifier
        name:
          type: string
          description: Role name
        description:
          type: string
          description: Role description
        isSystem:
          type: boolean
          description: Whether role is a system role (cannot be deleted)
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/Permission'
          description: List of permissions assigned to this role
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
      - name
    Permission:
      type: object
      properties:
        id:
          type: string
          description: Unique permission identifier
        name:
          type: string
          description: Permission name
        description:
          type: string
          description: Permission description
        resource:
          type: string
          description: Resource this permission applies to
        action:
          type: string
          description: Action allowed by this permission
        createdAt:
          type: string
          format: date-time
      required:
      - name
    Appointment:
      type: object
      properties:
        id:
          type: string
          description: Unique appointment identifier
        patientId:
          type: string
          description: Patient ID
        clinicianId:
          type: string
          description: Clinician ID
        branchId:
          type: string
          description: Branch ID
        date:
          type: string
          format: date-time
          description: Appointment date
        time:
          type: string
          description: Appointment time
        duration:
          type: integer
          description: Duration in minutes
        appointmentType:
          type: string
          description: Type of appointment
        status:
          type: string
          enum:
          - SCHEDULED
          - CONFIRMED
          - COMPLETED
          - CANCELLED
          - NO_SHOW
          description: Appointment status
        notes:
          type: string
          description: Appointment notes
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
      - patientId
      - date
      - time
    Device:
      type: object
      properties:
        id:
          type: string
          description: Unique device identifier
        patientId:
          type: string
          description: Patient ID
        inventoryId:
          type: string
          description: Inventory ID
        serialNumber:
          type: string
          description: Device serial number (for single ear devices)
        serialNumberLeft:
          type: string
          description: Left ear device serial number
        serialNumberRight:
          type: string
          description: Right ear device serial number
        brand:
          type: string
          description: Device brand
        model:
          type: string
          description: Device model
        deviceType:
          type: string
          description: Type of device
        category:
          type: string
          description: Device category
        ear:
          type: string
          enum:
          - LEFT
          - RIGHT
          - BILATERAL
          description: Which ear the device is for
        status:
          type: string
          enum:
          - IN_STOCK
          - ASSIGNED
          - TRIAL
          - DEFECTIVE
          - LOST
          - RETURNED
          description: Device status
        trialStartDate:
          type: string
          format: date
          description: Trial start date
        trialEndDate:
          type: string
          format: date
          description: Trial end date
        trialExtendedUntil:
          type: string
          format: date
          description: Trial extended until date
        warrantyStartDate:
          type: string
          format: date
          description: Warranty start date
        warrantyEndDate:
          type: string
          format: date
          description: Warranty end date
        warrantyTerms:
          type: string
          description: Warranty terms
        price:
          type: number
          format: decimal
          description: Device price
        purchaseDate:
          type: string
          format: date
          description: Purchase date
        warrantyExpiry:
          type: string
          format: date
          description: Warranty expiry date
        notes:
          type: string
          description: Device notes
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
      - serialNumber
      - model
      - brand
    Sale:
      type: object
      properties:
        id:
          type: string
          description: Unique sale identifier
        patientId:
          type: string
          description: Patient ID
        productId:
          type: string
          description: Product ID
        saleDate:
          type: string
          format: date-time
          description: Sale date
        totalAmount:
          type: number
          format: decimal
          description: Total sale amount
        listPriceTotal:
          type: number
          format: decimal
          description: List price total
        discountAmount:
          type: number
          format: decimal
          description: Discount amount
        sgkCoverage:
          type: number
          format: decimal
          description: SGK coverage amount
        patientPayment:
          type: number
          format: decimal
          description: Patient payment amount
        paymentMethod:
          type: string
          description: Payment method
        status:
          type: string
          enum:
          - PENDING
          - COMPLETED
          - CANCELLED
          description: Sale status
        notes:
          type: string
          description: Sale notes
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
      - patientId
      - totalAmount
    InventoryItem:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        brand:
          type: string
        model:
          type: string
        category:
          type: string
        barcode:
          type: string
        stock:
          type: integer
        price:
          type: number
        currency:
          type: string
        minStockLevel:
          type: integer
        isActive:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    Supplier:
      type: object
      properties:
        id:
          type: string
          description: Unique supplier identifier
        name:
          type: string
          description: Supplier name
        contactPerson:
          type: string
          description: Contact person name
        phone:
          type: string
          description: Supplier phone
        email:
          type: string
          format: email
          description: Supplier email
        address:
          type: string
          description: Supplier address
        taxNumber:
          type: string
          description: Tax number
        status:
          type: string
          enum:
          - ACTIVE
          - INACTIVE
          description: Supplier status
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
      - name
      - contactPerson
    Campaign:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        name:
          type: string
        description:
          type: string
        campaignType:
          type: string
        targetSegment:
          type: string
        targetCriteria:
          type: object
        messageTemplate:
          type: string
        status:
          type: string
        totalRecipients:
          type: integer
        successfulSends:
          type: integer
        failedSends:
          type: integer
        createdAt:
          type: string
          format: date-time
        sentAt:
          type: string
          format: date-time
    Notification:
      type: object
      properties:
        id:
          type: string
        userId:
          type: string
        title:
          type: string
        message:
          type: string
        type:
          type: string
        read:
          type: boolean
        createdAt:
          type: string
          format: date-time
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
        code:
          type: integer
          description: Error code
        details:
          type: object
          description: Additional error details
      required:
      - error
    SuccessResponse:
      type: object
      properties:
        message:
          type: string
          description: Success message
        data:
          type: object
          description: Response data
      required:
      - message
    PaginationInfo:
      type: object
      properties:
        page:
          type: integer
          description: Current page number (offset-based pagination)
        perPage:
          type: integer
          description: Items per page
        total:
          type: integer
          description: Total number of items (offset-based pagination)
        totalPages:
          type: integer
          description: Total number of pages (offset-based pagination)
        hasNext:
          type: boolean
          description: Whether there are more items available
        nextCursor:
          type: string
          description: Cursor for next page (cursor-based pagination)
        cursor:
          type: string
          description: Current cursor (cursor-based pagination)
      required:
      - page
      - perPage
      - total
      - totalPages
    PaymentRecord:
      type: object
      properties:
        id:
          type: string
          description: Unique payment record identifier
        patientId:
          type: string
          description: Patient ID
        saleId:
          type: string
          description: Sale ID
        promissoryNoteId:
          type: string
          description: Promissory note ID
        amount:
          type: number
          format: decimal
          description: Payment amount
        paymentDate:
          type: string
          format: date-time
          description: Payment date
        dueDate:
          type: string
          format: date
          description: Due date
        paymentMethod:
          type: string
          description: Payment method
        paymentType:
          type: string
          description: Payment type
        status:
          type: string
          enum:
          - PENDING
          - COMPLETED
          - CANCELLED
          - OVERDUE
          description: Payment status
        referenceNumber:
          type: string
          description: Reference number
        notes:
          type: string
          description: Payment notes
        deviceId:
          type: string
          description: Device ID
        ear:
          type: string
          enum:
          - LEFT
          - RIGHT
          - BILATERAL
          description: Which ear
        reason:
          type: string
          description: Payment reason
        fromInventory:
          type: boolean
          description: From inventory flag
        listPrice:
          type: number
          format: decimal
          description: List price
        salePrice:
          type: number
          format: decimal
          description: Sale price
        sgkScheme:
          type: string
          description: SGK scheme
        sgkSupport:
          type: number
          format: decimal
          description: SGK support amount
        discountType:
          type: string
          description: Discount type
        discountValue:
          type: number
          format: decimal
          description: Discount value
        netPayable:
          type: number
          format: decimal
          description: Net payable amount
        productId:
          type: string
          description: Product ID
        saleDate:
          type: string
          format: date-time
          description: Sale date
        listPriceTotal:
          type: number
          format: decimal
          description: List price total
        totalAmount:
          type: number
          format: decimal
          description: Total amount
        discountAmount:
          type: number
          format: decimal
          description: Discount amount
        finalAmount:
          type: number
          format: decimal
          description: Final amount
        paidAmount:
          type: number
          format: decimal
          description: Paid amount
        rightEarAssignmentId:
          type: string
          description: Right ear assignment ID
        leftEarAssignmentId:
          type: string
          description: Left ear assignment ID
        sgkCoverage:
          type: number
          format: decimal
          description: SGK coverage
        patientPayment:
          type: number
          format: decimal
          description: Patient payment
        planName:
          type: string
          description: Payment plan name
        installmentCount:
          type: integer
          description: Number of installments
        installmentAmount:
          type: number
          format: decimal
          description: Installment amount
        installmentNumber:
          type: integer
          description: Current installment number
        remainingBalance:
          type: number
          format: decimal
          description: Remaining balance
        interestRate:
          type: number
          format: decimal
          description: Interest rate
        totalInterest:
          type: number
          format: decimal
          description: Total interest
        processingFee:
          type: number
          format: decimal
          description: Processing fee amount
        startDate:
          type: string
          format: date-time
          description: Start date
        paymentPlanId:
          type: string
          description: Payment plan ID
        paidDate:
          type: string
          format: date-time
          description: Paid date
        lateFee:
          type: number
          format: decimal
          description: Late fee amount
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
      - patientId
      - amount
      - paymentDate
    User:
      type: object
      properties:
        id:
          type: string
        username:
          type: string
        email:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        role:
          type: string
        phone:
          type: string
        isPhoneVerified:
          type: boolean
        isActive:
          type: boolean
        createdAt:
          type: string
          format: date-time
    CommunicationTemplate:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        templateType:
          type: string
          enum:
          - sms
          - email
        category:
          type: string
        subject:
          type: string
        bodyText:
          type: string
        bodyHtml:
          type: string
        variables:
          type: array
          items:
            type: string
        isActive:
          type: boolean
        isSystem:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CommunicationMessage:
      type: object
      properties:
        id:
          type: string
          description: Unique message identifier
        messageType:
          type: string
          enum:
          - sms
          - email
          description: Type of message (sms or email)
        patientId:
          type: string
          description: Patient ID
        campaignId:
          type: string
          description: Campaign ID (if part of a campaign)
        templateId:
          type: string
          description: Template ID used for this message
        status:
          type: string
          description: Message status (sent, delivered, failed, etc.)
        phoneNumber:
          type: string
          description: Phone number (for SMS messages)
        toEmail:
          type: string
          description: Recipient email address (for email messages)
        fromEmail:
          type: string
          description: Sender email address (for email messages)
        subject:
          type: string
          description: Email subject (for email messages)
        message:
          type: string
          description: Message content (for SMS)
        bodyText:
          type: string
          description: Plain text content (for email)
        bodyHtml:
          type: string
          description: HTML content (for email)
        sentAt:
          type: string
          format: date-time
          description: When the message was sent
        deliveredAt:
          type: string
          format: date-time
          description: When the message was delivered
        errorMessage:
          type: string
          description: Error message if sending failed
        cost:
          type: number
          format: float
          description: Cost of sending the message
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
        isSystem:
          type: boolean
          description: Whether template is a system template
        usageCount:
          type: integer
          description: Number of times template has been used
        lastUsedAt:
          type: string
          format: date-time
          description: Last time template was used
      required:
      - name
      - templateType
      - bodyText
    CommunicationTemplateCreate:
      type: object
      properties:
        name:
          type: string
          description: Template name
        description:
          type: string
          description: Template description
        templateType:
          type: string
          enum:
          - sms
          - email
          description: Type of communication template
        category:
          type: string
          description: Template category
        subject:
          type: string
          description: Email subject (for email templates)
        bodyText:
          type: string
          description: Plain text content
        bodyHtml:
          type: string
          description: HTML content (for email templates)
        variables:
          type: array
          items:
            type: string
          description: Available template variables
        isActive:
          type: boolean
          default: true
          description: Whether template is active
      required:
      - name
      - templateType
      - bodyText
    CommunicationTemplateUpdate:
      type: object
      properties:
        name:
          type: string
          description: Template name
        description:
          type: string
          description: Template description
        category:
          type: string
          description: Template category
        subject:
          type: string
          description: Email subject (for email templates)
        bodyText:
          type: string
          description: Plain text content
        bodyHtml:
          type: string
          description: HTML content (for email templates)
        variables:
          type: array
          items:
            type: string
          description: Available template variables
        isActive:
          type: boolean
          description: Whether template is active
    PurchaseInvoice:
      type: object
      properties:
        id:
          type: integer
        birfaturaUuid:
          type: string
        invoiceNumber:
          type: string
        invoiceDate:
          type: string
          format: date-time
        invoiceType:
          type: string
          enum:
          - INCOMING
          - OUTGOING
        senderName:
          type: string
        senderTaxNumber:
          type: string
        senderTaxOffice:
          type: string
        senderAddress:
          type: string
        senderCity:
          type: string
        supplierId:
          type: integer
          nullable: true
        currency:
          type: string
        subtotal:
          type: number
        taxAmount:
          type: number
        totalAmount:
          type: number
        status:
          type: string
        isMatched:
          type: boolean
        notes:
          type: string
          nullable: true
        itemsCount:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
          nullable: true
    SuggestedSupplier:
      type: object
      properties:
        id:
          type: integer
        companyName:
          type: string
        taxNumber:
          type: string
        taxOffice:
          type: string
        address:
          type: string
        city:
          type: string
        invoiceCount:
          type: integer
        totalAmount:
          type: number
        firstInvoiceDate:
          type: string
          format: date-time
          nullable: true
        lastInvoiceDate:
          type: string
          format: date-time
          nullable: true
        status:
          type: string
          enum:
          - PENDING
          - ACCEPTED
          - REJECTED
        acceptedAt:
          type: string
          format: date-time
          nullable: true
        acceptedBy:
          type: string
          nullable: true
        supplierId:
          type: integer
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
          nullable: true
    SMSProviderConfig:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        apiUsername:
          type: string
        documentsEmail:
          type: string
        isActive:
          type: boolean
        documents:
          type: array
          items:
            type: object
    SMSHeaderRequest:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        headerText:
          type: string
        headerType:
          type: string
          enum:
          - company_title
          - trademark
          - domain
          - other
        status:
          type: string
          enum:
          - pending
          - approved
          - rejected
        rejectionReason:
          type: string
        documents:
          type: array
          items:
            type: string
        createdAt:
          type: string
          format: date-time
    SMSPackage:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        smsCount:
          type: integer
        price:
          type: number
        currency:
          type: string
        isActive:
          type: boolean
    TenantSMSCredit:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        balance:
          type: integer
        totalPurchased:
          type: integer
        totalUsed:
          type: integer
    TargetAudience:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        name:
          type: string
        sourceType:
          type: string
        totalRecords:
          type: integer
        filterCriteria:
          type: object
        createdAt:
          type: string
          format: date-time
    ActivityLog:
      type: object
      properties:
        id:
          type: string
        userId:
          type: string
        action:
          type: string
        entityType:
          type: string
        entityId:
          type: string
        details:
          type: string
        ipAddress:
          type: string
        userAgent:
          type: string
        createdAt:
          type: string
          format: date-time
    CommunicationTemplateCreateBody:
      type: object
      required:
      - name
      - templateType
      - bodyText
      properties:
        name:
          type: string
        description:
          type: string
        templateType:
          type: string
          enum:
          - sms
          - email
        category:
          type: string
        subject:
          type: string
        bodyText:
          type: string
        bodyHtml:
          type: string
        variables:
          type: array
          items:
            type: string
        isActive:
          type: boolean
    Affiliate:
      type: object
      properties:
        id:
          type: integer
        email:
          type: string
        iban:
          type: string
        code:
          type: string
        is_active:
          type: boolean
        created_at:
          type: string
          format: date-time
    AffiliateRegisterRequest:
      type: object
      required:
      - email
      - password
      properties:
        email:
          type: string
        password:
          type: string
        iban:
          type: string
    AffiliateLoginRequest:
      type: object
      required:
      - email
      - password
      properties:
        email:
          type: string
        password:
          type: string
