var $E=Object.defineProperty;var zE=(e,t,r)=>t in e?$E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var at=(e,t,r)=>(zE(e,typeof t!="symbol"?t+"":t,r),r),od=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var Y=(e,t,r)=>(od(e,t,"read from private field"),r?r.call(e):t.get(e)),Ee=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},ve=(e,t,r,n)=>(od(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);var _c=(e,t,r,n)=>({set _(a){ve(e,t,a,r)},get _(){return Y(e,t,n)}}),ze=(e,t,r)=>(od(e,t,"access private method"),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var VE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zv={exports:{}},S0={},Vv={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ic=Symbol.for("react.element"),HE=Symbol.for("react.portal"),WE=Symbol.for("react.fragment"),KE=Symbol.for("react.strict_mode"),GE=Symbol.for("react.profiler"),YE=Symbol.for("react.provider"),XE=Symbol.for("react.context"),qE=Symbol.for("react.forward_ref"),QE=Symbol.for("react.suspense"),JE=Symbol.for("react.memo"),ZE=Symbol.for("react.lazy"),Qp=Symbol.iterator;function e_(e){return e===null||typeof e!="object"?null:(e=Qp&&e[Qp]||e["@@iterator"],typeof e=="function"?e:null)}var Hv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Wv=Object.assign,Kv={};function uo(e,t,r){this.props=e,this.context=t,this.refs=Kv,this.updater=r||Hv}uo.prototype.isReactComponent={};uo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};uo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Gv(){}Gv.prototype=uo.prototype;function qh(e,t,r){this.props=e,this.context=t,this.refs=Kv,this.updater=r||Hv}var Qh=qh.prototype=new Gv;Qh.constructor=qh;Wv(Qh,uo.prototype);Qh.isPureReactComponent=!0;var Jp=Array.isArray,Yv=Object.prototype.hasOwnProperty,Jh={current:null},Xv={key:!0,ref:!0,__self:!0,__source:!0};function qv(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Yv.call(t,n)&&!Xv.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:ic,type:e,key:s,ref:i,props:a,_owner:Jh.current}}function t_(e,t){return{$$typeof:ic,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Zh(e){return typeof e=="object"&&e!==null&&e.$$typeof===ic}function r_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Zp=/\/+/g;function ld(e,t){return typeof e=="object"&&e!==null&&e.key!=null?r_(""+e.key):t.toString(36)}function iu(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case ic:case HE:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+ld(i,0):n,Jp(a)?(r="",e!=null&&(r=e.replace(Zp,"$&/")+"/"),iu(a,t,r,"",function(c){return c})):a!=null&&(Zh(a)&&(a=t_(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(Zp,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",Jp(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+ld(s,o);i+=iu(s,t,r,l,a)}else if(l=e_(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+ld(s,o++),i+=iu(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function bc(e,t,r){if(e==null)return e;var n=[],a=0;return iu(e,n,"","",function(s){return t.call(r,s,a++)}),n}function n_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var wr={current:null},ou={transition:null},a_={ReactCurrentDispatcher:wr,ReactCurrentBatchConfig:ou,ReactCurrentOwner:Jh};function Qv(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:bc,forEach:function(e,t,r){bc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return bc(e,function(){t++}),t},toArray:function(e){return bc(e,function(t){return t})||[]},only:function(e){if(!Zh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ue.Component=uo;Ue.Fragment=WE;Ue.Profiler=GE;Ue.PureComponent=qh;Ue.StrictMode=KE;Ue.Suspense=QE;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a_;Ue.act=Qv;Ue.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Wv({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Jh.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Yv.call(t,l)&&!Xv.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ic,type:e.type,key:a,ref:s,props:n,_owner:i}};Ue.createContext=function(e){return e={$$typeof:XE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:YE,_context:e},e.Consumer=e};Ue.createElement=qv;Ue.createFactory=function(e){var t=qv.bind(null,e);return t.type=e,t};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(e){return{$$typeof:qE,render:e}};Ue.isValidElement=Zh;Ue.lazy=function(e){return{$$typeof:ZE,_payload:{_status:-1,_result:e},_init:n_}};Ue.memo=function(e,t){return{$$typeof:JE,type:e,compare:t===void 0?null:t}};Ue.startTransition=function(e){var t=ou.transition;ou.transition={};try{e()}finally{ou.transition=t}};Ue.unstable_act=Qv;Ue.useCallback=function(e,t){return wr.current.useCallback(e,t)};Ue.useContext=function(e){return wr.current.useContext(e)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(e){return wr.current.useDeferredValue(e)};Ue.useEffect=function(e,t){return wr.current.useEffect(e,t)};Ue.useId=function(){return wr.current.useId()};Ue.useImperativeHandle=function(e,t,r){return wr.current.useImperativeHandle(e,t,r)};Ue.useInsertionEffect=function(e,t){return wr.current.useInsertionEffect(e,t)};Ue.useLayoutEffect=function(e,t){return wr.current.useLayoutEffect(e,t)};Ue.useMemo=function(e,t){return wr.current.useMemo(e,t)};Ue.useReducer=function(e,t,r){return wr.current.useReducer(e,t,r)};Ue.useRef=function(e){return wr.current.useRef(e)};Ue.useState=function(e){return wr.current.useState(e)};Ue.useSyncExternalStore=function(e,t,r){return wr.current.useSyncExternalStore(e,t,r)};Ue.useTransition=function(){return wr.current.useTransition()};Ue.version="18.3.1";Vv.exports=Ue;var V=Vv.exports;const ts=Xh(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s_=V,i_=Symbol.for("react.element"),o_=Symbol.for("react.fragment"),l_=Object.prototype.hasOwnProperty,c_=s_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u_={key:!0,ref:!0,__self:!0,__source:!0};function Jv(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)l_.call(t,n)&&!u_.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:i_,type:e,key:s,ref:i,props:a,_owner:c_.current}}S0.Fragment=o_;S0.jsx=Jv;S0.jsxs=Jv;zv.exports=S0;var u=zv.exports,bu={},Zv={exports:{}},Hr={},ey={exports:{}},ty={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,P){var Z=J.length;J.push(P);e:for(;0<Z;){var le=Z-1>>>1,R=J[le];if(0<a(R,P))J[le]=P,J[Z]=R,Z=le;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var P=J[0],Z=J.pop();if(Z!==P){J[0]=Z;e:for(var le=0,R=J.length,G=R>>>1;le<G;){var W=2*(le+1)-1,K=J[W],O=W+1,X=J[O];if(0>a(K,Z))O<R&&0>a(X,K)?(J[le]=X,J[O]=Z,le=O):(J[le]=K,J[W]=Z,le=W);else if(O<R&&0>a(X,Z))J[le]=X,J[O]=Z,le=O;else break e}}return P}function a(J,P){var Z=J.sortIndex-P.sortIndex;return Z!==0?Z:J.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],d=1,f=null,h=3,p=!1,x=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(J){for(var P=r(c);P!==null;){if(P.callback===null)n(c);else if(P.startTime<=J)n(c),P.sortIndex=P.expirationTime,t(l,P);else break;P=r(c)}}function S(J){if(m=!1,w(J),!x)if(r(l)!==null)x=!0,q(A);else{var P=r(c);P!==null&&Q(S,P.startTime-J)}}function A(J,P){x=!1,m&&(m=!1,g(k),k=-1),p=!0;var Z=h;try{for(w(P),f=r(l);f!==null&&(!(f.expirationTime>P)||J&&!C());){var le=f.callback;if(typeof le=="function"){f.callback=null,h=f.priorityLevel;var R=le(f.expirationTime<=P);P=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(l)&&n(l),w(P)}else n(l);f=r(l)}if(f!==null)var G=!0;else{var W=r(c);W!==null&&Q(S,W.startTime-P),G=!1}return G}finally{f=null,h=Z,p=!1}}var T=!1,b=null,k=-1,E=5,_=-1;function C(){return!(e.unstable_now()-_<E)}function F(){if(b!==null){var J=e.unstable_now();_=J;var P=!0;try{P=b(!0,J)}finally{P?D():(T=!1,b=null)}}else T=!1}var D;if(typeof y=="function")D=function(){y(F)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,B=M.port2;M.port1.onmessage=F,D=function(){B.postMessage(null)}}else D=function(){v(F,0)};function q(J){b=J,T||(T=!0,D())}function Q(J,P){k=v(function(){J(e.unstable_now())},P)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,q(A))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(J){switch(h){case 1:case 2:case 3:var P=3;break;default:P=h}var Z=h;h=P;try{return J()}finally{h=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,P){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var Z=h;h=J;try{return P()}finally{h=Z}},e.unstable_scheduleCallback=function(J,P,Z){var le=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?le+Z:le):Z=le,J){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=Z+R,J={id:d++,callback:P,priorityLevel:J,startTime:Z,expirationTime:R,sortIndex:-1},Z>le?(J.sortIndex=Z,t(c,J),r(l)===null&&J===r(c)&&(m?(g(k),k=-1):m=!0,Q(S,Z-le))):(J.sortIndex=R,t(l,J),x||p||(x=!0,q(A))),J},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(J){var P=h;return function(){var Z=h;h=P;try{return J.apply(this,arguments)}finally{h=Z}}}})(ty);ey.exports=ty;var d_=ey.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f_=V,$r=d_;function he(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ry=new Set,gl={};function ei(e,t){Xi(e,t),Xi(e+"Capture",t)}function Xi(e,t){for(gl[e]=t,e=0;e<t.length;e++)ry.add(t[e])}var oa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),af=Object.prototype.hasOwnProperty,h_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ex={},tx={};function m_(e){return af.call(tx,e)?!0:af.call(ex,e)?!1:h_.test(e)?tx[e]=!0:(ex[e]=!0,!1)}function p_(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function x_(e,t,r,n){if(t===null||typeof t>"u"||p_(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function kr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xt[e]=new kr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xt[t]=new kr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xt[e]=new kr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xt[e]=new kr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xt[e]=new kr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xt[e]=new kr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xt[e]=new kr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xt[e]=new kr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xt[e]=new kr(e,5,!1,e.toLowerCase(),null,!1,!1)});var em=/[\-:]([a-z])/g;function tm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(em,tm);Xt[t]=new kr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(em,tm);Xt[t]=new kr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(em,tm);Xt[t]=new kr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xt[e]=new kr(e,1,!1,e.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xt[e]=new kr(e,1,!1,e.toLowerCase(),null,!0,!0)});function rm(e,t,r,n){var a=Xt.hasOwnProperty(t)?Xt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(x_(t,r,a,n)&&(r=null),n||a===null?m_(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var pa=f_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tc=Symbol.for("react.element"),hi=Symbol.for("react.portal"),mi=Symbol.for("react.fragment"),nm=Symbol.for("react.strict_mode"),sf=Symbol.for("react.profiler"),ny=Symbol.for("react.provider"),ay=Symbol.for("react.context"),am=Symbol.for("react.forward_ref"),of=Symbol.for("react.suspense"),lf=Symbol.for("react.suspense_list"),sm=Symbol.for("react.memo"),ka=Symbol.for("react.lazy"),sy=Symbol.for("react.offscreen"),rx=Symbol.iterator;function bo(e){return e===null||typeof e!="object"?null:(e=rx&&e[rx]||e["@@iterator"],typeof e=="function"?e:null)}var mt=Object.assign,cd;function Mo(e){if(cd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);cd=t&&t[1]||""}return`
`+cd+e}var ud=!1;function dd(e,t){if(!e||ud)return"";ud=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{ud=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Mo(e):""}function g_(e){switch(e.tag){case 5:return Mo(e.type);case 16:return Mo("Lazy");case 13:return Mo("Suspense");case 19:return Mo("SuspenseList");case 0:case 2:case 15:return e=dd(e.type,!1),e;case 11:return e=dd(e.type.render,!1),e;case 1:return e=dd(e.type,!0),e;default:return""}}function cf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case mi:return"Fragment";case hi:return"Portal";case sf:return"Profiler";case nm:return"StrictMode";case of:return"Suspense";case lf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ay:return(e.displayName||"Context")+".Consumer";case ny:return(e._context.displayName||"Context")+".Provider";case am:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case sm:return t=e.displayName||null,t!==null?t:cf(e.type)||"Memo";case ka:t=e._payload,e=e._init;try{return cf(e(t))}catch{}}return null}function v_(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cf(t);case 8:return t===nm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function rs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function iy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function y_(e){var t=iy(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Cc(e){e._valueTracker||(e._valueTracker=y_(e))}function oy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=iy(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Tu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function uf(e,t){var r=t.checked;return mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function nx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=rs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ly(e,t){t=t.checked,t!=null&&rm(e,"checked",t,!1)}function df(e,t){ly(e,t);var r=rs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ff(e,t.type,r):t.hasOwnProperty("defaultValue")&&ff(e,t.type,rs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ax(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ff(e,t,r){(t!=="number"||Tu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Lo=Array.isArray;function Ti(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+rs(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function hf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(he(91));return mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function sx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(he(92));if(Lo(r)){if(1<r.length)throw Error(he(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:rs(r)}}function cy(e,t){var r=rs(t.value),n=rs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ix(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function uy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?uy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Nc,dy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Nc=Nc||document.createElement("div"),Nc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Nc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function vl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Yo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w_=["Webkit","ms","Moz","O"];Object.keys(Yo).forEach(function(e){w_.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Yo[t]=Yo[e]})});function fy(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Yo.hasOwnProperty(e)&&Yo[e]?(""+t).trim():t+"px"}function hy(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=fy(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var k_=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pf(e,t){if(t){if(k_[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(he(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(he(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(he(61))}if(t.style!=null&&typeof t.style!="object")throw Error(he(62))}}function xf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gf=null;function im(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vf=null,Ci=null,Ni=null;function ox(e){if(e=cc(e)){if(typeof vf!="function")throw Error(he(280));var t=e.stateNode;t&&(t=C0(t),vf(e.stateNode,e.type,t))}}function my(e){Ci?Ni?Ni.push(e):Ni=[e]:Ci=e}function py(){if(Ci){var e=Ci,t=Ni;if(Ni=Ci=null,ox(e),t)for(e=0;e<t.length;e++)ox(t[e])}}function xy(e,t){return e(t)}function gy(){}var fd=!1;function vy(e,t,r){if(fd)return e(t,r);fd=!0;try{return xy(e,t,r)}finally{fd=!1,(Ci!==null||Ni!==null)&&(gy(),py())}}function yl(e,t){var r=e.stateNode;if(r===null)return null;var n=C0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(he(231,t,typeof r));return r}var yf=!1;if(oa)try{var To={};Object.defineProperty(To,"passive",{get:function(){yf=!0}}),window.addEventListener("test",To,To),window.removeEventListener("test",To,To)}catch{yf=!1}function S_(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Xo=!1,Cu=null,Nu=!1,wf=null,E_={onError:function(e){Xo=!0,Cu=e}};function __(e,t,r,n,a,s,i,o,l){Xo=!1,Cu=null,S_.apply(E_,arguments)}function b_(e,t,r,n,a,s,i,o,l){if(__.apply(this,arguments),Xo){if(Xo){var c=Cu;Xo=!1,Cu=null}else throw Error(he(198));Nu||(Nu=!0,wf=c)}}function ti(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function yy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function lx(e){if(ti(e)!==e)throw Error(he(188))}function T_(e){var t=e.alternate;if(!t){if(t=ti(e),t===null)throw Error(he(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return lx(a),e;if(s===n)return lx(a),t;s=s.sibling}throw Error(he(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(he(189))}}if(r.alternate!==n)throw Error(he(190))}if(r.tag!==3)throw Error(he(188));return r.stateNode.current===r?e:t}function wy(e){return e=T_(e),e!==null?ky(e):null}function ky(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ky(e);if(t!==null)return t;e=e.sibling}return null}var Sy=$r.unstable_scheduleCallback,cx=$r.unstable_cancelCallback,C_=$r.unstable_shouldYield,N_=$r.unstable_requestPaint,kt=$r.unstable_now,A_=$r.unstable_getCurrentPriorityLevel,om=$r.unstable_ImmediatePriority,Ey=$r.unstable_UserBlockingPriority,Au=$r.unstable_NormalPriority,F_=$r.unstable_LowPriority,_y=$r.unstable_IdlePriority,E0=null,Bn=null;function P_(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(E0,e,void 0,(e.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:j_,R_=Math.log,D_=Math.LN2;function j_(e){return e>>>=0,e===0?32:31-(R_(e)/D_|0)|0}var Ac=64,Fc=4194304;function Bo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fu(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Bo(o):(s&=i,s!==0&&(n=Bo(s)))}else i=r&~a,i!==0?n=Bo(i):s!==0&&(n=Bo(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-wn(t),a=1<<r,n|=e[r],t&=~a;return n}function I_(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function O_(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-wn(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=I_(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function kf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function by(){var e=Ac;return Ac<<=1,!(Ac&4194240)&&(Ac=64),e}function hd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function oc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wn(t),e[t]=r}function M_(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-wn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function lm(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-wn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Qe=0;function Ty(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Cy,cm,Ny,Ay,Fy,Sf=!1,Pc=[],za=null,Va=null,Ha=null,wl=new Map,kl=new Map,_a=[],L_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ux(e,t){switch(e){case"focusin":case"focusout":za=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":wl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kl.delete(t.pointerId)}}function Co(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=cc(t),t!==null&&cm(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function B_(e,t,r,n,a){switch(t){case"focusin":return za=Co(za,e,t,r,n,a),!0;case"dragenter":return Va=Co(Va,e,t,r,n,a),!0;case"mouseover":return Ha=Co(Ha,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return wl.set(s,Co(wl.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,kl.set(s,Co(kl.get(s)||null,e,t,r,n,a)),!0}return!1}function Py(e){var t=ys(e.target);if(t!==null){var r=ti(t);if(r!==null){if(t=r.tag,t===13){if(t=yy(r),t!==null){e.blockedOn=t,Fy(e.priority,function(){Ny(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function lu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ef(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);gf=n,r.target.dispatchEvent(n),gf=null}else return t=cc(r),t!==null&&cm(t),e.blockedOn=r,!1;t.shift()}return!0}function dx(e,t,r){lu(e)&&r.delete(t)}function U_(){Sf=!1,za!==null&&lu(za)&&(za=null),Va!==null&&lu(Va)&&(Va=null),Ha!==null&&lu(Ha)&&(Ha=null),wl.forEach(dx),kl.forEach(dx)}function No(e,t){e.blockedOn===t&&(e.blockedOn=null,Sf||(Sf=!0,$r.unstable_scheduleCallback($r.unstable_NormalPriority,U_)))}function Sl(e){function t(a){return No(a,e)}if(0<Pc.length){No(Pc[0],e);for(var r=1;r<Pc.length;r++){var n=Pc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(za!==null&&No(za,e),Va!==null&&No(Va,e),Ha!==null&&No(Ha,e),wl.forEach(t),kl.forEach(t),r=0;r<_a.length;r++)n=_a[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<_a.length&&(r=_a[0],r.blockedOn===null);)Py(r),r.blockedOn===null&&_a.shift()}var Ai=pa.ReactCurrentBatchConfig,Pu=!0;function $_(e,t,r,n){var a=Qe,s=Ai.transition;Ai.transition=null;try{Qe=1,um(e,t,r,n)}finally{Qe=a,Ai.transition=s}}function z_(e,t,r,n){var a=Qe,s=Ai.transition;Ai.transition=null;try{Qe=4,um(e,t,r,n)}finally{Qe=a,Ai.transition=s}}function um(e,t,r,n){if(Pu){var a=Ef(e,t,r,n);if(a===null)Ed(e,t,n,Ru,r),ux(e,n);else if(B_(a,e,t,r,n))n.stopPropagation();else if(ux(e,n),t&4&&-1<L_.indexOf(e)){for(;a!==null;){var s=cc(a);if(s!==null&&Cy(s),s=Ef(e,t,r,n),s===null&&Ed(e,t,n,Ru,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Ed(e,t,n,null,r)}}var Ru=null;function Ef(e,t,r,n){if(Ru=null,e=im(n),e=ys(e),e!==null)if(t=ti(e),t===null)e=null;else if(r=t.tag,r===13){if(e=yy(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ru=e,null}function Ry(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(A_()){case om:return 1;case Ey:return 4;case Au:case F_:return 16;case _y:return 536870912;default:return 16}default:return 16}}var Oa=null,dm=null,cu=null;function Dy(){if(cu)return cu;var e,t=dm,r=t.length,n,a="value"in Oa?Oa.value:Oa.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return cu=a.slice(e,1<n?1-n:void 0)}function uu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Rc(){return!0}function fx(){return!1}function Wr(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Rc:fx,this.isPropagationStopped=fx,this}return mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Rc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Rc)},persist:function(){},isPersistent:Rc}),t}var fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fm=Wr(fo),lc=mt({},fo,{view:0,detail:0}),V_=Wr(lc),md,pd,Ao,_0=mt({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ao&&(Ao&&e.type==="mousemove"?(md=e.screenX-Ao.screenX,pd=e.screenY-Ao.screenY):pd=md=0,Ao=e),md)},movementY:function(e){return"movementY"in e?e.movementY:pd}}),hx=Wr(_0),H_=mt({},_0,{dataTransfer:0}),W_=Wr(H_),K_=mt({},lc,{relatedTarget:0}),xd=Wr(K_),G_=mt({},fo,{animationName:0,elapsedTime:0,pseudoElement:0}),Y_=Wr(G_),X_=mt({},fo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),q_=Wr(X_),Q_=mt({},fo,{data:0}),mx=Wr(Q_),J_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tb(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=eb[e])?!!t[e]:!1}function hm(){return tb}var rb=mt({},lc,{key:function(e){if(e.key){var t=J_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=uu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Z_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hm,charCode:function(e){return e.type==="keypress"?uu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?uu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nb=Wr(rb),ab=mt({},_0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),px=Wr(ab),sb=mt({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hm}),ib=Wr(sb),ob=mt({},fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),lb=Wr(ob),cb=mt({},_0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ub=Wr(cb),db=[9,13,27,32],mm=oa&&"CompositionEvent"in window,qo=null;oa&&"documentMode"in document&&(qo=document.documentMode);var fb=oa&&"TextEvent"in window&&!qo,jy=oa&&(!mm||qo&&8<qo&&11>=qo),xx=String.fromCharCode(32),gx=!1;function Iy(e,t){switch(e){case"keyup":return db.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oy(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pi=!1;function hb(e,t){switch(e){case"compositionend":return Oy(t);case"keypress":return t.which!==32?null:(gx=!0,xx);case"textInput":return e=t.data,e===xx&&gx?null:e;default:return null}}function mb(e,t){if(pi)return e==="compositionend"||!mm&&Iy(e,t)?(e=Dy(),cu=dm=Oa=null,pi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jy&&t.locale!=="ko"?null:t.data;default:return null}}var pb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!pb[e.type]:t==="textarea"}function My(e,t,r,n){my(n),t=Du(t,"onChange"),0<t.length&&(r=new fm("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Qo=null,El=null;function xb(e){Yy(e,0)}function b0(e){var t=vi(e);if(oy(t))return e}function gb(e,t){if(e==="change")return t}var Ly=!1;if(oa){var gd;if(oa){var vd="oninput"in document;if(!vd){var yx=document.createElement("div");yx.setAttribute("oninput","return;"),vd=typeof yx.oninput=="function"}gd=vd}else gd=!1;Ly=gd&&(!document.documentMode||9<document.documentMode)}function wx(){Qo&&(Qo.detachEvent("onpropertychange",By),El=Qo=null)}function By(e){if(e.propertyName==="value"&&b0(El)){var t=[];My(t,El,e,im(e)),vy(xb,t)}}function vb(e,t,r){e==="focusin"?(wx(),Qo=t,El=r,Qo.attachEvent("onpropertychange",By)):e==="focusout"&&wx()}function yb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return b0(El)}function wb(e,t){if(e==="click")return b0(t)}function kb(e,t){if(e==="input"||e==="change")return b0(t)}function Sb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _n=typeof Object.is=="function"?Object.is:Sb;function _l(e,t){if(_n(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!af.call(t,a)||!_n(e[a],t[a]))return!1}return!0}function kx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Sx(e,t){var r=kx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=kx(r)}}function Uy(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Uy(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $y(){for(var e=window,t=Tu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Tu(e.document)}return t}function pm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Eb(e){var t=$y(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Uy(r.ownerDocument.documentElement,r)){if(n!==null&&pm(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Sx(r,s);var i=Sx(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _b=oa&&"documentMode"in document&&11>=document.documentMode,xi=null,_f=null,Jo=null,bf=!1;function Ex(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;bf||xi==null||xi!==Tu(n)||(n=xi,"selectionStart"in n&&pm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Jo&&_l(Jo,n)||(Jo=n,n=Du(_f,"onSelect"),0<n.length&&(t=new fm("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=xi)))}function Dc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var gi={animationend:Dc("Animation","AnimationEnd"),animationiteration:Dc("Animation","AnimationIteration"),animationstart:Dc("Animation","AnimationStart"),transitionend:Dc("Transition","TransitionEnd")},yd={},zy={};oa&&(zy=document.createElement("div").style,"AnimationEvent"in window||(delete gi.animationend.animation,delete gi.animationiteration.animation,delete gi.animationstart.animation),"TransitionEvent"in window||delete gi.transitionend.transition);function T0(e){if(yd[e])return yd[e];if(!gi[e])return e;var t=gi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in zy)return yd[e]=t[r];return e}var Vy=T0("animationend"),Hy=T0("animationiteration"),Wy=T0("animationstart"),Ky=T0("transitionend"),Gy=new Map,_x="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function is(e,t){Gy.set(e,t),ei(t,[e])}for(var wd=0;wd<_x.length;wd++){var kd=_x[wd],bb=kd.toLowerCase(),Tb=kd[0].toUpperCase()+kd.slice(1);is(bb,"on"+Tb)}is(Vy,"onAnimationEnd");is(Hy,"onAnimationIteration");is(Wy,"onAnimationStart");is("dblclick","onDoubleClick");is("focusin","onFocus");is("focusout","onBlur");is(Ky,"onTransitionEnd");Xi("onMouseEnter",["mouseout","mouseover"]);Xi("onMouseLeave",["mouseout","mouseover"]);Xi("onPointerEnter",["pointerout","pointerover"]);Xi("onPointerLeave",["pointerout","pointerover"]);ei("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ei("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ei("onBeforeInput",["compositionend","keypress","textInput","paste"]);ei("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Uo));function bx(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,b_(n,t,void 0,e),e.currentTarget=null}function Yy(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;bx(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;bx(a,o,c),s=l}}}if(Nu)throw e=wf,Nu=!1,wf=null,e}function st(e,t){var r=t[Ff];r===void 0&&(r=t[Ff]=new Set);var n=e+"__bubble";r.has(n)||(Xy(t,e,2,!1),r.add(n))}function Sd(e,t,r){var n=0;t&&(n|=4),Xy(r,e,n,t)}var jc="_reactListening"+Math.random().toString(36).slice(2);function bl(e){if(!e[jc]){e[jc]=!0,ry.forEach(function(r){r!=="selectionchange"&&(Cb.has(r)||Sd(r,!1,e),Sd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[jc]||(t[jc]=!0,Sd("selectionchange",!1,t))}}function Xy(e,t,r,n){switch(Ry(t)){case 1:var a=$_;break;case 4:a=z_;break;default:a=um}r=a.bind(null,t,r,e),a=void 0,!yf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Ed(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ys(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}vy(function(){var c=s,d=im(r),f=[];e:{var h=Gy.get(e);if(h!==void 0){var p=fm,x=e;switch(e){case"keypress":if(uu(r)===0)break e;case"keydown":case"keyup":p=nb;break;case"focusin":x="focus",p=xd;break;case"focusout":x="blur",p=xd;break;case"beforeblur":case"afterblur":p=xd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=hx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=W_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ib;break;case Vy:case Hy:case Wy:p=Y_;break;case Ky:p=lb;break;case"scroll":p=V_;break;case"wheel":p=ub;break;case"copy":case"cut":case"paste":p=q_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=px}var m=(t&4)!==0,v=!m&&e==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,w;y!==null;){w=y;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,g!==null&&(S=yl(y,g),S!=null&&m.push(Tl(y,S,w)))),v)break;y=y.return}0<m.length&&(h=new p(h,x,null,r,d),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==gf&&(x=r.relatedTarget||r.fromElement)&&(ys(x)||x[la]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?ys(x):null,x!==null&&(v=ti(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(m=hx,S="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=px,S="onPointerLeave",g="onPointerEnter",y="pointer"),v=p==null?h:vi(p),w=x==null?h:vi(x),h=new m(S,y+"leave",p,r,d),h.target=v,h.relatedTarget=w,S=null,ys(d)===c&&(m=new m(g,y+"enter",x,r,d),m.target=w,m.relatedTarget=v,S=m),v=S,p&&x)t:{for(m=p,g=x,y=0,w=m;w;w=ci(w))y++;for(w=0,S=g;S;S=ci(S))w++;for(;0<y-w;)m=ci(m),y--;for(;0<w-y;)g=ci(g),w--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=ci(m),g=ci(g)}m=null}else m=null;p!==null&&Tx(f,h,p,m,!1),x!==null&&v!==null&&Tx(f,v,x,m,!0)}}e:{if(h=c?vi(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var A=gb;else if(vx(h))if(Ly)A=kb;else{A=yb;var T=vb}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(A=wb);if(A&&(A=A(e,c))){My(f,A,r,d);break e}T&&T(e,h,c),e==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&ff(h,"number",h.value)}switch(T=c?vi(c):window,e){case"focusin":(vx(T)||T.contentEditable==="true")&&(xi=T,_f=c,Jo=null);break;case"focusout":Jo=_f=xi=null;break;case"mousedown":bf=!0;break;case"contextmenu":case"mouseup":case"dragend":bf=!1,Ex(f,r,d);break;case"selectionchange":if(_b)break;case"keydown":case"keyup":Ex(f,r,d)}var b;if(mm)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else pi?Iy(e,r)&&(k="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(jy&&r.locale!=="ko"&&(pi||k!=="onCompositionStart"?k==="onCompositionEnd"&&pi&&(b=Dy()):(Oa=d,dm="value"in Oa?Oa.value:Oa.textContent,pi=!0)),T=Du(c,k),0<T.length&&(k=new mx(k,e,null,r,d),f.push({event:k,listeners:T}),b?k.data=b:(b=Oy(r),b!==null&&(k.data=b)))),(b=fb?hb(e,r):mb(e,r))&&(c=Du(c,"onBeforeInput"),0<c.length&&(d=new mx("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:c}),d.data=b))}Yy(f,t)})}function Tl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Du(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=yl(e,r),s!=null&&n.unshift(Tl(e,s,a)),s=yl(e,t),s!=null&&n.push(Tl(e,s,a))),e=e.return}return n}function ci(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Tx(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=yl(r,s),l!=null&&i.unshift(Tl(r,l,o))):a||(l=yl(r,s),l!=null&&i.push(Tl(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Nb=/\r\n?/g,Ab=/\u0000|\uFFFD/g;function Cx(e){return(typeof e=="string"?e:""+e).replace(Nb,`
`).replace(Ab,"")}function Ic(e,t,r){if(t=Cx(t),Cx(e)!==t&&r)throw Error(he(425))}function ju(){}var Tf=null,Cf=null;function Nf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Af=typeof setTimeout=="function"?setTimeout:void 0,Fb=typeof clearTimeout=="function"?clearTimeout:void 0,Nx=typeof Promise=="function"?Promise:void 0,Pb=typeof queueMicrotask=="function"?queueMicrotask:typeof Nx<"u"?function(e){return Nx.resolve(null).then(e).catch(Rb)}:Af;function Rb(e){setTimeout(function(){throw e})}function _d(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Sl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Sl(t)}function Wa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ax(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),In="__reactFiber$"+ho,Cl="__reactProps$"+ho,la="__reactContainer$"+ho,Ff="__reactEvents$"+ho,Db="__reactListeners$"+ho,jb="__reactHandles$"+ho;function ys(e){var t=e[In];if(t)return t;for(var r=e.parentNode;r;){if(t=r[la]||r[In]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ax(e);e!==null;){if(r=e[In])return r;e=Ax(e)}return t}e=r,r=e.parentNode}return null}function cc(e){return e=e[In]||e[la],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function vi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(he(33))}function C0(e){return e[Cl]||null}var Pf=[],yi=-1;function os(e){return{current:e}}function it(e){0>yi||(e.current=Pf[yi],Pf[yi]=null,yi--)}function et(e,t){yi++,Pf[yi]=e.current,e.current=t}var ns={},or=os(ns),Ar=os(!1),Vs=ns;function qi(e,t){var r=e.type.contextTypes;if(!r)return ns;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Fr(e){return e=e.childContextTypes,e!=null}function Iu(){it(Ar),it(or)}function Fx(e,t,r){if(or.current!==ns)throw Error(he(168));et(or,t),et(Ar,r)}function qy(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(he(108,v_(e)||"Unknown",a));return mt({},r,n)}function Ou(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ns,Vs=or.current,et(or,e),et(Ar,Ar.current),!0}function Px(e,t,r){var n=e.stateNode;if(!n)throw Error(he(169));r?(e=qy(e,t,Vs),n.__reactInternalMemoizedMergedChildContext=e,it(Ar),it(or),et(or,e)):it(Ar),et(Ar,r)}var Qn=null,N0=!1,bd=!1;function Qy(e){Qn===null?Qn=[e]:Qn.push(e)}function Ib(e){N0=!0,Qy(e)}function ls(){if(!bd&&Qn!==null){bd=!0;var e=0,t=Qe;try{var r=Qn;for(Qe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Qn=null,N0=!1}catch(a){throw Qn!==null&&(Qn=Qn.slice(e+1)),Sy(om,ls),a}finally{Qe=t,bd=!1}}return null}var wi=[],ki=0,Mu=null,Lu=0,en=[],tn=0,Hs=null,ea=1,ta="";function hs(e,t){wi[ki++]=Lu,wi[ki++]=Mu,Mu=e,Lu=t}function Jy(e,t,r){en[tn++]=ea,en[tn++]=ta,en[tn++]=Hs,Hs=e;var n=ea;e=ta;var a=32-wn(n)-1;n&=~(1<<a),r+=1;var s=32-wn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ea=1<<32-wn(t)+a|r<<a|n,ta=s+e}else ea=1<<s|r<<a|n,ta=e}function xm(e){e.return!==null&&(hs(e,1),Jy(e,1,0))}function gm(e){for(;e===Mu;)Mu=wi[--ki],wi[ki]=null,Lu=wi[--ki],wi[ki]=null;for(;e===Hs;)Hs=en[--tn],en[tn]=null,ta=en[--tn],en[tn]=null,ea=en[--tn],en[tn]=null}var Ur=null,Br=null,lt=!1,xn=null;function Zy(e,t){var r=rn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Rx(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ur=e,Br=Wa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ur=e,Br=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Hs!==null?{id:ea,overflow:ta}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=rn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ur=e,Br=null,!0):!1;default:return!1}}function Rf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Df(e){if(lt){var t=Br;if(t){var r=t;if(!Rx(e,t)){if(Rf(e))throw Error(he(418));t=Wa(r.nextSibling);var n=Ur;t&&Rx(e,t)?Zy(n,r):(e.flags=e.flags&-4097|2,lt=!1,Ur=e)}}else{if(Rf(e))throw Error(he(418));e.flags=e.flags&-4097|2,lt=!1,Ur=e}}}function Dx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ur=e}function Oc(e){if(e!==Ur)return!1;if(!lt)return Dx(e),lt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nf(e.type,e.memoizedProps)),t&&(t=Br)){if(Rf(e))throw e2(),Error(he(418));for(;t;)Zy(e,t),t=Wa(t.nextSibling)}if(Dx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(he(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Br=Wa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Br=null}}else Br=Ur?Wa(e.stateNode.nextSibling):null;return!0}function e2(){for(var e=Br;e;)e=Wa(e.nextSibling)}function Qi(){Br=Ur=null,lt=!1}function vm(e){xn===null?xn=[e]:xn.push(e)}var Ob=pa.ReactCurrentBatchConfig;function Fo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(he(309));var n=r.stateNode}if(!n)throw Error(he(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(he(284));if(!r._owner)throw Error(he(290,e))}return e}function Mc(e,t){throw e=Object.prototype.toString.call(t),Error(he(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function jx(e){var t=e._init;return t(e._payload)}function t2(e){function t(g,y){if(e){var w=g.deletions;w===null?(g.deletions=[y],g.flags|=16):w.push(y)}}function r(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function a(g,y){return g=Xa(g,y),g.index=0,g.sibling=null,g}function s(g,y,w){return g.index=w,e?(w=g.alternate,w!==null?(w=w.index,w<y?(g.flags|=2,y):w):(g.flags|=2,y)):(g.flags|=1048576,y)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,y,w,S){return y===null||y.tag!==6?(y=Rd(w,g.mode,S),y.return=g,y):(y=a(y,w),y.return=g,y)}function l(g,y,w,S){var A=w.type;return A===mi?d(g,y,w.props.children,S,w.key):y!==null&&(y.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===ka&&jx(A)===y.type)?(S=a(y,w.props),S.ref=Fo(g,y,w),S.return=g,S):(S=gu(w.type,w.key,w.props,null,g.mode,S),S.ref=Fo(g,y,w),S.return=g,S)}function c(g,y,w,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=Dd(w,g.mode,S),y.return=g,y):(y=a(y,w.children||[]),y.return=g,y)}function d(g,y,w,S,A){return y===null||y.tag!==7?(y=Os(w,g.mode,S,A),y.return=g,y):(y=a(y,w),y.return=g,y)}function f(g,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Rd(""+y,g.mode,w),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Tc:return w=gu(y.type,y.key,y.props,null,g.mode,w),w.ref=Fo(g,null,y),w.return=g,w;case hi:return y=Dd(y,g.mode,w),y.return=g,y;case ka:var S=y._init;return f(g,S(y._payload),w)}if(Lo(y)||bo(y))return y=Os(y,g.mode,w,null),y.return=g,y;Mc(g,y)}return null}function h(g,y,w,S){var A=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return A!==null?null:o(g,y,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Tc:return w.key===A?l(g,y,w,S):null;case hi:return w.key===A?c(g,y,w,S):null;case ka:return A=w._init,h(g,y,A(w._payload),S)}if(Lo(w)||bo(w))return A!==null?null:d(g,y,w,S,null);Mc(g,w)}return null}function p(g,y,w,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(w)||null,o(y,g,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Tc:return g=g.get(S.key===null?w:S.key)||null,l(y,g,S,A);case hi:return g=g.get(S.key===null?w:S.key)||null,c(y,g,S,A);case ka:var T=S._init;return p(g,y,w,T(S._payload),A)}if(Lo(S)||bo(S))return g=g.get(w)||null,d(y,g,S,A,null);Mc(y,S)}return null}function x(g,y,w,S){for(var A=null,T=null,b=y,k=y=0,E=null;b!==null&&k<w.length;k++){b.index>k?(E=b,b=null):E=b.sibling;var _=h(g,b,w[k],S);if(_===null){b===null&&(b=E);break}e&&b&&_.alternate===null&&t(g,b),y=s(_,y,k),T===null?A=_:T.sibling=_,T=_,b=E}if(k===w.length)return r(g,b),lt&&hs(g,k),A;if(b===null){for(;k<w.length;k++)b=f(g,w[k],S),b!==null&&(y=s(b,y,k),T===null?A=b:T.sibling=b,T=b);return lt&&hs(g,k),A}for(b=n(g,b);k<w.length;k++)E=p(b,g,k,w[k],S),E!==null&&(e&&E.alternate!==null&&b.delete(E.key===null?k:E.key),y=s(E,y,k),T===null?A=E:T.sibling=E,T=E);return e&&b.forEach(function(C){return t(g,C)}),lt&&hs(g,k),A}function m(g,y,w,S){var A=bo(w);if(typeof A!="function")throw Error(he(150));if(w=A.call(w),w==null)throw Error(he(151));for(var T=A=null,b=y,k=y=0,E=null,_=w.next();b!==null&&!_.done;k++,_=w.next()){b.index>k?(E=b,b=null):E=b.sibling;var C=h(g,b,_.value,S);if(C===null){b===null&&(b=E);break}e&&b&&C.alternate===null&&t(g,b),y=s(C,y,k),T===null?A=C:T.sibling=C,T=C,b=E}if(_.done)return r(g,b),lt&&hs(g,k),A;if(b===null){for(;!_.done;k++,_=w.next())_=f(g,_.value,S),_!==null&&(y=s(_,y,k),T===null?A=_:T.sibling=_,T=_);return lt&&hs(g,k),A}for(b=n(g,b);!_.done;k++,_=w.next())_=p(b,g,k,_.value,S),_!==null&&(e&&_.alternate!==null&&b.delete(_.key===null?k:_.key),y=s(_,y,k),T===null?A=_:T.sibling=_,T=_);return e&&b.forEach(function(F){return t(g,F)}),lt&&hs(g,k),A}function v(g,y,w,S){if(typeof w=="object"&&w!==null&&w.type===mi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Tc:e:{for(var A=w.key,T=y;T!==null;){if(T.key===A){if(A=w.type,A===mi){if(T.tag===7){r(g,T.sibling),y=a(T,w.props.children),y.return=g,g=y;break e}}else if(T.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===ka&&jx(A)===T.type){r(g,T.sibling),y=a(T,w.props),y.ref=Fo(g,T,w),y.return=g,g=y;break e}r(g,T);break}else t(g,T);T=T.sibling}w.type===mi?(y=Os(w.props.children,g.mode,S,w.key),y.return=g,g=y):(S=gu(w.type,w.key,w.props,null,g.mode,S),S.ref=Fo(g,y,w),S.return=g,g=S)}return i(g);case hi:e:{for(T=w.key;y!==null;){if(y.key===T)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){r(g,y.sibling),y=a(y,w.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else t(g,y);y=y.sibling}y=Dd(w,g.mode,S),y.return=g,g=y}return i(g);case ka:return T=w._init,v(g,y,T(w._payload),S)}if(Lo(w))return x(g,y,w,S);if(bo(w))return m(g,y,w,S);Mc(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(r(g,y.sibling),y=a(y,w),y.return=g,g=y):(r(g,y),y=Rd(w,g.mode,S),y.return=g,g=y),i(g)):r(g,y)}return v}var Ji=t2(!0),r2=t2(!1),Bu=os(null),Uu=null,Si=null,ym=null;function wm(){ym=Si=Uu=null}function km(e){var t=Bu.current;it(Bu),e._currentValue=t}function jf(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Fi(e,t){Uu=e,ym=Si=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Nr=!0),e.firstContext=null)}function an(e){var t=e._currentValue;if(ym!==e)if(e={context:e,memoizedValue:t,next:null},Si===null){if(Uu===null)throw Error(he(308));Si=e,Uu.dependencies={lanes:0,firstContext:e}}else Si=Si.next=e;return t}var ws=null;function Sm(e){ws===null?ws=[e]:ws.push(e)}function n2(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Sm(t)):(r.next=a.next,a.next=r),t.interleaved=r,ca(e,n)}function ca(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Sa=!1;function Em(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function a2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function na(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ka(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ge&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ca(e,r)}return a=n.interleaved,a===null?(t.next=t,Sm(n)):(t.next=a.next,a.next=t),n.interleaved=t,ca(e,r)}function du(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lm(e,r)}}function Ix(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function $u(e,t,r,n){var a=e.updateQueue;Sa=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var f=a.baseState;i=0,d=c=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,m=o;switch(h=t,p=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){f=x.call(p,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,h=typeof x=="function"?x.call(p,f,h):x,h==null)break e;f=mt({},f,h);break e;case 2:Sa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=p,l=f):d=d.next=p,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(1);if(d===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Ks|=i,e.lanes=i,e.memoizedState=f}}function Ox(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(he(191,a));a.call(n)}}}var uc={},Un=os(uc),Nl=os(uc),Al=os(uc);function ks(e){if(e===uc)throw Error(he(174));return e}function _m(e,t){switch(et(Al,t),et(Nl,e),et(Un,uc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:mf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=mf(t,e)}it(Un),et(Un,t)}function Zi(){it(Un),it(Nl),it(Al)}function s2(e){ks(Al.current);var t=ks(Un.current),r=mf(t,e.type);t!==r&&(et(Nl,e),et(Un,r))}function bm(e){Nl.current===e&&(it(Un),it(Nl))}var ft=os(0);function zu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Td=[];function Tm(){for(var e=0;e<Td.length;e++)Td[e]._workInProgressVersionPrimary=null;Td.length=0}var fu=pa.ReactCurrentDispatcher,Cd=pa.ReactCurrentBatchConfig,Ws=0,ht=null,Rt=null,Bt=null,Vu=!1,Zo=!1,Fl=0,Mb=0;function Qt(){throw Error(he(321))}function Cm(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!_n(e[r],t[r]))return!1;return!0}function Nm(e,t,r,n,a,s){if(Ws=s,ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fu.current=e===null||e.memoizedState===null?$b:zb,e=r(n,a),Zo){s=0;do{if(Zo=!1,Fl=0,25<=s)throw Error(he(301));s+=1,Bt=Rt=null,t.updateQueue=null,fu.current=Vb,e=r(n,a)}while(Zo)}if(fu.current=Hu,t=Rt!==null&&Rt.next!==null,Ws=0,Bt=Rt=ht=null,Vu=!1,t)throw Error(he(300));return e}function Am(){var e=Fl!==0;return Fl=0,e}function Pn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?ht.memoizedState=Bt=e:Bt=Bt.next=e,Bt}function sn(){if(Rt===null){var e=ht.alternate;e=e!==null?e.memoizedState:null}else e=Rt.next;var t=Bt===null?ht.memoizedState:Bt.next;if(t!==null)Bt=t,Rt=e;else{if(e===null)throw Error(he(310));Rt=e,e={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},Bt===null?ht.memoizedState=Bt=e:Bt=Bt.next=e}return Bt}function Pl(e,t){return typeof t=="function"?t(e):t}function Nd(e){var t=sn(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=Rt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var d=c.lane;if((Ws&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,i=n):l=l.next=f,ht.lanes|=d,Ks|=d}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,_n(n,t.memoizedState)||(Nr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,ht.lanes|=s,Ks|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ad(e){var t=sn(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);_n(s,t.memoizedState)||(Nr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function i2(){}function o2(e,t){var r=ht,n=sn(),a=t(),s=!_n(n.memoizedState,a);if(s&&(n.memoizedState=a,Nr=!0),n=n.queue,Fm(u2.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Bt!==null&&Bt.memoizedState.tag&1){if(r.flags|=2048,Rl(9,c2.bind(null,r,n,a,t),void 0,null),Ut===null)throw Error(he(349));Ws&30||l2(r,t,a)}return a}function l2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function c2(e,t,r,n){t.value=r,t.getSnapshot=n,d2(t)&&f2(e)}function u2(e,t,r){return r(function(){d2(t)&&f2(e)})}function d2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_n(e,r)}catch{return!0}}function f2(e){var t=ca(e,1);t!==null&&kn(t,e,1,-1)}function Mx(e){var t=Pn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pl,lastRenderedState:e},t.queue=e,e=e.dispatch=Ub.bind(null,ht,e),[t.memoizedState,e]}function Rl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function h2(){return sn().memoizedState}function hu(e,t,r,n){var a=Pn();ht.flags|=e,a.memoizedState=Rl(1|t,r,void 0,n===void 0?null:n)}function A0(e,t,r,n){var a=sn();n=n===void 0?null:n;var s=void 0;if(Rt!==null){var i=Rt.memoizedState;if(s=i.destroy,n!==null&&Cm(n,i.deps)){a.memoizedState=Rl(t,r,s,n);return}}ht.flags|=e,a.memoizedState=Rl(1|t,r,s,n)}function Lx(e,t){return hu(8390656,8,e,t)}function Fm(e,t){return A0(2048,8,e,t)}function m2(e,t){return A0(4,2,e,t)}function p2(e,t){return A0(4,4,e,t)}function x2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function g2(e,t,r){return r=r!=null?r.concat([e]):null,A0(4,4,x2.bind(null,t,e),r)}function Pm(){}function v2(e,t){var r=sn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Cm(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function y2(e,t){var r=sn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Cm(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function w2(e,t,r){return Ws&21?(_n(r,t)||(r=by(),ht.lanes|=r,Ks|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Nr=!0),e.memoizedState=r)}function Lb(e,t){var r=Qe;Qe=r!==0&&4>r?r:4,e(!0);var n=Cd.transition;Cd.transition={};try{e(!1),t()}finally{Qe=r,Cd.transition=n}}function k2(){return sn().memoizedState}function Bb(e,t,r){var n=Ya(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},S2(e))E2(t,r);else if(r=n2(e,t,r,n),r!==null){var a=gr();kn(r,e,n,a),_2(r,t,n)}}function Ub(e,t,r){var n=Ya(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(S2(e))E2(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,_n(o,i)){var l=t.interleaved;l===null?(a.next=a,Sm(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=n2(e,t,a,n),r!==null&&(a=gr(),kn(r,e,n,a),_2(r,t,n))}}function S2(e){var t=e.alternate;return e===ht||t!==null&&t===ht}function E2(e,t){Zo=Vu=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lm(e,r)}}var Hu={readContext:an,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useInsertionEffect:Qt,useLayoutEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useMutableSource:Qt,useSyncExternalStore:Qt,useId:Qt,unstable_isNewReconciler:!1},$b={readContext:an,useCallback:function(e,t){return Pn().memoizedState=[e,t===void 0?null:t],e},useContext:an,useEffect:Lx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,hu(4194308,4,x2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return hu(4194308,4,e,t)},useInsertionEffect:function(e,t){return hu(4,2,e,t)},useMemo:function(e,t){var r=Pn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Pn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Bb.bind(null,ht,e),[n.memoizedState,e]},useRef:function(e){var t=Pn();return e={current:e},t.memoizedState=e},useState:Mx,useDebugValue:Pm,useDeferredValue:function(e){return Pn().memoizedState=e},useTransition:function(){var e=Mx(!1),t=e[0];return e=Lb.bind(null,e[1]),Pn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ht,a=Pn();if(lt){if(r===void 0)throw Error(he(407));r=r()}else{if(r=t(),Ut===null)throw Error(he(349));Ws&30||l2(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Lx(u2.bind(null,n,s,e),[e]),n.flags|=2048,Rl(9,c2.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Pn(),t=Ut.identifierPrefix;if(lt){var r=ta,n=ea;r=(n&~(1<<32-wn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Fl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Mb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},zb={readContext:an,useCallback:v2,useContext:an,useEffect:Fm,useImperativeHandle:g2,useInsertionEffect:m2,useLayoutEffect:p2,useMemo:y2,useReducer:Nd,useRef:h2,useState:function(){return Nd(Pl)},useDebugValue:Pm,useDeferredValue:function(e){var t=sn();return w2(t,Rt.memoizedState,e)},useTransition:function(){var e=Nd(Pl)[0],t=sn().memoizedState;return[e,t]},useMutableSource:i2,useSyncExternalStore:o2,useId:k2,unstable_isNewReconciler:!1},Vb={readContext:an,useCallback:v2,useContext:an,useEffect:Fm,useImperativeHandle:g2,useInsertionEffect:m2,useLayoutEffect:p2,useMemo:y2,useReducer:Ad,useRef:h2,useState:function(){return Ad(Pl)},useDebugValue:Pm,useDeferredValue:function(e){var t=sn();return Rt===null?t.memoizedState=e:w2(t,Rt.memoizedState,e)},useTransition:function(){var e=Ad(Pl)[0],t=sn().memoizedState;return[e,t]},useMutableSource:i2,useSyncExternalStore:o2,useId:k2,unstable_isNewReconciler:!1};function fn(e,t){if(e&&e.defaultProps){t=mt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function If(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:mt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var F0={isMounted:function(e){return(e=e._reactInternals)?ti(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=gr(),a=Ya(e),s=na(n,a);s.payload=t,r!=null&&(s.callback=r),t=Ka(e,s,a),t!==null&&(kn(t,e,a,n),du(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=gr(),a=Ya(e),s=na(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ka(e,s,a),t!==null&&(kn(t,e,a,n),du(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=gr(),n=Ya(e),a=na(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ka(e,a,n),t!==null&&(kn(t,e,n,r),du(t,e,n))}};function Bx(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!_l(r,n)||!_l(a,s):!0}function b2(e,t,r){var n=!1,a=ns,s=t.contextType;return typeof s=="object"&&s!==null?s=an(s):(a=Fr(t)?Vs:or.current,n=t.contextTypes,s=(n=n!=null)?qi(e,a):ns),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=F0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ux(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&F0.enqueueReplaceState(t,t.state,null)}function Of(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Em(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=an(s):(s=Fr(t)?Vs:or.current,a.context=qi(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(If(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&F0.enqueueReplaceState(a,a.state,null),$u(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function eo(e,t){try{var r="",n=t;do r+=g_(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Fd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Mf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Hb=typeof WeakMap=="function"?WeakMap:Map;function T2(e,t,r){r=na(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ku||(Ku=!0,Gf=n),Mf(e,t)},r}function C2(e,t,r){r=na(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Mf(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Mf(e,t),typeof n!="function"&&(Ga===null?Ga=new Set([this]):Ga.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function $x(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Hb;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=a4.bind(null,e,t,r),t.then(e,e))}function zx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Vx(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=na(-1,1),t.tag=2,Ka(r,t,1))),r.lanes|=1),e)}var Wb=pa.ReactCurrentOwner,Nr=!1;function fr(e,t,r,n){t.child=e===null?r2(t,null,r,n):Ji(t,e.child,r,n)}function Hx(e,t,r,n,a){r=r.render;var s=t.ref;return Fi(t,a),n=Nm(e,t,r,n,s,a),r=Am(),e!==null&&!Nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ua(e,t,a)):(lt&&r&&xm(t),t.flags|=1,fr(e,t,n,a),t.child)}function Wx(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Bm(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,N2(e,t,s,n,a)):(e=gu(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:_l,r(i,n)&&e.ref===t.ref)return ua(e,t,a)}return t.flags|=1,e=Xa(s,n),e.ref=t.ref,e.return=t,t.child=e}function N2(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(_l(s,n)&&e.ref===t.ref)if(Nr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Nr=!0);else return t.lanes=e.lanes,ua(e,t,a)}return Lf(e,t,r,n,a)}function A2(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},et(_i,jr),jr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,et(_i,jr),jr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,et(_i,jr),jr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,et(_i,jr),jr|=n;return fr(e,t,a,r),t.child}function F2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Lf(e,t,r,n,a){var s=Fr(r)?Vs:or.current;return s=qi(t,s),Fi(t,a),r=Nm(e,t,r,n,s,a),n=Am(),e!==null&&!Nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ua(e,t,a)):(lt&&n&&xm(t),t.flags|=1,fr(e,t,r,a),t.child)}function Kx(e,t,r,n,a){if(Fr(r)){var s=!0;Ou(t)}else s=!1;if(Fi(t,a),t.stateNode===null)mu(e,t),b2(t,r,n),Of(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=an(c):(c=Fr(r)?Vs:or.current,c=qi(t,c));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Ux(t,i,n,c),Sa=!1;var h=t.memoizedState;i.state=h,$u(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Ar.current||Sa?(typeof d=="function"&&(If(t,r,d,n),l=t.memoizedState),(o=Sa||Bx(t,r,o,n,h,l,c))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,a2(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:fn(t.type,o),i.props=c,f=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=an(l):(l=Fr(r)?Vs:or.current,l=qi(t,l));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||h!==l)&&Ux(t,i,n,l),Sa=!1,h=t.memoizedState,i.state=h,$u(t,n,i,a);var x=t.memoizedState;o!==f||h!==x||Ar.current||Sa?(typeof p=="function"&&(If(t,r,p,n),x=t.memoizedState),(c=Sa||Bx(t,r,c,n,h,x,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Bf(e,t,r,n,s,a)}function Bf(e,t,r,n,a,s){F2(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Px(t,r,!1),ua(e,t,s);n=t.stateNode,Wb.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Ji(t,e.child,null,s),t.child=Ji(t,null,o,s)):fr(e,t,o,s),t.memoizedState=n.state,a&&Px(t,r,!0),t.child}function P2(e){var t=e.stateNode;t.pendingContext?Fx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Fx(e,t.context,!1),_m(e,t.containerInfo)}function Gx(e,t,r,n,a){return Qi(),vm(a),t.flags|=256,fr(e,t,r,n),t.child}var Uf={dehydrated:null,treeContext:null,retryLane:0};function $f(e){return{baseLanes:e,cachePool:null,transitions:null}}function R2(e,t,r){var n=t.pendingProps,a=ft.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),et(ft,a&1),e===null)return Df(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=D0(i,n,0,null),e=Os(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=$f(r),t.memoizedState=Uf,e):Rm(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Kb(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Xa(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Xa(o,s):(s=Os(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?$f(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Uf,n}return s=e.child,e=s.sibling,n=Xa(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Rm(e,t){return t=D0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Lc(e,t,r,n){return n!==null&&vm(n),Ji(t,e.child,null,r),e=Rm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Kb(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Fd(Error(he(422))),Lc(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=D0({mode:"visible",children:n.children},a,0,null),s=Os(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ji(t,e.child,null,i),t.child.memoizedState=$f(i),t.memoizedState=Uf,s);if(!(t.mode&1))return Lc(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(he(419)),n=Fd(s,n,void 0),Lc(e,t,i,n)}if(o=(i&e.childLanes)!==0,Nr||o){if(n=Ut,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ca(e,a),kn(n,e,a,-1))}return Lm(),n=Fd(Error(he(421))),Lc(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=s4.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Br=Wa(a.nextSibling),Ur=t,lt=!0,xn=null,e!==null&&(en[tn++]=ea,en[tn++]=ta,en[tn++]=Hs,ea=e.id,ta=e.overflow,Hs=t),t=Rm(t,n.children),t.flags|=4096,t)}function Yx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),jf(e.return,t,r)}function Pd(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function D2(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(fr(e,t,n.children,r),n=ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Yx(e,r,t);else if(e.tag===19)Yx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(et(ft,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&zu(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Pd(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&zu(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Pd(t,!0,r,null,s);break;case"together":Pd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function mu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ua(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ks|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(he(153));if(t.child!==null){for(e=t.child,r=Xa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Xa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Gb(e,t,r){switch(t.tag){case 3:P2(t),Qi();break;case 5:s2(t);break;case 1:Fr(t.type)&&Ou(t);break;case 4:_m(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;et(Bu,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(et(ft,ft.current&1),t.flags|=128,null):r&t.child.childLanes?R2(e,t,r):(et(ft,ft.current&1),e=ua(e,t,r),e!==null?e.sibling:null);et(ft,ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return D2(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),et(ft,ft.current),n)break;return null;case 22:case 23:return t.lanes=0,A2(e,t,r)}return ua(e,t,r)}var j2,zf,I2,O2;j2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zf=function(){};I2=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ks(Un.current);var s=null;switch(r){case"input":a=uf(e,a),n=uf(e,n),s=[];break;case"select":a=mt({},a,{value:void 0}),n=mt({},n,{value:void 0}),s=[];break;case"textarea":a=hf(e,a),n=hf(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=ju)}pf(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(gl.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(gl.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&st("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};O2=function(e,t,r,n){r!==n&&(t.flags|=4)};function Po(e,t){if(!lt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Yb(e,t,r){var n=t.pendingProps;switch(gm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(t),null;case 1:return Fr(t.type)&&Iu(),Jt(t),null;case 3:return n=t.stateNode,Zi(),it(Ar),it(or),Tm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Oc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xn!==null&&(qf(xn),xn=null))),zf(e,t),Jt(t),null;case 5:bm(t);var a=ks(Al.current);if(r=t.type,e!==null&&t.stateNode!=null)I2(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(he(166));return Jt(t),null}if(e=ks(Un.current),Oc(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[In]=t,n[Cl]=s,e=(t.mode&1)!==0,r){case"dialog":st("cancel",n),st("close",n);break;case"iframe":case"object":case"embed":st("load",n);break;case"video":case"audio":for(a=0;a<Uo.length;a++)st(Uo[a],n);break;case"source":st("error",n);break;case"img":case"image":case"link":st("error",n),st("load",n);break;case"details":st("toggle",n);break;case"input":nx(n,s),st("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},st("invalid",n);break;case"textarea":sx(n,s),st("invalid",n)}pf(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ic(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ic(n.textContent,o,e),a=["children",""+o]):gl.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&st("scroll",n)}switch(r){case"input":Cc(n),ax(n,s,!0);break;case"textarea":Cc(n),ix(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ju)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=uy(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[In]=t,e[Cl]=n,j2(e,t,!1,!1),t.stateNode=e;e:{switch(i=xf(r,n),r){case"dialog":st("cancel",e),st("close",e),a=n;break;case"iframe":case"object":case"embed":st("load",e),a=n;break;case"video":case"audio":for(a=0;a<Uo.length;a++)st(Uo[a],e);a=n;break;case"source":st("error",e),a=n;break;case"img":case"image":case"link":st("error",e),st("load",e),a=n;break;case"details":st("toggle",e),a=n;break;case"input":nx(e,n),a=uf(e,n),st("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=mt({},n,{value:void 0}),st("invalid",e);break;case"textarea":sx(e,n),a=hf(e,n),st("invalid",e);break;default:a=n}pf(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?hy(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&dy(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&vl(e,l):typeof l=="number"&&vl(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(gl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&st("scroll",e):l!=null&&rm(e,s,l,i))}switch(r){case"input":Cc(e),ax(e,n,!1);break;case"textarea":Cc(e),ix(e);break;case"option":n.value!=null&&e.setAttribute("value",""+rs(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Ti(e,!!n.multiple,s,!1):n.defaultValue!=null&&Ti(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=ju)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Jt(t),null;case 6:if(e&&t.stateNode!=null)O2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(he(166));if(r=ks(Al.current),ks(Un.current),Oc(t)){if(n=t.stateNode,r=t.memoizedProps,n[In]=t,(s=n.nodeValue!==r)&&(e=Ur,e!==null))switch(e.tag){case 3:Ic(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ic(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[In]=t,t.stateNode=n}return Jt(t),null;case 13:if(it(ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(lt&&Br!==null&&t.mode&1&&!(t.flags&128))e2(),Qi(),t.flags|=98560,s=!1;else if(s=Oc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(he(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(he(317));s[In]=t}else Qi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Jt(t),s=!1}else xn!==null&&(qf(xn),xn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ft.current&1?Dt===0&&(Dt=3):Lm())),t.updateQueue!==null&&(t.flags|=4),Jt(t),null);case 4:return Zi(),zf(e,t),e===null&&bl(t.stateNode.containerInfo),Jt(t),null;case 10:return km(t.type._context),Jt(t),null;case 17:return Fr(t.type)&&Iu(),Jt(t),null;case 19:if(it(ft),s=t.memoizedState,s===null)return Jt(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Po(s,!1);else{if(Dt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=zu(e),i!==null){for(t.flags|=128,Po(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return et(ft,ft.current&1|2),t.child}e=e.sibling}s.tail!==null&&kt()>to&&(t.flags|=128,n=!0,Po(s,!1),t.lanes=4194304)}else{if(!n)if(e=zu(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Po(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!lt)return Jt(t),null}else 2*kt()-s.renderingStartTime>to&&r!==1073741824&&(t.flags|=128,n=!0,Po(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=kt(),t.sibling=null,r=ft.current,et(ft,n?r&1|2:r&1),t):(Jt(t),null);case 22:case 23:return Mm(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?jr&1073741824&&(Jt(t),t.subtreeFlags&6&&(t.flags|=8192)):Jt(t),null;case 24:return null;case 25:return null}throw Error(he(156,t.tag))}function Xb(e,t){switch(gm(t),t.tag){case 1:return Fr(t.type)&&Iu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Zi(),it(Ar),it(or),Tm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bm(t),null;case 13:if(it(ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(he(340));Qi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(ft),null;case 4:return Zi(),null;case 10:return km(t.type._context),null;case 22:case 23:return Mm(),null;case 24:return null;default:return null}}var Bc=!1,rr=!1,qb=typeof WeakSet=="function"?WeakSet:Set,we=null;function Ei(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){xt(e,t,n)}else r.current=null}function Vf(e,t,r){try{r()}catch(n){xt(e,t,n)}}var Xx=!1;function Qb(e,t){if(Tf=Pu,e=$y(),pm(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||a!==0&&f.nodeType!==3||(o=i+a),f!==s||n!==0&&f.nodeType!==3||(l=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++d===n&&(l=i),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cf={focusedElem:e,selectionRange:r},Pu=!1,we=t;we!==null;)if(t=we,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,we=e;else for(;we!==null;){t=we;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,v=x.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:fn(t.type,m),v);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(S){xt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,we=e;break}we=t.return}return x=Xx,Xx=!1,x}function el(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Vf(t,r,s)}a=a.next}while(a!==n)}}function P0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Hf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function M2(e){var t=e.alternate;t!==null&&(e.alternate=null,M2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[In],delete t[Cl],delete t[Ff],delete t[Db],delete t[jb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function L2(e){return e.tag===5||e.tag===3||e.tag===4}function qx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||L2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=ju));else if(n!==4&&(e=e.child,e!==null))for(Wf(e,t,r),e=e.sibling;e!==null;)Wf(e,t,r),e=e.sibling}function Kf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Kf(e,t,r),e=e.sibling;e!==null;)Kf(e,t,r),e=e.sibling}var Vt=null,pn=!1;function ga(e,t,r){for(r=r.child;r!==null;)B2(e,t,r),r=r.sibling}function B2(e,t,r){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(E0,r)}catch{}switch(r.tag){case 5:rr||Ei(r,t);case 6:var n=Vt,a=pn;Vt=null,ga(e,t,r),Vt=n,pn=a,Vt!==null&&(pn?(e=Vt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Vt.removeChild(r.stateNode));break;case 18:Vt!==null&&(pn?(e=Vt,r=r.stateNode,e.nodeType===8?_d(e.parentNode,r):e.nodeType===1&&_d(e,r),Sl(e)):_d(Vt,r.stateNode));break;case 4:n=Vt,a=pn,Vt=r.stateNode.containerInfo,pn=!0,ga(e,t,r),Vt=n,pn=a;break;case 0:case 11:case 14:case 15:if(!rr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Vf(r,t,i),a=a.next}while(a!==n)}ga(e,t,r);break;case 1:if(!rr&&(Ei(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){xt(r,t,o)}ga(e,t,r);break;case 21:ga(e,t,r);break;case 22:r.mode&1?(rr=(n=rr)||r.memoizedState!==null,ga(e,t,r),rr=n):ga(e,t,r);break;default:ga(e,t,r)}}function Qx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new qb),t.forEach(function(n){var a=i4.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function cn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Vt=o.stateNode,pn=!1;break e;case 3:Vt=o.stateNode.containerInfo,pn=!0;break e;case 4:Vt=o.stateNode.containerInfo,pn=!0;break e}o=o.return}if(Vt===null)throw Error(he(160));B2(s,i,a),Vt=null,pn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){xt(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)U2(t,e),t=t.sibling}function U2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(cn(t,e),Cn(e),n&4){try{el(3,e,e.return),P0(3,e)}catch(m){xt(e,e.return,m)}try{el(5,e,e.return)}catch(m){xt(e,e.return,m)}}break;case 1:cn(t,e),Cn(e),n&512&&r!==null&&Ei(r,r.return);break;case 5:if(cn(t,e),Cn(e),n&512&&r!==null&&Ei(r,r.return),e.flags&32){var a=e.stateNode;try{vl(a,"")}catch(m){xt(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&ly(a,s),xf(o,i);var c=xf(o,s);for(i=0;i<l.length;i+=2){var d=l[i],f=l[i+1];d==="style"?hy(a,f):d==="dangerouslySetInnerHTML"?dy(a,f):d==="children"?vl(a,f):rm(a,d,f,c)}switch(o){case"input":df(a,s);break;case"textarea":cy(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Ti(a,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ti(a,!!s.multiple,s.defaultValue,!0):Ti(a,!!s.multiple,s.multiple?[]:"",!1))}a[Cl]=s}catch(m){xt(e,e.return,m)}}break;case 6:if(cn(t,e),Cn(e),n&4){if(e.stateNode===null)throw Error(he(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){xt(e,e.return,m)}}break;case 3:if(cn(t,e),Cn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Sl(t.containerInfo)}catch(m){xt(e,e.return,m)}break;case 4:cn(t,e),Cn(e);break;case 13:cn(t,e),Cn(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Im=kt())),n&4&&Qx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(rr=(c=rr)||d,cn(t,e),rr=c):cn(t,e),Cn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(we=e,d=e.child;d!==null;){for(f=we=d;we!==null;){switch(h=we,p=h.child,h.tag){case 0:case 11:case 14:case 15:el(4,h,h.return);break;case 1:Ei(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(m){xt(n,r,m)}}break;case 5:Ei(h,h.return);break;case 22:if(h.memoizedState!==null){Zx(f);continue}}p!==null?(p.return=h,we=p):Zx(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=fy("display",i))}catch(m){xt(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){xt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:cn(t,e),Cn(e),n&4&&Qx(e);break;case 21:break;default:cn(t,e),Cn(e)}}function Cn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(L2(r)){var n=r;break e}r=r.return}throw Error(he(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(vl(a,""),n.flags&=-33);var s=qx(e);Kf(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=qx(e);Wf(e,o,i);break;default:throw Error(he(161))}}catch(l){xt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Jb(e,t,r){we=e,$2(e)}function $2(e,t,r){for(var n=(e.mode&1)!==0;we!==null;){var a=we,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Bc;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||rr;o=Bc;var c=rr;if(Bc=i,(rr=l)&&!c)for(we=a;we!==null;)i=we,l=i.child,i.tag===22&&i.memoizedState!==null?e1(a):l!==null?(l.return=i,we=l):e1(a);for(;s!==null;)we=s,$2(s),s=s.sibling;we=a,Bc=o,rr=c}Jx(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,we=s):Jx(e)}}function Jx(e){for(;we!==null;){var t=we;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:rr||P0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!rr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:fn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Ox(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Ox(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Sl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}rr||t.flags&512&&Hf(t)}catch(h){xt(t,t.return,h)}}if(t===e){we=null;break}if(r=t.sibling,r!==null){r.return=t.return,we=r;break}we=t.return}}function Zx(e){for(;we!==null;){var t=we;if(t===e){we=null;break}var r=t.sibling;if(r!==null){r.return=t.return,we=r;break}we=t.return}}function e1(e){for(;we!==null;){var t=we;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{P0(4,t)}catch(l){xt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){xt(t,a,l)}}var s=t.return;try{Hf(t)}catch(l){xt(t,s,l)}break;case 5:var i=t.return;try{Hf(t)}catch(l){xt(t,i,l)}}}catch(l){xt(t,t.return,l)}if(t===e){we=null;break}var o=t.sibling;if(o!==null){o.return=t.return,we=o;break}we=t.return}}var Zb=Math.ceil,Wu=pa.ReactCurrentDispatcher,Dm=pa.ReactCurrentOwner,nn=pa.ReactCurrentBatchConfig,Ge=0,Ut=null,Ct=null,Kt=0,jr=0,_i=os(0),Dt=0,Dl=null,Ks=0,R0=0,jm=0,tl=null,Cr=null,Im=0,to=1/0,qn=null,Ku=!1,Gf=null,Ga=null,Uc=!1,Ma=null,Gu=0,rl=0,Yf=null,pu=-1,xu=0;function gr(){return Ge&6?kt():pu!==-1?pu:pu=kt()}function Ya(e){return e.mode&1?Ge&2&&Kt!==0?Kt&-Kt:Ob.transition!==null?(xu===0&&(xu=by()),xu):(e=Qe,e!==0||(e=window.event,e=e===void 0?16:Ry(e.type)),e):1}function kn(e,t,r,n){if(50<rl)throw rl=0,Yf=null,Error(he(185));oc(e,r,n),(!(Ge&2)||e!==Ut)&&(e===Ut&&(!(Ge&2)&&(R0|=r),Dt===4&&ba(e,Kt)),Pr(e,n),r===1&&Ge===0&&!(t.mode&1)&&(to=kt()+500,N0&&ls()))}function Pr(e,t){var r=e.callbackNode;O_(e,t);var n=Fu(e,e===Ut?Kt:0);if(n===0)r!==null&&cx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&cx(r),t===1)e.tag===0?Ib(t1.bind(null,e)):Qy(t1.bind(null,e)),Pb(function(){!(Ge&6)&&ls()}),r=null;else{switch(Ty(n)){case 1:r=om;break;case 4:r=Ey;break;case 16:r=Au;break;case 536870912:r=_y;break;default:r=Au}r=X2(r,z2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function z2(e,t){if(pu=-1,xu=0,Ge&6)throw Error(he(327));var r=e.callbackNode;if(Pi()&&e.callbackNode!==r)return null;var n=Fu(e,e===Ut?Kt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Yu(e,n);else{t=n;var a=Ge;Ge|=2;var s=H2();(Ut!==e||Kt!==t)&&(qn=null,to=kt()+500,Is(e,t));do try{r4();break}catch(o){V2(e,o)}while(1);wm(),Wu.current=s,Ge=a,Ct!==null?t=0:(Ut=null,Kt=0,t=Dt)}if(t!==0){if(t===2&&(a=kf(e),a!==0&&(n=a,t=Xf(e,a))),t===1)throw r=Dl,Is(e,0),ba(e,n),Pr(e,kt()),r;if(t===6)ba(e,n);else{if(a=e.current.alternate,!(n&30)&&!e4(a)&&(t=Yu(e,n),t===2&&(s=kf(e),s!==0&&(n=s,t=Xf(e,s))),t===1))throw r=Dl,Is(e,0),ba(e,n),Pr(e,kt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(he(345));case 2:ms(e,Cr,qn);break;case 3:if(ba(e,n),(n&130023424)===n&&(t=Im+500-kt(),10<t)){if(Fu(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){gr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Af(ms.bind(null,e,Cr,qn),t);break}ms(e,Cr,qn);break;case 4:if(ba(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-wn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=kt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Zb(n/1960))-n,10<n){e.timeoutHandle=Af(ms.bind(null,e,Cr,qn),n);break}ms(e,Cr,qn);break;case 5:ms(e,Cr,qn);break;default:throw Error(he(329))}}}return Pr(e,kt()),e.callbackNode===r?z2.bind(null,e):null}function Xf(e,t){var r=tl;return e.current.memoizedState.isDehydrated&&(Is(e,t).flags|=256),e=Yu(e,t),e!==2&&(t=Cr,Cr=r,t!==null&&qf(t)),e}function qf(e){Cr===null?Cr=e:Cr.push.apply(Cr,e)}function e4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!_n(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ba(e,t){for(t&=~jm,t&=~R0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-wn(t),n=1<<r;e[r]=-1,t&=~n}}function t1(e){if(Ge&6)throw Error(he(327));Pi();var t=Fu(e,0);if(!(t&1))return Pr(e,kt()),null;var r=Yu(e,t);if(e.tag!==0&&r===2){var n=kf(e);n!==0&&(t=n,r=Xf(e,n))}if(r===1)throw r=Dl,Is(e,0),ba(e,t),Pr(e,kt()),r;if(r===6)throw Error(he(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ms(e,Cr,qn),Pr(e,kt()),null}function Om(e,t){var r=Ge;Ge|=1;try{return e(t)}finally{Ge=r,Ge===0&&(to=kt()+500,N0&&ls())}}function Gs(e){Ma!==null&&Ma.tag===0&&!(Ge&6)&&Pi();var t=Ge;Ge|=1;var r=nn.transition,n=Qe;try{if(nn.transition=null,Qe=1,e)return e()}finally{Qe=n,nn.transition=r,Ge=t,!(Ge&6)&&ls()}}function Mm(){jr=_i.current,it(_i)}function Is(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Fb(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(gm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Iu();break;case 3:Zi(),it(Ar),it(or),Tm();break;case 5:bm(n);break;case 4:Zi();break;case 13:it(ft);break;case 19:it(ft);break;case 10:km(n.type._context);break;case 22:case 23:Mm()}r=r.return}if(Ut=e,Ct=e=Xa(e.current,null),Kt=jr=t,Dt=0,Dl=null,jm=R0=Ks=0,Cr=tl=null,ws!==null){for(t=0;t<ws.length;t++)if(r=ws[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}ws=null}return e}function V2(e,t){do{var r=Ct;try{if(wm(),fu.current=Hu,Vu){for(var n=ht.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Vu=!1}if(Ws=0,Bt=Rt=ht=null,Zo=!1,Fl=0,Dm.current=null,r===null||r.return===null){Dt=1,Dl=t,Ct=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=Kt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=zx(i);if(p!==null){p.flags&=-257,Vx(p,i,o,s,t),p.mode&1&&$x(s,c,t),t=p,l=c;var x=t.updateQueue;if(x===null){var m=new Set;m.add(l),t.updateQueue=m}else x.add(l);break e}else{if(!(t&1)){$x(s,c,t),Lm();break e}l=Error(he(426))}}else if(lt&&o.mode&1){var v=zx(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Vx(v,i,o,s,t),vm(eo(l,o));break e}}s=l=eo(l,o),Dt!==4&&(Dt=2),tl===null?tl=[s]:tl.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=T2(s,l,t);Ix(s,g);break e;case 1:o=l;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ga===null||!Ga.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=C2(s,o,t);Ix(s,S);break e}}s=s.return}while(s!==null)}K2(r)}catch(A){t=A,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(1)}function H2(){var e=Wu.current;return Wu.current=Hu,e===null?Hu:e}function Lm(){(Dt===0||Dt===3||Dt===2)&&(Dt=4),Ut===null||!(Ks&268435455)&&!(R0&268435455)||ba(Ut,Kt)}function Yu(e,t){var r=Ge;Ge|=2;var n=H2();(Ut!==e||Kt!==t)&&(qn=null,Is(e,t));do try{t4();break}catch(a){V2(e,a)}while(1);if(wm(),Ge=r,Wu.current=n,Ct!==null)throw Error(he(261));return Ut=null,Kt=0,Dt}function t4(){for(;Ct!==null;)W2(Ct)}function r4(){for(;Ct!==null&&!C_();)W2(Ct)}function W2(e){var t=Y2(e.alternate,e,jr);e.memoizedProps=e.pendingProps,t===null?K2(e):Ct=t,Dm.current=null}function K2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Xb(r,t),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Dt=6,Ct=null;return}}else if(r=Yb(r,t,jr),r!==null){Ct=r;return}if(t=t.sibling,t!==null){Ct=t;return}Ct=t=e}while(t!==null);Dt===0&&(Dt=5)}function ms(e,t,r){var n=Qe,a=nn.transition;try{nn.transition=null,Qe=1,n4(e,t,r,n)}finally{nn.transition=a,Qe=n}return null}function n4(e,t,r,n){do Pi();while(Ma!==null);if(Ge&6)throw Error(he(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(he(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(M_(e,s),e===Ut&&(Ct=Ut=null,Kt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Uc||(Uc=!0,X2(Au,function(){return Pi(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=nn.transition,nn.transition=null;var i=Qe;Qe=1;var o=Ge;Ge|=4,Dm.current=null,Qb(e,r),U2(r,e),Eb(Cf),Pu=!!Tf,Cf=Tf=null,e.current=r,Jb(r),N_(),Ge=o,Qe=i,nn.transition=s}else e.current=r;if(Uc&&(Uc=!1,Ma=e,Gu=a),s=e.pendingLanes,s===0&&(Ga=null),P_(r.stateNode),Pr(e,kt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Ku)throw Ku=!1,e=Gf,Gf=null,e;return Gu&1&&e.tag!==0&&Pi(),s=e.pendingLanes,s&1?e===Yf?rl++:(rl=0,Yf=e):rl=0,ls(),null}function Pi(){if(Ma!==null){var e=Ty(Gu),t=nn.transition,r=Qe;try{if(nn.transition=null,Qe=16>e?16:e,Ma===null)var n=!1;else{if(e=Ma,Ma=null,Gu=0,Ge&6)throw Error(he(331));var a=Ge;for(Ge|=4,we=e.current;we!==null;){var s=we,i=s.child;if(we.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(we=c;we!==null;){var d=we;switch(d.tag){case 0:case 11:case 15:el(8,d,s)}var f=d.child;if(f!==null)f.return=d,we=f;else for(;we!==null;){d=we;var h=d.sibling,p=d.return;if(M2(d),d===c){we=null;break}if(h!==null){h.return=p,we=h;break}we=p}}}var x=s.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}we=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,we=i;else e:for(;we!==null;){if(s=we,s.flags&2048)switch(s.tag){case 0:case 11:case 15:el(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,we=g;break e}we=s.return}}var y=e.current;for(we=y;we!==null;){i=we;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,we=w;else e:for(i=y;we!==null;){if(o=we,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:P0(9,o)}}catch(A){xt(o,o.return,A)}if(o===i){we=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,we=S;break e}we=o.return}}if(Ge=a,ls(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(E0,e)}catch{}n=!0}return n}finally{Qe=r,nn.transition=t}}return!1}function r1(e,t,r){t=eo(r,t),t=T2(e,t,1),e=Ka(e,t,1),t=gr(),e!==null&&(oc(e,1,t),Pr(e,t))}function xt(e,t,r){if(e.tag===3)r1(e,e,r);else for(;t!==null;){if(t.tag===3){r1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ga===null||!Ga.has(n))){e=eo(r,e),e=C2(t,e,1),t=Ka(t,e,1),e=gr(),t!==null&&(oc(t,1,e),Pr(t,e));break}}t=t.return}}function a4(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=gr(),e.pingedLanes|=e.suspendedLanes&r,Ut===e&&(Kt&r)===r&&(Dt===4||Dt===3&&(Kt&130023424)===Kt&&500>kt()-Im?Is(e,0):jm|=r),Pr(e,t)}function G2(e,t){t===0&&(e.mode&1?(t=Fc,Fc<<=1,!(Fc&130023424)&&(Fc=4194304)):t=1);var r=gr();e=ca(e,t),e!==null&&(oc(e,t,r),Pr(e,r))}function s4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),G2(e,r)}function i4(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(he(314))}n!==null&&n.delete(t),G2(e,r)}var Y2;Y2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ar.current)Nr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Nr=!1,Gb(e,t,r);Nr=!!(e.flags&131072)}else Nr=!1,lt&&t.flags&1048576&&Jy(t,Lu,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;mu(e,t),e=t.pendingProps;var a=qi(t,or.current);Fi(t,r),a=Nm(null,t,n,e,a,r);var s=Am();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fr(n)?(s=!0,Ou(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Em(t),a.updater=F0,t.stateNode=a,a._reactInternals=t,Of(t,n,e,r),t=Bf(null,t,n,!0,s,r)):(t.tag=0,lt&&s&&xm(t),fr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(mu(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=l4(n),e=fn(n,e),a){case 0:t=Lf(null,t,n,e,r);break e;case 1:t=Kx(null,t,n,e,r);break e;case 11:t=Hx(null,t,n,e,r);break e;case 14:t=Wx(null,t,n,fn(n.type,e),r);break e}throw Error(he(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:fn(n,a),Lf(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:fn(n,a),Kx(e,t,n,a,r);case 3:e:{if(P2(t),e===null)throw Error(he(387));n=t.pendingProps,s=t.memoizedState,a=s.element,a2(e,t),$u(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=eo(Error(he(423)),t),t=Gx(e,t,n,r,a);break e}else if(n!==a){a=eo(Error(he(424)),t),t=Gx(e,t,n,r,a);break e}else for(Br=Wa(t.stateNode.containerInfo.firstChild),Ur=t,lt=!0,xn=null,r=r2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Qi(),n===a){t=ua(e,t,r);break e}fr(e,t,n,r)}t=t.child}return t;case 5:return s2(t),e===null&&Df(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,Nf(n,a)?i=null:s!==null&&Nf(n,s)&&(t.flags|=32),F2(e,t),fr(e,t,i,r),t.child;case 6:return e===null&&Df(t),null;case 13:return R2(e,t,r);case 4:return _m(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ji(t,null,n,r):fr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:fn(n,a),Hx(e,t,n,a,r);case 7:return fr(e,t,t.pendingProps,r),t.child;case 8:return fr(e,t,t.pendingProps.children,r),t.child;case 12:return fr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,et(Bu,n._currentValue),n._currentValue=i,s!==null)if(_n(s.value,i)){if(s.children===a.children&&!Ar.current){t=ua(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=na(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),jf(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(he(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),jf(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}fr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Fi(t,r),a=an(a),n=n(a),t.flags|=1,fr(e,t,n,r),t.child;case 14:return n=t.type,a=fn(n,t.pendingProps),a=fn(n.type,a),Wx(e,t,n,a,r);case 15:return N2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:fn(n,a),mu(e,t),t.tag=1,Fr(n)?(e=!0,Ou(t)):e=!1,Fi(t,r),b2(t,n,a),Of(t,n,a,r),Bf(null,t,n,!0,e,r);case 19:return D2(e,t,r);case 22:return A2(e,t,r)}throw Error(he(156,t.tag))};function X2(e,t){return Sy(e,t)}function o4(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(e,t,r,n){return new o4(e,t,r,n)}function Bm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function l4(e){if(typeof e=="function")return Bm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===am)return 11;if(e===sm)return 14}return 2}function Xa(e,t){var r=e.alternate;return r===null?(r=rn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function gu(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")Bm(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case mi:return Os(r.children,a,s,t);case nm:i=8,a|=8;break;case sf:return e=rn(12,r,t,a|2),e.elementType=sf,e.lanes=s,e;case of:return e=rn(13,r,t,a),e.elementType=of,e.lanes=s,e;case lf:return e=rn(19,r,t,a),e.elementType=lf,e.lanes=s,e;case sy:return D0(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ny:i=10;break e;case ay:i=9;break e;case am:i=11;break e;case sm:i=14;break e;case ka:i=16,n=null;break e}throw Error(he(130,e==null?e:typeof e,""))}return t=rn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Os(e,t,r,n){return e=rn(7,e,n,t),e.lanes=r,e}function D0(e,t,r,n){return e=rn(22,e,n,t),e.elementType=sy,e.lanes=r,e.stateNode={isHidden:!1},e}function Rd(e,t,r){return e=rn(6,e,null,t),e.lanes=r,e}function Dd(e,t,r){return t=rn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function c4(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hd(0),this.expirationTimes=hd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hd(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Um(e,t,r,n,a,s,i,o,l){return e=new c4(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=rn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Em(s),e}function u4(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function q2(e){if(!e)return ns;e=e._reactInternals;e:{if(ti(e)!==e||e.tag!==1)throw Error(he(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(he(171))}if(e.tag===1){var r=e.type;if(Fr(r))return qy(e,r,t)}return t}function Q2(e,t,r,n,a,s,i,o,l){return e=Um(r,n,!0,e,a,s,i,o,l),e.context=q2(null),r=e.current,n=gr(),a=Ya(r),s=na(n,a),s.callback=t??null,Ka(r,s,a),e.current.lanes=a,oc(e,a,n),Pr(e,n),e}function j0(e,t,r,n){var a=t.current,s=gr(),i=Ya(a);return r=q2(r),t.context===null?t.context=r:t.pendingContext=r,t=na(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ka(a,t,i),e!==null&&(kn(e,a,i,s),du(e,a,i)),i}function Xu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function n1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function $m(e,t){n1(e,t),(e=e.alternate)&&n1(e,t)}function d4(){return null}var J2=typeof reportError=="function"?reportError:function(e){console.error(e)};function zm(e){this._internalRoot=e}I0.prototype.render=zm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(he(409));j0(e,t,null,null)};I0.prototype.unmount=zm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Gs(function(){j0(null,e,null,null)}),t[la]=null}};function I0(e){this._internalRoot=e}I0.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ay();e={blockedOn:null,target:e,priority:t};for(var r=0;r<_a.length&&t!==0&&t<_a[r].priority;r++);_a.splice(r,0,e),r===0&&Py(e)}};function Vm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function O0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function a1(){}function f4(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Xu(i);s.call(c)}}var i=Q2(t,n,e,0,null,!1,!1,"",a1);return e._reactRootContainer=i,e[la]=i.current,bl(e.nodeType===8?e.parentNode:e),Gs(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Xu(l);o.call(c)}}var l=Um(e,0,!1,null,null,!1,!1,"",a1);return e._reactRootContainer=l,e[la]=l.current,bl(e.nodeType===8?e.parentNode:e),Gs(function(){j0(t,l,r,n)}),l}function M0(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Xu(i);o.call(l)}}j0(t,i,e,a)}else i=f4(r,t,e,a,n);return Xu(i)}Cy=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Bo(t.pendingLanes);r!==0&&(lm(t,r|1),Pr(t,kt()),!(Ge&6)&&(to=kt()+500,ls()))}break;case 13:Gs(function(){var n=ca(e,1);if(n!==null){var a=gr();kn(n,e,1,a)}}),$m(e,1)}};cm=function(e){if(e.tag===13){var t=ca(e,134217728);if(t!==null){var r=gr();kn(t,e,134217728,r)}$m(e,134217728)}};Ny=function(e){if(e.tag===13){var t=Ya(e),r=ca(e,t);if(r!==null){var n=gr();kn(r,e,t,n)}$m(e,t)}};Ay=function(){return Qe};Fy=function(e,t){var r=Qe;try{return Qe=e,t()}finally{Qe=r}};vf=function(e,t,r){switch(t){case"input":if(df(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=C0(n);if(!a)throw Error(he(90));oy(n),df(n,a)}}}break;case"textarea":cy(e,r);break;case"select":t=r.value,t!=null&&Ti(e,!!r.multiple,t,!1)}};xy=Om;gy=Gs;var h4={usingClientEntryPoint:!1,Events:[cc,vi,C0,my,py,Om]},Ro={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m4={bundleType:Ro.bundleType,version:Ro.version,rendererPackageName:Ro.rendererPackageName,rendererConfig:Ro.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wy(e),e===null?null:e.stateNode},findFiberByHostInstance:Ro.findFiberByHostInstance||d4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{E0=$c.inject(m4),Bn=$c}catch{}}Hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=h4;Hr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vm(t))throw Error(he(200));return u4(e,t,null,r)};Hr.createRoot=function(e,t){if(!Vm(e))throw Error(he(299));var r=!1,n="",a=J2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Um(e,1,!1,null,null,r,!1,n,a),e[la]=t.current,bl(e.nodeType===8?e.parentNode:e),new zm(t)};Hr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(he(188)):(e=Object.keys(e).join(","),Error(he(268,e)));return e=wy(t),e=e===null?null:e.stateNode,e};Hr.flushSync=function(e){return Gs(e)};Hr.hydrate=function(e,t,r){if(!O0(t))throw Error(he(200));return M0(null,e,t,!0,r)};Hr.hydrateRoot=function(e,t,r){if(!Vm(e))throw Error(he(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=J2;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Q2(t,null,e,1,r??null,a,!1,s,i),e[la]=t.current,bl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new I0(t)};Hr.render=function(e,t,r){if(!O0(t))throw Error(he(200));return M0(null,e,t,!1,r)};Hr.unmountComponentAtNode=function(e){if(!O0(e))throw Error(he(40));return e._reactRootContainer?(Gs(function(){M0(null,null,e,!1,function(){e._reactRootContainer=null,e[la]=null})}),!0):!1};Hr.unstable_batchedUpdates=Om;Hr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!O0(r))throw Error(he(200));if(e==null||e._reactInternals===void 0)throw Error(he(38));return M0(e,t,r,!1,n)};Hr.version="18.3.1-next-f1338f8080-20240426";function Z2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z2)}catch(e){console.error(e)}}Z2(),Zv.exports=Hr;var Hm=Zv.exports,s1=Hm;bu.createRoot=s1.createRoot,bu.hydrateRoot=s1.hydrateRoot;var dc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},p4={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Na,Yh,Rv,x4=(Rv=class{constructor(){Ee(this,Na,p4);Ee(this,Yh,!1)}setTimeoutProvider(e){ve(this,Na,e)}setTimeout(e,t){return Y(this,Na).setTimeout(e,t)}clearTimeout(e){Y(this,Na).clearTimeout(e)}setInterval(e,t){return Y(this,Na).setInterval(e,t)}clearInterval(e){Y(this,Na).clearInterval(e)}},Na=new WeakMap,Yh=new WeakMap,Rv),Ss=new x4;function g4(e){setTimeout(e,0)}var Ys=typeof window>"u"||"Deno"in globalThis;function br(){}function v4(e,t){return typeof e=="function"?e(t):e}function Qf(e){return typeof e=="number"&&e>=0&&e!==1/0}function ew(e,t){return Math.max(e+(t||0)-Date.now(),0)}function qa(e,t){return typeof e=="function"?e(t):e}function Zr(e,t){return typeof e=="function"?e(t):e}function i1(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:s,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==Wm(i,t.options))return!1}else if(!Il(t.queryKey,i))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||s&&!s(t))}function o1(e,t){const{exact:r,status:n,predicate:a,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(jl(t.options.mutationKey)!==jl(s))return!1}else if(!Il(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function Wm(e,t){return((t==null?void 0:t.queryKeyHashFn)||jl)(e)}function jl(e){return JSON.stringify(e,(t,r)=>Zf(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Il(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Il(e[r],t[r])):!1}var y4=Object.prototype.hasOwnProperty;function tw(e,t){if(e===t)return e;const r=l1(e)&&l1(t);if(!r&&!(Zf(e)&&Zf(t)))return t;const a=(r?e:Object.keys(e)).length,s=r?t:Object.keys(t),i=s.length,o=r?new Array(i):{};let l=0;for(let c=0;c<i;c++){const d=r?c:s[c],f=e[d],h=t[d];if(f===h){o[d]=f,(r?c<a:y4.call(e,d))&&l++;continue}if(f===null||h===null||typeof f!="object"||typeof h!="object"){o[d]=h;continue}const p=tw(f,h);o[d]=p,p===f&&l++}return a===i&&l===a?e:o}function Jf(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function l1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Zf(e){if(!c1(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!c1(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function c1(e){return Object.prototype.toString.call(e)==="[object Object]"}function w4(e){return new Promise(t=>{Ss.setTimeout(t,e)})}function eh(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?tw(e,t):t}function k4(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function S4(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var Km=Symbol();function rw(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Km?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function E4(e,t){return typeof e=="function"?e(...t):!!e}var bs,Aa,Mi,Dv,_4=(Dv=class extends dc{constructor(){super();Ee(this,bs,void 0);Ee(this,Aa,void 0);Ee(this,Mi,void 0);ve(this,Mi,t=>{if(!Ys&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Y(this,Aa)||this.setEventListener(Y(this,Mi))}onUnsubscribe(){var t;this.hasListeners()||((t=Y(this,Aa))==null||t.call(this),ve(this,Aa,void 0))}setEventListener(t){var r;ve(this,Mi,t),(r=Y(this,Aa))==null||r.call(this),ve(this,Aa,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){Y(this,bs)!==t&&(ve(this,bs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Y(this,bs)=="boolean"?Y(this,bs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},bs=new WeakMap,Aa=new WeakMap,Mi=new WeakMap,Dv),Gm=new _4;function th(){let e,t;const r=new Promise((a,s)=>{e=a,t=s});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}var b4=g4;function T4(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=b4;const s=o=>{t?e.push(o):a(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var Wt=T4(),Li,Fa,Bi,jv,C4=(jv=class extends dc{constructor(){super();Ee(this,Li,!0);Ee(this,Fa,void 0);Ee(this,Bi,void 0);ve(this,Bi,t=>{if(!Ys&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){Y(this,Fa)||this.setEventListener(Y(this,Bi))}onUnsubscribe(){var t;this.hasListeners()||((t=Y(this,Fa))==null||t.call(this),ve(this,Fa,void 0))}setEventListener(t){var r;ve(this,Bi,t),(r=Y(this,Fa))==null||r.call(this),ve(this,Fa,t(this.setOnline.bind(this)))}setOnline(t){Y(this,Li)!==t&&(ve(this,Li,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return Y(this,Li)}},Li=new WeakMap,Fa=new WeakMap,Bi=new WeakMap,jv),qu=new C4;function N4(e){return Math.min(1e3*2**e,3e4)}function nw(e){return(e??"online")==="online"?qu.isOnline():!0}var rh=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function aw(e){let t=!1,r=0,n;const a=th(),s=()=>a.status!=="pending",i=m=>{var v;if(!s()){const g=new rh(m);h(g),(v=e.onCancel)==null||v.call(e,g)}},o=()=>{t=!0},l=()=>{t=!1},c=()=>Gm.isFocused()&&(e.networkMode==="always"||qu.isOnline())&&e.canRun(),d=()=>nw(e.networkMode)&&e.canRun(),f=m=>{s()||(n==null||n(),a.resolve(m))},h=m=>{s()||(n==null||n(),a.reject(m))},p=()=>new Promise(m=>{var v;n=g=>{(s()||c())&&m(g)},(v=e.onPause)==null||v.call(e)}).then(()=>{var m;n=void 0,s()||(m=e.onContinue)==null||m.call(e)}),x=()=>{if(s())return;let m;const v=r===0?e.initialPromise:void 0;try{m=v??e.fn()}catch(g){m=Promise.reject(g)}Promise.resolve(m).then(f).catch(g=>{var T;if(s())return;const y=e.retry??(Ys?0:3),w=e.retryDelay??N4,S=typeof w=="function"?w(r,g):w,A=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,g);if(t||!A){h(g);return}r++,(T=e.onFail)==null||T.call(e,r,g),w4(S).then(()=>c()?void 0:p()).then(()=>{t?h(g):x()})})};return{promise:a,status:()=>a.status,cancel:i,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:l,canStart:d,start:()=>(d()?x():p().then(x),a)}}var Ts,Iv,sw=(Iv=class{constructor(){Ee(this,Ts,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Qf(this.gcTime)&&ve(this,Ts,Ss.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Ys?1/0:5*60*1e3))}clearGcTimeout(){Y(this,Ts)&&(Ss.clearTimeout(Y(this,Ts)),ve(this,Ts,void 0))}},Ts=new WeakMap,Iv),Cs,Ui,Jr,Ns,Ot,Yl,As,hn,Xn,Ov,A4=(Ov=class extends sw{constructor(t){super();Ee(this,hn);Ee(this,Cs,void 0);Ee(this,Ui,void 0);Ee(this,Jr,void 0);Ee(this,Ns,void 0);Ee(this,Ot,void 0);Ee(this,Yl,void 0);Ee(this,As,void 0);ve(this,As,!1),ve(this,Yl,t.defaultOptions),this.setOptions(t.options),this.observers=[],ve(this,Ns,t.client),ve(this,Jr,Y(this,Ns).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ve(this,Cs,u1(this.options)),this.state=t.state??Y(this,Cs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Y(this,Ot))==null?void 0:t.promise}setOptions(t){if(this.options={...Y(this,Yl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=u1(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),ve(this,Cs,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Y(this,Jr).remove(this)}setData(t,r){const n=eh(this.state.data,t,this.options);return ze(this,hn,Xn).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){ze(this,hn,Xn).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=Y(this,Ot))==null?void 0:n.promise;return(a=Y(this,Ot))==null||a.cancel(t),r?r.then(br).catch(br):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Y(this,Cs))}isActive(){return this.observers.some(t=>Zr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Km||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>qa(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!ew(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Y(this,Ot))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Y(this,Ot))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Y(this,Jr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Y(this,Ot)&&(Y(this,As)?Y(this,Ot).cancel({revert:!0}):Y(this,Ot).cancelRetry()),this.scheduleGc()),Y(this,Jr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ze(this,hn,Xn).call(this,{type:"invalidate"})}async fetch(t,r){var l,c,d,f,h,p,x,m,v,g,y,w;if(this.state.fetchStatus!=="idle"&&((l=Y(this,Ot))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Y(this,Ot))return Y(this,Ot).continueRetry(),Y(this,Ot).promise}if(t&&this.setOptions(t),!this.options.queryFn){const S=this.observers.find(A=>A.options.queryFn);S&&this.setOptions(S.options)}const n=new AbortController,a=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(ve(this,As,!0),n.signal)})},s=()=>{const S=rw(this.options,r),T=(()=>{const b={client:Y(this,Ns),queryKey:this.queryKey,meta:this.meta};return a(b),b})();return ve(this,As,!1),this.options.persister?this.options.persister(S,T,this):S(T)},o=(()=>{const S={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Y(this,Ns),state:this.state,fetchFn:s};return a(S),S})();(c=this.options.behavior)==null||c.onFetch(o,this),ve(this,Ui,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&ze(this,hn,Xn).call(this,{type:"fetch",meta:(f=o.fetchOptions)==null?void 0:f.meta}),ve(this,Ot,aw({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:S=>{S instanceof rh&&S.revert&&this.setState({...Y(this,Ui),fetchStatus:"idle"}),n.abort()},onFail:(S,A)=>{ze(this,hn,Xn).call(this,{type:"failed",failureCount:S,error:A})},onPause:()=>{ze(this,hn,Xn).call(this,{type:"pause"})},onContinue:()=>{ze(this,hn,Xn).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const S=await Y(this,Ot).start();if(S===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(S),(p=(h=Y(this,Jr).config).onSuccess)==null||p.call(h,S,this),(m=(x=Y(this,Jr).config).onSettled)==null||m.call(x,S,this.state.error,this),S}catch(S){if(S instanceof rh){if(S.silent)return Y(this,Ot).promise;if(S.revert){if(this.state.data===void 0)throw S;return this.state.data}}throw ze(this,hn,Xn).call(this,{type:"error",error:S}),(g=(v=Y(this,Jr).config).onError)==null||g.call(v,S,this),(w=(y=Y(this,Jr).config).onSettled)==null||w.call(y,this.state.data,S,this),S}finally{this.scheduleGc()}}},Cs=new WeakMap,Ui=new WeakMap,Jr=new WeakMap,Ns=new WeakMap,Ot=new WeakMap,Yl=new WeakMap,As=new WeakMap,hn=new WeakSet,Xn=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...iw(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ve(this,Ui,t.manual?a:void 0),a;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Wt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Y(this,Jr).notify({query:this,type:"updated",action:t})})},Ov);function iw(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:nw(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function u1(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Er,Ve,Xl,ur,Fs,$i,Jn,Pa,ql,zi,Vi,Ps,Rs,Ra,Hi,Ds,$o,Ql,nh,Jl,ah,Zl,sh,ec,ih,tc,oh,rc,lh,nc,ch,k0,ow,Mv,F4=(Mv=class extends dc{constructor(t,r){super();Ee(this,Ds);Ee(this,Ql);Ee(this,Jl);Ee(this,Zl);Ee(this,ec);Ee(this,tc);Ee(this,rc);Ee(this,nc);Ee(this,k0);Ee(this,Er,void 0);Ee(this,Ve,void 0);Ee(this,Xl,void 0);Ee(this,ur,void 0);Ee(this,Fs,void 0);Ee(this,$i,void 0);Ee(this,Jn,void 0);Ee(this,Pa,void 0);Ee(this,ql,void 0);Ee(this,zi,void 0);Ee(this,Vi,void 0);Ee(this,Ps,void 0);Ee(this,Rs,void 0);Ee(this,Ra,void 0);Ee(this,Hi,new Set);this.options=r,ve(this,Er,t),ve(this,Pa,null),ve(this,Jn,th()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Y(this,Ve).addObserver(this),d1(Y(this,Ve),this.options)?ze(this,Ds,$o).call(this):this.updateResult(),ze(this,ec,ih).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return uh(Y(this,Ve),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return uh(Y(this,Ve),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ze(this,tc,oh).call(this),ze(this,rc,lh).call(this),Y(this,Ve).removeObserver(this)}setOptions(t){const r=this.options,n=Y(this,Ve);if(this.options=Y(this,Er).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Zr(this.options.enabled,Y(this,Ve))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ze(this,nc,ch).call(this),Y(this,Ve).setOptions(this.options),r._defaulted&&!Jf(this.options,r)&&Y(this,Er).getQueryCache().notify({type:"observerOptionsUpdated",query:Y(this,Ve),observer:this});const a=this.hasListeners();a&&f1(Y(this,Ve),n,this.options,r)&&ze(this,Ds,$o).call(this),this.updateResult(),a&&(Y(this,Ve)!==n||Zr(this.options.enabled,Y(this,Ve))!==Zr(r.enabled,Y(this,Ve))||qa(this.options.staleTime,Y(this,Ve))!==qa(r.staleTime,Y(this,Ve)))&&ze(this,Ql,nh).call(this);const s=ze(this,Jl,ah).call(this);a&&(Y(this,Ve)!==n||Zr(this.options.enabled,Y(this,Ve))!==Zr(r.enabled,Y(this,Ve))||s!==Y(this,Ra))&&ze(this,Zl,sh).call(this,s)}getOptimisticResult(t){const r=Y(this,Er).getQueryCache().build(Y(this,Er),t),n=this.createResult(r,t);return R4(this,n)&&(ve(this,ur,n),ve(this,$i,this.options),ve(this,Fs,Y(this,Ve).state)),n}getCurrentResult(){return Y(this,ur)}trackResult(t,r){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&Y(this,Jn).status==="pending"&&Y(this,Jn).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(t){Y(this,Hi).add(t)}getCurrentQuery(){return Y(this,Ve)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=Y(this,Er).defaultQueryOptions(t),n=Y(this,Er).getQueryCache().build(Y(this,Er),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return ze(this,Ds,$o).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),Y(this,ur)))}createResult(t,r){var E;const n=Y(this,Ve),a=this.options,s=Y(this,ur),i=Y(this,Fs),o=Y(this,$i),c=t!==n?t.state:Y(this,Xl),{state:d}=t;let f={...d},h=!1,p;if(r._optimisticResults){const _=this.hasListeners(),C=!_&&d1(t,r),F=_&&f1(t,n,r,a);(C||F)&&(f={...f,...iw(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:x,errorUpdatedAt:m,status:v}=f;p=f.data;let g=!1;if(r.placeholderData!==void 0&&p===void 0&&v==="pending"){let _;s!=null&&s.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(_=s.data,g=!0):_=typeof r.placeholderData=="function"?r.placeholderData((E=Y(this,Vi))==null?void 0:E.state.data,Y(this,Vi)):r.placeholderData,_!==void 0&&(v="success",p=eh(s==null?void 0:s.data,_,r),h=!0)}if(r.select&&p!==void 0&&!g)if(s&&p===(i==null?void 0:i.data)&&r.select===Y(this,ql))p=Y(this,zi);else try{ve(this,ql,r.select),p=r.select(p),p=eh(s==null?void 0:s.data,p,r),ve(this,zi,p),ve(this,Pa,null)}catch(_){ve(this,Pa,_)}Y(this,Pa)&&(x=Y(this,Pa),p=Y(this,zi),m=Date.now(),v="error");const y=f.fetchStatus==="fetching",w=v==="pending",S=v==="error",A=w&&y,T=p!==void 0,k={status:v,fetchStatus:f.fetchStatus,isPending:w,isSuccess:v==="success",isError:S,isInitialLoading:A,isLoading:A,data:p,dataUpdatedAt:f.dataUpdatedAt,error:x,errorUpdatedAt:m,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>c.dataUpdateCount||f.errorUpdateCount>c.errorUpdateCount,isFetching:y,isRefetching:y&&!w,isLoadingError:S&&!T,isPaused:f.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:S&&T,isStale:Ym(t,r),refetch:this.refetch,promise:Y(this,Jn),isEnabled:Zr(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const _=D=>{k.status==="error"?D.reject(k.error):k.data!==void 0&&D.resolve(k.data)},C=()=>{const D=ve(this,Jn,k.promise=th());_(D)},F=Y(this,Jn);switch(F.status){case"pending":t.queryHash===n.queryHash&&_(F);break;case"fulfilled":(k.status==="error"||k.data!==F.value)&&C();break;case"rejected":(k.status!=="error"||k.error!==F.reason)&&C();break}}return k}updateResult(){const t=Y(this,ur),r=this.createResult(Y(this,Ve),this.options);if(ve(this,Fs,Y(this,Ve).state),ve(this,$i,this.options),Y(this,Fs).data!==void 0&&ve(this,Vi,Y(this,Ve)),Jf(r,t))return;ve(this,ur,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,s=typeof a=="function"?a():a;if(s==="all"||!s&&!Y(this,Hi).size)return!0;const i=new Set(s??Y(this,Hi));return this.options.throwOnError&&i.add("error"),Object.keys(Y(this,ur)).some(o=>{const l=o;return Y(this,ur)[l]!==t[l]&&i.has(l)})};ze(this,k0,ow).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ze(this,ec,ih).call(this)}},Er=new WeakMap,Ve=new WeakMap,Xl=new WeakMap,ur=new WeakMap,Fs=new WeakMap,$i=new WeakMap,Jn=new WeakMap,Pa=new WeakMap,ql=new WeakMap,zi=new WeakMap,Vi=new WeakMap,Ps=new WeakMap,Rs=new WeakMap,Ra=new WeakMap,Hi=new WeakMap,Ds=new WeakSet,$o=function(t){ze(this,nc,ch).call(this);let r=Y(this,Ve).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(br)),r},Ql=new WeakSet,nh=function(){ze(this,tc,oh).call(this);const t=qa(this.options.staleTime,Y(this,Ve));if(Ys||Y(this,ur).isStale||!Qf(t))return;const n=ew(Y(this,ur).dataUpdatedAt,t)+1;ve(this,Ps,Ss.setTimeout(()=>{Y(this,ur).isStale||this.updateResult()},n))},Jl=new WeakSet,ah=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Y(this,Ve)):this.options.refetchInterval)??!1},Zl=new WeakSet,sh=function(t){ze(this,rc,lh).call(this),ve(this,Ra,t),!(Ys||Zr(this.options.enabled,Y(this,Ve))===!1||!Qf(Y(this,Ra))||Y(this,Ra)===0)&&ve(this,Rs,Ss.setInterval(()=>{(this.options.refetchIntervalInBackground||Gm.isFocused())&&ze(this,Ds,$o).call(this)},Y(this,Ra)))},ec=new WeakSet,ih=function(){ze(this,Ql,nh).call(this),ze(this,Zl,sh).call(this,ze(this,Jl,ah).call(this))},tc=new WeakSet,oh=function(){Y(this,Ps)&&(Ss.clearTimeout(Y(this,Ps)),ve(this,Ps,void 0))},rc=new WeakSet,lh=function(){Y(this,Rs)&&(Ss.clearInterval(Y(this,Rs)),ve(this,Rs,void 0))},nc=new WeakSet,ch=function(){const t=Y(this,Er).getQueryCache().build(Y(this,Er),this.options);if(t===Y(this,Ve))return;const r=Y(this,Ve);ve(this,Ve,t),ve(this,Xl,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},k0=new WeakSet,ow=function(t){Wt.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(Y(this,ur))}),Y(this,Er).getQueryCache().notify({query:Y(this,Ve),type:"observerResultsUpdated"})})},Mv);function P4(e,t){return Zr(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function d1(e,t){return P4(e,t)||e.state.data!==void 0&&uh(e,t,t.refetchOnMount)}function uh(e,t,r){if(Zr(t.enabled,e)!==!1&&qa(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&Ym(e,t)}return!1}function f1(e,t,r,n){return(e!==t||Zr(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Ym(e,r)}function Ym(e,t){return Zr(t.enabled,e)!==!1&&e.isStaleByTime(qa(t.staleTime,e))}function R4(e,t){return!Jf(e.getCurrentResult(),t)}function h1(e){return{onFetch:(t,r)=>{var d,f,h,p,x;const n=t.options,a=(h=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:h.direction,s=((p=t.state.data)==null?void 0:p.pages)||[],i=((x=t.state.data)==null?void 0:x.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let m=!1;const v=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},g=rw(t.options,t.fetchOptions),y=async(w,S,A)=>{if(m)return Promise.reject();if(S==null&&w.pages.length)return Promise.resolve(w);const b=(()=>{const C={client:t.client,queryKey:t.queryKey,pageParam:S,direction:A?"backward":"forward",meta:t.options.meta};return v(C),C})(),k=await g(b),{maxPages:E}=t.options,_=A?S4:k4;return{pages:_(w.pages,k,E),pageParams:_(w.pageParams,S,E)}};if(a&&s.length){const w=a==="backward",S=w?D4:m1,A={pages:s,pageParams:i},T=S(n,A);o=await y(A,T,w)}else{const w=e??s.length;do{const S=l===0?i[0]??n.initialPageParam:m1(n,o);if(l>0&&S==null)break;o=await y(o,S),l++}while(l<w)}return o};t.options.persister?t.fetchFn=()=>{var m,v;return(v=(m=t.options).persister)==null?void 0:v.call(m,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function m1(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function D4(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var ac,Rn,dr,js,Dn,wa,Lv,j4=(Lv=class extends sw{constructor(t){super();Ee(this,Dn);Ee(this,ac,void 0);Ee(this,Rn,void 0);Ee(this,dr,void 0);Ee(this,js,void 0);ve(this,ac,t.client),this.mutationId=t.mutationId,ve(this,dr,t.mutationCache),ve(this,Rn,[]),this.state=t.state||I4(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Y(this,Rn).includes(t)||(Y(this,Rn).push(t),this.clearGcTimeout(),Y(this,dr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ve(this,Rn,Y(this,Rn).filter(r=>r!==t)),this.scheduleGc(),Y(this,dr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Y(this,Rn).length||(this.state.status==="pending"?this.scheduleGc():Y(this,dr).remove(this))}continue(){var t;return((t=Y(this,js))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,c,d,f,h,p,x,m,v,g,y,w,S,A,T,b,k,E;const r=()=>{ze(this,Dn,wa).call(this,{type:"continue"})},n={client:Y(this,ac),meta:this.options.meta,mutationKey:this.options.mutationKey};ve(this,js,aw({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(_,C)=>{ze(this,Dn,wa).call(this,{type:"failed",failureCount:_,error:C})},onPause:()=>{ze(this,Dn,wa).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Y(this,dr).canRun(this)}));const a=this.state.status==="pending",s=!Y(this,js).canStart();try{if(a)r();else{ze(this,Dn,wa).call(this,{type:"pending",variables:t,isPaused:s}),await((o=(i=Y(this,dr).config).onMutate)==null?void 0:o.call(i,t,this,n));const C=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t,n));C!==this.state.context&&ze(this,Dn,wa).call(this,{type:"pending",context:C,variables:t,isPaused:s})}const _=await Y(this,js).start();return await((f=(d=Y(this,dr).config).onSuccess)==null?void 0:f.call(d,_,t,this.state.context,this,n)),await((p=(h=this.options).onSuccess)==null?void 0:p.call(h,_,t,this.state.context,n)),await((m=(x=Y(this,dr).config).onSettled)==null?void 0:m.call(x,_,null,this.state.variables,this.state.context,this,n)),await((g=(v=this.options).onSettled)==null?void 0:g.call(v,_,null,t,this.state.context,n)),ze(this,Dn,wa).call(this,{type:"success",data:_}),_}catch(_){try{throw await((w=(y=Y(this,dr).config).onError)==null?void 0:w.call(y,_,t,this.state.context,this,n)),await((A=(S=this.options).onError)==null?void 0:A.call(S,_,t,this.state.context,n)),await((b=(T=Y(this,dr).config).onSettled)==null?void 0:b.call(T,void 0,_,this.state.variables,this.state.context,this,n)),await((E=(k=this.options).onSettled)==null?void 0:E.call(k,void 0,_,t,this.state.context,n)),_}finally{ze(this,Dn,wa).call(this,{type:"error",error:_})}}finally{Y(this,dr).runNext(this)}}},ac=new WeakMap,Rn=new WeakMap,dr=new WeakMap,js=new WeakMap,Dn=new WeakSet,wa=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Wt.batch(()=>{Y(this,Rn).forEach(n=>{n.onMutationUpdate(t)}),Y(this,dr).notify({mutation:this,type:"updated",action:t})})},Lv);function I4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Zn,mn,sc,Bv,O4=(Bv=class extends dc{constructor(t={}){super();Ee(this,Zn,void 0);Ee(this,mn,void 0);Ee(this,sc,void 0);this.config=t,ve(this,Zn,new Set),ve(this,mn,new Map),ve(this,sc,0)}build(t,r,n){const a=new j4({client:t,mutationCache:this,mutationId:++_c(this,sc)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){Y(this,Zn).add(t);const r=zc(t);if(typeof r=="string"){const n=Y(this,mn).get(r);n?n.push(t):Y(this,mn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Y(this,Zn).delete(t)){const r=zc(t);if(typeof r=="string"){const n=Y(this,mn).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&Y(this,mn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=zc(t);if(typeof r=="string"){const n=Y(this,mn).get(r),a=n==null?void 0:n.find(s=>s.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=zc(t);if(typeof r=="string"){const a=(n=Y(this,mn).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Wt.batch(()=>{Y(this,Zn).forEach(t=>{this.notify({type:"removed",mutation:t})}),Y(this,Zn).clear(),Y(this,mn).clear()})}getAll(){return Array.from(Y(this,Zn))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>o1(r,n))}findAll(t={}){return this.getAll().filter(r=>o1(t,r))}notify(t){Wt.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Wt.batch(()=>Promise.all(t.map(r=>r.continue().catch(br))))}},Zn=new WeakMap,mn=new WeakMap,sc=new WeakMap,Bv);function zc(e){var t;return(t=e.options.scope)==null?void 0:t.id}var jn,Uv,M4=(Uv=class extends dc{constructor(t={}){super();Ee(this,jn,void 0);this.config=t,ve(this,jn,new Map)}build(t,r,n){const a=r.queryKey,s=r.queryHash??Wm(a,r);let i=this.get(s);return i||(i=new A4({client:t,queryKey:a,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){Y(this,jn).has(t.queryHash)||(Y(this,jn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Y(this,jn).get(t.queryHash);r&&(t.destroy(),r===t&&Y(this,jn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Wt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Y(this,jn).get(t)}getAll(){return[...Y(this,jn).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>i1(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>i1(t,n)):r}notify(t){Wt.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Wt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Wt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},jn=new WeakMap,Uv),pt,Da,ja,Wi,Ki,Ia,Gi,Yi,$v,L4=($v=class{constructor(e={}){Ee(this,pt,void 0);Ee(this,Da,void 0);Ee(this,ja,void 0);Ee(this,Wi,void 0);Ee(this,Ki,void 0);Ee(this,Ia,void 0);Ee(this,Gi,void 0);Ee(this,Yi,void 0);ve(this,pt,e.queryCache||new M4),ve(this,Da,e.mutationCache||new O4),ve(this,ja,e.defaultOptions||{}),ve(this,Wi,new Map),ve(this,Ki,new Map),ve(this,Ia,0)}mount(){_c(this,Ia)._++,Y(this,Ia)===1&&(ve(this,Gi,Gm.subscribe(async e=>{e&&(await this.resumePausedMutations(),Y(this,pt).onFocus())})),ve(this,Yi,qu.subscribe(async e=>{e&&(await this.resumePausedMutations(),Y(this,pt).onOnline())})))}unmount(){var e,t;_c(this,Ia)._--,Y(this,Ia)===0&&((e=Y(this,Gi))==null||e.call(this),ve(this,Gi,void 0),(t=Y(this,Yi))==null||t.call(this),ve(this,Yi,void 0))}isFetching(e){return Y(this,pt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Y(this,Da).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Y(this,pt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Y(this,pt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(qa(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return Y(this,pt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=Y(this,pt).get(n.queryHash),s=a==null?void 0:a.state.data,i=v4(t,s);if(i!==void 0)return Y(this,pt).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return Wt.batch(()=>Y(this,pt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Y(this,pt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Y(this,pt);Wt.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Y(this,pt);return Wt.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Wt.batch(()=>Y(this,pt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(br).catch(br)}invalidateQueries(e,t={}){return Wt.batch(()=>(Y(this,pt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Wt.batch(()=>Y(this,pt).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,r);return r.throwOnError||(s=s.catch(br)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(br)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Y(this,pt).build(this,t);return r.isStaleByTime(qa(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(br).catch(br)}fetchInfiniteQuery(e){return e.behavior=h1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(br).catch(br)}ensureInfiniteQueryData(e){return e.behavior=h1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return qu.isOnline()?Y(this,Da).resumePausedMutations():Promise.resolve()}getQueryCache(){return Y(this,pt)}getMutationCache(){return Y(this,Da)}getDefaultOptions(){return Y(this,ja)}setDefaultOptions(e){ve(this,ja,e)}setQueryDefaults(e,t){Y(this,Wi).set(jl(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Y(this,Wi).values()],r={};return t.forEach(n=>{Il(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){Y(this,Ki).set(jl(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Y(this,Ki).values()],r={};return t.forEach(n=>{Il(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Y(this,ja).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Wm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Km&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Y(this,ja).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Y(this,pt).clear(),Y(this,Da).clear()}},pt=new WeakMap,Da=new WeakMap,ja=new WeakMap,Wi=new WeakMap,Ki=new WeakMap,Ia=new WeakMap,Gi=new WeakMap,Yi=new WeakMap,$v),lw=V.createContext(void 0),B4=e=>{const t=V.useContext(lw);if(e)return e;if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},U4=({client:e,children:t})=>(V.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),u.jsx(lw.Provider,{value:e,children:t})),cw=V.createContext(!1),$4=()=>V.useContext(cw);cw.Provider;function z4(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var V4=V.createContext(z4()),H4=()=>V.useContext(V4),W4=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},K4=e=>{V.useEffect(()=>{e.clearReset()},[e])},G4=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||E4(r,[e.error,n])),Y4=e=>{if(e.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},X4=(e,t)=>e.isLoading&&e.isFetching&&!t,q4=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,p1=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Q4(e,t,r){var f,h,p,x,m;const n=$4(),a=H4(),s=B4(r),i=s.defaultQueryOptions(e);(h=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||h.call(f,i),i._optimisticResults=n?"isRestoring":"optimistic",Y4(i),W4(i,a),K4(a);const o=!s.getQueryCache().get(i.queryHash),[l]=V.useState(()=>new t(s,i)),c=l.getOptimisticResult(i),d=!n&&e.subscribed!==!1;if(V.useSyncExternalStore(V.useCallback(v=>{const g=d?l.subscribe(Wt.batchCalls(v)):br;return l.updateResult(),g},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),V.useEffect(()=>{l.setOptions(i)},[i,l]),q4(i,c))throw p1(i,l,a);if(G4({result:c,errorResetBoundary:a,throwOnError:i.throwOnError,query:s.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw c.error;if((x=(p=s.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||x.call(p,i,c),i.experimental_prefetchInRender&&!Ys&&X4(c,n)){const v=o?p1(i,l,a):(m=s.getQueryCache().get(i.queryHash))==null?void 0:m.promise;v==null||v.catch(br).finally(()=>{l.updateResult()})}return i.notifyOnChangeProps?c:l.trackResult(c)}function J4(e,t){return Q4(e,F4,t)}var Z4=function(){return null};const Ri=new WeakMap,vu=new WeakMap,Qu={current:[]};let jd=!1,nl=0;const zo=new Set,Vc=new Map;function uw(e){const t=Array.from(e).sort((r,n)=>r instanceof Di&&r.options.deps.includes(n)?1:n instanceof Di&&n.options.deps.includes(r)?-1:0);for(const r of t){if(Qu.current.includes(r))continue;Qu.current.push(r),r.recompute();const n=vu.get(r);if(n)for(const a of n){const s=Ri.get(a);s&&uw(s)}}}function eT(e){const t={prevVal:e.prevState,currentVal:e.state};for(const r of e.listeners)r(t)}function tT(e){const t={prevVal:e.prevState,currentVal:e.state};for(const r of e.listeners)r(t)}function dw(e){if(nl>0&&!Vc.has(e)&&Vc.set(e,e.prevState),zo.add(e),!(nl>0)&&!jd)try{for(jd=!0;zo.size>0;){const t=Array.from(zo);zo.clear();for(const r of t){const n=Vc.get(r)??r.prevState;r.prevState=n,eT(r)}for(const r of t){const n=Ri.get(r);n&&(Qu.current.push(r),uw(n))}for(const r of t){const n=Ri.get(r);if(n)for(const a of n)tT(a)}}}finally{jd=!1,Qu.current=[],Vc.clear()}}function al(e){nl++;try{e()}finally{if(nl--,nl===0){const t=zo.values().next().value;t&&dw(t)}}}function rT(e){return typeof e=="function"}class dh{constructor(t,r){this.listeners=new Set,this.subscribe=n=>{var a,s;this.listeners.add(n);const i=(s=(a=this.options)==null?void 0:a.onSubscribe)==null?void 0:s.call(a,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.prevState=t,this.state=t,this.options=r}setState(t){var r,n,a;this.prevState=this.state,(r=this.options)!=null&&r.updateFn?this.state=this.options.updateFn(this.prevState)(t):rT(t)?this.state=t(this.prevState):this.state=t,(a=(n=this.options)==null?void 0:n.onUpdate)==null||a.call(n),dw(this)}}class Di{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const r=this.options.deps.length,n=new Array(r),a=new Array(r);for(let s=0;s<r;s++){const i=this.options.deps[s];n[s]=i.prevState,a[s]=i.state}return this.lastSeenDepValues=a,{prevDepVals:n,currDepVals:a,prevVal:this.prevState??void 0}},this.recompute=()=>{var r,n;this.prevState=this.state;const a=this.getDepVals();this.state=this.options.fn(a),(n=(r=this.options).onUpdate)==null||n.call(r)},this.checkIfRecalculationNeededDeeply=()=>{for(const s of this.options.deps)s instanceof Di&&s.checkIfRecalculationNeededDeeply();let r=!1;const n=this.lastSeenDepValues,{currDepVals:a}=this.getDepVals();for(let s=0;s<a.length;s++)if(a[s]!==n[s]){r=!0;break}r&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const r of this._subscriptions)r()}),this.subscribe=r=>{var n,a;this.listeners.add(r);const s=(a=(n=this.options).onSubscribe)==null?void 0:a.call(n,r,this);return()=>{this.listeners.delete(r),s==null||s()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const r of t)if(r instanceof Di)r.registerOnGraph(),this.registerOnGraph(r.options.deps);else if(r instanceof dh){let n=Ri.get(r);n||(n=new Set,Ri.set(r,n)),n.add(this);let a=vu.get(this);a||(a=new Set,vu.set(this,a)),a.add(r)}}unregisterFromGraph(t=this.options.deps){for(const r of t)if(r instanceof Di)this.unregisterFromGraph(r.options.deps);else if(r instanceof dh){const n=Ri.get(r);n&&n.delete(this);const a=vu.get(this);a&&a.delete(r)}}}const Qa="__TSR_index",x1="popstate",g1="beforeunload";function nT(e){let t=e.getLocation();const r=new Set,n=i=>{t=e.getLocation(),r.forEach(o=>o({location:t,action:i}))},a=i=>{e.notifyOnIndexChange??!0?n(i):t=e.getLocation()},s=async({task:i,navigateOpts:o,...l})=>{var h,p;if((o==null?void 0:o.ignoreBlocker)??!1){i();return}const d=((h=e.getBlockers)==null?void 0:h.call(e))??[],f=l.type==="PUSH"||l.type==="REPLACE";if(typeof document<"u"&&d.length&&f)for(const x of d){const m=Ju(l.path,l.state);if(await x.blockerFn({currentLocation:t,nextLocation:m,action:l.type})){(p=e.onBlocked)==null||p.call(e);return}}i()};return{get location(){return t},get length(){return e.getLength()},subscribers:r,subscribe:i=>(r.add(i),()=>{r.delete(i)}),push:(i,o,l)=>{const c=t.state[Qa];o=v1(c+1,o),s({task:()=>{e.pushState(i,o),n({type:"PUSH"})},navigateOpts:l,type:"PUSH",path:i,state:o})},replace:(i,o,l)=>{const c=t.state[Qa];o=v1(c,o),s({task:()=>{e.replaceState(i,o),n({type:"REPLACE"})},navigateOpts:l,type:"REPLACE",path:i,state:o})},go:(i,o)=>{s({task:()=>{e.go(i),a({type:"GO",index:i})},navigateOpts:o,type:"GO"})},back:i=>{s({task:()=>{e.back((i==null?void 0:i.ignoreBlocker)??!1),a({type:"BACK"})},navigateOpts:i,type:"BACK"})},forward:i=>{s({task:()=>{e.forward((i==null?void 0:i.ignoreBlocker)??!1),a({type:"FORWARD"})},navigateOpts:i,type:"FORWARD"})},canGoBack:()=>t.state[Qa]!==0,createHref:i=>e.createHref(i),block:i=>{var l;if(!e.setBlockers)return()=>{};const o=((l=e.getBlockers)==null?void 0:l.call(e))??[];return e.setBlockers([...o,i]),()=>{var d,f;const c=((d=e.getBlockers)==null?void 0:d.call(e))??[];(f=e.setBlockers)==null||f.call(e,c.filter(h=>h!==i))}},flush:()=>{var i;return(i=e.flush)==null?void 0:i.call(e)},destroy:()=>{var i;return(i=e.destroy)==null?void 0:i.call(e)},notify:n}}function v1(e,t){t||(t={});const r=Xm();return{...t,key:r,__TSR_key:r,[Qa]:e}}function aT(e){var k,E;const t=(e==null?void 0:e.window)??(typeof document<"u"?window:void 0),r=t.history.pushState,n=t.history.replaceState;let a=[];const s=()=>a,i=_=>a=_,o=(e==null?void 0:e.createHref)??(_=>_),l=(e==null?void 0:e.parseLocation)??(()=>Ju(`${t.location.pathname}${t.location.search}${t.location.hash}`,t.history.state));if(!((k=t.history.state)!=null&&k.__TSR_key)&&!((E=t.history.state)!=null&&E.key)){const _=Xm();t.history.replaceState({[Qa]:0,key:_,__TSR_key:_},"")}let c=l(),d,f=!1,h=!1,p=!1,x=!1;const m=()=>c;let v,g;const y=()=>{v&&(b._ignoreSubscribers=!0,(v.isPush?t.history.pushState:t.history.replaceState)(v.state,"",v.href),b._ignoreSubscribers=!1,v=void 0,g=void 0,d=void 0)},w=(_,C,F)=>{const D=o(C);g||(d=c),c=Ju(C,F),v={href:D,state:F,isPush:(v==null?void 0:v.isPush)||_==="push"},g||(g=Promise.resolve().then(()=>y()))},S=_=>{c=l(),b.notify({type:_})},A=async()=>{if(h){h=!1;return}const _=l(),C=_.state[Qa]-c.state[Qa],F=C===1,D=C===-1,M=!F&&!D||f;f=!1;const B=M?"GO":D?"BACK":"FORWARD",q=M?{type:"GO",index:C}:{type:D?"BACK":"FORWARD"};if(p)p=!1;else{const Q=s();if(typeof document<"u"&&Q.length){for(const J of Q)if(await J.blockerFn({currentLocation:c,nextLocation:_,action:B})){h=!0,t.history.go(1),b.notify(q);return}}}c=l(),b.notify(q)},T=_=>{if(x){x=!1;return}let C=!1;const F=s();if(typeof document<"u"&&F.length)for(const D of F){const M=D.enableBeforeUnload??!0;if(M===!0){C=!0;break}if(typeof M=="function"&&M()===!0){C=!0;break}}if(C)return _.preventDefault(),_.returnValue=""},b=nT({getLocation:m,getLength:()=>t.history.length,pushState:(_,C)=>w("push",_,C),replaceState:(_,C)=>w("replace",_,C),back:_=>(_&&(p=!0),x=!0,t.history.back()),forward:_=>{_&&(p=!0),x=!0,t.history.forward()},go:_=>{f=!0,t.history.go(_)},createHref:_=>o(_),flush:y,destroy:()=>{t.history.pushState=r,t.history.replaceState=n,t.removeEventListener(g1,T,{capture:!0}),t.removeEventListener(x1,A)},onBlocked:()=>{d&&c!==d&&(c=d)},getBlockers:s,setBlockers:i,notifyOnIndexChange:!1});return t.addEventListener(g1,T,{capture:!0}),t.addEventListener(x1,A),t.history.pushState=function(..._){const C=r.apply(t.history,_);return b._ignoreSubscribers||S("PUSH"),C},t.history.replaceState=function(..._){const C=n.apply(t.history,_);return b._ignoreSubscribers||S("REPLACE"),C},b}function Ju(e,t){const r=e.indexOf("#"),n=e.indexOf("?"),a=Xm();return{href:e,pathname:e.substring(0,r>0?n>0?Math.min(r,n):r:n>0?n:e.length),hash:r>-1?e.substring(r):"",search:n>-1?e.slice(n,r===-1?void 0:r):"",state:t||{[Qa]:0,key:a,__TSR_key:a}}}function Xm(){return(Math.random()+1).toString(36).substring(7)}function fh(e){return e[e.length-1]}function sT(e){return typeof e=="function"}function Ms(e,t){return sT(e)?e(t):e}const iT=Object.prototype.hasOwnProperty;function qr(e,t){if(e===t)return e;const r=t,n=k1(e)&&k1(r);if(!n&&!(Zu(e)&&Zu(r)))return r;const a=n?e:y1(e);if(!a)return r;const s=n?r:y1(r);if(!s)return r;const i=a.length,o=s.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:s[d],h=e[f],p=r[f];if(h===p){l[f]=h,(n?d<i:iT.call(e,f))&&c++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){l[f]=p;continue}const x=qr(h,p);l[f]=x,x===h&&c++}return i===o&&c===i?e:l}function y1(e){const t=[],r=Object.getOwnPropertyNames(e);for(const a of r){if(!Object.prototype.propertyIsEnumerable.call(e,a))return!1;t.push(a)}const n=Object.getOwnPropertySymbols(e);for(const a of n){if(!Object.prototype.propertyIsEnumerable.call(e,a))return!1;t.push(a)}return t}function Zu(e){if(!w1(e))return!1;const t=e.constructor;if(typeof t>"u")return!0;const r=t.prototype;return!(!w1(r)||!r.hasOwnProperty("isPrototypeOf"))}function w1(e){return Object.prototype.toString.call(e)==="[object Object]"}function k1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ls(e,t,r){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0,a=e.length;n<a;n++)if(!Ls(e[n],t[n],r))return!1;return!0}if(Zu(e)&&Zu(t)){const n=(r==null?void 0:r.ignoreUndefined)??!0;if(r!=null&&r.partial){for(const i in t)if((!n||t[i]!==void 0)&&!Ls(e[i],t[i],r))return!1;return!0}let a=0;if(!n)a=Object.keys(e).length;else for(const i in e)e[i]!==void 0&&a++;let s=0;for(const i in t)if((!n||t[i]!==void 0)&&(s++,s>a||!Ls(e[i],t[i],r)))return!1;return a===s}return!1}function ro(e){let t,r;const n=new Promise((a,s)=>{t=a,r=s});return n.status="pending",n.resolve=a=>{n.status="resolved",n.value=a,t(a),e==null||e(a)},n.reject=a=>{n.status="rejected",r(a)},n}function Ja(e){return!!(e&&typeof e=="object"&&typeof e.then=="function")}var oT="Invariant failed";function da(e,t){if(!e)throw new Error(oT)}const Tr="__root__",$n=0,Xs=1,no=2,ao=3;function aa(e){return qm(e.filter(t=>t!==void 0).join("/"))}function qm(e){return e.replace(/\/{2,}/g,"/")}function Qm(e){return e==="/"?e:e.replace(/^\/{1,}/,"")}function Za(e){return e==="/"?e:e.replace(/\/{1,}$/,"")}function yu(e){return Za(Qm(e))}function e0(e,t){return e!=null&&e.endsWith("/")&&e!=="/"&&e!==`${t}/`?e.slice(0,-1):e}function lT(e,t,r){return e0(e,r)===e0(t,r)}function cT(e){const{type:t,value:r}=e;if(t===$n)return r;const{prefixSegment:n,suffixSegment:a}=e;if(t===Xs){const s=r.substring(1);if(n&&a)return`${n}{$${s}}${a}`;if(n)return`${n}{$${s}}`;if(a)return`{$${s}}${a}`}if(t===ao){const s=r.substring(1);return n&&a?`${n}{-$${s}}${a}`:n?`${n}{-$${s}}`:a?`{-$${s}}${a}`:`{-$${s}}`}if(t===no){if(n&&a)return`${n}{$}${a}`;if(n)return`${n}{$}`;if(a)return`{$}${a}`}return r}function uT({base:e,to:t,trailingSlash:r="never",parseCache:n}){var l;let a=fw(e,n).slice();const s=L0(t,n);a.length>1&&((l=fh(a))==null?void 0:l.value)==="/"&&a.pop();for(let c=0,d=s.length;c<d;c++){const f=s[c],h=f.value;h==="/"?c?c===d-1&&a.push(f):a=[f]:h===".."?a.pop():h==="."||a.push(f)}a.length>1&&(fh(a).value==="/"?r==="never"&&a.pop():r==="always"&&a.push({type:$n,value:"/"}));const i=a.map(cT);return aa(i)}const fw=(e,t)=>hw(e,t,!0),L0=(e,t)=>hw(e,t,!1),hw=(e,t,r)=>{if(!e)return[];const n=t==null?void 0:t.get(e);if(n)return n;const a=xT(e,r);return t==null||t.set(e,a),a},dT=/^\$.{1,}$/,fT=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,hT=/^(.*?)\{-(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,mT=/^\$$/,pT=/^(.*?)\{\$\}(.*)$/;function xT(e,t){e=qm(e);const r=[];if(e.slice(0,1)==="/"&&(e=e.substring(1),r.push({type:$n,value:"/"})),!e)return r;const n=e.split("/").filter(Boolean);return r.push(...n.map(a=>{const s=!t&&a!==Tr&&a.slice(-1)==="_"?a.slice(0,-1):a,i=s.match(pT);if(i){const c=i[1],d=i[2];return{type:no,value:"$",prefixSegment:c||void 0,suffixSegment:d||void 0}}const o=s.match(hT);if(o){const c=o[1],d=o[2],f=o[3];return{type:ao,value:d,prefixSegment:c||void 0,suffixSegment:f||void 0}}const l=s.match(fT);if(l){const c=l[1],d=l[2],f=l[3];return{type:Xs,value:""+d,prefixSegment:c||void 0,suffixSegment:f||void 0}}if(dT.test(s)){const c=s.substring(1);return{type:Xs,value:"$"+c,prefixSegment:void 0,suffixSegment:void 0}}return mT.test(s)?{type:no,value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:$n,value:s.includes("%25")?s.split("%25").map(c=>decodeURI(c)).join("%25"):decodeURI(s)}})),e.slice(-1)==="/"&&(e=e.substring(1),r.push({type:$n,value:"/"})),r}function Hc({path:e,params:t,leaveWildcards:r,leaveParams:n,decodeCharMap:a,parseCache:s}){const i=L0(e,s);function o(f){const h=t[f],p=typeof h=="string";return f==="*"||f==="_splat"?p?encodeURI(h):h:p?gT(h,a):h}let l=!1;const c={},d=aa(i.map(f=>{if(f.type===$n)return f.value;if(f.type===no){c._splat=t._splat,c["*"]=t._splat;const h=f.prefixSegment||"",p=f.suffixSegment||"";if(!("_splat"in t))return l=!0,r?`${h}${f.value}${p}`:h||p?`${h}${p}`:void 0;const x=o("_splat");return r?`${h}${f.value}${x??""}${p}`:`${h}${x}${p}`}if(f.type===Xs){const h=f.value.substring(1);!l&&!(h in t)&&(l=!0),c[h]=t[h];const p=f.prefixSegment||"",x=f.suffixSegment||"";if(n){const m=o(f.value);return`${p}${f.value}${m??""}${x}`}return`${p}${o(h)??"undefined"}${x}`}if(f.type===ao){const h=f.value.substring(1),p=f.prefixSegment||"",x=f.suffixSegment||"";if(!(h in t)||t[h]==null)return r?`${p}${h}${x}`:p||x?`${p}${x}`:void 0;if(c[h]=t[h],n){const m=o(f.value);return`${p}${f.value}${m??""}${x}`}return r?`${p}${h}${o(h)??""}${x}`:`${p}${o(h)??""}${x}`}return f.value}));return{usedParams:c,interpolatedPath:d,isMissingParams:l}}function gT(e,t){let r=encodeURIComponent(e);if(t)for(const[n,a]of t)r=r.replaceAll(n,a);return r}function hh(e,t,r){const n=vT(e,t,r);if(!(t.to&&!n))return n??{}}function vT(e,{to:t,fuzzy:r,caseSensitive:n},a){const s=t,i=fw(e.startsWith("/")?e:`/${e}`,a),o=L0(s.startsWith("/")?s:`/${s}`,a),l={};return yT(i,o,l,r,n)?l:void 0}function yT(e,t,r,n,a){var o,l,c;let s=0,i=0;for(;s<e.length||i<t.length;){const d=e[s],f=t[i];if(f){if(f.type===no){const h=e.slice(s);let p;if(f.prefixSegment||f.suffixSegment){if(!d)return!1;const x=f.prefixSegment||"",m=f.suffixSegment||"",v=d.value;if("prefixSegment"in f&&!v.startsWith(x)||"suffixSegment"in f&&!((o=e[e.length-1])!=null&&o.value.endsWith(m)))return!1;let g=decodeURI(aa(h.map(y=>y.value)));x&&g.startsWith(x)&&(g=g.slice(x.length)),m&&g.endsWith(m)&&(g=g.slice(0,g.length-m.length)),p=g}else p=decodeURI(aa(h.map(x=>x.value)));return r["*"]=p,r._splat=p,!0}if(f.type===$n){if(f.value==="/"&&!(d!=null&&d.value)){i++;continue}if(d){if(a){if(f.value!==d.value)return!1}else if(f.value.toLowerCase()!==d.value.toLowerCase())return!1;s++,i++;continue}else return!1}if(f.type===Xs){if(!d||d.value==="/")return!1;let h="",p=!1;if(f.prefixSegment||f.suffixSegment){const x=f.prefixSegment||"",m=f.suffixSegment||"",v=d.value;if(x&&!v.startsWith(x)||m&&!v.endsWith(m))return!1;let g=v;x&&g.startsWith(x)&&(g=g.slice(x.length)),m&&g.endsWith(m)&&(g=g.slice(0,g.length-m.length)),h=decodeURIComponent(g),p=!0}else h=decodeURIComponent(d.value),p=!0;p&&(r[f.value.substring(1)]=h,s++),i++;continue}if(f.type===ao){if(!d){i++;continue}if(d.value==="/"){i++;continue}let h="",p=!1;if(f.prefixSegment||f.suffixSegment){const x=f.prefixSegment||"",m=f.suffixSegment||"",v=d.value;if((!x||v.startsWith(x))&&(!m||v.endsWith(m))){let g=v;x&&g.startsWith(x)&&(g=g.slice(x.length)),m&&g.endsWith(m)&&(g=g.slice(0,g.length-m.length)),h=decodeURIComponent(g),p=!0}}else{let x=!0;for(let m=i+1;m<t.length;m++){const v=t[m];if((v==null?void 0:v.type)===$n&&v.value===d.value){x=!1;break}if((v==null?void 0:v.type)===Xs||(v==null?void 0:v.type)===no){e.length<t.length&&(x=!1);break}}x&&(h=decodeURIComponent(d.value),p=!0)}p&&(r[f.value.substring(1)]=h,s++),i++;continue}}if(s<e.length&&i>=t.length)return r["**"]=aa(e.slice(s).map(h=>h.value)),!!n&&((l=t[t.length-1])==null?void 0:l.value)!=="/";if(i<t.length&&s>=e.length){for(let h=i;h<t.length;h++)if(((c=t[h])==null?void 0:c.type)!==ao)return!1;break}break}return!0}const wT=.75,kT=1,ST=.5,ET=.4,_T=.25,bT=.2,TT=.05,CT=.02,NT=.01,S1=2e-4,E1=1e-4;function _1(e,t){return e.prefixSegment&&e.suffixSegment?t+TT+S1*e.prefixSegment.length+E1*e.suffixSegment.length:e.prefixSegment?t+CT+S1*e.prefixSegment.length:e.suffixSegment?t+NT+E1*e.suffixSegment.length:t}function AT(e){const t=[];return e.forEach((n,a)=>{var f;if(n.isRoot||!n.path)return;const s=Qm(n.fullPath);let i=L0(s),o=0;for(;i.length>o+1&&((f=i[o])==null?void 0:f.value)==="/";)o++;o>0&&(i=i.slice(o));let l=0,c=!1;const d=i.map((h,p)=>{if(h.value==="/")return wT;if(h.type===$n)return kT;let x;h.type===Xs?x=ST:h.type===ao?(x=ET,l++):x=_T;for(let m=p+1;m<i.length;m++){const v=i[m];if(v.type===$n&&v.value!=="/")return c=!0,_1(h,x+bT)}return _1(h,x)});t.push({child:n,trimmed:s,parsed:i,index:a,scores:d,optionalParamCount:l,hasStaticAfter:c})}),t.sort((n,a)=>{const s=Math.min(n.scores.length,a.scores.length);for(let i=0;i<s;i++)if(n.scores[i]!==a.scores[i])return a.scores[i]-n.scores[i];if(n.scores.length!==a.scores.length){if(n.optionalParamCount!==a.optionalParamCount){if(n.hasStaticAfter===a.hasStaticAfter)return n.optionalParamCount-a.optionalParamCount;if(n.hasStaticAfter&&!a.hasStaticAfter)return-1;if(!n.hasStaticAfter&&a.hasStaticAfter)return 1}return a.scores.length-n.scores.length}for(let i=0;i<s;i++)if(n.parsed[i].value!==a.parsed[i].value)return n.parsed[i].value>a.parsed[i].value?1:-1;return n.index-a.index}).map((n,a)=>(n.child.rank=a,n.child))}function FT({routeTree:e,initRoute:t}){const r={},n={},a=i=>{i.forEach((o,l)=>{t==null||t(o,l);const c=r[o.id];if(da(!c,`Duplicate routes found with id: ${String(o.id)}`),r[o.id]=o,!o.isRoot&&o.path){const f=Za(o.fullPath);(!n[f]||o.fullPath.endsWith("/"))&&(n[f]=o)}const d=o.children;d!=null&&d.length&&a(d)})};a([e]);const s=AT(Object.values(r));return{routesById:r,routesByPath:n,flatRoutes:s}}function zn(e){return!!(e!=null&&e.isNotFound)}function PT(){try{if(typeof window<"u"&&typeof window.sessionStorage=="object")return window.sessionStorage}catch{}}const t0="tsr-scroll-restoration-v1_3",RT=(e,t)=>{let r;return(...n)=>{r||(r=setTimeout(()=>{e(...n),r=null},t))}};function DT(){const e=PT();if(!e)return null;const t=e.getItem(t0);let r=t?JSON.parse(t):{};return{state:r,set:n=>(r=Ms(n,r)||r,e.setItem(t0,JSON.stringify(r)))}}const Wc=DT(),mh=e=>e.state.__TSR_key||e.href;function jT(e){const t=[];let r;for(;r=e.parentNode;)t.push(`${e.tagName}:nth-child(${Array.prototype.indexOf.call(r.children,e)+1})`),e=r;return`${t.reverse().join(" > ")}`.toLowerCase()}let r0=!1;function mw({storageKey:e,key:t,behavior:r,shouldScrollRestoration:n,scrollToTopSelectors:a,location:s}){var c,d;let i;try{i=JSON.parse(sessionStorage.getItem(e)||"{}")}catch(f){console.error(f);return}const o=t||((c=window.history.state)==null?void 0:c.__TSR_key),l=i[o];r0=!0;e:{if(n&&l&&Object.keys(l).length>0){for(const p in l){const x=l[p];if(p==="window")window.scrollTo({top:x.scrollY,left:x.scrollX,behavior:r});else if(p){const m=document.querySelector(p);m&&(m.scrollLeft=x.scrollX,m.scrollTop=x.scrollY)}}break e}const f=(s??window.location).hash.split("#",2)[1];if(f){const p=((d=window.history.state)==null?void 0:d.__hashScrollIntoViewOptions)??!0;if(p){const x=document.getElementById(f);x&&x.scrollIntoView(p)}break e}const h={top:0,left:0,behavior:r};if(window.scrollTo(h),a)for(const p of a){if(p==="window")continue;const x=typeof p=="function"?p():document.querySelector(p);x&&x.scrollTo(h)}}r0=!1}function IT(e,t){if(!Wc&&!e.isServer||((t??e.options.scrollRestoration??!1)&&(e.isScrollRestoring=!0),e.isServer||e.isScrollRestorationSetup||!Wc))return;e.isScrollRestorationSetup=!0,r0=!1;const n=e.options.getScrollRestorationKey||mh;window.history.scrollRestoration="manual";const a=s=>{if(r0||!e.isScrollRestoring)return;let i="";if(s.target===document||s.target===window)i="window";else{const l=s.target.getAttribute("data-scroll-restoration-id");l?i=`[data-scroll-restoration-id="${l}"]`:i=jT(s.target)}const o=n(e.state.location);Wc.set(l=>{const c=l[o]||(l[o]={}),d=c[i]||(c[i]={});if(i==="window")d.scrollX=window.scrollX||0,d.scrollY=window.scrollY||0;else if(i){const f=document.querySelector(i);f&&(d.scrollX=f.scrollLeft||0,d.scrollY=f.scrollTop||0)}return l})};typeof document<"u"&&document.addEventListener("scroll",RT(a,100),!0),e.subscribe("onRendered",s=>{const i=n(s.toLocation);if(!e.resetNextScroll){e.resetNextScroll=!0;return}typeof e.options.scrollRestoration=="function"&&!e.options.scrollRestoration({location:e.latestLocation})||(mw({storageKey:t0,key:i,behavior:e.options.scrollRestorationBehavior,shouldScrollRestoration:e.isScrollRestoring,scrollToTopSelectors:e.options.scrollToTopSelectors,location:e.history.location}),e.isScrollRestoring&&Wc.set(o=>(o[i]||(o[i]={}),o)))})}function OT(e){if(typeof document<"u"&&document.querySelector){const t=e.state.location.state.__hashScrollIntoViewOptions??!0;if(t&&e.state.location.hash!==""){const r=document.getElementById(e.state.location.hash);r&&r.scrollIntoView(t)}}}function MT(e,t=String){const r=new URLSearchParams;for(const n in e){const a=e[n];a!==void 0&&r.set(n,t(a))}return r.toString()}function Id(e){return e?e==="false"?!1:e==="true"?!0:+e*0===0&&+e+""===e?+e:e:""}function LT(e){const t=new URLSearchParams(e),r={};for(const[n,a]of t.entries()){const s=r[n];s==null?r[n]=Id(a):Array.isArray(s)?s.push(Id(a)):r[n]=[s,Id(a)]}return r}const BT=$T(JSON.parse),UT=zT(JSON.stringify,JSON.parse);function $T(e){return t=>{t[0]==="?"&&(t=t.substring(1));const r=LT(t);for(const n in r){const a=r[n];if(typeof a=="string")try{r[n]=e(a)}catch{}}return r}}function zT(e,t){const r=typeof t=="function";function n(a){if(typeof a=="object"&&a!==null)try{return e(a)}catch{}else if(r&&typeof a=="string")try{return t(a),e(a)}catch{}return a}return a=>{const s=MT(a,n);return s?`?${s}`:""}}function VT(e){if(e.statusCode=e.statusCode||e.code||307,!e.reloadDocument&&typeof e.href=="string")try{new URL(e.href),e.reloadDocument=!0}catch{}const t=new Headers(e.headers);e.href&&t.get("Location")===null&&t.set("Location",e.href);const r=new Response(null,{status:e.statusCode,headers:t});if(r.options=e,e.throw)throw r;return r}function On(e){return e instanceof Response&&!!e.options}function HT(e){const t=new Map;let r,n;const a=s=>{s.next&&(s.prev?(s.prev.next=s.next,s.next.prev=s.prev,s.next=void 0,n&&(n.next=s,s.prev=n)):(s.next.prev=void 0,r=s.next,s.next=void 0,n&&(s.prev=n,n.next=s)),n=s)};return{get(s){const i=t.get(s);if(i)return a(i),i.value},set(s,i){if(t.size>=e&&r){const l=r;t.delete(l.key),l.next&&(r=l.next,l.next.prev=void 0),l===n&&(n=void 0)}const o=t.get(s);if(o)o.value=i,a(o);else{const l={key:s,value:i,prev:n};n&&(n.next=l),n=l,r||(r=l),t.set(s,l)}}}}const wu=e=>{var t;if(!e.rendered)return e.rendered=!0,(t=e.onReady)==null?void 0:t.call(e)},B0=(e,t)=>!!(e.preload&&!e.router.state.matches.some(r=>r.id===t)),pw=(e,t)=>{var a;const r=e.router.routesById[t.routeId??""]??e.router.routeTree;!r.options.notFoundComponent&&((a=e.router.options)!=null&&a.defaultNotFoundComponent)&&(r.options.notFoundComponent=e.router.options.defaultNotFoundComponent),da(r.options.notFoundComponent);const n=e.matches.find(s=>s.routeId===r.id);da(n,"Could not find match for route: "+r.id),e.updateMatch(n.id,s=>({...s,status:"notFound",error:t,isFetching:!1})),t.routerCode==="BEFORE_LOAD"&&r.parentRoute&&(t.routeId=r.parentRoute.id,pw(e,t))},La=(e,t,r)=>{var n,a,s;if(!(!On(r)&&!zn(r))){if(On(r)&&r.redirectHandled&&!r.options.reloadDocument)throw r;if(t){(n=t._nonReactive.beforeLoadPromise)==null||n.resolve(),(a=t._nonReactive.loaderPromise)==null||a.resolve(),t._nonReactive.beforeLoadPromise=void 0,t._nonReactive.loaderPromise=void 0;const i=On(r)?"redirected":"notFound";e.updateMatch(t.id,o=>({...o,status:i,isFetching:!1,error:r})),zn(r)&&!r.routeId&&(r.routeId=t.routeId),(s=t._nonReactive.loadPromise)==null||s.resolve()}throw On(r)?(e.rendered=!0,r.options._fromLocation=e.location,r.redirectHandled=!0,r=e.router.resolveRedirect(r),r):(pw(e,r),r)}},xw=(e,t)=>{const r=e.router.getMatch(t);return!!(!e.router.isServer&&r._nonReactive.dehydrated||e.router.isServer&&r.ssr===!1)},Do=(e,t,r,n)=>{var o,l;const{id:a,routeId:s}=e.matches[t],i=e.router.looseRoutesById[s];if(r instanceof Promise)throw r;r.routerCode=n,e.firstBadMatchIndex??(e.firstBadMatchIndex=t),La(e,e.router.getMatch(a),r);try{(l=(o=i.options).onError)==null||l.call(o,r)}catch(c){r=c,La(e,e.router.getMatch(a),r)}e.updateMatch(a,c=>{var d,f;return(d=c._nonReactive.beforeLoadPromise)==null||d.resolve(),c._nonReactive.beforeLoadPromise=void 0,(f=c._nonReactive.loadPromise)==null||f.resolve(),{...c,error:r,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController}})},WT=(e,t,r,n)=>{var p;const a=e.router.getMatch(t),s=(p=e.matches[r-1])==null?void 0:p.id,i=s?e.router.getMatch(s):void 0;if(e.router.isShell()){a.ssr=t===Tr;return}if((i==null?void 0:i.ssr)===!1){a.ssr=!1;return}const o=x=>x===!0&&(i==null?void 0:i.ssr)==="data-only"?"data-only":x,l=e.router.options.defaultSsr??!0;if(n.options.ssr===void 0){a.ssr=o(l);return}if(typeof n.options.ssr!="function"){a.ssr=o(n.options.ssr);return}const{search:c,params:d}=a,f={search:Kc(c,a.searchError),params:Kc(d,a.paramsError),location:e.location,matches:e.matches.map(x=>({index:x.index,pathname:x.pathname,fullPath:x.fullPath,staticData:x.staticData,id:x.id,routeId:x.routeId,search:Kc(x.search,x.searchError),params:Kc(x.params,x.paramsError),ssr:x.ssr}))},h=n.options.ssr(f);if(Ja(h))return h.then(x=>{a.ssr=o(x??l)});a.ssr=o(h??l)},gw=(e,t,r,n)=>{var i;if(n._nonReactive.pendingTimeout!==void 0)return;const a=r.options.pendingMs??e.router.options.defaultPendingMs;if(!!(e.onReady&&!e.router.isServer&&!B0(e,t)&&(r.options.loader||r.options.beforeLoad||ww(r))&&typeof a=="number"&&a!==1/0&&(r.options.pendingComponent??((i=e.router.options)==null?void 0:i.defaultPendingComponent)))){const o=setTimeout(()=>{wu(e)},a);n._nonReactive.pendingTimeout=o}},KT=(e,t,r)=>{const n=e.router.getMatch(t);if(!n._nonReactive.beforeLoadPromise&&!n._nonReactive.loaderPromise)return;gw(e,t,r,n);const a=()=>{const s=e.router.getMatch(t);s.preload&&(s.status==="redirected"||s.status==="notFound")&&La(e,s,s.error)};return n._nonReactive.beforeLoadPromise?n._nonReactive.beforeLoadPromise.then(a):a()},GT=(e,t,r,n)=>{var b;const a=e.router.getMatch(t),s=a._nonReactive.loadPromise;a._nonReactive.loadPromise=ro(()=>{s==null||s.resolve()});const{paramsError:i,searchError:o}=a;i&&Do(e,r,i,"PARSE_PARAMS"),o&&Do(e,r,o,"VALIDATE_SEARCH"),gw(e,t,n,a);const l=new AbortController,c=(b=e.matches[r-1])==null?void 0:b.id,d=c?e.router.getMatch(c):void 0,h={...(d==null?void 0:d.context)??e.router.options.context??void 0,...a.__routeContext};let p=!1;const x=()=>{p||(p=!0,e.updateMatch(t,k=>({...k,isFetching:"beforeLoad",fetchCount:k.fetchCount+1,abortController:l,context:h})))},m=()=>{var k;(k=a._nonReactive.beforeLoadPromise)==null||k.resolve(),a._nonReactive.beforeLoadPromise=void 0,e.updateMatch(t,E=>({...E,isFetching:!1}))};if(!n.options.beforeLoad){al(()=>{x(),m()});return}a._nonReactive.beforeLoadPromise=ro();const{search:v,params:g,cause:y}=a,w=B0(e,t),S={search:v,abortController:l,params:g,preload:w,context:h,location:e.location,navigate:k=>e.router.navigate({...k,_fromLocation:e.location}),buildLocation:e.router.buildLocation,cause:w?"preload":y,matches:e.matches,...e.router.options.additionalContext},A=k=>{if(k===void 0){al(()=>{x(),m()});return}(On(k)||zn(k))&&(x(),Do(e,r,k,"BEFORE_LOAD")),al(()=>{x(),e.updateMatch(t,E=>({...E,__beforeLoadContext:k,context:{...E.context,...k}})),m()})};let T;try{if(T=n.options.beforeLoad(S),Ja(T))return x(),T.catch(k=>{Do(e,r,k,"BEFORE_LOAD")}).then(A)}catch(k){x(),Do(e,r,k,"BEFORE_LOAD")}A(T)},YT=(e,t)=>{const{id:r,routeId:n}=e.matches[t],a=e.router.looseRoutesById[n],s=()=>{if(e.router.isServer){const l=WT(e,r,t,a);if(Ja(l))return l.then(o)}return o()},i=()=>GT(e,r,t,a),o=()=>{if(xw(e,r))return;const l=KT(e,r,a);return Ja(l)?l.then(i):i()};return s()},sl=(e,t,r)=>{var s,i,o,l,c,d;const n=e.router.getMatch(t);if(!n||!r.options.head&&!r.options.scripts&&!r.options.headers)return;const a={matches:e.matches,match:n,params:n.params,loaderData:n.loaderData};return Promise.all([(i=(s=r.options).head)==null?void 0:i.call(s,a),(l=(o=r.options).scripts)==null?void 0:l.call(o,a),(d=(c=r.options).headers)==null?void 0:d.call(c,a)]).then(([f,h,p])=>{const x=f==null?void 0:f.meta,m=f==null?void 0:f.links,v=f==null?void 0:f.scripts,g=f==null?void 0:f.styles;return{meta:x,links:m,headScripts:v,headers:p,scripts:h,styles:g}})},vw=(e,t,r,n)=>{const a=e.matchPromises[r-1],{params:s,loaderDeps:i,abortController:o,context:l,cause:c}=e.router.getMatch(t),d=B0(e,t);return{params:s,deps:i,preload:!!d,parentMatchPromise:a,abortController:o,context:l,location:e.location,navigate:f=>e.router.navigate({...f,_fromLocation:e.location}),cause:d?"preload":c,route:n,...e.router.options.additionalContext}},b1=async(e,t,r,n)=>{var a,s,i,o;try{const l=e.router.getMatch(t);try{(!e.router.isServer||l.ssr===!0)&&yw(n);const c=(s=(a=n.options).loader)==null?void 0:s.call(a,vw(e,t,r,n)),d=n.options.loader&&Ja(c);if(!!(d||n._lazyPromise||n._componentsPromise||n.options.head||n.options.scripts||n.options.headers||l._nonReactive.minPendingPromise)&&e.updateMatch(t,m=>({...m,isFetching:"loader"})),n.options.loader){const m=d?await c:c;La(e,e.router.getMatch(t),m),m!==void 0&&e.updateMatch(t,v=>({...v,loaderData:m}))}n._lazyPromise&&await n._lazyPromise;const h=sl(e,t,n),p=h?await h:void 0,x=l._nonReactive.minPendingPromise;x&&await x,n._componentsPromise&&await n._componentsPromise,e.updateMatch(t,m=>({...m,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),...p}))}catch(c){let d=c;const f=l._nonReactive.minPendingPromise;f&&await f,La(e,e.router.getMatch(t),c);try{(o=(i=n.options).onError)==null||o.call(i,c)}catch(x){d=x,La(e,e.router.getMatch(t),x)}const h=sl(e,t,n),p=h?await h:void 0;e.updateMatch(t,x=>({...x,error:d,status:"error",isFetching:!1,...p}))}}catch(l){const c=e.router.getMatch(t);if(c){const d=sl(e,t,n);if(d){const f=await d;e.updateMatch(t,h=>({...h,...f}))}c._nonReactive.loaderPromise=void 0}La(e,c,l)}},XT=async(e,t)=>{var c,d;const{id:r,routeId:n}=e.matches[t];let a=!1,s=!1;const i=e.router.looseRoutesById[n];if(xw(e,r)){if(e.router.isServer){const f=sl(e,r,i);if(f){const h=await f;e.updateMatch(r,p=>({...p,...h}))}return e.router.getMatch(r)}}else{const f=e.router.getMatch(r);if(f._nonReactive.loaderPromise){if(f.status==="success"&&!e.sync&&!f.preload)return f;await f._nonReactive.loaderPromise;const h=e.router.getMatch(r);h.error&&La(e,h,h.error)}else{const h=Date.now()-f.updatedAt,p=B0(e,r),x=p?i.options.preloadStaleTime??e.router.options.defaultPreloadStaleTime??3e4:i.options.staleTime??e.router.options.defaultStaleTime??0,m=i.options.shouldReload,v=typeof m=="function"?m(vw(e,r,t,i)):m,g=!!p&&!e.router.state.matches.some(A=>A.id===r),y=e.router.getMatch(r);y._nonReactive.loaderPromise=ro(),g!==y.preload&&e.updateMatch(r,A=>({...A,preload:g}));const{status:w,invalid:S}=y;if(a=w==="success"&&(S||(v??h>x)),!(p&&i.options.preload===!1))if(a&&!e.sync)s=!0,(async()=>{var A,T;try{await b1(e,r,t,i);const b=e.router.getMatch(r);(A=b._nonReactive.loaderPromise)==null||A.resolve(),(T=b._nonReactive.loadPromise)==null||T.resolve(),b._nonReactive.loaderPromise=void 0}catch(b){On(b)&&await e.router.navigate(b.options)}})();else if(w!=="success"||a&&e.sync)await b1(e,r,t,i);else{const A=sl(e,r,i);if(A){const T=await A;e.updateMatch(r,b=>({...b,...T}))}}}}const o=e.router.getMatch(r);s||((c=o._nonReactive.loaderPromise)==null||c.resolve(),(d=o._nonReactive.loadPromise)==null||d.resolve()),clearTimeout(o._nonReactive.pendingTimeout),o._nonReactive.pendingTimeout=void 0,s||(o._nonReactive.loaderPromise=void 0),o._nonReactive.dehydrated=void 0;const l=s?o.isFetching:!1;return l!==o.isFetching||o.invalid!==!1?(e.updateMatch(r,f=>({...f,isFetching:l,invalid:!1})),e.router.getMatch(r)):o};async function T1(e){const t=Object.assign(e,{matchPromises:[]});!t.router.isServer&&t.router.state.matches.some(r=>r._forcePending)&&wu(t);try{for(let a=0;a<t.matches.length;a++){const s=YT(t,a);Ja(s)&&await s}const r=t.firstBadMatchIndex??t.matches.length;for(let a=0;a<r;a++)t.matchPromises.push(XT(t,a));await Promise.all(t.matchPromises);const n=wu(t);Ja(n)&&await n}catch(r){if(zn(r)&&!t.preload){const n=wu(t);throw Ja(n)&&await n,r}if(On(r))throw r}return t.matches}async function yw(e){if(!e._lazyLoaded&&e._lazyPromise===void 0&&(e.lazyFn?e._lazyPromise=e.lazyFn().then(t=>{const{id:r,...n}=t.options;Object.assign(e.options,n),e._lazyLoaded=!0,e._lazyPromise=void 0}):e._lazyLoaded=!0),!e._componentsLoaded&&e._componentsPromise===void 0){const t=()=>{var n;const r=[];for(const a of kw){const s=(n=e.options[a])==null?void 0:n.preload;s&&r.push(s())}if(r.length)return Promise.all(r).then(()=>{e._componentsLoaded=!0,e._componentsPromise=void 0});e._componentsLoaded=!0,e._componentsPromise=void 0};e._componentsPromise=e._lazyPromise?e._lazyPromise.then(t):t()}return e._componentsPromise}function Kc(e,t){return t?{status:"error",error:t}:{status:"success",value:e}}function ww(e){var t;for(const r of kw)if((t=e.options[r])!=null&&t.preload)return!0;return!1}const kw=["component","errorComponent","pendingComponent","notFoundComponent"];function qT(e){return{input:({url:t})=>{for(const r of e)t=Sw(r,t);return t},output:({url:t})=>{for(let r=e.length-1;r>=0;r--)t=Ew(e[r],t);return t}}}function QT(e){const t=yu(e.basepath),r=`/${t}`,n=`${r}/`,a=e.caseSensitive?r:r.toLowerCase(),s=e.caseSensitive?n:n.toLowerCase();return{input:({url:i})=>{const o=e.caseSensitive?i.pathname:i.pathname.toLowerCase();return o===a?i.pathname="/":o.startsWith(s)&&(i.pathname=i.pathname.slice(r.length)),i},output:({url:i})=>(i.pathname=aa(["/",t,i.pathname]),i)}}function Sw(e,t){var n;const r=(n=e==null?void 0:e.input)==null?void 0:n.call(e,{url:t});if(r){if(typeof r=="string")return new URL(r);if(r instanceof URL)return r}return t}function Ew(e,t){var n;const r=(n=e==null?void 0:e.output)==null?void 0:n.call(e,{url:t});if(r){if(typeof r=="string")return new URL(r);if(r instanceof URL)return r}return t}function Bs(e){const t=e.resolvedLocation,r=e.location,n=(t==null?void 0:t.pathname)!==r.pathname,a=(t==null?void 0:t.href)!==r.href,s=(t==null?void 0:t.hash)!==r.hash;return{fromLocation:t,toLocation:r,pathChanged:n,hrefChanged:a,hashChanged:s}}class JT{constructor(t){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=r=>r(),this.update=r=>{var h;r.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info.");const n=this.options,a=this.basepath??(n==null?void 0:n.basepath)??"/",s=this.basepath===void 0,i=n==null?void 0:n.rewrite;this.options={...n,...r},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(p=>[encodeURIComponent(p),p])):void 0,(!this.history||this.options.history&&this.options.history!==this.history)&&(this.options.history?this.history=this.options.history:this.isServer||(this.history=aT())),this.origin=this.options.origin,this.origin||(!this.isServer&&(window!=null&&window.origin)&&window.origin!=="null"?this.origin=window.origin:this.origin="http://localhost"),this.history&&this.updateLatestLocation(),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),!this.__store&&this.latestLocation&&(this.__store=new dh(eC(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(p=>!["redirected"].includes(p.status))}}}),IT(this));let o=!1;const l=this.options.basepath??"/",c=this.options.rewrite;if(s||a!==l||i!==c){this.basepath=l;const p=[];yu(l)!==""&&p.push(QT({basepath:l})),c&&p.push(c),this.rewrite=p.length===0?void 0:p.length===1?p[0]:qT(p),this.history&&this.updateLatestLocation(),o=!0}o&&this.__store&&(this.__store.state={...this.state,location:this.latestLocation}),typeof window<"u"&&"CSS"in window&&typeof((h=window.CSS)==null?void 0:h.supports)=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.updateLatestLocation=()=>{this.latestLocation=this.parseLocation(this.history.location,this.latestLocation)},this.buildRouteTree=()=>{const{routesById:r,routesByPath:n,flatRoutes:a}=FT({routeTree:this.routeTree,initRoute:(i,o)=>{i.init({originalIndex:o})}});this.routesById=r,this.routesByPath=n,this.flatRoutes=a;const s=this.options.notFoundRoute;s&&(s.init({originalIndex:99999999999}),this.routesById[s.id]=s)},this.subscribe=(r,n)=>{const a={eventType:r,fn:n};return this.subscribers.add(a),()=>{this.subscribers.delete(a)}},this.emit=r=>{this.subscribers.forEach(n=>{n.eventType===r.type&&n.fn(r)})},this.parseLocation=(r,n)=>{const a=({href:l,state:c})=>{const d=new URL(l,this.origin),f=Sw(this.rewrite,d),h=this.options.parseSearch(f.search),p=this.options.stringifySearch(h);f.search=p;const x=f.href.replace(f.origin,""),{pathname:m,hash:v}=f;return{href:x,publicHref:l,url:f.href,pathname:m,searchStr:p,search:qr(n==null?void 0:n.search,h),hash:v.split("#").reverse()[0]??"",state:qr(n==null?void 0:n.state,c)}},s=a(r),{__tempLocation:i,__tempKey:o}=s.state;if(i&&(!o||o===this.tempLocationKey)){const l=a(i);return l.state.key=s.state.key,l.state.__TSR_key=s.state.__TSR_key,delete l.state.__tempLocation,{...l,maskedLocation:s}}return s},this.resolvePathWithBase=(r,n)=>uT({base:r,to:qm(n),trailingSlash:this.options.trailingSlash,parseCache:this.parsePathnameCache}),this.matchRoutes=(r,n,a)=>typeof r=="string"?this.matchRoutesInternal({pathname:r,search:n},a):this.matchRoutesInternal(r,n),this.parsePathnameCache=HT(1e3),this.getMatchedRoutes=(r,n)=>tC({pathname:r,routePathname:n,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes,parseCache:this.parsePathnameCache}),this.cancelMatch=r=>{const n=this.getMatch(r);n&&(n.abortController.abort(),clearTimeout(n._nonReactive.pendingTimeout),n._nonReactive.pendingTimeout=void 0)},this.cancelMatches=()=>{var r;(r=this.state.pendingMatches)==null||r.forEach(n=>{this.cancelMatch(n.id)})},this.buildLocation=r=>{const n=(s={})=>{var _,C;const i=s._fromLocation||this.latestLocation,o=this.matchRoutes(i,{_buildLocation:!0}),l=fh(o);s.from;const c=s.unsafeRelative==="path"?i.pathname:s.from??l.fullPath,d=this.resolvePathWithBase(c,"."),f=l.search,h={...l.params},p=s.to?this.resolvePathWithBase(d,`${s.to}`):this.resolvePathWithBase(d,"."),x=s.params===!1||s.params===null?{}:(s.params??!0)===!0?h:Object.assign(h,Ms(s.params,h)),m=Hc({path:p,params:x,parseCache:this.parsePathnameCache}).interpolatedPath,v=this.matchRoutes(m,void 0,{_buildLocation:!0}).map(F=>this.looseRoutesById[F.routeId]);if(Object.keys(x).length>0)for(const F of v){const D=((_=F.options.params)==null?void 0:_.stringify)??F.options.stringifyParams;D&&Object.assign(x,D(x))}const g=Hc({path:p,params:x,leaveWildcards:!1,leaveParams:r.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath;let y=f;if(r._includeValidateSearch&&((C=this.options.search)!=null&&C.strict)){const F={};v.forEach(D=>{if(D.options.validateSearch)try{Object.assign(F,ph(D.options.validateSearch,{...F,...y}))}catch{}}),y=F}y=rC({search:y,dest:s,destRoutes:v,_includeValidateSearch:r._includeValidateSearch}),y=qr(f,y);const w=this.options.stringifySearch(y),S=s.hash===!0?i.hash:s.hash?Ms(s.hash,i.hash):void 0,A=S?`#${S}`:"";let T=s.state===!0?i.state:s.state?Ms(s.state,i.state):{};T=qr(i.state,T);const b=`${g}${w}${A}`,k=new URL(b,this.origin),E=Ew(this.rewrite,k);return{publicHref:E.pathname+E.search+E.hash,href:b,url:E.href,pathname:g,search:y,searchStr:w,state:T,hash:S??"",unmaskOnReload:s.unmaskOnReload}},a=(s={},i)=>{var c;const o=n(s);let l=i?n(i):void 0;if(!l){let d={};const f=(c=this.options.routeMasks)==null?void 0:c.find(h=>{const p=hh(o.pathname,{to:h.from,caseSensitive:!1,fuzzy:!1},this.parsePathnameCache);return p?(d=p,!0):!1});if(f){const{from:h,...p}=f;i={from:r.from,...p,params:d},l=n(i)}}return l&&(o.maskedLocation=l),o};return r.mask?a(r,{from:r.from,...r.mask}):a(r)},this.commitLocation=({viewTransition:r,ignoreBlocker:n,...a})=>{const s=()=>{const l=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];l.forEach(d=>{a.state[d]=this.latestLocation.state[d]});const c=Ls(a.state,this.latestLocation.state);return l.forEach(d=>{delete a.state[d]}),c},i=Za(this.latestLocation.href)===Za(a.href),o=this.commitLocationPromise;if(this.commitLocationPromise=ro(()=>{o==null||o.resolve()}),i&&s())this.load();else{let{maskedLocation:l,hashScrollIntoView:c,...d}=a;l&&(d={...l,state:{...l.state,__tempKey:void 0,__tempLocation:{...d,search:d.searchStr,state:{...d.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(d.unmaskOnReload??this.options.unmaskOnReload??!1)&&(d.state.__tempKey=this.tempLocationKey)),d.state.__hashScrollIntoViewOptions=c??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=r,this.history[a.replace?"replace":"push"](d.publicHref,d.state,{ignoreBlocker:n})}return this.resetNextScroll=a.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:r,resetScroll:n,hashScrollIntoView:a,viewTransition:s,ignoreBlocker:i,href:o,...l}={})=>{if(o){const d=this.history.location.state.__TSR_index,f=Ju(o,{__TSR_index:r?d:d+1});l.to=f.pathname,l.search=this.options.parseSearch(f.search),l.hash=f.hash.slice(1)}const c=this.buildLocation({...l,_includeValidateSearch:!0});return this.commitLocation({...c,viewTransition:s,replace:r,resetScroll:n,hashScrollIntoView:a,ignoreBlocker:i})},this.navigate=({to:r,reloadDocument:n,href:a,...s})=>{if(!n&&a)try{new URL(`${a}`),n=!0}catch{}return n?(a||(a=this.buildLocation({to:r,...s}).url),s.replace?window.location.replace(a):window.location.href=a,Promise.resolve()):this.buildAndCommitLocation({...s,href:a,to:r,_isNavigate:!0})},this.beforeLoad=()=>{if(this.cancelMatches(),this.updateLatestLocation(),this.isServer){const n=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0}),a=s=>{try{return encodeURI(decodeURI(s))}catch{return s}};if(yu(a(this.latestLocation.href))!==yu(a(n.href))){let s=n.url;throw this.origin&&s.startsWith(this.origin)&&(s=s.replace(this.origin,"")||"/"),VT({href:s})}}const r=this.matchRoutes(this.latestLocation);this.__store.setState(n=>({...n,status:"pending",statusCode:200,isLoading:!0,location:this.latestLocation,pendingMatches:r,cachedMatches:n.cachedMatches.filter(a=>!r.some(s=>s.id===a.id))}))},this.load=async r=>{let n,a,s;for(s=new Promise(i=>{this.startTransition(async()=>{var o;try{this.beforeLoad();const l=this.latestLocation,c=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...Bs({resolvedLocation:c,location:l})}),this.emit({type:"onBeforeLoad",...Bs({resolvedLocation:c,location:l})}),await T1({router:this,sync:r==null?void 0:r.sync,matches:this.state.pendingMatches,location:l,updateMatch:this.updateMatch,onReady:async()=>{this.startViewTransition(async()=>{let d,f,h;al(()=>{this.__store.setState(p=>{const x=p.matches,m=p.pendingMatches||p.matches;return d=x.filter(v=>!m.some(g=>g.id===v.id)),f=m.filter(v=>!x.some(g=>g.id===v.id)),h=x.filter(v=>m.some(g=>g.id===v.id)),{...p,isLoading:!1,loadedAt:Date.now(),matches:m,pendingMatches:void 0,cachedMatches:[...p.cachedMatches,...d.filter(v=>v.status!=="error")]}}),this.clearExpiredCache()}),[[d,"onLeave"],[f,"onEnter"],[h,"onStay"]].forEach(([p,x])=>{p.forEach(m=>{var v,g;(g=(v=this.looseRoutesById[m.routeId].options)[x])==null||g.call(v,m)})})})}})}catch(l){On(l)?(n=l,this.isServer||this.navigate({...n.options,replace:!0,ignoreBlocker:!0})):zn(l)&&(a=l),this.__store.setState(c=>({...c,statusCode:n?n.status:a?404:c.matches.some(d=>d.status==="error")?500:200,redirect:n}))}this.latestLoadPromise===s&&((o=this.commitLocationPromise)==null||o.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),i()})}),this.latestLoadPromise=s,await s;this.latestLoadPromise&&s!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(i=>({...i,statusCode:404}))},this.startViewTransition=r=>{const n=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,n&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let a;if(typeof n=="object"&&this.isViewTransitionTypesSupported){const s=this.latestLocation,i=this.state.resolvedLocation,o=typeof n.types=="function"?n.types(Bs({resolvedLocation:i,location:s})):n.types;if(o===!1){r();return}a={update:r,types:o}}else a=r;document.startViewTransition(a)}else r()},this.updateMatch=(r,n)=>{var s;const a=(s=this.state.pendingMatches)!=null&&s.some(i=>i.id===r)?"pendingMatches":this.state.matches.some(i=>i.id===r)?"matches":this.state.cachedMatches.some(i=>i.id===r)?"cachedMatches":"";a&&this.__store.setState(i=>{var o;return{...i,[a]:(o=i[a])==null?void 0:o.map(l=>l.id===r?n(l):l)}})},this.getMatch=r=>{var a;const n=s=>s.id===r;return this.state.cachedMatches.find(n)??((a=this.state.pendingMatches)==null?void 0:a.find(n))??this.state.matches.find(n)},this.invalidate=r=>{const n=a=>{var s;return((s=r==null?void 0:r.filter)==null?void 0:s.call(r,a))??!0?{...a,invalid:!0,...r!=null&&r.forcePending||a.status==="error"?{status:"pending",error:void 0}:void 0}:a};return this.__store.setState(a=>{var s;return{...a,matches:a.matches.map(n),cachedMatches:a.cachedMatches.map(n),pendingMatches:(s=a.pendingMatches)==null?void 0:s.map(n)}}),this.shouldViewTransition=!1,this.load({sync:r==null?void 0:r.sync})},this.resolveRedirect=r=>{if(!r.options.href){const n=this.buildLocation(r.options);let a=n.url;this.origin&&a.startsWith(this.origin)&&(a=a.replace(this.origin,"")||"/"),r.options.href=n.href,r.headers.set("Location",a)}return r.headers.get("Location")||r.headers.set("Location",r.options.href),r},this.clearCache=r=>{const n=r==null?void 0:r.filter;n!==void 0?this.__store.setState(a=>({...a,cachedMatches:a.cachedMatches.filter(s=>!n(s))})):this.__store.setState(a=>({...a,cachedMatches:[]}))},this.clearExpiredCache=()=>{const r=n=>{const a=this.looseRoutesById[n.routeId];if(!a.options.loader)return!0;const s=(n.preload?a.options.preloadGcTime??this.options.defaultPreloadGcTime:a.options.gcTime??this.options.defaultGcTime)??5*60*1e3;return n.status==="error"?!0:Date.now()-n.updatedAt>=s};this.clearCache({filter:r})},this.loadRouteChunk=yw,this.preloadRoute=async r=>{const n=this.buildLocation(r);let a=this.matchRoutes(n,{throwOnError:!0,preload:!0,dest:r});const s=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(o=>o.id)),i=new Set([...s,...this.state.cachedMatches.map(o=>o.id)]);al(()=>{a.forEach(o=>{i.has(o.id)||this.__store.setState(l=>({...l,cachedMatches:[...l.cachedMatches,o]}))})});try{return a=await T1({router:this,matches:a,location:n,preload:!0,updateMatch:(o,l)=>{s.has(o)?a=a.map(c=>c.id===o?l(c):c):this.updateMatch(o,l)}}),a}catch(o){if(On(o))return o.options.reloadDocument?void 0:await this.preloadRoute({...o.options,_fromLocation:n});zn(o)||console.error(o);return}},this.matchRoute=(r,n)=>{const a={...r,to:r.to?this.resolvePathWithBase(r.from||"",r.to):void 0,params:r.params||{},leaveParams:!0},s=this.buildLocation(a);if(n!=null&&n.pending&&this.state.status!=="pending")return!1;const o=((n==null?void 0:n.pending)===void 0?!this.state.isLoading:n.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,l=hh(o.pathname,{...n,to:s.pathname},this.parsePathnameCache);return!l||r.params&&!Ls(l,r.params,{partial:!0})?!1:l&&((n==null?void 0:n.includeSearch)??!0)?Ls(o.search,s.search,{partial:!0})?l:!1:l},this.hasNotFoundMatch=()=>this.__store.state.matches.some(r=>r.status==="notFound"||r.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...t,caseSensitive:t.caseSensitive??!1,notFoundMode:t.notFoundMode??"fuzzy",stringifySearch:t.stringifySearch??UT,parseSearch:t.parseSearch??BT}),typeof document<"u"&&(self.__TSR_ROUTER__=this)}isShell(){return!!this.options.isShell}isPrerendering(){return!!this.options.isPrerendering}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(t,r){var d;const{foundRoute:n,matchedRoutes:a,routeParams:s}=this.getMatchedRoutes(t.pathname,(d=r==null?void 0:r.dest)==null?void 0:d.to);let i=!1;(n?n.path!=="/"&&s["**"]:Za(t.pathname))&&(this.options.notFoundRoute?a.push(this.options.notFoundRoute):i=!0);const o=(()=>{if(i){if(this.options.notFoundMode!=="root")for(let f=a.length-1;f>=0;f--){const h=a[f];if(h.children)return h.id}return Tr}})(),l=[],c=f=>(f==null?void 0:f.id)?f.context??this.options.context??void 0:this.options.context??void 0;return a.forEach((f,h)=>{var D,M,B;const p=l[h-1],[x,m,v]=(()=>{const q=(p==null?void 0:p.search)??t.search,Q=(p==null?void 0:p._strictSearch)??void 0;try{const J=ph(f.options.validateSearch,{...q})??void 0;return[{...q,...J},{...Q,...J},void 0]}catch(J){let P=J;if(J instanceof n0||(P=new n0(J.message,{cause:J})),r!=null&&r.throwOnError)throw P;return[q,{},P]}})(),g=((M=(D=f.options).loaderDeps)==null?void 0:M.call(D,{search:x}))??"",y=g?JSON.stringify(g):"",{interpolatedPath:w,usedParams:S}=Hc({path:f.fullPath,params:s,decodeCharMap:this.pathParamsDecodeCharMap}),A=Hc({path:f.id,params:s,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath+y,T=this.getMatch(A),b=this.state.matches.find(q=>q.routeId===f.id),k=(T==null?void 0:T._strictParams)??S;let E;if(!T){const q=((B=f.options.params)==null?void 0:B.parse)??f.options.parseParams;if(q)try{Object.assign(k,q(k))}catch(Q){if(E=new ZT(Q.message,{cause:Q}),r!=null&&r.throwOnError)throw E}}Object.assign(s,k);const _=b?"stay":"enter";let C;if(T)C={...T,cause:_,params:b?qr(b.params,s):s,_strictParams:k,search:qr(b?b.search:T.search,x),_strictSearch:m};else{const q=f.options.loader||f.options.beforeLoad||f.lazyFn||ww(f)?"pending":"success";C={id:A,index:h,routeId:f.id,params:b?qr(b.params,s):s,_strictParams:k,pathname:w,updatedAt:Date.now(),search:b?qr(b.search,x):x,_strictSearch:m,searchError:void 0,status:q,isFetching:!1,error:void 0,paramsError:E,__routeContext:void 0,_nonReactive:{loadPromise:ro()},__beforeLoadContext:void 0,context:{},abortController:new AbortController,fetchCount:0,cause:_,loaderDeps:b?qr(b.loaderDeps,g):g,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:f.options.staticData||{},fullPath:f.fullPath}}r!=null&&r.preload||(C.globalNotFound=o===f.id),C.searchError=v;const F=c(p);C.context={...F,...C.__routeContext,...C.__beforeLoadContext},l.push(C)}),l.forEach((f,h)=>{const p=this.looseRoutesById[f.routeId];if(!this.getMatch(f.id)&&(r==null?void 0:r._buildLocation)!==!0){const m=l[h-1],v=c(m);if(p.options.context){const g={deps:f.loaderDeps,params:f.params,context:v??{},location:t,navigate:y=>this.navigate({...y,_fromLocation:t}),buildLocation:this.buildLocation,cause:f.cause,abortController:f.abortController,preload:!!f.preload,matches:l};f.__routeContext=p.options.context(g)??void 0}f.context={...v,...f.__routeContext,...f.__beforeLoadContext}}}),l}}class n0 extends Error{}class ZT extends Error{}function eC(e){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:e,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function ph(e,t){if(e==null)return{};if("~standard"in e){const r=e["~standard"].validate(t);if(r instanceof Promise)throw new n0("Async validation not supported");if(r.issues)throw new n0(JSON.stringify(r.issues,void 0,2),{cause:r});return r.value}return"parse"in e?e.parse(t):typeof e=="function"?e(t):{}}function tC({pathname:e,routePathname:t,caseSensitive:r,routesByPath:n,routesById:a,flatRoutes:s,parseCache:i}){let o={};const l=Za(e),c=p=>{var m;return hh(l,{to:p.fullPath,caseSensitive:((m=p.options)==null?void 0:m.caseSensitive)??r,fuzzy:!0},i)};let d=t!==void 0?n[t]:void 0;if(d)o=c(d);else{let p;for(const x of s){const m=c(x);if(m)if(x.path!=="/"&&m["**"])p||(p={foundRoute:x,routeParams:m});else{d=x,o=m;break}}!d&&p&&(d=p.foundRoute,o=p.routeParams)}let f=d||a[Tr];const h=[f];for(;f.parentRoute;)f=f.parentRoute,h.push(f);return h.reverse(),{matchedRoutes:h,routeParams:o,foundRoute:d}}function rC({search:e,dest:t,destRoutes:r,_includeValidateSearch:n}){const a=r.reduce((o,l)=>{var d;const c=[];if("search"in l.options)(d=l.options.search)!=null&&d.middlewares&&c.push(...l.options.search.middlewares);else if(l.options.preSearchFilters||l.options.postSearchFilters){const f=({search:h,next:p})=>{let x=h;"preSearchFilters"in l.options&&l.options.preSearchFilters&&(x=l.options.preSearchFilters.reduce((v,g)=>g(v),h));const m=p(x);return"postSearchFilters"in l.options&&l.options.postSearchFilters?l.options.postSearchFilters.reduce((v,g)=>g(v),m):m};c.push(f)}if(n&&l.options.validateSearch){const f=({search:h,next:p})=>{const x=p(h);try{return{...x,...ph(l.options.validateSearch,x)??void 0}}catch{return x}};c.push(f)}return o.concat(c)},[])??[],s=({search:o})=>t.search?t.search===!0?o:Ms(t.search,o):{};a.push(s);const i=(o,l)=>{if(o>=a.length)return l;const c=a[o];return c({search:l,next:f=>i(o+1,f)})};return i(0,e)}const nC="Error preloading route! ";class _w{constructor(t){if(this.init=r=>{var c,d;this.originalIndex=r.originalIndex;const n=this.options,a=!(n!=null&&n.path)&&!(n!=null&&n.id);this.parentRoute=(d=(c=this.options).getParentRoute)==null?void 0:d.call(c),a?this._path=Tr:this.parentRoute||da(!1);let s=a?Tr:n==null?void 0:n.path;s&&s!=="/"&&(s=Qm(s));const i=(n==null?void 0:n.id)||s;let o=a?Tr:aa([this.parentRoute.id===Tr?"":this.parentRoute.id,i]);s===Tr&&(s="/"),o!==Tr&&(o=aa(["/",o]));const l=o===Tr?"/":aa([this.parentRoute.fullPath,s]);this._path=s,this._id=o,this._fullPath=l,this._to=l},this.clone=r=>{this._path=r._path,this._id=r._id,this._fullPath=r._fullPath,this._to=r._to,this.options.getParentRoute=r.options.getParentRoute,this.children=r.children},this.addChildren=r=>this._addFileChildren(r),this._addFileChildren=r=>(Array.isArray(r)&&(this.children=r),typeof r=="object"&&r!==null&&(this.children=Object.values(r)),this),this._addFileTypes=()=>this,this.updateLoader=r=>(Object.assign(this.options,r),this),this.update=r=>(Object.assign(this.options,r),this),this.lazy=r=>(this.lazyFn=r,this),this.options=t||{},this.isRoot=!(t!=null&&t.getParentRoute),t!=null&&t.id&&(t!=null&&t.path))throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}}class aC extends _w{constructor(t){super(t)}}function Jm(e){const t=e.errorComponent??U0;return u.jsx(sC,{getResetKey:e.getResetKey,onCatch:e.onCatch,children:({error:r,reset:n})=>r?V.createElement(t,{error:r,reset:n}):e.children})}class sC extends V.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(t){return{resetKey:t.getResetKey()}}static getDerivedStateFromError(t){return{error:t}}reset(){this.setState({error:null})}componentDidUpdate(t,r){r.error&&r.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(t,r){this.props.onCatch&&this.props.onCatch(t,r)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function U0({error:e}){const[t,r]=V.useState(!1);return u.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[u.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),u.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>r(n=>!n),children:t?"Hide Error":"Show Error"})]}),u.jsx("div",{style:{height:".25rem"}}),t?u.jsx("div",{children:u.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:e.message?u.jsx("code",{children:e.message}):null})}):null]})}function iC({children:e,fallback:t=null}){return oC()?u.jsx(ts.Fragment,{children:e}):u.jsx(ts.Fragment,{children:t})}function oC(){return ts.useSyncExternalStore(lC,()=>!0,()=>!1)}function lC(){return()=>{}}var cC=!0;function Ol(e,t){if(!cC){if(e)return;var r="Warning: "+t;typeof console<"u"&&console.warn(r);try{throw Error(r)}catch{}}}var bw={exports:{}},Tw={},Cw={exports:{}},Nw={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var so=V;function uC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dC=typeof Object.is=="function"?Object.is:uC,fC=so.useState,hC=so.useEffect,mC=so.useLayoutEffect,pC=so.useDebugValue;function xC(e,t){var r=t(),n=fC({inst:{value:r,getSnapshot:t}}),a=n[0].inst,s=n[1];return mC(function(){a.value=r,a.getSnapshot=t,Od(a)&&s({inst:a})},[e,r,t]),hC(function(){return Od(a)&&s({inst:a}),e(function(){Od(a)&&s({inst:a})})},[e]),pC(r),r}function Od(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!dC(e,r)}catch{return!0}}function gC(e,t){return t()}var vC=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?gC:xC;Nw.useSyncExternalStore=so.useSyncExternalStore!==void 0?so.useSyncExternalStore:vC;Cw.exports=Nw;var yC=Cw.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $0=V,wC=yC;function kC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var SC=typeof Object.is=="function"?Object.is:kC,EC=wC.useSyncExternalStore,_C=$0.useRef,bC=$0.useEffect,TC=$0.useMemo,CC=$0.useDebugValue;Tw.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var s=_C(null);if(s.current===null){var i={hasValue:!1,value:null};s.current=i}else i=s.current;s=TC(function(){function l(p){if(!c){if(c=!0,d=p,p=n(p),a!==void 0&&i.hasValue){var x=i.value;if(a(x,p))return f=x}return f=p}if(x=f,SC(d,p))return x;var m=n(p);return a!==void 0&&a(x,m)?(d=p,x):(d=p,f=m)}var c=!1,d,f,h=r===void 0?null:r;return[function(){return l(t())},h===null?void 0:function(){return l(h())}]},[t,r,n,a]);var o=EC(e,s[0],s[1]);return bC(function(){i.hasValue=!0,i.value=o},[o]),CC(o),o};bw.exports=Tw;var Aw=bw.exports;const NC=Xh(Aw);function AC(e,t=r=>r){return Aw.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,FC)}function FC(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,a]of e)if(!t.has(n)||!Object.is(a,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();const r=C1(e);if(r.length!==C1(t).length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!Object.is(e[r[n]],t[r[n]]))return!1;return!0}function C1(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}const Md=V.createContext(null);function Fw(){return typeof document>"u"?Md:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=Md,Md)}function Kr(e){const t=V.useContext(Fw());return Ol(!(((e==null?void 0:e.warn)??!0)&&!t),"useRouter must be used inside a <RouterProvider> component!"),t}function Rr(e){const t=Kr({warn:(e==null?void 0:e.router)===void 0}),r=(e==null?void 0:e.router)||t,n=V.useRef(void 0);return AC(r.__store,a=>{if(e!=null&&e.select){if(e.structuralSharing??r.options.defaultStructuralSharing){const s=qr(n.current,e.select(a));return n.current=s,s}return e.select(a)}return a})}const z0=V.createContext(void 0),PC=V.createContext(void 0);function Vn(e){const t=V.useContext(e.from?PC:z0);return Rr({select:n=>{const a=n.matches.find(s=>e.from?e.from===s.routeId:s.id===t);if(da(!((e.shouldThrow??!0)&&!a),`Could not find ${e.from?`an active match from "${e.from}"`:"a nearest match!"}`),a!==void 0)return e.select?e.select(a):a},structuralSharing:e.structuralSharing})}function Zm(e){return Vn({from:e.from,strict:e.strict,structuralSharing:e.structuralSharing,select:t=>e.select?e.select(t.loaderData):t.loaderData})}function ep(e){const{select:t,...r}=e;return Vn({...r,select:n=>t?t(n.loaderDeps):n.loaderDeps})}function fc(e){return Vn({from:e.from,shouldThrow:e.shouldThrow,structuralSharing:e.structuralSharing,strict:e.strict,select:t=>{const r=e.strict===!1?t.params:t._strictParams;return e.select?e.select(r):r}})}function tp(e){return Vn({from:e.from,strict:e.strict,shouldThrow:e.shouldThrow,structuralSharing:e.structuralSharing,select:t=>e.select?e.select(t.search):t.search})}function mo(e){const t=Kr();return V.useCallback(r=>t.navigate({...r,from:r.from??(e==null?void 0:e.from)}),[e==null?void 0:e.from,t])}const Gc=typeof window<"u"?V.useLayoutEffect:V.useEffect;function Ld(e){const t=V.useRef({value:e,prev:null}),r=t.current.value;return e!==r&&(t.current={value:e,prev:r}),t.current.prev}function RC(e,t,r={},n={}){V.useEffect(()=>{if(!e.current||n.disabled||typeof IntersectionObserver!="function")return;const a=new IntersectionObserver(([s])=>{t(s)},r);return a.observe(e.current),()=>{a.disconnect()}},[t,r,n.disabled,e])}function DC(e){const t=V.useRef(null);return V.useImperativeHandle(e,()=>t.current,[]),t}function jC(e,t){const r=Kr(),[n,a]=V.useState(!1),s=V.useRef(!1),i=DC(t),{activeProps:o,inactiveProps:l,activeOptions:c,to:d,preload:f,preloadDelay:h,hashScrollIntoView:p,replace:x,startTransition:m,resetScroll:v,viewTransition:g,children:y,target:w,disabled:S,style:A,className:T,onClick:b,onFocus:k,onMouseEnter:E,onMouseLeave:_,onTouchStart:C,ignoreBlocker:F,params:D,search:M,hash:B,state:q,mask:Q,reloadDocument:J,unsafeRelative:P,from:Z,_fromLocation:le,...R}=e,G=Rr({select:De=>De.location.search,structuralSharing:!0}),W=e.from,K=V.useMemo(()=>({...e,from:W}),[r,G,W,e._fromLocation,e.hash,e.to,e.search,e.params,e.state,e.mask,e.unsafeRelative]),O=V.useMemo(()=>r.buildLocation({...K}),[r,K]),X=V.useMemo(()=>{if(S)return;let De=O.maskedLocation?O.maskedLocation.url:O.url,Ce=!1;return r.origin&&(De.startsWith(r.origin)?De=r.history.createHref(De.replace(r.origin,""))||"/":Ce=!0),{href:De,external:Ce}},[S,O.maskedLocation,O.url,r.origin,r.history]),se=V.useMemo(()=>{if(X!=null&&X.external)return X.href;try{return new URL(d),d}catch{}},[d,X]),ie=e.reloadDocument||se?!1:f??r.options.defaultPreload,oe=h??r.options.defaultPreloadDelay??0,ue=Rr({select:De=>{if(se)return!1;if(c!=null&&c.exact){if(!lT(De.location.pathname,O.pathname,r.basepath))return!1}else{const Ce=e0(De.location.pathname,r.basepath),Xe=e0(O.pathname,r.basepath);if(!(Ce.startsWith(Xe)&&(Ce.length===Xe.length||Ce[Xe.length]==="/")))return!1}return((c==null?void 0:c.includeSearch)??!0)&&!Ls(De.location.search,O.search,{partial:!(c!=null&&c.exact),ignoreUndefined:!(c!=null&&c.explicitUndefined)})?!1:c!=null&&c.includeHash?De.location.hash===O.hash:!0}}),L=V.useCallback(()=>{r.preloadRoute({...K}).catch(De=>{console.warn(De),console.warn(nC)})},[r,K]),Pe=V.useCallback(De=>{De!=null&&De.isIntersecting&&L()},[L]);RC(i,Pe,BC,{disabled:!!S||ie!=="viewport"}),V.useEffect(()=>{s.current||!S&&ie==="render"&&(L(),s.current=!0)},[S,L,ie]);const ke=De=>{const Ce=De.currentTarget.target,Xe=w!==void 0?w:Ce;if(!S&&!UC(De)&&!De.defaultPrevented&&(!Xe||Xe==="_self")&&De.button===0){De.preventDefault(),Hm.flushSync(()=>{a(!0)});const qe=r.subscribe("onResolved",()=>{qe(),a(!1)});r.navigate({...K,replace:x,resetScroll:v,hashScrollIntoView:p,startTransition:m,viewTransition:g,ignoreBlocker:F})}};if(se)return{...R,ref:i,href:se,...y&&{children:y},...w&&{target:w},...S&&{disabled:S},...A&&{style:A},...T&&{className:T},...b&&{onClick:b},...k&&{onFocus:k},...E&&{onMouseEnter:E},..._&&{onMouseLeave:_},...C&&{onTouchStart:C}};const Se=De=>{S||ie&&L()},xe=Se,de=De=>{if(!(S||!ie))if(!oe)L();else{const Ce=De.target;if(jo.has(Ce))return;const Xe=setTimeout(()=>{jo.delete(Ce),L()},oe);jo.set(Ce,Xe)}},be=De=>{if(S||!ie||!oe)return;const Ce=De.target,Xe=jo.get(Ce);Xe&&(clearTimeout(Xe),jo.delete(Ce))},Oe=ue?Ms(o,{})??IC:Bd,$e=ue?Bd:Ms(l,{})??Bd,At=[T,Oe.className,$e.className].filter(Boolean).join(" "),Ft=(A||Oe.style||$e.style)&&{...A,...Oe.style,...$e.style};return{...R,...Oe,...$e,href:X==null?void 0:X.href,ref:i,onClick:Io([b,ke]),onFocus:Io([k,Se]),onMouseEnter:Io([E,de]),onMouseLeave:Io([_,be]),onTouchStart:Io([C,xe]),disabled:!!S,target:w,...Ft&&{style:Ft},...At&&{className:At},...S&&OC,...ue&&MC,...n&&LC}}const Bd={},IC={className:"active"},OC={role:"link","aria-disabled":!0},MC={"data-status":"active","aria-current":"page"},LC={"data-transitioning":"transitioning"},jo=new WeakMap,BC={rootMargin:"100px"},Io=e=>t=>{for(const r of e)if(r){if(t.defaultPrevented)return;r(t)}},rp=V.forwardRef((e,t)=>{const{_asChild:r,...n}=e,{type:a,ref:s,...i}=jC(n,t),o=typeof n.children=="function"?n.children({isActive:i["data-status"]==="active"}):n.children;return r===void 0&&delete i.disabled,V.createElement(r||"a",{...i,ref:s},o)});function UC(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}let $C=class extends _w{constructor(t){super(t),this.useMatch=r=>Vn({select:r==null?void 0:r.select,from:this.id,structuralSharing:r==null?void 0:r.structuralSharing}),this.useRouteContext=r=>Vn({...r,from:this.id,select:n=>r!=null&&r.select?r.select(n.context):n.context}),this.useSearch=r=>tp({select:r==null?void 0:r.select,structuralSharing:r==null?void 0:r.structuralSharing,from:this.id}),this.useParams=r=>fc({select:r==null?void 0:r.select,structuralSharing:r==null?void 0:r.structuralSharing,from:this.id}),this.useLoaderDeps=r=>ep({...r,from:this.id}),this.useLoaderData=r=>Zm({...r,from:this.id}),this.useNavigate=()=>mo({from:this.fullPath}),this.Link=ts.forwardRef((r,n)=>u.jsx(rp,{ref:n,from:this.fullPath,...r})),this.$$typeof=Symbol.for("react.memo")}};function zC(e){return new $C(e)}class VC extends aC{constructor(t){super(t),this.useMatch=r=>Vn({select:r==null?void 0:r.select,from:this.id,structuralSharing:r==null?void 0:r.structuralSharing}),this.useRouteContext=r=>Vn({...r,from:this.id,select:n=>r!=null&&r.select?r.select(n.context):n.context}),this.useSearch=r=>tp({select:r==null?void 0:r.select,structuralSharing:r==null?void 0:r.structuralSharing,from:this.id}),this.useParams=r=>fc({select:r==null?void 0:r.select,structuralSharing:r==null?void 0:r.structuralSharing,from:this.id}),this.useLoaderDeps=r=>ep({...r,from:this.id}),this.useLoaderData=r=>Zm({...r,from:this.id}),this.useNavigate=()=>mo({from:this.fullPath}),this.Link=ts.forwardRef((r,n)=>u.jsx(rp,{ref:n,from:this.fullPath,...r})),this.$$typeof=Symbol.for("react.memo")}}function HC(e){return new VC(e)}function zr(e){return typeof e=="object"?new N1(e,{silent:!0}).createRoute(e):new N1(e,{silent:!0}).createRoute}class N1{constructor(t,r){this.path=t,this.createRoute=n=>{Ol(this.silent,"FileRoute is deprecated and will be removed in the next major version. Use the createFileRoute(path)(options) function instead.");const a=zC(n);return a.isRoot=!1,a},this.silent=r==null?void 0:r.silent}}class A1{constructor(t){this.useMatch=r=>Vn({select:r==null?void 0:r.select,from:this.options.id,structuralSharing:r==null?void 0:r.structuralSharing}),this.useRouteContext=r=>Vn({from:this.options.id,select:n=>r!=null&&r.select?r.select(n.context):n.context}),this.useSearch=r=>tp({select:r==null?void 0:r.select,structuralSharing:r==null?void 0:r.structuralSharing,from:this.options.id}),this.useParams=r=>fc({select:r==null?void 0:r.select,structuralSharing:r==null?void 0:r.structuralSharing,from:this.options.id}),this.useLoaderDeps=r=>ep({...r,from:this.options.id}),this.useLoaderData=r=>Zm({...r,from:this.options.id}),this.useNavigate=()=>{const r=Kr();return mo({from:r.routesById[this.options.id].fullPath})},this.options=t,this.$$typeof=Symbol.for("react.memo")}}function F1(e){return typeof e=="object"?new A1(e):t=>new A1({id:e,...t})}function WC(){const e=Kr(),t=V.useRef({router:e,mounted:!1}),[r,n]=V.useState(!1),{hasPendingMatches:a,isLoading:s}=Rr({select:f=>({isLoading:f.isLoading,hasPendingMatches:f.matches.some(h=>h.status==="pending")}),structuralSharing:!0}),i=Ld(s),o=s||r||a,l=Ld(o),c=s||a,d=Ld(c);return e.startTransition=f=>{n(!0),V.startTransition(()=>{f(),n(!1)})},V.useEffect(()=>{const f=e.history.subscribe(e.load),h=e.buildLocation({to:e.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return Za(e.latestLocation.href)!==Za(h.href)&&e.commitLocation({...h,replace:!0}),()=>{f()}},[e,e.history]),Gc(()=>{if(typeof window<"u"&&e.ssr||t.current.router===e&&t.current.mounted)return;t.current={router:e,mounted:!0},(async()=>{try{await e.load()}catch(h){console.error(h)}})()},[e]),Gc(()=>{i&&!s&&e.emit({type:"onLoad",...Bs(e.state)})},[i,e,s]),Gc(()=>{d&&!c&&e.emit({type:"onBeforeRouteMount",...Bs(e.state)})},[c,d,e]),Gc(()=>{l&&!o&&(e.emit({type:"onResolved",...Bs(e.state)}),e.__store.setState(f=>({...f,status:"idle",resolvedLocation:f.location})),OT(e))},[o,l,e]),null}function KC(e){const t=Rr({select:r=>`not-found-${r.location.pathname}-${r.status}`});return u.jsx(Jm,{getResetKey:()=>t,onCatch:(r,n)=>{var a;if(zn(r))(a=e.onCatch)==null||a.call(e,r,n);else throw r},errorComponent:({error:r})=>{var n;if(zn(r))return(n=e.fallback)==null?void 0:n.call(e,r);throw r},children:e.children})}function GC(){return u.jsx("p",{children:"Not Found"})}function di(e){return u.jsx(u.Fragment,{children:e.children})}function Pw(e,t,r){return t.options.notFoundComponent?u.jsx(t.options.notFoundComponent,{data:r}):e.options.defaultNotFoundComponent?u.jsx(e.options.defaultNotFoundComponent,{data:r}):u.jsx(GC,{})}function YC({children:e}){var r;const t=Kr();return t.isServer?u.jsx("script",{nonce:(r=t.options.ssr)==null?void 0:r.nonce,className:"$tsr",dangerouslySetInnerHTML:{__html:[e].filter(Boolean).join(`
`)+";$_TSR.c()"}}):null}function XC(){const e=Kr();if(!e.isScrollRestoring||!e.isServer||typeof e.options.scrollRestoration=="function"&&!e.options.scrollRestoration({location:e.latestLocation}))return null;const r=(e.options.getScrollRestorationKey||mh)(e.latestLocation),n=r!==mh(e.latestLocation)?r:void 0,a={storageKey:t0,shouldScrollRestoration:!0};return n&&(a.key=n),u.jsx(YC,{children:`(${mw.toString()})(${JSON.stringify(a)})`})}const Rw=V.memo(function({matchId:t}){var g,y;const r=Kr(),n=Rr({select:w=>{const S=w.matches.find(A=>A.id===t);return da(S),{routeId:S.routeId,ssr:S.ssr,_displayPending:S._displayPending}},structuralSharing:!0}),a=r.routesById[n.routeId],s=a.options.pendingComponent??r.options.defaultPendingComponent,i=s?u.jsx(s,{}):null,o=a.options.errorComponent??r.options.defaultErrorComponent,l=a.options.onCatch??r.options.defaultOnCatch,c=a.isRoot?a.options.notFoundComponent??((g=r.options.notFoundRoute)==null?void 0:g.options.component):a.options.notFoundComponent,d=n.ssr===!1||n.ssr==="data-only",f=(!a.isRoot||a.options.wrapInSuspense||d)&&(a.options.wrapInSuspense??s??(((y=a.options.errorComponent)==null?void 0:y.preload)||d))?V.Suspense:di,h=o?Jm:di,p=c?KC:di,x=Rr({select:w=>w.loadedAt}),m=Rr({select:w=>{var A;const S=w.matches.findIndex(T=>T.id===t);return(A=w.matches[S-1])==null?void 0:A.routeId}}),v=a.isRoot?a.options.shellComponent??di:di;return u.jsxs(v,{children:[u.jsx(z0.Provider,{value:t,children:u.jsx(f,{fallback:i,children:u.jsx(h,{getResetKey:()=>x,errorComponent:o||U0,onCatch:(w,S)=>{if(zn(w))throw w;Ol(!1,`Error in route match: ${t}`),l==null||l(w,S)},children:u.jsx(p,{fallback:w=>{if(!c||w.routeId&&w.routeId!==n.routeId||!w.routeId&&!a.isRoot)throw w;return V.createElement(c,w)},children:d||n._displayPending?u.jsx(iC,{fallback:i,children:u.jsx(P1,{matchId:t})}):u.jsx(P1,{matchId:t})})})})}),m===Tr&&r.options.scrollRestoration?u.jsxs(u.Fragment,{children:[u.jsx(qC,{}),u.jsx(XC,{})]}):null]})});function qC(){const e=Kr(),t=V.useRef(void 0);return u.jsx("script",{suppressHydrationWarning:!0,ref:r=>{r&&(t.current===void 0||t.current.href!==e.latestLocation.href)&&(e.emit({type:"onRendered",...Bs(e.state)}),t.current=e.latestLocation)}},e.latestLocation.state.__TSR_key)}const P1=V.memo(function({matchId:t}){var l,c,d,f;const r=Kr(),{match:n,key:a,routeId:s}=Rr({select:h=>{const p=h.matches.find(y=>y.id===t),x=p.routeId,m=r.routesById[x].options.remountDeps??r.options.defaultRemountDeps,v=m==null?void 0:m({routeId:x,loaderDeps:p.loaderDeps,params:p._strictParams,search:p._strictSearch});return{key:v?JSON.stringify(v):void 0,routeId:x,match:{id:p.id,status:p.status,error:p.error,_forcePending:p._forcePending,_displayPending:p._displayPending}}},structuralSharing:!0}),i=r.routesById[s],o=V.useMemo(()=>{const h=i.options.component??r.options.defaultComponent;return h?u.jsx(h,{},a):u.jsx(V0,{})},[a,i.options.component,r.options.defaultComponent]);if(n._displayPending)throw(l=r.getMatch(n.id))==null?void 0:l._nonReactive.displayPendingPromise;if(n._forcePending)throw(c=r.getMatch(n.id))==null?void 0:c._nonReactive.minPendingPromise;if(n.status==="pending"){const h=i.options.pendingMinMs??r.options.defaultPendingMinMs;if(h){const p=r.getMatch(n.id);if(p&&!p._nonReactive.minPendingPromise&&!r.isServer){const x=ro();p._nonReactive.minPendingPromise=x,setTimeout(()=>{x.resolve(),p._nonReactive.minPendingPromise=void 0},h)}}throw(d=r.getMatch(n.id))==null?void 0:d._nonReactive.loadPromise}if(n.status==="notFound")return da(zn(n.error)),Pw(r,i,n.error);if(n.status==="redirected")throw da(On(n.error)),(f=r.getMatch(n.id))==null?void 0:f._nonReactive.loadPromise;if(n.status==="error"){if(r.isServer){const h=(i.options.errorComponent??r.options.defaultErrorComponent)||U0;return u.jsx(h,{error:n.error,reset:void 0,info:{componentStack:""}})}throw n.error}return o}),V0=V.memo(function(){const t=Kr(),r=V.useContext(z0),n=Rr({select:c=>{var d;return(d=c.matches.find(f=>f.id===r))==null?void 0:d.routeId}}),a=t.routesById[n],s=Rr({select:c=>{const f=c.matches.find(h=>h.id===r);return da(f),f.globalNotFound}}),i=Rr({select:c=>{var h;const d=c.matches,f=d.findIndex(p=>p.id===r);return(h=d[f+1])==null?void 0:h.id}}),o=t.options.defaultPendingComponent?u.jsx(t.options.defaultPendingComponent,{}):null;if(s)return Pw(t,a,void 0);if(!i)return null;const l=u.jsx(Rw,{matchId:i});return r===Tr?u.jsx(V.Suspense,{fallback:o,children:l}):l});function QC(){const e=Kr(),r=e.routesById[Tr].options.pendingComponent??e.options.defaultPendingComponent,n=r?u.jsx(r,{}):null,a=e.isServer||typeof document<"u"&&e.ssr?di:V.Suspense,s=u.jsxs(a,{fallback:n,children:[!e.isServer&&u.jsx(WC,{}),u.jsx(JC,{})]});return e.options.InnerWrap?u.jsx(e.options.InnerWrap,{children:s}):s}function JC(){const e=Kr(),t=Rr({select:a=>{var s;return(s=a.matches[0])==null?void 0:s.id}}),r=Rr({select:a=>a.loadedAt}),n=t?u.jsx(Rw,{matchId:t}):null;return u.jsx(z0.Provider,{value:t,children:e.options.disableGlobalCatchBoundary?n:u.jsx(Jm,{getResetKey:()=>r,errorComponent:U0,onCatch:a=>{Ol(!1,"The following error wasn't caught by any route! At the very least, consider setting an 'errorComponent' in your RootRoute!"),Ol(!1,a.message||a.toString())},children:n})})}const ZC=e=>new eN(e);class eN extends JT{constructor(t){super(t)}}typeof globalThis<"u"?(globalThis.createFileRoute=zr,globalThis.createLazyFileRoute=F1):typeof window<"u"&&(window.createFileRoute=zr,window.createLazyFileRoute=F1);function tN({router:e,children:t,...r}){Object.keys(r).length>0&&e.update({...e.options,...r,context:{...e.options.context,...r.context}});const n=Fw(),a=u.jsx(n.Provider,{value:e,children:t});return e.options.Wrap?u.jsx(e.options.Wrap,{children:a}):a}function rN({router:e,...t}){return u.jsx(tN,{router:e,...t,children:u.jsx(QC,{})})}const R1=e=>{let t;const r=new Set,n=(d,f)=>{const h=typeof d=="function"?d(t):d;if(!Object.is(h,t)){const p=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(x=>x(t,p))}},a=()=>t,l={setState:n,getState:a,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{r.clear()}},c=t=e(n,a,l);return l},nN=e=>e?R1(e):R1,{useDebugValue:aN}=ts,{useSyncExternalStoreWithSelector:sN}=NC;const iN=e=>e;function oN(e,t=iN,r){const n=sN(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return aN(n),n}const D1=e=>{const t=typeof e=="function"?nN(e):e,r=(n,a)=>oN(t,n,a);return Object.assign(r,t),r},lN=e=>e?D1(e):D1;function cN(e,t){let r;try{r=e()}catch{return}return{getItem:a=>{var s;const i=l=>l===null?null:JSON.parse(l,t==null?void 0:t.reviver),o=(s=r.getItem(a))!=null?s:null;return o instanceof Promise?o.then(i):i(o)},setItem:(a,s)=>r.setItem(a,JSON.stringify(s,t==null?void 0:t.replacer)),removeItem:a=>r.removeItem(a)}}const Ml=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return Ml(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Ml(n)(r)}}}},uN=(e,t)=>(r,n,a)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,g)=>({...g,...v}),...t},i=!1;const o=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return e((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...v)},n,a);const d=Ml(s.serialize),f=()=>{const v=s.partialize({...n()});let g;const y=d({state:v,version:s.version}).then(w=>c.setItem(s.name,w)).catch(w=>{g=w});if(g)throw g;return y},h=a.setState;a.setState=(v,g)=>{h(v,g),f()};const p=e((...v)=>{r(...v),f()},n,a);let x;const m=()=>{var v;if(!c)return;i=!1,o.forEach(y=>y(n()));const g=((v=s.onRehydrateStorage)==null?void 0:v.call(s,n()))||void 0;return Ml(c.getItem.bind(c))(s.name).then(y=>{if(y)return s.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==s.version){if(s.migrate)return s.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var w;return x=s.merge(y,(w=n())!=null?w:p),r(x,!0),f()}).then(()=>{g==null||g(x,void 0),i=!0,l.forEach(y=>y(x))}).catch(y=>{g==null||g(void 0,y)})};return a.persist={setOptions:v=>{s={...s,...v},v.getStorage&&(c=v.getStorage())},clearStorage:()=>{c==null||c.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:v=>(o.add(v),()=>{o.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},m(),x||p},dN=(e,t)=>(r,n,a)=>{let s={storage:cN(()=>localStorage),partialize:m=>m,version:0,merge:(m,v)=>({...v,...m}),...t},i=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return e((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...m)},n,a);const d=()=>{const m=s.partialize({...n()});return c.setItem(s.name,{state:m,version:s.version})},f=a.setState;a.setState=(m,v)=>{f(m,v),d()};const h=e((...m)=>{r(...m),d()},n,a);a.getInitialState=()=>h;let p;const x=()=>{var m,v;if(!c)return;i=!1,o.forEach(y=>{var w;return y((w=n())!=null?w:h)});const g=((v=s.onRehydrateStorage)==null?void 0:v.call(s,(m=n())!=null?m:h))||void 0;return Ml(c.getItem.bind(c))(s.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==s.version){if(s.migrate)return[!0,s.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var w;const[S,A]=y;if(p=s.merge(A,(w=n())!=null?w:h),r(p,!0),S)return d()}).then(()=>{g==null||g(p,void 0),p=n(),i=!0,l.forEach(y=>y(p))}).catch(y=>{g==null||g(void 0,y)})};return a.persist={setOptions:m=>{s={...s,...m},m.storage&&(c=m.storage)},clearStorage:()=>{c==null||c.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>i,onHydrate:m=>(o.add(m),()=>{o.delete(m)}),onFinishHydration:m=>(l.add(m),()=>{l.delete(m)})},s.skipHydration||x(),p||h},fN=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?uN(e,t):dN(e,t),hN=fN,mN="http://localhost:5003/api";class pN{constructor(t){at(this,"baseURL");this.baseURL=t}async request(t,r={}){const n=localStorage.getItem("auth_token"),a={"Content-Type":"application/json",...r.headers||{}};n&&(a.Authorization=`Bearer ${n}`);const s=await fetch(`${this.baseURL}${t}`,{...r,headers:a}),i=await s.json();return{status:s.status,data:i}}async login(t){return this.request("/auth/login",{method:"POST",body:JSON.stringify(t)})}async logout(){return this.request("/auth/logout",{method:"POST"})}async refreshToken(){const t=localStorage.getItem("refresh_token");return this.request("/auth/refresh",{method:"POST",body:JSON.stringify({refreshToken:t})})}async getPatients(t={}){const r=new URLSearchParams;t.page&&r.append("page",t.page.toString()),t.limit&&r.append("limit",t.limit.toString()),t.search&&r.append("search",t.search);const n=r.toString(),a=`/patients${n?`?${n}`:""}`;return this.request(a)}async getPatient(t){return this.request(`/patients/${t}`)}async createPatient(t){return this.request("/patients",{method:"POST",body:JSON.stringify(t)})}async updatePatient(t,r){return this.request(`/patients/${t}`,{method:"PUT",body:JSON.stringify(r)})}async deletePatient(t){return this.request(`/patients/${t}`,{method:"DELETE"})}}const j1=new pN(mN),np=lN()(hN((e,t)=>({user:null,token:null,refreshToken:null,isAuthenticated:!1,isLoading:!1,error:null,setAuth:(r,n)=>{e({user:r,token:n,isAuthenticated:!0,error:null}),localStorage.setItem("auth_token",n),typeof window<"u"&&(window.__AUTH_TOKEN__=n)},clearAuth:()=>{e({user:null,token:null,refreshToken:null,isAuthenticated:!1,error:null}),localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("auth_token_timestamp"),typeof window<"u"&&delete window.__AUTH_TOKEN__},setLoading:r=>{e({isLoading:r})},setError:r=>{e({error:r})},login:async r=>{var s;const{setLoading:n,setError:a}=t();try{n(!0),a(null),console.log("Attempting login with credentials:",{username:r.username,password:"***"});const i=await j1.login(r);if(console.log("Login response:",i),console.log("Response status:",i.status),console.log("Response data:",i.data),i.status===200&&i.data){const o=i.data,{access_token:l,data:c,success:d,refreshToken:f}=o;if(console.log("Parsed token:",l),console.log("Parsed userData:",c),console.log("Success:",d),console.log("RefreshToken:",f),console.log("Full response data:",o),d&&l&&c){const h={id:c.id,email:c.email,name:c.fullName||c.username,role:c.role};e({user:h,token:l,refreshToken:f||null,isAuthenticated:!0,error:null}),localStorage.setItem("auth_token",l),f&&localStorage.setItem("refresh_token",f),localStorage.setItem("auth_token_timestamp",Date.now().toString()),typeof window<"u"&&(window.__AUTH_TOKEN__=l),console.log("Login successful, user authenticated")}else throw console.error("Missing required fields:",{success:d,token:!!l,userData:!!c}),new Error("Invalid response from server - missing token or user")}else if(i.status===401){const o=((s=i.data)==null?void 0:s.error)||"Invalid credentials";throw console.error("Authentication failed:",o),new Error(o)}else throw console.error("Invalid response structure:",{status:i.status,hasData:!!i.data}),new Error("Invalid response from server")}catch(i){console.error("Login error:",i),a(i instanceof Error?i.message:"Login failed")}finally{n(!1)}},logout:()=>{t().clearAuth()},refreshAuth:async()=>{try{const{refreshToken:r,clearAuth:n}=t();if(!r){n();return}const a=await j1.refreshToken();if(a.status===200&&a.data){const{access_token:s}=a.data;e({token:s}),localStorage.setItem("auth_token",s),typeof window<"u"&&(window.__AUTH_TOKEN__=s)}else n()}catch(r){console.error("Token refresh failed:",r),t().clearAuth()}},initializeAuth:async()=>{const{setLoading:r,login:n,isAuthenticated:a}=t()}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token,refreshToken:e.refreshToken,isAuthenticated:e.isAuthenticated})}));/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),yt=(e,t)=>{const r=V.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},d)=>V.createElement("svg",{ref:d,...xN,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${gN(e)}`,o].join(" "),...c},[...t.map(([f,h])=>V.createElement(f,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=yt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I1=yt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=yt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=yt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=yt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=yt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=yt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=yt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=yt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=yt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=yt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=yt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=yt("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=yt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=yt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=yt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O1=yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=yt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=yt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=yt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=yt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),PN={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-full mx-4"},il=({isOpen:e,onClose:t,onSave:r,title:n,size:a="md",closable:s=!0,backdrop:i=!0,showFooter:o=!0,saveButtonText:l="Kaydet",cancelButtonText:c="ptal",customFooter:d,children:f,className:h=""})=>{const p=V.useRef(null),x=V.useRef(null);V.useEffect(()=>{const w=S=>{S.key==="Escape"&&s&&t()};return e&&(document.addEventListener("keydown",w),x.current=document.activeElement,document.body.style.overflow="hidden",setTimeout(()=>{var A;const S=(A=p.current)==null?void 0:A.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');S&&S.length>0&&S[0].focus()},100)),()=>{document.removeEventListener("keydown",w),e&&(document.body.style.overflow="",x.current&&x.current.focus())}},[e,s,t]);const m=w=>{var S;if(w.key==="Tab"){const A=(S=p.current)==null?void 0:S.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(A&&A.length>0){const T=A[0],b=A[A.length-1];w.shiftKey&&document.activeElement===T?(w.preventDefault(),b.focus()):!w.shiftKey&&document.activeElement===b&&(w.preventDefault(),T.focus())}}},v=w=>{w.target===w.currentTarget&&i&&s&&t()},g=()=>{r&&r()!==!1&&t()};if(!e)return null;const y=u.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",onClick:v,children:[u.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),u.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),u.jsxs("div",{ref:p,className:`
            inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle w-full
            ${PN[a]}
            ${h}
          `,onKeyDown:m,children:[(n||s)&&u.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[n&&u.jsx("h3",{id:"modal-title",className:"text-lg font-semibold text-gray-900 dark:text-white",children:n}),s&&u.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:u.jsx(FN,{className:"w-5 h-5"})})]}),u.jsx("div",{className:"px-6 py-4",children:f}),o&&u.jsx("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600",children:d||u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-50 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:c}),r&&u.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:l})]})})]})]})});return Hm.createPortal(y,document.body)},RN={blue:{bg:"bg-blue-100 dark:bg-blue-900/20",icon:"text-blue-600 dark:text-blue-400"},green:{bg:"bg-green-100 dark:bg-green-900/20",icon:"text-green-600 dark:text-green-400"},yellow:{bg:"bg-yellow-100 dark:bg-yellow-900/20",icon:"text-yellow-600 dark:text-yellow-400"},red:{bg:"bg-red-100 dark:bg-red-900/20",icon:"text-red-600 dark:text-red-400"},purple:{bg:"bg-purple-100 dark:bg-purple-900/20",icon:"text-purple-600 dark:text-purple-400"},gray:{bg:"bg-gray-100 dark:bg-gray-700",icon:"text-gray-600 dark:text-gray-400"}},Ba=({title:e,value:t,icon:r,color:n="blue",trend:a,subtitle:s,clickable:i=!1,onClick:o,loading:l=!1,className:c=""})=>{const d=RN[n],f=i?"cursor-pointer hover:shadow-lg transition-shadow duration-200":"",h=()=>{if(!a)return null;const m=a.direction==="up"?"text-green-600 dark:text-green-400":a.direction==="down"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400",v=a.direction==="up"?Ow:a.direction==="down"?AN:jw;return u.jsxs("div",{className:"flex items-center mt-2",children:[u.jsxs("span",{className:`text-sm ${m} flex items-center`,children:[u.jsx(v,{className:"w-4 h-4 mr-1"}),u.jsx("span",{children:a.value})]}),a.period&&u.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 ml-2",children:a.period})]})},p=()=>u.jsx("div",{className:"animate-pulse",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-600 rounded w-24 mb-2"}),u.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-600 rounded w-16 mb-2"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-600 rounded w-20"})]}),u.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-600 rounded-lg ml-4"})]})}),x=()=>u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:e}),u.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-1",children:t}),s&&u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:s}),h()]}),r&&u.jsx("div",{className:`p-3 ${d.bg} rounded-lg ml-4`,children:u.jsx("div",{className:d.icon,children:r})})]});return u.jsx("div",{className:`
        bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700
        ${f}
        ${c}
      `,onClick:i?o:void 0,role:i?"button":void 0,tabIndex:i?0:void 0,onKeyDown:i?m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),o==null||o())}:void 0,children:l?p():x()})},Mw=({data:e,columns:t,loading:r=!1,pagination:n,rowSelection:a,actions:s,bulkActions:i,searchable:o=!1,onSearch:l,sortable:c=!1,onSort:d,rowKey:f="id",emptyText:h="Veri bulunamad",size:p="medium",bordered:x=!1,striped:m=!1,hoverable:v=!0,className:g=""})=>{const[y,w]=V.useState(""),[S,A]=V.useState(null);V.useState(!1);const T=V.useCallback((P,Z)=>typeof f=="function"?f(P):P[f]||Z,[f]),b=V.useMemo(()=>a?e.filter(P=>a.selectedRowKeys.includes(T(P,e.indexOf(P)))):[],[e,a,T]),k=P=>{if(!c)return;let Z="asc";(S==null?void 0:S.key)===P&&(Z=S.direction==="asc"?"desc":S.direction==="desc"?null:"asc"),A(Z?{key:P,direction:Z}:null),d==null||d(P,Z)},E=P=>{w(P),l==null||l(P)},_=P=>{if(a)if(P){const Z=e.map((le,R)=>T(le,R));a.onChange(Z,e)}else a.onChange([],[])},C=(P,Z)=>{if(!a)return;const le=T(P,e.indexOf(P));let R=[...a.selectedRowKeys];Z?R.push(le):R=R.filter(W=>W!==le);const G=e.filter(W=>R.includes(T(W,e.indexOf(W))));a.onChange(R,G)},F={small:"text-sm",medium:"text-base",large:"text-lg"},D={small:"px-3 py-2",medium:"px-4 py-3",large:"px-6 py-4"},M=a&&e.length>0&&e.every(P=>a.selectedRowKeys.includes(T(P,e.indexOf(P)))),B=a&&a.selectedRowKeys.length>0&&!M,q=(P,Z,le)=>{const R=Z[P.key];return P.render?P.render(R,Z,le):R},Q=P=>!s||s.length===0?null:u.jsx("div",{className:"flex items-center space-x-2",children:s.map(Z=>{var le;return u.jsxs("button",{onClick:()=>Z.onClick(P),disabled:(le=Z.disabled)==null?void 0:le.call(Z,P),className:`
              inline-flex items-center px-2 py-1 text-sm font-medium rounded-md
              ${Z.variant==="danger"?"text-red-700 bg-red-100 hover:bg-red-200 dark:text-red-400 dark:bg-red-900/20 dark:hover:bg-red-900/30":Z.variant==="primary"?"text-blue-700 bg-blue-100 hover:bg-blue-200 dark:text-blue-400 dark:bg-blue-900/20 dark:hover:bg-blue-900/30":"text-gray-700 bg-gray-100 hover:bg-gray-200 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600"}
              disabled:opacity-50 disabled:cursor-not-allowed
            `,children:[Z.icon&&u.jsx("span",{className:"mr-1",children:Z.icon}),Z.label]},Z.key)})}),J=()=>{if(!n)return null;const{current:P,pageSize:Z,total:le,showSizeChanger:R,pageSizeOptions:G=[10,20,50,100]}=n,W=Math.ceil(le/Z),K=(P-1)*Z+1,O=Math.min(P*Z,le),se=(()=>{const oe=[];if(W<=5)for(let ue=1;ue<=W;ue++)oe.push(ue);else{const ue=Math.max(1,P-Math.floor(2.5)),L=Math.min(W,ue+5-1);for(let Pe=ue;Pe<=L;Pe++)oe.push(Pe);ue>1&&(oe.unshift(-1),oe.unshift(1)),L<W&&(oe.push(-2),oe.push(W))}return oe})();return u.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center text-sm text-gray-700 dark:text-gray-300",children:[u.jsxs("span",{children:[le>0?`${K}-${O}`:"0"," / ",le," kayt gsteriliyor"]}),R&&u.jsx("select",{value:Z,onChange:ie=>n.onChange(1,Number(ie.target.value)),className:"ml-4 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:G.map(ie=>u.jsxs("option",{value:ie,children:[ie," / sayfa"]},ie))})]}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx("button",{onClick:()=>n.onChange(1,Z),disabled:P<=1,className:"px-2 py-1 text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",title:"lk sayfa",children:"lk"}),u.jsx("button",{onClick:()=>n.onChange(P-1,Z),disabled:P<=1,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",title:"nceki sayfa",children:u.jsx(yN,{className:"w-4 h-4"})}),u.jsx("div",{className:"flex items-center space-x-1",children:se.map((ie,oe)=>ie===-1||ie===-2?u.jsx("span",{className:"px-2 py-1 text-gray-400",children:"..."},`ellipsis-${oe}`):u.jsx("button",{onClick:()=>n.onChange(ie,Z),className:`
                    px-3 py-1 text-sm rounded-md transition-colors
                    ${ie===P?"bg-blue-600 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}
                  `,children:ie},ie))}),u.jsx("button",{onClick:()=>n.onChange(P+1,Z),disabled:P>=W,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",title:"Sonraki sayfa",children:u.jsx(wN,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>n.onChange(W,Z),disabled:P>=W,className:"px-2 py-1 text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",title:"Son sayfa",children:"Son"})]})]})};return u.jsxs("div",{className:`bg-white dark:bg-gray-800 shadow-sm rounded-lg ${g}`,children:[u.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[o&&u.jsxs("div",{className:"relative",children:[u.jsx(Iw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),u.jsx("input",{type:"text",placeholder:"Ara...",value:y,onChange:P=>E(P.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i&&b.length>0&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[b.length," kayt seildi"]}),u.jsx("div",{className:"flex space-x-2",children:i.map(P=>u.jsxs("button",{onClick:()=>P.onClick(b),className:`
                        inline-flex items-center px-3 py-1 text-sm font-medium rounded-md
                        ${P.variant==="danger"?"text-red-700 bg-red-100 hover:bg-red-200 dark:text-red-400 dark:bg-red-900/20 dark:hover:bg-red-900/30":P.variant==="primary"?"text-blue-700 bg-blue-100 hover:bg-blue-200 dark:text-blue-400 dark:bg-blue-900/20 dark:hover:bg-blue-900/30":"text-gray-700 bg-gray-100 hover:bg-gray-200 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600"}
                      `,children:[P.icon&&u.jsx("span",{className:"mr-1",children:P.icon}),P.label]},P.key))})]})]})})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:`min-w-full divide-y divide-gray-200 dark:divide-gray-700 ${F[p]}`,children:[u.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:u.jsxs("tr",{children:[a&&u.jsx("th",{className:`${D[p]} text-left`,children:u.jsx("input",{type:"checkbox",checked:M,ref:P=>{P&&(P.indeterminate=!!B)},onChange:P=>_(P.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),t.map(P=>u.jsx("th",{className:`
                    ${D[p]} text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider
                    ${P.sortable&&c?"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600":""}
                    ${P.align==="center"?"text-center":P.align==="right"?"text-right":"text-left"}
                  `,style:{width:P.width},onClick:()=>P.sortable&&k(P.key),children:u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx("span",{children:P.title}),P.sortable&&c&&u.jsxs("div",{className:"flex flex-col",children:[u.jsx(kN,{className:`w-3 h-3 ${(S==null?void 0:S.key)===P.key&&S.direction==="asc"?"text-blue-600":"text-gray-400"}`}),u.jsx(Dw,{className:`w-3 h-3 -mt-1 ${(S==null?void 0:S.key)===P.key&&S.direction==="desc"?"text-blue-600":"text-gray-400"}`})]})]})},P.key)),s&&s.length>0&&u.jsx("th",{className:`${D[p]} text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`,children:"lemler"})]})}),u.jsx("tbody",{className:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700 ${m?"divide-y-0":""}`,children:r?u.jsx("tr",{children:u.jsx("td",{colSpan:t.length+(a?1:0)+(s?1:0),className:"px-4 py-8 text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Ykleniyor..."})]})})}):e.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:t.length+(a?1:0)+(s?1:0),className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:h})}):e.map((P,Z)=>{var W;const le=T(P,Z),R=a==null?void 0:a.selectedRowKeys.includes(le),G=((W=a==null?void 0:a.getCheckboxProps)==null?void 0:W.call(a,P))||{};return u.jsxs("tr",{className:`
                      ${m&&Z%2===1?"bg-gray-50 dark:bg-gray-700/50":""}
                      ${v?"hover:bg-gray-50 dark:hover:bg-gray-700/50":""}
                      ${R?"bg-blue-50 dark:bg-blue-900/20":""}
                    `,children:[a&&u.jsx("td",{className:D[p],children:u.jsx("input",{type:"checkbox",checked:R,disabled:G.disabled,onChange:K=>C(P,K.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50"})}),t.map(K=>u.jsx("td",{className:`
                          ${D[p]} text-gray-900 dark:text-gray-100
                          ${K.align==="center"?"text-center":K.align==="right"?"text-right":"text-left"}
                          ${x?"border-r border-gray-200 dark:border-gray-700 last:border-r-0":""}
                        `,children:q(K,P,Z)},K.key)),s&&s.length>0&&u.jsx("td",{className:D[p],children:Q(P)})]},le)})})]})}),J()]})},DN={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-blue-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500"},jN={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},Te=({variant:e="primary",size:t="md",loading:r=!1,icon:n,iconPosition:a="left",fullWidth:s=!1,disabled:i,className:o="",children:l,...c})=>{const f=["inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",DN[e],jN[t],s?"w-full":"",o].filter(Boolean).join(" "),h=i||r;return u.jsxs("button",{className:f,disabled:h,...c,children:[r&&u.jsx(_N,{className:"w-4 h-4 mr-2 animate-spin"}),!r&&n&&a==="left"&&u.jsx("span",{className:"mr-2",children:n}),l,!r&&n&&a==="right"&&u.jsx("span",{className:"ml-2",children:n})]})},Ie=V.forwardRef(({label:e,error:t,helperText:r,leftIcon:n,rightIcon:a,fullWidth:s=!1,className:i="",id:o,...l},c)=>{const d=o||`input-${Math.random().toString(36).substr(2,9)}`,m=["block px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",t?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500",s?"w-full":"",n&&a?"pl-10 pr-10":n?"pl-10":a?"pr-10":"",i].filter(Boolean).join(" ");return u.jsxs("div",{className:s?"w-full":"",children:[e&&u.jsx("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),u.jsxs("div",{className:"relative",children:[n&&u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx("span",{className:"text-gray-400",children:n})}),u.jsx("input",{ref:c,id:d,className:m,...l}),a&&!t&&u.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:u.jsx("span",{className:"text-gray-400",children:a})}),t&&u.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:u.jsx(ap,{className:"w-5 h-5 text-red-500"})})]}),t&&u.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})});Ie.displayName="Input";const Tt=V.forwardRef(({label:e,error:t,helperText:r,options:n,placeholder:a,fullWidth:s=!1,className:i="",id:o,...l},c)=>{const d=o||`select-${Math.random().toString(36).substr(2,9)}`,x=["block px-3 py-2 pr-10 border rounded-lg text-sm bg-white transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed appearance-none",t?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500",s?"w-full":"",i].filter(Boolean).join(" ");return u.jsxs("div",{className:s?"w-full":"",children:[e&&u.jsx("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),u.jsxs("div",{className:"relative",children:[u.jsxs("select",{ref:c,id:d,className:x,...l,children:[a&&u.jsx("option",{value:"",disabled:!0,children:a}),n.map(m=>u.jsx("option",{value:m.value,disabled:m.disabled,children:m.label},m.value))]}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:t?u.jsx(ap,{className:"w-5 h-5 text-red-500"}):u.jsx(Dw,{className:"w-5 h-5 text-gray-400"})})]}),t&&u.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})});Tt.displayName="Select";const sp=V.forwardRef(({label:e,error:t,helperText:r,fullWidth:n=!1,resize:a="vertical",className:s="",id:i,...o},l)=>{const c=i||`textarea-${Math.random().toString(36).substr(2,9)}`,x=["block px-3 py-2 border rounded-lg text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",t?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500",n?"w-full":"",{none:"resize-none",vertical:"resize-y",horizontal:"resize-x",both:"resize"}[a],s].filter(Boolean).join(" ");return u.jsxs("div",{className:n?"w-full":"",children:[e&&u.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),u.jsxs("div",{className:"relative",children:[u.jsx("textarea",{ref:l,id:c,className:x,...o}),t&&u.jsx("div",{className:"absolute top-2 right-2 pointer-events-none",children:u.jsx(ap,{className:"w-5 h-5 text-red-500"})})]}),t&&u.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})});sp.displayName="Textarea";const IN={default:"bg-gray-100 text-gray-800",primary:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800"},ON={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-sm",lg:"px-3 py-1 text-sm"},L1=({children:e,variant:t="default",size:r="md",className:n=""})=>{const s=["inline-flex items-center font-medium rounded-full",IN[t],ON[r],n].filter(Boolean).join(" ");return u.jsx("span",{className:s,children:e})},Lw=V.forwardRef(({label:e,error:t,helperText:r,indeterminate:n=!1,className:a="",id:s,...i},o)=>{const l=s||`checkbox-${Math.random().toString(36).substr(2,9)}`,c="w-4 h-4 border rounded transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",d=t?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500",f=i.checked||n?"bg-blue-600 border-blue-600 text-white":"bg-white",h=[c,d,f,a].filter(Boolean).join(" ");return u.jsxs("div",{className:"flex items-start",children:[u.jsxs("div",{className:"relative flex items-center",children:[u.jsx("input",{ref:o,type:"checkbox",id:l,className:`${h} appearance-none`,...i}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:n?u.jsx(jw,{className:"w-3 h-3 text-white"}):i.checked?u.jsx(vN,{className:"w-3 h-3 text-white"}):null})]}),(e||t||r)&&u.jsxs("div",{className:"ml-2 flex-1",children:[e&&u.jsx("label",{htmlFor:l,className:"block text-sm font-medium text-gray-700 cursor-pointer",children:e}),t&&u.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})]})});Lw.displayName="Checkbox";const MN=V.forwardRef(({label:e,error:t,helperText:r,className:n="",id:a,...s},i)=>{const o=a||`radio-${Math.random().toString(36).substr(2,9)}`,l="w-4 h-4 border rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",c=t?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500",d=s.checked?"bg-blue-600 border-blue-600":"bg-white",f=[l,c,d,n].filter(Boolean).join(" ");return u.jsxs("div",{className:"flex items-start",children:[u.jsxs("div",{className:"relative flex items-center",children:[u.jsx("input",{ref:i,type:"radio",id:o,className:`${f} appearance-none`,...s}),s.checked&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:u.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]}),(e||t||r)&&u.jsxs("div",{className:"ml-2 flex-1",children:[e&&u.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700 cursor-pointer",children:e}),t&&u.jsx("p",{className:"mt-1 text-sm text-red-600",children:t}),r&&!t&&u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})]})});MN.displayName="Radio";V.createContext(void 0);V.createContext(void 0);const LN={default:"bg-white border border-gray-200 rounded-lg shadow-sm",outlined:"bg-white border-2 border-gray-300 rounded-lg",elevated:"bg-white border border-gray-200 rounded-lg shadow-lg",filled:"bg-gray-50 border border-gray-200 rounded-lg"},BN={none:"",sm:"p-3",md:"p-4",lg:"p-6"},B1=({className:e="",variant:t="default",padding:r="md",children:n,...a})=>{const s=[LN[t],BN[r],e].filter(Boolean).join(" ");return u.jsx("div",{className:s,...a,children:n})},UN=[{id:"1",productName:"Wireless Headphones",brand:"TechBrand",model:"WH-1000XM4",category:"Electronics",stock:25,minStock:10,unitPrice:299.99,vatIncludedPrice:353.99,totalValue:8849.75,barcode:"1234567890123",supplier:"Tech Supplier Inc.",warrantyPeriod:"2 years",status:"active",createdAt:"2024-01-15T10:30:00Z",updatedAt:"2024-01-20T14:45:00Z"},{id:"2",productName:"Bluetooth Speaker",brand:"AudioMax",model:"BT-500",category:"Electronics",stock:5,minStock:15,unitPrice:89.99,vatIncludedPrice:106.19,totalValue:530.95,barcode:"2345678901234",supplier:"Audio Solutions Ltd.",warrantyPeriod:"1 year",status:"active",createdAt:"2024-01-10T09:15:00Z",updatedAt:"2024-01-18T16:20:00Z"}],$d=["All","Electronics","Accessories","Components","Tools"],$N=["All","TechBrand","AudioMax","ComponentCorp","ToolMaster"],zN=["All","Active","Inactive","Discontinued"],VN=()=>{var Z,le,R,G,W,K;const[e,t]=V.useState(UN),[r,n]=V.useState(!1),[a,s]=V.useState({search:"",category:"All",brand:"All",status:"All",lowStock:!1}),[i,o]=V.useState(!1),[l,c]=V.useState(!1),[d,f]=V.useState(!1),[h,p]=V.useState(!1),[x,m]=V.useState(!1),[v,g]=V.useState(null);V.useState("category"),V.useState({category:"",priceType:"percentage",priceValue:"",stockOperation:"set",stockValue:"",supplier:""});const[y,w]=V.useState([]),[S,A]=V.useState({current:1,pageSize:20,total:0}),[T,b]=V.useState({productName:"",brand:"",model:"",category:"",stock:0,minStock:0,unitPrice:0,barcode:"",supplier:"",warrantyPeriod:"",status:"active"}),k=V.useMemo(()=>{let O=e;if(a.search){const X=a.search.toLowerCase();O=O.filter(se=>{var ie;return se.productName.toLowerCase().includes(X)||se.brand.toLowerCase().includes(X)||se.model.toLowerCase().includes(X)||((ie=se.barcode)==null?void 0:ie.toLowerCase().includes(X))})}return a.category!=="All"&&(O=O.filter(X=>X.category===a.category)),a.brand!=="All"&&(O=O.filter(X=>X.brand===a.brand)),a.status!=="All"&&(O=O.filter(X=>X.status===a.status.toLowerCase())),a.lowStock&&(O=O.filter(X=>X.stock<=X.minStock)),O},[e,a]),E=V.useMemo(()=>{const O=e.length,X=e.filter(oe=>oe.stock<=oe.minStock).length,se=e.reduce((oe,ue)=>oe+ue.totalValue,0),ie=e.filter(oe=>oe.status==="active").length;return{totalProducts:O,lowStockCount:X,totalValue:se,activeTrials:ie}},[e]);V.useEffect(()=>{A(O=>({...O,total:k.length}))},[k]);const _=[{key:"productName",title:"Product Name",sortable:!0,render:(O,X)=>u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:O}),u.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[X.brand," - ",X.model]})]})},{key:"category",title:"Category",sortable:!0,render:O=>u.jsx(L1,{variant:"secondary",children:O})},{key:"stock",title:"Stock",sortable:!0,render:(O,X)=>u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:`font-medium ${O<=X.minStock?"text-red-600":"text-gray-900 dark:text-white"}`,children:O}),O<=X.minStock&&u.jsx(I1,{className:"w-4 h-4 text-red-500"})]})},{key:"minStock",title:"Min Stock",sortable:!0},{key:"unitPrice",title:"Unit Price",sortable:!0,render:O=>`${O.toFixed(2)}`},{key:"vatIncludedPrice",title:"VAT Included Price",sortable:!0,render:O=>`${O.toFixed(2)}`},{key:"totalValue",title:"Total Value",sortable:!0,render:O=>`${O.toFixed(2)}`},{key:"status",title:"Status",render:O=>u.jsx(L1,{variant:O==="active"?"success":O==="inactive"?"warning":"danger",children:O.charAt(0).toUpperCase()+O.slice(1)})}],C=[{key:"view",label:"View Details",icon:u.jsx(EN,{className:"w-4 h-4"}),onClick:O=>{g(O),f(!0)}},{key:"edit",label:"Edit",icon:u.jsx(CN,{className:"w-4 h-4"}),onClick:O=>{g(O),b(O),c(!0)}},{key:"delete",label:"Delete",icon:u.jsx(O1,{className:"w-4 h-4"}),variant:"danger",onClick:O=>{window.confirm(`Are you sure you want to delete ${O.productName}?`)&&t(X=>X.filter(se=>se.id!==O.id))}}],F=[{key:"bulk-operations",label:"Bulk Operations",icon:u.jsx(bN,{className:"w-4 h-4"}),onClick:O=>{p(!0)}},{key:"delete",label:"Delete Selected",icon:u.jsx(O1,{className:"w-4 h-4"}),variant:"danger",onClick:O=>{if(window.confirm(`Are you sure you want to delete ${O.length} items?`)){const X=O.map(se=>se.id);t(se=>se.filter(ie=>!X.includes(ie.id))),w([])}}},{key:"export",label:"Export Selected",icon:u.jsx(Ud,{className:"w-4 h-4"}),onClick:O=>{D(O)}}],D=O=>{const se=[["ID","Product Name","Brand","Model","Category","Stock","Min Stock","Unit Price","VAT Included Price","Total Value","Barcode","Serial Number","Supplier","Warranty Period","Status","Created At","Updated At"].join(","),...O.map(ue=>[ue.id,`"${ue.productName}"`,`"${ue.brand}"`,`"${ue.model}"`,`"${ue.category}"`,ue.stock,ue.minStock,ue.unitPrice,ue.vatIncludedPrice,ue.totalValue,`"${ue.barcode||""}"`,`"${ue.serialNumber||""}"`,`"${ue.supplier||""}"`,`"${ue.warrantyPeriod||""}"`,ue.status,ue.createdAt,ue.updatedAt].join(","))].join(`
`),ie=new Blob([se],{type:"text/csv;charset=utf-8;"}),oe=document.createElement("a");oe.href=URL.createObjectURL(ie),oe.download=`inventory_export_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe)},M=()=>{const O=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Inventory Report</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; }
          .header { text-align: center; margin-bottom: 30px; }
          .stats { display: flex; justify-content: space-around; margin: 20px 0; }
          .stat-item { text-align: center; }
          @media print { .no-print { display: none; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Inventory Report</h1>
          <p>Generated on: ${new Date().toLocaleDateString()}</p>
        </div>
        
        <div class="stats">
          <div class="stat-item">
            <h3>${E.totalProducts}</h3>
            <p>Total Products</p>
          </div>
          <div class="stat-item">
            <h3>${E.lowStockCount}</h3>
            <p>Low Stock Items</p>
          </div>
          <div class="stat-item">
            <h3>${E.totalValue.toFixed(2)}</h3>
            <p>Total Value</p>
          </div>
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Name</th>
              <th>Brand</th>
              <th>Category</th>
              <th>Stock</th>
              <th>Unit Price</th>
              <th>Total Value</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            ${k.map(se=>`
              <tr>
                <td>${se.productName}</td>
                <td>${se.brand}</td>
                <td>${se.category}</td>
                <td>${se.stock}</td>
                <td>${se.unitPrice.toFixed(2)}</td>
                <td>${se.totalValue.toFixed(2)}</td>
                <td>${se.status}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      </body>
      </html>
    `,X=window.open("","_blank");X&&(X.document.write(O),X.document.close(),X.print())},B=(O,X)=>{s(se=>({...se,[O]:X}))},q=()=>{if(!T.productName||!T.brand||!T.category)return alert("Please fill in all required fields"),!1;const O={id:Date.now().toString(),productName:T.productName,brand:T.brand,model:T.model||"",category:T.category,stock:T.stock||0,minStock:T.minStock||0,unitPrice:T.unitPrice||0,vatIncludedPrice:(T.unitPrice||0)*1.18,totalValue:(T.stock||0)*((T.unitPrice||0)*1.18),barcode:T.barcode,supplier:T.supplier,warrantyPeriod:T.warrantyPeriod,status:T.status,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return t(X=>[...X,O]),b({productName:"",brand:"",model:"",category:"",stock:0,minStock:0,unitPrice:0,barcode:"",supplier:"",warrantyPeriod:"",status:"active"}),!0},Q=()=>{if(!v||!T.productName||!T.brand||!T.category)return alert("Please fill in all required fields"),!1;const O={...v,...T,vatIncludedPrice:(T.unitPrice||0)*1.18,totalValue:(T.stock||0)*((T.unitPrice||0)*1.18),updatedAt:new Date().toISOString()};return t(X=>X.map(se=>se.id===v.id?O:se)),g(null),b({productName:"",brand:"",model:"",category:"",stock:0,minStock:0,unitPrice:0,barcode:"",supplier:"",warrantyPeriod:"",status:"active"}),!0},J=(O,X)=>{A(se=>({...se,current:O,pageSize:X}))},P=(O,X)=>{w(O)};return u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Inventory Management"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your product inventory"})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Te,{variant:"outline",onClick:M,icon:u.jsx(Ud,{className:"w-4 h-4"}),children:"Print"}),u.jsx(Te,{variant:"outline",onClick:()=>D(k),icon:u.jsx(Ud,{className:"w-4 h-4"}),children:"Export CSV"}),u.jsx(Te,{variant:"outline",onClick:()=>m(!0),icon:u.jsx(M1,{className:"w-4 h-4"}),children:"Bulk Upload"}),u.jsx(Te,{onClick:()=>o(!0),icon:u.jsx(NN,{className:"w-4 h-4"}),children:"Add Product"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsx(Ba,{title:"Total Products",value:E.totalProducts.toString(),color:"blue",icon:u.jsx(TN,{className:"w-6 h-6"})}),u.jsx(Ba,{title:"Low Stock",value:E.lowStockCount.toString(),color:"red",icon:u.jsx(I1,{className:"w-6 h-6"})}),u.jsx(Ba,{title:"Total Value",value:`${E.totalValue.toFixed(2)}`,color:"green",icon:u.jsx(SN,{className:"w-6 h-6"})}),u.jsx(Ba,{title:"Active Items",value:E.activeTrials.toString(),color:"purple",icon:u.jsx(Ow,{className:"w-6 h-6"})})]}),u.jsx(B1,{className:"p-4",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[u.jsx("div",{className:"lg:col-span-2",children:u.jsx(Ie,{placeholder:"Search products, brands, models...",value:a.search,onChange:O=>B("search",O.target.value),leftIcon:u.jsx(Iw,{className:"w-4 h-4"})})}),u.jsx(Tt,{value:a.category,onChange:O=>B("category",O),options:$d.map(O=>({value:O,label:O})),placeholder:"Category"}),u.jsx(Tt,{value:a.brand,onChange:O=>B("brand",O),options:$N.map(O=>({value:O,label:O})),placeholder:"Brand"}),u.jsx(Tt,{value:a.status,onChange:O=>B("status",O),options:zN.map(O=>({value:O,label:O})),placeholder:"Status"}),u.jsx("div",{className:"flex items-center",children:u.jsx(Lw,{checked:a.lowStock,onChange:O=>B("lowStock",O),label:"Low Stock Only"})})]})}),u.jsx(B1,{children:u.jsx(Mw,{data:k.slice((S.current-1)*S.pageSize,S.current*S.pageSize),columns:_,loading:r,pagination:{...S,onChange:J},rowSelection:{selectedRowKeys:y,onChange:P},actions:C,bulkActions:F,searchable:!1,sortable:!0,rowKey:"id",hoverable:!0,striped:!0})}),u.jsx(il,{isOpen:i,onClose:()=>o(!1),onSave:q,title:"Add New Product",size:"lg",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Ie,{label:"Product Name *",value:T.productName||"",onChange:O=>b(X=>({...X,productName:O.target.value})),placeholder:"Enter product name"}),u.jsx(Ie,{label:"Brand *",value:T.brand||"",onChange:O=>b(X=>({...X,brand:O.target.value})),placeholder:"Enter brand"}),u.jsx(Ie,{label:"Model",value:T.model||"",onChange:O=>b(X=>({...X,model:O.target.value})),placeholder:"Enter model"}),u.jsx(Tt,{label:"Category *",value:T.category||"",onChange:O=>b(X=>({...X,category:O.target.value})),options:$d.filter(O=>O!=="All").map(O=>({value:O,label:O})),placeholder:"Select category"}),u.jsx(Ie,{label:"Stock Quantity",type:"number",value:((Z=T.stock)==null?void 0:Z.toString())||"0",onChange:O=>b(X=>({...X,stock:parseInt(O.target.value)||0})),placeholder:"0"}),u.jsx(Ie,{label:"Minimum Stock",type:"number",value:((le=T.minStock)==null?void 0:le.toString())||"0",onChange:O=>b(X=>({...X,minStock:parseInt(O.target.value)||0})),placeholder:"0"}),u.jsx(Ie,{label:"Unit Price",type:"number",step:"0.01",value:((R=T.unitPrice)==null?void 0:R.toString())||"0",onChange:O=>b(X=>({...X,unitPrice:parseFloat(O.target.value)||0})),placeholder:"0.00"}),u.jsx(Ie,{label:"Barcode",value:T.barcode||"",onChange:O=>b(X=>({...X,barcode:O.target.value})),placeholder:"Enter barcode"}),u.jsx(Ie,{label:"Supplier",value:T.supplier||"",onChange:O=>b(X=>({...X,supplier:O.target.value})),placeholder:"Enter supplier"}),u.jsx(Ie,{label:"Warranty Period",value:T.warrantyPeriod||"",onChange:O=>b(X=>({...X,warrantyPeriod:O.target.value})),placeholder:"e.g., 2 years"})]}),u.jsx(Tt,{label:"Status",value:T.status||"active",onChange:O=>b(X=>({...X,status:O.target.value})),options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"discontinued",label:"Discontinued"}]})]})}),u.jsx(il,{isOpen:l,onClose:()=>{c(!1),g(null)},onSave:Q,title:"Edit Product",size:"lg",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Ie,{label:"Product Name *",value:T.productName||"",onChange:O=>b(X=>({...X,productName:O.target.value})),placeholder:"Enter product name"}),u.jsx(Ie,{label:"Brand *",value:T.brand||"",onChange:O=>b(X=>({...X,brand:O.target.value})),placeholder:"Enter brand"}),u.jsx(Ie,{label:"Model",value:T.model||"",onChange:O=>b(X=>({...X,model:O.target.value})),placeholder:"Enter model"}),u.jsx(Tt,{label:"Category *",value:T.category||"",onChange:O=>b(X=>({...X,category:O.target.value})),options:$d.filter(O=>O!=="All").map(O=>({value:O,label:O})),placeholder:"Select category"}),u.jsx(Ie,{label:"Stock Quantity",type:"number",value:((G=T.stock)==null?void 0:G.toString())||"0",onChange:O=>b(X=>({...X,stock:parseInt(O.target.value)||0})),placeholder:"0"}),u.jsx(Ie,{label:"Minimum Stock",type:"number",value:((W=T.minStock)==null?void 0:W.toString())||"0",onChange:O=>b(X=>({...X,minStock:parseInt(O.target.value)||0})),placeholder:"0"}),u.jsx(Ie,{label:"Unit Price",type:"number",step:"0.01",value:((K=T.unitPrice)==null?void 0:K.toString())||"0",onChange:O=>b(X=>({...X,unitPrice:parseFloat(O.target.value)||0})),placeholder:"0.00"}),u.jsx(Ie,{label:"Barcode",value:T.barcode||"",onChange:O=>b(X=>({...X,barcode:O.target.value})),placeholder:"Enter barcode"}),u.jsx(Ie,{label:"Supplier",value:T.supplier||"",onChange:O=>b(X=>({...X,supplier:O.target.value})),placeholder:"Enter supplier"}),u.jsx(Ie,{label:"Warranty Period",value:T.warrantyPeriod||"",onChange:O=>b(X=>({...X,warrantyPeriod:O.target.value})),placeholder:"e.g., 2 years"})]}),u.jsx(Tt,{label:"Status",value:T.status||"active",onChange:O=>b(X=>({...X,status:O.target.value})),options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"discontinued",label:"Discontinued"}]})]})}),u.jsx(il,{isOpen:x,onClose:()=>m(!1),title:"Bulk Upload Products",size:"md",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsx(M1,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Upload a CSV file with your product data"})]}),u.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6",children:u.jsx("input",{type:"file",accept:".csv",className:"w-full",onChange:O=>{var X;console.log("File selected:",(X=O.target.files)==null?void 0:X[0])}})}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:u.jsx("p",{children:"CSV format: Product Name, Brand, Model, Category, Stock, Min Stock, Unit Price, Barcode, Supplier, Warranty Period"})})]})})]})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_e=(e,t)=>{const r=V.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},d)=>V.createElement("svg",{ref:d,...HN,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${WN(e)}`,o].join(" "),...c},[...t.map(([f,h])=>V.createElement(f,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=_e("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=_e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=_e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=_e("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=_e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=_e("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=_e("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=_e("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=_e("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=_e("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=_e("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=_e("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=_e("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=_e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=_e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eA=_e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=_e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=_e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=_e("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tA=_e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=_e("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=_e("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=_e("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=_e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nA=_e("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=_e("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aA=_e("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sA=_e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iA=_e("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oA=_e("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lA=_e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=_e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=_e("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cA=_e("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uA=_e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dA=_e("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=_e("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hA=_e("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mA=_e("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=_e("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=_e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=_e("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=_e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=_e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=_e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vA=_e("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yA=_e("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=_e("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=_e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=_e("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=_e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=_e("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=_e("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=_e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=_e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=_e("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bl=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function EA(){const[e,t]=V.useState("seed-admin"),[r,n]=V.useState("AdminPass123!"),[a,s]=V.useState(!1),{login:i,isLoading:o,error:l}=np(),c=async d=>{if(d.preventDefault(),!(!e.trim()||!r.trim())){console.log("Form submission - username:",e,"password:",r);try{await i({username:e.trim(),password:r})}catch(f){console.error("Login failed:",f)}}};return u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"max-w-md w-full space-y-8",children:[u.jsxs("div",{children:[u.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100",children:u.jsx(oA,{className:"h-6 w-6 text-blue-600"})}),u.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"X-EAR CRM'e Giri Yapn"}),u.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"itme cihaz hasta ynetim sistemi"})]}),u.jsxs("form",{className:"mt-8 space-y-6",onSubmit:c,children:[u.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"username",className:"sr-only",children:"Kullanc Ad"}),u.jsx(Ie,{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Kullanc ad",value:e,onChange:d=>t(d.target.value),disabled:o})]}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"password",className:"sr-only",children:"ifre"}),u.jsx(Ie,{id:"password",name:"password",type:a?"text":"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"ifre",value:r,onChange:d=>n(d.target.value),disabled:o}),u.jsx(Te,{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!a),disabled:o,variant:"default",children:a?u.jsx(rA,{className:"h-4 w-4 text-gray-400"}):u.jsx(Vw,{className:"h-4 w-4 text-gray-400"})})]})]}),l&&u.jsx("div",{className:"rounded-md bg-red-50 p-4",children:u.jsx("div",{className:"text-sm text-red-700",children:l})}),u.jsx("div",{children:u.jsx(Te,{type:"submit",disabled:o||!e.trim()||!r.trim(),className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:o?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Giri yaplyor..."]}):"Giri Yap"})})]})]})})}const _A=({children:e})=>{const{isAuthenticated:t,isLoading:r,initializeAuth:n}=np();return console.log("AuthProvider render - isAuthenticated:",t,"isLoading:",r),V.useEffect(()=>{n()},[]),r?(console.log("AuthProvider: Showing loading screen"),u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-600",children:"Ykleniyor..."})]})})):t?(console.log("AuthProvider: Rendering children (MainLayout)"),u.jsx(u.Fragment,{children:e})):(console.log("AuthProvider: Showing login form"),u.jsx(EA,{}))};class bA extends V.Component{constructor(r){super(r);at(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});at(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({error:r,errorInfo:n}),this.props.onError&&this.props.onError(r,n)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[u.jsx("div",{className:"flex justify-center mb-4",children:u.jsx(Uw,{className:"h-12 w-12 text-red-500"})}),u.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Bir Hata Olutu"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"zgnz, beklenmeyen bir hata olutu. Ltfen sayfay yenilemeyi deneyin."}),!1,u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[u.jsxs("button",{onClick:this.handleRetry,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[u.jsx(Ll,{className:"h-4 w-4 mr-2"}),"Tekrar Dene"]}),u.jsxs("button",{onClick:this.handleGoHome,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[u.jsx(aA,{className:"h-4 w-4 mr-2"}),"Ana Sayfa"]})]})]})}):this.props.children}}const TA={error:{icon:ip,bgColor:"bg-red-50",borderColor:"border-red-200",iconColor:"text-red-500",titleColor:"text-red-800",messageColor:"text-red-700",buttonColor:"bg-red-600 hover:bg-red-700 focus:ring-red-500"},warning:{icon:Uw,bgColor:"bg-yellow-50",borderColor:"border-yellow-200",iconColor:"text-yellow-500",titleColor:"text-yellow-800",messageColor:"text-yellow-700",buttonColor:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500"},info:{icon:sA,bgColor:"bg-blue-50",borderColor:"border-blue-200",iconColor:"text-blue-500",titleColor:"text-blue-800",messageColor:"text-blue-700",buttonColor:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"},success:{icon:H0,bgColor:"bg-green-50",borderColor:"border-green-200",iconColor:"text-green-500",titleColor:"text-green-800",messageColor:"text-green-700",buttonColor:"bg-green-600 hover:bg-green-700 focus:ring-green-500"}},K0=({title:e,message:t,type:r="error",dismissible:n=!1,onDismiss:a,onRetry:s,retryText:i="Tekrar Dene",className:o=""})=>{const l=TA[r],c=l.icon;return u.jsx("div",{className:`rounded-md border p-4 ${l.bgColor} ${l.borderColor} ${o}`,children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx(c,{className:`h-5 w-5 ${l.iconColor}`})}),u.jsxs("div",{className:"ml-3 flex-1",children:[e&&u.jsx("h3",{className:`text-sm font-medium ${l.titleColor}`,children:e}),u.jsx("div",{className:`${e?"mt-2":""} text-sm ${l.messageColor}`,children:u.jsx("p",{children:t})}),s&&u.jsx("div",{className:"mt-4",children:u.jsxs("button",{type:"button",onClick:s,className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white ${l.buttonColor} focus:outline-none focus:ring-2 focus:ring-offset-2`,children:[u.jsx(Ll,{className:"h-4 w-4 mr-2"}),i]})})]}),n&&a&&u.jsx("div",{className:"ml-auto pl-3",children:u.jsx("div",{className:"-mx-1.5 -my-1.5",children:u.jsxs("button",{type:"button",onClick:a,className:`inline-flex rounded-md p-1.5 ${l.iconColor} hover:bg-opacity-20 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-transparent`,children:[u.jsx("span",{className:"sr-only",children:"Kapat"}),u.jsx(Bl,{className:"h-5 w-5"})]})})})]})})},CA=({onRetry:e})=>u.jsx(K0,{title:"Balant Hatas",message:"Sunucuya balanrken bir hata olutu. nternet balantnz kontrol edin ve tekrar deneyin.",type:"error",onRetry:e}),NA=({resource:e="kaynak"})=>u.jsx(K0,{title:"Bulunamad",message:`Aradnz ${e} bulunamad. Sayfa kaldrlm veya tanm olabilir.`,type:"warning"}),AA=({position:e="top-right",...t})=>{const r={"top-right":"fixed top-4 right-4 z-50","top-left":"fixed top-4 left-4 z-50","bottom-right":"fixed bottom-4 right-4 z-50","bottom-left":"fixed bottom-4 left-4 z-50"};return u.jsx("div",{className:r[e],children:u.jsx(K0,{...t,className:`max-w-sm shadow-lg ${t.className||""}`,dismissible:!0})})};function Zw(e,t){return function(){return e.apply(t,arguments)}}const{toString:FA}=Object.prototype,{getPrototypeOf:up}=Object,{iterator:G0,toStringTag:ek}=Symbol,Y0=(e=>t=>{const r=FA.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),bn=e=>(e=e.toLowerCase(),t=>Y0(t)===e),X0=e=>t=>typeof t===e,{isArray:po}=Array,oo=X0("undefined");function mc(e){return e!==null&&!oo(e)&&e.constructor!==null&&!oo(e.constructor)&&Dr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const tk=bn("ArrayBuffer");function PA(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&tk(e.buffer),t}const RA=X0("string"),Dr=X0("function"),rk=X0("number"),pc=e=>e!==null&&typeof e=="object",DA=e=>e===!0||e===!1,ku=e=>{if(Y0(e)!=="object")return!1;const t=up(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(ek in e)&&!(G0 in e)},jA=e=>{if(!pc(e)||mc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},IA=bn("Date"),OA=bn("File"),MA=bn("Blob"),LA=bn("FileList"),BA=e=>pc(e)&&Dr(e.pipe),UA=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Dr(e.append)&&((t=Y0(e))==="formdata"||t==="object"&&Dr(e.toString)&&e.toString()==="[object FormData]"))},$A=bn("URLSearchParams"),[zA,VA,HA,WA]=["ReadableStream","Request","Response","Headers"].map(bn),KA=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),po(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(mc(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let o;for(n=0;n<i;n++)o=s[n],t.call(null,e[o],o,e)}}function nk(e,t){if(mc(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Es=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),ak=e=>!oo(e)&&e!==Es;function gh(){const{caseless:e,skipUndefined:t}=ak(this)&&this||{},r={},n=(a,s)=>{const i=e&&nk(r,s)||s;ku(r[i])&&ku(a)?r[i]=gh(r[i],a):ku(a)?r[i]=gh({},a):po(a)?r[i]=a.slice():(!t||!oo(a))&&(r[i]=a)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&xc(arguments[a],n);return r}const GA=(e,t,r,{allOwnKeys:n}={})=>(xc(t,(a,s)=>{r&&Dr(a)?e[s]=Zw(a,r):e[s]=a},{allOwnKeys:n}),e),YA=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),XA=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},qA=(e,t,r,n)=>{let a,s,i;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)i=a[s],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&up(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},QA=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},JA=e=>{if(!e)return null;if(po(e))return e;let t=e.length;if(!rk(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},ZA=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&up(Uint8Array)),e3=(e,t)=>{const n=(e&&e[G0]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},t3=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},r3=bn("HTMLFormElement"),n3=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),$1=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),a3=bn("RegExp"),sk=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};xc(r,(a,s)=>{let i;(i=t(a,s,e))!==!1&&(n[s]=i||a)}),Object.defineProperties(e,n)},s3=e=>{sk(e,(t,r)=>{if(Dr(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Dr(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},i3=(e,t)=>{const r={},n=a=>{a.forEach(s=>{r[s]=!0})};return po(e)?n(e):n(String(e).split(t)),r},o3=()=>{},l3=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function c3(e){return!!(e&&Dr(e.append)&&e[ek]==="FormData"&&e[G0])}const u3=e=>{const t=new Array(10),r=(n,a)=>{if(pc(n)){if(t.indexOf(n)>=0)return;if(mc(n))return n;if(!("toJSON"in n)){t[a]=n;const s=po(n)?[]:{};return xc(n,(i,o)=>{const l=r(i,a+1);!oo(l)&&(s[o]=l)}),t[a]=void 0,s}}return n};return r(e,0)},d3=bn("AsyncFunction"),f3=e=>e&&(pc(e)||Dr(e))&&Dr(e.then)&&Dr(e.catch),ik=((e,t)=>e?setImmediate:t?((r,n)=>(Es.addEventListener("message",({source:a,data:s})=>{a===Es&&s===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Es.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Dr(Es.postMessage)),h3=typeof queueMicrotask<"u"?queueMicrotask.bind(Es):typeof process<"u"&&process.nextTick||ik,m3=e=>e!=null&&Dr(e[G0]),ae={isArray:po,isArrayBuffer:tk,isBuffer:mc,isFormData:UA,isArrayBufferView:PA,isString:RA,isNumber:rk,isBoolean:DA,isObject:pc,isPlainObject:ku,isEmptyObject:jA,isReadableStream:zA,isRequest:VA,isResponse:HA,isHeaders:WA,isUndefined:oo,isDate:IA,isFile:OA,isBlob:MA,isRegExp:a3,isFunction:Dr,isStream:BA,isURLSearchParams:$A,isTypedArray:ZA,isFileList:LA,forEach:xc,merge:gh,extend:GA,trim:KA,stripBOM:YA,inherits:XA,toFlatObject:qA,kindOf:Y0,kindOfTest:bn,endsWith:QA,toArray:JA,forEachEntry:e3,matchAll:t3,isHTMLForm:r3,hasOwnProperty:$1,hasOwnProp:$1,reduceDescriptors:sk,freezeMethods:s3,toObjectSet:i3,toCamelCase:n3,noop:o3,toFiniteNumber:l3,findKey:nk,global:Es,isContextDefined:ak,isSpecCompliantForm:c3,toJSONObject:u3,isAsyncFn:d3,isThenable:f3,setImmediate:ik,asap:h3,isIterable:m3};function Le(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}ae.inherits(Le,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ae.toJSONObject(this.config),code:this.code,status:this.status}}});const ok=Le.prototype,lk={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{lk[e]={value:e}});Object.defineProperties(Le,lk);Object.defineProperty(ok,"isAxiosError",{value:!0});Le.from=(e,t,r,n,a,s)=>{const i=Object.create(ok);ae.toFlatObject(e,i,function(d){return d!==Error.prototype},c=>c!=="isAxiosError");const o=e&&e.message?e.message:"Error",l=t==null&&e?e.code:t;return Le.call(i,o,l,r,n,a),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",s&&Object.assign(i,s),i};const p3=null;function vh(e){return ae.isPlainObject(e)||ae.isArray(e)}function ck(e){return ae.endsWith(e,"[]")?e.slice(0,-2):e}function z1(e,t,r){return e?e.concat(t).map(function(a,s){return a=ck(a),!r&&s?"["+a+"]":a}).join(r?".":""):t}function x3(e){return ae.isArray(e)&&!e.some(vh)}const g3=ae.toFlatObject(ae,{},null,function(t){return/^is[A-Z]/.test(t)});function q0(e,t,r){if(!ae.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ae.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,v){return!ae.isUndefined(v[m])});const n=r.metaTokens,a=r.visitor||d,s=r.dots,i=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&ae.isSpecCompliantForm(t);if(!ae.isFunction(a))throw new TypeError("visitor must be a function");function c(x){if(x===null)return"";if(ae.isDate(x))return x.toISOString();if(ae.isBoolean(x))return x.toString();if(!l&&ae.isBlob(x))throw new Le("Blob is not supported. Use a Buffer instead.");return ae.isArrayBuffer(x)||ae.isTypedArray(x)?l&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,m,v){let g=x;if(x&&!v&&typeof x=="object"){if(ae.endsWith(m,"{}"))m=n?m:m.slice(0,-2),x=JSON.stringify(x);else if(ae.isArray(x)&&x3(x)||(ae.isFileList(x)||ae.endsWith(m,"[]"))&&(g=ae.toArray(x)))return m=ck(m),g.forEach(function(w,S){!(ae.isUndefined(w)||w===null)&&t.append(i===!0?z1([m],S,s):i===null?m:m+"[]",c(w))}),!1}return vh(x)?!0:(t.append(z1(v,m,s),c(x)),!1)}const f=[],h=Object.assign(g3,{defaultVisitor:d,convertValue:c,isVisitable:vh});function p(x,m){if(!ae.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+m.join("."));f.push(x),ae.forEach(x,function(g,y){(!(ae.isUndefined(g)||g===null)&&a.call(t,g,ae.isString(y)?y.trim():y,m,h))===!0&&p(g,m?m.concat(y):[y])}),f.pop()}}if(!ae.isObject(e))throw new TypeError("data must be an object");return p(e),t}function V1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function dp(e,t){this._pairs=[],e&&q0(e,this,t)}const uk=dp.prototype;uk.append=function(t,r){this._pairs.push([t,r])};uk.toString=function(t){const r=t?function(n){return t.call(this,n,V1)}:V1;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function v3(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function dk(e,t,r){if(!t)return e;const n=r&&r.encode||v3;ae.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(a?s=a(t,r):s=ae.isURLSearchParams(t)?t.toString():new dp(t,r).toString(n),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class y3{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ae.forEach(this.handlers,function(n){n!==null&&t(n)})}}const H1=y3,fk={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},w3=typeof URLSearchParams<"u"?URLSearchParams:dp,k3=typeof FormData<"u"?FormData:null,S3=typeof Blob<"u"?Blob:null,E3={isBrowser:!0,classes:{URLSearchParams:w3,FormData:k3,Blob:S3},protocols:["http","https","file","blob","url","data"]},fp=typeof window<"u"&&typeof document<"u",yh=typeof navigator=="object"&&navigator||void 0,_3=fp&&(!yh||["ReactNative","NativeScript","NS"].indexOf(yh.product)<0),b3=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),T3=fp&&window.location.href||"http://localhost",C3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:fp,hasStandardBrowserEnv:_3,hasStandardBrowserWebWorkerEnv:b3,navigator:yh,origin:T3},Symbol.toStringTag,{value:"Module"})),nr={...C3,...E3};function N3(e,t){return q0(e,new nr.classes.URLSearchParams,{visitor:function(r,n,a,s){return nr.isNode&&ae.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function A3(e){return ae.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function F3(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}function hk(e){function t(r,n,a,s){let i=r[s++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),l=s>=r.length;return i=!i&&ae.isArray(a)?a.length:i,l?(ae.hasOwnProp(a,i)?a[i]=[a[i],n]:a[i]=n,!o):((!a[i]||!ae.isObject(a[i]))&&(a[i]=[]),t(r,n,a[i],s)&&ae.isArray(a[i])&&(a[i]=F3(a[i])),!o)}if(ae.isFormData(e)&&ae.isFunction(e.entries)){const r={};return ae.forEachEntry(e,(n,a)=>{t(A3(n),a,r,0)}),r}return null}function P3(e,t,r){if(ae.isString(e))try{return(t||JSON.parse)(e),ae.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const hp={transitional:fk,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,s=ae.isObject(t);if(s&&ae.isHTMLForm(t)&&(t=new FormData(t)),ae.isFormData(t))return a?JSON.stringify(hk(t)):t;if(ae.isArrayBuffer(t)||ae.isBuffer(t)||ae.isStream(t)||ae.isFile(t)||ae.isBlob(t)||ae.isReadableStream(t))return t;if(ae.isArrayBufferView(t))return t.buffer;if(ae.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return N3(t,this.formSerializer).toString();if((o=ae.isFileList(t))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return q0(o?{"files[]":t}:t,l&&new l,this.formSerializer)}}return s||a?(r.setContentType("application/json",!1),P3(t)):t}],transformResponse:[function(t){const r=this.transitional||hp.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(ae.isResponse(t)||ae.isReadableStream(t))return t;if(t&&ae.isString(t)&&(n&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?Le.from(o,Le.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:nr.classes.FormData,Blob:nr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ae.forEach(["delete","get","head","post","put","patch"],e=>{hp.headers[e]={}});const mp=hp,R3=ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),D3=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),n=i.substring(a+1).trim(),!(!r||t[r]&&R3[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},W1=Symbol("internals");function Oo(e){return e&&String(e).trim().toLowerCase()}function Su(e){return e===!1||e==null?e:ae.isArray(e)?e.map(Su):String(e)}function j3(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const I3=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function zd(e,t,r,n,a){if(ae.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!ae.isString(t)){if(ae.isString(n))return t.indexOf(n)!==-1;if(ae.isRegExp(n))return n.test(t)}}function O3(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function M3(e,t){const r=ae.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,s,i){return this[n].call(this,t,a,s,i)},configurable:!0})})}let Q0=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function s(o,l,c){const d=Oo(l);if(!d)throw new Error("header name must be a non-empty string");const f=ae.findKey(a,d);(!f||a[f]===void 0||c===!0||c===void 0&&a[f]!==!1)&&(a[f||l]=Su(o))}const i=(o,l)=>ae.forEach(o,(c,d)=>s(c,d,l));if(ae.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(ae.isString(t)&&(t=t.trim())&&!I3(t))i(D3(t),r);else if(ae.isObject(t)&&ae.isIterable(t)){let o={},l,c;for(const d of t){if(!ae.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[c=d[0]]=(l=o[c])?ae.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}i(o,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=Oo(t),t){const n=ae.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return j3(a);if(ae.isFunction(r))return r.call(this,a,n);if(ae.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Oo(t),t){const n=ae.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||zd(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function s(i){if(i=Oo(i),i){const o=ae.findKey(n,i);o&&(!r||zd(n,n[o],o,r))&&(delete n[o],a=!0)}}return ae.isArray(t)?t.forEach(s):s(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const s=r[n];(!t||zd(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const r=this,n={};return ae.forEach(this,(a,s)=>{const i=ae.findKey(n,s);if(i){r[i]=Su(a),delete r[s];return}const o=t?O3(s):String(s).trim();o!==s&&delete r[s],r[o]=Su(a),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ae.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&ae.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[W1]=this[W1]={accessors:{}}).accessors,a=this.prototype;function s(i){const o=Oo(i);n[o]||(M3(a,i),n[o]=!0)}return ae.isArray(t)?t.forEach(s):s(t),this}};Q0.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ae.reduceDescriptors(Q0.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});ae.freezeMethods(Q0);const Sn=Q0;function Vd(e,t){const r=this||mp,n=t||r,a=Sn.from(n.headers);let s=n.data;return ae.forEach(e,function(o){s=o.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function mk(e){return!!(e&&e.__CANCEL__)}function xo(e,t,r){Le.call(this,e??"canceled",Le.ERR_CANCELED,t,r),this.name="CanceledError"}ae.inherits(xo,Le,{__CANCEL__:!0});function pk(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Le("Request failed with status code "+r.status,[Le.ERR_BAD_REQUEST,Le.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function L3(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function B3(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,s=0,i;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),d=n[s];i||(i=c),r[a]=l,n[a]=c;let f=s,h=0;for(;f!==a;)h+=r[f++],f=f%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),c-i<t)return;const p=d&&c-d;return p?Math.round(h*1e3/p):void 0}}function U3(e,t){let r=0,n=1e3/t,a,s;const i=(c,d=Date.now())=>{r=d,a=null,s&&(clearTimeout(s),s=null),e(...c)};return[(...c)=>{const d=Date.now(),f=d-r;f>=n?i(c,d):(a=c,s||(s=setTimeout(()=>{s=null,i(a)},n-f)))},()=>a&&i(a)]}const a0=(e,t,r=3)=>{let n=0;const a=B3(50,250);return U3(s=>{const i=s.loaded,o=s.lengthComputable?s.total:void 0,l=i-n,c=a(l),d=i<=o;n=i;const f={loaded:i,total:o,progress:o?i/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&d?(o-i)/c:void 0,event:s,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(f)},r)},K1=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},G1=e=>(...t)=>ae.asap(()=>e(...t)),$3=nr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,nr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(nr.origin),nr.navigator&&/(msie|trident)/i.test(nr.navigator.userAgent)):()=>!0,z3=nr.hasStandardBrowserEnv?{write(e,t,r,n,a,s){const i=[e+"="+encodeURIComponent(t)];ae.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),ae.isString(n)&&i.push("path="+n),ae.isString(a)&&i.push("domain="+a),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function V3(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function H3(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function xk(e,t,r){let n=!V3(t);return e&&(n||r==!1)?H3(e,t):t}const Y1=e=>e instanceof Sn?{...e}:e;function qs(e,t){t=t||{};const r={};function n(c,d,f,h){return ae.isPlainObject(c)&&ae.isPlainObject(d)?ae.merge.call({caseless:h},c,d):ae.isPlainObject(d)?ae.merge({},d):ae.isArray(d)?d.slice():d}function a(c,d,f,h){if(ae.isUndefined(d)){if(!ae.isUndefined(c))return n(void 0,c,f,h)}else return n(c,d,f,h)}function s(c,d){if(!ae.isUndefined(d))return n(void 0,d)}function i(c,d){if(ae.isUndefined(d)){if(!ae.isUndefined(c))return n(void 0,c)}else return n(void 0,d)}function o(c,d,f){if(f in t)return n(c,d);if(f in e)return n(void 0,c)}const l={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(c,d,f)=>a(Y1(c),Y1(d),f,!0)};return ae.forEach(Object.keys({...e,...t}),function(d){const f=l[d]||a,h=f(e[d],t[d],d);ae.isUndefined(h)&&f!==o||(r[d]=h)}),r}const gk=e=>{const t=qs({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:i,auth:o}=t;if(t.headers=i=Sn.from(i),t.url=dk(xk(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),ae.isFormData(r)){if(nr.hasStandardBrowserEnv||nr.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(ae.isFunction(r.getHeaders)){const l=r.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([d,f])=>{c.includes(d.toLowerCase())&&i.set(d,f)})}}if(nr.hasStandardBrowserEnv&&(n&&ae.isFunction(n)&&(n=n(t)),n||n!==!1&&$3(t.url))){const l=a&&s&&z3.read(s);l&&i.set(a,l)}return t},W3=typeof XMLHttpRequest<"u",K3=W3&&function(e){return new Promise(function(r,n){const a=gk(e);let s=a.data;const i=Sn.from(a.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=a,d,f,h,p,x;function m(){p&&p(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(a.method.toUpperCase(),a.url,!0),v.timeout=a.timeout;function g(){if(!v)return;const w=Sn.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),A={data:!o||o==="text"||o==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:w,config:e,request:v};pk(function(b){r(b),m()},function(b){n(b),m()},A),v=null}"onloadend"in v?v.onloadend=g:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(g)},v.onabort=function(){v&&(n(new Le("Request aborted",Le.ECONNABORTED,e,v)),v=null)},v.onerror=function(S){const A=S&&S.message?S.message:"Network Error",T=new Le(A,Le.ERR_NETWORK,e,v);T.event=S||null,n(T),v=null},v.ontimeout=function(){let S=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const A=a.transitional||fk;a.timeoutErrorMessage&&(S=a.timeoutErrorMessage),n(new Le(S,A.clarifyTimeoutError?Le.ETIMEDOUT:Le.ECONNABORTED,e,v)),v=null},s===void 0&&i.setContentType(null),"setRequestHeader"in v&&ae.forEach(i.toJSON(),function(S,A){v.setRequestHeader(A,S)}),ae.isUndefined(a.withCredentials)||(v.withCredentials=!!a.withCredentials),o&&o!=="json"&&(v.responseType=a.responseType),c&&([h,x]=a0(c,!0),v.addEventListener("progress",h)),l&&v.upload&&([f,p]=a0(l),v.upload.addEventListener("progress",f),v.upload.addEventListener("loadend",p)),(a.cancelToken||a.signal)&&(d=w=>{v&&(n(!w||w.type?new xo(null,e,v):w),v.abort(),v=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=L3(a.url);if(y&&nr.protocols.indexOf(y)===-1){n(new Le("Unsupported protocol "+y+":",Le.ERR_BAD_REQUEST,e));return}v.send(s||null)})},G3=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const s=function(c){if(!a){a=!0,o();const d=c instanceof Error?c:this.reason;n.abort(d instanceof Le?d:new xo(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,s(new Le(`timeout ${t} of ms exceeded`,Le.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:l}=n;return l.unsubscribe=()=>ae.asap(o),l}},Y3=G3,X3=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},q3=async function*(e,t){for await(const r of Q3(e))yield*X3(r,t)},Q3=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},X1=(e,t,r,n)=>{const a=q3(e,t);let s=0,i,o=l=>{i||(i=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:c,value:d}=await a.next();if(c){o(),l.close();return}let f=d.byteLength;if(r){let h=s+=f;r(h)}l.enqueue(new Uint8Array(d))}catch(c){throw o(c),c}},cancel(l){return o(l),a.return()}},{highWaterMark:2})},q1=64*1024,{isFunction:Yc}=ae,J3=(({Request:e,Response:t})=>({Request:e,Response:t}))(ae.global),{ReadableStream:Q1,TextEncoder:J1}=ae.global,Z1=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Z3=e=>{e=ae.merge.call({skipUndefined:!0},J3,e);const{fetch:t,Request:r,Response:n}=e,a=t?Yc(t):typeof fetch=="function",s=Yc(r),i=Yc(n);if(!a)return!1;const o=a&&Yc(Q1),l=a&&(typeof J1=="function"?(x=>m=>x.encode(m))(new J1):async x=>new Uint8Array(await new r(x).arrayBuffer())),c=s&&o&&Z1(()=>{let x=!1;const m=new r(nr.origin,{body:new Q1,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!m}),d=i&&o&&Z1(()=>ae.isReadableStream(new n("").body)),f={stream:d&&(x=>x.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!f[x]&&(f[x]=(m,v)=>{let g=m&&m[x];if(g)return g.call(m);throw new Le(`Response type '${x}' is not supported`,Le.ERR_NOT_SUPPORT,v)})});const h=async x=>{if(x==null)return 0;if(ae.isBlob(x))return x.size;if(ae.isSpecCompliantForm(x))return(await new r(nr.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(ae.isArrayBufferView(x)||ae.isArrayBuffer(x))return x.byteLength;if(ae.isURLSearchParams(x)&&(x=x+""),ae.isString(x))return(await l(x)).byteLength},p=async(x,m)=>{const v=ae.toFiniteNumber(x.getContentLength());return v??h(m)};return async x=>{let{url:m,method:v,data:g,signal:y,cancelToken:w,timeout:S,onDownloadProgress:A,onUploadProgress:T,responseType:b,headers:k,withCredentials:E="same-origin",fetchOptions:_}=gk(x),C=t||fetch;b=b?(b+"").toLowerCase():"text";let F=Y3([y,w&&w.toAbortSignal()],S),D=null;const M=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let B;try{if(T&&c&&v!=="get"&&v!=="head"&&(B=await p(k,g))!==0){let le=new r(m,{method:"POST",body:g,duplex:"half"}),R;if(ae.isFormData(g)&&(R=le.headers.get("content-type"))&&k.setContentType(R),le.body){const[G,W]=K1(B,a0(G1(T)));g=X1(le.body,q1,G,W)}}ae.isString(E)||(E=E?"include":"omit");const q=s&&"credentials"in r.prototype,Q={..._,signal:F,method:v.toUpperCase(),headers:k.normalize().toJSON(),body:g,duplex:"half",credentials:q?E:void 0};D=s&&new r(m,Q);let J=await(s?C(D,_):C(m,Q));const P=d&&(b==="stream"||b==="response");if(d&&(A||P&&M)){const le={};["status","statusText","headers"].forEach(K=>{le[K]=J[K]});const R=ae.toFiniteNumber(J.headers.get("content-length")),[G,W]=A&&K1(R,a0(G1(A),!0))||[];J=new n(X1(J.body,q1,G,()=>{W&&W(),M&&M()}),le)}b=b||"text";let Z=await f[ae.findKey(f,b)||"text"](J,x);return!P&&M&&M(),await new Promise((le,R)=>{pk(le,R,{data:Z,headers:Sn.from(J.headers),status:J.status,statusText:J.statusText,config:x,request:D})})}catch(q){throw M&&M(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new Le("Network Error",Le.ERR_NETWORK,x,D),{cause:q.cause||q}):Le.from(q,q&&q.code,x,D)}}},eF=new Map,vk=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:a}=t,s=[n,a,r];let i=s.length,o=i,l,c,d=eF;for(;o--;)l=s[o],c=d.get(l),c===void 0&&d.set(l,c=o?new Map:Z3(t)),d=c;return c};vk();const wh={http:p3,xhr:K3,fetch:{get:vk}};ae.forEach(wh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const eg=e=>`- ${e}`,tF=e=>ae.isFunction(e)||e===null||e===!1,yk={getAdapter:(e,t)=>{e=ae.isArray(e)?e:[e];const{length:r}=e;let n,a;const s={};for(let i=0;i<r;i++){n=e[i];let o;if(a=n,!tF(n)&&(a=wh[(o=String(n)).toLowerCase()],a===void 0))throw new Le(`Unknown adapter '${o}'`);if(a&&(ae.isFunction(a)||(a=a.get(t))))break;s[o||"#"+i]=a}if(!a){const i=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(eg).join(`
`):" "+eg(i[0]):"as no adapter specified";throw new Le("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a},adapters:wh};function Hd(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new xo(null,e)}function tg(e){return Hd(e),e.headers=Sn.from(e.headers),e.data=Vd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),yk.getAdapter(e.adapter||mp.adapter,e)(e).then(function(n){return Hd(e),n.data=Vd.call(e,e.transformResponse,n),n.headers=Sn.from(n.headers),n},function(n){return mk(n)||(Hd(e),n&&n.response&&(n.response.data=Vd.call(e,e.transformResponse,n.response),n.response.headers=Sn.from(n.response.headers))),Promise.reject(n)})}const wk="1.12.2",J0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{J0[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const rg={};J0.transitional=function(t,r,n){function a(s,i){return"[Axios v"+wk+"] Transitional option '"+s+"'"+i+(n?". "+n:"")}return(s,i,o)=>{if(t===!1)throw new Le(a(i," has been removed"+(r?" in "+r:"")),Le.ERR_DEPRECATED);return r&&!rg[i]&&(rg[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,i,o):!0}};J0.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function rF(e,t,r){if(typeof e!="object")throw new Le("options must be an object",Le.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],i=t[s];if(i){const o=e[s],l=o===void 0||i(o,s,e);if(l!==!0)throw new Le("option "+s+" must be "+l,Le.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Le("Unknown option "+s,Le.ERR_BAD_OPTION)}}const Eu={assertOptions:rF,validators:J0},Nn=Eu.validators;let s0=class{constructor(t){this.defaults=t||{},this.interceptors={request:new H1,response:new H1}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=qs(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:s}=r;n!==void 0&&Eu.assertOptions(n,{silentJSONParsing:Nn.transitional(Nn.boolean),forcedJSONParsing:Nn.transitional(Nn.boolean),clarifyTimeoutError:Nn.transitional(Nn.boolean)},!1),a!=null&&(ae.isFunction(a)?r.paramsSerializer={serialize:a}:Eu.assertOptions(a,{encode:Nn.function,serialize:Nn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Eu.assertOptions(r,{baseUrl:Nn.spelling("baseURL"),withXsrfToken:Nn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=s&&ae.merge(s.common,s[r.method]);s&&ae.forEach(["delete","get","head","post","put","patch","common"],x=>{delete s[x]}),r.headers=Sn.concat(i,s);const o=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(l=l&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let d,f=0,h;if(!l){const x=[tg.bind(this),void 0];for(x.unshift(...o),x.push(...c),h=x.length,d=Promise.resolve(r);f<h;)d=d.then(x[f++],x[f++]);return d}h=o.length;let p=r;for(;f<h;){const x=o[f++],m=o[f++];try{p=x(p)}catch(v){m.call(this,v);break}}try{d=tg.call(this,p)}catch(x){return Promise.reject(x)}for(f=0,h=c.length;f<h;)d=d.then(c[f++],c[f++]);return d}getUri(t){t=qs(this.defaults,t);const r=xk(t.baseURL,t.url,t.allowAbsoluteUrls);return dk(r,t.params,t.paramsSerializer)}};ae.forEach(["delete","get","head","options"],function(t){s0.prototype[t]=function(r,n){return this.request(qs(n||{},{method:t,url:r,data:(n||{}).data}))}});ae.forEach(["post","put","patch"],function(t){function r(n){return function(s,i,o){return this.request(qs(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}s0.prototype[t]=r(),s0.prototype[t+"Form"]=r(!0)});const _u=s0;let nF=class kk{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const i=new Promise(o=>{n.subscribe(o),s=o}).then(a);return i.cancel=function(){n.unsubscribe(s)},i},t(function(s,i,o){n.reason||(n.reason=new xo(s,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new kk(function(a){t=a}),cancel:t}}};const aF=nF;function sF(e){return function(r){return e.apply(null,r)}}function iF(e){return ae.isObject(e)&&e.isAxiosError===!0}const kh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(kh).forEach(([e,t])=>{kh[t]=e});const oF=kh;function Sk(e){const t=new _u(e),r=Zw(_u.prototype.request,t);return ae.extend(r,_u.prototype,t,{allOwnKeys:!0}),ae.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return Sk(qs(e,a))},r}const Nt=Sk(mp);Nt.Axios=_u;Nt.CanceledError=xo;Nt.CancelToken=aF;Nt.isCancel=mk;Nt.VERSION=wk;Nt.toFormData=q0;Nt.AxiosError=Le;Nt.Cancel=Nt.CanceledError;Nt.all=function(t){return Promise.all(t)};Nt.spread=sF;Nt.isAxiosError=iF;Nt.mergeConfig=qs;Nt.AxiosHeaders=Sn;Nt.formToJSON=e=>hk(ae.isHTMLForm(e)?new FormData(e):e);Nt.getAdapter=yk.getAdapter;Nt.HttpStatusCode=oF;Nt.default=Nt;const zt=Nt,{Axios:a9,AxiosError:pp,CanceledError:s9,isCancel:i9,CancelToken:o9,VERSION:l9,all:c9,Cancel:u9,isAxiosError:d9,spread:f9,toFormData:h9,AxiosHeaders:m9,HttpStatusCode:p9,formToJSON:x9,getAdapter:g9,mergeConfig:v9}=zt,lF=e=>{var t,r;return e instanceof pp?((r=(t=e.response)==null?void 0:t.data)==null?void 0:r.message)||e.message||"API hatas olutu":e instanceof Error?e.message:typeof e=="string"?e:"Bilinmeyen bir hata olutu"},cF=e=>e instanceof pp?!e.response||e.code==="NETWORK_ERROR":!1,uF=e=>{var t;return e instanceof pp?((t=e.response)==null?void 0:t.status)===401:!1},Ek=V.createContext(void 0),dF=()=>{const e=V.useContext(Ek);if(!e)throw new Error("useGlobalError must be used within a GlobalErrorProvider");return e},fF=({children:e})=>{const[t,r]=V.useState([]),n=()=>`error-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,a=V.useCallback((h,p={})=>{const x=n(),m={id:x,message:h,timestamp:new Date,type:"error",duration:5e3,...p};return r(v=>[...v,m]),m.duration&&m.duration>0&&!m.persistent&&setTimeout(()=>{c(x)},m.duration),x},[]),s=V.useCallback((h,p={})=>{let x=lF(h),m=p.title;cF(h)?(m=m||"Balant Hatas",x="Sunucuya balanrken bir hata olutu. nternet balantnz kontrol edin."):uF(h)&&(m=m||"Yetkilendirme Hatas",x="Bu ilem iin yetkiniz bulunmuyor. Ltfen tekrar giri yapn."),a(x,{...p,type:"error",title:m})},[a]),i=V.useCallback((h,p={})=>{a(h,{...p,type:"success",duration:p.duration||3e3})},[a]),o=V.useCallback((h,p={})=>{a(h,{...p,type:"warning"})},[a]),l=V.useCallback((h,p={})=>{a(h,{...p,type:"info"})},[a]),c=V.useCallback(h=>{r(p=>p.filter(x=>x.id!==h))},[]),d=V.useCallback(()=>{r([])},[]),f={showError:s,showSuccess:i,showWarning:o,showInfo:l,clearError:c,clearAllErrors:d};return u.jsxs(Ek.Provider,{value:f,children:[e,u.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(h=>u.jsx(AA,{title:h.title,message:h.message,type:h.type,dismissible:!0,onDismiss:()=>c(h.id),onRetry:h.onRetry,retryText:h.retryText,position:"top-right",className:"animate-in slide-in-from-right-full duration-300"},h.id))})]})},hF=function(){return null},mF=({children:e})=>{const{user:t}=np();console.log("MainLayout render - user:",t);const r=mo(),[n,a]=V.useState(()=>{const g=localStorage.getItem("sidebarCollapsed");return g?JSON.parse(g):!1}),[s,i]=V.useState(()=>{const g=localStorage.getItem("darkMode");return g?JSON.parse(g):!1}),[o,l]=V.useState(!1),[c,d]=V.useState({});V.useEffect(()=>{localStorage.setItem("sidebarCollapsed",JSON.stringify(n))},[n]),V.useEffect(()=>{localStorage.setItem("darkMode",JSON.stringify(s)),s?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[s]);const f=()=>{a(!n)},h=()=>{i(!s)},p=()=>{l(!o)},x=g=>{d(y=>({...y,[g]:!y[g]}))},m=[{key:"dashboard",label:"Dashboard",icon:YN,href:"/"},{key:"patients",label:"Hastalar",icon:Us,href:"/patients"},{key:"appointments",label:"Randevular",icon:hc,href:"/appointments"},{key:"inventory",label:"Envanter",icon:fA,href:"/inventory"},{key:"suppliers",label:"Tedarikiler",icon:QN,href:"/suppliers"},{key:"invoices",label:"Fatura",icon:lp,submenu:[{label:"Satlar",href:"/invoices"},{label:"Allar",href:"/invoices/purchases"},{label:"Yeni Fatura",href:"/invoices/new"},{label:"deme Takibi",href:"/invoices/payments"}]},{key:"cashflow",label:"Kasa",icon:Jw,href:"/cashflow"},{key:"campaigns",label:"Kampanyalar",icon:cA,href:"/campaigns"},{key:"sgk",label:"SGK",icon:JN,submenu:[{label:"SGK Raporlar",href:"/sgk"},{label:"Hasta Eletirme",href:"/sgk/matching"},{label:"Belge Ykleme",href:"/sgk/upload"}]},{key:"reports",label:"Raporlar",icon:gA,submenu:[{label:"Genel Raporlar",href:"/reports"},{label:"Sat Raporlar",href:"/reports/sales"},{label:"Hasta Raporlar",href:"/reports/patients"}]},{key:"automation",label:"Otomasyon",icon:qN,href:"/automation"},{key:"settings",label:"Ayarlar",icon:xh,href:"/settings"}],v=g=>{const y=g.submenu&&g.submenu.length>0,w=c[g.key];return u.jsxs("li",{style:{marginBottom:"0.25rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0.75rem 1rem",color:s?"#d1d5db":"#374151",textDecoration:"none",borderRadius:"0.375rem",cursor:"pointer",transition:"all 0.2s ease",backgroundColor:"transparent"},onClick:()=>{y?x(g.key):r({to:g.href})},onMouseEnter:S=>{S.currentTarget.style.backgroundColor=s?"#374151":"#f3f4f6",S.currentTarget.style.color=s?"#ffffff":"#1f2937"},onMouseLeave:S=>{S.currentTarget.style.backgroundColor="transparent",S.currentTarget.style.color=s?"#d1d5db":"#374151"},children:[u.jsx("span",{style:{marginRight:n?"0":"0.75rem"},children:u.jsx(g.icon,{size:20})}),!n&&u.jsxs(u.Fragment,{children:[u.jsx("span",{style:{flex:1},children:g.label}),y&&u.jsx("span",{style:{transform:w?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:u.jsx(eA,{size:16})})]})]}),y&&!n&&w&&u.jsx("ul",{style:{listStyle:"none",padding:0,margin:"0.25rem 0 0 2rem",borderLeft:`2px solid ${s?"#374151":"#e5e7eb"}`},children:g.submenu.map((S,A)=>u.jsx("li",{children:u.jsx(rp,{to:S.href,style:{display:"block",padding:"0.5rem 1rem",color:s?"#9ca3af":"#6b7280",textDecoration:"none",fontSize:"0.875rem",borderRadius:"0.375rem",transition:"all 0.2s ease"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor=s?"#374151":"#f3f4f6",T.currentTarget.style.color=s?"#ffffff":"#1f2937"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="transparent",T.currentTarget.style.color=s?"#9ca3af":"#6b7280"},children:S.label})},A))})]},g.key)};return V.useEffect(()=>(window.toggleSidebar=f,()=>{delete window.toggleSidebar}),[]),u.jsxs("div",{style:{display:"flex",minHeight:"100vh",backgroundColor:s?"#111827":"#ffffff",color:s?"#ffffff":"#000000"},children:[u.jsxs("nav",{style:{width:n?"80px":"240px",backgroundColor:s?"#1f2937":"#ffffff",borderRight:`1px solid ${s?"#374151":"#e5e7eb"}`,transition:"width 0.3s ease",position:"fixed",height:"100vh",overflowY:"auto",zIndex:1e3},children:[u.jsxs("div",{style:{padding:"1rem",borderBottom:`1px solid ${s?"#374151":"#e5e7eb"}`,display:"flex",alignItems:"center",justifyContent:n?"center":"space-between"},children:[u.jsx(Te,{onClick:f,style:{background:"none",border:"none",cursor:"pointer",padding:"0.5rem",borderRadius:"0.375rem",color:s?"#ffffff":"#1f2937",display:"flex",alignItems:"center",justifyContent:"center"},variant:"ghost",children:u.jsx(uA,{size:20})}),!n&&u.jsx("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:"bold",color:s?"#ffffff":"#1f2937"},children:"X-EAR CRM"})]}),u.jsx("ul",{style:{listStyle:"none",padding:"1rem 0.5rem",margin:0},children:m.map(v)})]}),u.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",marginLeft:n?"80px":"240px",transition:"margin-left 0.3s ease"},children:[u.jsx("header",{style:{backgroundColor:s?"#1f2937":"#ffffff",padding:"1rem 2rem",borderBottom:`1px solid ${s?"#374151":"#e5e7eb"}`,boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",position:"sticky",top:0,zIndex:999},children:u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("h1",{style:{margin:0,fontSize:"1.5rem",color:s?"#ffffff":"#1f2937",fontWeight:"600"},children:"Dashboard"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[u.jsx(Te,{onClick:h,style:{background:"none",border:"none",cursor:"pointer",padding:"0.5rem",borderRadius:"0.375rem",color:s?"#ffffff":"#1f2937",display:"flex",alignItems:"center",justifyContent:"center"},title:s?"Ak Tema":"Koyu Tema",variant:"ghost",children:s?u.jsx(yA,{size:20}):u.jsx(dA,{size:20})}),u.jsxs(Te,{style:{position:"relative",background:"none",border:"none",cursor:"pointer",padding:"0.5rem",borderRadius:"0.375rem",color:s?"#ffffff":"#1f2937",display:"flex",alignItems:"center",justifyContent:"center"},title:"Bildirimler",variant:"ghost",children:[u.jsx(XN,{size:20}),u.jsx("span",{style:{position:"absolute",top:"0.25rem",right:"0.25rem",width:"8px",height:"8px",backgroundColor:"#ef4444",borderRadius:"50%"}})]}),u.jsxs("div",{style:{position:"relative"},children:[u.jsxs(Te,{onClick:p,style:{display:"flex",alignItems:"center",gap:"0.5rem",background:"none",border:"none",cursor:"pointer",padding:"0.5rem",borderRadius:"0.375rem",backgroundColor:s?"#374151":"#f3f4f6"},variant:"ghost",children:[u.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"#3b82f6",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"0.875rem"},children:u.jsx(io,{size:16})}),u.jsxs("div",{style:{textAlign:"left",color:s?"#ffffff":"#1f2937"},children:[u.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500"},children:(t==null?void 0:t.name)||"User"}),u.jsx("div",{style:{fontSize:"0.75rem",opacity:.7},children:(t==null?void 0:t.role)||"Guest"})]}),u.jsx(ZN,{size:12,style:{color:s?"#ffffff":"#1f2937"}})]}),o&&u.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",backgroundColor:s?"#1f2937":"#ffffff",border:`1px solid ${s?"#374151":"#e5e7eb"}`,borderRadius:"0.5rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",minWidth:"200px",zIndex:1e3},children:u.jsxs("div",{style:{padding:"0.5rem 0"},children:[u.jsxs("a",{href:"/profile",style:{display:"flex",alignItems:"center",padding:"0.75rem 1rem",color:s?"#ffffff":"#1f2937",textDecoration:"none",fontSize:"0.875rem",borderBottom:`1px solid ${s?"#374151":"#e5e7eb"}`,backgroundColor:"transparent",transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor=s?"#374151":"#f3f4f6"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="transparent"},children:[u.jsx(io,{size:16,style:{marginRight:"0.5rem"}}),u.jsx("span",{children:"Profil"})]}),u.jsxs("a",{href:"/settings",style:{display:"flex",alignItems:"center",padding:"0.75rem 1rem",color:s?"#ffffff":"#1f2937",textDecoration:"none",fontSize:"0.875rem",borderBottom:`1px solid ${s?"#374151":"#e5e7eb"}`,backgroundColor:"transparent",transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor=s?"#374151":"#f3f4f6"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="transparent"},children:[u.jsx(xh,{size:16,style:{marginRight:"0.5rem"}}),u.jsx("span",{children:"Ayarlar"})]}),u.jsxs(Te,{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/login"},style:{display:"flex",alignItems:"center",width:"100%",padding:"0.75rem 1rem",color:"#ef4444",background:"none",border:"none",textAlign:"left",fontSize:"0.875rem",cursor:"pointer",backgroundColor:"transparent",transition:"background-color 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor=s?"#374151":"#f3f4f6"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="transparent"},variant:"ghost",children:[u.jsx(lA,{size:16,style:{marginRight:"0.5rem"}}),u.jsx("span",{children:"k Yap"})]})]})})]})]})]})}),u.jsx("main",{style:{flex:1,padding:"2rem",backgroundColor:s?"#111827":"#f9fafb",minHeight:"calc(100vh - 80px)"},children:e})]})]})},ri=HC({component:()=>u.jsxs(u.Fragment,{children:[u.jsx(mF,{children:u.jsx(V0,{})}),u.jsx(hF,{})]}),notFoundComponent:()=>u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-gray-200 max-w-md w-full text-center",children:[u.jsx("div",{className:"text-gray-400 mb-4",children:u.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.47-.881-6.08-2.33"})})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Sayfa Bulunamad"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Aradnz sayfa mevcut deil veya tanm olabilir."}),u.jsx("a",{href:"/",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Ana Sayfaya Dn"})]})})});function fa(e){return Array.isArray?Array.isArray(e):Tk(e)==="[object Array]"}const pF=1/0;function xF(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-pF?"-0":t}function gF(e){return e==null?"":xF(e)}function Mn(e){return typeof e=="string"}function _k(e){return typeof e=="number"}function vF(e){return e===!0||e===!1||yF(e)&&Tk(e)=="[object Boolean]"}function bk(e){return typeof e=="object"}function yF(e){return bk(e)&&e!==null}function Ir(e){return e!=null}function Wd(e){return!e.trim().length}function Tk(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const wF="Incorrect 'index' type",kF=e=>`Invalid value for key ${e}`,SF=e=>`Pattern length exceeds max of ${e}.`,EF=e=>`Missing ${e} property in key`,_F=e=>`Property 'weight' in key '${e}' must be a positive integer`,ng=Object.prototype.hasOwnProperty;let bF=class{constructor(t){this._keys=[],this._keyMap={};let r=0;t.forEach(n=>{let a=Ck(n);this._keys.push(a),this._keyMap[a.id]=a,r+=a.weight}),this._keys.forEach(n=>{n.weight/=r})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function Ck(e){let t=null,r=null,n=null,a=1,s=null;if(Mn(e)||fa(e))n=e,t=ag(e),r=Sh(e);else{if(!ng.call(e,"name"))throw new Error(EF("name"));const i=e.name;if(n=i,ng.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(_F(i));t=ag(i),r=Sh(i),s=e.getFn}return{path:t,id:r,weight:a,src:n,getFn:s}}function ag(e){return fa(e)?e:e.split(".")}function Sh(e){return fa(e)?e.join("."):e}function TF(e,t){let r=[],n=!1;const a=(s,i,o)=>{if(Ir(s))if(!i[o])r.push(s);else{let l=i[o];const c=s[l];if(!Ir(c))return;if(o===i.length-1&&(Mn(c)||_k(c)||vF(c)))r.push(gF(c));else if(fa(c)){n=!0;for(let d=0,f=c.length;d<f;d+=1)a(c[d],i,o+1)}else i.length&&a(c,i,o+1)}};return a(e,Mn(t)?t.split("."):t,0),n?r:r[0]}const CF={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},NF={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},AF={location:0,threshold:.6,distance:100},FF={useExtendedSearch:!1,getFn:TF,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Ae={...NF,...CF,...AF,...FF};const PF=/[^ ]+/g;function RF(e=1,t=3){const r=new Map,n=Math.pow(10,t);return{get(a){const s=a.match(PF).length;if(r.has(s))return r.get(s);const i=1/Math.pow(s,.5*e),o=parseFloat(Math.round(i*n)/n);return r.set(s,o),o},clear(){r.clear()}}}let xp=class{constructor({getFn:t=Ae.getFn,fieldNormWeight:r=Ae.fieldNormWeight}={}){this.norm=RF(r,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((r,n)=>{this._keysMap[r.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Mn(this.docs[0])?this.docs.forEach((t,r)=>{this._addString(t,r)}):this.docs.forEach((t,r)=>{this._addObject(t,r)}),this.norm.clear())}add(t){const r=this.size();Mn(t)?this._addString(t,r):this._addObject(t,r)}removeAt(t){this.records.splice(t,1);for(let r=t,n=this.size();r<n;r+=1)this.records[r].i-=1}getValueForItemAtKeyId(t,r){return t[this._keysMap[r]]}size(){return this.records.length}_addString(t,r){if(!Ir(t)||Wd(t))return;let n={v:t,i:r,n:this.norm.get(t)};this.records.push(n)}_addObject(t,r){let n={i:r,$:{}};this.keys.forEach((a,s)=>{let i=a.getFn?a.getFn(t):this.getFn(t,a.path);if(Ir(i)){if(fa(i)){let o=[];const l=[{nestedArrIndex:-1,value:i}];for(;l.length;){const{nestedArrIndex:c,value:d}=l.pop();if(Ir(d))if(Mn(d)&&!Wd(d)){let f={v:d,i:c,n:this.norm.get(d)};o.push(f)}else fa(d)&&d.forEach((f,h)=>{l.push({nestedArrIndex:h,value:f})})}n.$[s]=o}else if(Mn(i)&&!Wd(i)){let o={v:i,n:this.norm.get(i)};n.$[s]=o}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}};function Nk(e,t,{getFn:r=Ae.getFn,fieldNormWeight:n=Ae.fieldNormWeight}={}){const a=new xp({getFn:r,fieldNormWeight:n});return a.setKeys(e.map(Ck)),a.setSources(t),a.create(),a}function DF(e,{getFn:t=Ae.getFn,fieldNormWeight:r=Ae.fieldNormWeight}={}){const{keys:n,records:a}=e,s=new xp({getFn:t,fieldNormWeight:r});return s.setKeys(n),s.setIndexRecords(a),s}function Xc(e,{errors:t=0,currentLocation:r=0,expectedLocation:n=0,distance:a=Ae.distance,ignoreLocation:s=Ae.ignoreLocation}={}){const i=t/e.length;if(s)return i;const o=Math.abs(n-r);return a?i+o/a:o?1:i}function jF(e=[],t=Ae.minMatchCharLength){let r=[],n=-1,a=-1,s=0;for(let i=e.length;s<i;s+=1){let o=e[s];o&&n===-1?n=s:!o&&n!==-1&&(a=s-1,a-n+1>=t&&r.push([n,a]),n=-1)}return e[s-1]&&s-n>=t&&r.push([n,s-1]),r}const ps=32;function IF(e,t,r,{location:n=Ae.location,distance:a=Ae.distance,threshold:s=Ae.threshold,findAllMatches:i=Ae.findAllMatches,minMatchCharLength:o=Ae.minMatchCharLength,includeMatches:l=Ae.includeMatches,ignoreLocation:c=Ae.ignoreLocation}={}){if(t.length>ps)throw new Error(SF(ps));const d=t.length,f=e.length,h=Math.max(0,Math.min(n,f));let p=s,x=h;const m=o>1||l,v=m?Array(f):[];let g;for(;(g=e.indexOf(t,x))>-1;){let b=Xc(t,{currentLocation:g,expectedLocation:h,distance:a,ignoreLocation:c});if(p=Math.min(b,p),x=g+d,m){let k=0;for(;k<d;)v[g+k]=1,k+=1}}x=-1;let y=[],w=1,S=d+f;const A=1<<d-1;for(let b=0;b<d;b+=1){let k=0,E=S;for(;k<E;)Xc(t,{errors:b,currentLocation:h+E,expectedLocation:h,distance:a,ignoreLocation:c})<=p?k=E:S=E,E=Math.floor((S-k)/2+k);S=E;let _=Math.max(1,h-E+1),C=i?f:Math.min(h+E,f)+d,F=Array(C+2);F[C+1]=(1<<b)-1;for(let M=C;M>=_;M-=1){let B=M-1,q=r[e.charAt(B)];if(m&&(v[B]=+!!q),F[M]=(F[M+1]<<1|1)&q,b&&(F[M]|=(y[M+1]|y[M])<<1|1|y[M+1]),F[M]&A&&(w=Xc(t,{errors:b,currentLocation:B,expectedLocation:h,distance:a,ignoreLocation:c}),w<=p)){if(p=w,x=B,x<=h)break;_=Math.max(1,2*h-x)}}if(Xc(t,{errors:b+1,currentLocation:h,expectedLocation:h,distance:a,ignoreLocation:c})>p)break;y=F}const T={isMatch:x>=0,score:Math.max(.001,w)};if(m){const b=jF(v,o);b.length?l&&(T.indices=b):T.isMatch=!1}return T}function OF(e){let t={};for(let r=0,n=e.length;r<n;r+=1){const a=e.charAt(r);t[a]=(t[a]||0)|1<<n-r-1}return t}const i0=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;let Ak=class{constructor(t,{location:r=Ae.location,threshold:n=Ae.threshold,distance:a=Ae.distance,includeMatches:s=Ae.includeMatches,findAllMatches:i=Ae.findAllMatches,minMatchCharLength:o=Ae.minMatchCharLength,isCaseSensitive:l=Ae.isCaseSensitive,ignoreDiacritics:c=Ae.ignoreDiacritics,ignoreLocation:d=Ae.ignoreLocation}={}){if(this.options={location:r,threshold:n,distance:a,includeMatches:s,findAllMatches:i,minMatchCharLength:o,isCaseSensitive:l,ignoreDiacritics:c,ignoreLocation:d},t=l?t:t.toLowerCase(),t=c?i0(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const f=(p,x)=>{this.chunks.push({pattern:p,alphabet:OF(p),startIndex:x})},h=this.pattern.length;if(h>ps){let p=0;const x=h%ps,m=h-x;for(;p<m;)f(this.pattern.substr(p,ps),p),p+=ps;if(x){const v=h-ps;f(this.pattern.substr(v),v)}}else f(this.pattern,0)}searchIn(t){const{isCaseSensitive:r,ignoreDiacritics:n,includeMatches:a}=this.options;if(t=r?t:t.toLowerCase(),t=n?i0(t):t,this.pattern===t){let m={isMatch:!0,score:0};return a&&(m.indices=[[0,t.length-1]]),m}const{location:s,distance:i,threshold:o,findAllMatches:l,minMatchCharLength:c,ignoreLocation:d}=this.options;let f=[],h=0,p=!1;this.chunks.forEach(({pattern:m,alphabet:v,startIndex:g})=>{const{isMatch:y,score:w,indices:S}=IF(t,m,v,{location:s+g,distance:i,threshold:o,findAllMatches:l,minMatchCharLength:c,includeMatches:a,ignoreLocation:d});y&&(p=!0),h+=w,y&&S&&(f=[...f,...S])});let x={isMatch:p,score:p?h/this.chunks.length:1};return p&&a&&(x.indices=f),x}},cs=class{constructor(t){this.pattern=t}static isMultiMatch(t){return sg(t,this.multiRegex)}static isSingleMatch(t){return sg(t,this.singleRegex)}search(){}};function sg(e,t){const r=e.match(t);return r?r[1]:null}let MF=class extends cs{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const r=t===this.pattern;return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}},LF=class extends cs{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const n=t.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}},BF=class extends cs{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const r=t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}},UF=class extends cs{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const r=!t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}},$F=class extends cs{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const r=t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},zF=class extends cs{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const r=!t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}},Fk=class extends cs{constructor(t,{location:r=Ae.location,threshold:n=Ae.threshold,distance:a=Ae.distance,includeMatches:s=Ae.includeMatches,findAllMatches:i=Ae.findAllMatches,minMatchCharLength:o=Ae.minMatchCharLength,isCaseSensitive:l=Ae.isCaseSensitive,ignoreDiacritics:c=Ae.ignoreDiacritics,ignoreLocation:d=Ae.ignoreLocation}={}){super(t),this._bitapSearch=new Ak(t,{location:r,threshold:n,distance:a,includeMatches:s,findAllMatches:i,minMatchCharLength:o,isCaseSensitive:l,ignoreDiacritics:c,ignoreLocation:d})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}},Pk=class extends cs{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let r=0,n;const a=[],s=this.pattern.length;for(;(n=t.indexOf(this.pattern,r))>-1;)r=n+s,a.push([n,r-1]);const i=!!a.length;return{isMatch:i,score:i?0:1,indices:a}}};const Eh=[MF,Pk,BF,UF,zF,$F,LF,Fk],ig=Eh.length,VF=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,HF="|";function WF(e,t={}){return e.split(HF).map(r=>{let n=r.trim().split(VF).filter(s=>s&&!!s.trim()),a=[];for(let s=0,i=n.length;s<i;s+=1){const o=n[s];let l=!1,c=-1;for(;!l&&++c<ig;){const d=Eh[c];let f=d.isMultiMatch(o);f&&(a.push(new d(f,t)),l=!0)}if(!l)for(c=-1;++c<ig;){const d=Eh[c];let f=d.isSingleMatch(o);if(f){a.push(new d(f,t));break}}}return a})}const KF=new Set([Fk.type,Pk.type]);let GF=class{constructor(t,{isCaseSensitive:r=Ae.isCaseSensitive,ignoreDiacritics:n=Ae.ignoreDiacritics,includeMatches:a=Ae.includeMatches,minMatchCharLength:s=Ae.minMatchCharLength,ignoreLocation:i=Ae.ignoreLocation,findAllMatches:o=Ae.findAllMatches,location:l=Ae.location,threshold:c=Ae.threshold,distance:d=Ae.distance}={}){this.query=null,this.options={isCaseSensitive:r,ignoreDiacritics:n,includeMatches:a,minMatchCharLength:s,findAllMatches:o,ignoreLocation:i,location:l,threshold:c,distance:d},t=r?t:t.toLowerCase(),t=n?i0(t):t,this.pattern=t,this.query=WF(this.pattern,this.options)}static condition(t,r){return r.useExtendedSearch}searchIn(t){const r=this.query;if(!r)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:a,ignoreDiacritics:s}=this.options;t=a?t:t.toLowerCase(),t=s?i0(t):t;let i=0,o=[],l=0;for(let c=0,d=r.length;c<d;c+=1){const f=r[c];o.length=0,i=0;for(let h=0,p=f.length;h<p;h+=1){const x=f[h],{isMatch:m,indices:v,score:g}=x.search(t);if(m){if(i+=1,l+=g,n){const y=x.constructor.type;KF.has(y)?o=[...o,...v]:o.push(v)}}else{l=0,i=0,o.length=0;break}}if(i){let h={isMatch:!0,score:l/i};return n&&(h.indices=o),h}}return{isMatch:!1,score:1}}};const _h=[];function YF(...e){_h.push(...e)}function bh(e,t){for(let r=0,n=_h.length;r<n;r+=1){let a=_h[r];if(a.condition(e,t))return new a(e,t)}return new Ak(e,t)}const o0={AND:"$and",OR:"$or"},Th={PATH:"$path",PATTERN:"$val"},Ch=e=>!!(e[o0.AND]||e[o0.OR]),XF=e=>!!e[Th.PATH],qF=e=>!fa(e)&&bk(e)&&!Ch(e),og=e=>({[o0.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function Rk(e,t,{auto:r=!0}={}){const n=a=>{let s=Object.keys(a);const i=XF(a);if(!i&&s.length>1&&!Ch(a))return n(og(a));if(qF(a)){const l=i?a[Th.PATH]:s[0],c=i?a[Th.PATTERN]:a[l];if(!Mn(c))throw new Error(kF(l));const d={keyId:Sh(l),pattern:c};return r&&(d.searcher=bh(c,t)),d}let o={children:[],operator:s[0]};return s.forEach(l=>{const c=a[l];fa(c)&&c.forEach(d=>{o.children.push(n(d))})}),o};return Ch(e)||(e=og(e)),n(e)}function QF(e,{ignoreFieldNorm:t=Ae.ignoreFieldNorm}){e.forEach(r=>{let n=1;r.matches.forEach(({key:a,norm:s,score:i})=>{const o=a?a.weight:null;n*=Math.pow(i===0&&o?Number.EPSILON:i,(o||1)*(t?1:s))}),r.score=n})}function JF(e,t){const r=e.matches;t.matches=[],Ir(r)&&r.forEach(n=>{if(!Ir(n.indices)||!n.indices.length)return;const{indices:a,value:s}=n;let i={indices:a,value:s};n.key&&(i.key=n.key.src),n.idx>-1&&(i.refIndex=n.idx),t.matches.push(i)})}function ZF(e,t){t.score=e.score}function eP(e,t,{includeMatches:r=Ae.includeMatches,includeScore:n=Ae.includeScore}={}){const a=[];return r&&a.push(JF),n&&a.push(ZF),e.map(s=>{const{idx:i}=s,o={item:t[i],refIndex:i};return a.length&&a.forEach(l=>{l(s,o)}),o})}let go=class{constructor(t,r={},n){this.options={...Ae,...r},this.options.useExtendedSearch,this._keyStore=new bF(this.options.keys),this.setCollection(t,n)}setCollection(t,r){if(this._docs=t,r&&!(r instanceof xp))throw new Error(wF);this._myIndex=r||Nk(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){Ir(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const r=[];for(let n=0,a=this._docs.length;n<a;n+=1){const s=this._docs[n];t(s,n)&&(this.removeAt(n),n-=1,a-=1,r.push(s))}return r}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:r=-1}={}){const{includeMatches:n,includeScore:a,shouldSort:s,sortFn:i,ignoreFieldNorm:o}=this.options;let l=Mn(t)?Mn(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return QF(l,{ignoreFieldNorm:o}),s&&l.sort(i),_k(r)&&r>-1&&(l=l.slice(0,r)),eP(l,this._docs,{includeMatches:n,includeScore:a})}_searchStringList(t){const r=bh(t,this.options),{records:n}=this._myIndex,a=[];return n.forEach(({v:s,i,n:o})=>{if(!Ir(s))return;const{isMatch:l,score:c,indices:d}=r.searchIn(s);l&&a.push({item:s,idx:i,matches:[{score:c,value:s,norm:o,indices:d}]})}),a}_searchLogical(t){const r=Rk(t,this.options),n=(o,l,c)=>{if(!o.children){const{keyId:f,searcher:h}=o,p=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(l,f),searcher:h});return p&&p.length?[{idx:c,item:l,matches:p}]:[]}const d=[];for(let f=0,h=o.children.length;f<h;f+=1){const p=o.children[f],x=n(p,l,c);if(x.length)d.push(...x);else if(o.operator===o0.AND)return[]}return d},a=this._myIndex.records,s={},i=[];return a.forEach(({$:o,i:l})=>{if(Ir(o)){let c=n(r,o,l);c.length&&(s[l]||(s[l]={idx:l,item:o,matches:[]},i.push(s[l])),c.forEach(({matches:d})=>{s[l].matches.push(...d)}))}}),i}_searchObjectList(t){const r=bh(t,this.options),{keys:n,records:a}=this._myIndex,s=[];return a.forEach(({$:i,i:o})=>{if(!Ir(i))return;let l=[];n.forEach((c,d)=>{l.push(...this._findMatches({key:c,value:i[d],searcher:r}))}),l.length&&s.push({idx:o,item:i,matches:l})}),s}_findMatches({key:t,value:r,searcher:n}){if(!Ir(r))return[];let a=[];if(fa(r))r.forEach(({v:s,i,n:o})=>{if(!Ir(s))return;const{isMatch:l,score:c,indices:d}=n.searchIn(s);l&&a.push({score:c,key:t,value:s,idx:i,norm:o,indices:d})});else{const{v:s,n:i}=r,{isMatch:o,score:l,indices:c}=n.searchIn(s);o&&a.push({score:l,key:t,value:s,norm:i,indices:c})}return a}};go.version="7.1.0";go.createIndex=Nk;go.parseIndex=DF;go.config=Ae;go.parseQuery=Rk;YF(GF);class tP{constructor(t,r={}){this.originalData=t;const n={threshold:.3,distance:100,minMatchCharLength:2,findAllMatches:!1,includeScore:!0,includeMatches:!0,shouldSort:!0,...r};this.options=n,this.fuse=new go(t,n)}search(t){return!t||t.length<2?this.originalData.map(n=>({item:n})):this.fuse.search(t).map(n=>({item:n.item,score:n.score,matches:n.matches}))}setData(t){this.originalData=t,this.fuse.setCollection(t)}addItems(t){this.originalData=[...this.originalData,...t],this.fuse.setCollection(this.originalData)}removeItems(t){this.originalData=this.originalData.filter(r=>!t(r)),this.fuse.setCollection(this.originalData)}getAllData(){return this.originalData}getStats(){return{totalItems:this.originalData.length,searchKeys:this.options.keys,threshold:this.options.threshold}}}function rP(e,t={}){return new tP(e,t)}const lg={strict:{threshold:.2,distance:50,minMatchCharLength:3},balanced:{threshold:.3,distance:100,minMatchCharLength:2},lenient:{threshold:.6,distance:200,minMatchCharLength:1},exactWithTypos:{threshold:.1,distance:20,minMatchCharLength:3,findAllMatches:!0}};function nP(e,t={}){const{debounceMs:r=300,minQueryLength:n=2,preset:a,...s}=t,i=V.useMemo(()=>a&&lg[a]?{...lg[a],...s}:s,[a,s]),[o,l]=V.useState(""),[c,d]=V.useState(""),[f,h]=V.useState(!1),[p,x]=V.useState(e),m=V.useMemo(()=>rP(p,i),[p,i]);V.useEffect(()=>{if(o.length===0){d(""),h(!1);return}if(o.length<n){d(""),h(!1);return}h(!0);const E=setTimeout(()=>{d(o),h(!1)},r);return()=>clearTimeout(E)},[o,r,n]);const v=V.useMemo(()=>!c||c.length<n?p.map(E=>({item:E})):m.search(c),[c,m,p,n]),g=v.length,y=g>0,w=V.useCallback(E=>{l(E)},[]),S=V.useCallback(()=>{l(""),d(""),h(!1)},[]),A=V.useCallback(E=>{x(E)},[]),T=V.useCallback(E=>{x(_=>[..._,...E])},[]),b=V.useCallback(E=>{x(_=>_.filter(C=>!E(C)))},[]),k=V.useMemo(()=>m.getStats(),[m]);return{results:v,query:o,setQuery:w,isSearching:f,totalResults:g,hasResults:y,clearSearch:S,setData:A,addItems:T,removeItems:b,stats:k}}var Dk={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(VE,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,s=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function d(k){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(E){var _=A(E);_.chunkSize=parseInt(_.chunkSize),E.step||E.chunk||(_.chunkSize=null),this._handle=new m(_),(this._handle.streamer=this)._config=_}).call(this,k),this.parseChunk=function(E,_){var C=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<C){let D=this._config.newline;D||(F=this._config.quoteChar||'"',D=this._handle.guessLineEndings(E,F)),E=[...E.split(D).slice(C)].join(D)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&(F=this._config.beforeFirstChunk(E))!==void 0&&(E=F),this.isFirstChunk=!1,this._halted=!1;var C=this._partialLine+E,F=(this._partialLine="",this._handle.parse(C,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(E=F.meta.cursor,C=(this._finished||(this._partialLine=C.substring(E-this._baseIndex),this._baseIndex=E),F&&F.data&&(this._rowCount+=F.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)n.postMessage({results:F,workerId:c.WORKER_ID,finished:C});else if(b(this._config.chunk)&&!_){if(this._config.chunk(F,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=F=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(F.data),this._completeResults.errors=this._completeResults.errors.concat(F.errors),this._completeResults.meta=F.meta),this._completed||!C||!b(this._config.complete)||F&&F.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),C||F&&F.meta.paused||this._nextChunk(),F}this._halted=!0},this._sendError=function(E){b(this._config.error)?this._config.error(E):i&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:E,finished:!1})}}function f(k){var E;(k=k||{}).chunkSize||(k.chunkSize=c.RemoteChunkSize),d.call(this,k),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(_){this._input=_,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(E=new XMLHttpRequest,this._config.withCredentials&&(E.withCredentials=this._config.withCredentials),s||(E.onload=T(this._chunkLoaded,this),E.onerror=T(this._chunkError,this)),E.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var _,C=this._config.downloadRequestHeaders;for(_ in C)E.setRequestHeader(_,C[_])}var F;this._config.chunkSize&&(F=this._start+this._config.chunkSize-1,E.setRequestHeader("Range","bytes="+this._start+"-"+F));try{E.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}s&&E.status===0&&this._chunkError()}},this._chunkLoaded=function(){E.readyState===4&&(E.status<200||400<=E.status?this._chunkError():(this._start+=this._config.chunkSize||E.responseText.length,this._finished=!this._config.chunkSize||this._start>=(_=>(_=_.getResponseHeader("Content-Range"))!==null?parseInt(_.substring(_.lastIndexOf("/")+1)):-1)(E),this.parseChunk(E.responseText)))},this._chunkError=function(_){_=E.statusText||_,this._sendError(new Error(_))}}function h(k){(k=k||{}).chunkSize||(k.chunkSize=c.LocalChunkSize),d.call(this,k);var E,_,C=typeof FileReader<"u";this.stream=function(F){this._input=F,_=F.slice||F.webkitSlice||F.mozSlice,C?((E=new FileReader).onload=T(this._chunkLoaded,this),E.onerror=T(this._chunkError,this)):E=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var F=this._input,D=(this._config.chunkSize&&(D=Math.min(this._start+this._config.chunkSize,this._input.size),F=_.call(F,this._start,D)),E.readAsText(F,this._config.encoding));C||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(F){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(F.target.result)},this._chunkError=function(){this._sendError(E.error)}}function p(k){var E;d.call(this,k=k||{}),this.stream=function(_){return E=_,this._nextChunk()},this._nextChunk=function(){var _,C;if(!this._finished)return _=this._config.chunkSize,E=_?(C=E.substring(0,_),E.substring(_)):(C=E,""),this._finished=!E,this.parseChunk(C)}}function x(k){d.call(this,k=k||{});var E=[],_=!0,C=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(F){this._input=F,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){C&&E.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),E.length?this.parseChunk(E.shift()):_=!0},this._streamData=T(function(F){try{E.push(typeof F=="string"?F:F.toString(this._config.encoding)),_&&(_=!1,this._checkIsFinished(),this.parseChunk(E.shift()))}catch(D){this._streamError(D)}},this),this._streamError=T(function(F){this._streamCleanUp(),this._sendError(F)},this),this._streamEnd=T(function(){this._streamCleanUp(),C=!0,this._streamData("")},this),this._streamCleanUp=T(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(k){var E,_,C,F,D=Math.pow(2,53),M=-D,B=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,q=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Q=this,J=0,P=0,Z=!1,le=!1,R=[],G={data:[],errors:[],meta:{}};function W(se){return k.skipEmptyLines==="greedy"?se.join("").trim()==="":se.length===1&&se[0].length===0}function K(){if(G&&C&&(X("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),C=!1),k.skipEmptyLines&&(G.data=G.data.filter(function(L){return!W(L)})),O()){let L=function(Pe,ke){b(k.transformHeader)&&(Pe=k.transformHeader(Pe,ke)),R.push(Pe)};var ue=L;if(G)if(Array.isArray(G.data[0])){for(var se=0;O()&&se<G.data.length;se++)G.data[se].forEach(L);G.data.splice(0,1)}else G.data.forEach(L)}function ie(L,Pe){for(var ke=k.header?{}:[],Se=0;Se<L.length;Se++){var xe=Se,de=L[Se],de=((be,Oe)=>($e=>(k.dynamicTypingFunction&&k.dynamicTyping[$e]===void 0&&(k.dynamicTyping[$e]=k.dynamicTypingFunction($e)),(k.dynamicTyping[$e]||k.dynamicTyping)===!0))(be)?Oe==="true"||Oe==="TRUE"||Oe!=="false"&&Oe!=="FALSE"&&(($e=>{if(B.test($e)&&($e=parseFloat($e),M<$e&&$e<D))return 1})(Oe)?parseFloat(Oe):q.test(Oe)?new Date(Oe):Oe===""?null:Oe):Oe)(xe=k.header?Se>=R.length?"__parsed_extra":R[Se]:xe,de=k.transform?k.transform(de,xe):de);xe==="__parsed_extra"?(ke[xe]=ke[xe]||[],ke[xe].push(de)):ke[xe]=de}return k.header&&(Se>R.length?X("FieldMismatch","TooManyFields","Too many fields: expected "+R.length+" fields but parsed "+Se,P+Pe):Se<R.length&&X("FieldMismatch","TooFewFields","Too few fields: expected "+R.length+" fields but parsed "+Se,P+Pe)),ke}var oe;G&&(k.header||k.dynamicTyping||k.transform)&&(oe=1,!G.data.length||Array.isArray(G.data[0])?(G.data=G.data.map(ie),oe=G.data.length):G.data=ie(G.data,0),k.header&&G.meta&&(G.meta.fields=R),P+=oe)}function O(){return k.header&&R.length===0}function X(se,ie,oe,ue){se={type:se,code:ie,message:oe},ue!==void 0&&(se.row=ue),G.errors.push(se)}b(k.step)&&(F=k.step,k.step=function(se){G=se,O()?K():(K(),G.data.length!==0&&(J+=se.data.length,k.preview&&J>k.preview?_.abort():(G.data=G.data[0],F(G,Q))))}),this.parse=function(se,ie,oe){var ue=k.quoteChar||'"',ue=(k.newline||(k.newline=this.guessLineEndings(se,ue)),C=!1,k.delimiter?b(k.delimiter)&&(k.delimiter=k.delimiter(se),G.meta.delimiter=k.delimiter):((ue=((L,Pe,ke,Se,xe)=>{var de,be,Oe,$e;xe=xe||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var At=0;At<xe.length;At++){for(var Ft,De=xe[At],Ce=0,Xe=0,qe=0,St=(Oe=void 0,new g({comments:Se,delimiter:De,newline:Pe,preview:10}).parse(L)),rt=0;rt<St.data.length;rt++)ke&&W(St.data[rt])?qe++:(Ft=St.data[rt].length,Xe+=Ft,Oe===void 0?Oe=Ft:0<Ft&&(Ce+=Math.abs(Ft-Oe),Oe=Ft));0<St.data.length&&(Xe/=St.data.length-qe),(be===void 0||Ce<=be)&&($e===void 0||$e<Xe)&&1.99<Xe&&(be=Ce,de=De,$e=Xe)}return{successful:!!(k.delimiter=de),bestDelimiter:de}})(se,k.newline,k.skipEmptyLines,k.comments,k.delimitersToGuess)).successful?k.delimiter=ue.bestDelimiter:(C=!0,k.delimiter=c.DefaultDelimiter),G.meta.delimiter=k.delimiter),A(k));return k.preview&&k.header&&ue.preview++,E=se,_=new g(ue),G=_.parse(E,ie,oe),K(),Z?{meta:{paused:!0}}:G||{meta:{paused:!1}}},this.paused=function(){return Z},this.pause=function(){Z=!0,_.abort(),E=b(k.chunk)?"":E.substring(_.getCharIndex())},this.resume=function(){Q.streamer._halted?(Z=!1,Q.streamer.parseChunk(E,!0)):setTimeout(Q.resume,3)},this.aborted=function(){return le},this.abort=function(){le=!0,_.abort(),G.meta.aborted=!0,b(k.complete)&&k.complete(G),E=""},this.guessLineEndings=function(L,ue){L=L.substring(0,1048576);var ue=new RegExp(v(ue)+"([^]*?)"+v(ue),"gm"),oe=(L=L.replace(ue,"")).split("\r"),ue=L.split(`
`),L=1<ue.length&&ue[0].length<oe[0].length;if(oe.length===1||L)return`
`;for(var Pe=0,ke=0;ke<oe.length;ke++)oe[ke][0]===`
`&&Pe++;return Pe>=oe.length/2?`\r
`:"\r"}}function v(k){return k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(k){var E=(k=k||{}).delimiter,_=k.newline,C=k.comments,F=k.step,D=k.preview,M=k.fastMode,B=null,q=!1,Q=k.quoteChar==null?'"':k.quoteChar,J=Q;if(k.escapeChar!==void 0&&(J=k.escapeChar),(typeof E!="string"||-1<c.BAD_DELIMITERS.indexOf(E))&&(E=","),C===E)throw new Error("Comment character same as delimiter");C===!0?C="#":(typeof C!="string"||-1<c.BAD_DELIMITERS.indexOf(C))&&(C=!1),_!==`
`&&_!=="\r"&&_!==`\r
`&&(_=`
`);var P=0,Z=!1;this.parse=function(le,R,G){if(typeof le!="string")throw new Error("Input must be a string");var W=le.length,K=E.length,O=_.length,X=C.length,se=b(F),ie=[],oe=[],ue=[],L=P=0;if(!le)return Ce();if(M||M!==!1&&le.indexOf(Q)===-1){for(var Pe=le.split(_),ke=0;ke<Pe.length;ke++){if(ue=Pe[ke],P+=ue.length,ke!==Pe.length-1)P+=_.length;else if(G)return Ce();if(!C||ue.substring(0,X)!==C){if(se){if(ie=[],$e(ue.split(E)),Xe(),Z)return Ce()}else $e(ue.split(E));if(D&&D<=ke)return ie=ie.slice(0,D),Ce(!0)}}return Ce()}for(var Se=le.indexOf(E,P),xe=le.indexOf(_,P),de=new RegExp(v(J)+v(Q),"g"),be=le.indexOf(Q,P);;)if(le[P]===Q)for(be=P,P++;;){if((be=le.indexOf(Q,be+1))===-1)return G||oe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ie.length,index:P}),Ft();if(be===W-1)return Ft(le.substring(P,be).replace(de,Q));if(Q===J&&le[be+1]===J)be++;else if(Q===J||be===0||le[be-1]!==J){Se!==-1&&Se<be+1&&(Se=le.indexOf(E,be+1));var Oe=At((xe=xe!==-1&&xe<be+1?le.indexOf(_,be+1):xe)===-1?Se:Math.min(Se,xe));if(le.substr(be+1+Oe,K)===E){ue.push(le.substring(P,be).replace(de,Q)),le[P=be+1+Oe+K]!==Q&&(be=le.indexOf(Q,P)),Se=le.indexOf(E,P),xe=le.indexOf(_,P);break}if(Oe=At(xe),le.substring(be+1+Oe,be+1+Oe+O)===_){if(ue.push(le.substring(P,be).replace(de,Q)),De(be+1+Oe+O),Se=le.indexOf(E,P),be=le.indexOf(Q,P),se&&(Xe(),Z))return Ce();if(D&&ie.length>=D)return Ce(!0);break}oe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ie.length,index:P}),be++}}else if(C&&ue.length===0&&le.substring(P,P+X)===C){if(xe===-1)return Ce();P=xe+O,xe=le.indexOf(_,P),Se=le.indexOf(E,P)}else if(Se!==-1&&(Se<xe||xe===-1))ue.push(le.substring(P,Se)),P=Se+K,Se=le.indexOf(E,P);else{if(xe===-1)break;if(ue.push(le.substring(P,xe)),De(xe+O),se&&(Xe(),Z))return Ce();if(D&&ie.length>=D)return Ce(!0)}return Ft();function $e(qe){ie.push(qe),L=P}function At(qe){var St=0;return St=qe!==-1&&(qe=le.substring(be+1,qe))&&qe.trim()===""?qe.length:St}function Ft(qe){return G||(qe===void 0&&(qe=le.substring(P)),ue.push(qe),P=W,$e(ue),se&&Xe()),Ce()}function De(qe){P=qe,$e(ue),ue=[],xe=le.indexOf(_,P)}function Ce(qe){if(k.header&&!R&&ie.length&&!q){var St=ie[0],rt=Object.create(null),Sr=new Set(St);let Be=!1;for(let Je=0;Je<St.length;Je++){let ct=St[Je];if(rt[ct=b(k.transformHeader)?k.transformHeader(ct,Je):ct]){let nt,Tn=rt[ct];for(;nt=ct+"_"+Tn,Tn++,Sr.has(nt););Sr.add(nt),St[Je]=nt,rt[ct]++,Be=!0,(B=B===null?{}:B)[nt]=ct}else rt[ct]=1,St[Je]=ct;Sr.add(ct)}Be&&console.warn("Duplicate headers found and renamed."),q=!0}return{data:ie,errors:oe,meta:{delimiter:E,linebreak:_,aborted:Z,truncated:!!qe,cursor:L+(R||0),renamedHeaders:B}}}function Xe(){F(Ce()),ie=[],oe=[]}},this.abort=function(){Z=!0},this.getCharIndex=function(){return P}}function y(k){var E=k.data,_=o[E.workerId],C=!1;if(E.error)_.userError(E.error,E.file);else if(E.results&&E.results.data){var F={abort:function(){C=!0,w(E.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:S,resume:S};if(b(_.userStep)){for(var D=0;D<E.results.data.length&&(_.userStep({data:E.results.data[D],errors:E.results.errors,meta:E.results.meta},F),!C);D++);delete E.results}else b(_.userChunk)&&(_.userChunk(E.results,F,E.file),delete E.results)}E.finished&&!C&&w(E.workerId,E.results)}function w(k,E){var _=o[k];b(_.userComplete)&&_.userComplete(E),_.terminate(),delete o[k]}function S(){throw new Error("Not implemented.")}function A(k){if(typeof k!="object"||k===null)return k;var E,_=Array.isArray(k)?[]:{};for(E in k)_[E]=A(k[E]);return _}function T(k,E){return function(){k.apply(E,arguments)}}function b(k){return typeof k=="function"}return c.parse=function(k,E){var _=(E=E||{}).dynamicTyping||!1;if(b(_)&&(E.dynamicTypingFunction=_,_={}),E.dynamicTyping=_,E.transform=!!b(E.transform)&&E.transform,!E.worker||!c.WORKERS_SUPPORTED)return _=null,c.NODE_STREAM_INPUT,typeof k=="string"?(k=(C=>C.charCodeAt(0)!==65279?C:C.slice(1))(k),_=new(E.download?f:p)(E)):k.readable===!0&&b(k.read)&&b(k.on)?_=new x(E):(n.File&&k instanceof File||k instanceof Object)&&(_=new h(E)),_.stream(k);(_=(()=>{var C;return!!c.WORKERS_SUPPORTED&&(C=(()=>{var F=n.URL||n.webkitURL||null,D=r.toString();return c.BLOB_URL||(c.BLOB_URL=F.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))})(),(C=new n.Worker(C)).onmessage=y,C.id=l++,o[C.id]=C)})()).userStep=E.step,_.userChunk=E.chunk,_.userComplete=E.complete,_.userError=E.error,E.step=b(E.step),E.chunk=b(E.chunk),E.complete=b(E.complete),E.error=b(E.error),delete E.worker,_.postMessage({input:k,config:E,workerId:_.id})},c.unparse=function(k,E){var _=!1,C=!0,F=",",D=`\r
`,M='"',B=M+M,q=!1,Q=null,J=!1,P=((()=>{if(typeof E=="object"){if(typeof E.delimiter!="string"||c.BAD_DELIMITERS.filter(function(R){return E.delimiter.indexOf(R)!==-1}).length||(F=E.delimiter),typeof E.quotes!="boolean"&&typeof E.quotes!="function"&&!Array.isArray(E.quotes)||(_=E.quotes),typeof E.skipEmptyLines!="boolean"&&typeof E.skipEmptyLines!="string"||(q=E.skipEmptyLines),typeof E.newline=="string"&&(D=E.newline),typeof E.quoteChar=="string"&&(M=E.quoteChar),typeof E.header=="boolean"&&(C=E.header),Array.isArray(E.columns)){if(E.columns.length===0)throw new Error("Option columns is empty");Q=E.columns}E.escapeChar!==void 0&&(B=E.escapeChar+M),E.escapeFormulae instanceof RegExp?J=E.escapeFormulae:typeof E.escapeFormulae=="boolean"&&E.escapeFormulae&&(J=/^[=+\-@\t\r].*$/)}})(),new RegExp(v(M),"g"));if(typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(k)){if(!k.length||Array.isArray(k[0]))return Z(null,k,q);if(typeof k[0]=="object")return Z(Q||Object.keys(k[0]),k,q)}else if(typeof k=="object")return typeof k.data=="string"&&(k.data=JSON.parse(k.data)),Array.isArray(k.data)&&(k.fields||(k.fields=k.meta&&k.meta.fields||Q),k.fields||(k.fields=Array.isArray(k.data[0])?k.fields:typeof k.data[0]=="object"?Object.keys(k.data[0]):[]),Array.isArray(k.data[0])||typeof k.data[0]=="object"||(k.data=[k.data])),Z(k.fields||[],k.data||[],q);throw new Error("Unable to serialize unrecognized input");function Z(R,G,W){var K="",O=(typeof R=="string"&&(R=JSON.parse(R)),typeof G=="string"&&(G=JSON.parse(G)),Array.isArray(R)&&0<R.length),X=!Array.isArray(G[0]);if(O&&C){for(var se=0;se<R.length;se++)0<se&&(K+=F),K+=le(R[se],se);0<G.length&&(K+=D)}for(var ie=0;ie<G.length;ie++){var oe=(O?R:G[ie]).length,ue=!1,L=O?Object.keys(G[ie]).length===0:G[ie].length===0;if(W&&!O&&(ue=W==="greedy"?G[ie].join("").trim()==="":G[ie].length===1&&G[ie][0].length===0),W==="greedy"&&O){for(var Pe=[],ke=0;ke<oe;ke++){var Se=X?R[ke]:ke;Pe.push(G[ie][Se])}ue=Pe.join("").trim()===""}if(!ue){for(var xe=0;xe<oe;xe++){0<xe&&!L&&(K+=F);var de=O&&X?R[xe]:xe;K+=le(G[ie][de],xe)}ie<G.length-1&&(!W||0<oe&&!L)&&(K+=D)}}return K}function le(R,G){var W,K;return R==null?"":R.constructor===Date?JSON.stringify(R).slice(1,25):(K=!1,J&&typeof R=="string"&&J.test(R)&&(R="'"+R,K=!0),W=R.toString().replace(P,B),(K=K||_===!0||typeof _=="function"&&_(R,G)||Array.isArray(_)&&_[G]||((O,X)=>{for(var se=0;se<X.length;se++)if(-1<O.indexOf(X[se]))return!0;return!1})(W,c.BAD_DELIMITERS)||-1<W.indexOf(F)||W.charAt(0)===" "||W.charAt(W.length-1)===" ")?M+W+M:W)}},c.RECORD_SEP=String.fromCharCode(30),c.UNIT_SEP=String.fromCharCode(31),c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!s&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=g,c.ParserHandle=m,c.NetworkStreamer=f,c.FileStreamer=h,c.StringStreamer=p,c.ReadableStreamStreamer=x,n.jQuery&&((a=n.jQuery).fn.parse=function(k){var E=k.config||{},_=[];return this.each(function(D){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var M=0;M<this.files.length;M++)_.push({file:this.files[M],inputElem:this,instanceConfig:a.extend({},E)})}),C(),this;function C(){if(_.length===0)b(k.complete)&&k.complete();else{var D,M,B,q,Q=_[0];if(b(k.before)){var J=k.before(Q.file,Q.inputElem);if(typeof J=="object"){if(J.action==="abort")return D="AbortError",M=Q.file,B=Q.inputElem,q=J.reason,void(b(k.error)&&k.error({name:D},M,B,q));if(J.action==="skip")return void F();typeof J.config=="object"&&(Q.instanceConfig=a.extend(Q.instanceConfig,J.config))}else if(J==="skip")return void F()}var P=Q.instanceConfig.complete;Q.instanceConfig.complete=function(Z){b(P)&&P(Z,Q.file,Q.inputElem),F()},c.parse(Q.file,Q.instanceConfig)}}function F(){_.splice(0,1),C()}}),i&&(n.onmessage=function(k){k=k.data,c.WORKER_ID===void 0&&k&&(c.WORKER_ID=k.workerId),typeof k.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(k.input,k.config),finished:!0}):(n.File&&k.input instanceof File||k.input instanceof Object)&&(k=c.parse(k.input,k.config))&&n.postMessage({workerId:c.WORKER_ID,results:k,finished:!0})}),(f.prototype=Object.create(d.prototype)).constructor=f,(h.prototype=Object.create(d.prototype)).constructor=h,(p.prototype=Object.create(p.prototype)).constructor=p,(x.prototype=Object.create(d.prototype)).constructor=x,c})})(Dk);var aP=Dk.exports;const sP=Xh(aP);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jk=1252,iP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},vp=function(e){iP.indexOf(e)!=-1&&(jk=gp[0]=e)};function oP(){vp(1252)}var vn=function(e){vp(e)};function Ik(){vn(1200),oP()}function cg(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function lP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Ok(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Vo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?lP(e.slice(2)):t==254&&r==255?Ok(e.slice(2)):t==65279?e.slice(1):e},qc=function(t){return String.fromCharCode(t)},ug=function(t){return String.fromCharCode(t)},Ta,Ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dg(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Ua.charAt(s)+Ua.charAt(i)+Ua.charAt(o)+Ua.charAt(l);return t}function Vr(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Ua.indexOf(e.charAt(c++)),i=Ua.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Ua.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ua.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var He=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ni=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function as(e){return He?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function fg(e){return He?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var gn=function(t){return He?ni(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ai(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function yp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return yp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ca=He?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ni(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function cP(e){for(var t=[],r=0,n=e.length+250,a=as(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=as(65535),n=65530)}return t.push(a.slice(0,r)),Ca(t)}var vr=/\u0000/g,Ho=/[\u0001-\u0006]/g;function ji(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function yn(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}function wp(e,t){var r=""+e;return r.length>=t?r:gt(" ",t-r.length)+r}function l0(e,t){var r=""+e;return r.length>=t?r:r+gt(" ",t-r.length)}function uP(e,t){var r=""+Math.round(e);return r.length>=t?r:gt("0",t-r.length)+r}function dP(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}var hg=Math.pow(2,32);function ui(e,t){if(e>hg||e<-hg)return uP(e,t);var r=Math.round(e);return dP(r,t)}function c0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var mg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Kd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fP(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},pg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function u0(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,d=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*i+s,d=f*c+l,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=s):(d=c,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function _s(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=yP(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Mk=new Date(1899,11,31,0,0,0),mP=Mk.getTime(),pP=new Date(1900,2,1,0,0,0);function Lk(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=pP&&(r+=24*60*60*1e3),(r-(mP+(e.getTimezoneOffset()-Mk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function kp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xP(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gP(e){var t=e<0?12:11,r=kp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vP(e){var t=kp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ul(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=gP(e):t===10?r=e.toFixed(10).substr(0,12):r=vP(e),kp(xP(r.toUpperCase()))}function Qs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ul(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return on(14,Lk(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yP(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wP(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Kd[r.m-1][1];case 5:return Kd[r.m-1][0];default:return Kd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return mg[r.q][0];default:return mg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?yn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=yn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var d=c>0?yn(l,c):"";return d}function $a(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Bk=/%/g;function kP(e,t,r){var n=t.replace(Bk,""),a=t.length-n.length;return sa(e,n,r*Math.pow(10,2*a))+gt("%",a)}function SP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return sa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Uk(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Uk(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var $k=/# (\?+)( ?)\/( ?)(\d+)/;function EP(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?gt(" ",e[1].length+1+e[4].length):wp(i,e[1].length)+e[2]+"/"+e[3]+yn(o,e[4].length))}function _P(e,t,r){return r+(t===0?"":""+t)+gt(" ",e[1].length+2+e[4].length)}var zk=/^#*0*\.([0#]+)/,Vk=/\).*[0#]/,Hk=/\(###\) ###\\?-####/;function hr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function xg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function gg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function bP(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function TP(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Xr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Vk)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xr("n",n,r):"("+Xr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return SP(e,t,r);if(t.indexOf("%")!==-1)return kP(e,t,r);if(t.indexOf("E")!==-1)return Uk(t,r);if(t.charCodeAt(0)===36)return"$"+Xr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ui(l,t.length);if(t.match(/^[#?]+$/))return a=ui(r,0),a==="0"&&(a=""),a.length>t.length?a:hr(t.substr(0,t.length-a.length))+a;if(s=t.match($k))return EP(s,l,c);if(t.match(/^#+0+$/))return c+ui(l,t.length-t.indexOf("0"));if(s=t.match(zk))return a=xg(r,s[1].length).replace(/^([^\.]+)$/,"$1."+hr(s[1])).replace(/\.$/,"."+hr(s[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+gt("0",hr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+xg(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$a(ui(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xr(e,t,-r):$a(""+(Math.floor(r)+bP(r,s[1].length)))+"."+yn(gg(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Xr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ji(Xr(e,t.replace(/[\\-]/g,""),r)),i=0,ji(ji(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(t.match(Hk))return a=Xr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=u0(l,Math.pow(10,i)-1,!1),a=""+c,d=sa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=l0(o[2],i),d.length<s[4].length&&(d=hr(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=u0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?wp(o[1],i)+s[2]+"/"+s[3]+l0(o[2],i):gt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=ui(r,0),t.length<=a.length?a:hr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,h=t.length-a.length-f;return hr(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=gg(r,s[1].length),r<0?"-"+Xr(e,t,-r):$a(TP(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?yn(0,3-x.length):"")+x})+"."+yn(i,s[1].length);switch(t){case"###,##0.00":return Xr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=$a(ui(l,0));return p!=="0"?c+p:"";case"###,###.00":return Xr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Xr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function CP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return sa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function NP(e,t,r){var n=t.replace(Bk,""),a=t.length-n.length;return sa(e,n,r*Math.pow(10,2*a))+gt("%",a)}function Wk(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Wk(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,d){return l+c+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Vk)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fn("n",n,r):"("+Fn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CP(e,t,r);if(t.indexOf("%")!==-1)return NP(e,t,r);if(t.indexOf("E")!==-1)return Wk(t,r);if(t.charCodeAt(0)===36)return"$"+Fn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+yn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:hr(t.substr(0,t.length-a.length))+a;if(s=t.match($k))return _P(s,l,c);if(t.match(/^#+0+$/))return c+yn(l,t.length-t.indexOf("0"));if(s=t.match(zk))return a=(""+r).replace(/^([^\.]+)$/,"$1."+hr(s[1])).replace(/\.$/,"."+hr(s[1])),a=a.replace(/\.(\d*)$/,function(x,m){return"."+m+gt("0",hr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$a(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):$a(""+r)+"."+gt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Fn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ji(Fn(e,t.replace(/[\\-]/g,""),r)),i=0,ji(ji(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(t.match(Hk))return a=Fn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=u0(l,Math.pow(10,i)-1,!1),a=""+c,d=sa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=l0(o[2],i),d.length<s[4].length&&(d=hr(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=u0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?wp(o[1],i)+s[2]+"/"+s[3]+l0(o[2],i):gt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:hr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,h=t.length-a.length-f;return hr(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):$a(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?yn(0,3-x.length):"")+x})+"."+yn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=$a(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return Fn(e,t.slice(0,t.lastIndexOf(".")),r)+hr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function sa(e,t,r){return(r|0)===r?Fn(e,t,r):Xr(e,t,r)}function AP(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Kk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function vo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":c0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Kk))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function FP(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,d,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!c0(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";a[a.length]={t:x,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=_s(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=_s(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=_s(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Kk)){if(c==null&&(c=_s(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",vo(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var v=0,g=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",v<1&&(v=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(g=Math.max(g,y[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[i].v.match(/[Hh]/)&&(v=1),v<2&&a[i].v.match(/[Mm]/)&&(v=2),v<3&&a[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",S;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=wP(a[i].t.charCodeAt(0),a[i].v,c,g),a[i].t="t";break;case"n":case"?":for(S=i+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[i].v+=a[S].v,a[S]={v:"",t:";"},++S;w+=a[i].v,i=S-1;break;case"G":a[i].t="t",a[i].v=Qs(t,r);break}var A="",T,b;if(w.length>0){w.charCodeAt(0)==40?(T=t<0&&w.charCodeAt(0)===45?-t:t,b=sa("n",w,T)):(T=t<0&&n>1?-t:t,b=sa("n",w,T),T<0&&a[0]&&a[0].t=="t"&&(b=b.substr(1),a[0].v="-"+a[0].v)),S=b.length-1;var k=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){k=i;break}var E=a.length;if(k===a.length&&b.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(S>=a[i].v.length-1?(S-=a[i].v.length,a[i].v=b.substr(S+1,a[i].v.length)):S<0?a[i].v="":(a[i].v=b.substr(0,S+1),S=-1),a[i].t="t",E=i);S>=0&&E<a.length&&(a[E].v=b.substr(0,S+1)+a[E].v)}else if(k!==a.length&&b.indexOf("E")===-1){for(S=b.indexOf(".")-1,i=k;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(d=a[i].v.indexOf(".")>-1&&i===k?a[i].v.indexOf(".")-1:a[i].v.length-1,A=a[i].v.substr(d+1);d>=0;--d)S>=0&&(a[i].v.charAt(d)==="0"||a[i].v.charAt(d)==="#")&&(A=b.charAt(S--)+A);a[i].v=A,a[i].t="t",E=i}for(S>=0&&E<a.length&&(a[E].v=b.substr(0,S+1)+a[E].v),S=b.indexOf(".")+1,i=k;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==k)){for(d=a[i].v.indexOf(".")>-1&&i===k?a[i].v.indexOf(".")+1:0,A=a[i].v.substr(0,d);d<a[i].v.length;++d)S<b.length&&(A+=b.charAt(S++));a[i].v=A,a[i].t="t",E=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(T=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=sa(a[i].t,a[i].v,T),a[i].t="t");var _="";for(i=0;i!==a.length;++i)a[i]!=null&&(_+=a[i].v);return _}var vg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yg(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function PP(e,t){var r=AP(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(vg),o=r[1].match(vg);return yg(t,i)?[n,r[0]]:yg(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function on(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Me)[e],n==null&&(n=r.table&&r.table[pg[e]]||Me[pg[e]]),n==null&&(n=hP[e]||"General");break}if(c0(n,0))return Qs(t,r);t instanceof Date&&(t=Lk(t,r.date1904));var a=PP(n,t);if(c0(a[1]))return Qs(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return FP(a[1],t,r,a[0])}function $s(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Me[r]==null){t<0&&(t=r);continue}if(Me[r]==e){t=r;break}}t<0&&(t=391)}return Me[t]=e,t}function Gk(){Me=fP()}var RP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Yk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function DP(e){var t=typeof e=="number"?Me[e]:e;return t=t.replace(Yk,"(\\d+)"),new RegExp("^"+t+"$")}function jP(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(Yk)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:a=p;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?d:c+"T"+d}var IP=function(){var e={};e.version="1.2.0";function t(){for(var b=0,k=new Array(256),E=0;E!=256;++E)b=E,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,k[E]=b;return typeof Int32Array<"u"?new Int32Array(k):k}var r=t();function n(b){var k=0,E=0,_=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(_=0;_!=256;++_)C[_]=b[_];for(_=0;_!=256;++_)for(E=b[_],k=256+_;k<4096;k+=256)E=C[k]=E>>>8^b[E&255];var F=[];for(_=1;_!=16;++_)F[_-1]=typeof Int32Array<"u"?C.subarray(_*256,_*256+256):C.slice(_*256,_*256+256);return F}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],d=a[5],f=a[6],h=a[7],p=a[8],x=a[9],m=a[10],v=a[11],g=a[12],y=a[13],w=a[14];function S(b,k){for(var E=k^-1,_=0,C=b.length;_<C;)E=E>>>8^r[(E^b.charCodeAt(_++))&255];return~E}function A(b,k){for(var E=k^-1,_=b.length-15,C=0;C<_;)E=w[b[C++]^E&255]^y[b[C++]^E>>8&255]^g[b[C++]^E>>16&255]^v[b[C++]^E>>>24]^m[b[C++]]^x[b[C++]]^p[b[C++]]^h[b[C++]]^f[b[C++]]^d[b[C++]]^c[b[C++]]^l[b[C++]]^o[b[C++]]^i[b[C++]]^s[b[C++]]^r[b[C++]];for(_+=15;C<_;)E=E>>>8^r[(E^b[C++])&255];return~E}function T(b,k){for(var E=k^-1,_=0,C=b.length,F=0,D=0;_<C;)F=b.charCodeAt(_++),F<128?E=E>>>8^r[(E^F)&255]:F<2048?(E=E>>>8^r[(E^(192|F>>6&31))&255],E=E>>>8^r[(E^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,D=b.charCodeAt(_++)&1023,E=E>>>8^r[(E^(240|F>>8&7))&255],E=E>>>8^r[(E^(128|F>>2&63))&255],E=E>>>8^r[(E^(128|D>>6&15|(F&3)<<4))&255],E=E>>>8^r[(E^(128|D&63))&255]):(E=E>>>8^r[(E^(224|F>>12&15))&255],E=E>>>8^r[(E^(128|F>>6&63))&255],E=E>>>8^r[(E^(128|F&63))&255]);return~E}return e.table=r,e.bstr=S,e.buf=A,e.str=T,e}(),We=function(){var t={};t.version="1.2.1";function r(N,U){for(var j=N.split("/"),I=U.split("/"),z=0,H=0,te=Math.min(j.length,I.length);z<te;++z){if(H=j[z].length-I[z].length)return H;if(j[z]!=I[z])return j[z]<I[z]?-1:1}return j.length-I.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var U=N.lastIndexOf("/");return U===-1?N:N.slice(0,U+1)}function a(N){if(N.charAt(N.length-1)=="/")return a(N.slice(0,-1));var U=N.lastIndexOf("/");return U===-1?N:N.slice(U+1)}function s(N,U){typeof U=="string"&&(U=new Date(U));var j=U.getHours();j=j<<6|U.getMinutes(),j=j<<5|U.getSeconds()>>>1,N.write_shift(2,j);var I=U.getFullYear()-1980;I=I<<4|U.getMonth()+1,I=I<<5|U.getDate(),N.write_shift(2,I)}function i(N){var U=N.read_shift(2)&65535,j=N.read_shift(2)&65535,I=new Date,z=j&31;j>>>=5;var H=j&15;j>>>=4,I.setMilliseconds(0),I.setFullYear(j+1980),I.setMonth(H-1),I.setDate(z);var te=U&31;U>>>=5;var ce=U&63;return U>>>=6,I.setHours(U),I.setMinutes(ce),I.setSeconds(te<<1),I}function o(N){Ht(N,0);for(var U={},j=0;N.l<=N.length-4;){var I=N.read_shift(2),z=N.read_shift(2),H=N.l+z,te={};switch(I){case 21589:j=N.read_shift(1),j&1&&(te.mtime=N.read_shift(4)),z>5&&(j&2&&(te.atime=N.read_shift(4)),j&4&&(te.ctime=N.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}N.l=H,U[I]=te}return U}var l;function c(){return l||(l={})}function d(N,U){if(N[0]==80&&N[1]==75)return qp(N,U);if((N[0]|32)==109&&(N[1]|32)==105)return IE(N,U);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var j=3,I=512,z=0,H=0,te=0,ce=0,ee=0,re=[],ne=N.slice(0,512);Ht(ne,0);var fe=f(ne);switch(j=fe[0],j){case 3:I=512;break;case 4:I=4096;break;case 0:if(fe[1]==0)return qp(N,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}I!==512&&(ne=N.slice(0,I),Ht(ne,28));var pe=N.slice(0,I);h(ne,j);var ye=ne.read_shift(4,"i");if(j===3&&ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ye);ne.l+=4,te=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ce=ne.read_shift(4,"i"),z=ne.read_shift(4,"i"),ee=ne.read_shift(4,"i"),H=ne.read_shift(4,"i");for(var me=-1,ge=0;ge<109&&(me=ne.read_shift(4,"i"),!(me<0));++ge)re[ge]=me;var je=p(N,I);v(ee,H,je,I,re);var ut=y(je,te,re,I);ut[te].name="!Directory",z>0&&ce!==D&&(ut[ce].name="!MiniFAT"),ut[re[0]].name="!FAT",ut.fat_addrs=re,ut.ssz=I;var dt={},qt=[],So=[],Eo=[];w(te,ut,je,qt,z,dt,So,ce),x(So,Eo,qt),qt.shift();var _o={FileIndex:So,FullPaths:Eo};return U&&U.raw&&(_o.raw={header:pe,sectors:je}),_o}function f(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(M,"Header Signature: "),N.l+=16;var U=N.read_shift(2,"u");return[N.read_shift(2,"u"),U]}function h(N,U){var j=9;switch(N.l+=2,j=N.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function p(N,U){for(var j=Math.ceil(N.length/U)-1,I=[],z=1;z<j;++z)I[z-1]=N.slice(z*U,(z+1)*U);return I[j-1]=N.slice(j*U),I}function x(N,U,j){for(var I=0,z=0,H=0,te=0,ce=0,ee=j.length,re=[],ne=[];I<ee;++I)re[I]=ne[I]=I,U[I]=j[I];for(;ce<ne.length;++ce)I=ne[ce],z=N[I].L,H=N[I].R,te=N[I].C,re[I]===I&&(z!==-1&&re[z]!==z&&(re[I]=re[z]),H!==-1&&re[H]!==H&&(re[I]=re[H])),te!==-1&&(re[te]=I),z!==-1&&I!=re[I]&&(re[z]=re[I],ne.lastIndexOf(z)<ce&&ne.push(z)),H!==-1&&I!=re[I]&&(re[H]=re[I],ne.lastIndexOf(H)<ce&&ne.push(H));for(I=1;I<ee;++I)re[I]===I&&(H!==-1&&re[H]!==H?re[I]=re[H]:z!==-1&&re[z]!==z&&(re[I]=re[z]));for(I=1;I<ee;++I)if(N[I].type!==0){if(ce=I,ce!=re[ce])do ce=re[ce],U[I]=U[ce]+"/"+U[I];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[I]=-1}for(U[0]+="/",I=1;I<ee;++I)N[I].type!==2&&(U[I]+="/")}function m(N,U,j){for(var I=N.start,z=N.size,H=[],te=I;j&&z>0&&te>=0;)H.push(U.slice(te*F,te*F+F)),z-=F,te=xs(j,te*4);return H.length===0?Pt(0):Ca(H).slice(0,N.size)}function v(N,U,j,I,z){var H=D;if(N===D){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var te=j[N],ce=(I>>>2)-1;if(!te)return;for(var ee=0;ee<ce&&(H=xs(te,ee*4))!==D;++ee)z.push(H);v(xs(te,I-4),U-1,j,I,z)}}function g(N,U,j,I,z){var H=[],te=[];z||(z=[]);var ce=I-1,ee=0,re=0;for(ee=U;ee>=0;){z[ee]=!0,H[H.length]=ee,te.push(N[ee]);var ne=j[Math.floor(ee*4/I)];if(re=ee*4&ce,I<4+re)throw new Error("FAT boundary crossed: "+ee+" 4 "+I);if(!N[ne])break;ee=xs(N[ne],re)}return{nodes:H,data:Ag([te])}}function y(N,U,j,I){var z=N.length,H=[],te=[],ce=[],ee=[],re=I-1,ne=0,fe=0,pe=0,ye=0;for(ne=0;ne<z;++ne)if(ce=[],pe=ne+U,pe>=z&&(pe-=z),!te[pe]){ee=[];var me=[];for(fe=pe;fe>=0;){me[fe]=!0,te[fe]=!0,ce[ce.length]=fe,ee.push(N[fe]);var ge=j[Math.floor(fe*4/I)];if(ye=fe*4&re,I<4+ye)throw new Error("FAT boundary crossed: "+fe+" 4 "+I);if(!N[ge]||(fe=xs(N[ge],ye),me[fe]))break}H[pe]={nodes:ce,data:Ag([ee])}}return H}function w(N,U,j,I,z,H,te,ce){for(var ee=0,re=I.length?2:0,ne=U[N].data,fe=0,pe=0,ye;fe<ne.length;fe+=128){var me=ne.slice(fe,fe+128);Ht(me,64),pe=me.read_shift(2),ye=Tp(me,0,pe-re),I.push(ye);var ge={name:ye,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},je=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);je!==0&&(ge.ct=S(me,me.l-8));var ut=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);ut!==0&&(ge.mt=S(me,me.l-8)),ge.start=me.read_shift(4,"i"),ge.size=me.read_shift(4,"i"),ge.size<0&&ge.start<0&&(ge.size=ge.type=0,ge.start=D,ge.name=""),ge.type===5?(ee=ge.start,z>0&&ee!==D&&(U[ee].name="!StreamData")):ge.size>=4096?(ge.storage="fat",U[ge.start]===void 0&&(U[ge.start]=g(j,ge.start,U.fat_addrs,U.ssz)),U[ge.start].name=ge.name,ge.content=U[ge.start].data.slice(0,ge.size)):(ge.storage="minifat",ge.size<0?ge.size=0:ee!==D&&ge.start!==D&&U[ee]&&(ge.content=m(ge,U[ee].data,(U[ce]||{}).data))),ge.content&&Ht(ge.content,0),H[ye]=ge,te.push(ge)}}function S(N,U){return new Date((Or(N,U+4)/1e7*Math.pow(2,32)+Or(N,U)/1e7-11644473600)*1e3)}function A(N,U){return c(),d(l.readFileSync(N),U)}function T(N,U){var j=U&&U.type;switch(j||He&&Buffer.isBuffer(N)&&(j="buffer"),j||"base64"){case"file":return A(N,U);case"base64":return d(gn(Vr(N)),U);case"binary":return d(gn(N),U)}return d(N,U)}function b(N,U){var j=U||{},I=j.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=I+"/",N.FileIndex[0]={name:I,type:5}),j.CLSID&&(N.FileIndex[0].clsid=j.CLSID),k(N)}function k(N){var U="Sh33tJ5";if(!We.find(N,"/"+U)){var j=Pt(4);j[0]=55,j[1]=j[3]=50,j[2]=54,N.FileIndex.push({name:U,type:2,content:j,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+U),E(N)}}function E(N,U){b(N);for(var j=!1,I=!1,z=N.FullPaths.length-1;z>=0;--z){var H=N.FileIndex[z];switch(H.type){case 0:I?j=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(H.R*H.L*H.C)&&(j=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!U)){var te=new Date(1987,1,19),ce=0,ee=Object.create?Object.create(null):{},re=[];for(z=0;z<N.FullPaths.length;++z)ee[N.FullPaths[z]]=!0,N.FileIndex[z].type!==0&&re.push([N.FullPaths[z],N.FileIndex[z]]);for(z=0;z<re.length;++z){var ne=n(re[z][0]);I=ee[ne],I||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:q,ct:te,mt:te,content:null}]),ee[ne]=!0)}for(re.sort(function(ye,me){return r(ye[0],me[0])}),N.FullPaths=[],N.FileIndex=[],z=0;z<re.length;++z)N.FullPaths[z]=re[z][0],N.FileIndex[z]=re[z][1];for(z=0;z<re.length;++z){var fe=N.FileIndex[z],pe=N.FullPaths[z];if(fe.name=a(pe).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||q,z===0)fe.C=re.length>1?1:-1,fe.size=0,fe.type=5;else if(pe.slice(-1)=="/"){for(ce=z+1;ce<re.length&&n(N.FullPaths[ce])!=pe;++ce);for(fe.C=ce>=re.length?-1:ce,ce=z+1;ce<re.length&&n(N.FullPaths[ce])!=n(pe);++ce);fe.R=ce>=re.length?-1:ce,fe.type=1}else n(N.FullPaths[z+1]||"")==n(pe)&&(fe.R=z+1),fe.type=2}}}function _(N,U){var j=U||{};if(j.fileType=="mad")return OE(N,j);switch(E(N),j.fileType){case"zip":return AE(N,j)}var I=function(ye){for(var me=0,ge=0,je=0;je<ye.FileIndex.length;++je){var ut=ye.FileIndex[je];if(ut.content){var dt=ut.content.length;dt>0&&(dt<4096?me+=dt+63>>6:ge+=dt+511>>9)}}for(var qt=ye.FullPaths.length+3>>2,So=me+7>>3,Eo=me+127>>7,_o=So+ge+qt+Eo,fs=_o+127>>7,id=fs<=109?0:Math.ceil((fs-109)/127);_o+fs+id+127>>7>fs;)id=++fs<=109?0:Math.ceil((fs-109)/127);var Gn=[1,id,fs,Eo,qt,ge,me,0];return ye.FileIndex[0].size=me<<6,Gn[7]=(ye.FileIndex[0].start=Gn[0]+Gn[1]+Gn[2]+Gn[3]+Gn[4]+Gn[5])+(Gn[6]+7>>3),Gn}(N),z=Pt(I[7]<<9),H=0,te=0;{for(H=0;H<8;++H)z.write_shift(1,B[H]);for(H=0;H<8;++H)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),H=0;H<3;++H)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,I[2]),z.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:D),z.write_shift(4,I[3]),z.write_shift(-4,I[1]?I[0]-1:D),z.write_shift(4,I[1]),H=0;H<109;++H)z.write_shift(-4,H<I[2]?I[1]+H:-1)}if(I[1])for(te=0;te<I[1];++te){for(;H<236+te*127;++H)z.write_shift(-4,H<I[2]?I[1]+H:-1);z.write_shift(-4,te===I[1]-1?D:te+1)}var ce=function(ye){for(te+=ye;H<te-1;++H)z.write_shift(-4,H+1);ye&&(++H,z.write_shift(-4,D))};for(te=H=0,te+=I[1];H<te;++H)z.write_shift(-4,Q.DIFSECT);for(te+=I[2];H<te;++H)z.write_shift(-4,Q.FATSECT);ce(I[3]),ce(I[4]);for(var ee=0,re=0,ne=N.FileIndex[0];ee<N.FileIndex.length;++ee)ne=N.FileIndex[ee],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=te,ce(re+511>>9)));for(ce(I[6]+7>>3);z.l&511;)z.write_shift(-4,Q.ENDOFCHAIN);for(te=H=0,ee=0;ee<N.FileIndex.length;++ee)ne=N.FileIndex[ee],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=te,ce(re+63>>6)));for(;z.l&511;)z.write_shift(-4,Q.ENDOFCHAIN);for(H=0;H<I[4]<<2;++H){var fe=N.FullPaths[H];if(!fe||fe.length===0){for(ee=0;ee<17;++ee)z.write_shift(4,0);for(ee=0;ee<3;++ee)z.write_shift(4,-1);for(ee=0;ee<12;++ee)z.write_shift(4,0);continue}ne=N.FileIndex[H],H===0&&(ne.start=ne.size?ne.start-1:D);var pe=H===0&&j.root||ne.name;if(re=2*(pe.length+1),z.write_shift(64,pe,"utf16le"),z.write_shift(2,re),z.write_shift(1,ne.type),z.write_shift(1,ne.color),z.write_shift(-4,ne.L),z.write_shift(-4,ne.R),z.write_shift(-4,ne.C),ne.clsid)z.write_shift(16,ne.clsid,"hex");else for(ee=0;ee<4;++ee)z.write_shift(4,0);z.write_shift(4,ne.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,ne.start),z.write_shift(4,ne.size),z.write_shift(4,0)}for(H=1;H<N.FileIndex.length;++H)if(ne=N.FileIndex[H],ne.size>=4096)if(z.l=ne.start+1<<9,He&&Buffer.isBuffer(ne.content))ne.content.copy(z,z.l,0,ne.size),z.l+=ne.size+511&-512;else{for(ee=0;ee<ne.size;++ee)z.write_shift(1,ne.content[ee]);for(;ee&511;++ee)z.write_shift(1,0)}for(H=1;H<N.FileIndex.length;++H)if(ne=N.FileIndex[H],ne.size>0&&ne.size<4096)if(He&&Buffer.isBuffer(ne.content))ne.content.copy(z,z.l,0,ne.size),z.l+=ne.size+63&-64;else{for(ee=0;ee<ne.size;++ee)z.write_shift(1,ne.content[ee]);for(;ee&63;++ee)z.write_shift(1,0)}if(He)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function C(N,U){var j=N.FullPaths.map(function(ee){return ee.toUpperCase()}),I=j.map(function(ee){var re=ee.split("/");return re[re.length-(ee.slice(-1)=="/"?2:1)]}),z=!1;U.charCodeAt(0)===47?(z=!0,U=j[0].slice(0,-1)+U):z=U.indexOf("/")!==-1;var H=U.toUpperCase(),te=z===!0?j.indexOf(H):I.indexOf(H);if(te!==-1)return N.FileIndex[te];var ce=!H.match(Ho);for(H=H.replace(vr,""),ce&&(H=H.replace(Ho,"!")),te=0;te<j.length;++te)if((ce?j[te].replace(Ho,"!"):j[te]).replace(vr,"")==H||(ce?I[te].replace(Ho,"!"):I[te]).replace(vr,"")==H)return N.FileIndex[te];return null}var F=64,D=-2,M="d0cf11e0a1b11ae1",B=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(N,U,j){c();var I=_(N,j);l.writeFileSync(U,I)}function P(N){for(var U=new Array(N.length),j=0;j<N.length;++j)U[j]=String.fromCharCode(N[j]);return U.join("")}function Z(N,U){var j=_(N,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,j),j;case"binary":return typeof j=="string"?j:P(j);case"base64":return dg(typeof j=="string"?j:P(j));case"buffer":if(He)return Buffer.isBuffer(j)?j:ni(j);case"array":return typeof j=="string"?gn(j):j}return j}var le;function R(N){try{var U=N.InflateRaw,j=new U;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)le=N;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function G(N,U){if(!le)return Yp(N,U);var j=le.InflateRaw,I=new j,z=I._processChunk(N.slice(N.l),I._finishFlushFlag);return N.l+=I.bytesRead,z}function W(N){return le?le.deflateRawSync(N):Be(N)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(N){var U=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(U>>16|U>>8|U)&255}for(var ie=typeof Uint8Array<"u",oe=ie?new Uint8Array(256):[],ue=0;ue<256;++ue)oe[ue]=se(ue);function L(N,U){var j=oe[N&255];return U<=8?j>>>8-U:(j=j<<8|oe[N>>8&255],U<=16?j>>>16-U:(j=j<<8|oe[N>>16&255],j>>>24-U))}function Pe(N,U){var j=U&7,I=U>>>3;return(N[I]|(j<=6?0:N[I+1]<<8))>>>j&3}function ke(N,U){var j=U&7,I=U>>>3;return(N[I]|(j<=5?0:N[I+1]<<8))>>>j&7}function Se(N,U){var j=U&7,I=U>>>3;return(N[I]|(j<=4?0:N[I+1]<<8))>>>j&15}function xe(N,U){var j=U&7,I=U>>>3;return(N[I]|(j<=3?0:N[I+1]<<8))>>>j&31}function de(N,U){var j=U&7,I=U>>>3;return(N[I]|(j<=1?0:N[I+1]<<8))>>>j&127}function be(N,U,j){var I=U&7,z=U>>>3,H=(1<<j)-1,te=N[z]>>>I;return j<8-I||(te|=N[z+1]<<8-I,j<16-I)||(te|=N[z+2]<<16-I,j<24-I)||(te|=N[z+3]<<24-I),te&H}function Oe(N,U,j){var I=U&7,z=U>>>3;return I<=5?N[z]|=(j&7)<<I:(N[z]|=j<<I&255,N[z+1]=(j&7)>>8-I),U+3}function $e(N,U,j){var I=U&7,z=U>>>3;return j=(j&1)<<I,N[z]|=j,U+1}function At(N,U,j){var I=U&7,z=U>>>3;return j<<=I,N[z]|=j&255,j>>>=8,N[z+1]=j,U+8}function Ft(N,U,j){var I=U&7,z=U>>>3;return j<<=I,N[z]|=j&255,j>>>=8,N[z+1]=j&255,N[z+2]=j>>>8,U+16}function De(N,U){var j=N.length,I=2*j>U?2*j:U+5,z=0;if(j>=U)return N;if(He){var H=fg(I);if(N.copy)N.copy(H);else for(;z<N.length;++z)H[z]=N[z];return H}else if(ie){var te=new Uint8Array(I);if(te.set)te.set(N);else for(;z<j;++z)te[z]=N[z];return te}return N.length=I,N}function Ce(N){for(var U=new Array(N),j=0;j<N;++j)U[j]=0;return U}function Xe(N,U,j){var I=1,z=0,H=0,te=0,ce=0,ee=N.length,re=ie?new Uint16Array(32):Ce(32);for(H=0;H<32;++H)re[H]=0;for(H=ee;H<j;++H)N[H]=0;ee=N.length;var ne=ie?new Uint16Array(ee):Ce(ee);for(H=0;H<ee;++H)re[z=N[H]]++,I<z&&(I=z),ne[H]=0;for(re[0]=0,H=1;H<=I;++H)re[H+16]=ce=ce+re[H-1]<<1;for(H=0;H<ee;++H)ce=N[H],ce!=0&&(ne[H]=re[ce+16]++);var fe=0;for(H=0;H<ee;++H)if(fe=N[H],fe!=0)for(ce=L(ne[H],I)>>I-fe,te=(1<<I+4-fe)-1;te>=0;--te)U[ce|te<<fe]=fe&15|H<<4;return I}var qe=ie?new Uint16Array(512):Ce(512),St=ie?new Uint16Array(32):Ce(32);if(!ie){for(var rt=0;rt<512;++rt)qe[rt]=0;for(rt=0;rt<32;++rt)St[rt]=0}(function(){for(var N=[],U=0;U<32;U++)N.push(5);Xe(N,St,32);var j=[];for(U=0;U<=143;U++)j.push(8);for(;U<=255;U++)j.push(9);for(;U<=279;U++)j.push(7);for(;U<=287;U++)j.push(8);Xe(j,qe,288)})();var Sr=function(){for(var U=ie?new Uint8Array(32768):[],j=0,I=0;j<X.length-1;++j)for(;I<X[j+1];++I)U[I]=j;for(;I<32768;++I)U[I]=29;var z=ie?new Uint8Array(259):[];for(j=0,I=0;j<O.length-1;++j)for(;I<O[j+1];++I)z[I]=j;function H(ce,ee){for(var re=0;re<ce.length;){var ne=Math.min(65535,ce.length-re),fe=re+ne==ce.length;for(ee.write_shift(1,+fe),ee.write_shift(2,ne),ee.write_shift(2,~ne&65535);ne-- >0;)ee[ee.l++]=ce[re++]}return ee.l}function te(ce,ee){for(var re=0,ne=0,fe=ie?new Uint16Array(32768):[];ne<ce.length;){var pe=Math.min(65535,ce.length-ne);if(pe<10){for(re=Oe(ee,re,+(ne+pe==ce.length)),re&7&&(re+=8-(re&7)),ee.l=re/8|0,ee.write_shift(2,pe),ee.write_shift(2,~pe&65535);pe-- >0;)ee[ee.l++]=ce[ne++];re=ee.l*8;continue}re=Oe(ee,re,+(ne+pe==ce.length)+2);for(var ye=0;pe-- >0;){var me=ce[ne];ye=(ye<<5^me)&32767;var ge=-1,je=0;if((ge=fe[ye])&&(ge|=ne&-32768,ge>ne&&(ge-=32768),ge<ne))for(;ce[ge+je]==ce[ne+je]&&je<250;)++je;if(je>2){me=z[je],me<=22?re=At(ee,re,oe[me+1]>>1)-1:(At(ee,re,3),re+=5,At(ee,re,oe[me-23]>>5),re+=3);var ut=me<8?0:me-4>>2;ut>0&&(Ft(ee,re,je-O[me]),re+=ut),me=U[ne-ge],re=At(ee,re,oe[me]>>3),re-=3;var dt=me<4?0:me-2>>1;dt>0&&(Ft(ee,re,ne-ge-X[me]),re+=dt);for(var qt=0;qt<je;++qt)fe[ye]=ne&32767,ye=(ye<<5^ce[ne])&32767,++ne;pe-=je-1}else me<=143?me=me+48:re=$e(ee,re,1),re=At(ee,re,oe[me]),fe[ye]=ne&32767,++ne}re=At(ee,re,0)-1}return ee.l=(re+7)/8|0,ee.l}return function(ee,re){return ee.length<8?H(ee,re):te(ee,re)}}();function Be(N){var U=Pt(50+Math.floor(N.length*1.1)),j=Sr(N,U);return U.slice(0,j)}var Je=ie?new Uint16Array(32768):Ce(32768),ct=ie?new Uint16Array(32768):Ce(32768),nt=ie?new Uint16Array(128):Ce(128),Tn=1,Gp=1;function TE(N,U){var j=xe(N,U)+257;U+=5;var I=xe(N,U)+1;U+=5;var z=Se(N,U)+4;U+=4;for(var H=0,te=ie?new Uint8Array(19):Ce(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,re=ie?new Uint8Array(8):Ce(8),ne=ie?new Uint8Array(8):Ce(8),fe=te.length,pe=0;pe<z;++pe)te[K[pe]]=H=ke(N,U),ee<H&&(ee=H),re[H]++,U+=3;var ye=0;for(re[0]=0,pe=1;pe<=ee;++pe)ne[pe]=ye=ye+re[pe-1]<<1;for(pe=0;pe<fe;++pe)(ye=te[pe])!=0&&(ce[pe]=ne[ye]++);var me=0;for(pe=0;pe<fe;++pe)if(me=te[pe],me!=0){ye=oe[ce[pe]]>>8-me;for(var ge=(1<<7-me)-1;ge>=0;--ge)nt[ye|ge<<me]=me&7|pe<<3}var je=[];for(ee=1;je.length<j+I;)switch(ye=nt[de(N,U)],U+=ye&7,ye>>>=3){case 16:for(H=3+Pe(N,U),U+=2,ye=je[je.length-1];H-- >0;)je.push(ye);break;case 17:for(H=3+ke(N,U),U+=3;H-- >0;)je.push(0);break;case 18:for(H=11+de(N,U),U+=7;H-- >0;)je.push(0);break;default:je.push(ye),ee<ye&&(ee=ye);break}var ut=je.slice(0,j),dt=je.slice(j);for(pe=j;pe<286;++pe)ut[pe]=0;for(pe=I;pe<30;++pe)dt[pe]=0;return Tn=Xe(ut,Je,286),Gp=Xe(dt,ct,30),U}function CE(N,U){if(N[0]==3&&!(N[1]&3))return[as(U),2];for(var j=0,I=0,z=fg(U||1<<18),H=0,te=z.length>>>0,ce=0,ee=0;!(I&1);){if(I=ke(N,j),j+=3,I>>>1)I>>1==1?(ce=9,ee=5):(j=TE(N,j),ce=Tn,ee=Gp);else{j&7&&(j+=8-(j&7));var re=N[j>>>3]|N[(j>>>3)+1]<<8;if(j+=32,re>0)for(!U&&te<H+re&&(z=De(z,H+re),te=z.length);re-- >0;)z[H++]=N[j>>>3],j+=8;continue}for(;;){!U&&te<H+32767&&(z=De(z,H+32767),te=z.length);var ne=be(N,j,ce),fe=I>>>1==1?qe[ne]:Je[ne];if(j+=fe&15,fe>>>=4,!(fe>>>8&255))z[H++]=fe;else{if(fe==256)break;fe-=257;var pe=fe<8?0:fe-4>>2;pe>5&&(pe=0);var ye=H+O[fe];pe>0&&(ye+=be(N,j,pe),j+=pe),ne=be(N,j,ee),fe=I>>>1==1?St[ne]:ct[ne],j+=fe&15,fe>>>=4;var me=fe<4?0:fe-2>>1,ge=X[fe];for(me>0&&(ge+=be(N,j,me),j+=me),!U&&te<ye&&(z=De(z,ye+100),te=z.length);H<ye;)z[H]=z[H-ge],++H}}}return U?[z,j+7>>>3]:[z.slice(0,H),j+7>>>3]}function Yp(N,U){var j=N.slice(N.l||0),I=CE(j,U);return N.l+=I[1],I[0]}function Xp(N,U){if(N)typeof console<"u"&&console.error(U);else throw new Error(U)}function qp(N,U){var j=N;Ht(j,0);var I=[],z=[],H={FileIndex:I,FullPaths:z};b(H,{root:U.root});for(var te=j.length-4;(j[te]!=80||j[te+1]!=75||j[te+2]!=5||j[te+3]!=6)&&te>=0;)--te;j.l=te+4,j.l+=4;var ce=j.read_shift(2);j.l+=6;var ee=j.read_shift(4);for(j.l=ee,te=0;te<ce;++te){j.l+=20;var re=j.read_shift(4),ne=j.read_shift(4),fe=j.read_shift(2),pe=j.read_shift(2),ye=j.read_shift(2);j.l+=8;var me=j.read_shift(4),ge=o(j.slice(j.l+fe,j.l+fe+pe));j.l+=fe+pe+ye;var je=j.l;j.l=me+4,NE(j,re,ne,H,ge),j.l=je}return H}function NE(N,U,j,I,z){N.l+=2;var H=N.read_shift(2),te=N.read_shift(2),ce=i(N);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var ee=N.read_shift(4),re=N.read_shift(4),ne=N.read_shift(4),fe=N.read_shift(2),pe=N.read_shift(2),ye="",me=0;me<fe;++me)ye+=String.fromCharCode(N[N.l++]);if(pe){var ge=o(N.slice(N.l,N.l+pe));(ge[21589]||{}).mt&&(ce=ge[21589].mt),((z||{})[21589]||{}).mt&&(ce=z[21589].mt)}N.l+=pe;var je=N.slice(N.l,N.l+re);switch(te){case 8:je=G(N,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var ut=!1;H&8&&(ee=N.read_shift(4),ee==134695760&&(ee=N.read_shift(4),ut=!0),re=N.read_shift(4),ne=N.read_shift(4)),re!=U&&Xp(ut,"Bad compressed size: "+U+" != "+re),ne!=j&&Xp(ut,"Bad uncompressed size: "+j+" != "+ne),sd(I,ye,je,{unsafe:!0,mt:ce})}function AE(N,U){var j=U||{},I=[],z=[],H=Pt(1),te=j.compression?8:0,ce=0,ee=0,re=0,ne=0,fe=0,pe=N.FullPaths[0],ye=pe,me=N.FileIndex[0],ge=[],je=0;for(ee=1;ee<N.FullPaths.length;++ee)if(ye=N.FullPaths[ee].slice(pe.length),me=N.FileIndex[ee],!(!me.size||!me.content||ye=="Sh33tJ5")){var ut=ne,dt=Pt(ye.length);for(re=0;re<ye.length;++re)dt.write_shift(1,ye.charCodeAt(re)&127);dt=dt.slice(0,dt.l),ge[fe]=IP.buf(me.content,0);var qt=me.content;te==8&&(qt=W(qt)),H=Pt(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ce),H.write_shift(2,te),me.mt?s(H,me.mt):H.write_shift(4,0),H.write_shift(-4,ge[fe]),H.write_shift(4,qt.length),H.write_shift(4,me.content.length),H.write_shift(2,dt.length),H.write_shift(2,0),ne+=H.length,I.push(H),ne+=dt.length,I.push(dt),ne+=qt.length,I.push(qt),H=Pt(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ce),H.write_shift(2,te),H.write_shift(4,0),H.write_shift(-4,ge[fe]),H.write_shift(4,qt.length),H.write_shift(4,me.content.length),H.write_shift(2,dt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,ut),je+=H.l,z.push(H),je+=dt.length,z.push(dt),++fe}return H=Pt(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,fe),H.write_shift(2,fe),H.write_shift(4,je),H.write_shift(4,ne),H.write_shift(2,0),Ca([Ca(I),Ca(z),H])}var Ec={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function FE(N,U){if(N.ctype)return N.ctype;var j=N.name||"",I=j.match(/\.([^\.]+)$/);return I&&Ec[I[1]]||U&&(I=(j=U).match(/[\.\\]([^\.\\])+$/),I&&Ec[I[1]])?Ec[I[1]]:"application/octet-stream"}function PE(N){for(var U=dg(N),j=[],I=0;I<U.length;I+=76)j.push(U.slice(I,I+76));return j.join(`\r
`)+`\r
`}function RE(N){var U=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],I=U.split(`\r
`),z=0;z<I.length;++z){var H=I[z];if(H.length==0){j.push("");continue}for(var te=0;te<H.length;){var ce=76,ee=H.slice(te,te+ce);ee.charAt(ce-1)=="="?ce--:ee.charAt(ce-2)=="="?ce-=2:ee.charAt(ce-3)=="="&&(ce-=3),ee=H.slice(te,te+ce),te+=ce,te<H.length&&(ee+="="),j.push(ee)}}return j.join(`\r
`)}function DE(N){for(var U=[],j=0;j<N.length;++j){for(var I=N[j];j<=N.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+N[++j];U.push(I)}for(var z=0;z<U.length;++z)U[z]=U[z].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return gn(U.join(`\r
`))}function jE(N,U,j){for(var I="",z="",H="",te,ce=0;ce<10;++ce){var ee=U[ce];if(!ee||ee.match(/^\s*$/))break;var re=ee.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":I=re[2].trim();break;case"content-type":H=re[2].trim();break;case"content-transfer-encoding":z=re[2].trim();break}}switch(++ce,z.toLowerCase()){case"base64":te=gn(Vr(U.slice(ce).join("")));break;case"quoted-printable":te=DE(U.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var ne=sd(N,I.slice(j.length),te,{unsafe:!0});H&&(ne.ctype=H)}function IE(N,U){if(P(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=U&&U.root||"",I=(He&&Buffer.isBuffer(N)?N.toString("binary"):P(N)).split(`\r
`),z=0,H="";for(z=0;z<I.length;++z)if(H=I[z],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),j||(j=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),H.slice(0,j.length)!=j););var te=(I[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var ce="--"+(te[1]||""),ee=[],re=[],ne={FileIndex:ee,FullPaths:re};b(ne);var fe,pe=0;for(z=0;z<I.length;++z){var ye=I[z];ye!==ce&&ye!==ce+"--"||(pe++&&jE(ne,I.slice(fe,z),j),fe=z)}return ne}function OE(N,U){var j=U||{},I=j.boundary||"SheetJS";I="------="+I;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],H=N.FullPaths[0],te=H,ce=N.FileIndex[0],ee=1;ee<N.FullPaths.length;++ee)if(te=N.FullPaths[ee].slice(H.length),ce=N.FileIndex[ee],!(!ce.size||!ce.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(je){return"_x"+je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(je){return"_u"+je.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,ne=He&&Buffer.isBuffer(re)?re.toString("binary"):P(re),fe=0,pe=Math.min(1024,ne.length),ye=0,me=0;me<=pe;++me)(ye=ne.charCodeAt(me))>=32&&ye<128&&++fe;var ge=fe>=pe*4/5;z.push(I),z.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+te),z.push("Content-Transfer-Encoding: "+(ge?"quoted-printable":"base64")),z.push("Content-Type: "+FE(ce,te)),z.push(""),z.push(ge?RE(ne):PE(ne))}return z.push(I+`--\r
`),z.join(`\r
`)}function ME(N){var U={};return b(U,N),U}function sd(N,U,j,I){var z=I&&I.unsafe;z||b(N);var H=!z&&We.find(N,U);if(!H){var te=N.FullPaths[0];U.slice(0,te.length)==te?te=U:(te.slice(-1)!="/"&&(te+="/"),te=(te+U).replace("//","/")),H={name:a(U),type:2},N.FileIndex.push(H),N.FullPaths.push(te),z||We.utils.cfb_gc(N)}return H.content=j,H.size=j?j.length:0,I&&(I.CLSID&&(H.clsid=I.CLSID),I.mt&&(H.mt=I.mt),I.ct&&(H.ct=I.ct)),H}function LE(N,U){b(N);var j=We.find(N,U);if(j){for(var I=0;I<N.FileIndex.length;++I)if(N.FileIndex[I]==j)return N.FileIndex.splice(I,1),N.FullPaths.splice(I,1),!0}return!1}function BE(N,U,j){b(N);var I=We.find(N,U);if(I){for(var z=0;z<N.FileIndex.length;++z)if(N.FileIndex[z]==I)return N.FileIndex[z].name=a(j),N.FullPaths[z]=j,!0}return!1}function UE(N){E(N,!0)}return t.find=C,t.read=T,t.parse=d,t.write=Z,t.writeFile=J,t.utils={cfb_new:ME,cfb_add:sd,cfb_del:LE,cfb_mov:BE,cfb_gc:UE,ReadShift:ol,CheckField:gS,prep_blob:Ht,bconcat:Ca,use_zlib:R,_deflateRaw:Be,_inflateRaw:Yp,consts:Q},t}();function OP(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Hn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Sp(e){for(var t=[],r=Hn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var d0=new Date(1899,11,30,0,0,0);function yr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=d0.getTime()+(e.getTimezoneOffset()-d0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Xk=new Date,MP=d0.getTime()+(Xk.getTimezoneOffset()-d0.getTimezoneOffset())*6e4,wg=Xk.getTimezoneOffset();function Z0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+MP),t.getTimezoneOffset()!==wg&&t.setTime(t.getTime()+(t.getTimezoneOffset()-wg)*6e4),t}function LP(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var kg=new Date("2017-02-19T19:06:09.000Z"),qk=isNaN(kg.getFullYear())?new Date("2/19/17"):kg,BP=qk.getFullYear()==2017;function $t(e,t){var r=new Date(e);if(BP)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(qk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Js(e,t){if(He&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ko(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ko(Ok(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ko(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ko(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Gt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Gt(e[r]));return t}function gt(e,t){for(var r="";r.length<t;)r+=e;return r}function En(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var UP=["january","february","march","april","may","june","july","august","september","october","november","december"];function lo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&UP.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var $P=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function Qk(e){return e?e.content&&e.type?Js(e.content,!0):e.data?Vo(e.data):e.asNodeBuffer&&He?Vo(e.asNodeBuffer().toString("binary")):e.asBinary?Vo(e.asBinary()):e._data&&e._data.getContent?Vo(Js(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Jk(e){if(!e)return null;if(e.data)return cg(e.data);if(e.asNodeBuffer&&He)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?cg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function zP(e){return e&&e.name.slice(-4)===".bin"?Jk(e):Qk(e)}function Qr(e,t){for(var r=e.FullPaths||Hn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Ep(e,t){var r=Qr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function _t(e,t,r){if(!r)return zP(Ep(e,t));if(!t)return null;try{return _t(e,t)}catch{return null}}function Lr(e,t,r){if(!r)return Qk(Ep(e,t));if(!t)return null;try{return Lr(e,t)}catch{return null}}function Zk(e,t,r){if(!r)return Jk(Ep(e,t));if(!t)return null;try{return Zk(e,t)}catch{return null}}function Sg(e){for(var t=e.FullPaths||Hn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function VP(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return He?n=ni(r):n=cP(r),We.utils.cfb_add(e,t,n)}We.utils.cfb_add(e,t,r)}else e.file(t,r)}function eS(e,t){switch(t.type){case"base64":return We.read(e,{type:"base64"});case"binary":return We.read(e,{type:"binary"});case"buffer":case"array":return We.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Wo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var tS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Eg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,WP=/<[^>]*>/g,cr=tS.match(Eg)?Eg:WP,KP=/<\w*:/,GP=/<(\/?)\w+:/;function Ne(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(HP),o=0,l="",c=0,d="",f="",h=1;if(i)for(c=0;c!=i.length;++c){for(f=i[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(a=f.charCodeAt(s+1))==34||a==39?1:0,l=f.slice(s+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,r||(n[d.toLowerCase()]=l);else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=l,r||(n[p.toLowerCase()]=l)}}return n}function Wn(e){return e.replace(GP,"<$1")}var rS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},YP=Sp(rS),Ye=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return rS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),XP=/[&<>'"]/g,qP=/[\u0000-\u001f]/g;function _p(e){var t=e+"";return t.replace(XP,function(r){return YP[r]}).replace(/\n/g,"<br/>").replace(qP,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var _g=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function ot(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gd(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function bg(e){var t=as(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Tg(e){return ni(e,"binary").toString("utf8")}var Qc="foo bar baz",tt=He&&(Tg(Qc)==Gd(Qc)&&Tg||bg(Qc)==Gd(Qc)&&bg)||Gd,Ko=He?function(e){return ni(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$l=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),nS=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),QP=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),JP=/<\/?(?:vt:)?variant>/g,ZP=/<(?:vt:)([^>]*)>([\s\S]*)</;function Cg(e,t){var r=Ne(e),n=e.match(QP(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(JP,"").match(ZP);i&&a.push({v:tt(i[2]),t:i[1]})}),a}var eR=/(^\s|\s$|\n)/;function tR(e){return Hn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function rR(e,t,r){return"<"+e+(r!=null?tR(r):"")+(t!=null?(t.match(eR)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function bp(e){if(He&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return tt(ai(yp(e)));throw new Error("Bad input format: expected Buffer or string")}var zl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,nR={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},aR=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function sR(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function iR(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Ng=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Ag=He?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ni(t)})):Ng(e)}:Ng,Fg=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ra(e,a)));return n.join("").replace(vr,"")},Tp=He?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(vr,""):Fg(e,t,r)}:Fg,Pg=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},aS=He?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Pg(e,t,r)}:Pg,Rg=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(fi(e,a)));return n.join("")},gc=He?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Rg(t,r,n)}:Rg,sS=function(e,t){var r=Or(e,t);return r>0?gc(e,t+4,t+4+r-1):""},iS=sS,oS=function(e,t){var r=Or(e,t);return r>0?gc(e,t+4,t+4+r-1):""},lS=oS,cS=function(e,t){var r=2*Or(e,t);return r>0?gc(e,t+4,t+4+r-1):""},uS=cS,dS=function(t,r){var n=Or(t,r);return n>0?Tp(t,r+4,r+4+n):""},fS=dS,hS=function(e,t){var r=Or(e,t);return r>0?gc(e,t+4,t+4+r):""},mS=hS,pS=function(e,t){return sR(e,t)},f0=pS,xS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};He&&(iS=function(t,r){if(!Buffer.isBuffer(t))return sS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},lS=function(t,r){if(!Buffer.isBuffer(t))return oS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},uS=function(t,r){if(!Buffer.isBuffer(t))return cS(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},fS=function(t,r){if(!Buffer.isBuffer(t))return dS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},mS=function(t,r){if(!Buffer.isBuffer(t))return hS(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},f0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):pS(t,r)},xS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var fi=function(e,t){return e[t]},ra=function(e,t){return e[t+1]*256+e[t]},oR=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Or=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},xs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lR=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ol(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,He&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ra(this,c)),c+=2;e*=2;break;case"utf8":r=gc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Tp(this,this.l,this.l+e);break;case"wstr":return ol.call(this,e,"dbcs");case"lpstr-ansi":r=iS(this,this.l),e=4+Or(this,this.l);break;case"lpstr-cp":r=lS(this,this.l),e=4+Or(this,this.l);break;case"lpwstr":r=uS(this,this.l),e=4+2*Or(this,this.l);break;case"lpp4":e=4+Or(this,this.l),r=fS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Or(this,this.l),r=mS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=fi(this,this.l+e++))!==0;)s.push(qc(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=ra(this,this.l+e))!==0;)s.push(qc(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=fi(this,c),this.l=c+1,o=ol.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(qc(ra(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=fi(this,c),this.l=c+1,o=ol.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(qc(fi(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=fi(this,this.l),this.l++,n;case 2:return n=(t==="i"?oR:ra)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?xs:lR)(this,this.l),this.l+=4,n):(a=Or(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=f0(this,this.l):a=f0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=aS(this,this.l,e);break}}return this.l+=e,r}var cR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},uR=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},dR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fR(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)dR(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,cR(this,t,this.l);break;case 8:if(n=8,r==="f"){iR(this,t,this.l);break}case 16:break;case-4:n=4,uR(this,t,this.l);break}return this.l+=n,this}function gS(e,t){var r=aS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ht(e,t){e.l=t,e.read_shift=ol,e.chk=gS,e.write_shift=fR}function lr(e,t){e.l+=t}function Pt(e){var t=as(e);return Ht(t,0),t}function xa(e,t,r){if(e){var n,a,s;Ht(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=v0[o]||v0[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=l,t(d,c,o))return}}}function Nh(){var e=[],t=He?256:2048,r=function(c){var d=Pt(c);return Ht(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),Ca(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function ll(e,t,r){var n=Gt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Dg(e,t,r){var n=Gt(e);return n.s=ll(n.s,t.s,r),n.e=ll(n.e,t.s,r),n}function cl(e,t){if(e.cRel&&e.c<0)for(e=Gt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Gt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Re(e);return!e.cRel&&e.cRel!=null&&(r=pR(r)),!e.rRel&&e.rRel!=null&&(r=hR(r)),r}function Yd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+jt(e.s.c)+":"+(e.e.cRel?"":"$")+jt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Yt(e.s.r)+":"+(e.e.rRel?"":"$")+Yt(e.e.r):cl(e.s,t.biff)+":"+cl(e.e,t.biff)}function Cp(e){return parseInt(mR(e),10)-1}function Yt(e){return""+(e+1)}function hR(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function mR(e){return e.replace(/\$(\d+)$/,"$1")}function Np(e){for(var t=xR(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function jt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pR(e){return e.replace(/^([A-Z])/,"$$$1")}function xR(e){return e.replace(/^\$([A-Z])/,"$1")}function gR(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function xr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Re(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yo(e){var t=e.indexOf(":");return t==-1?{s:xr(e),e:xr(e)}:{s:xr(e.slice(0,t)),e:xr(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=Re(e)),typeof t!="string"&&(t=Re(t)),e==t?e:e+":"+t)}function vt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function jg(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=on(e.z,r?yr(t):t)}catch{}try{return e.w=on((e.XF||{}).numFmtId||(r?14:0),r?yr(t):t)}catch{return""+t}}function ha(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?oi[e.v]||e.v:t==null?jg(e,e.v):jg(e,t))}function us(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function vS(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=vt(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),i==-1&&(c.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},x=i+f,m=o+h;if(c.s.r>x&&(c.s.r=x),c.s.c>m&&(c.s.c=m),c.e.r<x&&(c.e.r=x),c.e.c<m&&(c.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Me[14],n.cellDates?(p.t="d",p.w=on(p.z,yr(p.v))):(p.t="n",p.v=yr(p.v),p.w=on(p.z,p.v))):p.t="s";if(a)s[x]||(s[x]=[]),s[x][m]&&s[x][m].z&&(p.z=s[x][m].z),s[x][m]=p;else{var v=Re({c:m,r:x});s[v]&&s[v].z&&(p.z=s[v].z),s[v]=p}}}return c.s.c<1e7&&(s["!ref"]=Ke(c)),s}function wo(e,t){return vS(null,e,t)}function vR(e){return e.read_shift(4,"i")}function ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yR(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ap(e,t){var r=e.l,n=e.read_shift(1),a=ir(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(yR(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var wR=Ap;function ln(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function si(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var kR=ir;function Fp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var SR=ir,Ah=Fp;function Pp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?f0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):xs(t,0)>>2;return r?a/100:a}function yS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ii=yS;function ar(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ER(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=zs[a];c&&(t.rgb=Hl(c));break;case 2:t.rgb=Hl([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function _R(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function wS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function bR(e){return wS(e,1)}function TR(e){return wS(e,2)}var Rp=2,_r=3,Jc=11,Ig=12,h0=19,Zc=64,CR=65,NR=71,AR=4108,FR=4126,Lt=80,kS=81,PR=[Lt,kS],RR={1:{n:"CodePage",t:Rp},2:{n:"Category",t:Lt},3:{n:"PresentationFormat",t:Lt},4:{n:"ByteCount",t:_r},5:{n:"LineCount",t:_r},6:{n:"ParagraphCount",t:_r},7:{n:"SlideCount",t:_r},8:{n:"NoteCount",t:_r},9:{n:"HiddenCount",t:_r},10:{n:"MultimediaClipCount",t:_r},11:{n:"ScaleCrop",t:Jc},12:{n:"HeadingPairs",t:AR},13:{n:"TitlesOfParts",t:FR},14:{n:"Manager",t:Lt},15:{n:"Company",t:Lt},16:{n:"LinksUpToDate",t:Jc},17:{n:"CharacterCount",t:_r},19:{n:"SharedDoc",t:Jc},22:{n:"HyperlinksChanged",t:Jc},23:{n:"AppVersion",t:_r,p:"version"},24:{n:"DigSig",t:CR},26:{n:"ContentType",t:Lt},27:{n:"ContentStatus",t:Lt},28:{n:"Language",t:Lt},29:{n:"Version",t:Lt},255:{},2147483648:{n:"Locale",t:h0},2147483651:{n:"Behavior",t:h0},1919054434:{}},DR={1:{n:"CodePage",t:Rp},2:{n:"Title",t:Lt},3:{n:"Subject",t:Lt},4:{n:"Author",t:Lt},5:{n:"Keywords",t:Lt},6:{n:"Comments",t:Lt},7:{n:"Template",t:Lt},8:{n:"LastAuthor",t:Lt},9:{n:"RevNumber",t:Lt},10:{n:"EditTime",t:Zc},11:{n:"LastPrinted",t:Zc},12:{n:"CreatedDate",t:Zc},13:{n:"ModifiedDate",t:Zc},14:{n:"PageCount",t:_r},15:{n:"WordCount",t:_r},16:{n:"CharCount",t:_r},17:{n:"Thumbnail",t:NR},18:{n:"Application",t:Lt},19:{n:"DocSecurity",t:_r},255:{},2147483648:{n:"Locale",t:h0},2147483651:{n:"Behavior",t:h0},1919054434:{}},Og={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},jR=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function IR(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var OR=IR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zs=Gt(OR),oi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},SS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Mg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function MR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function LR(e){var t=MR();if(!e||!e.match)return t;var r={};if((e.match(cr)||[]).forEach(function(n){var a=Ne(n);switch(a[0].replace(KP,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Mg[a.ContentType]]!==void 0&&t[Mg[a.ContentType]].push(a.PartName);break}}),t.xmlns!==nR.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var bi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Fh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ul(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(cr)||[]).forEach(function(a){var s=Ne(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Wo(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var BR="application/vnd.oasis.opendocument.spreadsheet";function UR(e,t){for(var r=bp(e),n,a;n=zl.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ne(n[0],!1),a.path=="/"&&a.type!==BR)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var dl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],$R=function(){for(var e=new Array(dl.length),t=0;t<dl.length;++t){var r=dl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function ES(e){var t={};e=tt(e);for(var r=0;r<dl.length;++r){var n=dl[r],a=e.match($R[r]);a!=null&&a.length>0&&(t[n[1]]=Ye(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=$t(t[n[1]]))}return t}var zR=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function _S(e,t,r,n){var a=[];if(typeof e=="string")a=Cg(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var i=typeof t=="string"?Cg(t,n).map(function(d){return d.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function VR(e,t,r){var n={};return t||(t={}),e=tt(e),zR.forEach(function(a){var s=(e.match($l(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Ye(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&_S(n.HeadingPairs,n.TitlesOfParts,t,r),t}var HR=/<[^>]+>[^<]*/g;function WR(e,t){var r={},n="",a=e.match(HR);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Ne(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ye(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ye(d);break;case"bool":r[n]=ot(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=$t(d);break;case"cy":case"error":r[n]=Ye(d);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var KR={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Xd;function GR(e,t,r){Xd||(Xd=Sp(KR)),t=Xd[t]||t,e[t]=r}function Dp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function bS(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function TS(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function CS(e,t,r){return t===31?TS(e):bS(e,t,r)}function Ph(e,t,r){return CS(e,t,r===!1?0:4)}function YR(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return CS(e,t,0)}function XR(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(vr,""),e.l-a&2&&(e.l+=2)}return r}function qR(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(vr,"");return r}function QR(e){var t=e.l,r=m0(e,kS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=m0(e,_r);return[r,n]}function JR(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(QR(e));return r}function Lg(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(vr,"").replace(Ho,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function NS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function ZR(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function m0(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==Ig&&n!==t&&PR.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Ig?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return bS(e,n,4).replace(vr,"");case 31:return TS(e);case 64:return Dp(e);case 65:return NS(e);case 71:return ZR(e);case 80:return Ph(e,n,!s.raw).replace(vr,"");case 81:return YR(e,n).replace(vr,"");case 4108:return JR(e);case 4126:case 4127:return n==4127?XR(e):qR(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Bg(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var d=e.read_shift(4),f=e.read_shift(4);s[i]=[d,f+r]}s.sort(function(y,w){return y[1]-w[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[s[i][0]];if(h[x.n]=m0(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:vn(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(s[i][0]===1){if(o=h.CodePage=m0(e,Rp),vn(o),l!==-1){var m=e.l;e.l=s[l][1],c=Lg(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Lg(e,o)}else{var v=c[s[i][0]],g;switch(e[e.l]){case 65:e.l+=4,g=NS(e);break;case 30:e.l+=4,g=Ph(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=Ph(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=wt(e,4);break;case 64:e.l+=4,g=$t(Dp(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=g}}return e.l=r+n,h}function Ug(e,t,r){var n=e.content;if(!n)return{};Ht(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==We.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var f=Bg(n,t),h={SystemIdentifier:c};for(var p in f)h[p]=f[p];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Bg(n,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[s,i],h}function va(e,t){return e.read_shift(t),null}function eD(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function wt(e,t){return e.read_shift(t)===1}function bt(e){return e.read_shift(2,"u")}function AS(e,t){return eD(e,t,bt)}function tD(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function vc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function rD(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=d,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Zs(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function yc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Zs(e,n,r)}function li(e,t,r){if(r.biff>5)return yc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function nD(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function aD(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(vr,"");return n&&(e.l+=24),a}function sD(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(vr,"");return r+i}function iD(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return aD(e);case"0303000000000000c000000000000046":return sD(e);default:throw new Error("Unsupported Moniker "+r)}}function eu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(vr,""):"";return r}function oD(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",d,f;a&16&&(s=eu(e,r-e.l)),a&128&&(i=eu(e,r-e.l)),(a&257)===257&&(o=eu(e,r-e.l)),(a&257)===1&&(l=iD(e,r-e.l)),a&8&&(c=eu(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=Dp(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),f&&(p.time=f),s&&(p.Tooltip=s),p}function FS(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function PS(e,t){var r=FS(e);return r[3]=0,r}function Kn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function lD(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function cD(e,t,r){return t===0?"":li(e,t,r)}function uD(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function RS(e){var t=e.read_shift(2),r=Pp(e);return[t,r]}function dD(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=vc(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function ed(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function DS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var fD=DS;function jS(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function hD(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function mD(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Zt(e){e.l+=2,e.l+=e.read_shift(2)}var pD={0:Zt,4:Zt,5:Zt,6:Zt,7:mD,8:Zt,9:Zt,10:Zt,11:Zt,12:Zt,13:hD,14:Zt,15:Zt,16:Zt,17:Zt,18:Zt,19:Zt,20:Zt,21:jS};function xD(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(pD[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function tu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function gD(e,t){return t===0||e.read_shift(2),1200}function vD(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=li(e,0,r);return e.read_shift(t+n-e.l),a}function yD(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function wD(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=vc(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function kD(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(rD(e));return s.Count=n,s.Unique=a,s}function SD(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function ED(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function _D(e){var t=lD(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function bD(e){return e.read_shift(2),e.read_shift(4)}function $g(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function TD(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function CD(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function ND(){}function AD(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=vc(e,0,r),n}function FD(e){var t=Kn(e);return t.isst=e.read_shift(4),t}function PD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Kn(e);r.biff==2&&e.l++;var s=yc(e,n-e.l,r);return a.val=s,a}function RD(e,t,r){var n=e.read_shift(2),a=li(e,0,r);return[n,a]}var DD=li;function zg(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function jD(e){var t=e.read_shift(2),r=e.read_shift(2),n=RS(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function ID(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(RS(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function OD(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function MD(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=jR[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function LD(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=MD(e,t,n.fStyle,r),n}function BD(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Vg(e,t,r){var n=Kn(e);(r.biff==2||t==9)&&++e.l;var a=tD(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function UD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Kn(e),a=ar(e);return n.val=a,n}var Hg=cD;function $D(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Zs(e,s),o=[];n>e.l;)o.push(yc(e));return[s,a,i,o]}function Wg(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=dD(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var zD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Kg(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Zs(e,i,r);a&32&&(c=zD[c.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:Ej(e,d,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function IS(e,t,r){if(r.biff<8)return VD(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(uD(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function VD(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=vc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function HD(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Zs(e,n,r),i=Zs(e,a,r);return[s,i]}function WD(e,t,r){var n=DS(e);e.l++;var a=e.read_shift(1);return t-=8,[_j(e,t,r),a,n]}function Gg(e,t,r){var n=fD(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,kj(e,t,r)]}function KD(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function GD(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=li(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function YD(e,t,r){return GD(e,t,r)}function XD(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ed(e));return r}function qD(e,t,r){if(r&&r.biff<8)return JD(e,t,r);var n=jS(e),a=xD(e,t-22,n[1]);return{cmo:n,ft:a}}var QD={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function JD(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((QD[n]||lr)(e,t,r)),{cmo:[a,n,s],ft:i}}function ZD(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=nD(e,6,r);var o=e.read_shift(2);e.read_shift(2),bt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var d=e[e.l],f=Zs(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(d?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function e6(e,t){var r=ed(e);e.l+=16;var n=oD(e,t-24);return[r,n]}function t6(e,t){e.read_shift(2);var r=ed(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(vr,""),[r,n]}function r6(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Og[r]||r,r=e.read_shift(2),t[1]=Og[r]||r,t}function n6(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(PS(e));return r}function a6(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(PS(e));return r}function s6(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function OS(e,t,r){if(!r.cellStyles)return lr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function i6(e,t){var r={};return t<32||(e.l+=16,r.header=ar(e),r.footer=ar(e),e.l+=2),r}function o6(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var l6=Kn,c6=AS,u6=yc;function d6(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function f6(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Kn(e);++e.l;var a=li(e,t-7,r);return n.t="str",n.val=a,n}function h6(e){var t=Kn(e);++e.l;var r=ar(e);return t.t="n",t.val=r,t}function m6(e){var t=Kn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function p6(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function x6(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function g6(e,t,r){var n=e.l+t,a=Kn(e),s=e.read_shift(2),i=Zs(e,s,r);return e.l=n,a.t="str",a.val=i,a}var v6=[2,3,48,49,131,139,140,245],Yg=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Sp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],d=as(1);switch(l.type){case"base64":d=gn(Vr(o));break;case"binary":d=gn(o);break;case"buffer":case"array":d=o;break}Ht(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,v=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(v=d.read_shift(2));var g=d.read_shift(2),y=l.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var w=[],S={},A=Math.min(d.length,f==2?521:v-10-(p?264:0)),T=x?32:11;d.l<A&&d[d.l]!=13;)switch(S={},S.name=Ta.utils.decode(y,d.slice(d.l,d.l+T)).replace(/[\u0000\r\n].*$/g,""),d.l+=T,S.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),f==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&w.push(S),f!=2&&(d.l+=x?13:14),S.type){case"B":(!p||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var b=0,k=0;for(c[0]=[],k=0;k!=w.length;++k)c[0][k]=w[k].name;for(;m-- >0;){if(d[d.l]===42){d.l+=g;continue}for(++d.l,c[++b]=[],k=0,k=0;k!=w.length;++k){var E=d.slice(d.l,d.l+w[k].len);d.l+=w[k].len,Ht(E,0);var _=Ta.utils.decode(y,E);switch(w[k].type){case"C":_.trim().length&&(c[b][k]=_.replace(/\s+$/,""));break;case"D":_.length===8?c[b][k]=new Date(+_.slice(0,4),+_.slice(4,6)-1,+_.slice(6,8)):c[b][k]=_;break;case"F":c[b][k]=parseFloat(_.trim());break;case"+":case"I":c[b][k]=x?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(_.trim().toUpperCase()){case"Y":case"T":c[b][k]=!0;break;case"N":case"F":c[b][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+_+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[b][k]="##MEMO##"+(x?parseInt(_.trim(),10):E.read_shift(4));break;case"N":_=_.replace(/\u0000/g,"").trim(),_&&_!="."&&(c[b][k]=+_||0);break;case"@":c[b][k]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":c[b][k]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":c[b][k]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[b][k]=-E.read_shift(-8,"f");break;case"B":if(p&&w[k].len==8){c[b][k]=E.read_shift(8,"f");break}case"G":case"P":E.l+=w[k].len;break;case"0":if(w[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[k].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var d=wo(r(o,c),c);return d["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,d}function a(o,l){try{return us(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&vn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=Nh(),f=Lh(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),x=o["!cols"]||[],m=0,v=0,g=0,y=1;for(m=0;m<h.length;++m){if(((x[m]||{}).DBF||{}).name){h[m]=x[m].DBF.name,++g;continue}if(h[m]!=null){if(++g,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(v=0;v<1024;++v)if(h.indexOf(h[m]+"_"+v)==-1){h[m]+="_"+v;break}}}}var w=vt(o["!ref"]),S=[],A=[],T=[];for(m=0;m<=w.e.c-w.s.c;++m){var b="",k="",E=0,_=[];for(v=0;v<p.length;++v)p[v][m]!=null&&_.push(p[v][m]);if(_.length==0||h[m]==null){S[m]="?";continue}for(v=0;v<_.length;++v){switch(typeof _[v]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=_[v]instanceof Date?"D":"C";break;default:k="C"}E=Math.max(E,String(_[v]).length),b=b&&b!=k?"C":k}E>250&&(E=250),k=((x[m]||{}).DBF||{}).type,k=="C"&&x[m].DBF.len>E&&(E=x[m].DBF.len),b=="B"&&k=="N"&&(b="N",T[m]=x[m].DBF.dec,E=x[m].DBF.len),A[m]=b=="C"||k=="N"?E:s[b]||0,y+=A[m],S[m]=b}var C=d.next(32);for(C.write_shift(4,318902576),C.write_shift(4,p.length),C.write_shift(2,296+32*g),C.write_shift(2,y),m=0;m<4;++m)C.write_shift(4,0);for(C.write_shift(4,0|(+t[jk]||3)<<8),m=0,v=0;m<h.length;++m)if(h[m]!=null){var F=d.next(32),D=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,D,"sbcs"),F.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),F.write_shift(4,v),F.write_shift(1,A[m]||s[S[m]]||0),F.write_shift(1,T[m]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),v+=A[m]||s[S[m]]||0}var M=d.next(264);for(M.write_shift(4,13),m=0;m<65;++m)M.write_shift(4,0);for(m=0;m<p.length;++m){var B=d.next(y);for(B.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(S[v]){case"L":B.write_shift(1,p[m][v]==null?63:p[m][v]?84:70);break;case"B":B.write_shift(8,p[m][v]||0,"f");break;case"N":var q="0";for(typeof p[m][v]=="number"&&(q=p[m][v].toFixed(T[v]||0)),g=0;g<A[v]-q.length;++g)B.write_shift(1,32);B.write_shift(1,q,"sbcs");break;case"D":p[m][v]?(B.write_shift(4,("0000"+p[m][v].getFullYear()).slice(-4),"sbcs"),B.write_shift(2,("00"+(p[m][v].getMonth()+1)).slice(-2),"sbcs"),B.write_shift(2,("00"+p[m][v].getDate()).slice(-2),"sbcs")):B.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(p[m][v]!=null?p[m][v]:"").slice(0,A[v]);for(B.write_shift(1,Q,"sbcs"),g=0;g<A[v]-Q.length;++g)B.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),y6=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Hn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=e[p];return typeof x=="number"?ug(x):x},n=function(h,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?h:ug(m)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return s(Vr(h),p);case"binary":return s(h,p);case"buffer":return s(He&&Buffer.isBuffer(h)?h.toString("binary"):ai(h),p);case"array":return s(Js(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var x=h.split(/[\n\r]+/),m=-1,v=-1,g=0,y=0,w=[],S=[],A=null,T={},b=[],k=[],E=[],_=0,C;for(+p.codepage>=0&&vn(+p.codepage);g!==x.length;++g){_=0;var F=x[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),D=F.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),M=D[0],B;if(F.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&S.push(F.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,Q=!1,J=!1,P=!1,Z=-1,le=-1;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"A":break;case"X":v=parseInt(D[y].slice(1))-1,Q=!0;break;case"Y":for(m=parseInt(D[y].slice(1))-1,Q||(v=0),C=w.length;C<=m;++C)w[C]=[];break;case"K":B=D[y].slice(1),B.charAt(0)==='"'?B=B.slice(1,B.length-1):B==="TRUE"?B=!0:B==="FALSE"?B=!1:isNaN(En(B))?isNaN(lo(B).getDate())||(B=$t(B)):(B=En(B),A!==null&&vo(A)&&(B=Z0(B))),q=!0;break;case"E":P=!0;var R=Ii(D[y].slice(1),{r:m,c:v});w[m][v]=[w[m][v],R];break;case"S":J=!0,w[m][v]=[w[m][v],"S5S"];break;case"G":break;case"R":Z=parseInt(D[y].slice(1))-1;break;case"C":le=parseInt(D[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+F)}if(q&&(w[m][v]&&w[m][v].length==2?w[m][v][0]=B:w[m][v]=B,A=null),J){if(P)throw new Error("SYLK shared formula cannot have own formula");var G=Z>-1&&w[Z][le];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");w[m][v][1]=KS(G[1],{r:m-Z,c:v-le})}break;case"F":var W=0;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"X":v=parseInt(D[y].slice(1))-1,++W;break;case"Y":for(m=parseInt(D[y].slice(1))-1,C=w.length;C<=m;++C)w[C]=[];break;case"M":_=parseInt(D[y].slice(1))/20;break;case"F":break;case"G":break;case"P":A=S[parseInt(D[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=D[y].slice(1).split(" "),C=parseInt(E[0],10);C<=parseInt(E[1],10);++C)_=parseInt(E[2],10),k[C-1]=_===0?{hidden:!0}:{wch:_},co(k[C-1]);break;case"C":v=parseInt(D[y].slice(1))-1,k[v]||(k[v]={});break;case"R":m=parseInt(D[y].slice(1))-1,b[m]||(b[m]={}),_>0?(b[m].hpt=_,b[m].hpx=Wl(_)):_===0&&(b[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+F)}W<1&&(A=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+F)}}return b.length>0&&(T["!rows"]=b),k.length>0&&(T["!cols"]=k),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,T]}function i(h,p){var x=a(h,p),m=x[0],v=x[1],g=wo(m,p);return Hn(v).forEach(function(y){g[y]=v[y]}),g}function o(h,p){return us(i(h,p),p)}function l(h,p,x,m){var v="C;Y"+(x+1)+";X"+(m+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+s8(h.f,{r:x,c:m}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(h,p){p.forEach(function(x,m){var v="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?v+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=x0(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=g0(x.wpx)),typeof x.wch=="number"&&(v+=Math.round(x.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function d(h,p){p.forEach(function(x,m){var v="F;";x.hidden?v+="M0;":x.hpt?v+="M"+20*x.hpt+";":x.hpx&&(v+="M"+20*VS(x.hpx)+";"),v.length>2&&h.push(v+"R"+(m+1))})}function f(h,p){var x=["ID;PWXL;N;E"],m=[],v=vt(h["!ref"]),g,y=Array.isArray(h),w=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&c(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var S=v.s.r;S<=v.e.r;++S)for(var A=v.s.c;A<=v.e.c;++A){var T=Re({r:S,c:A});g=y?(h[S]||[])[A]:h[T],!(!g||g.v==null&&(!g.f||g.F))&&m.push(l(g,h,S,A))}return x.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),w6=function(){function e(s,i){switch(i.type){case"base64":return t(Vr(s),i);case"binary":return t(s,i);case"buffer":return t(He&&Buffer.isBuffer(s)?s.toString("binary"):ai(s),i);case"array":return t(Js(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[d].trim().split(","),p=h[0],x=h[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(En(x))?isNaN(lo(x).getDate())?f[l][c]=x:f[l][c]=$t(x):f[l][c]=En(x),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(s,i){return wo(e(s,i),i)}function n(s,i){return us(r(s,i),i)}var a=function(){var s=function(l,c,d,f,h){l.push(c),l.push(d+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,d,f){l.push(c+","+d),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],d=vt(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,d.e.r-d.s.r+1,""),s(c,"TUPLES",0,d.e.c-d.s.c+1,""),s(c,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(c,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var m=Re({r:p,c:x});if(f=h?(l[p]||[])[x]:l[m],!f){i(c,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?i(c,1,0,"="+f.f):i(c,1,0,""):i(c,0,v,"V");break;case"b":i(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=on(f.z||Me[14],yr($t(f.v)))),i(c,0,f.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var g=`\r
`,y=c.join(g);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),k6=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),x=-1,m=-1,v=0,g=[];v!==p.length;++v){var y=p[v].trim().split(":");if(y[0]==="cell"){var w=xr(y[1]);if(g.length<=w.r)for(x=g.length;x<=w.r;++x)g[x]||(g[x]=[]);switch(x=w.r,m=w.c,y[2]){case"t":g[x][m]=e(y[3]);break;case"v":g[x][m]=+y[3];break;case"vtf":var S=y[y.length-1];case"vtc":switch(y[3]){case"nl":g[x][m]=!!+y[4];break;default:g[x][m]=+y[4];break}y[2]=="vtf"&&(g[x][m]=[g[x][m],S])}}}return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}function n(f,h){return wo(r(f,h),h)}function a(f,h){return us(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],x,m="",v=yo(f["!ref"]),g=Array.isArray(f),y=v.s.r;y<=v.e.r;++y)for(var w=v.s.c;w<=v.e.c;++w)if(m=Re({r:y,c:w}),x=g?(f[y]||[])[w]:f[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var S=yr($t(x.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=x.w||on(x.z||Me[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,i,o,i,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Vl=function(){function e(d,f,h,p,x){x.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(En(d))?isNaN(lo(d).getDate())?f[h][p]=d:f[h][p]=$t(d):f[h][p]=En(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var v=10,g=0,y=0;y<=m;++y)g=x[y].indexOf(" "),g==-1?g=x[y].length:g++,v=Math.max(v,g);for(y=0;y<=m;++y){p[y]=[];var w=0;for(e(x[y].slice(0,v).trim(),p,y,w,h),w=1;w<=(x[y].length-v)/10+1;++w)e(x[y].slice(v+(w-1)*10,v+w*10).trim(),p,y,w,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[x.pop()[1]]||44}function s(d,f){var h=f||{},p="",x=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=a(d.slice(0,1024)):h&&h.FS?p=h.FS:p=a(d.slice(0,1024));var v=0,g=0,y=0,w=0,S=0,A=p.charCodeAt(0),T=!1,b=0,k=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=h.dateNF!=null?DP(h.dateNF):null;function _(){var C=d.slice(w,S),F={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)F.t="z";else if(h.raw)F.t="s",F.v=C;else if(C.trim().length===0)F.t="s",F.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(F.t="s",F.v=C.slice(2,-1).replace(/""/g,'"')):o8(C)?(F.t="n",F.f=C.slice(1)):(F.t="s",F.v=C);else if(C=="TRUE")F.t="b",F.v=!0;else if(C=="FALSE")F.t="b",F.v=!1;else if(!isNaN(y=En(C)))F.t="n",h.cellText!==!1&&(F.w=C),F.v=y;else if(!isNaN(lo(C).getDate())||E&&C.match(E)){F.z=h.dateNF||Me[14];var D=0;E&&C.match(E)&&(C=jP(C,h.dateNF,C.match(E)||[]),D=1),h.cellDates?(F.t="d",F.v=$t(C,D)):(F.t="n",F.v=yr($t(C,D))),h.cellText!==!1&&(F.w=on(F.z,F.v instanceof Date?yr(F.v):F.v)),h.cellNF||delete F.z}else F.t="s",F.v=C;if(F.t=="z"||(h.dense?(x[v]||(x[v]=[]),x[v][g]=F):x[Re({c:g,r:v})]=F),w=S+1,k=d.charCodeAt(w),m.e.c<g&&(m.e.c=g),m.e.r<v&&(m.e.r=v),b==A)++g;else if(g=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;S<d.length;++S)switch(b=d.charCodeAt(S)){case 34:k===34&&(T=!T);break;case A:case 10:case 13:if(!T&&_())break e;break}return S-w>0&&_(),x["!ref"]=Ke(m),x}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):wo(t(d,f),f)}function o(d,f){var h="",p=f.type=="string"?[0,0,0,0]:$p(d,f);switch(f.type){case"base64":h=Vr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Ta<"u"?h=Ta.utils.decode(f.codepage,d):h=He&&Buffer.isBuffer(d)?d.toString("binary"):ai(d);break;case"array":h=Js(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=tt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=tt(h):f.type=="binary"&&typeof Ta<"u"&&f.codepage&&(h=Ta.utils.decode(f.codepage,Ta.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?k6.to_sheet(f.type=="string"?h:tt(h),f):i(h,f)}function l(d,f){return us(o(d,f),f)}function c(d){for(var f=[],h=vt(d["!ref"]),p,x=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var v=[],g=h.s.c;g<=h.e.c;++g){var y=Re({r:m,c:g});if(p=x?(d[m]||[])[g]:d[y],!p||p.v==null){v.push("          ");continue}for(var w=(p.w||(ha(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";v.push(w+(g===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function S6(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=y6.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Vl.to_workbook(e,t)}}var fl=function(){function e(R,G,W){if(R){Ht(R,R.l||0);for(var K=W.Enum||Z;R.l<R.length;){var O=R.read_shift(2),X=K[O]||K[65535],se=R.read_shift(2),ie=R.l+se,oe=X.f&&X.f(R,se,W);if(R.l=ie,G(oe,X,O))return}}}function t(R,G){switch(G.type){case"base64":return r(gn(Vr(R)),G);case"binary":return r(gn(R),G);case"buffer":case"array":return r(R,G)}throw"Unsupported type "+G.type}function r(R,G){if(!R)return R;var W=G||{},K=W.dense?[]:{},O="Sheet1",X="",se=0,ie={},oe=[],ue=[],L={s:{r:0,c:0},e:{r:0,c:0}},Pe=W.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)W.Enum=Z,e(R,function(de,be,Oe){switch(Oe){case 0:W.vers=de,de>=4096&&(W.qpro=!0);break;case 6:L=de;break;case 204:de&&(X=de);break;case 222:X=de;break;case 15:case 51:W.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Oe==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=W.dateNF||Me[14],W.cellDates&&(de[1].t="d",de[1].v=Z0(de[1].v))),W.qpro&&de[3]>se&&(K["!ref"]=Ke(L),ie[O]=K,oe.push(O),K=W.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},se=de[3],O=X||"Sheet"+(se+1),X="");var $e=W.dense?(K[de[0].r]||[])[de[0].c]:K[Re(de[0])];if($e){$e.t=de[1].t,$e.v=de[1].v,de[1].z!=null&&($e.z=de[1].z),de[1].f!=null&&($e.f=de[1].f);break}W.dense?(K[de[0].r]||(K[de[0].r]=[]),K[de[0].r][de[0].c]=de[1]):K[Re(de[0])]=de[1];break}},W);else if(R[2]==26||R[2]==14)W.Enum=le,R[2]==14&&(W.qpro=!0,R.l=0),e(R,function(de,be,Oe){switch(Oe){case 204:O=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>se&&(K["!ref"]=Ke(L),ie[O]=K,oe.push(O),K=W.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},se=de[3],O="Sheet"+(se+1)),Pe>0&&de[0].r>=Pe)break;W.dense?(K[de[0].r]||(K[de[0].r]=[]),K[de[0].r][de[0].c]=de[1]):K[Re(de[0])]=de[1],L.e.c<de[0].c&&(L.e.c=de[0].c),L.e.r<de[0].r&&(L.e.r=de[0].r);break;case 27:de[14e3]&&(ue[de[14e3][0]]=de[14e3][1]);break;case 1537:ue[de[0]]=de[1],de[0]==se&&(O=de[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(K["!ref"]=Ke(L),ie[X||O]=K,oe.push(X||O),!ue.length)return{SheetNames:oe,Sheets:ie};for(var ke={},Se=[],xe=0;xe<ue.length;++xe)ie[oe[xe]]?(Se.push(ue[xe]||oe[xe]),ke[ue[xe]]=ie[ue[xe]]||ie[oe[xe]]):(Se.push(ue[xe]),ke[ue[xe]]={"!ref":"A1"});return{SheetNames:Se,Sheets:ke}}function n(R,G){var W=G||{};if(+W.codepage>=0&&vn(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Nh(),O=vt(R["!ref"]),X=Array.isArray(R),se=[];dn(K,0,s(1030)),dn(K,6,l(O));for(var ie=Math.min(O.e.r,8191),oe=O.s.r;oe<=ie;++oe)for(var ue=Yt(oe),L=O.s.c;L<=O.e.c;++L){oe===O.s.r&&(se[L]=jt(L));var Pe=se[L]+ue,ke=X?(R[oe]||[])[L]:R[Pe];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?dn(K,13,p(oe,L,ke.v)):dn(K,14,m(oe,L,ke.v));else{var Se=ha(ke);dn(K,15,f(oe,L,Se.slice(0,239)))}}return dn(K,1),K.end()}function a(R,G){var W=G||{};if(+W.codepage>=0&&vn(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Nh();dn(K,0,i(R));for(var O=0,X=0;O<R.SheetNames.length;++O)(R.Sheets[R.SheetNames[O]]||{})["!ref"]&&dn(K,27,P(R.SheetNames[O],X++));var se=0;for(O=0;O<R.SheetNames.length;++O){var ie=R.Sheets[R.SheetNames[O]];if(!(!ie||!ie["!ref"])){for(var oe=vt(ie["!ref"]),ue=Array.isArray(ie),L=[],Pe=Math.min(oe.e.r,8191),ke=oe.s.r;ke<=Pe;++ke)for(var Se=Yt(ke),xe=oe.s.c;xe<=oe.e.c;++xe){ke===oe.s.r&&(L[xe]=jt(xe));var de=L[xe]+Se,be=ue?(ie[ke]||[])[xe]:ie[de];if(!(!be||be.t=="z"))if(be.t=="n")dn(K,23,_(ke,xe,se,be.v));else{var Oe=ha(be);dn(K,22,b(ke,xe,se,Oe.slice(0,239)))}}++se}}return dn(K,1),K.end()}function s(R){var G=Pt(2);return G.write_shift(2,R),G}function i(R){var G=Pt(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var W=0,K=0,O=0,X=0;X<R.SheetNames.length;++X){var se=R.SheetNames[X],ie=R.Sheets[se];if(!(!ie||!ie["!ref"])){++O;var oe=yo(ie["!ref"]);W<oe.e.r&&(W=oe.e.r),K<oe.e.c&&(K=oe.e.c)}}return W>8191&&(W=8191),G.write_shift(2,W),G.write_shift(1,O),G.write_shift(1,K),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(R,G,W){var K={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&W.qpro?(K.s.c=R.read_shift(1),R.l++,K.s.r=R.read_shift(2),K.e.c=R.read_shift(1),R.l++,K.e.r=R.read_shift(2),K):(K.s.c=R.read_shift(2),K.s.r=R.read_shift(2),G==12&&W.qpro&&(R.l+=2),K.e.c=R.read_shift(2),K.e.r=R.read_shift(2),G==12&&W.qpro&&(R.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function l(R){var G=Pt(8);return G.write_shift(2,R.s.c),G.write_shift(2,R.s.r),G.write_shift(2,R.e.c),G.write_shift(2,R.e.r),G}function c(R,G,W){var K=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(K[0].c=R.read_shift(1),K[3]=R.read_shift(1),K[0].r=R.read_shift(2),R.l+=2):(K[2]=R.read_shift(1),K[0].c=R.read_shift(2),K[0].r=R.read_shift(2)),K}function d(R,G,W){var K=R.l+G,O=c(R,G,W);if(O[1].t="s",W.vers==20768){R.l++;var X=R.read_shift(1);return O[1].v=R.read_shift(X,"utf8"),O}return W.qpro&&R.l++,O[1].v=R.read_shift(K-R.l,"cstr"),O}function f(R,G,W){var K=Pt(7+W.length);K.write_shift(1,255),K.write_shift(2,G),K.write_shift(2,R),K.write_shift(1,39);for(var O=0;O<K.length;++O){var X=W.charCodeAt(O);K.write_shift(1,X>=128?95:X)}return K.write_shift(1,0),K}function h(R,G,W){var K=c(R,G,W);return K[1].v=R.read_shift(2,"i"),K}function p(R,G,W){var K=Pt(7);return K.write_shift(1,255),K.write_shift(2,G),K.write_shift(2,R),K.write_shift(2,W,"i"),K}function x(R,G,W){var K=c(R,G,W);return K[1].v=R.read_shift(8,"f"),K}function m(R,G,W){var K=Pt(13);return K.write_shift(1,255),K.write_shift(2,G),K.write_shift(2,R),K.write_shift(8,W,"f"),K}function v(R,G,W){var K=R.l+G,O=c(R,G,W);if(O[1].v=R.read_shift(8,"f"),W.qpro)R.l=K;else{var X=R.read_shift(2);S(R.slice(R.l,R.l+X),O),R.l+=X}return O}function g(R,G,W){var K=G&32768;return G&=-32769,G=(K?R:0)+(G>=8192?G-16384:G),(K?"":"$")+(W?jt(G):Yt(G))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(R,G){Ht(R,0);for(var W=[],K=0,O="",X="",se="",ie="";R.l<R.length;){var oe=R[R.l++];switch(oe){case 0:W.push(R.read_shift(8,"f"));break;case 1:X=g(G[0].c,R.read_shift(2),!0),O=g(G[0].r,R.read_shift(2),!1),W.push(X+O);break;case 2:{var ue=g(G[0].c,R.read_shift(2),!0),L=g(G[0].r,R.read_shift(2),!1);X=g(G[0].c,R.read_shift(2),!0),O=g(G[0].r,R.read_shift(2),!1),W.push(ue+L+":"+X+O)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(R.read_shift(2));break;case 6:{for(var Pe="";oe=R[R.l++];)Pe+=String.fromCharCode(oe);W.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:ie=W.pop(),se=W.pop(),W.push(["AND","OR"][oe-20]+"("+se+","+ie+")");break;default:if(oe<32&&w[oe])ie=W.pop(),se=W.pop(),W.push(se+w[oe]+ie);else if(y[oe]){if(K=y[oe][1],K==69&&(K=R[R.l++]),K>W.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+W.join("|")+"|");return}var ke=W.slice(-K);W.length-=K,W.push(y[oe][0]+"("+ke.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}W.length==1?G[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function A(R){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=R.read_shift(2),G[3]=R[R.l++],G[0].c=R[R.l++],G}function T(R,G){var W=A(R);return W[1].t="s",W[1].v=R.read_shift(G-4,"cstr"),W}function b(R,G,W,K){var O=Pt(6+K.length);O.write_shift(2,R),O.write_shift(1,W),O.write_shift(1,G),O.write_shift(1,39);for(var X=0;X<K.length;++X){var se=K.charCodeAt(X);O.write_shift(1,se>=128?95:se)}return O.write_shift(1,0),O}function k(R,G){var W=A(R);W[1].v=R.read_shift(2);var K=W[1].v>>1;if(W[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return W[1].v=K,W}function E(R,G){var W=A(R),K=R.read_shift(4),O=R.read_shift(4),X=R.read_shift(2);if(X==65535)return K===0&&O===3221225472?(W[1].t="e",W[1].v=15):K===0&&O===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var se=X&32768;return X=(X&32767)-16446,W[1].v=(1-se*2)*(O*Math.pow(2,X+32)+K*Math.pow(2,X)),W}function _(R,G,W,K){var O=Pt(14);if(O.write_shift(2,R),O.write_shift(1,W),O.write_shift(1,G),K==0)return O.write_shift(4,0),O.write_shift(4,0),O.write_shift(2,65535),O;var X=0,se=0,ie=0,oe=0;return K<0&&(X=1,K=-K),se=Math.log2(K)|0,K/=Math.pow(2,se-31),oe=K>>>0,oe&2147483648||(K/=2,++se,oe=K>>>0),K-=oe,oe|=2147483648,oe>>>=0,K*=Math.pow(2,32),ie=K>>>0,O.write_shift(4,ie),O.write_shift(4,oe),se+=16383+(X?32768:0),O.write_shift(2,se),O}function C(R,G){var W=E(R);return R.l+=G-14,W}function F(R,G){var W=A(R),K=R.read_shift(4);return W[1].v=K>>6,W}function D(R,G){var W=A(R),K=R.read_shift(8,"f");return W[1].v=K,W}function M(R,G){var W=D(R);return R.l+=G-10,W}function B(R,G){return R[R.l+G-1]==0?R.read_shift(G,"cstr"):""}function q(R,G){var W=R[R.l++];W>G-1&&(W=G-1);for(var K="";K.length<W;)K+=String.fromCharCode(R[R.l++]);return K}function Q(R,G,W){if(!(!W.qpro||G<21)){var K=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var O=R.read_shift(G-21,"cstr");return[K,O]}}function J(R,G){for(var W={},K=R.l+G;R.l<K;){var O=R.read_shift(2);if(O==14e3){for(W[O]=[0,""],W[O][0]=R.read_shift(2);R[R.l];)W[O][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return W}function P(R,G){var W=Pt(5+R.length);W.write_shift(2,14e3),W.write_shift(2,G);for(var K=0;K<R.length;++K){var O=R.charCodeAt(K);W[W.l++]=O>127?95:O}return W[W.l++]=0,W}var Z={0:{n:"BOF",f:bt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:B},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:B},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function E6(e){var t={},r=e.match(cr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ne(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=gp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var _6=function(){var e=$l("t"),t=$l("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Ye(i[1])},l=s.match(t);return l&&(o.s=E6(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),b6=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),T6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,C6=/<(?:\w+:)?r>/,N6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function jp(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ye(tt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=tt(e),r&&(n.h=_p(n.t))):e.match(C6)&&(n.r=tt(e),n.t=Ye(tt((e.replace(N6,"").match(T6)||[]).join("").replace(cr,""))),r&&(n.h=b6(_6(n.r)))),n):{t:""}}var A6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,F6=/<(?:\w+:)?(?:si|sstItem)>/g,P6=/<\/(?:\w+:)?(?:si|sstItem)>/;function R6(e,t){var r=[],n="";if(!e)return r;var a=e.match(A6);if(a){n=a[2].replace(F6,"").split(P6);for(var s=0;s!=n.length;++s){var i=jp(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ne(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function D6(e){return[e.read_shift(4),e.read_shift(4)]}function j6(e,t){var r=[],n=!1;return xa(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function MS(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ia(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function I6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ia(e,4),t.U=ia(e,4),t.W=ia(e,4),t}function O6(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function M6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(O6(e));return t}function L6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function B6(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ia(e,4),t.U=ia(e,4),t.W=ia(e,4),t}function U6(e){var t=B6(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function LS(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function BS(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function $6(e){var t=ia(e);switch(t.Minor){case 2:return[t.Minor,z6(e)];case 3:return[t.Minor,V6()];case 4:return[t.Minor,H6(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function z6(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=LS(e,r),a=BS(e,e.length-e.l);return{t:"Std",h:n,v:a}}function V6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function H6(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(cr,function(s){var i=Ne(s);switch(Wn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function W6(e,t){var r={},n=r.EncryptionVersionInfo=ia(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=LS(e,a),t-=a,r.EncryptionVerifier=BS(e,t),r}function K6(e){var t={},r=t.EncryptionVersionInfo=ia(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function G6(e){var t=0,r,n=MS(e),a=n.length+1,s,i,o,l,c;for(r=as(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var US=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var d=i[c],f=0;f!=7;++f)d&64&&(o^=r[l]),d*=2,--l;return o};return function(i){for(var o=MS(i),l=s(o),c=o.length,d=as(16),f=0;f!=16;++f)d[f]=0;var h,p,x;for((c&1)===1&&(h=l>>8,d[c]=a(e[0],h),--c,h=l&255,p=o[o.length-1],d[c]=a(p,h));c>0;)--c,h=l>>8,d[c]=a(o[c],h),--c,h=l&255,d[c]=a(o[c],h);for(c=15,x=15-o.length;x>0;)h=l>>8,d[c]=a(e[x],h),--c,--x,h=l&255,d[c]=a(o[c],h),--c,--x;return d}}(),Y6=function(e,t,r,n,a){a||(a=t),n||(n=US(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},X6=function(e){var t=0,r=US(e);return function(n){var a=Y6("",n,t,r);return t=a[1],a[0]}};function q6(e,t,r,n){var a={key:bt(e),verificationBytes:bt(e)};return r.password&&(a.verifier=G6(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=X6(r.password)),a}function Q6(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=K6(e):n.Data=W6(e,t),n}function J6(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Q6(e,t-2,n):q6(e,r.biff>=8?t:t-2,r,n),n}var Z6=function(){function e(a,s){switch(s.type){case"base64":return t(Vr(a),s);case"binary":return t(a,s);case"buffer":return t(He&&Buffer.isBuffer(a)?a.toString("binary"):ai(a),s);case"array":return t(Js(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,x,m=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var v=d.slice(p,h.lastIndex-x[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var g={v,t:"s"};Array.isArray(o)?o[f][m]=g:o[Re({r:f,c:m})]=g}break}p=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ke(c),o}function r(a,s){return us(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=vt(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Re({r:c,c:d});o=l?(a[c]||[])[d]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ha(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function e5(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Hl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function t5(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function r5(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function p0(e,t){if(t===0)return e;var r=t5(e5(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Hl(r5(r))}var $S=6,n5=15,a5=1,mr=$S;function x0(e){return Math.floor((e+Math.round(128/mr)/256)*mr)}function g0(e){return Math.floor((e-5)/mr*100+.5)/100}function Rh(e){return Math.round((e*mr+5)/mr*256)/256}function qd(e){return Rh(g0(x0(e)))}function Ip(e){var t=Math.abs(e-qd(e)),r=mr;if(t>.005)for(mr=a5;mr<n5;++mr)Math.abs(e-qd(e))<=t&&(t=Math.abs(e-qd(e)),r=mr);mr=r}function co(e){e.width?(e.wpx=x0(e.width),e.wch=g0(e.wpx),e.MDW=mr):e.wpx?(e.wch=g0(e.wpx),e.width=Rh(e.wch),e.MDW=mr):typeof e.wch=="number"&&(e.width=Rh(e.wch),e.wpx=x0(e.width),e.MDW=mr),e.customWidth&&delete e.customWidth}var s5=96,zS=s5;function VS(e){return e*96/zS}function Wl(e){return e*zS/96}var i5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function o5(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(cr)||[]).forEach(function(i){var o=Ne(i);switch(Wn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=ot(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=ot(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function l5(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(cr)||[]).forEach(function(i){var o=Ne(i);switch(Wn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function c5(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(cr)||[]).forEach(function(i){var o=Ne(i);switch(Wn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=tt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?ot(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?ot(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?ot(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?ot(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?ot(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?ot(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?ot(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=gp[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=ot(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=zs[a.color.index];a.color.index==81&&(l=zs[1]),l||(l=zs[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=p0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function u5(e,t,r){t.NumberFmt=[];for(var n=Hn(Me),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Me[n[a]];var s=e[0].match(cr);if(s)for(a=0;a<s.length;++a){var i=Ne(s[a]);switch(Wn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ye(tt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}$s(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var ru=["numFmtId","fillId","fontId","borderId","xfId"],nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function d5(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(cr)||[]).forEach(function(s){var i=Ne(s),o=0;switch(Wn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<ru.length;++o)n[ru[o]]&&(n[ru[o]]=parseInt(n[ru[o]],10));for(o=0;o<nu.length;++o)n[nu[o]]&&(n[nu[o]]=ot(n[nu[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=ot(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var f5=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&u5(f,d,c),(f=o.match(a))&&c5(f,d,l,c),(f=o.match(n))&&l5(f,d,l,c),(f=o.match(s))&&o5(f,d,l,c),(f=o.match(r))&&d5(f,d,c),d}}();function h5(e,t){var r=e.read_shift(2),n=ir(e);return[r,n]}function m5(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=_R(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=ER(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ir(e),n}var p5=lr;function x5(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var g5=lr;function v5(e,t,r){var n={};n.NumberFmt=[];for(var a in Me)n.NumberFmt[a]=Me[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return xa(e,function(l,c,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],$s(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=p0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(d),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(d);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var y5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function w5(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(cr)||[]).forEach(function(a){var s=Ne(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[y5.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function k5(){}function S5(){}var E5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,b5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function T5(e,t,r){t.themeElements={};var n;[["clrScheme",E5,w5],["fontScheme",_5,k5],["fmtScheme",b5,S5]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var C5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function HS(e,t){(!e||e.length===0)&&(e=N5());var r,n={};if(!(r=e.match(C5)))throw new Error("themeElements not found in theme");return T5(r[0],n,t),n.raw=e,n}function N5(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[tS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function A5(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=eS(s,{type:"array"})}catch{return}var o=Lr(i,"theme/theme/theme1.xml",!0);if(o)return HS(o,r)}}function F5(e){return e.read_shift(4)}function P5(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=R5(e,4);break;case 2:t.xclrValue=FS(e);break;case 3:t.xclrValue=F5(e);break;case 4:e.l+=4;break}return e.l+=8,t}function R5(e,t){return lr(e,t)}function D5(e,t){return lr(e,t)}function j5(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=P5(e);break;case 6:n[1]=D5(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function I5(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(j5(e,r-e.l));return{ixfe:n,ext:s}}function O5(e,t){t.forEach(function(r){switch(r[0]){}})}function M5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ir(e)}}function L5(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function B5(e){return e.l+=4,e.read_shift(4)!=0}function U5(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return xa(e,function(l,c,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function $5(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(cr,function(o){var l=Ne(o);switch(Wn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function z5(e){var t=[];if(!e)return t;var r=1;return(e.match(cr)||[]).forEach(function(n){var a=Ne(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function V5(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Re(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function H5(e,t,r){var n=[];return xa(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function W5(e,t,r,n){if(!e)return e;var a=n||{},s=!1;xa(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function K5(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Xg(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=xr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=vt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ke(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function G5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ne(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=xr(l.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&jp(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function Y5(e,t){var r=[],n=!1,a={},s=0;return e.replace(cr,function(o,l){var c=Ne(o);switch(Wn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function X5(e,t){var r=[],n=!1;return e.replace(cr,function(s){var i=Ne(s);switch(Wn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function q5(e){var t={};t.iauthor=e.read_shift(4);var r=ii(e);return t.rfx=r.s,t.ref=Re(r.s),e.l+=16,t}var Q5=ir;function J5(e,t){var r=[],n=[],a={},s=!1;return xa(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Z5="application/vnd.ms-office.vbaProject";function e8(e){var t=We.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(t,a,e.FileIndex[n].content)}}),We.write(t)}function t8(){return{"!type":"dialog"}}function r8(){return{"!type":"dialog"}}function n8(){return{"!type":"macro"}}function a8(){return{"!type":"macro"}}var Ii=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,l?c+=t.r:--c,a+(o?"":"$")+jt(d)+(l?"":"$")+Yt(c)}return function(a,s){return t=s,a.replace(e,r)}}(),WS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,s8=function(){return function(t,r){return t.replace(WS,function(n,a,s,i,o,l){var c=Np(i)-(s?0:r.c),d=Cp(l)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+f+"C"+h})}}();function KS(e,t){return e.replace(WS,function(r,n,a,s,i,o){return n+(a=="$"?a+s:jt(Np(s)+t.c))+(i=="$"?i+o:Yt(Cp(o)+t.r))})}function i8(e,t,r){var n=yo(t),a=n.s,s=xr(r),i={r:s.r-a.r,c:s.c-a.c};return KS(e,i)}function o8(e){return e.length!=1}function qg(e){return e.replace(/_xlfn\./g,"")}function Et(e){e.l+=1}function ss(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function GS(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return YS(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=ss(e,2),o=ss(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function YS(e){var t=ss(e,2),r=ss(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function l8(e,t,r){if(r.biff<8)return YS(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=ss(e,2),i=ss(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function XS(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return c8(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ss(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function c8(e){var t=ss(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function u8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function d8(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return f8(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function f8(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function h8(e,t,r){var n=(e[e.l++]&96)>>5,a=GS(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function m8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=GS(e,s,r);return[n,a,i]}function p8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function x8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function g8(e,t,r){var n=(e[e.l++]&96)>>5,a=l8(e,t-1,r);return[n,a]}function v8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Qg(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function y8(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function w8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function k8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function S8(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function E8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function qS(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function _8(e){return e.read_shift(2),qS(e)}function b8(e){return e.read_shift(2),qS(e)}function T8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=XS(e,0,r);return[n,a]}function C8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=d8(e,0,r);return[n,a]}function N8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=XS(e,0,r);return[n,a,s]}function A8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Fj[a],ZS[a],n]}function F8(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:P8(e);return[a,(s[0]===0?ZS:Aj)[s[1]]]}function P8(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function R8(e,t,r){e.l+=r&&r.biff==2?3:4}function D8(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function j8(e){return e.l++,oi[e.read_shift(1)]}function I8(e){return e.l++,e.read_shift(2)}function O8(e){return e.l++,e.read_shift(1)!==0}function M8(e){return e.l++,ar(e)}function L8(e,t,r){return e.l++,vc(e,t-1,r)}function B8(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=wt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=oi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ar(e);break;case 2:r[1]=li(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function U8(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?ii:ed)(e));return a}function $8(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=B8(e,r.biff);return i}function z8(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function V8(e,t,r){if(r.biff==5)return H8(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function H8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function W8(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function K8(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function G8(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Y8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var X8=lr,q8=lr,Q8=lr;function wc(e,t,r){return e.l+=2,[u8(e)]}function Op(e){return e.l+=6,[]}var J8=wc,Z8=Op,ej=Op,tj=wc;function QS(e){return e.l+=2,[bt(e),e.read_shift(2)&1]}var rj=wc,nj=QS,aj=Op,sj=wc,ij=wc,oj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lj(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=oj[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function cj(e){return e.l+=2,[e.read_shift(4)]}function uj(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function dj(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function fj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function mj(e){return e.l+=4,[0,0]}var Jg={1:{n:"PtgExp",f:D8},2:{n:"PtgTbl",f:Q8},3:{n:"PtgAdd",f:Et},4:{n:"PtgSub",f:Et},5:{n:"PtgMul",f:Et},6:{n:"PtgDiv",f:Et},7:{n:"PtgPower",f:Et},8:{n:"PtgConcat",f:Et},9:{n:"PtgLt",f:Et},10:{n:"PtgLe",f:Et},11:{n:"PtgEq",f:Et},12:{n:"PtgGe",f:Et},13:{n:"PtgGt",f:Et},14:{n:"PtgNe",f:Et},15:{n:"PtgIsect",f:Et},16:{n:"PtgUnion",f:Et},17:{n:"PtgRange",f:Et},18:{n:"PtgUplus",f:Et},19:{n:"PtgUminus",f:Et},20:{n:"PtgPercent",f:Et},21:{n:"PtgParen",f:Et},22:{n:"PtgMissArg",f:Et},23:{n:"PtgStr",f:L8},26:{n:"PtgSheet",f:uj},27:{n:"PtgEndSheet",f:dj},28:{n:"PtgErr",f:j8},29:{n:"PtgBool",f:O8},30:{n:"PtgInt",f:I8},31:{n:"PtgNum",f:M8},32:{n:"PtgArray",f:v8},33:{n:"PtgFunc",f:A8},34:{n:"PtgFuncVar",f:F8},35:{n:"PtgName",f:z8},36:{n:"PtgRef",f:T8},37:{n:"PtgArea",f:h8},38:{n:"PtgMemArea",f:W8},39:{n:"PtgMemErr",f:X8},40:{n:"PtgMemNoMem",f:q8},41:{n:"PtgMemFunc",f:K8},42:{n:"PtgRefErr",f:G8},43:{n:"PtgAreaErr",f:p8},44:{n:"PtgRefN",f:C8},45:{n:"PtgAreaN",f:g8},46:{n:"PtgMemAreaN",f:fj},47:{n:"PtgMemNoMemN",f:hj},57:{n:"PtgNameX",f:V8},58:{n:"PtgRef3d",f:N8},59:{n:"PtgArea3d",f:m8},60:{n:"PtgRefErr3d",f:Y8},61:{n:"PtgAreaErr3d",f:x8},255:{}},pj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xj={1:{n:"PtgElfLel",f:QS},2:{n:"PtgElfRw",f:sj},3:{n:"PtgElfCol",f:J8},6:{n:"PtgElfRwV",f:ij},7:{n:"PtgElfColV",f:tj},10:{n:"PtgElfRadical",f:rj},11:{n:"PtgElfRadicalS",f:aj},13:{n:"PtgElfColS",f:Z8},15:{n:"PtgElfColSV",f:ej},16:{n:"PtgElfRadicalLel",f:nj},25:{n:"PtgList",f:lj},29:{n:"PtgSxName",f:cj},255:{}},gj={0:{n:"PtgAttrNoop",f:mj},1:{n:"PtgAttrSemi",f:E8},2:{n:"PtgAttrIf",f:k8},4:{n:"PtgAttrChoose",f:y8},8:{n:"PtgAttrGoto",f:w8},16:{n:"PtgAttrSum",f:R8},32:{n:"PtgAttrBaxcel",f:Qg},33:{n:"PtgAttrBaxcel",f:Qg},64:{n:"PtgAttrSpace",f:_8},65:{n:"PtgAttrSpaceSemi",f:b8},128:{n:"PtgAttrIfError",f:S8},255:{}};function kc(e,t,r,n){if(n.biff<8)return lr(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=$8(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=U8(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(lr(e,t)),s}function Sc(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Jg[s]||Jg[pj[s]],(s===24||s===25)&&(a=(s===24?xj:gj)[e[e.l+1]]),!a||!a.f?lr(e,t):i.push([a.n,a.f(e,t,r)]);return i}function vj(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var yj={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function wj(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function JS(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Zg(e,t,r){var n=JS(e,t,r);return n=="#REF"?n:wj(n,r)}function tr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,d,f=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",g=0,y=e[0].length;g<y;++g){var w=e[0][g];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=gt(" ",e[0][m][1][1]);break;case 1:v=gt("\r",e[0][m][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+v,m=-1}o.push(c+yj[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=ll(w[1][1],i,a),o.push(cl(d,s));break;case"PtgRefN":d=r?ll(w[1][1],r,a):w[1][1],o.push(cl(d,s));break;case"PtgRef3d":f=w[1][1],d=ll(w[1][2],i,a),x=Zg(n,f,a),o.push(x+"!"+cl(d,s));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],A=w[1][1];S||(S=0),S&=127;var T=S==0?[]:o.slice(-S);o.length-=S,A==="User"&&(A=T.shift()),o.push(A+"("+T.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=Dg(w[1][1],r?{s:r}:i,a),o.push(Yd(p,a));break;case"PtgArea":p=Dg(w[1][1],i,a),o.push(Yd(p,a));break;case"PtgArea3d":f=w[1][1],p=w[1][2],x=Zg(n,f,a),o.push(x+"!"+Yd(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var b=(n.names||[])[h-1]||(n[0]||[])[h],k=b?b.Name:"SH33TJSNAME"+String(h);k&&k.slice(0,6)=="_xlfn."&&!a.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var E=w[1][1];h=w[1][2];var _;if(a.biff<=5)E<0&&(E=-E),n[E]&&(_=n[E][h]);else{var C="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][h]&&n[E][h].itab>0&&(C=n.SheetNames[n[E][h].itab-1]+"!"):C=n.SheetNames[h-1]+"!"),n[E]&&n[E][h])C+=n[E][h].Name;else if(n[0]&&n[0][h])C+=n[0][h].Name;else{var F=(JS(n,E,a)||"").split(";;");F[h-1]?C=F[h-1]:C+="SH33TJSERRX"}o.push(C);break}_||(_={Name:"SH33TJSERRY"}),o.push(_.Name);break;case"PtgParen":var D="(",M=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:D=gt(" ",e[0][m][1][1])+D;break;case 3:D=gt("\r",e[0][m][1][1])+D;break;case 4:M=gt(" ",e[0][m][1][1])+M;break;case 5:M=gt("\r",e[0][m][1][1])+M;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(D+o.pop()+M);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var B={c:r.c,r:r.r};if(n.sharedf[Re(d)]){var q=n.sharedf[Re(d)];o.push(tr(q,i,B,n,a))}else{var Q=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(d.c<c[0].s.c||d.c>c[0].e.c)&&!(d.r<c[0].s.r||d.r>c[0].e.r)){o.push(tr(c[1],i,B,n,a)),Q=!0;break}Q||o.push(w[1])}break;case"PtgArray":o.push("{"+vj(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&J.indexOf(e[0][g][0])==-1){w=e[0][m];var P=!0;switch(w[1][0]){case 4:P=!1;case 0:v=gt(" ",w[1][1]);break;case 5:P=!1;case 1:v=gt("\r",w[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((P?v:"")+o.pop()+(P?"":v)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function kj(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],lr(e,t-2)];var o=Sc(e,i,r);return t!==i+a&&(s=kc(e,t-i-a,o,r)),e.l=n,[o,s]}function Sj(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],lr(e,t-2)];var o=Sc(e,i,r);return t!==i+a&&(s=kc(e,t-i-a,o,r)),e.l=n,[o,s]}function Ej(e,t,r,n){var a=e.l+t,s=Sc(e,n,r),i;return a!==e.l&&(i=kc(e,a-e.l,s,r)),[s,i]}function _j(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Sc(e,s,r);return s==65535?[[],lr(e,t-2)]:(t!==s+2&&(a=kc(e,n-s-2,i,r)),[i,a])}function bj(e){var t;if(ra(e,e.l+6)!==65535)return[ar(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Qd(e,t,r){var n=e.l+t,a=Kn(e);r.biff==2&&++e.l;var s=bj(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Sj(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function td(e,t,r){var n=e.read_shift(4),a=Sc(e,n,r),s=e.read_shift(4),i=s>0?kc(e,s,a,r):null;return[a,i]}var Tj=td,rd=td,Cj=td,Nj=td,Aj={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ZS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Fj={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ev(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Jd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var hl={},Oi={};function ml(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function eE(e,t,r,n,a,s){try{n.cellNF&&(e.z=Me[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$t(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Me[t]==null&&$s(RP[t]||"General",t),e.t==="e")e.w=e.w||oi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ul(e.v);else if(e.t==="d"){var i=yr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Ul(i)}else{if(e.v===void 0)return"";e.w=Qs(e.v,Oi)}else e.t==="d"?e.w=on(t,yr(e.v),Oi):e.w=on(t,e.v,Oi)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=p0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=p0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function Pj(e,t){var r=vt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var Rj=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Dj=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,jj=/<(?:\w:)?hyperlink [^>]*>/mg,Ij=/"(\w*:\w*)"/,Oj=/<(?:\w:)?col\b[^>]*[\/]?>/g,Mj=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Lj=/<(?:\w:)?pageMargins[^>]*\/>/g,tE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Bj=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Uj=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $j(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",f=e.match(Dj);f?(c=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):c=d=e;var h=c.match(tE);h?Mp(h[0],o,a,r):(h=c.match(Bj))&&zj(h[0],h[1]||"",o,a,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(Ij);x&&Pj(o,x[1])}var m=c.match(Uj);m&&m[1]&&Yj(m[1],a);var v=[];if(t.cellStyles){var g=c.match(Oj);g&&Wj(v,g)}f&&Xj(f[1],o,t,l,s,i);var y=d.match(Mj);y&&(o["!autofilter"]=Kj(y[0]));var w=[],S=d.match(Rj);if(S)for(p=0;p!=S.length;++p)w[p]=vt(S[p].slice(S[p].indexOf('"')+1));var A=d.match(jj);A&&Vj(o,A,n);var T=d.match(Lj);if(T&&(o["!margins"]=Hj(Ne(T[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ke(l)),t.sheetRows>0&&o["!ref"]){var b=vt(o["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>l.e.r&&(b.e.r=l.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>l.e.c&&(b.e.c=l.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ke(b))}return v.length>0&&(o["!cols"]=v),w.length>0&&(o["!merges"]=w),o}function Mp(e,t,r,n){var a=Ne(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ye(tt(a.codeName)))}function zj(e,t,r,n,a){Mp(e.slice(0,e.indexOf(">")),r,n,a)}function Vj(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ne(tt(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Ye(s.location))):(s.Target="#"+Ye(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=vt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=Re({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function Hj(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Wj(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ne(t[n],!0);a.hidden&&(a.hidden=ot(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Ip(a.width)),co(a);s<=i;)e[s++]=Gt(a)}}function Kj(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var Gj=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Yj(e,t){t.Views||(t.Views=[{}]),(e.match(Gj)||[]).forEach(function(r,n){var a=Ne(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),ot(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var Xj=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=$l("v"),i=$l("f");return function(l,c,d,f,h,p){for(var x=0,m="",v=[],g=[],y=0,w=0,S=0,A="",T,b,k=0,E=0,_,C,F=0,D=0,M=Array.isArray(p.CellXf),B,q=[],Q=[],J=Array.isArray(c),P=[],Z={},le=!1,R=!!d.sheetStubs,G=l.split(t),W=0,K=G.length;W!=K;++W){m=G[W].trim();var O=m.length;if(O!==0){var X=0;e:for(x=0;x<O;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(b=Ne(m.slice(X,x),!0),k=b.r!=null?parseInt(b.r,10):k+1,E=-1,d.sheetRows&&d.sheetRows<k)continue;Z={},le=!1,b.ht&&(le=!0,Z.hpt=parseFloat(b.ht),Z.hpx=Wl(Z.hpt)),b.hidden=="1"&&(le=!0,Z.hidden=!0),b.outlineLevel!=null&&(le=!0,Z.level=+b.outlineLevel),le&&(P[k-1]=Z)}break;case"<":X=x;break}if(X>=x)break;if(b=Ne(m.slice(X,x),!0),k=b.r!=null?parseInt(b.r,10):k+1,E=-1,!(d.sheetRows&&d.sheetRows<k)){f.s.r>k-1&&(f.s.r=k-1),f.e.r<k-1&&(f.e.r=k-1),d&&d.cellStyles&&(Z={},le=!1,b.ht&&(le=!0,Z.hpt=parseFloat(b.ht),Z.hpx=Wl(Z.hpt)),b.hidden=="1"&&(le=!0,Z.hidden=!0),b.outlineLevel!=null&&(le=!0,Z.level=+b.outlineLevel),le&&(P[k-1]=Z)),v=m.slice(x).split(e);for(var se=0;se!=v.length&&v[se].trim().charAt(0)=="<";++se);for(v=v.slice(se),x=0;x!=v.length;++x)if(m=v[x].trim(),m.length!==0){if(g=m.match(r),y=x,w=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,g!=null&&g.length===2){for(y=0,A=g[1],w=0;w!=A.length&&!((S=A.charCodeAt(w)-64)<1||S>26);++w)y=26*y+S;--y,E=y}else++E;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,b=Ne(m.slice(0,w),!0),b.r||(b.r=Re({r:k-1,c:E})),A=m.slice(w),T={t:""},(g=A.match(s))!=null&&g[1]!==""&&(T.v=Ye(g[1])),d.cellFormula){if((g=A.match(i))!=null&&g[1]!==""){if(T.f=Ye(tt(g[1])).replace(/\r\n/g,`
`),d.xlfn||(T.f=qg(T.f)),g[0].indexOf('t="array"')>-1)T.F=(A.match(a)||[])[1],T.F.indexOf(":")>-1&&q.push([vt(T.F),T.F]);else if(g[0].indexOf('t="shared"')>-1){C=Ne(g[0]);var ie=Ye(tt(g[1]));d.xlfn||(ie=qg(ie)),Q[parseInt(C.si,10)]=[C,ie,b.r]}}else(g=A.match(/<f[^>]*\/>/))&&(C=Ne(g[0]),Q[C.si]&&(T.f=i8(Q[C.si][1],Q[C.si][2],b.r)));var oe=xr(b.r);for(w=0;w<q.length;++w)oe.r>=q[w][0].s.r&&oe.r<=q[w][0].e.r&&oe.c>=q[w][0].s.c&&oe.c<=q[w][0].e.c&&(T.F=q[w][1])}if(b.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(R)T.t="z";else continue;else T.t=b.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),T.t){case"n":if(T.v==""||T.v==null){if(!R)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!R)continue;T.t="z"}else _=hl[parseInt(T.v,10)],T.v=_.t,T.r=_.r,d.cellHTML&&(T.h=_.h);break;case"str":T.t="s",T.v=T.v!=null?tt(T.v):"",d.cellHTML&&(T.h=_p(T.v));break;case"inlineStr":g=A.match(n),T.t="s",g!=null&&(_=jp(g[1]))?(T.v=_.t,d.cellHTML&&(T.h=_.h)):T.v="";break;case"b":T.v=ot(T.v);break;case"d":d.cellDates?T.v=$t(T.v,1):(T.v=yr($t(T.v,1)),T.t="n");break;case"e":(!d||d.cellText!==!1)&&(T.w=T.v),T.v=SS[T.v];break}if(F=D=0,B=null,M&&b.s!==void 0&&(B=p.CellXf[b.s],B!=null&&(B.numFmtId!=null&&(F=B.numFmtId),d.cellStyles&&B.fillId!=null&&(D=B.fillId))),eE(T,F,D,d,h,p),d.cellDates&&M&&T.t=="n"&&vo(Me[F])&&(T.t="d",T.v=Z0(T.v)),b.cm&&d.xlmeta){var ue=(d.xlmeta.Cell||[])[+b.cm-1];ue&&ue.type=="XLDAPR"&&(T.D=!0)}if(J){var L=xr(b.r);c[L.r]||(c[L.r]=[]),c[L.r][L.c]=T}else c[b.r]=T}}}}P.length>0&&(c["!rows"]=P)}}();function qj(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var Qj=ii;function Jj(){}function Zj(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=kR(e),r}function eI(e){var t=ln(e);return[t]}function tI(e){var t=si(e);return[t]}function rI(e){var t=ln(e),r=e.read_shift(1);return[t,r,"b"]}function nI(e){var t=si(e),r=e.read_shift(1);return[t,r,"b"]}function aI(e){var t=ln(e),r=e.read_shift(1);return[t,r,"e"]}function sI(e){var t=si(e),r=e.read_shift(1);return[t,r,"e"]}function iI(e){var t=ln(e),r=e.read_shift(4);return[t,r,"s"]}function oI(e){var t=si(e),r=e.read_shift(4);return[t,r,"s"]}function lI(e){var t=ln(e),r=ar(e);return[t,r,"n"]}function rE(e){var t=si(e),r=ar(e);return[t,r,"n"]}function cI(e){var t=ln(e),r=Pp(e);return[t,r,"n"]}function uI(e){var t=si(e),r=Pp(e);return[t,r,"n"]}function dI(e){var t=ln(e),r=Ap(e);return[t,r,"is"]}function fI(e){var t=ln(e),r=ir(e);return[t,r,"str"]}function hI(e){var t=si(e),r=ir(e);return[t,r,"str"]}function mI(e,t,r){var n=e.l+t,a=ln(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=rd(e,n-e.l,r);i[3]=tr(o,null,a,r.supbooks,r)}else e.l=n;return i}function pI(e,t,r){var n=e.l+t,a=ln(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=rd(e,n-e.l,r);i[3]=tr(o,null,a,r.supbooks,r)}else e.l=n;return i}function xI(e,t,r){var n=e.l+t,a=ln(e);a.r=r["!row"];var s=ar(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=rd(e,n-e.l,r);i[3]=tr(o,null,a,r.supbooks,r)}else e.l=n;return i}function gI(e,t,r){var n=e.l+t,a=ln(e);a.r=r["!row"];var s=ir(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=rd(e,n-e.l,r);i[3]=tr(o,null,a,r.supbooks,r)}else e.l=n;return i}var vI=ii;function yI(e,t){var r=e.l+t,n=ii(e),a=Fp(e),s=ir(e),i=ir(e),o=ir(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function wI(){}function kI(e,t,r){var n=e.l+t,a=yS(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=Tj(e,n-e.l,r);i[1]=o}else e.l=n;return i}function SI(e,t,r){var n=e.l+t,a=ii(e),s=[a];if(r.cellFormula){var i=Nj(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var EI=["left","right","top","bottom","header","footer"];function _I(e){var t={};return EI.forEach(function(r){t[r]=ar(e)}),t}function bI(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function TI(){}function CI(){}function NI(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,x,m,v,g,y,w,S,A,T=[];o.biff=12,o["!row"]=0;var b=0,k=!1,E=[],_={},C=o.supbooks||a.supbooks||[[]];if(C.sharedf=_,C.arrayf=E,C.SheetNames=a.SheetNames||a.Sheets.map(function(J){return J.name}),!o.supbooks&&(o.supbooks=C,a.Names))for(var F=0;F<a.Names.length;++F)C[0][F+1]=a.Names[F];var D=[],M=[],B=!1;v0[16]={n:"BrtShortReal",f:rE};var q;if(xa(e,function(P,Z,le){if(!h)switch(le){case 148:c=P;break;case 0:p=P,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),S=Yt(v=p.r),o["!row"]=p.r,(P.hidden||P.hpt||P.level!=null)&&(P.hpt&&(P.hpx=Wl(P.hpt)),M[P.r]=P);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:P[2]},P[2]){case"n":x.v=P[1];break;case"s":w=hl[P[1]],x.v=w.t,x.r=w.r;break;case"b":x.v=!!P[1];break;case"e":x.v=P[1],o.cellText!==!1&&(x.w=oi[x.v]);break;case"str":x.t="s",x.v=P[1];break;case"is":x.t="s",x.v=P[1].t;break}if((m=i.CellXf[P[0].iStyleRef])&&eE(x,m.numFmtId,null,o,s,i),g=P[0].c==-1?g+1:P[0].c,o.dense?(l[v]||(l[v]=[]),l[v][g]=x):l[jt(g)+S]=x,o.cellFormula){for(k=!1,b=0;b<E.length;++b){var R=E[b];p.r>=R[0].s.r&&p.r<=R[0].e.r&&g>=R[0].s.c&&g<=R[0].e.c&&(x.F=Ke(R[0]),k=!0)}!k&&P.length>3&&(x.f=P[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>g&&(d.s.c=g),d.e.r<p.r&&(d.e.r=p.r),d.e.c<g&&(d.e.c=g),o.cellDates&&m&&x.t=="n"&&vo(Me[m.numFmtId])){var G=_s(x.v);G&&(x.t="d",x.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},g=P[0].c==-1?g+1:P[0].c,o.dense?(l[v]||(l[v]=[]),l[v][g]=x):l[jt(g)+S]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>g&&(d.s.c=g),d.e.r<p.r&&(d.e.r=p.r),d.e.c<g&&(d.e.c=g),q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 176:T.push(P);break;case 49:q=((o.xlmeta||{}).Cell||[])[P-1];break;case 494:var W=n["!id"][P.relId];for(W?(P.Target=W.Target,P.loc&&(P.Target+="#"+P.loc),P.Rel=W):P.relId==""&&(P.Target="#"+P.loc),v=P.rfx.s.r;v<=P.rfx.e.r;++v)for(g=P.rfx.s.c;g<=P.rfx.e.c;++g)o.dense?(l[v]||(l[v]=[]),l[v][g]||(l[v][g]={t:"z",v:void 0}),l[v][g].l=P):(y=Re({c:g,r:v}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=P);break;case 426:if(!o.cellFormula)break;E.push(P),A=o.dense?l[v][g]:l[jt(g)+S],A.f=tr(P[1],d,{r:p.r,c:g},C,o),A.F=Ke(P[0]);break;case 427:if(!o.cellFormula)break;_[Re(P[0].s)]=P[1],A=o.dense?l[v][g]:l[jt(g)+S],A.f=tr(P[1],d,{r:p.r,c:g},C,o);break;case 60:if(!o.cellStyles)break;for(;P.e>=P.s;)D[P.e--]={width:P.w/256,hidden:!!(P.flags&1),level:P.level},B||(B=!0,Ip(P.w/256)),co(D[P.e+1]);break;case 161:l["!autofilter"]={ref:Ke(P)};break;case 476:l["!margins"]=P;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),P.name&&(a.Sheets[r].CodeName=P.name),(P.above||P.left)&&(l["!outline"]={above:P.above,left:P.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),P.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!Z.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+le.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ke(c||d)),o.sheetRows&&l["!ref"]){var Q=vt(l["!ref"]);o.sheetRows<=+Q.e.r&&(Q.e.r=o.sheetRows-1,Q.e.r>d.e.r&&(Q.e.r=d.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>d.e.c&&(Q.e.c=d.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ke(Q))}return T.length>0&&(l["!merges"]=T),D.length>0&&(l["!cols"]=D),M.length>0&&(l["!rows"]=M),l}function AI(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=Ye((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function FI(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=AI(f);d.s.r=d.s.c=0,d.e.c=o,c=jt(o),h[0].forEach(function(p,x){i[c+Yt(x)]={t:"n",v:p,z:h[1]},l=x}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=Ke(d)),i}function PI(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(tE);return o&&Mp(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function RI(e,t){e.l+=10;var r=ir(e);return{name:r}}function DI(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return xa(e,function(l,c,d){switch(d){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var nE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jI=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],II=[],OI=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function tv(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ot(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function rv(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ot(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function aE(e){rv(e.WBProps,nE),rv(e.CalcPr,OI),tv(e.WBView,jI),tv(e.Sheets,II),Oi.date1904=ot(e.WBProps.date1904)}var MI="][*?/\\".split("");function LI(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return MI.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var BI=/<\w+:workbook/;function UI(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(cr,function(l,c){var d=Ne(l);switch(Wn(d[0])){case"<?xml":break;case"<workbook":l.match(BI)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":nE.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=ot(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=tt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ye(tt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=tt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),ot(d.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=Ye(tt(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),aR.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return aE(r),r}function $I(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ah(e),r.name=ir(e),r}function zI(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ir(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function VI(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function HI(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=SR(e),i=Cj(e,0,r),o=Fp(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function WI(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],v0[16]={n:"BrtFRTArchID$",f:VI},xa(e,function(l,c,d){switch(d){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=tr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),aE(r),r.Names=s,r.supbooks=i,r}function KI(e,t,r){return t.slice(-4)===".bin"?WI(e,r):UI(e,r)}function GI(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?NI(e,n,r,a,s,i,o):$j(e,n,r,a,s,i,o)}function YI(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?DI(e,n,r,a,s):PI(e,n,r,a,s)}function XI(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?n8():a8()}function qI(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?t8():r8()}function QI(e,t,r,n){return t.slice(-4)===".bin"?v5(e,r,n):f5(e,r,n)}function JI(e,t,r){return HS(e,r)}function ZI(e,t,r){return t.slice(-4)===".bin"?j6(e,r):R6(e,r)}function eO(e,t,r){return t.slice(-4)===".bin"?J5(e,r):G5(e,r)}function tO(e,t,r){return t.slice(-4)===".bin"?H5(e):z5(e)}function rO(e,t,r,n){return r.slice(-4)===".bin"?W5(e,t,r,n):void 0}function nO(e,t,r){return t.slice(-4)===".bin"?U5(e,t,r):$5(e,t,r)}var sE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,iE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function un(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var a=e.match(sE),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(iE),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function aO(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(sE),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(iE),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var pl;function sO(e,t){var r=pl[e]||Ye(e);return r==="General"?Qs(t):on(r,t)}function iO(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ot(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=$t(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ye(t)]=a}function oO(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||oi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ul(e.v):e.w=Qs(e.v):e.w=sO(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=pl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&vo(n)){var a=_s(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function lO(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=i5[n.Pattern]||n.Pattern)}e[t.ID]=t}function cO(e,t,r,n,a,s,i,o,l,c){var d="General",f=n.StyleID,h={};c=c||{};var p=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ot(e);break;case"String":n.t="s",n.r=_g(Ye(e)),n.v=e.indexOf("<")>-1?Ye(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=($t(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ye(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=SS[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=_g(t||e));break}if(oO(n,d,c),c.cellFormula!==!1)if(n.Formula){var m=Ye(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Ii(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Ii("RC:RC",a):n.ArrayRange&&(n.F=Ii(n.ArrayRange,a),l.push([vt(n.F),n.F]))}else for(x=0;x<l.length;++x)a.r>=l[x][0].s.r&&a.r<=l[x][0].e.r&&a.c>=l[x][0].s.c&&a.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function uO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Zd(e,t){var r=t||{};Gk();var n=Vo(bp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=tt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Gt(r);return i.type="string",Vl.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(be){a.indexOf("<"+be)>=0&&(s=!0)}),s)return yO(n,r);pl={"General Number":"General","General Date":Me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Me[15],"Short Date":Me[14],"Long Time":Me[19],"Medium Time":Me[18],"Short Time":Me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Me[2],Standard:Me[4],Percent:Me[10],Scientific:Me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,d={},f=[],h=r.dense?[]:{},p="",x={},m={},v=un('<Data ss:Type="String">'),g=0,y=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},T={},b="",k=0,E=[],_={},C={},F=0,D=[],M=[],B={},q=[],Q,J=!1,P=[],Z=[],le={},R=0,G=0,W={Sheets:[],WBProps:{date1904:!1}},K={};zl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var O="";o=zl.exec(n);)switch(o[3]=(O=o[3]).toLowerCase()){case"data":if(O=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?cO(n.slice(g,o.index),b,v,l[l.length-1][0]=="comment"?B:x,{c:y,r:w},A,q[y],m,P,r):(b="",v=un(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(M.length>0&&(x.c=M),(!r.sheetRows||r.sheetRows>w)&&x.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][y]=x):h[jt(y)+Yt(w)]=x),x.HRef&&(x.l={Target:Ye(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(R=y+(parseInt(x.MergeAcross,10)|0),G=w+(parseInt(x.MergeDown,10)|0),E.push({s:{c:y,r:w},e:{c:R,r:G}})),!r.sheetStubs)x.MergeAcross?y=R+1:++y;else if(x.MergeAcross||x.MergeDown){for(var X=y;X<=R;++X)for(var se=w;se<=G;++se)(X>y||se>w)&&(r.dense?(h[se]||(h[se]=[]),h[se][X]={t:"z"}):h[jt(X)+Yt(se)]={t:"z"});y=R+1}else++y;else x=aO(o[0]),x.Index&&(y=+x.Index-1),y<S.s.c&&(S.s.c=y),y>S.e.c&&(S.e.c=y),o[0].slice(-2)==="/>"&&++y,M=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),o[0].slice(-2)==="/>"&&(m=un(o[0]),m.Index&&(w=+m.Index-1)),y=0,++w):(m=un(o[0]),m.Index&&(w=+m.Index-1),le={},(m.AutoFitHeight=="0"||m.Height)&&(le.hpx=parseInt(m.Height,10),le.hpt=VS(le.hpx),Z[w]=le),m.Hidden=="1"&&(le.hidden=!0,Z[w]=le));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=Ke(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=Ke(S))),E.length&&(h["!merges"]=E),q.length>0&&(h["!cols"]=q),Z.length>0&&(h["!rows"]=Z),d[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,l.push([o[3],!1]),c=un(o[0]),p=Ye(c.Name),h=r.dense?[]:{},E=[],P=[],Z=[],K={name:p,Hidden:0},W.Sheets.push(K);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),q=[],J=!1}break;case"style":o[1]==="/"?lO(A,T,r):T=un(o[0]);break;case"numberformat":T.nf=Ye(un(o[0]).Format||"General"),pl[T.nf]&&(T.nf=pl[T.nf]);for(var ie=0;ie!=392&&Me[ie]!=T.nf;++ie);if(ie==392){for(ie=57;ie!=392;++ie)if(Me[ie]==null){$s(T.nf,ie);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Q=un(o[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!J&&Q.wpx>10){J=!0,mr=$S;for(var oe=0;oe<q.length;++oe)q[oe]&&co(q[oe])}J&&co(Q),q[Q.Index-1||q.length]=Q;for(var ue=0;ue<+Q.Span;++ue)q[q.length]=Gt(Q);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var L=Ne(o[0]),Pe={Name:L.Name,Ref:Ii(L.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(Pe.Sheet=W.Sheets.length-1),W.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?b+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=un(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?GR(_,O,n.slice(F,o.index)):F=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));uO(B),M.push(B)}else l.push([o[3],!1]),c=un(o[0]),B={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=un(o[0]);h["!autofilter"]={ref:Ii(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return lv(n,r);var Se=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Se=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Se=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Se=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Se=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(F,o.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else F=o.index+o[0].length;break;case"header":h["!margins"]||ml(h["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(h["!margins"].header=+Ne(o[0]).Margin);break;case"footer":h["!margins"]||ml(h["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(h["!margins"].footer=+Ne(o[0]).Margin);break;case"pagemargins":var xe=Ne(o[0]);h["!margins"]||ml(h["!margins"]={},"xlml"),isNaN(+xe.Top)||(h["!margins"].top=+xe.Top),isNaN(+xe.Left)||(h["!margins"].left=+xe.Left),isNaN(+xe.Right)||(h["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(h["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Se=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Se=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Se=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Se=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Se=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Se=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Se=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Se=!1}break;case"smarttags":break;default:Se=!1;break}if(Se||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?iO(C,O,D,n.slice(F,o.index)):(D=o,F=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var de={};return!r.bookSheets&&!r.bookProps&&(de.Sheets=d),de.SheetNames=f,de.Workbook=W,de.SSF=Gt(Me),de.Props=_,de.Custprops=C,de}function Dh(e,t){switch(Up(t=t||{}),t.type||"base64"){case"base64":return Zd(Vr(e),t);case"binary":case"buffer":case"file":return Zd(e,t);case"array":return Zd(ai(e),t)}}function dO(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=bR(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=TR(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var fO=[60,1084,2066,2165,2175];function hO(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=ra(r,r.l),c=jh[l],d=0;c!=null&&fO.indexOf(l)>-1;)s=ra(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),i.push(o),r.l+=4+s,c=jh[l=ra(r,r.l)];var f=Ca(i);Ht(f,0);var h=0;f.lens=[];for(var p=0;p<i.length;++p)f.lens.push(h),h+=i[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function An(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Me[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||oi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ul(e.v):e.w=Qs(e.v):e.w=on(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&vo(Me[n]||String(n))){var a=_s(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function au(e,t,r){return{v:e,ixfe:t,t:r}}function mO(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",d={},f,h="",p,x,m,v,g={},y=[],w,S,A=[],T=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},E=function(Be){return Be<8?zs[Be]:Be<64&&T[Be-8]||zs[Be]},_=function(Be,Je,ct){var nt=Je.XF.data;if(!(!nt||!nt.patternType||!ct||!ct.cellStyles)){Je.s={},Je.s.patternType=nt.patternType;var Tn;(Tn=Hl(E(nt.icvFore)))&&(Je.s.fgColor={rgb:Tn}),(Tn=Hl(E(nt.icvBack)))&&(Je.s.bgColor={rgb:Tn})}},C=function(Be,Je,ct){if(!(le>1)&&!(ct.sheetRows&&Be.r>=ct.sheetRows)){if(ct.cellStyles&&Je.XF&&Je.XF.data&&_(Be,Je,ct),delete Je.ixfe,delete Je.XF,f=Be,h=Re(Be),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Be.r<i.s.r&&(i.s.r=Be.r),Be.c<i.s.c&&(i.s.c=Be.c),Be.r+1>i.e.r&&(i.e.r=Be.r+1),Be.c+1>i.e.c&&(i.e.c=Be.c+1),ct.cellFormula&&Je.f){for(var nt=0;nt<y.length;++nt)if(!(y[nt][0].s.c>Be.c||y[nt][0].s.r>Be.r)&&!(y[nt][0].e.c<Be.c||y[nt][0].e.r<Be.r)){Je.F=Ke(y[nt][0]),(y[nt][0].s.c!=Be.c||y[nt][0].s.r!=Be.r)&&delete Je.f,Je.f&&(Je.f=""+tr(y[nt][1],i,Be,P,F));break}}ct.dense?(a[Be.r]||(a[Be.r]=[]),a[Be.r][Be.c]=Je):a[h]=Je}},F={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var D,M=[],B=[],q=[],Q=[],J=!1,P=[];P.SheetNames=F.snames,P.sharedf=F.sharedf,P.arrayf=F.arrayf,P.names=[],P.XTI=[];var Z=0,le=0,R=0,G=[],W=[],K;F.codepage=1200,vn(1200);for(var O=!1;e.l<e.length-1;){var X=e.l,se=e.read_shift(2);if(se===0&&Z===10)break;var ie=e.l===e.length?0:e.read_shift(2),oe=jh[se];if(oe&&oe.f){if(t.bookSheets&&Z===133&&se!==133)break;if(Z=se,oe.r===2||oe.r==12){var ue=e.read_shift(2);if(ie-=2,!F.enc&&ue!==se&&((ue&255)<<8|ue>>8)!==se)throw new Error("rt mismatch: "+ue+"!="+se);oe.r==12&&(e.l+=10,ie-=10)}var L={};if(se===10?L=oe.f(e,ie,F):L=hO(se,oe,e,ie,F),le==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(se){case 34:r.opts.Date1904=b.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=L;break;case 66:var Pe=Number(L);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}vn(F.codepage=Pe),O=!0;break;case 317:F.rrtabid=L;break;case 25:F.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:F.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(a["!type"]="dialog"),L.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),L.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:A.push(L);break;case 430:P.push([L]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(L);break;case 24:case 536:K={Name:L.Name,Ref:tr(L.rgce,i,null,P,F)},L.itab>0&&(K.Sheet=L.itab-1),P.names.push(K),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(W[L.itab-1]={ref:Ke(L.rgce[0][0][1][2])});break;case 22:F.ExternCount=L;break;case 23:P.length==0&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(L),P.XTI=P.XTI.concat(L);break;case 2196:if(F.biff<8)break;K!=null&&(K.Comment=L[1]);break;case 18:a["!protect"]=L;break;case 19:L!==0&&F.WTF&&console.error("Password verifier: "+L);break;case 133:s[L.pos]=L,F.snames.push(L.name);break;case 10:{if(--le)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ke(i),t.sheetRows&&t.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ke(i),i.e.r=ke}i.e.r++,i.e.c++}M.length>0&&(a["!merges"]=M),B.length>0&&(a["!objects"]=B),q.length>0&&(a["!cols"]=q),Q.length>0&&(a["!rows"]=Q),b.Sheets.push(k)}c===""?d=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),F.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(F.biff=5,O=!0,vn(F.codepage=28591)),F.biff==8&&L.BIFFVer==0&&L.dt==16&&(F.biff=2),le++)break;if(a=t.dense?[]:{},F.biff<8&&!O&&(O=!0,vn(F.codepage=t.codepage||1252)),F.biff<5||L.BIFFVer==0&&L.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Se={pos:e.l-ie,name:c};s[Se.pos]=Se,F.snames.push(c)}else c=(s[X]||{name:""}).name;L.dt==32&&(a["!type"]="chart"),L.dt==64&&(a["!type"]="macro"),M=[],B=[],F.arrayf=y=[],q=[],Q=[],J=!1,k={Hidden:(s[X]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[L.r]||[])[L.c]:a[Re({c:L.c,r:L.r})])&&++L.c,w={ixfe:L.ixfe,XF:A[L.ixfe]||{},v:L.val,t:"n"},R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:L.c,r:L.r},w,t);break;case 5:case 517:w={ixfe:L.ixfe,XF:A[L.ixfe],v:L.val,t:L.t},R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:L.c,r:L.r},w,t);break;case 638:w={ixfe:L.ixfe,XF:A[L.ixfe],v:L.rknum,t:"n"},R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:L.c,r:L.r},w,t);break;case 189:for(var xe=L.c;xe<=L.C;++xe){var de=L.rkrec[xe-L.c][0];w={ixfe:de,XF:A[de],v:L.rkrec[xe-L.c][1],t:"n"},R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:xe,r:L.r},w,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){o=L;break}if(w=au(L.val,L.cell.ixfe,L.tt),w.XF=A[w.ixfe],t.cellFormula){var be=L.formula;if(be&&be[0]&&be[0][0]&&be[0][0][0]=="PtgExp"){var Oe=be[0][0][1][0],$e=be[0][0][1][1],At=Re({r:Oe,c:$e});g[At]?w.f=""+tr(L.formula,i,L.cell,P,F):w.F=((t.dense?(a[Oe]||[])[$e]:a[At])||{}).F}else w.f=""+tr(L.formula,i,L.cell,P,F)}R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C(L.cell,w,t),o=L}break;case 7:case 519:if(o)o.val=L,w=au(L,o.cell.ixfe,"s"),w.XF=A[w.ixfe],t.cellFormula&&(w.f=""+tr(o.formula,i,o.cell,P,F)),R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(L);var Ft=Re(L[0].s);if(p=t.dense?(a[L[0].s.r]||[])[L[0].s.c]:a[Ft],t.cellFormula&&p){if(!o||!Ft||!p)break;p.f=""+tr(L[1],i,L[0],P,F),p.F=Ke(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;g[Re(o.cell)]=L[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Re(o.cell)],(p||{}).f=""+tr(L[0],i,f,P,F)}}break;case 253:w=au(l[L.isst].t,L.ixfe,"s"),l[L.isst].h&&(w.h=l[L.isst].h),w.XF=A[w.ixfe],R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:L.c,r:L.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:L.ixfe,XF:A[L.ixfe],t:"z"},R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:L.c,r:L.r},w,t));break;case 190:if(t.sheetStubs)for(var De=L.c;De<=L.C;++De){var Ce=L.ixfe[De-L.c];w={ixfe:Ce,XF:A[Ce],t:"z"},R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:De,r:L.r},w,t)}break;case 214:case 516:case 4:w=au(L.val,L.ixfe,"s"),w.XF=A[w.ixfe],R>0&&(w.z=G[w.ixfe>>8&63]),An(w,t,r.opts.Date1904),C({c:L.c,r:L.r},w,t);break;case 0:case 512:le===1&&(i=L);break;case 252:l=L;break;case 1054:if(F.biff==4){G[R++]=L[1];for(var Xe=0;Xe<R+163&&Me[Xe]!=L[1];++Xe);Xe>=163&&$s(L[1],R+163)}else $s(L[1],L[0]);break;case 30:{G[R++]=L;for(var qe=0;qe<R+163&&Me[qe]!=L;++qe);qe>=163&&$s(L,R+163)}break;case 229:M=M.concat(L);break;case 93:B[L.cmo[0]]=F.lastobj=L;break;case 438:F.lastobj.TxO=L;break;case 127:F.lastobj.ImData=L;break;case 440:for(v=L[0].s.r;v<=L[0].e.r;++v)for(m=L[0].s.c;m<=L[0].e.c;++m)p=t.dense?(a[v]||[])[m]:a[Re({c:m,r:v})],p&&(p.l=L[1]);break;case 2048:for(v=L[0].s.r;v<=L[0].e.r;++v)for(m=L[0].s.c;m<=L[0].e.c;++m)p=t.dense?(a[v]||[])[m]:a[Re({c:m,r:v})],p&&p.l&&(p.l.Tooltip=L[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;p=t.dense?(a[L[0].r]||[])[L[0].c]:a[Re(L[0])];var St=B[L[2]];p||(t.dense?(a[L[0].r]||(a[L[0].r]=[]),p=a[L[0].r][L[0].c]={t:"z"}):p=a[Re(L[0])]={t:"z"},i.e.r=Math.max(i.e.r,L[0].r),i.s.r=Math.min(i.s.r,L[0].r),i.e.c=Math.max(i.e.c,L[0].c),i.s.c=Math.min(i.s.c,L[0].c)),p.c||(p.c=[]),x={a:L[1],t:St.TxO.t},p.c.push(x)}break;case 2173:O5(A[L.ixfe],L.ext);break;case 125:{if(!F.cellStyles)break;for(;L.e>=L.s;)q[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},J||(J=!0,Ip(L.w/256)),co(q[L.e+1])}break;case 520:{var rt={};L.level!=null&&(Q[L.r]=rt,rt.level=L.level),L.hidden&&(Q[L.r]=rt,rt.hidden=!0),L.hpt&&(Q[L.r]=rt,rt.hpt=L.hpt,rt.hpx=Wl(L.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ml(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=L;break;case 161:a["!margins"]||ml(a["!margins"]={}),a["!margins"].header=L.header,a["!margins"].footer=L.footer;break;case 574:L.RTL&&(b.Views[0].RTL=!0);break;case 146:T=L;break;case 2198:D=L;break;case 140:S=L;break;case 442:c?k.CodeName=L||k.name:b.WBProps.CodeName=L||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=ie}return r.SheetNames=Hn(s).sort(function(Sr,Be){return Number(Sr)-Number(Be)}).map(function(Sr){return s[Sr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&W.forEach(function(Sr,Be){r.Sheets[r.SheetNames[Be]]["!autofilter"]=Sr}),r.Strings=l,r.SSF=Gt(Me),F.enc&&(r.Encryption=F.enc),D&&(r.Themes=D),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),P.names.length>0&&(b.Names=P.names),r.Workbook=b,r}var nv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pO(e,t,r){var n=We.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Ug(n,RR,nv.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=We.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Ug(i,DR,nv.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(_S(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function oE(e,t){t||(t={}),Up(t),Ik(),t.codepage&&vp(t.codepage);var r,n;if(e.FullPaths){if(We.find(e,"/encryption"))throw new Error("File is password-protected");r=We.find(e,"!CompObj"),n=We.find(e,"/Workbook")||We.find(e,"/Book")}else{switch(t.type){case"base64":e=gn(Vr(e));break;case"binary":e=gn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ht(e,0),n={content:e}}var a,s;if(r&&dO(r),t.bookProps&&!t.bookSheets)a={};else{var i=He?"buffer":"array";if(n&&n.content)a=mO(n.content,t);else if((s=We.find(e,"PerfectOffice_MAIN"))&&s.content)a=fl.to_workbook(s.content,(t.type=i,t));else if((s=We.find(e,"NativeContent_MAIN"))&&s.content)a=fl.to_workbook(s.content,(t.type=i,t));else throw(s=We.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&We.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=e8(e))}var o={};return e.FullPaths&&pO(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var v0={0:{f:qj},1:{f:eI},2:{f:cI},3:{f:aI},4:{f:rI},5:{f:lI},6:{f:fI},7:{f:iI},8:{f:gI},9:{f:xI},10:{f:mI},11:{f:pI},12:{f:tI},13:{f:uI},14:{f:sI},15:{f:nI},16:{f:rE},17:{f:hI},18:{f:oI},19:{f:Ap},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HI},40:{},42:{},43:{f:m5},44:{f:h5},45:{f:p5},46:{f:g5},47:{f:x5},48:{},49:{f:vR},50:{},51:{f:L5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:OS},62:{f:dI},63:{f:V5},64:{f:TI},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:lr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bI},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Zj},148:{f:Qj,p:16},151:{f:wI},152:{},153:{f:zI},154:{},155:{},156:{f:$I},157:{},158:{},159:{T:1,f:D6},160:{T:-1},161:{T:1,f:ii},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:M5},336:{T:-1},337:{f:B5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ah},357:{},358:{},359:{},360:{T:1},361:{},362:{f:IS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kI},427:{f:SI},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_I},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Jj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:yI},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ah},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Q5},633:{T:1},634:{T:-1},635:{T:1,f:q5},636:{T:-1},637:{f:wR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:RI},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:CI},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jh={6:{f:Qd},10:{f:va},12:{f:bt},13:{f:bt},14:{f:wt},15:{f:wt},16:{f:ar},17:{f:wt},18:{f:wt},19:{f:bt},20:{f:Hg},21:{f:Hg},23:{f:IS},24:{f:Kg},25:{f:wt},26:{},27:{},28:{f:YD},29:{},34:{f:wt},35:{f:Wg},38:{f:ar},39:{f:ar},40:{f:ar},41:{f:ar},42:{f:wt},43:{f:wt},47:{f:J6},49:{f:AD},51:{f:bt},60:{},61:{f:TD},64:{f:wt},65:{f:ND},66:{f:bt},77:{},80:{},81:{},82:{},85:{f:bt},89:{},90:{},91:{},92:{f:vD},93:{f:qD},94:{},95:{f:wt},96:{},97:{},99:{f:wt},125:{f:OS},128:{f:BD},129:{f:yD},130:{f:bt},131:{f:wt},132:{f:wt},133:{f:wD},134:{},140:{f:r6},141:{f:bt},144:{},146:{f:a6},151:{},152:{},153:{},154:{},155:{},156:{f:bt},157:{},158:{},160:{f:c6},161:{f:i6},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ID},190:{f:OD},193:{f:va},197:{},198:{},199:{},200:{},201:{},202:{f:wt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:bt},220:{},221:{f:wt},222:{},224:{f:LD},225:{f:gD},226:{f:va},227:{},229:{f:XD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:kD},253:{f:FD},255:{f:SD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:AS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wt},353:{f:va},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$D},431:{f:wt},432:{},433:{},434:{},437:{},438:{f:ZD},439:{f:wt},440:{f:e6},441:{},442:{f:yc},443:{},444:{f:bt},445:{},446:{},448:{f:va},449:{f:bD,r:2},450:{f:va},512:{f:zg},513:{f:l6},515:{f:UD},516:{f:PD},517:{f:Vg},519:{f:u6},520:{f:ED},523:{},545:{f:Gg},549:{f:$g},566:{},574:{f:CD},638:{f:jD},659:{},1048:{},1054:{f:RD},1084:{},1212:{f:WD},2048:{f:t6},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:va},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:s6,r:12},2173:{f:I5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HD,r:12},2197:{},2198:{f:A5,r:12},2199:{},2200:{},2201:{},2202:{f:KD,r:12},2203:{f:va},2204:{},2205:{},2206:{},2207:{},2211:{f:_D},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:bt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:o6},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:n6},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:zg},1:{},2:{f:m6},3:{f:h6},4:{f:f6},5:{f:Vg},7:{f:p6},8:{},9:{f:tu},11:{},22:{f:bt},30:{f:DD},31:{},32:{},33:{f:Gg},36:{},37:{f:$g},50:{f:x6},62:{},52:{},67:{},68:{f:bt},69:{},86:{},126:{},127:{f:d6},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:g6},223:{},234:{},354:{},421:{},518:{f:Qd},521:{f:tu},536:{f:Kg},547:{f:Wg},561:{},579:{},1030:{f:Qd},1033:{f:tu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function dn(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&xS(r)&&e.push(r)}}function av(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=$P(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var m=l[i].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var g=m.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var y=g[o].trim();if(y.match(/<t[dh]/i)){for(var w=y,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var A=0;A<x.length;++A){var T=x[A];T.s.c==d&&T.s.r<c&&c<=T.e.r&&(d=T.e.c+1,A=-1)}var b=Ne(y.slice(0,y.indexOf(">")));h=b.colspan?+b.colspan:1,((f=+b.rowspan)>1||h>1)&&x.push({s:{r:c,c:d},e:{r:c+(f||1)-1,c:d+h-1}});var k=b.t||b["data-t"]||"";if(!w.length){d+=h;continue}if(w=nS(w),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!w.length){d+=h;continue}var E={t:"s",v:w};r.raw||!w.trim().length||k=="s"||(w==="TRUE"?E={t:"b",v:!0}:w==="FALSE"?E={t:"b",v:!1}:isNaN(En(w))?isNaN(lo(w).getDate())||(E={t:"d",v:$t(w)},r.cellDates||(E={t:"n",v:yr(E.v)}),E.z=r.dateNF||Me[14]):E={t:"n",v:En(w)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=E):n[Re({r:c,c:d})]=E,d+=h}}}}return n["!ref"]=Ke(p),x.length&&(n["!merges"]=x),n}function xO(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var d=Re({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||_p(f.w||(ha(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,s.push(rR("td",h,p))}}var x="<tr>";return x+s.join("")+"</tr>"}var gO='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vO="</body></html>";function yO(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return us(av(r[0],t),t);var n=zp();return r.forEach(function(a,s){Vp(n,av(a,t),"Sheet"+(s+1))}),n}function wO(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function kO(e,t){var r=t||{},n=r.header!=null?r.header:gO,a=r.footer!=null?r.footer:vO,s=[n],i=yo(e["!ref"]);r.dense=Array.isArray(e),s.push(wO(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(xO(e,i,o,r));return s.push("</table>"+a),s.join("")}function lE(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?xr(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=yo(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),a==-1&&(c.e.r=a=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,v=0,g=0,y=0,w=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&m<l;++x){var S=o[x];if(sv(S)){if(n.display)continue;p[m]={hidden:!0}}var A=S.children;for(v=g=0;v<A.length;++v){var T=A[v];if(!(n.display&&sv(T))){var b=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):nS(T.innerHTML),k=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<f.length;++h){var E=f[h];E.s.c==g+s&&E.s.r<m+a&&m+a<=E.e.r&&(g=E.e.c+1-s,h=-1)}w=+T.getAttribute("colspan")||1,((y=+T.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:m+a,c:g+s},e:{r:m+a+(y||1)-1,c:g+s+(w||1)-1}});var _={t:"s",v:b},C=T.getAttribute("data-t")||T.getAttribute("t")||"";b!=null&&(b.length==0?_.t=C||"z":n.raw||b.trim().length==0||C=="s"||(b==="TRUE"?_={t:"b",v:!0}:b==="FALSE"?_={t:"b",v:!1}:isNaN(En(b))?isNaN(lo(b).getDate())||(_={t:"d",v:$t(b)},n.cellDates||(_={t:"n",v:yr(_.v)}),_.z=n.dateNF||Me[14]):_={t:"n",v:En(b)})),_.z===void 0&&k!=null&&(_.z=k);var F="",D=T.getElementsByTagName("A");if(D&&D.length)for(var M=0;M<D.length&&!(D[M].hasAttribute("href")&&(F=D[M].getAttribute("href"),F.charAt(0)!="#"));++M);F&&F.charAt(0)!="#"&&(_.l={Target:F}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][g+s]=_):e[Re({c:g+s,r:m+a})]=_,c.e.c<g+s&&(c.e.c=g+s),g+=w}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Ke(c),m>=l&&(e["!fullref"]=Ke((c.e.r=o.length-x+m-1+a,c))),e}function cE(e,t){var r=t||{},n=r.dense?[]:{};return lE(n,e,t)}function SO(e,t){return us(cE(e,t),t)}function sv(e){var t="",r=EO(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function EO(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _O(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ye(t.replace(/<[^>]*>/g,""));return[r]}var iv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uE(e,t){var r=t||{},n=bp(e),a=[],s,i,o={name:""},l="",c=0,d,f,h={},p=[],x=r.dense?[]:{},m,v,g={value:""},y="",w=0,S=[],A=-1,T=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,E={},_=[],C={},F=0,D=0,M=[],B=1,q=1,Q=[],J={Names:[]},P={},Z=["",""],le=[],R={},G="",W=0,K=!1,O=!1,X=0;for(zl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=zl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?x["!ref"]=Ke(b):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(x["!fullref"]=x["!ref"],b.e.r=r.sheetRows-1,x["!ref"]=Ke(b)),_.length&&(x["!merges"]=_),M.length&&(x["!rows"]=M),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=x,O=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Ne(m[0],!1),A=T=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,x=r.dense?[]:{},_=[],M=[],O=!0);break;case"table-row-group":m[1]==="/"?--k:++k;break;case"table-row":case"":if(m[1]==="/"){A+=B,B=1;break}if(f=Ne(m[0],!1),f.?A=f.-1:A==-1&&(A=0),B=+f["number-rows-repeated"]||1,B<10)for(X=0;X<B;++X)k>0&&(M[A+X]={level:k});T=-1;break;case"covered-table-cell":m[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(x[A]||(x[A]=[]),x[A][T]={t:"z"}):x[Re({r:A,c:T})]={t:"z"}),y="",S=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++T,g=Ne(m[0],!1),q=parseInt(g["number-columns-repeated"]||"1",10),v={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(v.f=ev(Ye(g.formula))),(g.||g["value-type"])=="string"&&(v.t="s",v.v=Ye(g["string-value"]||""),r.dense?(x[A]||(x[A]=[]),x[A][T]=v):x[Re({r:A,c:T})]=v),T+=q-1;else if(m[1]!=="/"){++T,y="",w=0,S=[],q=1;var se=B?A+B-1:A;if(T>b.e.c&&(b.e.c=T),T<b.s.c&&(b.s.c=T),A<b.s.r&&(b.s.r=A),se>b.e.r&&(b.e.r=se),g=Ne(m[0],!1),le=[],R={},v={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=Ye(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(F=parseInt(g["number-matrix-rows-spanned"],10)||0,D=parseInt(g["number-matrix-columns-spanned"],10)||0,C={s:{r:A,c:T},e:{r:A+F-1,c:T+D-1}},v.F=Ke(C),Q.push([C,v.F])),g.formula)v.f=ev(g.formula);else for(X=0;X<Q.length;++X)A>=Q[X][0].s.r&&A<=Q[X][0].e.r&&T>=Q[X][0].s.c&&T<=Q[X][0].e.c&&(v.F=Q[X][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(F=parseInt(g["number-rows-spanned"],10)||0,D=parseInt(g["number-columns-spanned"],10)||0,C={s:{r:A,c:T},e:{r:A+F-1,c:T+D-1}},_.push(C)),g["number-columns-repeated"]&&(q=parseInt(g["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=ot(g["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(g.value);break;case"percentage":v.t="n",v.v=parseFloat(g.value);break;case"currency":v.t="n",v.v=parseFloat(g.value);break;case"date":v.t="d",v.v=$t(g["date-value"]),r.cellDates||(v.t="n",v.v=yr(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=LP(g["time-value"])/86400,r.cellDates&&(v.t="d",v.v=Z0(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(g.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",g["string-value"]!=null&&(y=Ye(g["string-value"]),S=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(K=!1,v.t==="s"&&(v.v=y||"",S.length&&(v.R=S),K=w==0),P.Target&&(v.l=P),le.length>0&&(v.c=le,le=[]),y&&r.cellText!==!1&&(v.w=y),K&&(v.t="z",delete v.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var ie=0;ie<B;++ie){if(q=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(x[A+ie]||(x[A+ie]=[]),x[A+ie][T]=ie==0?v:Gt(v);--q>0;)x[A+ie][T+q]=Gt(v);else for(x[Re({r:A+ie,c:T})]=v;--q>0;)x[Re({r:A+ie,c:T+q})]=Gt(v);b.e.c<=T&&(b.e.c=T)}q=parseInt(g["number-columns-repeated"]||"1",10),T+=q-1,q=0,v={},y="",S=[]}P={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;R.t=y,S.length&&(R.R=S),R.a=G,le.push(R)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);G="",W=0,y="",w=0,S=[];break;case"creator":m[1]==="/"?G=n.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);y="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(E[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Ne(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ne(m[0],!1),l+=iv[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ne(m[0],!1),l+=iv[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=Ne(m[0],!1),Z=Jd(i["cell-range-address"]);var oe={Name:i.name,Ref:Z[0]+"!"+Z[1]};O&&(oe.Sheet=p.length),J.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!g||!g["string-value"])){var ue=_O(n.slice(w,m.index));y=(y.length>0?y+`
`:"")+ue[0]}else Ne(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{Z=Jd(Ne(m[0])["target-range-address"]),h[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(P=Ne(m[0],!1),!P.href)break;P.Target=Ye(P.href),delete P.href,P.Target.charAt(0)=="#"&&P.Target.indexOf(".")>-1?(Z=Jd(P.Target.slice(1)),P.Target="#"+Z[0]+"!"+Z[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var L={Sheets:h,SheetNames:p,Workbook:J};return r.bookSheets&&delete L.Sheets,L}function ov(e,t){t=t||{},Qr(e,"META-INF/manifest.xml")&&UR(_t(e,"META-INF/manifest.xml"),t);var r=Lr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=uE(tt(r),t);return Qr(e,"meta.xml")&&(n.Props=ES(_t(e,"meta.xml"))),n}function lv(e,t){return uE(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Lp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ih(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):tt(ai(e))}function Oh(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function cv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function bO(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Kl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function It(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function sr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Kl(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Kl(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Bp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function TO(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Kl(e,n),s=sr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:It(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=sr(o.data),c=It(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=It(s[3][0].data)>>>0>0),r.push(i)}return r}function CO(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Kl(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Oh(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var d=Oh(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function NO(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(CO(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Oh(t)}function AO(e,t,r,n){var a=Lp(e),s=a.getUint32(4,!0),i=(n>1?12:8)+cv(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,d=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=cv(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function FO(e,t,r){var n=Lp(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,d=new Date(2001,0,1);a&1&&(l=bO(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function PO(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return AO(e,t,r,e[0]);case 5:return FO(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function es(e){var t=sr(e);return Kl(t[1][0].data)}function uv(e,t){var r=sr(t.data),n=It(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=sr(i.data),l=It(o[1][0].data)>>>0;switch(n){case 1:s[l]=Ih(o[3][0].data);break;case 8:{var c=e[es(o[9][0].data)][0],d=sr(c.data),f=e[es(d[1][0].data)][0],h=It(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=sr(f.data);s[l]=p[3].map(function(x){return Ih(x.data)}).join("")}break}}),s}function RO(e,t){var r,n,a,s,i,o,l,c,d,f,h,p,x,m,v=sr(e),g=It(v[1][0].data)>>>0,y=It(v[2][0].data)>>>0,w=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&It(v[8][0].data)>0||!1,S,A;if((s=(a=v[7])==null?void 0:a[0])!=null&&s.data&&t!=0)S=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,A=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(d=v[4])==null?void 0:d[0])!=null&&f.data&&t!=1)S=(p=(h=v[4])==null?void 0:h[0])==null?void 0:p.data,A=(m=(x=v[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=w?4:1,b=Lp(S),k=[],E=0;E<S.length/2;++E){var _=b.getUint16(E*2,!0);_<65535&&k.push([E,_])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var C=[];for(E=0;E<k.length-1;++E)C[k[E][0]]=A.subarray(k[E][1]*T,k[E+1][1]*T);return k.length>=1&&(C[k[k.length-1][0]]=A.subarray(k[k.length-1][1]*T)),{R:g,cells:C}}function DO(e,t){var r,n=sr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?It(n[7][0].data)>>>0>0?1:0:-1,s=Bp(n[5],function(i){return RO(i,a)});return{nrows:It(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function jO(e,t,r){var n,a=sr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(It(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(It(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ke(s);var i=sr(a[4][0].data),o=uv(e,e[es(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?uv(e,e[es(i[17][0].data)][0]):[],c=sr(i[3][0].data),d=0;c[1].forEach(function(f){var h=sr(f.data),p=e[es(h[2][0].data)][0],x=It(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=DO(e,p);m.data.forEach(function(v,g){v.forEach(function(y,w){var S=Re({r:d+g,c:w}),A=PO(y,o,l);A&&(r[S]=A)})}),d+=m.nrows})}function IO(e,t){var r=sr(t.data),n={"!ref":"A1"},a=e[es(r[2][0].data)],s=It(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return jO(e,a[0],n),n}function OO(e,t){var r,n=sr(t.data),a={name:(r=n[1])!=null&&r[0]?Ih(n[1][0].data):"",sheets:[]},s=Bp(n[2],es);return s.forEach(function(i){e[i].forEach(function(o){var l=It(o.meta[1][0].data);l==6e3&&a.sheets.push(IO(e,o))})}),a}function MO(e,t){var r=zp(),n=sr(t.data),a=Bp(n[1],es);if(a.forEach(function(s){e[s].forEach(function(i){var o=It(i.meta[1][0].data);if(o==2){var l=OO(e,i);l.sheets.forEach(function(c,d){Vp(r,c,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ef(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=NO(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var d;try{d=TO(c)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&It(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var d=It(c.meta[1][0].data)>>>0;if(d==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return MO(s,o)}function LO(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Up(e){LO([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function BO(e){return bi.WS.indexOf(e)>-1?"sheet":e==bi.CS?"chart":e==bi.DS?"dialog":e==bi.MS?"macro":e&&e.length?e:"sheet"}function UO(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,BO(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function $O(e,t,r,n,a,s,i,o,l,c,d,f){try{s[n]=ul(Lr(e,r,!0),t);var h=_t(e,t),p;switch(o){case"sheet":p=GI(h,t,a,l,s[n],c,d,f);break;case"chart":if(p=YI(h,t,a,l,s[n],c,d,f),!p||!p["!drawel"])break;var x=Wo(p["!drawel"].Target,t),m=Fh(x),v=K5(Lr(e,x,!0),ul(Lr(e,m,!0),x)),g=Wo(v,x),y=Fh(g);p=FI(Lr(e,g,!0),g,l,ul(Lr(e,y,!0),g),c,p);break;case"macro":p=XI(h,t,a,l,s[n],c,d,f);break;case"dialog":p=qI(h,t,a,l,s[n],c,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var w=[];s&&s[n]&&Hn(s[n]).forEach(function(S){var A="";if(s[n][S].Type==bi.CMNT){A=Wo(s[n][S].Target,t);var T=eO(_t(e,A,!0),A,l);if(!T||!T.length)return;Xg(p,T,!1)}s[n][S].Type==bi.TCMNT&&(A=Wo(s[n][S].Target,t),w=w.concat(Y5(_t(e,A,!0),l)))}),w&&w.length&&Xg(p,w,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function Gr(e){return e.charAt(0)=="/"?e.slice(1):e}function zO(e,t){if(Gk(),t=t||{},Up(t),Qr(e,"META-INF/manifest.xml")||Qr(e,"objectdata.xml"))return ov(e,t);if(Qr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ef<"u"){if(e.FileIndex)return ef(e);var r=We.utils.cfb_new();return Sg(e).forEach(function(M){VP(r,M,Zk(e,M))}),ef(r)}throw new Error("Unsupported NUMBERS file")}if(!Qr(e,"[Content_Types].xml"))throw Qr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Qr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Sg(e),a=LR(Lr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",_t(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!_t(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(hl=[],a.sst)try{hl=ZI(_t(e,Gr(a.sst)),a.sst,t)}catch(M){if(t.WTF)throw M}t.cellStyles&&a.themes.length&&(l=JI(Lr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=QI(_t(e,Gr(a.style)),a.style,l,t))}a.links.map(function(M){try{var B=ul(Lr(e,Fh(Gr(M))),M);return rO(_t(e,Gr(M)),B,M,t)}catch{}});var d=KI(_t(e,Gr(a.workbooks[0])),a.workbooks[0],t),f={},h="";a.coreprops.length&&(h=_t(e,Gr(a.coreprops[0]),!0),h&&(f=ES(h)),a.extprops.length!==0&&(h=_t(e,Gr(a.extprops[0]),!0),h&&VR(h,f,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=Lr(e,Gr(a.custprops[0]),!0),h&&(p=WR(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(B){return B.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var m={};t.bookDeps&&a.calcchain&&(m=tO(_t(e,Gr(a.calcchain)),a.calcchain));var v=0,g={},y,w;{var S=d.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var A=0;A!=S.length;++A)f.SheetNames[A]=S[A].name}var T=s?"bin":"xml",b=a.workbooks[0].lastIndexOf("/"),k=(a.workbooks[0].slice(0,b+1)+"_rels/"+a.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");Qr(e,k)||(k="xl/_rels/workbook."+T+".rels");var E=ul(Lr(e,k,!0),k.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=nO(_t(e,Gr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=X5(_t(e,Gr(a.people[0])),t)),E&&(E=UO(E,d.Sheets));var _=_t(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var C="sheet";if(E&&E[v]?(y="xl/"+E[v][1].replace(/[\/]?xl\//,""),Qr(e,y)||(y=E[v][1]),Qr(e,y)||(y=k.replace(/_rels\/.*$/,"")+E[v][1]),C=E[v][2]):(y="xl/worksheets/sheet"+(v+1-_)+"."+T,y=y.replace(/sheet0\./,"sheet.")),w=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,D=0;D!=t.sheets.length;++D)typeof t.sheets[D]=="number"&&t.sheets[D]==v&&(F=1),typeof t.sheets[D]=="string"&&t.sheets[D].toLowerCase()==f.SheetNames[v].toLowerCase()&&(F=1);if(!F)continue e}}$O(e,y,w,f.SheetNames[v],v,g,i,C,t,d,l,c)}return x={Directory:a,Workbook:d,Props:f,Custprops:p,Deps:m,Sheets:i,SheetNames:f.SheetNames,Strings:hl,Styles:c,Themes:l,SSF:Gt(Me)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(M,B){M=M.replace(/^Root Entry[\/]/,""),x.keys.push(M),x.files[M]=e.FileIndex[B]}))),t&&t.bookVBA&&(a.vba.length>0?x.vbaraw=_t(e,Gr(a.vba[0]),!0):a.defaults&&a.defaults.bin===Z5&&(x.vbaraw=_t(e,"xl/vbaProject.bin",!0))),x}function VO(e,t){var r=t||{},n="Workbook",a=We.find(e,n);try{if(n="/!DataSpaces/Version",a=We.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(I6(a.content),n="/!DataSpaces/DataSpaceMap",a=We.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=M6(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=We.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=L6(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=We.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);U6(a.content)}catch{}if(n="/EncryptionInfo",a=We.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=$6(a.content);if(n="/EncryptedPackage",a=We.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function $p(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Vr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function HO(e,t){return We.find(e,"EncryptedPackage")?VO(e,t):oE(e,t)}function WO(e,t){var r,n=e,a=t||{};return a.type||(a.type=He&&Buffer.isBuffer(e)?"buffer":"base64"),r=eS(n,a),zO(r,a)}function dE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Dh(e.slice(r),t);default:break e}return Vl.to_workbook(e,t)}function KO(e,t){var r="",n=$p(e,t);switch(t.type){case"base64":r=Vr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Js(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=tt(r)),t.type="binary",dE(r,t)}function GO(e,t){var r=e;return t.type=="base64"&&(r=Vr(r)),r=Ta.utils.decode(1200,r.slice(2),"str"),t.type="binary",dE(r,t)}function YO(e){return e.match(/[^\x00-\x7F]/)?Ko(e):e}function tf(e,t,r,n){return n?(r.type="string",Vl.to_workbook(e,r)):Vl.to_workbook(t,r)}function Mh(e,t){Ik();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Mh(new Uint8Array(e),(r=Gt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Oi={},r.dateNF&&(Oi.dateNF=r.dateNF),r.type||(r.type=He&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=He?"buffer":"binary",n=OP(e),typeof Uint8Array<"u"&&!He&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=YO(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Gt(r),r.type="array",Mh(yp(n),r)}switch((a=$p(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return HO(We.read(n,r),r);break;case 9:if(a[1]<=8)return oE(n,r);break;case 60:return Dh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return S6(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return w6.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?WO(n,r):tf(e,n,r,s);case 239:return a[3]===60?Dh(n,r):tf(e,n,r,s);case 255:if(a[1]===254)return GO(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return fl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return fl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Yg.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Z6.to_workbook(n,r);break;case 10:case 13:case 32:return KO(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return v6.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Yg.to_workbook(n,r):tf(e,n,r,s)}function XO(e,t,r,n,a,s,i,o){var l=Yt(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[p]!=null&&(h[s[p]]=c);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[p]!=null){if(m==null)if(x.t=="e"&&m===null)h[s[p]]=null;else if(c!==void 0)h[s[p]]=c;else if(d&&m===null)h[s[p]]=null;else continue;else h[s[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:ha(x,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Lh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof d){case"string":l=vt(d);break;case"number":l=vt(e["!ref"]),l.s.r=d;break;default:l=d}n>0&&(a=0);var f=Yt(l.s.r),h=[],p=[],x=0,m=0,v=Array.isArray(e),g=l.s.r,y=0,w={};v&&!e[g]&&(e[g]=[]);var S=c.skipHidden&&e["!cols"]||[],A=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(S[y]||{}).hidden)switch(h[y]=jt(y),r=v?e[g][y]:e[h[y]+f],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ha(r,null,c),m=w[i]||0,!m)w[i]=1;else{do o=i+"_"+m++;while(w[o]);w[i]=m,w[o]=1}s[y]=o}for(g=l.s.r+a;g<=l.e.r;++g)if(!(A[g]||{}).hidden){var T=XO(e,l,g,h,n,s,v,c);(T.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=T.row)}return p.length=x,p}var dv=/"/g;function qO(e,t,r,n,a,s,i,o){for(var l=!0,c=[],d="",f=Yt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+f];if(p==null)d="";else if(p.v!=null){l=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:ha(p,null,o));for(var x=0,m=0;x!==d.length;++x)if((m=d.charCodeAt(x))===a||m===s||m===34||o.forceQuotes){d='"'+d.replace(dv,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(l=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(dv,'""')+'"')):d="";c.push(d)}return o.blankrows===!1&&l?null:c.join(i)}function fE(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=vt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=jt(x));for(var m=0,v=a.s.r;v<=a.e.r;++v)(p[v]||{}).hidden||(d=qO(e,a,v,f,i,l,s,n),d!=null&&(n.strip&&(d=d.replace(c,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function QO(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=fE(e,t);return r}function JO(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=vt(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=jt(o);for(var d=a.s.r;d<=a.e.r;++d)for(s=Yt(d),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function hE(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;i=l.r,o=l.c}var c,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var f=vt(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+a)}else i==-1&&(i=0,d.e.r=t.length-1+a);var h=n.header||[],p=0;t.forEach(function(m,v){Hn(m).forEach(function(g){(p=h.indexOf(g))==-1&&(h[p=h.length]=g);var y=m[g],w="z",S="",A=Re({c:o+p,r:i+v+a});c=Gl(s,A),y&&typeof y=="object"&&!(y instanceof Date)?s[A]=y:(typeof y=="number"?w="n":typeof y=="boolean"?w="b":typeof y=="string"?w="s":y instanceof Date?(w="d",n.cellDates||(w="n",y=yr(y)),S=n.dateNF||Me[14]):y===null&&n.nullError&&(w="e",y=0),c?(c.t=w,c.v=y,delete c.w,delete c.R,S&&(c.z=S)):s[A]=c={t:w,v:y},S&&(c.z=S))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var x=Yt(i);if(a)for(p=0;p<h.length;++p)s[jt(p+o)+x]={t:"s",v:h[p]};return s["!ref"]=Ke(d),s}function ZO(e,t){return hE(null,e,t)}function Gl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=xr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Gl(e,Re(t)):Gl(e,Re({r:t,c:r||0}))}function eM(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function zp(){return{SheetNames:[],Sheets:{}}}function Vp(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(LI(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function tM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=eM(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function rM(e,t){return e.z=t,e}function mE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function nM(e,t,r){return mE(e,"#"+t,r)}function aM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sM(e,t,r,n){for(var a=typeof t!="string"?t:vt(t),s=typeof t=="string"?t:Ke(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Gl(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var iM={encode_col:jt,encode_row:Yt,encode_cell:Re,encode_range:Ke,decode_col:Np,decode_row:Cp,split_cell:gR,decode_cell:xr,decode_range:yo,format_cell:ha,sheet_add_aoa:vS,sheet_add_json:hE,sheet_add_dom:lE,aoa_to_sheet:wo,json_to_sheet:ZO,table_to_sheet:cE,table_to_book:SO,sheet_to_csv:fE,sheet_to_txt:QO,sheet_to_json:Lh,sheet_to_html:kO,sheet_to_formulae:JO,sheet_to_row_object_array:Lh,sheet_get_cell:Gl,book_new:zp,book_append_sheet:Vp,book_set_sheet_visibility:tM,cell_set_number_format:rM,cell_set_hyperlink:mE,cell_set_internal_link:nM,cell_add_comment:aM,sheet_set_array_formula:sM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class nd{static async parseCSV(t,r={}){const n=Date.now();return new Promise((a,s)=>{const{preview:i=!1,previewRows:o=this.DEFAULT_PREVIEW_ROWS,hasHeaders:l=!0,delimiter:c="",skipEmptyLines:d=!0,trimHeaders:f=!0,transformHeader:h}=r;sP.parse(t,{header:!1,delimiter:c||void 0,skipEmptyLines:d,preview:i?o+(l?1:0):0,encoding:r.encoding||"UTF-8",complete:p=>{try{const x=Date.now()-n,m=p.data;if(m.length===0){s({type:"INVALID_DATA",message:"File appears to be empty or contains no valid data"});return}let v=[],g=[];if(l&&m.length>0)v=m[0].map((A,T)=>{let b=f?A.trim():A;return h&&(b=h(b)),b||`Column ${T+1}`}),g=m.slice(1);else{const S=Math.max(...m.map(A=>A.length));v=Array.from({length:S},(A,T)=>`Column ${T+1}`),g=m}const y=i?g.slice(0,o):g,w={headers:v,rows:g,totalRows:g.length,preview:y,metadata:{fileName:t.name,fileSize:t.size,fileType:t.type||"text/csv",encoding:r.encoding||"UTF-8",delimiter:p.meta.delimiter,hasHeaders:l,parseTime:x}};a(w)}catch(x){s({type:"PARSE_ERROR",message:"Failed to process CSV data",details:x})}},error:p=>{s({type:"PARSE_ERROR",message:`CSV parsing failed: ${p.message}`,details:p})}})})}static async parseExcel(t,r={}){const n=Date.now();return new Promise((a,s)=>{const i=new FileReader;i.onload=o=>{var l;try{const{preview:c=!1,previewRows:d=this.DEFAULT_PREVIEW_ROWS,hasHeaders:f=!0,trimHeaders:h=!0,transformHeader:p}=r,x=new Uint8Array((l=o.target)==null?void 0:l.result),m=Mh(x,{type:"array"}),v=m.SheetNames[0],g=m.Sheets[v];if(!g){s({type:"INVALID_DATA",message:"Excel file contains no readable worksheets"});return}const y=iM.sheet_to_json(g,{header:1,defval:"",blankrows:!1});if(y.length===0){s({type:"INVALID_DATA",message:"Excel file appears to be empty"});return}let w=[],S=[];if(f&&y.length>0)w=y[0].map((E,_)=>{let C=String(E||"");return h&&(C=C.trim()),p&&(C=p(C)),C||`Column ${_+1}`}),S=y.slice(1);else{const k=Math.max(...y.map(E=>E.length));w=Array.from({length:k},(E,_)=>`Column ${_+1}`),S=y}const A=c?S.slice(0,d):S,T=Date.now()-n,b={headers:w,rows:S,totalRows:S.length,preview:A,metadata:{fileName:t.name,fileSize:t.size,fileType:t.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",hasHeaders:f,parseTime:T}};a(b)}catch(c){s({type:"PARSE_ERROR",message:"Failed to parse Excel file",details:c})}},i.onerror=()=>{s({type:"PARSE_ERROR",message:"Failed to read Excel file"})},i.readAsArrayBuffer(t)})}static async parseFile(t,r={}){if(t.size>this.MAX_FILE_SIZE)throw{type:"FILE_TOO_LARGE",message:`File size (${Math.round(t.size/1024/1024)}MB) exceeds maximum allowed size (${Math.round(this.MAX_FILE_SIZE/1024/1024)}MB)`};const n=t.type||this.getFileTypeFromExtension(t.name);if(!this.SUPPORTED_TYPES.includes(n))throw{type:"UNSUPPORTED_FORMAT",message:`Unsupported file format: ${n}. Supported formats: CSV, Excel (.xlsx, .xls)`};if(n==="text/csv"||n==="text/plain")return this.parseCSV(t,r);if(n==="application/vnd.ms-excel"||n==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")return this.parseExcel(t,r);throw{type:"UNSUPPORTED_FORMAT",message:`Unable to determine parser for file type: ${n}`}}static getFileTypeFromExtension(t){switch(t.toLowerCase().split(".").pop()){case"csv":return"text/csv";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xls":return"application/vnd.ms-excel";case"txt":return"text/plain";default:return"application/octet-stream"}}static validateParsedData(t){return t&&Array.isArray(t.headers)&&Array.isArray(t.rows)&&t.headers.length>0&&typeof t.totalRows=="number"&&t.metadata&&typeof t.metadata.fileName=="string"}static getParsingStats(t){const r=t.headers.map((n,a)=>{const s=t.rows.map(o=>o[a]),i=s.filter(o=>o!=null&&o!=="");return{name:n,index:a,totalValues:s.length,nonEmptyValues:i.length,emptyValues:s.length-i.length,fillRate:i.length/s.length,sampleValues:i.slice(0,5)}});return{totalColumns:t.headers.length,totalRows:t.totalRows,parseTime:t.metadata.parseTime,fileSize:t.metadata.fileSize,columnStats:r}}}nd.MAX_FILE_SIZE=50*1024*1024;nd.DEFAULT_PREVIEW_ROWS=10;nd.SUPPORTED_TYPES=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain"];class Bh{static detectValueType(t,r={}){var i,o,l;const n={...this.DEFAULT_OPTIONS,...r};if(t==null)return"null";const a=String(t),s=n.trimWhitespace?a.trim():a;return(i=n.nullValues)!=null&&i.includes(s.toLowerCase())?"null":(o=n.booleanTrueValues)!=null&&o.includes(s.toLowerCase())||(l=n.booleanFalseValues)!=null&&l.includes(s.toLowerCase())?"boolean":this.isEmail(s)?"email":this.isUrl(s)?"url":this.isPhone(s)?"phone":this.isCurrency(s,n.currencySymbols||[])?"currency":this.isPercentage(s)?"percentage":this.isDateTime(s)?"datetime":this.isDate(s)?"date":this.isTime(s)?"time":this.isInteger(s,n)?"integer":this.isFloat(s,n)?"float":"string"}static analyzeColumn(t,r,n,a={}){const s={...this.DEFAULT_OPTIONS,...a},i=t.filter(v=>v!=null&&String(v).trim()!=="");if(i.length===0)return{columnName:r,columnIndex:n,detectedType:"string",confidence:0,totalValues:t.length,nonEmptyValues:0,nullValues:t.length,uniqueValues:0,samples:[],convertedSamples:[],errors:["Column contains no data"]};const o={string:0,number:0,integer:0,float:0,boolean:0,date:0,datetime:0,time:0,email:0,url:0,phone:0,currency:0,percentage:0,null:0,unknown:0},l=i.slice(0,10),c=[],d=[];i.forEach(v=>{const g=this.detectValueType(v,s);o[g]++});const f=Object.entries(o).filter(([v,g])=>g>0).sort(([,v],[,g])=>g-v),[h,p]=f[0]||["string",0],x=p/i.length;l.forEach(v=>{try{const g=this.convertValue(v,h,s);c.push(g)}catch(g){c.push(v),d.push(`Failed to convert "${v}": ${g}`)}});const m=[];if(x<.8&&m.push(`Low confidence (${Math.round(x*100)}%) - consider manual review`),f.length>1){const[,v]=f[1];m.push(`Alternative type detected: ${v}`)}return{columnName:r,columnIndex:n,detectedType:h,confidence:x,totalValues:t.length,nonEmptyValues:i.length,nullValues:t.length-i.length,uniqueValues:new Set(i).size,samples:l,convertedSamples:c,errors:d,suggestions:m.length>0?m:void 0}}static convertValue(t,r,n={}){var o,l;const a={...this.DEFAULT_OPTIONS,...n};if(t==null)return null;const s=String(t),i=a.trimWhitespace?s.trim():s;switch(r){case"null":return null;case"boolean":if((o=a.booleanTrueValues)!=null&&o.includes(i.toLowerCase()))return!0;if((l=a.booleanFalseValues)!=null&&l.includes(i.toLowerCase()))return!1;throw new Error(`Cannot convert "${i}" to boolean`);case"integer":const c=this.parseNumber(i,a);if(!Number.isInteger(c))throw new Error(`"${i}" is not a valid integer`);return c;case"float":case"number":return this.parseNumber(i,a);case"currency":return this.parseCurrency(i,a);case"percentage":return this.parsePercentage(i);case"date":return this.parseDate(i);case"datetime":return this.parseDateTime(i);case"time":return this.parseTime(i);case"email":case"url":case"phone":case"string":default:return i}}static convertColumn(t,r,n={}){const a=[],s=[];return t.forEach((i,o)=>{try{const l=this.convertValue(i,r,n);a.push(l)}catch(l){a.push(i),s.push({index:o,value:i,error:String(l)})}}),{converted:a,errors:s}}static isEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}static isUrl(t){try{return new URL(t),!0}catch{return!1}}static isPhone(t){const r=/^[\+]?[1-9][\d]{0,15}$/,n=t.replace(/[\s\-\(\)\.]/g,"");return r.test(n)&&n.length>=7}static isCurrency(t,r){if(!r.some(s=>t.includes(s)))return!1;const a=t.replace(/[^\d\.,\-]/g,"");return this.isFloat(a,{})}static isPercentage(t){return t.includes("%")&&this.isFloat(t.replace("%",""),{})}static isInteger(t,r){try{const n=this.parseNumber(t,r);return Number.isInteger(n)}catch{return!1}}static isFloat(t,r){try{const n=this.parseNumber(t,r);return!isNaN(n)&&isFinite(n)}catch{return!1}}static isDate(t){return/^\d{1,4}[-\/\.]\d{1,2}[-\/\.]\d{1,4}$/.test(t)&&!isNaN(Date.parse(t))}static isDateTime(t){return/^\d{1,4}[-\/\.]\d{1,2}[-\/\.]\d{1,4}\s+\d{1,2}:\d{2}(:\d{2})?/.test(t)&&!isNaN(Date.parse(t))}static isTime(t){return/^\d{1,2}:\d{2}(:\d{2})?(\s*(AM|PM))?$/i.test(t)}static parseNumber(t,r){const{decimalSeparator:n=".",thousandsSeparator:a=","}=r;let s=t.replace(/\s/g,"");a&&a!==n&&(s=s.replace(new RegExp(`\\${a}`,"g"),"")),n!=="."&&(s=s.replace(n,"."));const i=parseFloat(s);if(isNaN(i))throw new Error(`Cannot parse "${t}" as number`);return i}static parseCurrency(t,r){const n=t.replace(/[^\d\.,\-]/g,"");return this.parseNumber(n,r)}static parsePercentage(t){const r=t.replace("%","");return parseFloat(r)/100}static parseDate(t){const r=new Date(t);if(isNaN(r.getTime()))throw new Error(`Cannot parse "${t}" as date`);return r}static parseDateTime(t){return this.parseDate(t)}static parseTime(t){return t}}Bh.DEFAULT_OPTIONS={dateFormats:["YYYY-MM-DD","DD/MM/YYYY","MM/DD/YYYY","DD-MM-YYYY","MM-DD-YYYY","YYYY/MM/DD","DD.MM.YYYY","YYYY-MM-DD HH:mm:ss","DD/MM/YYYY HH:mm:ss","MM/DD/YYYY HH:mm:ss"],currencySymbols:["$","","","","",""],decimalSeparator:".",thousandsSeparator:",",booleanTrueValues:["true","yes","y","1","on","enabled","active"],booleanFalseValues:["false","no","n","0","off","disabled","inactive"],nullValues:["","null","NULL","nil","NIL","n/a","N/A","undefined"],trimWhitespace:!0,strictMode:!1};const oM={maxFileSize:10*1024*1024,allowedTypes:[".csv",".xlsx",".xls"],previewRows:10,autoDetectTypes:!0,parseOptions:{hasHeaders:!0,skipEmptyLines:!0,trimHeaders:!0},conversionOptions:{trimWhitespace:!0,strictMode:!1}};function lM(e={}){const t={...oM,...e},r=V.useRef(t.parseOptions||{}),n=V.useRef(t.conversionOptions||{}),[a,s]=V.useState({file:null,isUploading:!1,isProcessing:!1,progress:0,error:null,parsedData:null,columnTypes:null,previewData:null}),i=V.useCallback(g=>{var y;if(t.maxFileSize&&g.size>t.maxFileSize)return`File size (${Math.round(g.size/1024/1024)}MB) exceeds maximum allowed size (${Math.round(t.maxFileSize/1024/1024)}MB)`;if(t.allowedTypes&&t.allowedTypes.length>0){const w="."+((y=g.name.split(".").pop())==null?void 0:y.toLowerCase());if(!t.allowedTypes.includes(w))return`File type "${w}" is not allowed. Allowed types: ${t.allowedTypes.join(", ")}`}return null},[t.maxFileSize,t.allowedTypes]),o=V.useCallback(async g=>{const y=i(g);if(y){s(w=>({...w,error:y}));return}s(w=>({...w,file:g,isUploading:!0,error:null,progress:0}));try{for(let w=0;w<=100;w+=10)s(S=>({...S,progress:w})),await new Promise(S=>setTimeout(S,50));s(w=>({...w,isUploading:!1,progress:100})),t.autoDetectTypes&&await l()}catch(w){s(S=>({...S,isUploading:!1,error:w instanceof Error?w.message:"Upload failed"}))}},[i,t.autoDetectTypes]),l=V.useCallback(async()=>{if(!a.file){s(g=>({...g,error:"No file selected"}));return}s(g=>({...g,isProcessing:!0,error:null}));try{const g=await nd.parseFile(a.file,r.current);let y=null;t.autoDetectTypes&&g.rows.length>0&&(y=g.headers.map((S,A)=>{const T=g.rows.map(b=>b[A]);return Bh.analyzeColumn(T,S,A,n.current)}));const w=g.rows.slice(0,t.previewRows||10);s(S=>({...S,isProcessing:!1,parsedData:g,columnTypes:y,previewData:w}))}catch(g){const y=g instanceof Error?`Parse error: ${g.message}`:"Processing failed";s(w=>({...w,isProcessing:!1,error:y}))}},[a.file,t.autoDetectTypes,t.previewRows]),c=V.useCallback(async(g,y)=>{if(!a.parsedData||!a.columnTypes){s(w=>({...w,error:"No data to convert"}));return}try{const w=a.parsedData.rows.map(k=>k[g]),{converted:S,errors:A}=Bh.convertColumn(w,y,n.current),T=a.parsedData.rows.map((k,E)=>{const _=[...k];return _[g]=S[E],_}),b=[...a.columnTypes];b[g]={...b[g],detectedType:y,confidence:A.length===0?1:1-A.length/w.length,errors:A.map(k=>k.error)},s(k=>({...k,parsedData:k.parsedData?{...k.parsedData,rows:T}:null,columnTypes:b,previewData:T.slice(0,t.previewRows||10)}))}catch(w){s(S=>({...S,error:w instanceof Error?w.message:"Conversion failed"}))}},[a.parsedData,a.columnTypes,t.previewRows]),d=V.useCallback(async()=>{if(!a.columnTypes){s(g=>({...g,error:"No column type information available"}));return}try{for(const g of a.columnTypes)await c(g.columnIndex,g.detectedType)}catch(g){s(y=>({...y,error:g instanceof Error?g.message:"Batch conversion failed"}))}},[a.columnTypes,c]),f=V.useCallback(()=>{s({file:null,isUploading:!1,isProcessing:!1,progress:0,error:null,parsedData:null,columnTypes:null,previewData:null})},[]),h=V.useCallback(()=>{s(g=>({...g,file:null,parsedData:null,columnTypes:null,previewData:null,error:null}))},[]),p=V.useCallback(g=>{r.current={...r.current,...g}},[]),x=V.useCallback(g=>{n.current={...n.current,...g}},[]),m=V.useCallback(g=>{if(!a.parsedData)return[];const y=g||t.previewRows||10;return a.parsedData.rows.slice(0,y)},[a.parsedData,t.previewRows]),v=V.useCallback(g=>{var y;if(!a.parsedData){s(w=>({...w,error:"No data to download"}));return}try{const w=[a.parsedData.headers.join(","),...a.parsedData.rows.map(b=>b.map(k=>typeof k=="string"&&k.includes(",")?`"${k.replace(/"/g,'""')}"`:String(k)).join(","))].join(`
`),S=new Blob([w],{type:"text/csv;charset=utf-8;"}),A=document.createElement("a"),T=URL.createObjectURL(S);A.setAttribute("href",T),A.setAttribute("download",g||`processed_${((y=a.file)==null?void 0:y.name)||"data.csv"}`),A.style.visibility="hidden",document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(T)}catch(w){s(S=>({...S,error:w instanceof Error?w.message:"Download failed"}))}},[a.parsedData,a.file]);return{state:a,actions:{uploadFile:o,processFile:l,convertColumn:c,convertAllColumns:d,reset:f,removeFile:h,updateParseOptions:p,updateConversionOptions:x,getPreviewData:m,downloadProcessedData:v}}}const cM=[{id:"1",name:"iPhone 14 Pro",category:"Telefon",description:"Apple iPhone 14 Pro 128GB"},{id:"2",name:"Samsung Galaxy S23",category:"Telefon",description:"Samsung Galaxy S23 256GB"},{id:"3",name:"MacBook Air M2",category:"Laptop",description:"Apple MacBook Air M2 13 in"},{id:"4",name:"Dell XPS 13",category:"Laptop",description:"Dell XPS 13 Intel i7"},{id:"5",name:"iPad Pro",category:"Tablet",description:"Apple iPad Pro 11 in"},{id:"6",name:"AirPods Pro",category:"Kulaklk",description:"Apple AirPods Pro 2. nesil"},{id:"7",name:"Sony WH-1000XM4",category:"Kulaklk",description:"Sony WH-1000XM4 Kablosuz Kulaklk"},{id:"8",name:"Nintendo Switch",category:"Oyun Konsolu",description:"Nintendo Switch OLED Model"}],uM=()=>{var l;const{results:e,query:t,setQuery:r,isSearching:n}=nP(cM,{keys:["name","category","description"],threshold:.3,includeScore:!0}),{state:a,actions:s}=lM({maxFileSize:5*1024*1024,allowedTypes:[".csv",".xlsx",".xls"],parseOptions:{hasHeaders:!0,delimiter:",",encoding:"utf-8"}}),i=c=>{var f;const d=(f=c.target.files)==null?void 0:f[0];d&&s.uploadFile(d)},o=s.getPreviewData(5);return u.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Core Paket Test Sayfas"}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[u.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Fuzzy Search Testi"}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-2",children:"rn Ara"}),u.jsx(Ie,{id:"search",type:"text",value:t,onChange:c=>r(c.target.value),placeholder:"iPhone, Samsung, MacBook...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),n&&u.jsx("div",{className:"text-blue-600 mb-4",children:"Aranyor..."}),u.jsx("div",{className:"space-y-3",children:e.length>0?e.map((c,d)=>u.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900",children:c.item.name}),u.jsx("p",{className:"text-sm text-gray-600",children:c.item.category}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:c.item.description})]}),c.score&&u.jsxs("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["Skor: ",((1-c.score)*100).toFixed(0),"%"]})]})},c.item.id)):t?u.jsxs("div",{className:"text-gray-500 text-center py-8",children:['"',t,'" iin sonu bulunamad']}):u.jsx("div",{className:"text-gray-500 text-center py-8",children:"Arama yapmak iin yukardaki kutuya yazn"})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"File Upload Testi"}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-gray-700 mb-2",children:"CSV/Excel Dosyas Se"}),u.jsx(Ie,{id:"file-upload",type:"file",accept:".csv,.xlsx,.xls",onChange:i,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-3",children:"Dosya Durumu"}),u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Durum:"})," ",u.jsx("span",{className:`px-2 py-1 rounded text-xs ${a.file?a.isProcessing?"bg-yellow-100 text-yellow-800":a.parsedData?"bg-green-100 text-green-800":"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:a.file?a.isProcessing?"leniyor":a.parsedData?"Baarl":"Hata":"Bekliyor"})]}),a.file&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Dosya:"})," ",a.file.name]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Boyut:"})," ",(a.file.size/1024).toFixed(1)," KB"]})]}),a.parsedData&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Satr Says:"})," ",a.parsedData.rows.length]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"Stun Says:"})," ",a.parsedData.headers.length]})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-3",children:"Stun Tipleri"}),a.columnTypes&&u.jsx("div",{className:"space-y-1 text-sm",children:a.columnTypes.map((c,d)=>{var f;return u.jsxs("div",{children:[u.jsxs("span",{className:"font-medium",children:[(f=a.parsedData)==null?void 0:f.headers[d],":"]})," ",u.jsx("span",{className:"text-blue-600",children:c.detectedType}),c.confidence&&u.jsxs("span",{className:"text-gray-500 ml-1",children:["(",(c.confidence*100).toFixed(0),"%)"]})]},d)})})]})]}),a.error&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:[u.jsx("h4",{className:"text-red-800 font-medium mb-2",children:"Hata"}),u.jsx("p",{className:"text-red-700 text-sm",children:a.error})]}),o.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-3",children:"Veri nizlemesi (lk 5 satr)"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border border-gray-200 rounded-lg",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsx("tr",{children:(l=a.parsedData)==null?void 0:l.headers.map((c,d)=>u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},d))})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map((c,d)=>u.jsx("tr",{className:"hover:bg-gray-50",children:c.map((f,h)=>u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 whitespace-nowrap",children:String(f)},h))},d))})]})})]}),a.parsedData&&u.jsxs("div",{className:"mt-6 flex gap-3",children:[u.jsx(Te,{onClick:()=>s.processFile(),disabled:a.isProcessing,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:a.isProcessing?"leniyor...":"Yeniden le"}),u.jsx(Te,{onClick:()=>s.reset(),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",variant:"default",children:"Temizle"})]})]})]})},dM=zr("/test")({component:uM});class fM{constructor(){at(this,"dbName","XEarOutbox");at(this,"dbVersion",1);at(this,"storeName","operations");at(this,"db",null);at(this,"isOnline",navigator.onLine);at(this,"syncInProgress",!1);at(this,"syncInterval",null);this.initDB(),this.setupEventListeners(),this.startPeriodicSync()}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.syncPendingOperations()}),window.addEventListener("offline",()=>{this.isOnline=!1})}startPeriodicSync(){this.syncInterval=window.setInterval(()=>{this.isOnline&&!this.syncInProgress&&this.syncPendingOperations()},3e4)}async initDB(){return new Promise((t,r)=>{const n=indexedDB.open(this.dbName,this.dbVersion);n.onerror=()=>r(n.error),n.onsuccess=()=>{this.db=n.result,t(this.db)},n.onupgradeneeded=a=>{const s=a.target.result;if(!s.objectStoreNames.contains(this.storeName)){const i=s.createObjectStore(this.storeName,{keyPath:"id",autoIncrement:!0});i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("endpoint","endpoint",{unique:!1}),i.createIndex("status","status",{unique:!1}),i.createIndex("priority","priority",{unique:!1})}}})}async addOperation(t){var n,a,s;this.db||await this.initDB();const r={...t,id:this.generateOperationId(),timestamp:Date.now(),status:"pending",retryCount:0,maxRetries:t.maxRetries||3,priority:t.priority||"normal",createdAt:new Date().toISOString()};try{const i=((n=r.headers)==null?void 0:n["Idempotency-Key"])||((a=r.headers)==null?void 0:a["idempotency-key"])||((s=r.headers)==null?void 0:s["Idempotency-key"]);if(i){const l=(await this.getPendingOperations()).find(c=>{if(!c||!c.headers)return!1;const d=c.headers["Idempotency-Key"]||c.headers["idempotency-key"]||c.headers["Idempotency-key"];return c.endpoint===r.endpoint&&(c.method||"GET")===(r.method||"GET")&&d===i});if(l)return this.emitOutboxEvent("operation-duplicate",l),l}}catch(i){console.warn("Outbox deduplication check failed, proceeding to add operation:",i)}return new Promise((i,o)=>{const d=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).add(r);d.onsuccess=()=>{this.emitOutboxEvent("operation-added",r),i(r)},d.onerror=()=>o(d.error)})}async getPendingOperations(){return this.db||await this.initDB(),new Promise((t,r)=>{const i=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).index("status").getAll("pending");i.onsuccess=()=>{const o=i.result.sort((l,c)=>{const d={high:3,normal:2,low:1},f=d[l.priority||"normal"],h=d[c.priority||"normal"];return f!==h?h-f:(l.timestamp||0)-(c.timestamp||0)});t(o)},i.onerror=()=>r(i.error)})}async updateOperation(t,r){return this.db||await this.initDB(),new Promise((n,a)=>{const i=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName),o=i.get(t);o.onsuccess=()=>{const l=o.result;if(!l){a(new Error("Operation not found"));return}const c={...l,...r},d=i.put(c);d.onsuccess=()=>{this.emitOutboxEvent("operation-updated",c),n(c)},d.onerror=()=>a(d.error)},o.onerror=()=>a(o.error)})}async removeOperation(t){return this.db||await this.initDB(),new Promise((r,n)=>{const i=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(t);i.onsuccess=()=>{this.emitOutboxEvent("operation-removed",{id:t}),r()},i.onerror=()=>n(i.error)})}async syncPendingOperations(){if(!(this.syncInProgress||!this.isOnline)){this.syncInProgress=!0,this.emitOutboxEvent("sync-started",{});try{const t=await this.getPendingOperations();let r=0,n=0;for(const a of t)try{const s=await this.executeOperation(a);this.emitOutboxEvent("operation-succeeded",{operation:a,result:s}),await this.removeOperation(a.id),r++}catch(s){console.error("Operation failed:",s);const i=(a.retryCount||0)+1;i>=(a.maxRetries||3)?await this.updateOperation(a.id,{status:"failed",retryCount:i,lastError:s instanceof Error?s.message:String(s),failedAt:new Date().toISOString()}):await this.updateOperation(a.id,{retryCount:i,lastError:s instanceof Error?s.message:String(s),nextRetryAt:new Date(Date.now()+this.getRetryDelay(i)).toISOString()}),n++}this.emitOutboxEvent("sync-completed",{total:t.length,success:r,failures:n})}catch(t){console.error("Sync failed:",t),this.emitOutboxEvent("sync-failed",t)}finally{this.syncInProgress=!1}}}async executeOperation(t){const{method:r,endpoint:n,data:a,headers:s={}}=t,i="http://localhost:5003",o=n.startsWith("http")?n:`${i}${n}`,l=await fetch(o,{method:r,headers:{"Content-Type":"application/json",...s},body:a?JSON.stringify(a):void 0});if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);return await l.json()}getRetryDelay(t){return Math.min(1e3*Math.pow(2,t),6e4)+Math.random()*1e3}generateOperationId(){return`op_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}emitOutboxEvent(t,r={}){window.dispatchEvent(new CustomEvent("outbox-event",{detail:{type:t,data:r,timestamp:Date.now()}}))}async getStats(){return this.db||await this.initDB(),new Promise((t,r)=>{const s=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();s.onsuccess=()=>{const i=s.result,o={total:i.length,pending:i.filter(c=>c.status==="pending").length,failed:i.filter(c=>c.status==="failed").length,oldestPending:null,newestPending:null},l=i.filter(c=>c.status==="pending");l.length>0&&(o.oldestPending=Math.min(...l.map(c=>c.timestamp||0)),o.newestPending=Math.max(...l.map(c=>c.timestamp||0))),t(o)},s.onerror=()=>r(s.error)})}async clearFailedOperations(){return this.db||await this.initDB(),new Promise((t,r)=>{const i=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).index("status").openCursor(IDBKeyRange.only("failed"));let o=0;i.onsuccess=l=>{const c=l.target.result;c?(c.delete(),o++,c.continue()):(this.emitOutboxEvent("failed-operations-cleared",{count:o}),t(o))},i.onerror=()=>r(i.error)})}destroy(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null),this.db&&(this.db.close(),this.db=null)}}const pr=new fM,fv="patient-search-filters",hv="patient-bulk-actions-state",hM="x-ear.auth.token@v1",mM="x-ear.auth.refresh@v1",pM="x-ear.user.preferences@v1",mv="x-ear.ui.sidebarCollapsed@v1",xM="x-ear.ui.themeMode@v1",gM="x-ear.forms.patient.draft@v1",vM="x-ear.forms.appointment.draft@v1",pv="x-ear.patients.detailsTab@v1",xv="x-ear.cache.api@v1",Go="x-ear.patients.data@v1",gv="x-ear.patients.legacy@v1",yM="x-ear.patients.crm@v1",wM="x-ear.sms.messages@v1",kM="x-ear.sgk.data@v1",vv="x-ear.sgk.documents@v1",yv="x-ear.patients.documents@v1",SM="x-ear.sgk.unmatchedDocs@v1",EM="x-ear.inventory.filterPreset@v1",wv="x-ear.cashflow.records@v1",_M="x-ear.appointments.data@v1",bM="x-ear.appointments.filterPresets@v1",TM="x-ear.sgk.reports@v1",CM="x-ear.cashflow.incomeTypes@v1",NM="x-ear.cashflow.expenseTypes@v1",AM="x-ear.devices.maintenance@v1",FM="x-ear.notifications.data@v1",PM="x-ear.automation.rules@v1",RM="x-ear.sms.logs@v1",DM="x-ear.automation.logs@v1",kv="x-ear.inventory.data@v1",Sv="x-ear.invoices.data@v1",Ev="x-ear.purchases.data@v1",jM="x-ear.patients.savedViews@v1",IM="x-ear.ocr.dynamicNames@v1",_v="x-ear.auth.currentUser@v1",OM="x-ear.system.settings@v1",MM="x-ear.sgk.backgroundStatus@v1",LM="x-ear.ui.sgkSubmenuExpanded@v1",BM="x-ear.ui.faturaSubmenuExpanded@v1",UM="x-ear.ui.reportsSubmenuExpanded@v1",$M="x-ear.auth.accessToken@v1",bv="x-ear.auth.jwt@v1",pE=(e,t)=>zt.get("/api/patients",{...t,params:{...e,...t==null?void 0:t.params}}),zM="XEarPatientDB",VM=1,Yr="patients",ya="cache";class HM{constructor(){at(this,"db",null);at(this,"initPromise",null)}async init(){return this.initPromise?this.initPromise:(this.initPromise=new Promise((t,r)=>{const n=indexedDB.open(zM,VM);n.onerror=()=>{r(new Error("Failed to open IndexedDB"))},n.onsuccess=()=>{this.db=n.result,t()},n.onupgradeneeded=a=>{const s=a.target.result;if(!s.objectStoreNames.contains(Yr)){const i=s.createObjectStore(Yr,{keyPath:"id"});i.createIndex("tcNumber","tcNumber",{unique:!1}),i.createIndex("status","status",{unique:!1}),i.createIndex("updatedAt","updatedAt",{unique:!1})}s.objectStoreNames.contains(ya)||s.createObjectStore(ya,{keyPath:"key"})}}),this.initPromise)}async ensureDB(){if(this.db||await this.init(),!this.db)throw new Error("IndexedDB not initialized");return this.db}async savePatients(t){const n=(await this.ensureDB()).transaction([Yr],"readwrite"),a=n.objectStore(Yr);await new Promise((s,i)=>{const o=a.clear();o.onsuccess=()=>s(),o.onerror=()=>i(o.error)});for(const s of t)await new Promise((i,o)=>{const l=a.add(s);l.onsuccess=()=>i(),l.onerror=()=>o(l.error)});await new Promise((s,i)=>{n.oncomplete=()=>s(),n.onerror=()=>i(n.error)})}async getPatients(){const n=(await this.ensureDB()).transaction([Yr],"readonly").objectStore(Yr);return new Promise((a,s)=>{const i=n.getAll();i.onsuccess=()=>a(i.result||[]),i.onerror=()=>s(i.error)})}async getPatient(t){const a=(await this.ensureDB()).transaction([Yr],"readonly").objectStore(Yr);return new Promise((s,i)=>{const o=a.get(t);o.onsuccess=()=>s(o.result||null),o.onerror=()=>i(o.error)})}async updatePatient(t){const a=(await this.ensureDB()).transaction([Yr],"readwrite").objectStore(Yr);return new Promise((s,i)=>{const o=a.put(t);o.onsuccess=()=>s(),o.onerror=()=>i(o.error)})}async deletePatient(t){const a=(await this.ensureDB()).transaction([Yr],"readwrite").objectStore(Yr);return new Promise((s,i)=>{const o=a.delete(t);o.onsuccess=()=>s(),o.onerror=()=>i(o.error)})}async setCache(t,r,n){const i=(await this.ensureDB()).transaction([ya],"readwrite").objectStore(ya),o={key:t,data:r,timestamp:Date.now(),ttl:n};return new Promise((l,c)=>{const d=i.put(o);d.onsuccess=()=>l(),d.onerror=()=>c(d.error)})}async getCache(t){const a=(await this.ensureDB()).transaction([ya],"readonly").objectStore(ya);return new Promise((s,i)=>{const o=a.get(t);o.onsuccess=()=>{const l=o.result;if(!l){s(null);return}if(l.ttl&&Date.now()-l.timestamp>l.ttl){this.deleteCache(t),s(null);return}s(l.data)},o.onerror=()=>i(o.error)})}async deleteCache(t){const a=(await this.ensureDB()).transaction([ya],"readwrite").objectStore(ya);return new Promise((s,i)=>{const o=a.delete(t);o.onsuccess=()=>s(),o.onerror=()=>i(o.error)})}async fallbackToLocalStorage(t){try{const r=localStorage.getItem(t);return r?JSON.parse(r):null}catch(r){return console.warn("Failed to read from localStorage fallback:",r),null}}async saveFallbackToLocalStorage(t,r){try{localStorage.setItem(t,JSON.stringify(r))}catch(n){console.warn("Failed to save to localStorage fallback:",n)}}}const Ze=new HM;class WM{constructor(){at(this,"patients",[]);at(this,"initialized",!1);this.init()}async init(){this.initialized||(await Ze.init(),await this.loadPatients(),this.initialized=!0,window.addEventListener("storage",this.handleStorageChange.bind(this)))}handleStorageChange(t){t.key===Go&&this.loadPatients()}async loadPatients(){try{const t=await Ze.getPatients();if(t.length>0){this.patients=t,console.log(` Loaded ${t.length} patients from IndexedDB cache`),this.refreshFromAPI().catch(r=>console.warn("Background API refresh failed:",r));return}}catch(t){console.warn("Failed to load from IndexedDB, trying API:",t)}await this.refreshFromAPI()}async refreshFromAPI(){try{const t=[];let r;for(;;){const a={per_page:100};r&&(a.cursor=r);const s=await pE(a).catch(c=>{throw c}),i=s==null?void 0:s.data;if(!i||!Array.isArray(i.data))break;const o=i.data;t.push(...o);const l=i.pagination;if(!(l!=null&&l.hasNext)||!(l!=null&&l.nextCursor)||(r=l.nextCursor,o.length===0))break}if(t.length>0){const a=t.map(s=>this.convertOrvalPatient(s));this.patients=a,await Ze.savePatients(a),console.log(` Refreshed ${a.length} patients from API and cached in IndexedDB`)}}catch(t){console.warn("API refresh failed, trying localStorage fallback:",t);try{const r=localStorage.getItem(Go);if(r){const n=JSON.parse(r);this.patients=Array.isArray(n)?n:[],console.log(` Loaded ${this.patients.length} patients from localStorage fallback`)}}catch(r){console.error("Both API and localStorage failed:",r),this.patients=[]}}}async savePatients(){try{await Ze.savePatients(this.patients);const t={count:this.patients.length,lastUpdated:new Date().toISOString(),version:1};await Ze.saveFallbackToLocalStorage(Go+"_meta",t),window.dispatchEvent(new CustomEvent("patients:updated",{detail:{patients:this.patients}}))}catch(t){console.error("Failed to save patients to IndexedDB:",t);try{await Ze.saveFallbackToLocalStorage(Go,this.patients),console.warn("Used localStorage emergency fallback for patient data")}catch(r){console.error("Failed to save patients even to localStorage fallback:",r)}}}normalizePatientData(){this.patients=this.patients.map(t=>({...t,name:t.name||`${t.firstName||""} ${t.lastName||""}`.trim()||"Unnamed Patient",tags:Array.isArray(t.tags)?t.tags:[],devices:Array.isArray(t.devices)?t.devices:[],notes:Array.isArray(t.notes)?t.notes:[],communications:Array.isArray(t.communications)?t.communications:[],reports:Array.isArray(t.reports)?t.reports:[],ereceiptHistory:Array.isArray(t.ereceiptHistory)?t.ereceiptHistory:[],sgkInfo:t.sgkInfo||{hasInsurance:!1},priorityScore:t.priorityScore||this.calculatePriorityScore(t)}))}async createPatient(t){var r,n;try{if(await this.init(),!((r=t.name)!=null&&r.trim()))throw new Error("Patient name is required");if(!((n=t.phone)!=null&&n.trim()))throw new Error("Patient phone is required");if(t.tcNumber&&!await this.validateTcNumber(t.tcNumber))throw new Error("TC number already exists");if(t.sgkStatus&&!["pending","approved","rejected","paid"].includes(t.sgkStatus))throw new Error("Invalid SGK status format");const a={id:this.generateId(),...t,name:t.name||`${t.firstName||""} ${t.lastName||""}`.trim()||"Unnamed Patient",tags:t.tags||[],devices:t.devices||[],notes:t.notes||[],communications:t.communications||[],reports:t.reports||[],ereceiptHistory:t.ereceiptHistory||[],sgkInfo:t.sgkInfo||{hasInsurance:!1},priorityScore:this.calculatePriorityScore(t),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};this.patients.push(a),this.savePatients();try{await pr.addOperation({method:"POST",endpoint:"/api/patients",data:a,priority:"high"})}catch(s){console.warn("Failed to queue patient creation for sync:",s)}return window.dispatchEvent(new CustomEvent("patient:created",{detail:{patient:a}})),a}catch(a){throw console.error("Failed to create patient:",a),a instanceof Error?a:new Error("Failed to create patient")}}async updatePatient(t,r){try{if(await this.init(),!(t!=null&&t.trim()))throw new Error("Patient ID is required");const n=this.patients.findIndex(i=>i.id===t);if(n===-1)throw new Error("Patient not found");if(r.tcNumber&&r.tcNumber!==this.patients[n].tcNumber&&!await this.validateTcNumber(r.tcNumber,t))throw new Error("TC number already exists");const a={...this.patients[n]},s={...this.patients[n],...r,id:t,updatedAt:new Date().toISOString(),priorityScore:this.calculatePriorityScore({...this.patients[n],...r})};this.patients[n]=s,this.savePatients();try{await pr.addOperation({method:"PUT",endpoint:`/api/patients/${t}`,data:r,headers:{"If-Match":a.updatedAt||new Date().toISOString()},priority:"high"})}catch(i){console.warn("Failed to queue patient update for sync:",i)}return window.dispatchEvent(new CustomEvent("patient:updated",{detail:{patient:s,oldPatient:a,changes:r}})),s}catch(n){throw console.error("Failed to update patient:",n),n instanceof Error?n:new Error("Failed to update patient")}}async deletePatient(t){try{if(await this.init(),!(t!=null&&t.trim()))throw new Error("Patient ID is required");const r=this.patients.findIndex(a=>a.id===t);if(r===-1)throw new Error("Patient not found");const n=this.patients[r];this.patients.splice(r,1),this.savePatients();try{await pr.addOperation({method:"DELETE",endpoint:`/api/patients/${t}`,priority:"normal"})}catch(a){console.warn("Failed to queue patient deletion for sync:",a)}return window.dispatchEvent(new CustomEvent("patient:deleted",{detail:{patient:n}})),!0}catch(r){throw console.error("Failed to delete patient:",r),r instanceof Error?r:new Error("Failed to delete patient")}}async getPatient(t){try{return await this.init(),t!=null&&t.trim()&&this.patients.find(r=>r.id===t)||null}catch(r){return console.error("Failed to get patient:",r),null}}async getPatients(t={}){var r;try{await this.init();let n=[...this.patients];if((r=t.search)!=null&&r.trim()){const d=t.search.toLowerCase();n=n.filter(f=>f.name.toLowerCase().includes(d)||f.phone.includes(t.search)||f.tcNumber&&f.tcNumber.includes(t.search)||f.email&&f.email.toLowerCase().includes(d))}if(t.status&&(n=n.filter(d=>d.status===t.status)),t.segment&&(n=n.filter(d=>d.segment===t.segment)),t.label&&(n=n.filter(d=>d.label===t.label)),t.acquisitionType&&(n=n.filter(d=>d.acquisitionType===t.acquisitionType)),t.tags&&t.tags.length>0&&(n=n.filter(d=>t.tags.some(f=>d.tags.includes(f)))),t.hasDevices!==void 0&&(n=n.filter(d=>t.hasDevices?d.devices.length>0:d.devices.length===0)),t.sgkStatus&&(n=n.filter(d=>d.sgkStatus===t.sgkStatus)),t.priorityScore&&(n=n.filter(d=>{const f=d.priorityScore||0;return(!t.priorityScore.min||f>=t.priorityScore.min)&&(!t.priorityScore.max||f<=t.priorityScore.max)})),t.dateRange)try{const d=new Date(t.dateRange.start),f=new Date(t.dateRange.end);n=n.filter(h=>{const p=new Date(h.createdAt);return p>=d&&p<=f})}catch(d){console.warn("Invalid date range filter:",d)}n.sort((d,f)=>{const h=(f.priorityScore||0)-(d.priorityScore||0);if(h!==0)return h;const p=d.name||"",x=f.name||"";return p.localeCompare(x,"tr")});const a=t.page||1,s=t.limit||20,i=(a-1)*s,o=i+s,l=n.slice(i,o),c=o<n.length;return{patients:l,total:n.length,page:a,pageSize:s,hasMore:c}}catch(n){return console.error("Failed to get patients:",n),{patients:[],total:0,page:1,pageSize:0,hasMore:!1}}}async getPatientStats(){try{await this.init();const t={total:this.patients.length,byStatus:{active:0,inactive:0,archived:0},bySegment:{new:0,trial:0,purchased:0,control:0,renewal:0},byLabel:{yeni:0,"arama-bekliyor":0,"randevu-verildi":0,"deneme-yapildi":0,"kontrol-hastasi":0,"satis-tamamlandi":0},highPriority:0,withDevices:0,sgkPending:0,overduePayments:0};return this.patients.forEach(r=>{try{r.status in t.byStatus&&t.byStatus[r.status]++,r.segment in t.bySegment&&t.bySegment[r.segment]++,r.label in t.byLabel&&t.byLabel[r.label]++,(r.priorityScore||0)>=80&&t.highPriority++,r.devices&&r.devices.length>0&&t.withDevices++,r.sgkStatus==="pending"&&t.sgkPending++,r.installments&&r.installments.some(n=>n.status==="overdue"||n.dueDate&&new Date(n.dueDate)<new Date&&n.status==="pending")&&t.overduePayments++}catch(n){console.warn("Error processing patient stats for patient:",r.id,n)}}),t}catch(t){return console.error("Failed to get patient stats:",t),{total:0,byStatus:{active:0,inactive:0,archived:0},bySegment:{new:0,trial:0,purchased:0,control:0,renewal:0},byLabel:{yeni:0,"arama-bekliyor":0,"randevu-verildi":0,"deneme-yapildi":0,"kontrol-hastasi":0,"satis-tamamlandi":0},highPriority:0,withDevices:0,sgkPending:0,overduePayments:0}}}calculatePriorityScore(t){let r=0;if(t.deviceTrial&&t.priceGiven&&!t.purchased&&(r+=100),t.lastContactDate){const n=Math.floor((Date.now()-new Date(t.lastContactDate).getTime())/864e5);n>30&&(r+=Math.min(n,50))}if(t.missedAppointments&&t.missedAppointments>0&&(r+=t.missedAppointments*20),t.overdueAmount&&t.overdueAmount>0&&(r+=Math.min(t.overdueAmount/1e3*10,50)),t.sgkStatus==="rejected"?r+=75:t.sgkStatus==="pending"&&(r+=25),t.batteryReportDue){const n=new Date(t.batteryReportDue),a=Math.floor((n.getTime()-Date.now())/(1e3*60*60*24));a<=30&&a>=0?r+=30-a:a<0&&(r+=Math.abs(a)*2)}return Math.round(r)}async getHighPriorityPatients(){try{return await this.init(),this.patients.filter(t=>(t.priorityScore||0)>=80).sort((t,r)=>(r.priorityScore||0)-(t.priorityScore||0))}catch(t){return console.error("Failed to get high priority patients:",t),[]}}async addDevice(t,r){var n;try{if(!(t!=null&&t.trim()))throw new Error("Patient ID is required");if(!((n=r.type)!=null&&n.trim()))throw new Error("Device type is required");const a=await this.getPatient(t);if(!a)throw new Error("Patient not found");const s={id:this.generateId(),...r};return await this.updatePatient(t,{devices:[...a.devices,s]})?s:null}catch(a){throw console.error("Failed to add device:",a),a instanceof Error?a:new Error("Failed to add device")}}async updateDevice(t,r,n){try{if(!(t!=null&&t.trim())||!(r!=null&&r.trim()))throw new Error("Patient ID and Device ID are required");const a=await this.getPatient(t);if(!a)throw new Error("Patient not found");const s=a.devices.findIndex(c=>c.id===r);if(s===-1)throw new Error("Device not found");const i={...a.devices[s],...n},o=[...a.devices];return o[s]=i,await this.updatePatient(t,{devices:o})?i:null}catch(a){throw console.error("Failed to update device:",a),a instanceof Error?a:new Error("Failed to update device")}}async addNote(t,r,n="general"){try{if(!(t!=null&&t.trim()))throw new Error("Patient ID is required");if(!(r!=null&&r.trim()))throw new Error("Note text is required");const a=await this.getPatient(t);if(!a)throw new Error("Patient not found");const s={id:this.generateId(),author:"System",date:new Date().toISOString(),text:r.trim(),type:n};return await this.updatePatient(t,{notes:[...a.notes,s]})?s:null}catch(a){throw console.error("Failed to add note:",a),a instanceof Error?a:new Error("Failed to add note")}}async addCommunication(t,r){var n;try{if(!(t!=null&&t.trim()))throw new Error("Patient ID is required");if(!r.type||!((n=r.content)!=null&&n.trim()))throw new Error("Communication type and content are required");const a=await this.getPatient(t);if(!a)throw new Error("Patient not found");const s={id:this.generateId(),...r,timestamp:new Date().toISOString()};return await this.updatePatient(t,{communications:[...a.communications||[],s]})?s:null}catch(a){throw console.error("Failed to add communication:",a),a instanceof Error?a:new Error("Failed to add communication")}}async findMatches(t){await this.init();const r=[];for(const n of this.patients){const a=this.calculatePatientMatch(t,n);a.score>.3&&r.push(a)}return r.sort((n,a)=>a.score-n.score),r.slice(0,10)}calculatePatientMatch(t,r){let n=0;const a=[];if(t.tcNo&&r.tcNumber&&t.tcNo===r.tcNumber&&(n+=.8,a.push("tcNumber")),t.name&&r.name){const i=this.calculateStringSimilarity(t.name,r.name);i>.6&&(n+=i*.4,a.push("name"))}if(t.birthDate&&r.birthDate&&t.birthDate===r.birthDate&&(n+=.3,a.push("birthDate")),t.phone&&r.phone){const i=this.calculateStringSimilarity(t.phone,r.phone);i>.8&&(n+=i*.2,a.push("phone"))}let s="low";return n>=.8?s="high":n>=.6&&(s="medium"),{patient:r,score:n,matchedFields:a,confidence:s}}calculateStringSimilarity(t,r){const n=t.length>r.length?t:r,a=t.length>r.length?r:t;if(n.length===0)return 1;const s=this.levenshteinDistance(n,a);return(n.length-s)/n.length}levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let a=0;a<=t.length;a++)n[0][a]=a;for(let a=0;a<=r.length;a++)n[a][0]=a;for(let a=1;a<=r.length;a++)for(let s=1;s<=t.length;s++){const i=t[s-1]===r[a-1]?0:1;n[a][s]=Math.min(n[a][s-1]+1,n[a-1][s]+1,n[a-1][s-1]+i)}return n[r.length][t.length]}generateId(){return`patient_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async validateTcNumber(t,r){try{return await this.init(),!(t!=null&&t.trim())||!/^\d{11}$/.test(t)?!1:!this.patients.some(n=>n.tcNumber===t&&n.id!==r)}catch(n){return console.error("Failed to validate TC number:",n),!1}}async bulkUpdatePatients(t){var a;const r=[],n=[];for(const s of t)try{if(!((a=s.id)!=null&&a.trim())){n.push("Missing patient ID in bulk update");continue}const i=await this.updatePatient(s.id,s.data);i&&r.push(i)}catch(i){n.push(`Failed to update patient ${s.id}: ${i}`)}return n.length>0&&console.warn("Bulk update errors:",n),r}async exportPatients(){try{return await this.init(),JSON.stringify(this.patients,null,2)}catch(t){throw console.error("Failed to export patients:",t),new Error("Failed to export patients")}}async importPatients(t){try{await this.init();const r=JSON.parse(t);if(!Array.isArray(r))throw new Error("Invalid data format");const n={success:0,errors:[]};for(const a of r)try{await this.createPatient(a),n.success++}catch(s){n.errors.push(`Failed to import patient: ${s instanceof Error?s.message:"Unknown error"}`)}return n}catch(r){throw new Error(`Import failed: ${r instanceof Error?r.message:"Unknown error"}`)}}convertOrvalPatient(t){return{id:t.id||t._id||t.patientId||"",name:`${t.firstName||""} ${t.lastName||""}`.trim()||"Unnamed Patient",firstName:t.firstName||"",lastName:t.lastName||"",phone:t.phone||"",email:t.email||"",tcNumber:t.tcNumber||t.identityNumber||"",birthDate:t.birthDate||"",address:t.addressFull||`${t.addressCity||""} ${t.addressDistrict||""}`.trim()||void 0,status:(t.status||"active").toLowerCase(),segment:t.segment||"new",label:"yeni",acquisitionType:t.acquisitionType||"diger",tags:Array.isArray(t.tags)?t.tags:[],devices:[],notes:[],communications:[],reports:[],ereceiptHistory:[],sgkInfo:{hasInsurance:!!t.sgkInfo,...t.sgkInfo},sgkStatus:"pending",priorityScore:t.priorityScore||0,createdAt:t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt||new Date().toISOString()}}}const Mt=new WM;function ma(e){return Array.isArray?Array.isArray(e):vE(e)==="[object Array]"}const KM=1/0;function GM(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-KM?"-0":t}function YM(e){return e==null?"":GM(e)}function Ln(e){return typeof e=="string"}function xE(e){return typeof e=="number"}function XM(e){return e===!0||e===!1||qM(e)&&vE(e)=="[object Boolean]"}function gE(e){return typeof e=="object"}function qM(e){return gE(e)&&e!==null}function Mr(e){return e!=null}function rf(e){return!e.trim().length}function vE(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const QM="Incorrect 'index' type",JM=e=>`Invalid value for key ${e}`,ZM=e=>`Pattern length exceeds max of ${e}.`,eL=e=>`Missing ${e} property in key`,tL=e=>`Property 'weight' in key '${e}' must be a positive integer`,Tv=Object.prototype.hasOwnProperty;class rL{constructor(t){this._keys=[],this._keyMap={};let r=0;t.forEach(n=>{let a=yE(n);this._keys.push(a),this._keyMap[a.id]=a,r+=a.weight}),this._keys.forEach(n=>{n.weight/=r})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function yE(e){let t=null,r=null,n=null,a=1,s=null;if(Ln(e)||ma(e))n=e,t=Cv(e),r=Uh(e);else{if(!Tv.call(e,"name"))throw new Error(eL("name"));const i=e.name;if(n=i,Tv.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(tL(i));t=Cv(i),r=Uh(i),s=e.getFn}return{path:t,id:r,weight:a,src:n,getFn:s}}function Cv(e){return ma(e)?e:e.split(".")}function Uh(e){return ma(e)?e.join("."):e}function nL(e,t){let r=[],n=!1;const a=(s,i,o)=>{if(Mr(s))if(!i[o])r.push(s);else{let l=i[o];const c=s[l];if(!Mr(c))return;if(o===i.length-1&&(Ln(c)||xE(c)||XM(c)))r.push(YM(c));else if(ma(c)){n=!0;for(let d=0,f=c.length;d<f;d+=1)a(c[d],i,o+1)}else i.length&&a(c,i,o+1)}};return a(e,Ln(t)?t.split("."):t,0),n?r:r[0]}const aL={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},sL={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},iL={location:0,threshold:.6,distance:100},oL={useExtendedSearch:!1,getFn:nL,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Fe={...sL,...aL,...iL,...oL};const lL=/[^ ]+/g;function cL(e=1,t=3){const r=new Map,n=Math.pow(10,t);return{get(a){const s=a.match(lL).length;if(r.has(s))return r.get(s);const i=1/Math.pow(s,.5*e),o=parseFloat(Math.round(i*n)/n);return r.set(s,o),o},clear(){r.clear()}}}class Hp{constructor({getFn:t=Fe.getFn,fieldNormWeight:r=Fe.fieldNormWeight}={}){this.norm=cL(r,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((r,n)=>{this._keysMap[r.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Ln(this.docs[0])?this.docs.forEach((t,r)=>{this._addString(t,r)}):this.docs.forEach((t,r)=>{this._addObject(t,r)}),this.norm.clear())}add(t){const r=this.size();Ln(t)?this._addString(t,r):this._addObject(t,r)}removeAt(t){this.records.splice(t,1);for(let r=t,n=this.size();r<n;r+=1)this.records[r].i-=1}getValueForItemAtKeyId(t,r){return t[this._keysMap[r]]}size(){return this.records.length}_addString(t,r){if(!Mr(t)||rf(t))return;let n={v:t,i:r,n:this.norm.get(t)};this.records.push(n)}_addObject(t,r){let n={i:r,$:{}};this.keys.forEach((a,s)=>{let i=a.getFn?a.getFn(t):this.getFn(t,a.path);if(Mr(i)){if(ma(i)){let o=[];const l=[{nestedArrIndex:-1,value:i}];for(;l.length;){const{nestedArrIndex:c,value:d}=l.pop();if(Mr(d))if(Ln(d)&&!rf(d)){let f={v:d,i:c,n:this.norm.get(d)};o.push(f)}else ma(d)&&d.forEach((f,h)=>{l.push({nestedArrIndex:h,value:f})})}n.$[s]=o}else if(Ln(i)&&!rf(i)){let o={v:i,n:this.norm.get(i)};n.$[s]=o}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function wE(e,t,{getFn:r=Fe.getFn,fieldNormWeight:n=Fe.fieldNormWeight}={}){const a=new Hp({getFn:r,fieldNormWeight:n});return a.setKeys(e.map(yE)),a.setSources(t),a.create(),a}function uL(e,{getFn:t=Fe.getFn,fieldNormWeight:r=Fe.fieldNormWeight}={}){const{keys:n,records:a}=e,s=new Hp({getFn:t,fieldNormWeight:r});return s.setKeys(n),s.setIndexRecords(a),s}function su(e,{errors:t=0,currentLocation:r=0,expectedLocation:n=0,distance:a=Fe.distance,ignoreLocation:s=Fe.ignoreLocation}={}){const i=t/e.length;if(s)return i;const o=Math.abs(n-r);return a?i+o/a:o?1:i}function dL(e=[],t=Fe.minMatchCharLength){let r=[],n=-1,a=-1,s=0;for(let i=e.length;s<i;s+=1){let o=e[s];o&&n===-1?n=s:!o&&n!==-1&&(a=s-1,a-n+1>=t&&r.push([n,a]),n=-1)}return e[s-1]&&s-n>=t&&r.push([n,s-1]),r}const gs=32;function fL(e,t,r,{location:n=Fe.location,distance:a=Fe.distance,threshold:s=Fe.threshold,findAllMatches:i=Fe.findAllMatches,minMatchCharLength:o=Fe.minMatchCharLength,includeMatches:l=Fe.includeMatches,ignoreLocation:c=Fe.ignoreLocation}={}){if(t.length>gs)throw new Error(ZM(gs));const d=t.length,f=e.length,h=Math.max(0,Math.min(n,f));let p=s,x=h;const m=o>1||l,v=m?Array(f):[];let g;for(;(g=e.indexOf(t,x))>-1;){let b=su(t,{currentLocation:g,expectedLocation:h,distance:a,ignoreLocation:c});if(p=Math.min(b,p),x=g+d,m){let k=0;for(;k<d;)v[g+k]=1,k+=1}}x=-1;let y=[],w=1,S=d+f;const A=1<<d-1;for(let b=0;b<d;b+=1){let k=0,E=S;for(;k<E;)su(t,{errors:b,currentLocation:h+E,expectedLocation:h,distance:a,ignoreLocation:c})<=p?k=E:S=E,E=Math.floor((S-k)/2+k);S=E;let _=Math.max(1,h-E+1),C=i?f:Math.min(h+E,f)+d,F=Array(C+2);F[C+1]=(1<<b)-1;for(let M=C;M>=_;M-=1){let B=M-1,q=r[e.charAt(B)];if(m&&(v[B]=+!!q),F[M]=(F[M+1]<<1|1)&q,b&&(F[M]|=(y[M+1]|y[M])<<1|1|y[M+1]),F[M]&A&&(w=su(t,{errors:b,currentLocation:B,expectedLocation:h,distance:a,ignoreLocation:c}),w<=p)){if(p=w,x=B,x<=h)break;_=Math.max(1,2*h-x)}}if(su(t,{errors:b+1,currentLocation:h,expectedLocation:h,distance:a,ignoreLocation:c})>p)break;y=F}const T={isMatch:x>=0,score:Math.max(.001,w)};if(m){const b=dL(v,o);b.length?l&&(T.indices=b):T.isMatch=!1}return T}function hL(e){let t={};for(let r=0,n=e.length;r<n;r+=1){const a=e.charAt(r);t[a]=(t[a]||0)|1<<n-r-1}return t}const y0=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class kE{constructor(t,{location:r=Fe.location,threshold:n=Fe.threshold,distance:a=Fe.distance,includeMatches:s=Fe.includeMatches,findAllMatches:i=Fe.findAllMatches,minMatchCharLength:o=Fe.minMatchCharLength,isCaseSensitive:l=Fe.isCaseSensitive,ignoreDiacritics:c=Fe.ignoreDiacritics,ignoreLocation:d=Fe.ignoreLocation}={}){if(this.options={location:r,threshold:n,distance:a,includeMatches:s,findAllMatches:i,minMatchCharLength:o,isCaseSensitive:l,ignoreDiacritics:c,ignoreLocation:d},t=l?t:t.toLowerCase(),t=c?y0(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const f=(p,x)=>{this.chunks.push({pattern:p,alphabet:hL(p),startIndex:x})},h=this.pattern.length;if(h>gs){let p=0;const x=h%gs,m=h-x;for(;p<m;)f(this.pattern.substr(p,gs),p),p+=gs;if(x){const v=h-gs;f(this.pattern.substr(v),v)}}else f(this.pattern,0)}searchIn(t){const{isCaseSensitive:r,ignoreDiacritics:n,includeMatches:a}=this.options;if(t=r?t:t.toLowerCase(),t=n?y0(t):t,this.pattern===t){let m={isMatch:!0,score:0};return a&&(m.indices=[[0,t.length-1]]),m}const{location:s,distance:i,threshold:o,findAllMatches:l,minMatchCharLength:c,ignoreLocation:d}=this.options;let f=[],h=0,p=!1;this.chunks.forEach(({pattern:m,alphabet:v,startIndex:g})=>{const{isMatch:y,score:w,indices:S}=fL(t,m,v,{location:s+g,distance:i,threshold:o,findAllMatches:l,minMatchCharLength:c,includeMatches:a,ignoreLocation:d});y&&(p=!0),h+=w,y&&S&&(f=[...f,...S])});let x={isMatch:p,score:p?h/this.chunks.length:1};return p&&a&&(x.indices=f),x}}class ds{constructor(t){this.pattern=t}static isMultiMatch(t){return Nv(t,this.multiRegex)}static isSingleMatch(t){return Nv(t,this.singleRegex)}search(){}}function Nv(e,t){const r=e.match(t);return r?r[1]:null}class mL extends ds{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const r=t===this.pattern;return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class pL extends ds{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const n=t.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}class xL extends ds{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const r=t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class gL extends ds{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const r=!t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class vL extends ds{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const r=t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class yL extends ds{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const r=!t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class SE extends ds{constructor(t,{location:r=Fe.location,threshold:n=Fe.threshold,distance:a=Fe.distance,includeMatches:s=Fe.includeMatches,findAllMatches:i=Fe.findAllMatches,minMatchCharLength:o=Fe.minMatchCharLength,isCaseSensitive:l=Fe.isCaseSensitive,ignoreDiacritics:c=Fe.ignoreDiacritics,ignoreLocation:d=Fe.ignoreLocation}={}){super(t),this._bitapSearch=new kE(t,{location:r,threshold:n,distance:a,includeMatches:s,findAllMatches:i,minMatchCharLength:o,isCaseSensitive:l,ignoreDiacritics:c,ignoreLocation:d})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class EE extends ds{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let r=0,n;const a=[],s=this.pattern.length;for(;(n=t.indexOf(this.pattern,r))>-1;)r=n+s,a.push([n,r-1]);const i=!!a.length;return{isMatch:i,score:i?0:1,indices:a}}}const $h=[mL,EE,xL,gL,yL,vL,pL,SE],Av=$h.length,wL=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,kL="|";function SL(e,t={}){return e.split(kL).map(r=>{let n=r.trim().split(wL).filter(s=>s&&!!s.trim()),a=[];for(let s=0,i=n.length;s<i;s+=1){const o=n[s];let l=!1,c=-1;for(;!l&&++c<Av;){const d=$h[c];let f=d.isMultiMatch(o);f&&(a.push(new d(f,t)),l=!0)}if(!l)for(c=-1;++c<Av;){const d=$h[c];let f=d.isSingleMatch(o);if(f){a.push(new d(f,t));break}}}return a})}const EL=new Set([SE.type,EE.type]);class _L{constructor(t,{isCaseSensitive:r=Fe.isCaseSensitive,ignoreDiacritics:n=Fe.ignoreDiacritics,includeMatches:a=Fe.includeMatches,minMatchCharLength:s=Fe.minMatchCharLength,ignoreLocation:i=Fe.ignoreLocation,findAllMatches:o=Fe.findAllMatches,location:l=Fe.location,threshold:c=Fe.threshold,distance:d=Fe.distance}={}){this.query=null,this.options={isCaseSensitive:r,ignoreDiacritics:n,includeMatches:a,minMatchCharLength:s,findAllMatches:o,ignoreLocation:i,location:l,threshold:c,distance:d},t=r?t:t.toLowerCase(),t=n?y0(t):t,this.pattern=t,this.query=SL(this.pattern,this.options)}static condition(t,r){return r.useExtendedSearch}searchIn(t){const r=this.query;if(!r)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:a,ignoreDiacritics:s}=this.options;t=a?t:t.toLowerCase(),t=s?y0(t):t;let i=0,o=[],l=0;for(let c=0,d=r.length;c<d;c+=1){const f=r[c];o.length=0,i=0;for(let h=0,p=f.length;h<p;h+=1){const x=f[h],{isMatch:m,indices:v,score:g}=x.search(t);if(m){if(i+=1,l+=g,n){const y=x.constructor.type;EL.has(y)?o=[...o,...v]:o.push(v)}}else{l=0,i=0,o.length=0;break}}if(i){let h={isMatch:!0,score:l/i};return n&&(h.indices=o),h}}return{isMatch:!1,score:1}}}const zh=[];function bL(...e){zh.push(...e)}function Vh(e,t){for(let r=0,n=zh.length;r<n;r+=1){let a=zh[r];if(a.condition(e,t))return new a(e,t)}return new kE(e,t)}const w0={AND:"$and",OR:"$or"},Hh={PATH:"$path",PATTERN:"$val"},Wh=e=>!!(e[w0.AND]||e[w0.OR]),TL=e=>!!e[Hh.PATH],CL=e=>!ma(e)&&gE(e)&&!Wh(e),Fv=e=>({[w0.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function _E(e,t,{auto:r=!0}={}){const n=a=>{let s=Object.keys(a);const i=TL(a);if(!i&&s.length>1&&!Wh(a))return n(Fv(a));if(CL(a)){const l=i?a[Hh.PATH]:s[0],c=i?a[Hh.PATTERN]:a[l];if(!Ln(c))throw new Error(JM(l));const d={keyId:Uh(l),pattern:c};return r&&(d.searcher=Vh(c,t)),d}let o={children:[],operator:s[0]};return s.forEach(l=>{const c=a[l];ma(c)&&c.forEach(d=>{o.children.push(n(d))})}),o};return Wh(e)||(e=Fv(e)),n(e)}function NL(e,{ignoreFieldNorm:t=Fe.ignoreFieldNorm}){e.forEach(r=>{let n=1;r.matches.forEach(({key:a,norm:s,score:i})=>{const o=a?a.weight:null;n*=Math.pow(i===0&&o?Number.EPSILON:i,(o||1)*(t?1:s))}),r.score=n})}function AL(e,t){const r=e.matches;t.matches=[],Mr(r)&&r.forEach(n=>{if(!Mr(n.indices)||!n.indices.length)return;const{indices:a,value:s}=n;let i={indices:a,value:s};n.key&&(i.key=n.key.src),n.idx>-1&&(i.refIndex=n.idx),t.matches.push(i)})}function FL(e,t){t.score=e.score}function PL(e,t,{includeMatches:r=Fe.includeMatches,includeScore:n=Fe.includeScore}={}){const a=[];return r&&a.push(AL),n&&a.push(FL),e.map(s=>{const{idx:i}=s,o={item:t[i],refIndex:i};return a.length&&a.forEach(l=>{l(s,o)}),o})}class ko{constructor(t,r={},n){this.options={...Fe,...r},this.options.useExtendedSearch,this._keyStore=new rL(this.options.keys),this.setCollection(t,n)}setCollection(t,r){if(this._docs=t,r&&!(r instanceof Hp))throw new Error(QM);this._myIndex=r||wE(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){Mr(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const r=[];for(let n=0,a=this._docs.length;n<a;n+=1){const s=this._docs[n];t(s,n)&&(this.removeAt(n),n-=1,a-=1,r.push(s))}return r}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:r=-1}={}){const{includeMatches:n,includeScore:a,shouldSort:s,sortFn:i,ignoreFieldNorm:o}=this.options;let l=Ln(t)?Ln(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return NL(l,{ignoreFieldNorm:o}),s&&l.sort(i),xE(r)&&r>-1&&(l=l.slice(0,r)),PL(l,this._docs,{includeMatches:n,includeScore:a})}_searchStringList(t){const r=Vh(t,this.options),{records:n}=this._myIndex,a=[];return n.forEach(({v:s,i,n:o})=>{if(!Mr(s))return;const{isMatch:l,score:c,indices:d}=r.searchIn(s);l&&a.push({item:s,idx:i,matches:[{score:c,value:s,norm:o,indices:d}]})}),a}_searchLogical(t){const r=_E(t,this.options),n=(o,l,c)=>{if(!o.children){const{keyId:f,searcher:h}=o,p=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(l,f),searcher:h});return p&&p.length?[{idx:c,item:l,matches:p}]:[]}const d=[];for(let f=0,h=o.children.length;f<h;f+=1){const p=o.children[f],x=n(p,l,c);if(x.length)d.push(...x);else if(o.operator===w0.AND)return[]}return d},a=this._myIndex.records,s={},i=[];return a.forEach(({$:o,i:l})=>{if(Mr(o)){let c=n(r,o,l);c.length&&(s[l]||(s[l]={idx:l,item:o,matches:[]},i.push(s[l])),c.forEach(({matches:d})=>{s[l].matches.push(...d)}))}}),i}_searchObjectList(t){const r=Vh(t,this.options),{keys:n,records:a}=this._myIndex,s=[];return a.forEach(({$:i,i:o})=>{if(!Mr(i))return;let l=[];n.forEach((c,d)=>{l.push(...this._findMatches({key:c,value:i[d],searcher:r}))}),l.length&&s.push({idx:o,item:i,matches:l})}),s}_findMatches({key:t,value:r,searcher:n}){if(!Mr(r))return[];let a=[];if(ma(r))r.forEach(({v:s,i,n:o})=>{if(!Mr(s))return;const{isMatch:l,score:c,indices:d}=n.searchIn(s);l&&a.push({score:c,key:t,value:s,idx:i,norm:o,indices:d})});else{const{v:s,n:i}=r,{isMatch:o,score:l,indices:c}=n.searchIn(s);o&&a.push({score:l,key:t,value:s,norm:i,indices:c})}return a}}ko.version="7.1.0";ko.createIndex=wE;ko.parseIndex=uL;ko.config=Fe;ko.parseQuery=_E;bL(_L);class RL{constructor(){at(this,"fuseInstance",null);this.initializeFuse()}initializeFuse(){const t={keys:[{name:"name",weight:.3},{name:"firstName",weight:.25},{name:"lastName",weight:.25},{name:"phone",weight:.2},{name:"tcNumber",weight:.15},{name:"email",weight:.1},{name:"tags",weight:.05}],threshold:.3,includeScore:!0,includeMatches:!0,minMatchCharLength:2};this.fuseInstance=new ko([],t)}updateSearchIndex(t){this.fuseInstance&&this.fuseInstance.setCollection(t)}searchPatients(t,r={}){let n=[...t];if(r.search&&r.search.trim())if(this.fuseInstance)n=this.fuseInstance.search(r.search.trim()).map(d=>d.item);else{const c=r.search.toLowerCase();n=t.filter(d=>{var f,h,p,x,m,v;return((f=d.name)==null?void 0:f.toLowerCase().includes(c))||((h=d.firstName)==null?void 0:h.toLowerCase().includes(c))||((p=d.lastName)==null?void 0:p.toLowerCase().includes(c))||((x=d.phone)==null?void 0:x.includes(c))||((m=d.tcNumber)==null?void 0:m.includes(c))||((v=d.email)==null?void 0:v.toLowerCase().includes(c))})}n=this.applyFilters(n,r);const a=r.page||1,s=r.limit||50,i=(a-1)*s,o=i+s;return{patients:n.slice(i,o),total:n.length,page:a,pageSize:s,hasMore:o<n.length}}applyFilters(t,r){return t.filter(n=>{if(r.status&&n.status!==r.status||r.segment&&n.segment!==r.segment||r.label&&n.label!==r.label||r.acquisitionType&&n.acquisitionType!==r.acquisitionType||r.tags&&r.tags.length>0&&!r.tags.some(s=>{var i;return(i=n.tags)==null?void 0:i.includes(s)}))return!1;if(r.hasDevices!==void 0){const a=n.devices&&n.devices.length>0;if(r.hasDevices!==a)return!1}if(r.sgkStatus&&n.sgkStatus!==r.sgkStatus)return!1;if(r.priorityScore){const a=n.priorityScore||0;if(r.priorityScore.min!==void 0&&a<r.priorityScore.min||r.priorityScore.max!==void 0&&a>r.priorityScore.max)return!1}if(r.dateRange){const a=new Date(n.createdAt);if(r.dateRange.start){const s=new Date(r.dateRange.start);if(a<s)return!1}if(r.dateRange.end){const s=new Date(r.dateRange.end);if(a>s)return!1}}return!0})}findMatches(t,r){const n=[];for(const a of r){const s=this.calculatePatientMatch(t,a);s.score>.3&&n.push(s)}return n.sort((a,s)=>s.score-a.score)}calculatePatientMatch(t,r){let n=0,a=0;const s=[];if(t.name&&r.name){const l=this.calculateStringSimilarity(t.name,r.name);n+=l*.4,a+=.4,l>.7&&s.push("name")}if(t.tcNo&&r.tcNumber){const l=t.tcNo===r.tcNumber?1:0;n+=l*.3,a+=.3,l>0&&s.push("tcNumber")}if(t.phone&&r.phone){const l=this.calculatePhoneSimilarity(t.phone,r.phone);n+=l*.2,a+=.2,l>.8&&s.push("phone")}if(t.birthDate&&r.birthDate){const l=t.birthDate===r.birthDate?1:0;n+=l*.1,a+=.1,l>0&&s.push("birthDate")}const i=a>0?n/a:0;let o="low";return i>.8?o="high":i>.6&&(o="medium"),{patient:r,score:i,matchedFields:s,confidence:o}}calculateStringSimilarity(t,r){const n=t.toLowerCase().trim(),a=r.toLowerCase().trim();if(n===a)return 1;const s=Math.max(n.length,a.length);return s===0?1:1-this.levenshteinDistance(n,a)/s}calculatePhoneSimilarity(t,r){const n=i=>i.replace(/[\s\-\(\)]/g,""),a=n(t),s=n(r);return a===s?1:a.includes(s)||s.includes(a)?.9:this.calculateStringSimilarity(a,s)}levenshteinDistance(t,r){const n=Array(r.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let a=0;a<=t.length;a++)n[0][a]=a;for(let a=0;a<=r.length;a++)n[a][0]=a;for(let a=1;a<=r.length;a++)for(let s=1;s<=t.length;s++){const i=t[s-1]===r[a-1]?0:1;n[a][s]=Math.min(n[a][s-1]+1,n[a-1][s]+1,n[a-1][s-1]+i)}return n[r.length][t.length]}}const DL=new RL;class jL{constructor(){at(this,"CACHE_PREFIX","patient_cache_");at(this,"METADATA_KEY","patient_cache_metadata");at(this,"DEFAULT_TTL",24*60*60*1e3);at(this,"MAX_CACHE_SIZE",1e4)}async cachePatients(t,r={}){try{await Ze.savePatients(t),await this.updateCacheMetadata(t.length);const n=r.ttl||this.DEFAULT_TTL,a=t.map(s=>Ze.setCache(`${this.CACHE_PREFIX}${s.id}`,s,n));await Promise.all(a)}catch(n){throw console.error("Failed to cache patients:",n),n}}async getCachedPatient(t){try{const r=await Ze.getPatient(t);return r||await Ze.getCache(`${this.CACHE_PREFIX}${t}`)}catch(r){return console.error(`Failed to get cached patient ${t}:`,r),null}}async getCachedPatients(){try{return await Ze.getPatients()}catch(t){return console.error("Failed to get cached patients:",t),[]}}async searchCachedPatients(t){try{let n=[...await this.getCachedPatients()];if(t.search){const c=t.search.toLowerCase();n=n.filter(d=>{var f,h,p,x,m,v;return((f=d.name)==null?void 0:f.toLowerCase().includes(c))||((h=d.firstName)==null?void 0:h.toLowerCase().includes(c))||((p=d.lastName)==null?void 0:p.toLowerCase().includes(c))||((x=d.phone)==null?void 0:x.includes(c))||((m=d.tcNumber)==null?void 0:m.includes(c))||((v=d.email)==null?void 0:v.toLowerCase().includes(c))})}t.status&&t.status.length>0&&(n=n.filter(c=>t.status.includes(c.status))),t.segment&&t.segment.length>0&&(n=n.filter(c=>t.segment.includes(c.segment))),t.label&&t.label.length>0&&(n=n.filter(c=>t.label.includes(c.label))),t.acquisitionType&&t.acquisitionType.length>0&&(n=n.filter(c=>t.acquisitionType.includes(c.acquisitionType))),t.tags&&t.tags.length>0&&(n=n.filter(c=>{var d;return(d=c.tags)==null?void 0:d.some(f=>t.tags.includes(f))})),t.hasDevices!==void 0&&(n=n.filter(c=>t.hasDevices?c.devices&&c.devices.length>0:!c.devices||c.devices.length===0));const a=t.page||1,s=t.limit||50,i=(a-1)*s;return{patients:n.slice(i,i+s).map(c=>{var d;return{id:c.id,firstName:c.firstName||"",lastName:c.lastName||"",tcNumber:c.tcNumber,phone:c.phone,email:c.email,status:c.status,segment:c.segment,labels:c.label?[c.label]:[],registrationDate:c.createdAt,lastVisitDate:c.updatedAt,deviceCount:((d=c.devices)==null?void 0:d.length)||0,hasInsurance:!!c.sgkInfo,outstandingBalance:0,priority:0}}),totalCount:n.length,filteredCount:n.length}}catch(r){return console.error("Failed to search cached patients:",r),{patients:[],totalCount:0,filteredCount:0}}}async updateCachedPatient(t){try{await Ze.updatePatient(t),await Ze.setCache(`${this.CACHE_PREFIX}${t.id}`,t)}catch(r){throw console.error(`Failed to update cached patient ${t.id}:`,r),r}}async removeCachedPatient(t){try{await Ze.deletePatient(t),await Ze.deleteCache(`${this.CACHE_PREFIX}${t}`)}catch(r){throw console.error(`Failed to remove cached patient ${t}:`,r),r}}async getCacheStats(){try{const t=await this.getCachedPatients(),r=await Ze.getCache(this.METADATA_KEY),n={totalPatients:t.length,lastUpdated:(r==null?void 0:r.lastUpdated)||null,cacheSize:this.calculateCacheSize(t),oldestEntry:null,newestEntry:null};if(t.length>0){const a=[...t].sort((s,i)=>new Date(s.createdAt).getTime()-new Date(i.createdAt).getTime());n.oldestEntry=a[0].createdAt,n.newestEntry=a[a.length-1].createdAt}return n}catch(t){return console.error("Failed to get cache stats:",t),{totalPatients:0,lastUpdated:null,cacheSize:0,oldestEntry:null,newestEntry:null}}}async clearCache(){try{const r=(await this.getCachedPatients()).map(n=>this.removeCachedPatient(n.id));await Promise.all(r),await Ze.deleteCache(this.METADATA_KEY)}catch(t){throw console.error("Failed to clear cache:",t),t}}async optimizeCache(){try{const t=await this.getCachedPatients();if(t.length>this.MAX_CACHE_SIZE){const a=[...t].sort((s,i)=>new Date(s.updatedAt).getTime()-new Date(i.updatedAt).getTime()).slice(0,t.length-this.MAX_CACHE_SIZE).map(s=>this.removeCachedPatient(s.id));await Promise.all(a)}}catch(t){console.error("Failed to optimize cache:",t)}}async isPatientCached(t){try{return await this.getCachedPatient(t)!==null}catch(r){return console.error(`Failed to check if patient ${t} is cached:`,r),!1}}async preloadPatients(t){console.log("Preloading patients:",t)}async updateCacheMetadata(t){try{const r={lastUpdated:new Date().toISOString(),patientCount:t,version:"1.0.0"};await Ze.setCache(this.METADATA_KEY,r)}catch(r){console.error("Failed to update cache metadata:",r)}}calculateCacheSize(t){const r=JSON.stringify(t);return new Blob([r]).size}getNestedValue(t,r){return r.split(".").reduce((n,a)=>n==null?void 0:n[a],t)}}const er=new jL;class IL{validatePatient(t,r=[]){const n=[],a=[];return this.validateRequiredFields(t,n),this.validateFormats(t,n,a),this.validateBusinessRules(t,n,a),this.validateUniqueness(t,r,n),{isValid:n.filter(s=>s.severity==="error").length===0,errors:n,warnings:a}}validateTcNumber(t,r,n=[]){return!t||t.length!==11||!/^\d{11}$/.test(t)||!this.isValidTcNumberAlgorithm(t)?!1:!n.find(s=>s.tcNumber===t&&s.id!==r)}validatePhone(t){if(!t)return!1;const r=t.replace(/\D/g,"");return r.length===10?/^[235]\d{9}$/.test(r):r.length===11?/^0[235]\d{9}$/.test(r):r.length===12?/^90[235]\d{9}$/.test(r):r.length===13?/^0090[235]\d{9}$/.test(r):!1}validateEmail(t){return t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t):!0}validateBirthDate(t){if(!t)return!0;const r=new Date(t),n=new Date;if(isNaN(r.getTime())||r>=n)return!1;const a=new Date;return a.setFullYear(a.getFullYear()-120),r>=a}validateRequiredFields(t,r){(!t.phone||!t.phone.trim())&&r.push({field:"phone",code:"REQUIRED",message:"Telefon numaras zorunludur",severity:"error"}),!t.name&&(!t.firstName||!t.lastName)&&r.push({field:"name",code:"REQUIRED",message:"Hasta ad zorunludur",severity:"error"})}validateFormats(t,r,n){t.phone&&!this.validatePhone(t.phone)&&r.push({field:"phone",code:"INVALID_FORMAT",message:"Geersiz telefon numaras format",severity:"error"}),t.tcNumber&&!this.isValidTcNumberAlgorithm(t.tcNumber)&&r.push({field:"tcNumber",code:"INVALID_FORMAT",message:"Geersiz TC Kimlik Numaras",severity:"error"}),t.email&&!this.validateEmail(t.email)&&r.push({field:"email",code:"INVALID_FORMAT",message:"Geersiz e-posta adresi format",severity:"error"}),t.birthDate&&!this.validateBirthDate(t.birthDate)&&r.push({field:"birthDate",code:"INVALID_DATE",message:"Geersiz doum tarihi",severity:"error"})}validateBusinessRules(t,r,n){if(t.birthDate){const a=this.calculateAge(t.birthDate);a<18&&n.push({field:"birthDate",code:"MINOR_PATIENT",message:"Hasta 18 yandan kk",suggestion:"Veli bilgilerini eklemeyi unutmayn"}),a>90&&n.push({field:"birthDate",code:"ELDERLY_PATIENT",message:"Hasta 90 yandan byk",suggestion:"Ya bilgisini kontrol edin"})}t.status==="archived"&&t.segment!=="renewal"&&n.push({field:"status",code:"STATUS_SEGMENT_MISMATCH",message:"Arivlenmi hasta iin segment uyumsuzluu",suggestion:"Segment bilgisini kontrol edin"}),t.deviceTrial&&!t.trialDate&&n.push({field:"trialDate",code:"MISSING_TRIAL_DATE",message:"Deneme cihaz var ama deneme tarihi eksik",suggestion:"Deneme tarihini ekleyin"}),t.purchased&&!t.purchaseDate&&n.push({field:"purchaseDate",code:"MISSING_PURCHASE_DATE",message:"Satn alm var ama satn alma tarihi eksik",suggestion:"Satn alma tarihini ekleyin"})}validateUniqueness(t,r,n){if(t.tcNumber){const a=r.find(s=>s.tcNumber===t.tcNumber&&s.id!==t.id);a&&n.push({field:"tcNumber",code:"DUPLICATE",message:`Bu TC Kimlik Numaras baka bir hasta tarafndan kullanlyor: ${a.name}`,severity:"error"})}if(t.phone){const a=r.find(s=>s.phone===t.phone&&s.id!==t.id);a&&n.push({field:"phone",code:"DUPLICATE_WARNING",message:`Bu telefon numaras baka bir hasta tarafndan kullanlyor: ${a.name}`,severity:"warning"})}}isValidTcNumberAlgorithm(t){if(!t||t.length!==11)return!1;const r=t.split("").map(Number);if(r[0]===0)return!1;const n=r[0]+r[2]+r[4]+r[6]+r[8],a=r[1]+r[3]+r[5]+r[7],s=(n*7-a)%10,i=(n+a+r[9])%10;return r[9]===s&&r[10]===i}calculateAge(t){const r=new Date(t),n=new Date;let a=n.getFullYear()-r.getFullYear();const s=n.getMonth()-r.getMonth();return(s<0||s===0&&n.getDate()<r.getDate())&&a--,a}}const Kh=new IL;class OL{constructor(){at(this,"SYNC_KEY","patient_last_sync");at(this,"BATCH_SIZE",50);at(this,"syncInProgress",!1)}async syncPatients(t={}){if(this.syncInProgress)throw new Error("Sync already in progress");this.syncInProgress=!0;try{const r=await this.performSync(t);return await this.updateLastSyncTime(),r}finally{this.syncInProgress=!1}}async syncSinglePatient(t,r={}){try{if(!await Ze.getPatient(t))throw new Error(`Patient ${t} not found locally`);return(await pr.getPendingOperations()).filter(i=>i.endpoint.includes(`/patients/${t}`)||i.data&&typeof i.data=="object"&&"id"in i.data&&i.data.id===t).length>0&&!r.force&&await this.pushPendingChanges([t]),await this.pullPatientFromServer(t),!0}catch(n){return console.error(`Failed to sync patient ${t}:`,n),!1}}async getLastSyncTime(){try{const t=await Ze.getCache(this.SYNC_KEY);return typeof t=="string"?t:null}catch(t){return console.error("Failed to get last sync time:",t),null}}async getPendingSyncCount(){try{return(await pr.getPendingOperations()).filter(r=>r.endpoint.includes("/patients")).length}catch(t){return console.error("Failed to get pending sync count:",t),0}}async hasPendingChanges(t){try{const r=await pr.getPendingOperations();return t?r.some(n=>n.endpoint.includes(`/patients/${t}`)||n.data&&typeof n.data=="object"&&"id"in n.data&&n.data.id===t):r.some(n=>n.endpoint.includes("/patients"))}catch(r){return console.error("Failed to check pending changes:",r),!1}}async resolveConflict(t,r){switch(r){case"local":return await this.pushPatientToServer(t.localVersion),t.localVersion;case"remote":return await Ze.updatePatient(t.remoteVersion),t.remoteVersion;case"merge":const n=this.mergePatients(t.localVersion,t.remoteVersion);return await Ze.updatePatient(n),await this.pushPatientToServer(n),n;default:throw new Error(`Invalid conflict resolution: ${r}`)}}async performSync(t){const r={success:!1,synced:0,failed:0,conflicts:[],lastSyncTime:new Date().toISOString()};try{const n=await this.pushPendingChanges(),a=await this.pullRemoteChanges(t);return r.synced=(n.synced||0)+(a.synced||0),r.failed=(n.failed||0)+(a.failed||0),r.conflicts=[...n.conflicts||[],...a.conflicts||[]],r.success=r.failed===0&&r.conflicts.length===0,r}catch(n){return console.error("Sync failed:",n),r.success=!1,r}}async pushPendingChanges(t){const r={synced:0,failed:0,conflicts:[]};try{const a=(await pr.getPendingOperations()).filter(s=>t?t.some(i=>s.endpoint.includes(`/patients/${i}`)||s.data&&typeof s.data=="object"&&"id"in s.data&&s.data.id===i):s.endpoint.includes("/patients"));for(const s of a)try{await this.processPendingOperation(s),r.synced++}catch(i){console.error(`Failed to process operation ${s.id}:`,i),r.failed++}}catch(n){console.error("Failed to push pending changes:",n)}return r}async pullRemoteChanges(t){var n;const r={synced:0,failed:0,conflicts:[]};try{const a=t.since||await this.getLastSyncTime(),s=t.batchSize||this.BATCH_SIZE,i=await pE({});if((n=i.data)!=null&&n.data)for(const o of i.data.data)try{const l=await this.syncRemotePatient(o,t);l.conflict?r.conflicts.push(l.conflict):r.synced++}catch(l){console.error(`Failed to sync patient ${o.id}:`,l),r.failed++}}catch(a){console.error("Failed to pull remote changes:",a)}return r}async syncRemotePatient(t,r){const n=await Ze.getPatient(t.id);if(!n)return await Ze.updatePatient(t),{};const a=await this.hasPendingChanges(t.id),s=new Date(n.updatedAt)>new Date(t.updatedAt);if(a||s){const i={patientId:t.id,localVersion:n,remoteVersion:t,conflictType:"update"};return r.conflictResolution&&r.conflictResolution!=="prompt"?(await this.resolveConflict(i,r.conflictResolution),{}):{conflict:i}}return await Ze.updatePatient(t),{}}async processPendingOperation(t){console.log("Processing pending operation:",t.id,t.method,t.endpoint)}async pushPatientToServer(t){await pr.addOperation({method:"PUT",endpoint:`/api/patients/${t.id}`,data:t,headers:{"Idempotency-Key":`update-patient-${t.id}-${Date.now()}`}})}async pullPatientFromServer(t){console.log("Pulling patient from server:",t)}mergePatients(t,r){const n=new Date(t.updatedAt).getTime(),a=new Date(r.updatedAt).getTime();return n>a?{...r,...t,updatedAt:new Date().toISOString()}:{...t,...r,updatedAt:new Date().toISOString()}}async updateLastSyncTime(){try{await Ze.setCache(this.SYNC_KEY,new Date().toISOString())}catch(t){console.error("Failed to update last sync time:",t)}}}const xl=new OL,ML=(e={})=>{const{enableRealTimeSync:t=!0,cacheEnabled:r=!0,autoRefresh:n=!1,refreshInterval:a=3e4}=e,[s,i]=V.useState([]),[o,l]=V.useState(null),[c,d]=V.useState(!0),[f,h]=V.useState(!1),[p,x]=V.useState(!1),[m,v]=V.useState(null),[g,y]=V.useState({});V.useEffect(()=>{(async()=>{try{if(d(!0),v(null),r){const Q=await er.getCachedPatients();Q.length>0&&(i(Q),d(!1))}const q=await Mt.getPatients();i(q.patients)}catch(q){console.error("Failed to initialize patients:",q),v(q instanceof Error?q.message:"Failed to load patients")}finally{d(!1)}})()},[r]),V.useEffect(()=>{if(!n)return;const B=setInterval(async()=>{try{const q=await Mt.getPatients();i(q.patients)}catch(q){console.error("Auto refresh failed:",q)}},a);return()=>clearInterval(B)},[n,a]),V.useEffect(()=>{if(!t)return;const B=q=>{var Q;(Q=q.key)!=null&&Q.startsWith("patient_")&&Mt.getPatients().then(J=>{i(J.patients)})};return window.addEventListener("storage",B),()=>window.removeEventListener("storage",B)},[t]);const w=V.useCallback(async B=>{try{h(!0),v(null),y(B);let q;if(r&&!B.search)q=await er.searchCachedPatients(B);else{const Q={search:B.search,status:B.status,segment:B.segment,labels:B.label?[B.label[0]]:void 0,hasDevice:B.hasDevices,page:B.page,limit:B.limit};q=await DL.searchPatients(s,Q)}l(q)}catch(q){console.error("Search failed:",q),v(q instanceof Error?q.message:"Search failed")}finally{h(!1)}},[s,r]),S=V.useCallback(()=>{l(null),y({})},[]),A=V.useCallback(B=>{y(B),w(B)},[w]),T=V.useCallback(async B=>{try{v(null);const q=Kh.validatePatient(B);if(!q.isValid)throw new Error(`Validation failed: ${q.errors.join(", ")}`);const Q=await Mt.createPatient(B);return i(J=>[...J,Q]),r&&await er.updateCachedPatient(Q),t&&await xl.syncSinglePatient(Q.id),Q}catch(q){throw console.error("Failed to create patient:",q),v(q instanceof Error?q.message:"Failed to create patient"),q}},[r,t]),b=V.useCallback(async(B,q)=>{try{if(v(null),!s.find(P=>P.id===B))throw new Error("Patient not found");const J=await Mt.updatePatient(B,q);if(!J)throw new Error("Failed to update patient");return i(P=>P.map(Z=>Z.id===B?J:Z)),r&&await er.updateCachedPatient(J),t&&await xl.syncSinglePatient(B),J}catch(Q){throw console.error("Failed to update patient:",Q),v(Q instanceof Error?Q.message:"Failed to update patient"),Q}},[s,r,t]),k=V.useCallback(async B=>{try{if(v(null),!await Mt.deletePatient(B))throw new Error("Failed to delete patient");i(Q=>Q.filter(J=>J.id!==B)),r&&await er.removeCachedPatient(B),t&&console.log("Marking patient for deletion:",B)}catch(q){throw console.error("Failed to delete patient:",q),v(q instanceof Error?q.message:"Failed to delete patient"),q}},[r,t]),E=V.useCallback(async()=>{try{d(!0),v(null);const B=await Mt.getPatients();i(B.patients),Object.keys(g).length>0&&await w(g)}catch(B){console.error("Failed to refresh patients:",B),v(B instanceof Error?B.message:"Failed to refresh patients")}finally{d(!1)}},[g,w]),_=V.useCallback(async()=>{try{x(!0),v(null);const B=await xl.syncPatients();B.conflicts.length>0&&console.warn("Sync conflicts detected:",B.conflicts),await E()}catch(B){console.error("Failed to sync patients:",B),v(B instanceof Error?B.message:"Failed to sync patients")}finally{x(!1)}},[E]),C=V.useCallback(async()=>{try{r&&(await er.clearCache(),await E())}catch(B){console.error("Failed to clear cache:",B),v(B instanceof Error?B.message:"Failed to clear cache")}},[r,E]),F=V.useCallback(B=>s.find(q=>q.id===B),[s]),D=V.useCallback(B=>{const q=Kh.validatePatient(B);return{isValid:q.isValid,errors:q.errors.map(Q=>Q.message)}},[]),M=V.useMemo(()=>o?o.totalCount:s.length,[o,s.length]);return{patients:s,searchResults:o,totalCount:M,isLoading:c,isSearching:f,isSyncing:p,error:m,searchPatients:w,clearSearch:S,applyFilters:A,createPatient:T,updatePatient:b,deletePatient:k,refreshPatients:E,syncPatients:_,clearCache:C,getPatientById:F,validatePatient:D}};function LL(){var _,C,F;const e=mo();fc({strict:!1});const[t,r]=V.useState({search:"",status:[],segment:[],label:[],hasDevices:void 0,page:1,limit:20}),[n,a]=V.useState(!1);V.useState([]);const[s,i]=V.useState(!1),{patients:o,searchResults:l,isLoading:c,isSyncing:d,error:f,searchPatients:h,refreshPatients:p,syncPatients:x}=ML({enableRealTimeSync:!0,cacheEnabled:!0,autoRefresh:!0,refreshInterval:6e4});V.useEffect(()=>{h(t)},[]);const m=(l==null?void 0:l.totalCount)||0,v=(l==null?void 0:l.patients)||[],g=[{value:"",label:"Tm Durumlar"},{value:"active",label:"Aktif"},{value:"inactive",label:"Pasif"},{value:"archived",label:"Arivlenmi"}],y=[{value:"",label:"Tm Segmentler"},{value:"new",label:"Yeni"},{value:"trial",label:"Deneme"},{value:"purchased",label:"Satn Alm"},{value:"control",label:"Kontrol"},{value:"renewal",label:"Yenileme"}],w=[{value:"",label:"Tm Etiketler"},{value:"yeni",label:"Yeni"},{value:"arama-bekliyor",label:"Arama Bekliyor"},{value:"randevu-verildi",label:"Randevu Verildi"},{value:"deneme-yapildi",label:"Deneme Yapld"},{value:"kontrol-hastasi",label:"Kontrol Hastas"},{value:"satis-tamamlandi",label:"Sat Tamamland"}],S=D=>{const M={...t,search:D,page:1};r(M),h(M)},A=(D,M)=>{const B={...t,[D]:M,page:1};r(B),h(B)},T=D=>{e({to:`/patients/${D.id}`})},b=async()=>{await p()},k=async()=>{await x()},E=[{key:"name",title:"Ad Soyad",render:D=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(Us,{className:"w-4 h-4 text-blue-600"})})}),u.jsxs("div",{children:[u.jsxs("div",{className:"font-medium text-gray-900",children:[D.firstName," ",D.lastName]}),u.jsx("div",{className:"text-sm text-gray-500",children:D.phone})]})]})},{key:"status",title:"Durum",render:D=>{const M={active:{color:"green",icon:H0,label:"Aktif"},inactive:{color:"gray",icon:Us,label:"Pasif"},archived:{color:"red",icon:Us,label:"Ariv"}},B=M[D.status]||M.active,q=B.icon;return u.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-${B.color}-100 text-${B.color}-800`,children:[u.jsx(q,{className:"w-3 h-3 mr-1"}),B.label]})}},{key:"segment",title:"Segment",render:D=>{const M={new:{color:"blue",label:"Yeni"},trial:{color:"yellow",label:"Deneme"},purchased:{color:"green",label:"Satn Alm"},control:{color:"purple",label:"Kontrol"},renewal:{color:"orange",label:"Yenileme"}},B=M[D.segment]||M.new;return u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-${B.color}-100 text-${B.color}-800`,children:B.label})}},{key:"labels",title:"Etiket",render:D=>{var M,B;return u.jsx("span",{className:"text-sm text-gray-600 capitalize",children:((B=(M=D.labels)==null?void 0:M[0])==null?void 0:B.replace("-"," "))||"-"})}},{key:"priority",title:"ncelik",render:D=>{const M=D.priority||0,B=M>=80?"red":M>=60?"yellow":"green";return u.jsxs("div",{className:"flex items-center",children:[u.jsx(nA,{className:`w-4 h-4 mr-1 text-${B}-500`}),u.jsx("span",{className:"text-sm font-medium",children:M})]})}},{key:"deviceCount",title:"Cihaz",render:D=>{const M=D.deviceCount>0;return u.jsxs("div",{className:"flex items-center",children:[u.jsx(Ww,{className:`w-4 h-4 ${M?"text-green-500":"text-gray-400"}`}),u.jsx("span",{className:"ml-1 text-sm",children:M?D.deviceCount:"Yok"})]})}},{key:"registrationDate",title:"Kayt Tarihi",render:D=>u.jsx("span",{className:"text-sm text-gray-600",children:new Date(D.registrationDate).toLocaleDateString("tr-TR")})}];return u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Hastalar"}),u.jsxs("p",{className:"text-gray-600",children:["Toplam ",m," hastadan ",v.length," tanesi gsteriliyor"]})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsxs(Te,{variant:"outline",size:"sm",onClick:b,disabled:c,className:"flex items-center space-x-2",children:[u.jsx(Ll,{className:`w-4 h-4 ${c?"animate-spin":""}`}),u.jsx("span",{children:"Yenile"})]}),u.jsxs(Te,{variant:"outline",size:"sm",onClick:k,disabled:d,className:"flex items-center space-x-2",children:[u.jsx(Ll,{className:`w-4 h-4 ${d?"animate-spin":""}`}),u.jsx("span",{children:"Sync"})]}),u.jsxs(Te,{variant:n?"primary":"outline",size:"sm",onClick:()=>a(!n),className:"flex items-center space-x-2",children:[u.jsx(Hw,{className:"w-4 h-4"}),u.jsx("span",{children:"Filtreler"})]}),u.jsxs(Te,{onClick:()=>i(!0),className:"flex items-center space-x-2",children:[u.jsx(cp,{className:"w-4 h-4"}),u.jsx("span",{children:"Yeni Hasta"})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-center space-x-4",children:u.jsx("div",{className:"flex-1",children:u.jsx(Ie,{placeholder:"Hasta ad, telefon, TC kimlik no ile arama yapn...",value:t.search||"",onChange:D=>S(D.target.value),className:"w-full",leftIcon:u.jsx(Yw,{className:"w-4 h-4"})})})}),n&&u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[u.jsx(Tt,{placeholder:"Durum",value:((_=t.status)==null?void 0:_[0])||"",onChange:D=>A("status",D?[D]:[]),options:g}),u.jsx(Tt,{placeholder:"Segment",value:((C=t.segment)==null?void 0:C[0])||"",onChange:D=>A("segment",D?[D]:[]),options:y}),u.jsx(Tt,{placeholder:"Etiket",value:((F=t.label)==null?void 0:F[0])||"",onChange:D=>A("label",D?[D]:[]),options:w}),u.jsx(Tt,{placeholder:"Cihaz Durumu",value:t.hasDevices===!0?"true":t.hasDevices===!1?"false":"",onChange:D=>A("hasDevices",D.target.value==="true"?!0:D.target.value==="false"?!1:void 0),options:[{value:"",label:"Tm"},{value:"true",label:"Cihaz Var"},{value:"false",label:"Cihaz Yok"}]})]})})]}),u.jsx("div",{className:"bg-white rounded-lg shadow",children:u.jsx(Mw,{data:v,columns:E,loading:c,pagination:{current:t.page||1,pageSize:t.limit||20,total:m,onChange:(D,M)=>{const B={...t,page:D,limit:M};r(B),h(B)}},emptyText:"Hasta bulunamad",actions:[{key:"view",label:"Grntle",onClick:T,variant:"primary"}]})}),s&&u.jsx(il,{isOpen:s,onClose:()=>i(!1),title:"Yeni Hasta Ekle",size:"lg",children:u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"text-center text-gray-500",children:"PatientForm component will be implemented here"})})}),u.jsx(V0,{})]})}const BL=zr("/patients")({component:LL}),UL=zr("/invoices")({component:$L});function $L(){return u.jsx(V0,{})}const zL=zr("/inventory")({component:VL});function VL(){return u.jsx(VN,{})}const HL=zr("/appointments")({component:WL});function WL(){return u.jsxs("div",{className:"p-2",children:[u.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Randevular"}),u.jsx("div",{className:"border rounded-lg p-4",children:u.jsx("p",{children:"Randevu takvimi burada grntlenecek..."})})]})}const KL=({stats:e,onCardClick:t})=>u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[u.jsx(Ba,{title:"Toplam Hasta",value:e.totalPatients.toString(),icon:u.jsx(Us,{className:"w-6 h-6"}),color:"blue",trend:{value:"+12%",direction:"up"},onClick:()=>t==null?void 0:t("patients")}),u.jsx(Ba,{title:"Aktif Denemeler",value:e.activeTrials.toString(),icon:u.jsx(Bw,{className:"w-6 h-6"}),color:"green",trend:{value:"+5%",direction:"up"},onClick:()=>t==null?void 0:t("trials")}),u.jsx(Ba,{title:"Aylk Ciro",value:`${e.monthlyRevenue.toLocaleString()}`,icon:u.jsx(Qw,{className:"w-6 h-6"}),color:"purple",trend:{value:"+8%",direction:"up"},onClick:()=>t==null?void 0:t("revenue")}),u.jsx(Ba,{title:"Bugnk Randevular",value:e.todayAppointments.toString(),icon:u.jsx(hc,{className:"w-6 h-6"}),color:"yellow",trend:{value:"3 bekleyen",direction:"neutral"},onClick:()=>t==null?void 0:t("appointments")})]}),GL=({stats:e})=>{const t=a=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),r=[{label:"Aktif Hastalar",value:e.activePatients,icon:Us,color:"blue"},{label:"Gnlk Ciro",value:t(e.dailyRevenue),icon:op,color:"green"},{label:"Bekleyen Randevular",value:e.pendingAppointments,icon:hc,color:"orange"},{label:"Biten Denemeler",value:e.endingTrials,icon:W0,color:"yellow"}],n=a=>({blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",orange:"bg-orange-100 text-orange-600",yellow:"bg-yellow-100 text-yellow-600"})[a]||"bg-gray-100 text-gray-600";return u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Hzl statistikler"}),u.jsx("div",{className:"space-y-4",children:r.map((a,s)=>{const i=a.icon;return u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:`p-2 rounded-full ${n(a.color)}`,children:u.jsx(i,{className:"w-4 h-4"})}),u.jsx("span",{className:"text-sm text-gray-600",children:a.label})]}),u.jsx("span",{className:`text-lg font-semibold ${a.color==="green"?"text-green-600":a.color==="orange"?"text-orange-600":a.color==="yellow"?"text-yellow-600":"text-gray-900"}`,children:a.value})]},s)})})]})},YL=({lastTransaction:e,onClick:t})=>u.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg p-8 cursor-pointer hover:shadow-xl transition-all duration-300 transform hover:scale-105",onClick:t,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"p-4 bg-green-100 rounded-full",children:u.jsx(Jw,{className:"w-8 h-8 text-green-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xl font-bold text-gray-900",children:"Kasa Kayd"}),u.jsx("p",{className:"text-lg text-green-700 font-medium",children:"Hzl Giri"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Gelir ve gider ilemlerinizi kolayca kaydedin"})]})]})}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Son ilem"}),u.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(e==null?void 0:e.amount)||"-"}),u.jsx("p",{className:"text-xs text-gray-500",children:(e==null?void 0:e.date)||"-"})]}),u.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm",children:u.jsx(cp,{className:"w-6 h-6 text-green-600"})})]})]})}),XL=({lastCalculation:e,onClick:t})=>u.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-8 cursor-pointer hover:shadow-xl transition-all duration-300 transform hover:scale-105",onClick:t,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"p-4 bg-blue-100 rounded-full",children:u.jsx($w,{className:"w-8 h-8 text-blue-600"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xl font-bold text-gray-900",children:"Fiyat Hesapla"}),u.jsx("p",{className:"text-lg text-blue-700 font-medium",children:"SGK Destei"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Cihaz fiyatlarn SGK destekleriyle hesaplayn"})]})]})}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Son hesaplama"}),u.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(e==null?void 0:e.amount)||"-"}),u.jsx("p",{className:"text-xs text-gray-500",children:(e==null?void 0:e.date)||"-"})]}),u.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm",children:u.jsx(W0,{className:"w-6 h-6 text-blue-600"})})]})]})}),qL=({isOpen:e,onClose:t,onSubmit:r})=>{const[n,a]=V.useState({type:"income",recordType:"cash",amount:0,description:""}),s=()=>{n.amount>0&&n.description.trim()&&(r(n),t(),a({type:"income",recordType:"cash",amount:0,description:""}))};return u.jsx(il,{isOpen:e,onClose:t,onSave:s,title:"Kasa lemi",size:"md",saveButtonText:"Kaydet",cancelButtonText:"ptal",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"lem Tr"}),u.jsxs("div",{className:"flex space-x-4",children:[u.jsx(Te,{type:"button",onClick:()=>a({...n,type:"income"}),className:`flex-1 py-2 px-4 rounded-lg border ${n.type==="income"?"bg-green-50 border-green-200 text-green-700":"bg-gray-50 border-gray-200 text-gray-700"}`,variant:"default",children:"Gelir"}),u.jsx(Te,{type:"button",onClick:()=>a({...n,type:"expense"}),className:`flex-1 py-2 px-4 rounded-lg border ${n.type==="expense"?"bg-red-50 border-red-200 text-red-700":"bg-gray-50 border-gray-200 text-gray-700"}`,variant:"default",children:"Gider"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kayt Tr"}),u.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"cash",label:"Nakit",icon:op},{value:"card",label:"Kart",icon:zw},{value:"transfer",label:"Havale",icon:vA}].map(({value:i,label:o,icon:l})=>u.jsxs(Te,{type:"button",onClick:()=>a({...n,recordType:i}),className:`flex flex-col items-center py-3 px-2 rounded-lg border ${n.recordType===i?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700"}`,variant:"default",children:[u.jsx(l,{className:"w-5 h-5 mb-1"}),u.jsx("span",{className:"text-sm",children:o})]},i))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hasta (Opsiyonel)"}),u.jsxs("div",{className:"relative",children:[u.jsx(io,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),u.jsxs(Tt,{value:n.patientId||"",onChange:i=>a({...n,patientId:i.target.value||void 0}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[u.jsx("option",{value:"",children:"Hasta sein..."}),u.jsx("option",{value:"1",children:"Ahmet Ylmaz"}),u.jsx("option",{value:"2",children:"Aye Kaya"}),u.jsx("option",{value:"3",children:"Mehmet Demir"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tutar ()"}),u.jsx(Ie,{type:"number",value:n.amount||"",onChange:i=>a({...n,amount:parseFloat(i.target.value)||0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00",min:"0",step:"0.01"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aklama"}),u.jsx(sp,{value:n.description,onChange:i=>a({...n,description:i.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"lem aklamas...",rows:3})]})]})})},QL=({isOpen:e,onClose:t,onCalculate:r})=>{const[n,a]=V.useState(0),[s,i]=V.useState(0),[o,l]=V.useState(0),[c,d]=V.useState(1),[f,h]=V.useState({devicePrice:0,discountPercent:0,discountAmount:0,finalPrice:0}),p=[{name:"Temel Model",price:15e3},{name:"Orta Seviye",price:25e3},{name:"Premium Model",price:45e3},{name:"Lks Model",price:65e3}];V.useEffect(()=>{const y=n-o,w=c>1?y/c:y;h({devicePrice:n,discountPercent:s,discountAmount:o,finalPrice:Math.max(0,y),installments:c>1?c:void 0,installmentAmount:c>1?w:void 0})},[n,s,o,c]);const x=y=>{i(y),l(n*y/100)},m=y=>{l(y),i(n>0?y/n*100:0)},v=y=>{if(y.preventDefault(),n<=0){alert("Ltfen geerli bir cihaz fiyat giriniz");return}r(f),t()},g=()=>{a(0),i(0),l(0),d(1)};return e?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[u.jsx($w,{className:"w-6 h-6 mr-2 text-blue-600"}),"Fiyat Hesaplama"]}),u.jsx(Te,{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",variant:"default",children:u.jsx(Bl,{className:"w-6 h-6"})})]}),u.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hzl Cihaz Seimi"}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:p.map(y=>u.jsxs(Te,{type:"button",onClick:()=>a(y.price),className:"p-2 text-sm border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-colors",variant:"default",children:[u.jsx("div",{className:"font-medium",children:y.name}),u.jsxs("div",{className:"text-gray-600",children:[y.price.toLocaleString("tr-TR")," "]})]},y.name))})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[u.jsx(op,{className:"w-4 h-4 inline mr-1"}),"Cihaz Fiyat ()"]}),u.jsx(Ie,{type:"number",step:"0.01",min:"0",value:n,onChange:y=>a(parseFloat(y.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00",required:!0})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[u.jsx(pA,{className:"w-4 h-4 inline mr-1"}),"ndirim (%)"]}),u.jsx(Ie,{type:"number",step:"0.1",min:"0",max:"100",value:s,onChange:y=>x(parseFloat(y.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ndirim Tutar ()"}),u.jsx(Ie,{type:"number",step:"0.01",min:"0",value:o,onChange:y=>m(parseFloat(y.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taksit Says"}),u.jsxs(Tt,{value:c,onChange:y=>d(parseInt(y.target.value)),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[u.jsx("option",{value:1,children:"Pein"}),u.jsx("option",{value:2,children:"2 Taksit"}),u.jsx("option",{value:3,children:"3 Taksit"}),u.jsx("option",{value:6,children:"6 Taksit"}),u.jsx("option",{value:9,children:"9 Taksit"}),u.jsx("option",{value:12,children:"12 Taksit"})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[u.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Hesaplama Sonucu"}),u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{className:"text-gray-600",children:"Cihaz Fiyat:"}),u.jsxs("span",{className:"font-medium",children:[n.toLocaleString("tr-TR")," "]})]}),u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{className:"text-gray-600",children:"ndirim:"}),u.jsxs("span",{className:"font-medium text-red-600",children:["-",o.toLocaleString("tr-TR"),"  (",s.toFixed(1),"%)"]})]}),u.jsxs("div",{className:"border-t border-gray-200 pt-2",children:[u.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[u.jsx("span",{children:"Toplam:"}),u.jsxs("span",{className:"text-green-600",children:[f.finalPrice.toLocaleString("tr-TR")," "]})]}),f.installmentAmount&&u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mt-1",children:[u.jsx("span",{children:"Taksit Tutar:"}),u.jsxs("span",{children:[f.installmentAmount.toLocaleString("tr-TR"),"  x ",c]})]})]})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx(Te,{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",variant:"default",children:"Temizle"}),u.jsx(Te,{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",variant:"default",children:"ptal"}),u.jsx(Te,{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",variant:"default",children:"Hesaplamay Kaydet"})]})]})]})}):null},JL=()=>{const[e,t]=V.useState({stats:{totalPatients:0,todayAppointments:0,monthlyRevenue:0,activeTrials:0,activePatients:0,dailyRevenue:0,pendingAppointments:0,endingTrials:0},loading:!0,error:null});return V.useEffect(()=>{(async()=>{try{await new Promise(i=>setTimeout(i,500)),t({stats:{totalPatients:156,todayAppointments:8,monthlyRevenue:485e3,activeTrials:23,activePatients:142,dailyRevenue:12500,pendingAppointments:5,endingTrials:3},lastTransaction:{amount:"2,500",date:"2 saat nce"},lastCalculation:{amount:"8,750",date:"1 gn nce"},loading:!1,error:null})}catch(n){t(a=>({...a,loading:!1,error:n instanceof Error?n.message:"Veri yklenirken hata olutu"}))}})()},[]),e},ZL=zr("/")({component:e7});function e7(){const{stats:e,lastTransaction:t,lastCalculation:r,loading:n,error:a}=JL(),[s,i]=V.useState("week"),[o,l]=V.useState(!1),[c,d]=V.useState(!1),f=g=>{switch(g){case"patients":window.location.href="/patients";break;case"trials":window.location.href="/patients?filter=trial";break;case"revenue":window.location.href="/reports";break;case"appointments":window.location.href="/appointments";break}},h=()=>{l(!0)},p=()=>{d(!0)},x=g=>{console.log("Cash register data:",g)},m=g=>{console.log("Pricing calculation data:",g)},v=()=>{window.location.reload()};return n?u.jsx("div",{className:"flex items-center justify-center min-h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a?u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:u.jsxs("p",{className:"text-red-600",children:["Hata: ",a]})}):u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 rounded-lg shadow-sm",children:u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx(Tt,{value:s,onChange:g=>i(g.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",options:[{value:"today",label:"Bugn"},{value:"week",label:"Son 1 Hafta"},{value:"month",label:"Son 1 Ay"},{value:"quarter",label:"Son eyrek"}]}),u.jsx(Te,{onClick:v,className:"p-2 text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",variant:"secondary",children:u.jsx(Ll,{className:"w-5 h-5"})})]})})}),u.jsx(KL,{stats:{totalPatients:e.totalPatients,todayAppointments:e.todayAppointments,monthlyRevenue:e.monthlyRevenue,activeTrials:e.activeTrials},onCardClick:f}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx(YL,{lastTransaction:t,onClick:h}),u.jsx(XL,{lastCalculation:r,onClick:p}),u.jsx(GL,{stats:{activePatients:e.activePatients,dailyRevenue:e.dailyRevenue,pendingAppointments:e.pendingAppointments,endingTrials:e.endingTrials}})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trend Analizi"}),u.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center",children:u.jsx("p",{className:"text-gray-500",children:"Chart component will be implemented here"})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Hasta Dalm"}),u.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center",children:u.jsx("p",{className:"text-gray-500",children:"Chart component will be implemented here"})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cihaz Dalm"}),u.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center",children:u.jsx("p",{className:"text-gray-500",children:"Device distribution chart"})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Son Aktiviteler"}),u.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center",children:u.jsx("p",{className:"text-gray-500",children:"Recent activities list"})})]})]}),u.jsx(qL,{isOpen:o,onClose:()=>l(!1),onSubmit:x}),u.jsx(QL,{isOpen:c,onClose:()=>d(!1),onCalculate:m})]})}function t7({patients:e,isLoading:t,error:r,filters:n}){return t?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-gray-500",children:"Hastalar ykleniyor..."})}):r?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsxs("div",{className:"text-red-500",children:["Hata: ",r.message]})}):e.length===0?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-gray-500",children:"Hasta bulunamad"})}):u.jsx("div",{className:"overflow-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ad Soyad"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"TC Kimlik"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Telefon"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durum"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"lemler"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(a=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[a.firstName," ",a.lastName]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm text-gray-900",children:a.tcNumber})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm text-gray-900",children:a.phone})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.status==="active"?"Aktif":"Pasif"})}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[u.jsx("button",{className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"Dzenle"}),u.jsx("button",{className:"text-red-600 hover:text-red-900",children:"Sil"})]})]},a.id))})]})})}const Wp=()=>{const[e,t]=V.useState(()=>{try{const i=localStorage.getItem(fv);return i?JSON.parse(i):{}}catch{return{}}});V.useEffect(()=>{localStorage.setItem(fv,JSON.stringify(e))},[e]);const r=V.useCallback((i,o)=>{t(l=>({...l,[i]:o}))},[]),n=V.useCallback(i=>{t(o=>{const l={...o};return delete l[i],l})},[]),a=V.useCallback(()=>{t({})},[]),s=V.useCallback(()=>{t({})},[]);return{filters:e,updateFilter:r,clearFilter:n,clearAllFilters:a,resetFilters:s,setFilters:t}},r7=({placeholder:e="Hasta ara (isim, TC, telefon...)",className:t=""})=>{const{filters:r,updateFilter:n}=Wp(),a=s=>{n("search",s.target.value)};return u.jsxs("div",{className:`relative ${t}`,children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yw,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),u.jsx("input",{type:"text",value:r.search||"",onChange:a,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:e})]})},n7=({className:e=""})=>{const{filters:t,updateFilter:r,clearAllFilters:n}=Wp(),a=[{value:"",label:"Tm Durumlar"},{value:"active",label:"Aktif"},{value:"inactive",label:"Pasif"},{value:"archived",label:"Ariv"}],s=[{value:"",label:"Tm Segmentler"},{value:"premium",label:"Premium"},{value:"standard",label:"Standart"},{value:"basic",label:"Temel"}],i=Object.values(t).some(o=>o!==""&&o!==null&&o!==void 0);return u.jsxs("div",{className:`flex flex-wrap items-center gap-4 ${e}`,children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Hw,{className:"h-4 w-4 text-gray-500"}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filtreler:"})]}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Durum"}),u.jsx("select",{value:t.status||"",onChange:o=>r("status",o.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500",children:a.map(o=>u.jsx("option",{value:o.value,children:o.label},o.value))})]}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Segment"}),u.jsx("select",{value:t.segment||"",onChange:o=>r("segment",o.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500",children:s.map(o=>u.jsx("option",{value:o.value,children:o.label},o.value))})]}),i&&u.jsxs("button",{onClick:n,className:"flex items-center gap-1 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:[u.jsx(Bl,{className:"h-4 w-4"}),"Temizle"]})]})},a7=({selectedPatients:e,onAction:t,className:r=""})=>{if(e.length===0)return null;const n=[{id:"edit",label:"Dzenle",icon:hA,variant:"primary",disabled:e.length>1},{id:"export",label:"Da Aktar",icon:tA,variant:"secondary"},{id:"email",label:"E-posta Gnder",icon:Kw,variant:"secondary"},{id:"archive",label:"Arivle",icon:KN,variant:"warning"},{id:"delete",label:"Sil",icon:qw,variant:"danger"}],a=(s,i)=>{const o="flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-md transition-colors";if(i)return`${o} bg-gray-100 text-gray-400 cursor-not-allowed`;switch(s){case"primary":return`${o} bg-blue-600 text-white hover:bg-blue-700`;case"secondary":return`${o} bg-gray-100 text-gray-700 hover:bg-gray-200`;case"warning":return`${o} bg-yellow-100 text-yellow-800 hover:bg-yellow-200`;case"danger":return`${o} bg-red-100 text-red-800 hover:bg-red-200`;default:return`${o} bg-gray-100 text-gray-700 hover:bg-gray-200`}};return u.jsxs("div",{className:`flex items-center gap-2 p-4 bg-blue-50 border border-blue-200 rounded-lg ${r}`,children:[u.jsx("div",{className:"flex-1",children:u.jsxs("p",{className:"text-sm font-medium text-blue-900",children:[e.length," hasta seildi"]})}),u.jsx("div",{className:"flex items-center gap-2",children:n.map(s=>{const i=s.icon;return u.jsxs("button",{onClick:()=>!s.disabled&&t(s.id,e),disabled:s.disabled,className:a(s.variant,s.disabled||!1),title:s.disabled?"Bu ilem iin tek hasta sein":s.label,children:[u.jsx(i,{className:"h-4 w-4"}),s.label]},s.id)})})]})},s7=({stats:e,className:t=""})=>{const r=[{id:"total",label:"Toplam Hasta",value:e.total,icon:Us,color:"blue",bgColor:"bg-blue-50",iconColor:"text-blue-600",textColor:"text-blue-900"},{id:"active",label:"Aktif Hasta",value:e.active,icon:kA,color:"green",bgColor:"bg-green-50",iconColor:"text-green-600",textColor:"text-green-900"},{id:"inactive",label:"Pasif Hasta",value:e.inactive,icon:SA,color:"red",bgColor:"bg-red-50",iconColor:"text-red-600",textColor:"text-red-900"},{id:"new",label:"Bu Ay Yeni",value:e.newThisMonth,icon:Qw,color:"purple",bgColor:"bg-purple-50",iconColor:"text-purple-600",textColor:"text-purple-900"}];return u.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 ${t}`,children:r.map(n=>{const a=n.icon;return u.jsx("div",{className:`${n.bgColor} rounded-lg p-6 border border-gray-200`,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:n.label}),u.jsx("p",{className:`text-2xl font-bold ${n.textColor}`,children:n.value.toLocaleString("tr-TR")})]}),u.jsx("div",{className:`p-3 rounded-full ${n.bgColor}`,children:u.jsx(a,{className:`h-6 w-6 ${n.iconColor}`})})]})},n.id)})})},i7=({onUpload:e,onClose:t,className:r=""})=>{const n=V.useRef(null),[a,s]=V.useState(!1),[i,o]=V.useState(null),[l,c]=V.useState({status:"idle"}),d=v=>{v.preventDefault(),v.stopPropagation(),v.type==="dragenter"||v.type==="dragover"?s(!0):v.type==="dragleave"&&s(!1)},f=v=>{v.preventDefault(),v.stopPropagation(),s(!1),v.dataTransfer.files&&v.dataTransfer.files[0]&&h(v.dataTransfer.files[0])},h=v=>{if(v.type!=="text/csv"&&!v.name.endsWith(".csv")){c({status:"error",message:"Ltfen sadece CSV dosyas sein."});return}o(v),c({status:"idle"})},p=v=>{v.target.files&&v.target.files[0]&&h(v.target.files[0])},x=async()=>{if(i){c({status:"uploading",progress:0});try{await e(i),c({status:"success",message:"Dosya baaryla yklendi!"}),setTimeout(()=>{o(null),c({status:"idle"}),n.current&&(n.current.value="")},2e3)}catch(v){c({status:"error",message:v instanceof Error?v.message:"Dosya yklenirken hata olutu."})}}},m=()=>{o(null),c({status:"idle"}),n.current&&(n.current.value="")};return u.jsxs("div",{className:`bg-white rounded-lg border border-gray-200 p-6 ${r}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"CSV Dosyas Ykle"}),t&&u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(Bl,{className:"h-5 w-5"})})]}),i?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(lp,{className:"h-8 w-8 text-blue-600"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:i.name}),u.jsxs("p",{className:"text-sm text-gray-500",children:[(i.size/1024).toFixed(1)," KB"]})]})]}),u.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:l.status==="uploading",children:u.jsx(Bl,{className:"h-5 w-5"})})]}),l.status!=="idle"&&u.jsxs("div",{className:"p-4 rounded-lg",children:[l.status==="uploading"&&u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Ykleniyor..."})]}),l.status==="success"&&u.jsxs("div",{className:"flex items-center gap-3 text-green-600",children:[u.jsx(H0,{className:"h-5 w-5"}),u.jsx("span",{className:"text-sm",children:l.message})]}),l.status==="error"&&u.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[u.jsx(ip,{className:"h-5 w-5"}),u.jsx("span",{className:"text-sm",children:l.message})]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:x,disabled:l.status==="uploading",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l.status==="uploading"?"Ykleniyor...":"Ykle"}),u.jsx("button",{onClick:m,disabled:l.status==="uploading",className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"ptal"})]})]}):u.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${a?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:d,onDragLeave:d,onDragOver:d,onDrop:f,children:[u.jsx(wA,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),u.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"CSV dosyasn buraya srkleyin"}),u.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"veya dosya semek iin tklayn"}),u.jsx("button",{onClick:()=>{var v;return(v=n.current)==null?void 0:v.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors",children:"Dosya Se"}),u.jsx("input",{ref:n,type:"file",accept:".csv",onChange:p,className:"hidden"})]}),u.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:u.jsxs("p",{className:"text-xs text-blue-800",children:[u.jsx("strong",{children:"Not:"})," CSV dosyas u stunlar iermelidir: Ad, Soyad, E-posta, Telefon, Doum Tarihi"]})})]})},o7=({savedViews:e,currentView:t,onSelectView:r,onSaveView:n,onUpdateView:a,onDeleteView:s,currentFilters:i,className:o=""})=>{const[l,c]=V.useState(!1),[d,f]=V.useState(null),[h,p]=V.useState(""),x=()=>{h.trim()&&(n(h.trim(),i),p(""),c(!1))},m=y=>{h.trim()&&(a(y,h.trim(),i),p(""),f(null))},v=y=>{f(y.id),p(y.name)},g=()=>{f(null),c(!1),p("")};return u.jsxs("div",{className:`bg-white rounded-lg border border-gray-200 p-4 ${o}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h3",{className:"text-sm font-medium text-gray-900 flex items-center gap-2",children:[u.jsx(U1,{className:"h-4 w-4"}),"Kaytl Grnmler"]}),u.jsxs("button",{onClick:()=>c(!0),className:"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center gap-1",children:[u.jsx(cp,{className:"h-4 w-4"}),"Yeni Grnm"]})]}),u.jsxs("div",{className:"space-y-2",children:[l&&u.jsxs("div",{className:"p-3 border border-blue-200 rounded-lg bg-blue-50",children:[u.jsx("input",{type:"text",value:h,onChange:y=>p(y.target.value),placeholder:"Grnm ad...",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 mb-2",autoFocus:!0}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:x,disabled:!h.trim(),className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Kaydet"}),u.jsx("button",{onClick:g,className:"px-3 py-1 text-xs border border-gray-300 text-gray-700 rounded hover:bg-gray-50",children:"ptal"})]})]}),e.map(y=>u.jsx("div",{className:`p-3 rounded-lg border transition-colors ${t===y.id?"border-blue-200 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:d===y.id?u.jsxs("div",{children:[u.jsx("input",{type:"text",value:h,onChange:w=>p(w.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 mb-2",autoFocus:!0}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>m(y.id),disabled:!h.trim(),className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Gncelle"}),u.jsx("button",{onClick:g,className:"px-3 py-1 text-xs border border-gray-300 text-gray-700 rounded hover:bg-gray-50",children:"ptal"})]})]}):u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("button",{onClick:()=>r(y.id),className:"text-left w-full",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Vw,{className:"h-4 w-4 text-gray-400"}),u.jsx("span",{className:"text-sm font-medium text-gray-900",children:y.name}),y.isDefault&&u.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded-full",children:"Varsaylan"})]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:new Date(y.createdAt).toLocaleDateString("tr-TR")})]})}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>v(y),className:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"Dzenle",children:u.jsx(mA,{className:"h-3 w-3"})}),!y.isDefault&&u.jsx("button",{onClick:()=>s(y.id),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Sil",children:u.jsx(qw,{className:"h-3 w-3"})})]})]})},y.id)),e.length===0&&!l&&u.jsxs("div",{className:"text-center py-6 text-gray-500",children:[u.jsx(U1,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),u.jsx("p",{className:"text-sm",children:"Henz kaytl grnm yok"}),u.jsx("p",{className:"text-xs",children:"Filtreleri ayarlayp yeni grnm oluturun"})]})]})]})},l7=()=>({patientsGetPatients:(m,v)=>zt.get("/api/patients",{...v,params:{...m,...v==null?void 0:v.params}}),patientsCreatePatient:(m,v)=>zt.post("/api/patients",m,v),patientsDeletePatient:(m,v)=>zt.delete(`/api/patients/${m}`,v),salesAssignDevicesExtended:(m,v,g)=>zt.post(`/api/patients/${m}/assign-devices-extended`,v,g),patientSubresourcesCreatePatientEreceipt:(m,v,g)=>zt.post(`/api/patients/${m}/ereceipts`,v,g),patientSubresourcesDeletePatientEreceipt:(m,v,g)=>zt.delete(`/api/patients/${m}/ereceipts/${v}`,g),patientSubresourcesAddPatientHearingTest:(m,v,g)=>zt.post(`/api/patients/${m}/hearing-tests`,v,g),patientSubresourcesDeletePatientHearingTest:(m,v,g)=>zt.delete(`/api/patients/${m}/hearing-tests/${v}`,g),patientSubresourcesCreatePatientNote:(m,v,g)=>zt.post(`/api/patients/${m}/notes`,v,g),patientSubresourcesDeletePatientNote:(m,v,g)=>zt.delete(`/api/patients/${m}/notes/${v}`,g),salesGetPatientSales:(m,v)=>zt.get(`/api/patients/${m}/sales`,v),sgkGetPatientSgkDocuments:(m,v)=>zt.get(`/api/patients/${m}/sgk-documents`,v),patientsBulkUploadPatients:(m,v)=>zt.post("/api/patients/bulk_upload",m,v),patientsExportPatientsCsv:m=>zt.get("/api/patients/export",m),patientsSearchPatients:m=>zt.get("/api/patients/search",m)});function c7(){var s;const{data:e,isLoading:t,error:r,refetch:n}=J4({queryKey:["patients"],queryFn:()=>l7().patientsGetPatients(),staleTime:3e5});return{patients:((s=e==null?void 0:e.data)==null?void 0:s.data)||[],isLoading:t,error:r,refetch:n}}const u7=()=>{const[e,t]=V.useState(()=>{try{const f=localStorage.getItem(hv);return f?JSON.parse(f):{selectedPatients:[],isAllSelected:!1}}catch{return{selectedPatients:[],isAllSelected:!1}}});V.useEffect(()=>{localStorage.setItem(hv,JSON.stringify(e))},[e]);const r=V.useCallback(f=>{t(h=>({...h,selectedPatients:[...h.selectedPatients,f],isAllSelected:!1}))},[]),n=V.useCallback(f=>{t(h=>({...h,selectedPatients:h.selectedPatients.filter(p=>p!==f),isAllSelected:!1}))},[]),a=V.useCallback(f=>{t(h=>{const p=h.selectedPatients.includes(f);return{...h,selectedPatients:p?h.selectedPatients.filter(x=>x!==f):[...h.selectedPatients,f],isAllSelected:!1}})},[]),s=V.useCallback(f=>{t(h=>({...h,selectedPatients:f.map(p=>p.id),isAllSelected:!0}))},[]),i=V.useCallback(()=>{t(f=>({...f,selectedPatients:[],isAllSelected:!1}))},[]),o=V.useCallback(async(f,h)=>{e.selectedPatients.length!==0&&(t(p=>({...p,lastAction:f})),h&&await h(e.selectedPatients),i())},[e.selectedPatients,i]),l=V.useCallback(async()=>{await o("export")},[o]),c=V.useCallback(async f=>{await o("delete",f)},[o]),d=V.useCallback(async f=>{await o("archive",f)},[o]);return{selectedPatients:e.selectedPatients,isAllSelected:e.isAllSelected,selectedCount:e.selectedPatients.length,selectPatient:r,deselectPatient:n,togglePatient:a,selectAll:s,clearSelection:i,executeAction:o,exportSelected:l,deleteSelected:c,archiveSelected:d}};function d7(){const{patients:e,isLoading:t,error:r}=c7(),{filters:n,updateFilters:a,clearFilters:s}=Wp(),{selectedPatients:i,bulkActions:o}=u7();return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[u.jsx("h1",{className:"text-2xl font-semibold",children:"Hastalar"}),u.jsx(i7,{})]}),u.jsx(s7,{patients:e}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx(o7,{}),u.jsx(r7,{onSearch:a}),u.jsx(n7,{filters:n,onChange:a}),u.jsx(a7,{selectedPatients:i,actions:o})]}),u.jsx("div",{className:"flex-1 overflow-hidden",children:u.jsx(V.Suspense,{fallback:u.jsx("div",{children:"Ykleniyor..."}),children:u.jsx(t7,{patients:e,isLoading:t,error:r,filters:n})})})]})}const f7=zr("/patients/")({component:d7});class h7{async loadInvoices(){try{const t=localStorage.getItem(Sv);return t?JSON.parse(t):[]}catch(t){return console.error("Error loading invoices:",t),[]}}async saveInvoices(t){try{localStorage.setItem(Sv,JSON.stringify(t))}catch(r){throw console.error("Error saving invoices:",r),new Error("Faturalar kaydedilemedi")}}generateSampleInvoices(){const t=[],r=["draft","sent","paid","overdue","cancelled"],n=["standard","proforma","credit_note","debit_note"];for(let a=1;a<=20;a++){const s=new Date(Date.now()-Math.random()*90*24*60*60*1e3),i=new Date(s.getTime()+30*24*60*60*1e3),o=this.generateInvoiceItems(Math.floor(Math.random()*5)+1),l=o.reduce((f,h)=>f+h.unitPrice*h.quantity,0),c=o.reduce((f,h)=>f+h.taxAmount,0),d=l+c;t.push({id:`inv-${a.toString().padStart(3,"0")}`,invoiceNumber:`2024-${a.toString().padStart(4,"0")}`,customerId:`cust-${Math.floor(Math.random()*100)+1}`,customerName:`Mteri ${a}`,customerTaxNumber:`${Math.floor(Math.random()*9e9)+1e9}`,customerAddress:{street:`Test Sokak No: ${a}`,city:"stanbul",postalCode:"34000",country:"Trkiye"},billingAddress:{name:`Mteri ${a}`,address:`Fatura Sokak No: ${a}`,city:"stanbul",postalCode:"34000",country:"Trkiye",taxNumber:`${Math.floor(Math.random()*9e9)+1e9}`},items:o,subtotal:l,taxes:[{type:"vat",rate:.18,amount:c}],totalAmount:d,status:r[Math.floor(Math.random()*r.length)],type:n[Math.floor(Math.random()*n.length)],paymentMethod:"cash",dueDate:i.toISOString(),createdAt:s.toISOString(),updatedAt:s.toISOString(),notes:`rnek fatura ${a} notlar`})}return t}generateInvoiceItems(t=3){const r=[],n=[{name:"itme Cihaz Bakm",price:150},{name:"Kulak Kalb",price:200},{name:"itme Testi",price:100},{name:"Cihaz Ayar",price:75},{name:"Pil Deiimi",price:25}];for(let a=0;a<t;a++){const s=n[a%n.length],i=Math.floor(Math.random()*3)+1,o=s.price,l=.18,c=o*i*l,d=o*i+c;r.push({id:`item-${Date.now()}-${a}`,description:s.name,quantity:i,unitPrice:o,taxRate:l,taxAmount:c,totalPrice:d,sgkCode:`SGK${1e3+a}`,category:"service"})}return r}async initializeData(){if((await this.loadInvoices()).length===0){const r=this.generateSampleInvoices();await this.saveInvoices(r)}}async createInvoice(t){const r=await this.loadInvoices(),n={id:`inv-${Date.now()}`,invoiceNumber:t.invoiceNumber||`2024-${(r.length+1).toString().padStart(4,"0")}`,customerId:t.customerId,customerName:t.customerName,customerTaxNumber:t.customerTaxNumber,customerAddress:t.customerAddress,items:t.items,subtotal:t.subtotal,taxes:t.taxes,totalAmount:t.totalAmount,status:t.status||"draft",type:t.type||"standard",paymentMethod:t.paymentMethod||"cash",dueDate:t.dueDate,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),notes:t.notes,attachments:t.attachments||[],templateId:t.templateId};return r.push(n),await this.saveInvoices(r),await pr.addOperation({method:"POST",endpoint:"/api/invoices",data:t,priority:"high"}),n}async updateInvoice(t,r){const n=await this.loadInvoices(),a=n.findIndex(i=>i.id===t);if(a===-1)throw new Error("Fatura bulunamad");const s={...n[a],...r,updatedAt:new Date().toISOString()};return n[a]=s,await this.saveInvoices(n),await pr.addOperation({method:"PUT",endpoint:`/api/invoices/${t}`,data:{id:t,...r},priority:"normal"}),s}async deleteInvoice(t){const r=await this.loadInvoices(),n=r.filter(a=>a.id!==t);if(n.length===r.length)throw new Error("Fatura bulunamad");await this.saveInvoices(n),await pr.addOperation({method:"DELETE",endpoint:`/api/invoices/${t}`,priority:"normal"})}async getInvoice(t){return(await this.loadInvoices()).find(n=>n.id===t)||null}async getInvoices(t){let r=await this.loadInvoices();if(t&&(t.status&&(r=r.filter(l=>l.status===t.status)),t.type&&(r=r.filter(l=>l.type===t.type)),t.customerId&&(r=r.filter(l=>l.customerId===t.customerId)),t.dateFrom&&(r=r.filter(l=>new Date(l.createdAt)>=new Date(t.dateFrom))),t.dateTo&&(r=r.filter(l=>new Date(l.createdAt)<=new Date(t.dateTo))),t.search)){const l=t.search.toLowerCase();r=r.filter(c=>{var d;return c.invoiceNumber.toLowerCase().includes(l)||c.customerName.toLowerCase().includes(l)||((d=c.customerTaxNumber)==null?void 0:d.includes(l))})}const n=(t==null?void 0:t.page)||1,a=(t==null?void 0:t.limit)||10,s=(n-1)*a,i=s+a;return{invoices:r.slice(s,i),total:r.length,page:n,limit:a,totalPages:Math.ceil(r.length/a)}}async getInvoiceStats(){const t=await this.loadInvoices();return{total:t.length,draft:t.filter(n=>n.status==="draft").length,sent:t.filter(n=>n.status==="sent").length,paid:t.filter(n=>n.status==="paid").length,overdue:t.filter(n=>n.status==="overdue").length,cancelled:t.filter(n=>n.status==="cancelled").length,totalAmount:t.reduce((n,a)=>n+a.totalAmount,0),paidAmount:t.filter(n=>n.status==="paid").reduce((n,a)=>n+a.totalAmount,0),pendingAmount:t.filter(n=>["sent","overdue"].includes(n.status)).reduce((n,a)=>n+a.totalAmount,0)}}async sendInvoice(t){const r=await this.getInvoice(t);if(!r)throw new Error("Fatura bulunamad");if(r.status==="sent")throw new Error("Fatura zaten gnderilmi");return this.updateInvoice(t,{id:t,status:"sent",gibSentDate:new Date().toISOString()})}async cancelInvoice(t,r){const n=await this.getInvoice(t);if(!n)throw new Error("Fatura bulunamad");if(n.status==="cancelled")throw new Error("Fatura zaten iptal edilmi");return this.updateInvoice(t,{id:t,status:"cancelled",notes:r?`${n.notes||""}
ptal nedeni: ${r}`:n.notes})}async markAsPaid(t,r){return this.updateInvoice(t,{id:t,status:"paid",paymentDate:new Date().toISOString(),paymentMethod:r})}async submitEFatura(t){try{return await this.updateInvoice(t.invoiceId,{id:t.invoiceId,status:"sent",ettn:t.ettn,gibSentDate:new Date().toISOString()}),await pr.addOperation({method:"POST",endpoint:"/api/invoices/efatura/submit",data:t,priority:"high"}),{success:!0,ettn:t.ettn}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Bilinmeyen hata"}}}async submitBulkEFatura(t){try{const r=[];for(const n of t.invoiceIds){const a=await this.submitEFatura({invoiceId:n,ettn:`ETTN-${Date.now()}-${n}`,submissionDate:t.submissionDate});r.push({invoiceId:n,...a})}return{success:!0,results:r}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Toplu gnderim hatas"}}}async getTemplates(){return[{id:"template-1",name:"Standart Fatura",description:"Genel kullanm iin standart fatura ablonu",isDefault:!0,fields:["customerName","items","totalAmount"],createdAt:new Date().toISOString()},{id:"template-2",name:"Proforma Fatura",description:"Proforma fatura ablonu",isDefault:!1,fields:["customerName","items","totalAmount","validUntil"],createdAt:new Date().toISOString()}]}calculateInvoice(t){let r=0,n=0;return{items:t.map(s=>{const i=s.quantity*s.unitPrice,o=i*(s.taxRate||0),l=i+o;return r+=i,n+=o,{...s,id:`temp-${Date.now()}-${Math.random()}`,taxAmount:o,totalPrice:l}}),subtotal:r,totalTax:n,totalAmount:r+n}}validateInvoice(t){var a;const r=[],n=[];return(a=t.customerName)!=null&&a.trim()||r.push("Mteri ad gereklidir"),(!t.items||t.items.length===0)&&r.push("En az bir kalem gereklidir"),t.items&&t.items.forEach((s,i)=>{var o;(o=s.description)!=null&&o.trim()||r.push(`${i+1}. kalem aklamas gereklidir`),(!s.quantity||s.quantity<=0)&&r.push(`${i+1}. kalem miktar geerli olmaldr`),(!s.unitPrice||s.unitPrice<=0)&&r.push(`${i+1}. kalem birim fiyat geerli olmaldr`)}),t.dueDate?new Date(t.dueDate)<new Date&&n.push("Vade tarihi gemite"):n.push("Vade tarihi belirtilmemi"),{isValid:r.length===0,errors:r,warnings:n}}async addPayment(t,r){return{...r,id:`payment-${Date.now()}`,createdAt:new Date().toISOString()}}async createPaymentPlan(t,r){return{...r,id:`plan-${Date.now()}`,createdAt:new Date().toISOString()}}async exportInvoices(t){try{const r=await this.getInvoices(t.filters);return{success:!0,data:{invoices:r.invoices,format:t.format,exportedAt:new Date().toISOString(),total:r.total}}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Da aktarm hatas"}}}}const Ea=new h7;function m7({onInvoiceSelect:e,filters:t,showActions:r=!0,compact:n=!1}){const[a,s]=V.useState([]),[i,o]=V.useState(!0),[l,c]=V.useState(null),[d,f]=V.useState(""),[h,p]=V.useState(null),[x,m]=V.useState(1),[v,g]=V.useState(1),y=async _=>{try{o(!0),c(null);const C=await Ea.getInvoices({...t,..._,page:x,limit:10});s(C.invoices),g(C.totalPages)}catch(C){c(C instanceof Error?C.message:"Faturalar yklenirken hata olutu")}finally{o(!1)}};V.useEffect(()=>{Ea.initializeData().then(()=>{y()})},[x]),V.useEffect(()=>{const _=setTimeout(()=>{d.trim()?y({...t,search:d.trim()}):y(t)},300);return()=>clearTimeout(_)},[d,t]);const w=_=>{p(_),e==null||e(_)},S=async(_,C)=>{if(C.stopPropagation(),window.confirm(`${_.invoiceNumber} numaral faturay silmek istediinizden emin misiniz?`))try{await Ea.deleteInvoice(_.id),y()}catch(F){c(F instanceof Error?F.message:"Fatura silinirken hata olutu")}},A=async(_,C)=>{try{C==="sent"?await Ea.sendInvoice(_.id):C==="paid"?await Ea.markAsPaid(_.id):C==="cancelled"&&await Ea.cancelInvoice(_.id),y()}catch(F){c(F instanceof Error?F.message:"Fatura durumu gncellenirken hata olutu")}},T=_=>{switch(_){case"draft":return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"paid":return"bg-green-100 text-green-800";case"overdue":return"bg-red-100 text-red-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=_=>{switch(_){case"draft":return"Taslak";case"sent":return"Gnderildi";case"paid":return"dendi";case"overdue":return"Vadesi Geti";case"cancelled":return"ptal";default:return _}},k=_=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(_),E=_=>new Date(_).toLocaleDateString("tr-TR");return i?u.jsxs("div",{className:"flex items-center justify-center p-8",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Faturalar ykleniyor..."})]}):l?u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),u.jsxs("div",{className:"ml-3",children:[u.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Hata"}),u.jsx("div",{className:"mt-2 text-sm text-red-700",children:l})]})]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-center space-x-4",children:u.jsx("div",{className:"flex-1",children:u.jsx(Ie,{type:"text",placeholder:"Fatura ara (numara, mteri ad, vergi no...)",value:d,onChange:_=>f(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})})}),u.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:u.jsx("ul",{className:"divide-y divide-gray-200",children:a.length===0?u.jsx("li",{className:"px-6 py-8 text-center text-gray-500",children:"Fatura bulunamad"}):a.map(_=>{var C,F;return u.jsx("li",{className:`px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors ${(h==null?void 0:h.id)===_.id?"bg-blue-50":""}`,onClick:()=>w(_),children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"flex-1 min-w-0",children:u.jsx("div",{className:"flex items-center space-x-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:_.invoiceNumber}),u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T(_.status)}`,children:b(_.status)})]}),u.jsxs("div",{className:"mt-1 flex items-center space-x-4 text-sm text-gray-500",children:[u.jsx("span",{children:_.patientName}),((C=_.billingAddress)==null?void 0:C.taxNumber)&&u.jsxs("span",{children:["VN: ",(F=_.billingAddress)==null?void 0:F.taxNumber]}),u.jsx("span",{children:E(_.createdAt)}),_.dueDate&&u.jsxs("span",{children:["Vade: ",E(_.dueDate)]})]})]})})}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:k(_.grandTotal)}),u.jsxs("p",{className:"text-xs text-gray-500",children:[_.items.length," kalem"]})]}),r&&u.jsxs("div",{className:"flex items-center space-x-2",children:[_.status==="draft"&&u.jsx(Te,{onClick:D=>{D.stopPropagation(),A(_,"sent")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",variant:"default",children:"Gnder"}),_.status==="sent"&&u.jsx(Te,{onClick:D=>{D.stopPropagation(),A(_,"paid")},className:"text-green-600 hover:text-green-800 text-sm font-medium",variant:"default",children:"dendi"}),["draft","sent"].includes(_.status)&&u.jsx(Te,{onClick:D=>S(_,D),className:"text-red-600 hover:text-red-800 text-sm font-medium",variant:"default",children:"Sil"})]})]})]})},_.id)})})}),v>1&&u.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-t border-gray-200 sm:px-6",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx(Te,{onClick:()=>m(Math.max(1,x-1)),disabled:x===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:"nceki"}),u.jsx(Te,{onClick:()=>m(Math.min(v,x+1)),disabled:x===v,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:"Sonraki"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Sayfa ",u.jsx("span",{className:"font-medium",children:x})," / ",u.jsx("span",{className:"font-medium",children:v})]})}),u.jsx("div",{children:u.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[u.jsx(Te,{onClick:()=>m(Math.max(1,x-1)),disabled:x===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:"nceki"}),u.jsx(Te,{onClick:()=>m(Math.min(v,x+1)),disabled:x===v,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:"Sonraki"})]})})]})]})]})}class Yn{static validateTurkishTaxNumber(t){if(!t||t.length!==10)return!1;const r=t.split("").map(Number);if(r.some(isNaN))return!1;let n=0;for(let i=0;i<9;i++)n+=r[i]*(10-i);const a=n%11;return(a<2?a:11-a)===r[9]}static validateTCKN(t){if(!t||t.length!==11)return!1;const r=t.split("").map(Number);if(r.some(isNaN)||r[0]===0)return!1;const n=r[0]+r[2]+r[4]+r[6]+r[8],a=r[1]+r[3]+r[5]+r[7],s=(n*7-a)%10,i=(n+a+s)%10;return s===r[9]&&i===r[10]}static validateEmail(t){return t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t):!1}static validateTurkishPhone(t){if(!t)return!1;const r=t.replace(/\D/g,"");return r.length===10?/^[2-5]\d{9}$/.test(r):r.length===13?/^905\d{9}$/.test(r):!1}static validateTurkishPostalCode(t){return t?/^\d{5}$/.test(t):!1}static validateAmount(t){if(t===""||t===null||t===void 0)return!1;const r=typeof t=="string"?parseFloat(t):t;return isNaN(r)||r<0?!1:(r.toString().split(".")[1]||"").length<=2}static validatePercentage(t){if(t===""||t===null||t===void 0)return!1;const r=typeof t=="string"?parseFloat(t):t;return!isNaN(r)&&r>=0&&r<=100}static validateInvoiceDate(t){if(!t)return!1;const r=new Date(t),n=new Date;return n.setHours(23,59,59,999),r<=n&&r>=new Date("2000-01-01")}static validateDueDate(t,r){if(!t||!r)return!1;const n=new Date(t),a=new Date(r);return n>=a}static generateIdempotencyKey(){return`invoice_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static formatTurkishCurrency(t){return new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}static formatTurkishPhone(t){if(!t)return"";const r=t.replace(/\D/g,"");return r.length===10?`(0${r.substr(0,3)}) ${r.substr(3,3)} ${r.substr(6,2)} ${r.substr(8,2)}`:r.length===13&&r.startsWith("905")?`+90 (${r.substr(2,3)}) ${r.substr(5,3)} ${r.substr(8,2)} ${r.substr(10,2)}`:t}static formatTaxNumber(t){if(!t)return"";const r=t.replace(/\D/g,"");return r.length===10?`${r.substr(0,3)} ${r.substr(3,3)} ${r.substr(6,2)} ${r.substr(8,2)}`:r.length===11?`${r.substr(0,3)} ${r.substr(3,3)} ${r.substr(6,3)} ${r.substr(9,2)}`:t}}const nf={version:"1.0.0",invoiceTypes:{individual:{name:"Bireysel Fatura",description:"Bireysel mteriler iin fatura",requiredFields:["customer_info","invoice_details","items"],conditionalFields:["device_info","sgk_info"]},corporate:{name:"Kurumsal Fatura",description:"Kurumsal mteriler iin fatura",requiredFields:["company_info","invoice_details","items"],conditionalFields:["device_info","sgk_info"]},export:{name:"hracat Faturas",description:"Yurt d satlar iin fatura",requiredFields:["export_info","invoice_details","items"],conditionalFields:["device_info"]}},scenarios:{device_sale:{name:"Cihaz Sat",description:"itme cihaz sat faturas",applicableTypes:["individual","corporate"]},service:{name:"Hizmet Faturas",description:"Bakm, onarm ve dier hizmetler",applicableTypes:["individual","corporate"]},export_device:{name:"Cihaz hracat",description:"Yurt d cihaz sat",applicableTypes:["export"]}},fieldDefinitions:{customer_info:{name:"customer_info",title:"Mteri Bilgileri",description:"Bireysel mteri bilgileri",fields:{first_name:{id:"first_name",label:"Ad",type:"text",required:!0,validation:{minLength:2,maxLength:50}},last_name:{id:"last_name",label:"Soyad",type:"text",required:!0,validation:{minLength:2,maxLength:50}},tc_number:{id:"tc_number",label:"T.C. Kimlik No",type:"text",required:!0,placeholder:"12345678901",validation:{pattern:"^[0-9]{11}$",minLength:11,maxLength:11},helpText:"11 haneli T.C. Kimlik Numaras"},email:{id:"email",label:"E-posta",type:"email",required:!1,placeholder:"ornek@email.com"},phone:{id:"phone",label:"Telefon",type:"tel",required:!0,placeholder:"0532 123 45 67"},address:{id:"address",label:"Adres",type:"textarea",required:!0,validation:{minLength:10,maxLength:200}},city:{id:"city",label:"l",type:"select",required:!0,options:[{value:"istanbul",text:"stanbul"},{value:"ankara",text:"Ankara"},{value:"izmir",text:"zmir"},{value:"bursa",text:"Bursa"},{value:"antalya",text:"Antalya"}]},postal_code:{id:"postal_code",label:"Posta Kodu",type:"text",required:!0,placeholder:"34000",validation:{pattern:"^[0-9]{5}$"}}}},company_info:{name:"company_info",title:"irket Bilgileri",description:"Kurumsal mteri bilgileri",fields:{company_name:{id:"company_name",label:"irket Ad",type:"text",required:!0,validation:{minLength:2,maxLength:100}},tax_number:{id:"tax_number",label:"Vergi Numaras",type:"text",required:!0,placeholder:"1234567890",validation:{pattern:"^[0-9]{10}$",minLength:10,maxLength:10},helpText:"10 haneli Vergi Kimlik Numaras"},tax_office:{id:"tax_office",label:"Vergi Dairesi",type:"text",required:!0,validation:{minLength:2,maxLength:50}},contact_person:{id:"contact_person",label:"Yetkili Kii",type:"text",required:!1,validation:{maxLength:100}},email:{id:"email",label:"E-posta",type:"email",required:!1,placeholder:"info@sirket.com"},phone:{id:"phone",label:"Telefon",type:"tel",required:!0,placeholder:"0212 123 45 67"},address:{id:"address",label:"Adres",type:"textarea",required:!0,validation:{minLength:10,maxLength:200}},city:{id:"city",label:"l",type:"select",required:!0,options:[{value:"istanbul",text:"stanbul"},{value:"ankara",text:"Ankara"},{value:"izmir",text:"zmir"},{value:"bursa",text:"Bursa"},{value:"antalya",text:"Antalya"}]},postal_code:{id:"postal_code",label:"Posta Kodu",type:"text",required:!0,placeholder:"34000",validation:{pattern:"^[0-9]{5}$"}}}},export_info:{name:"export_info",title:"hracat Bilgileri",description:"Yurt d sat bilgileri",fields:{company_name:{id:"company_name",label:"irket Ad",type:"text",required:!0,validation:{minLength:2,maxLength:100}},country:{id:"country",label:"lke",type:"select",required:!0,options:[{value:"DE",text:"Almanya"},{value:"FR",text:"Fransa"},{value:"UK",text:"ngiltere"},{value:"US",text:"Amerika"},{value:"NL",text:"Hollanda"}]},currency:{id:"currency",label:"Para Birimi",type:"select",required:!0,defaultValue:"EUR",options:[{value:"EUR",text:"Euro (EUR)"},{value:"USD",text:"Dolar (USD)"},{value:"GBP",text:"Sterlin (GBP)"}]},exchange_rate:{id:"exchange_rate",label:"Dviz Kuru",type:"number",required:!0,validation:{min:.01,max:1e3},helpText:"1 TRY = ? Yabanc Para"},address:{id:"address",label:"Adres",type:"textarea",required:!0,validation:{minLength:10,maxLength:200}}}},invoice_details:{name:"invoice_details",title:"Fatura Detaylar",description:"Fatura tarih ve deme bilgileri",fields:{invoice_date:{id:"invoice_date",label:"Fatura Tarihi",type:"date",required:!0,defaultValue:new Date().toISOString().split("T")[0]},due_date:{id:"due_date",label:"Vade Tarihi",type:"date",required:!0},payment_method:{id:"payment_method",label:"deme Yntemi",type:"select",required:!0,defaultValue:"cash",options:[{value:"cash",text:"Nakit"},{value:"credit_card",text:"Kredi Kart"},{value:"bank_transfer",text:"Havale/EFT"},{value:"check",text:"ek"},{value:"installment",text:"Taksit"}]},notes:{id:"notes",label:"Notlar",type:"textarea",required:!1,validation:{maxLength:500},placeholder:"Fatura ile ilgili ek notlar..."}}},items:{name:"items",title:"Fatura Kalemleri",description:"Satlan rn ve hizmetler",fields:{items_list:{id:"items_list",label:"Kalemler",type:"text",required:!0,helpText:"En az bir kalem eklemelisiniz"}}},device_info:{name:"device_info",title:"Cihaz Bilgileri",description:"itme cihaz detaylar",conditional:{dependsOn:"scenario",condition:"equals",value:"device_sale"},fields:{device_brand:{id:"device_brand",label:"Cihaz Markas",type:"select",required:!0,options:[{value:"phonak",text:"Phonak"},{value:"oticon",text:"Oticon"},{value:"widex",text:"Widex"},{value:"resound",text:"ReSound"},{value:"signia",text:"Signia"}]},device_model:{id:"device_model",label:"Cihaz Modeli",type:"text",required:!0,validation:{minLength:2,maxLength:50}},device_serial:{id:"device_serial",label:"Seri Numaras",type:"text",required:!0,validation:{minLength:5,maxLength:20}},device_side:{id:"device_side",label:"Kulak",type:"select",required:!0,options:[{value:"left",text:"Sol"},{value:"right",text:"Sa"},{value:"both",text:"ift"}]},warranty_period:{id:"warranty_period",label:"Garanti Sresi (Ay)",type:"number",required:!0,defaultValue:24,validation:{min:1,max:60}}}},sgk_info:{name:"sgk_info",title:"SGK Bilgileri",description:"Sosyal Gvenlik Kurumu bilgileri",conditional:{dependsOn:"has_sgk_coverage",condition:"equals",value:!0},fields:{has_sgk_coverage:{id:"has_sgk_coverage",label:"SGK Kapsamnda",type:"checkbox",required:!1,defaultValue:!1},sgk_number:{id:"sgk_number",label:"SGK Sicil No",type:"text",required:!1,conditional:{dependsOn:"has_sgk_coverage",condition:"equals",value:!0},validation:{minLength:10,maxLength:15}},sgk_institution:{id:"sgk_institution",label:"SGK Kurumu",type:"text",required:!1,conditional:{dependsOn:"has_sgk_coverage",condition:"equals",value:!0},validation:{maxLength:100}},sgk_coverage_rate:{id:"sgk_coverage_rate",label:"Karlama Oran (%)",type:"number",required:!1,conditional:{dependsOn:"has_sgk_coverage",condition:"equals",value:!0},defaultValue:80,validation:{min:0,max:100}}}}}},p7=({onSubmit:e,onValidationChange:t,initialData:r={},disabled:n=!1,className:a=""})=>{const[s,i]=V.useState({invoiceType:r.invoiceType||"individual",scenario:r.scenario||"device_sale",...r}),[o,l]=V.useState([{id:"1",description:"",quantity:1,unitPrice:0,taxRate:18,total:0}]),[c,d]=V.useState({}),[f,h]=V.useState({}),p=(_,C)=>{if(!_.conditional)return!0;const{dependsOn:F,condition:D,value:M}=_.conditional,B=C[F];switch(D){case"equals":return B===M;case"not_equals":return B!==M;case"contains":return String(B).includes(String(M));default:return!0}},x=V.useMemo(()=>{const _=nf,C=_.invoiceTypes[s.invoiceType];if(!C)return[];const F=[];return C.requiredFields.forEach(D=>{const M=_.fieldDefinitions[D];M&&F.push(M)}),C.conditionalFields.forEach(D=>{const M=_.fieldDefinitions[D];M&&p(M,s)&&F.push(M)}),F},[s.invoiceType,s.scenario,s]),m=(_,C)=>{if(!_.conditional)return!0;const{dependsOn:F,condition:D,value:M}=_.conditional,B=C[F];switch(D){case"equals":return B===M;case"not_equals":return B!==M;case"contains":return String(B).includes(String(M));case"greater_than":return Number(B)>Number(M);case"less_than":return Number(B)<Number(M);default:return!0}},v=(_,C)=>{if(_.required&&(!C||C===""))return`${_.label} alan zorunludur`;if(!C)return null;const F=_.validation;return F?F.pattern&&!new RegExp(F.pattern).test(String(C))?_.id==="tc_number"?Yn.validateTCKN(String(C))?null:"Geersiz T.C. Kimlik Numaras":_.id==="tax_number"?Yn.validateTurkishTaxNumber(String(C))?null:"Geersiz Vergi Kimlik Numaras":_.id==="postal_code"?Yn.validateTurkishPostalCode(String(C))?null:"Geersiz posta kodu":`${_.label} format geersiz`:_.type==="email"&&!Yn.validateEmail(String(C))?"Geersiz e-posta adresi":_.type==="tel"&&!Yn.validateTurkishPhone(String(C))?"Geersiz telefon numaras":F.minLength&&String(C).length<F.minLength?`${_.label} en az ${F.minLength} karakter olmaldr`:F.maxLength&&String(C).length>F.maxLength?`${_.label} en fazla ${F.maxLength} karakter olmaldr`:F.min!==void 0&&Number(C)<F.min?`${_.label} en az ${F.min} olmaldr`:F.max!==void 0&&Number(C)>F.max?`${_.label} en fazla ${F.max} olmaldr`:null:null},g=()=>{const _=[],C={};x.forEach(D=>{const M=s[D.name]||{};Object.values(D.fields).forEach(B=>{if(m(B,M)){const q=M[B.id],Q=v(B,q);if(Q){const J=`${D.name}.${B.id}`;C[J]=Q,_.push({field:B.id,section:D.name,message:Q,type:B.required&&(!q||q==="")?"required":"pattern"})}}})}),(o.length===0||o.every(D=>!D.description))&&(C.items="En az bir fatura kalemi eklemelisiniz",_.push({field:"items_list",section:"items",message:"En az bir fatura kalemi eklemelisiniz",type:"required"})),d(C);const F={isValid:_.length===0,errors:_,warnings:[]};return t&&t(F),F},y=(_,C,F)=>{i(M=>({...M,[_]:{...M[_],[C]:F}}));const D=`${_}.${C}`;h(M=>({...M,[D]:!0})),c[D]&&d(M=>{const B={...M};return delete B[D],B})},w=_=>{i(C=>({invoiceType:_,scenario:C.scenario}))},S=(_,C,F)=>{l(D=>{const M=[...D];if(M[_]={...M[_],[C]:F},C==="quantity"||C==="unitPrice"||C==="taxRate"){const B=M[_],q=B.quantity*B.unitPrice,Q=q*(B.taxRate/100);M[_].total=q+Q}return M})},A=()=>{l(_=>[..._,{id:Date.now().toString(),description:"",quantity:1,unitPrice:0,taxRate:18,total:0}])},T=_=>{o.length>1&&l(C=>C.filter((F,D)=>D!==_))},b=_=>{if(_.preventDefault(),g().isValid){const F={...s,items:o.filter(D=>D.description.trim()!=="")};e(F)}};V.useEffect(()=>{g()},[s,o,x]);const k=(_,C)=>{var J;const F=s[_.name]||{},D=F[C.id]||C.defaultValue||"",M=`${_.name}.${C.id}`,B=c[M]&&f[M];if(!m(C,F))return null;const q={id:C.id,name:C.id,value:D,disabled:n,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${B?"border-red-500":"border-gray-300"}`,placeholder:C.placeholder,onChange:P=>{const Z=C.type==="checkbox"?P.target.checked:C.type==="number"?parseFloat(P.target.value)||0:P.target.value;y(_.name,C.id,Z)}};let Q;switch(C.type){case"select":Q=u.jsxs(Tt,{...q,children:[u.jsx("option",{value:"",children:"Seiniz..."}),(J=C.options)==null?void 0:J.map(P=>u.jsx("option",{value:P.value,disabled:P.disabled,children:P.text},P.value))]});break;case"textarea":Q=u.jsx(sp,{...q,rows:3});break;case"checkbox":Q=u.jsx(Ie,{type:"checkbox",id:C.id,name:C.id,checked:!!D,disabled:n,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500",onChange:P=>y(_.name,C.id,P.target.checked)});break;default:Q=u.jsx(Ie,{type:C.type,...q})}return u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{htmlFor:C.id,className:"block text-sm font-medium text-gray-700 mb-1",children:[C.label,C.required&&u.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),C.type==="checkbox"?u.jsxs("div",{className:"flex items-center",children:[Q,u.jsx("label",{htmlFor:C.id,className:"ml-2 text-sm text-gray-700",children:C.label})]}):Q,C.helpText&&u.jsx("p",{className:"mt-1 text-xs text-gray-500",children:C.helpText}),B&&u.jsx("p",{className:"mt-1 text-xs text-red-500",children:c[M]})]},C.id)},E=V.useMemo(()=>{const _=o.reduce((D,M)=>D+M.quantity*M.unitPrice,0),C=o.reduce((D,M)=>{const B=M.quantity*M.unitPrice;return D+B*(M.taxRate/100)},0),F=_+C;return{subtotal:_,totalTax:C,total:F}},[o]);return u.jsxs("form",{onSubmit:b,className:`space-y-6 ${a}`,children:[u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Fatura Tipi"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(nf.invoiceTypes).map(([_,C])=>u.jsxs("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[u.jsx(Ie,{type:"radio",name:"invoiceType",value:_,checked:s.invoiceType===_,onChange:F=>w(F.target.value),disabled:n,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"}),u.jsxs("div",{className:"ml-3",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.name}),C.description&&u.jsx("div",{className:"text-xs text-gray-500",children:C.description})]})]},_))})]}),u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Senaryo"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(nf.scenarios).filter(([_,C])=>C.applicableTypes.includes(s.invoiceType)).map(([_,C])=>u.jsxs("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[u.jsx(Ie,{type:"radio",name:"scenario",value:_,checked:s.scenario===_,onChange:F=>y("","scenario",F.target.value),disabled:n,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"}),u.jsxs("div",{className:"ml-3",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.name}),C.description&&u.jsx("div",{className:"text-xs text-gray-500",children:C.description})]})]},_))})]}),x.map(_=>u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:_.title}),_.description&&u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:_.description}),_.name==="items"?u.jsxs("div",{className:"space-y-4",children:[o.map((C,F)=>u.jsx("div",{className:"p-4 border rounded-lg bg-gray-50",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[u.jsxs("div",{className:"md:col-span-2",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Aklama ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx(Ie,{type:"text",value:C.description,onChange:D=>S(F,"description",D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"rn/hizmet aklamas",disabled:n})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Miktar ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx(Ie,{type:"number",min:"1",value:C.quantity,onChange:D=>S(F,"quantity",parseFloat(D.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:n})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Birim Fiyat ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx(Ie,{type:"number",min:"0",step:"0.01",value:C.unitPrice,onChange:D=>S(F,"unitPrice",parseFloat(D.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:n})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"KDV (%)"}),u.jsxs(Tt,{value:C.taxRate,onChange:D=>S(F,"taxRate",parseFloat(D.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:n,children:[u.jsx("option",{value:0,children:"0%"}),u.jsx("option",{value:1,children:"1%"}),u.jsx("option",{value:8,children:"8%"}),u.jsx("option",{value:18,children:"18%"})]})]}),u.jsxs("div",{className:"flex items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Toplam"}),u.jsx("div",{className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-md text-right",children:Yn.formatTurkishCurrency(C.total)})]}),o.length>1&&u.jsx(Te,{type:"button",onClick:()=>T(F),className:"ml-2 p-2 text-red-600 hover:text-red-800 focus:outline-none",disabled:n,variant:"default",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},C.id)),u.jsx(Te,{type:"button",onClick:A,className:"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-gray-400 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:n,variant:"default",children:"+ Yeni Kalem Ekle"}),c.items&&u.jsx("p",{className:"text-sm text-red-500",children:c.items}),u.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{children:"Ara Toplam:"}),u.jsx("span",{children:Yn.formatTurkishCurrency(E.subtotal)})]}),u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{children:"KDV:"}),u.jsx("span",{children:Yn.formatTurkishCurrency(E.totalTax)})]}),u.jsxs("div",{className:"flex justify-between text-lg font-semibold border-t pt-2",children:[u.jsx("span",{children:"Genel Toplam:"}),u.jsx("span",{children:Yn.formatTurkishCurrency(E.total)})]})]})})]}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(_.fields).map(C=>k(_,C))})]},_.name)),u.jsx("div",{className:"flex justify-end space-x-4",children:u.jsx(Te,{type:"submit",disabled:n||Object.keys(c).length>0,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:"Fatura Olutur"})})]})};function bE({initialViewMode:e="list"}={}){var y,w;const[t,r]=V.useState(null),[n,a]=V.useState({}),[s,i]=V.useState(e),[o,l]=V.useState(!1),c=S=>{r(S),i("details")},d=()=>{r(null),i("form")},f=S=>{r(S),i("form")},h=()=>{r(null),i("list")},p=S=>{a(A=>({...A,...S}))},x=()=>{a({})},m=S=>{var F,D,M,B;const{invoiceType:A,scenario:T,items:b,...k}=S;let E={};A==="individual"&&k.customer_info?E={type:"individual",firstName:k.customer_info.first_name,lastName:k.customer_info.last_name,tcNumber:k.customer_info.tc_number,email:k.customer_info.email,phone:k.customer_info.phone,address:{street:k.customer_info.address,city:k.customer_info.city,postalCode:k.customer_info.postal_code}}:A==="corporate"&&k.company_info?E={type:"corporate",companyName:k.company_info.company_name,taxNumber:k.company_info.tax_number,taxOffice:k.company_info.tax_office,contactPerson:k.company_info.contact_person,email:k.company_info.email,phone:k.company_info.phone,address:{street:k.company_info.address,city:k.company_info.city,postalCode:k.company_info.postal_code}}:A==="export"&&k.export_info&&(E={type:"export",companyName:k.export_info.company_name,country:k.export_info.country,currency:k.export_info.currency,exchangeRate:k.export_info.exchange_rate,address:{street:k.export_info.address}});const _=k.invoice_details||{},C=(b==null?void 0:b.map(q=>({name:q.description||q.name||"rn/Hizmet",description:q.description,quantity:q.quantity,unitPrice:q.unitPrice,taxRate:q.taxRate})))||[];return k.device_info&&(k.device_info.device_brand,k.device_info.device_model,k.device_info.device_serial,k.device_info.device_side,k.device_info.warranty_period),(F=k.sgk_info)!=null&&F.has_sgk_coverage&&(k.sgk_info.sgk_number,k.sgk_info.sgk_institution,k.sgk_info.sgk_coverage_rate),{type:A,patientName:E.firstName?`${E.firstName} ${E.lastName}`:E.companyName||"Mteri",patientId:E.id,patientPhone:E.phone,patientTcNumber:E.tcNumber,billingAddress:{name:E.firstName?`${E.firstName} ${E.lastName}`:E.companyName||"Mteri",address:((D=E.address)==null?void 0:D.street)||"",city:((M=E.address)==null?void 0:M.city)||"",postalCode:((B=E.address)==null?void 0:B.postalCode)||"",taxNumber:E.taxNumber,taxOffice:E.taxOffice},issueDate:_.invoice_date||new Date().toISOString().split("T")[0],dueDate:_.due_date,paymentMethod:_.payment_method,notes:_.notes,items:C}},v=async S=>{try{let A;if(t){const T=m(S);A=await Ea.updateInvoice(t.id,T)}else{const T=m(S);A=await Ea.createInvoice(T)}h(),console.log("Invoice saved successfully:",A)}catch(A){console.error("Error submitting invoice:",A)}},g=Object.keys(n).some(S=>{const A=n[S];return A!=null&&A!==""});return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center py-6",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[s!=="list"&&u.jsx(Te,{variant:"outline",onClick:h,icon:u.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),iconPosition:"left",children:"Geri"}),u.jsxs("div",{children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[s==="list"&&"Satlar",s==="form"&&(t?"Fatura Dzenle":"Yeni Fatura"),s==="details"&&"Fatura Detaylar"]}),s==="list"&&u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Sat faturalarnz ynetin ve takip edin"})]})]}),s==="list"&&u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsxs(Te,{variant:g?"secondary":"outline",onClick:()=>l(!o),icon:u.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),iconPosition:"left",children:["Filtrele",g&&u.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Aktif"})]}),u.jsx(Te,{variant:"primary",onClick:d,icon:u.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),iconPosition:"left",children:"Yeni Fatura"})]})]})})}),s==="list"&&o&&u.jsx("div",{className:"bg-white border-b border-gray-200",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durum"}),u.jsxs(Tt,{value:((y=n.status)==null?void 0:y[0])||"",onChange:S=>p({status:S.target.value?[S.target.value]:void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[u.jsx("option",{value:"",children:"Tm Durumlar"}),u.jsx("option",{value:"draft",children:"Taslak"}),u.jsx("option",{value:"sent",children:"Gnderildi"}),u.jsx("option",{value:"paid",children:"dendi"}),u.jsx("option",{value:"overdue",children:"Vadesi Geti"}),u.jsx("option",{value:"cancelled",children:"ptal"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tip"}),u.jsxs(Tt,{value:((w=n.type)==null?void 0:w[0])||"",onChange:S=>p({type:S.target.value?[S.target.value]:void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[u.jsx("option",{value:"",children:"Tm Tipler"}),u.jsx("option",{value:"sale",children:"Sat"}),u.jsx("option",{value:"service",children:"Hizmet"}),u.jsx("option",{value:"proforma",children:"Proforma"}),u.jsx("option",{value:"sgk",children:"SGK"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Balang Tarihi"}),u.jsx(Ie,{type:"date",value:n.issueDateFrom||"",onChange:S=>p({issueDateFrom:S.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biti Tarihi"}),u.jsx(Ie,{type:"date",value:n.issueDateTo||"",onChange:S=>p({issueDateTo:S.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),g&&u.jsx("div",{className:"mt-4 flex justify-end",children:u.jsx(Te,{variant:"outline",onClick:x,children:"Filtreleri Temizle"})})]})}),u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s==="list"&&u.jsx(m7,{onInvoiceSelect:c,filters:n,showActions:!0}),s==="form"&&u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t?"Fatura Dzenle":"Yeni Fatura Olutur"})}),u.jsx("div",{className:"p-6",children:u.jsx(p7,{onSubmit:v,initialData:t?{type:t.type,patientName:t.patientName,patientPhone:t.patientPhone,patientTcNumber:t.patientTcNumber,billingAddress:t.billingAddress,issueDate:t.issueDate,dueDate:t.dueDate,paymentMethod:t.paymentMethod,notes:t.notes,items:t.items,subtotal:t.subtotal,totalDiscount:t.totalDiscount,totalTax:t.totalTax,grandTotal:t.grandTotal,currency:t.currency||"TRY",autoCalculateTax:!0}:void 0})})]}),s==="details"&&t&&u.jsx(x7,{invoice:t,onEdit:()=>f(t)})]})]})}function x7({invoice:e,onEdit:t}){var i,o,l,c;const r=d=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(d),n=d=>new Date(d).toLocaleDateString("tr-TR"),a=d=>{switch(d){case"draft":return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"paid":return"bg-green-100 text-green-800";case"overdue":return"bg-red-100 text-red-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},s=d=>{switch(d){case"draft":return"Taslak";case"sent":return"Gnderildi";case"paid":return"dendi";case"overdue":return"Vadesi Geti";case"cancelled":return"ptal";default:return d}};return u.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[u.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["Fatura #",e.invoiceNumber]}),u.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:[n(e.createdAt)," tarihinde oluturuldu"]})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${a(e.status)}`,children:s(e.status)}),u.jsx(Te,{variant:"outline",onClick:t,children:"Dzenle"})]})]})}),u.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Mteri Bilgileri"}),u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Ad Soyad"}),u.jsx("dd",{className:"text-sm text-gray-900",children:e.patientName})]}),e.patientPhone&&u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Telefon"}),u.jsx("dd",{className:"text-sm text-gray-900",children:e.patientPhone})]}),e.patientTcNumber&&u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"TC Kimlik No"}),u.jsx("dd",{className:"text-sm text-gray-900",children:e.patientTcNumber})]})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Fatura Adresi"}),u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Adres"}),u.jsx("dd",{className:"text-sm text-gray-900",children:((i=e.billingAddress)==null?void 0:i.address)||"N/A"})]}),u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"ehir"}),u.jsx("dd",{className:"text-sm text-gray-900",children:((o=e.billingAddress)==null?void 0:o.city)||"N/A"})]}),((l=e.billingAddress)==null?void 0:l.taxNumber)&&u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Vergi No"}),u.jsx("dd",{className:"text-sm text-gray-900",children:(c=e.billingAddress)==null?void 0:c.taxNumber})]})]})]})]}),u.jsxs("div",{className:"mt-8",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Fatura Kalemleri"}),u.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"rn/Hizmet"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Miktar"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Birim Fiyat"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"KDV"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Toplam"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.items.map(d=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.name}),d.description&&u.jsx("div",{className:"text-sm text-gray-500",children:d.description})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.quantity}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r(d.unitPrice)}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["%",d.taxRate]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r(d.totalPrice)})]},d.id))})]})})]}),u.jsx("div",{className:"mt-6 flex justify-end",children:u.jsx("div",{className:"w-full max-w-md",children:u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("dt",{className:"text-sm text-gray-500",children:"Ara Toplam"}),u.jsx("dd",{className:"text-sm text-gray-900",children:r(e.subtotal)})]}),e.totalDiscount>0&&u.jsxs("div",{className:"flex justify-between",children:[u.jsx("dt",{className:"text-sm text-gray-500",children:"ndirim"}),u.jsxs("dd",{className:"text-sm text-gray-900",children:["-",r(e.totalDiscount)]})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("dt",{className:"text-sm text-gray-500",children:"KDV"}),u.jsx("dd",{className:"text-sm text-gray-900",children:r(e.totalTax)})]}),u.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2",children:[u.jsx("dt",{className:"text-base font-medium text-gray-900",children:"Genel Toplam"}),u.jsx("dd",{className:"text-base font-medium text-gray-900",children:r(e.grandTotal)})]})]})})}),e.notes&&u.jsxs("div",{className:"mt-6",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Notlar"}),u.jsx("p",{className:"text-sm text-gray-700",children:e.notes})]})]})]})}const g7=zr("/invoices/")({component:bE}),v7=(e,t={})=>{const{enableRealTimeSync:r=!0,cacheEnabled:n=!0,autoRefresh:a=!1,refreshInterval:s=3e4}=t,[i,o]=V.useState(null),[l,c]=V.useState(!0),[d,f]=V.useState(!1),[h,p]=V.useState(!1),[x,m]=V.useState(null);V.useEffect(()=>{if(!e){o(null),c(!1);return}(async()=>{try{if(c(!0),m(null),n){const B=await er.getCachedPatient(e);B&&(o(B),c(!1))}const M=await Mt.getPatient(e);M?o(M):m("Patient not found")}catch(M){console.error("Failed to load patient:",M),m(M instanceof Error?M.message:"Failed to load patient")}finally{c(!1)}})()},[e,n]),V.useEffect(()=>{if(!a||!e)return;const D=setInterval(async()=>{try{const M=await Mt.getPatient(e);M&&o(M)}catch(M){console.error("Auto refresh failed:",M)}},s);return()=>clearInterval(D)},[a,s,e]),V.useEffect(()=>{if(!r||!e)return;const D=M=>{M.key===`patient_${e}`&&Mt.getPatient(e).then(B=>{B&&o(B)})};return window.addEventListener("storage",D),()=>window.removeEventListener("storage",D)},[r,e]);const v=V.useCallback(async D=>{if(!e||!i)throw new Error("No patient loaded");try{f(!0),m(null);const M=await Mt.updatePatient(e,D);if(!M)throw new Error("Failed to update patient");return o(M),n&&await er.updateCachedPatient(M),r&&await xl.syncSinglePatient(e),M}catch(M){throw console.error("Failed to update patient:",M),m(M instanceof Error?M.message:"Failed to update patient"),M}finally{f(!1)}},[e,i,n,r]),g=V.useCallback(async()=>{if(!e)throw new Error("No patient loaded");try{if(f(!0),m(null),!await Mt.deletePatient(e))throw new Error("Failed to delete patient");o(null),n&&await er.removeCachedPatient(e)}catch(D){throw console.error("Failed to delete patient:",D),m(D instanceof Error?D.message:"Failed to delete patient"),D}finally{f(!1)}},[e,n]),y=V.useCallback(async D=>{if(!e)throw new Error("No patient loaded");try{m(null);const M=await Mt.addDevice(e,D);if(!M)throw new Error("Failed to add device");if(i){const B={...i,devices:[...i.devices||[],M]};o(B),n&&await er.updateCachedPatient(B)}return M}catch(M){throw console.error("Failed to add device:",M),m(M instanceof Error?M.message:"Failed to add device"),M}},[e,i,n]),w=V.useCallback(async(D,M)=>{if(!e)throw new Error("No patient loaded");try{m(null);const B=await Mt.updateDevice(e,D,M);if(!B)throw new Error("Failed to update device");if(i){const q={...i,devices:(i.devices||[]).map(Q=>Q.id===D?B:Q)};o(q),n&&await er.updateCachedPatient(q)}return B}catch(B){throw console.error("Failed to update device:",B),m(B instanceof Error?B.message:"Failed to update device"),B}},[e,i,n]),S=V.useCallback(async D=>{if(!e||!i)throw new Error("No patient loaded");try{m(null);const M={...i,devices:(i.devices||[]).filter(B=>B.id!==D)};o(M),n&&await er.updateCachedPatient(M)}catch(M){throw console.error("Failed to remove device:",M),m(M instanceof Error?M.message:"Failed to remove device"),M}},[e,i,n]),A=V.useCallback(async(D,M="general")=>{if(!e)throw new Error("No patient loaded");try{m(null);const B=await Mt.addNote(e,D,M);if(!B)throw new Error("Failed to add note");if(i){const q={...i,notes:[...i.notes||[],B]};o(q),n&&await er.updateCachedPatient(q)}return B}catch(B){throw console.error("Failed to add note:",B),m(B instanceof Error?B.message:"Failed to add note"),B}},[e,i,n]),T=V.useCallback(async(D,M)=>{var B;if(!e||!i)throw new Error("No patient loaded");try{m(null);const q=(B=i.notes)==null?void 0:B.find(P=>P.id===D);if(!q)throw new Error("Note not found");const Q={...q,...M,date:new Date().toISOString()},J={...i,notes:(i.notes||[]).map(P=>P.id===D?Q:P)};return o(J),n&&await er.updateCachedPatient(J),Q}catch(q){throw console.error("Failed to update note:",q),m(q instanceof Error?q.message:"Failed to update note"),q}},[e,i,n]),b=V.useCallback(async D=>{if(!e||!i)throw new Error("No patient loaded");try{m(null);const M={...i,notes:(i.notes||[]).filter(B=>B.id!==D)};o(M),n&&await er.updateCachedPatient(M)}catch(M){throw console.error("Failed to remove note:",M),m(M instanceof Error?M.message:"Failed to remove note"),M}},[e,i,n]),k=V.useCallback(async D=>{if(!e)throw new Error("No patient loaded");try{m(null);const M=await Mt.addCommunication(e,D);if(!M)throw new Error("Failed to add communication");if(i){const B={...i,communications:[...i.communications||[],M]};o(B),n&&await er.updateCachedPatient(B)}return M}catch(M){throw console.error("Failed to add communication:",M),m(M instanceof Error?M.message:"Failed to add communication"),M}},[e,i,n]),E=V.useCallback(async()=>{if(e)try{c(!0),m(null);const D=await Mt.getPatient(e);D?o(D):m("Patient not found")}catch(D){console.error("Failed to refresh patient:",D),m(D instanceof Error?D.message:"Failed to refresh patient")}finally{c(!1)}},[e]),_=V.useCallback(async()=>{if(e)try{if(p(!0),m(null),!await xl.syncSinglePatient(e))throw new Error("Sync failed");await E()}catch(D){console.error("Failed to sync patient:",D),m(D instanceof Error?D.message:"Failed to sync patient")}finally{p(!1)}},[e,E]),C=V.useCallback(D=>{const M=D||i;if(!M)return{isValid:!1,errors:["No patient data to validate"]};const B=Kh.validatePatient(M);return{isValid:B.isValid,errors:B.errors.map(q=>q.message)}},[i]),F=V.useCallback(()=>i?Mt.calculatePriorityScore(i):0,[i]);return{patient:i,isLoading:l,isSaving:d,isSyncing:h,error:x,updatePatient:v,deletePatient:g,addDevice:y,updateDevice:w,removeDevice:S,addNote:A,updateNote:T,removeNote:b,addCommunication:k,refreshPatient:E,syncPatient:_,validatePatient:C,calculatePriorityScore:F}},y7=({patient:e,isLoading:t})=>{if(t||!e)return u.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200 p-6",children:u.jsx("div",{className:"animate-pulse",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-16 h-16 bg-gray-300 rounded-full"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"h-6 bg-gray-300 rounded w-48 mb-2"}),u.jsx("div",{className:"h-4 bg-gray-300 rounded w-32"})]})]})})});const r=(s,i)=>`${s.charAt(0)}${i.charAt(0)}`.toUpperCase(),n=s=>s?new Date(s).toLocaleDateString("tr-TR"):"N/A",a=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return u.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200 p-6",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-xl font-semibold",children:r(e.firstName,e.lastName)}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[e.firstName," ",e.lastName]}),u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a(e.status)}`,children:e.status==="active"?"Aktif":"Pasif"})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(io,{className:"w-4 h-4"}),u.jsxs("span",{children:["TC: ",e.tcNumber]})]}),e.phone&&u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(xA,{className:"w-4 h-4"}),u.jsx("span",{children:e.phone})]}),e.email&&u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(Kw,{className:"w-4 h-4"}),u.jsx("span",{children:e.email})]}),e.birthDate&&u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(hc,{className:"w-4 h-4"}),u.jsxs("span",{children:["Doum: ",n(e.birthDate)]})]})]}),(e.addressCity||e.addressDistrict||e.addressFull)&&u.jsxs("div",{className:"flex items-center space-x-1 mt-2 text-sm text-gray-600",children:[u.jsx(Gw,{className:"w-4 h-4"}),u.jsx("span",{children:e.addressFull||`${e.addressDistrict||""} ${e.addressCity||""}`.trim()})]})]})]}),u.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[e.tags&&e.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-1",children:e.tags.map((s,i)=>u.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[u.jsx(Xw,{className:"w-3 h-3 mr-1"}),s]},i))}),e.segment&&u.jsxs("div",{className:"text-sm text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Segment:"})," ",e.segment]}),e.acquisitionType&&u.jsxs("div",{className:"text-sm text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Kaynak:"})," ",e.acquisitionType]})]})]})})},w7=[{id:"overview",label:"Genel Bak",icon:u.jsx(io,{className:"w-4 h-4"})},{id:"appointments",label:"Randevular",icon:u.jsx(hc,{className:"w-4 h-4"})},{id:"devices",label:"Cihazlar",icon:u.jsx(Ww,{className:"w-4 h-4"})},{id:"sales",label:"Satlar",icon:u.jsx(zw,{className:"w-4 h-4"})},{id:"documents",label:"Belgeler",icon:u.jsx(lp,{className:"w-4 h-4"})},{id:"timeline",label:"Zaman izelgesi",icon:u.jsx(W0,{className:"w-4 h-4"})},{id:"tests",label:"itme Testleri",icon:u.jsx(Bw,{className:"w-4 h-4"})},{id:"settings",label:"Ayarlar",icon:u.jsx(xh,{className:"w-4 h-4"})}],k7=({activeTab:e,onTabChange:t,tabs:r=w7})=>u.jsx("div",{className:"bg-white border-b border-gray-200",children:u.jsx("div",{className:"px-6",children:u.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:r.map(n=>u.jsxs("button",{onClick:()=>t(n.id),className:`
                group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap
                ${e===n.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
              `,"aria-current":e===n.id?"page":void 0,children:[u.jsx("span",{className:`
                mr-2 
                ${e===n.id?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}
              `,children:n.icon}),n.label,n.count!==void 0&&u.jsx("span",{className:`
                  ml-2 py-0.5 px-2 rounded-full text-xs
                  ${e===n.id?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-900"}
                `,children:n.count})]},n.id))})})}),S7=({activeTab:e,patient:t,isLoading:r})=>{if(r||!t)return u.jsx("div",{className:"p-6",children:u.jsxs("div",{className:"animate-pulse space-y-4",children:[u.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),u.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),u.jsx("div",{className:"h-4 bg-gray-300 rounded w-2/3"})]})});const n=i=>i?new Date(i).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"}):"Belirtilmemi",a=()=>u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(io,{className:"w-5 h-5 mr-2"}),"Kiisel Bilgiler"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ad Soyad"}),u.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[t.firstName," ",t.lastName]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"TC Kimlik No"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.tcNumber})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telefon"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.phone||"Belirtilmemi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"E-posta"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.email||"Belirtilmemi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Doum Tarihi"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:n(t.birthDate)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cinsiyet"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.gender==="M"?"Erkek":t.gender==="F"?"Kadn":"Belirtilmemi"})]})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(Gw,{className:"w-5 h-5 mr-2"}),"Adres Bilgileri"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ehir"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.addressCity||"Belirtilmemi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"le"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.addressDistrict||"Belirtilmemi"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tam Adres"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.addressFull||"Belirtilmemi"})]})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(Xw,{className:"w-5 h-5 mr-2"}),"Ek Bilgiler"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Durum"}),u.jsx("p",{className:"mt-1",children:u.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[t.status==="active"?u.jsx(H0,{className:"w-3 h-3 mr-1"}):u.jsx(ip,{className:"w-3 h-3 mr-1"}),t.status==="active"?"Aktif":"Pasif"]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Segment"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.segment||"Belirtilmemi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Edinim Tr"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.acquisitionType||"Belirtilmemi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ncelik Skoru"}),u.jsx("p",{className:"mt-1 text-sm text-gray-900",children:t.priorityScore||"Belirtilmemi"})]})]}),t.tags&&t.tags.length>0&&u.jsxs("div",{className:"mt-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Etiketler"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((i,o)=>u.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:i},o))})]})]})]}),s=i=>u.jsx("div",{className:"p-6 text-center",children:u.jsxs("div",{className:"max-w-sm mx-auto",children:[u.jsx(W0,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:[i," Yaknda Gelecek"]}),u.jsx("p",{className:"text-gray-500",children:"Bu zellik u anda gelitirme aamasnda. Yaknda kullanma sunulacak."})]})});switch(e){case"overview":return a();case"appointments":return s("Randevular");case"devices":return s("Cihazlar");case"sales":return s("Satlar");case"documents":return s("Belgeler");case"timeline":return s("Zaman izelgesi");case"tests":return s("itme Testleri");case"settings":return s("Ayarlar");default:return a()}},E7={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8",xl:"h-12 w-12"},_7={sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl"},b7=({size:e="md",text:t,className:r="",fullScreen:n=!1})=>{const a=u.jsxs("div",{className:`flex flex-col items-center justify-center ${r}`,children:[u.jsx(iA,{className:`${E7[e]} animate-spin text-blue-600`}),t&&u.jsx("p",{className:`mt-2 text-gray-600 ${_7[e]}`,children:t})]});return n?u.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:a}):a},T7=()=>{var d,f;const{patientId:e}=fc({strict:!1}),t=mo(),{showError:r}=dF(),[n,a]=V.useState(()=>localStorage.getItem(pv)||"overview"),{data:s,isLoading:i,error:o}=v7(e||"");V.useEffect(()=>{o&&r("Hasta bilgileri yklenirken bir hata olutu")},[o,r]);const l=h=>{a(h),localStorage.setItem(pv,h)},c=()=>{t({to:"/patients"})};return e?i?u.jsx(b7,{size:"xl",text:"Hasta bilgileri ykleniyor...",fullScreen:!0}):o?((d=o==null?void 0:o.message)==null?void 0:d.includes("network"))||((f=o==null?void 0:o.message)==null?void 0:f.includes("fetch"))?u.jsx(CA,{onRetry:()=>window.location.reload()}):u.jsx(K0,{type:"error",title:"Hasta Bulunamad",message:"Hasta bilgileri yklenirken bir hata olutu veya hasta bulunamad.",onRetry:()=>window.location.reload(),onDismiss:c,retryText:"Tekrar Dene"}):u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:u.jsxs("button",{onClick:c,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[u.jsx(GN,{className:"w-4 h-4 mr-2"}),"Hasta Listesine Dn"]})}),u.jsx(y7,{patient:s,isLoading:i}),u.jsx(k7,{activeTab:n,onTabChange:l}),u.jsx("div",{className:"bg-white",children:u.jsx(S7,{patient:s,activeTab:n,isLoading:i})})]}):u.jsx(NA,{resource:"hasta ID"})},C7=zr("/patients/$patientId")({component:T7,loader:async({params:e})=>{if(!e.patientId)throw new Error("Patient ID is required");return{patientId:e.patientId}},errorComponent:({error:e})=>u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-gray-200 max-w-md w-full text-center",children:[u.jsx("div",{className:"text-red-500 mb-4",children:u.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Hasta Bulunamad"}),u.jsx("p",{className:"text-gray-600 mb-4",children:(e==null?void 0:e.message)||"Belirtilen hasta bulunamad veya eriim izniniz yok."}),u.jsx("a",{href:"/patients",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Hasta Listesine Dn"})]})})});class N7{async loadPurchases(){try{const t=localStorage.getItem(Ev);if(!t){const r=this.createSamplePurchases();return await this.savePurchases(r),r}return JSON.parse(t)}catch(t){return console.error("Error loading purchases:",t),[]}}async savePurchases(t){try{localStorage.setItem(Ev,JSON.stringify(t))}catch(r){throw console.error("Error saving purchases:",r),r}}createSamplePurchases(){return[{id:"purchase-1",purchaseNumber:"AL202401001",type:"standard",status:"approved",supplierName:"ABC Medikal Ltd.",supplierTaxNumber:"1234567890",supplierAddress:"stanbul, Trkiye",supplierPhone:"+90 212 123 45 67",supplierEmail:"info@abcmedikal.com",issueDate:"2024-01-15",dueDate:"2024-02-15",paymentMethod:"Kredi Kart",items:this.createSamplePurchaseItems(),subtotal:8500,taxTotal:1530,grandTotal:10030,notes:"Acil sipari",xmlData:"<xml>sample xml data</xml>",xmlFileName:"AL202401001.xml",xmlImportDate:"2024-01-15T10:30:00Z",createdAt:"2024-01-15T10:30:00Z"}]}createSamplePurchaseItems(){return[{id:"item-1",name:"Dijital Termometre",description:"Infrared dijital termometre",quantity:10,unitPrice:850,taxRate:18,taxAmount:153,totalPrice:1003,unit:"adet",productCode:"TERM001",barcode:"1234567890123"}]}async createPurchase(t){try{const r=t.items.map(i=>({...i,id:this.generateId(),taxAmount:i.quantity*i.unitPrice*(i.taxRate/100),totalPrice:i.quantity*i.unitPrice*(1+i.taxRate/100)})),n=this.calculatePurchase(r),a={id:this.generateId(),purchaseNumber:this.generatePurchaseNumber(),status:"draft",type:t.type,supplierName:t.supplierName,supplierTaxNumber:t.supplierTaxNumber,supplierAddress:t.supplierAddress,supplierPhone:t.supplierPhone,supplierEmail:t.supplierEmail,issueDate:t.issueDate,dueDate:t.dueDate,paymentMethod:t.paymentMethod,items:r,subtotal:n.subtotal,taxTotal:n.totalTax,grandTotal:n.totalAmount,notes:t.notes,internalNotes:t.internalNotes,referenceNumber:t.referenceNumber,orderNumber:t.orderNumber,xmlData:t.xmlData,xmlFileName:t.xmlFileName,xmlImportDate:t.xmlData?new Date().toISOString():void 0,createdAt:new Date().toISOString()},s=await this.loadPurchases();return s.push(a),await this.savePurchases(s),await pr.addOperation({method:"POST",endpoint:"/api/purchases",data:a}),a}catch(r){throw console.error("Error creating purchase:",r),r}}async updatePurchase(t,r){try{const n=await this.loadPurchases(),a=n.findIndex(o=>o.id===t);if(a===-1)throw new Error("Purchase not found");let s=n[a].items;r.items&&(s=r.items.map(o=>({...o,id:this.generateId(),taxAmount:o.quantity*o.unitPrice*(o.taxRate/100),totalPrice:o.quantity*o.unitPrice*(1+o.taxRate/100)})));const i={...n[a],...r,items:s,updatedAt:new Date().toISOString(),updatedBy:"current-user"};return n[a]=i,await this.savePurchases(n),await pr.addOperation({method:"PUT",endpoint:`/api/purchases/${t}`,data:i}),i}catch(n){throw console.error("Error updating purchase:",n),n}}async deletePurchase(t){try{const n=(await this.loadPurchases()).filter(a=>a.id!==t);await this.savePurchases(n),await pr.addOperation({method:"DELETE",endpoint:`/api/purchases/${t}`,data:{id:t}})}catch(r){throw console.error("Error deleting purchase:",r),r}}async searchPurchases(t={}){try{let n=[...await this.loadPurchases()];if(t.search){const c=t.search.toLowerCase();n=n.filter(d=>{var f;return d.purchaseNumber.toLowerCase().includes(c)||d.supplierName.toLowerCase().includes(c)||((f=d.notes)==null?void 0:f.toLowerCase().includes(c))})}t.status&&(n=n.filter(c=>c.status===t.status)),t.type&&(n=n.filter(c=>c.type===t.type)),t.supplierName&&(n=n.filter(c=>c.supplierName.toLowerCase().includes(t.supplierName.toLowerCase()))),t.hasXmlData!==void 0&&(n=n.filter(c=>t.hasXmlData?!!c.xmlData:!c.xmlData));const a=t.page||1,s=t.limit||10,i=(a-1)*s,o=i+s;return{purchases:n.slice(i,o),total:n.length,totalPages:Math.ceil(n.length/s),page:a,pageSize:s,limit:s,hasMore:o<n.length,filters:t}}catch(r){throw console.error("Error searching purchases:",r),r}}async getPurchaseById(t){try{return(await this.loadPurchases()).find(n=>n.id===t)||null}catch(r){return console.error("Error getting purchase by ID:",r),null}}async getPurchaseStats(){try{const t=await this.loadPurchases();return{total:t.length,draft:t.filter(n=>n.status==="draft").length,sent:t.filter(n=>n.status==="sent").length,approved:t.filter(n=>n.status==="approved").length,rejected:t.filter(n=>n.status==="rejected").length,paid:t.filter(n=>n.status==="paid").length,cancelled:t.filter(n=>n.status==="cancelled").length,totalAmount:t.reduce((n,a)=>n+a.grandTotal,0),xmlImported:t.filter(n=>!!n.xmlData).length}}catch(t){throw console.error("Error getting purchase stats:",t),t}}async importFromXML(t,r){try{const n=this.parseXMLToPurchaseData(t,r);return await this.createPurchase({...n,xmlData:t,xmlFileName:r,xmlImportDate:new Date().toISOString()})}catch(n){throw console.error("Error importing from XML:",n),n}}parseXMLToPurchaseData(t,r){return{type:"standard",supplierName:"XML e Aktarlan Tedariki",issueDate:new Date().toISOString().split("T")[0],items:[{name:"XML e Aktarlan rn",quantity:1,unitPrice:100,taxRate:18}]}}calculatePurchase(t){const r=t.reduce((s,i)=>s+i.quantity*i.unitPrice,0),n=t.reduce((s,i)=>s+i.taxAmount,0),a=r+n;return{items:t,subtotal:r,totalTax:n,totalAmount:a}}validatePurchase(t){var a,s;const r=[],n=[];return(a=t.supplierName)!=null&&a.trim()||r.push("Tedariki ad gereklidir"),t.issueDate||r.push("Fatura tarihi gereklidir"),(!t.items||t.items.length===0)&&r.push("En az bir kalem gereklidir"),(s=t.items)==null||s.forEach((i,o)=>{var l;(l=i.name)!=null&&l.trim()||r.push(`${o+1}. kalem ad gereklidir`),i.quantity<=0&&r.push(`${o+1}. kalem miktar 0'dan byk olmaldr`),i.unitPrice<=0&&r.push(`${o+1}. kalem birim fiyat 0'dan byk olmaldr`)}),{isValid:r.length===0,errors:r,warnings:n}}generateId(){return`purchase-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}generatePurchaseNumber(){const t=new Date,r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`AL${r}${n}${a}${s}`}}const A7=new N7;function F7({onPurchaseSelect:e,filters:t={},showActions:r=!1,compact:n=!1}){const[a,s]=V.useState([]),[i,o]=V.useState(!0),[l,c]=V.useState(null),[d,f]=V.useState(null);V.useEffect(()=>{(async()=>{try{o(!0),c(null);const y=await A7.searchPurchases(t);s(y.purchases)}catch(y){c(y instanceof Error?y.message:"Al faturalar yklenirken hata olutu")}finally{o(!1)}})()},[t]);const h=g=>{f(g),e==null||e(g)},p=g=>new Date(g).toLocaleDateString("tr-TR"),x=g=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(g),m=g=>{switch(g){case"draft":return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"paid":return"bg-purple-100 text-purple-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},v=g=>{switch(g){case"draft":return"Taslak";case"sent":return"Gnderildi";case"approved":return"Onayland";case"rejected":return"Reddedildi";case"paid":return"dendi";case"cancelled":return"ptal";default:return g}};return i?u.jsxs("div",{className:"flex items-center justify-center py-12",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Al faturalar ykleniyor..."})]}):l?u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),u.jsxs("div",{className:"ml-3",children:[u.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Hata"}),u.jsx("div",{className:"mt-2 text-sm text-red-700",children:u.jsx("p",{children:l})})]})]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-center space-x-4",children:u.jsx("div",{className:"flex-1",children:u.jsx(Ie,{type:"text",placeholder:"Al faturas ara...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})})}),u.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:u.jsx("ul",{className:"divide-y divide-gray-200",children:a.length===0?u.jsx("li",{className:"px-6 py-8 text-center text-gray-500",children:u.jsxs("div",{className:"text-center",children:[u.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),u.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Al faturas bulunamad"}),u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Henz XML formatnda al faturas import edilmemi."})]})}):a.map(g=>u.jsx("li",{className:`px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors ${(d==null?void 0:d.id)===g.id?"bg-blue-50":""}`,onClick:()=>h(g),children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"flex-1 min-w-0",children:u.jsx("div",{className:"flex items-center space-x-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:g.purchaseNumber}),u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m(g.status)}`,children:v(g.status)}),g.xmlFileName&&u.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"XML"})]}),u.jsxs("div",{className:"mt-1 flex items-center space-x-4 text-sm text-gray-500",children:[u.jsx("span",{children:g.supplierName}),g.supplierTaxNumber&&u.jsxs("span",{children:["VN: ",g.supplierTaxNumber]}),u.jsx("span",{children:p(g.issueDate)}),g.dueDate&&u.jsxs("span",{children:["Vade: ",p(g.dueDate)]})]})]})})}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:x(g.grandTotal)}),u.jsxs("p",{className:"text-xs text-gray-500",children:[g.items.length," kalem"]})]}),r&&u.jsxs("div",{className:"flex items-center space-x-2",children:[g.status==="draft"&&u.jsx(Te,{className:"text-blue-600 hover:text-blue-900 text-sm font-medium",onClick:y=>{y.stopPropagation()},variant:"default",children:"Onayla"}),g.status==="approved"&&u.jsx(Te,{className:"text-green-600 hover:text-green-900 text-sm font-medium",onClick:y=>{y.stopPropagation()},variant:"default",children:"de"}),u.jsx(Te,{className:"text-gray-400 hover:text-gray-600",onClick:y=>{y.stopPropagation()},variant:"default",children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})})]})]})]})},g.id))})}),a.length>0&&u.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx(Te,{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",variant:"default",children:"nceki"}),u.jsx(Te,{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",variant:"default",children:"Sonraki"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Toplam ",u.jsx("span",{className:"font-medium",children:a.length})," al faturas"]})}),u.jsx("div",{children:u.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[u.jsx(Te,{className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:"nceki"}),u.jsx(Te,{className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",variant:"default",children:"Sonraki"})]})})]})]})]})}function P7(){const[e,t]=V.useState(null),[r,n]=V.useState({}),[a,s]=V.useState("list"),[i,o]=V.useState(!1),l=f=>{t(f),s("details")},c=f=>{t(f),s("form")},d=()=>{s("list"),t(null)};return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a!=="list"&&u.jsx("div",{className:"bg-white shadow",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsx("div",{className:"flex items-center justify-between h-16",children:u.jsxs(Te,{onClick:d,className:"flex items-center text-gray-600 hover:text-gray-900",variant:"default",children:[u.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Allar Listesine Dn"]})})})}),a==="list"&&u.jsx("div",{className:"bg-white shadow",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[u.jsx("div",{className:"md:flex md:items-center md:justify-between",children:u.jsx("div",{className:"flex-1 min-w-0",children:u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Allar"}),u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"XML formatnda gelen al faturalarn ynetin ve takip edin"})]})})}),u.jsx("div",{className:"mt-4 flex items-center justify-between",children:u.jsxs(Te,{onClick:()=>o(!i),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",variant:"default",children:[u.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),"Filtreler",i?u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),i&&u.jsx("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Durum"}),u.jsxs(Tt,{value:r.status||"",onChange:f=>n({...r,status:f.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[u.jsx("option",{value:"",children:"Tm"}),u.jsx("option",{value:"draft",children:"Taslak"}),u.jsx("option",{value:"sent",children:"Gnderildi"}),u.jsx("option",{value:"approved",children:"Onayland"}),u.jsx("option",{value:"rejected",children:"Reddedildi"}),u.jsx("option",{value:"paid",children:"dendi"}),u.jsx("option",{value:"cancelled",children:"ptal"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tedariki"}),u.jsx(Ie,{type:"text",value:r.supplierName||"",onChange:f=>n({...r,supplierName:f.target.value||void 0}),placeholder:"Tedariki ad...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Balang Tarihi"}),u.jsx(Ie,{type:"date",value:r.dateFrom||"",onChange:f=>n({...r,dateFrom:f.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biti Tarihi"}),u.jsx(Ie,{type:"date",value:r.dateTo||"",onChange:f=>n({...r,dateTo:f.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})})]})}),u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a==="list"&&u.jsx(F7,{onPurchaseSelect:l,filters:r,showActions:!0}),a==="form"&&u.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:u.jsxs("div",{className:"text-center py-12",children:[u.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),u.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Al Faturas Formu"}),u.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Al faturas formu henz hazr deil. XML import zellii yaknda eklenecek."})]})}),a==="details"&&e&&u.jsx(R7,{purchase:e,onEdit:()=>c(e)})]})]})}function R7({purchase:e,onEdit:t}){const r=i=>new Date(i).toLocaleDateString("tr-TR"),n=i=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(i),a=i=>{switch(i){case"draft":return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"paid":return"bg-purple-100 text-purple-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},s=i=>{switch(i){case"draft":return"Taslak";case"sent":return"Gnderildi";case"approved":return"Onayland";case"rejected":return"Reddedildi";case"paid":return"dendi";case"cancelled":return"ptal";default:return i}};return u.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[u.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["Al Faturas #",e.purchaseNumber]}),u.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:[r(e.createdAt)," tarihinde oluturuldu"]})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${a(e.status)}`,children:s(e.status)}),u.jsx(Te,{onClick:t,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",variant:"default",children:"Dzenle"})]})]})}),u.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Tedariki Bilgileri"}),u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Tedariki Ad"}),u.jsx("dd",{className:"text-sm text-gray-900",children:e.supplierName})]}),e.supplierTaxNumber&&u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Vergi No"}),u.jsx("dd",{className:"text-sm text-gray-900",children:e.supplierTaxNumber})]}),e.supplierAddress&&u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Adres"}),u.jsx("dd",{className:"text-sm text-gray-900",children:e.supplierAddress})]})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Fatura Bilgileri"}),u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Fatura Tarihi"}),u.jsx("dd",{className:"text-sm text-gray-900",children:r(e.issueDate)})]}),e.dueDate&&u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Vade Tarihi"}),u.jsx("dd",{className:"text-sm text-gray-900",children:r(e.dueDate)})]}),u.jsxs("div",{children:[u.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Toplam Tutar"}),u.jsx("dd",{className:"text-sm text-gray-900 font-medium",children:n(e.grandTotal)})]})]})]})]}),u.jsxs("div",{className:"mt-8",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-4",children:"Fatura Kalemleri"}),u.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"rn/Hizmet"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Miktar"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Birim Fiyat"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"KDV"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Toplam"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.items.map(i=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.name}),i.description&&u.jsx("div",{className:"text-sm text-gray-500",children:i.description})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.quantity}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n(i.unitPrice)}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["%",i.taxRate]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n(i.totalPrice)})]},i.id))})]})})]}),u.jsx("div",{className:"mt-6 flex justify-end",children:u.jsx("div",{className:"w-full max-w-sm",children:u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("dt",{className:"text-sm text-gray-600",children:"Ara Toplam:"}),u.jsx("dd",{className:"text-sm text-gray-900",children:n(e.subtotal)})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("dt",{className:"text-sm text-gray-600",children:"KDV:"}),u.jsx("dd",{className:"text-sm text-gray-900",children:n(e.taxTotal)})]}),u.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2",children:[u.jsx("dt",{className:"text-base font-medium text-gray-900",children:"Genel Toplam:"}),u.jsx("dd",{className:"text-base font-medium text-gray-900",children:n(e.grandTotal)})]})]})})}),e.notes&&u.jsxs("div",{className:"mt-6",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Notlar"}),u.jsx("p",{className:"text-sm text-gray-600",children:e.notes})]})]})]})}const D7=zr("/invoices/purchases")({component:P7}),j7=zr("/invoices/new")({component:I7});function I7(){return u.jsx(bE,{initialViewMode:"form"})}const O7=dM.update({id:"/test",path:"/test",getParentRoute:()=>ri}),Kp=BL.update({id:"/patients",path:"/patients",getParentRoute:()=>ri}),ad=UL.update({id:"/invoices",path:"/invoices",getParentRoute:()=>ri}),M7=zL.update({id:"/inventory",path:"/inventory",getParentRoute:()=>ri}),L7=HL.update({id:"/appointments",path:"/appointments",getParentRoute:()=>ri}),B7=ZL.update({id:"/",path:"/",getParentRoute:()=>ri}),U7=f7.update({id:"/",path:"/",getParentRoute:()=>Kp}),$7=g7.update({id:"/",path:"/",getParentRoute:()=>ad}),z7=C7.update({id:"/$patientId",path:"/$patientId",getParentRoute:()=>Kp}),V7=D7.update({id:"/purchases",path:"/purchases",getParentRoute:()=>ad}),H7=j7.update({id:"/new",path:"/new",getParentRoute:()=>ad}),W7={InvoicesNewRoute:H7,InvoicesPurchasesRoute:V7,InvoicesIndexRoute:$7},K7=ad._addFileChildren(W7),G7={PatientsPatientIdRoute:z7,PatientsIndexRoute:U7},Y7=Kp._addFileChildren(G7),X7={IndexRoute:B7,AppointmentsRoute:L7,InventoryRoute:M7,InvoicesRoute:K7,PatientsRoute:Y7,TestRoute:O7},q7=ri._addFileChildren(X7)._addFileTypes(),Q7=ZC({routeTree:q7});function Pv(){const e=new L4({defaultOptions:{queries:{staleTime:3e5,gcTime:18e5,retry:(t,r)=>{var n,a;return((n=r==null?void 0:r.response)==null?void 0:n.status)>=400&&((a=r==null?void 0:r.response)==null?void 0:a.status)<500?!1:t<3}}}});return u.jsx(bA,{children:u.jsx(U4,{client:e,children:u.jsx(fF,{children:u.jsxs(_A,{children:[u.jsx(rN,{router:Q7}),u.jsx(Z4,{initialIsOpen:!1})]})})})})}const J7=[{from:"auth_token",to:hM,version:"v1"},{from:"token",to:bv,version:"v1"},{from:"jwt",to:bv,version:"v1"},{from:"xear_access_token",to:$M,version:"v1"},{from:"refresh_token",to:mM,version:"v1"},{from:"user_session",to:pM,version:"v1"},{from:"currentUser",to:_v,version:"v1"},{from:"currentUserId",to:_v,transform:e=>({id:e,timestamp:Date.now()}),version:"v1"},{from:"sidebar_collapsed",to:mv,transform:e=>({collapsed:e,timestamp:Date.now()}),version:"v1"},{from:"sidebarCollapsed",to:mv,transform:e=>({collapsed:e==="true",timestamp:Date.now()}),version:"v1"},{from:"sgkSubmenuExpanded",to:LM,transform:e=>e==="true",version:"v1"},{from:"faturaSubmenuExpanded",to:BM,transform:e=>e==="true",version:"v1"},{from:"reportsSubmenuExpanded",to:UM,transform:e=>e==="true",version:"v1"},{from:"theme_preference",to:xM,version:"v1"},{from:"systemSettings",to:OM,version:"v1"},{from:"xear_patients_data",to:Go,version:"v1"},{from:"xear_patients",to:gv,version:"v1"},{from:"patients",to:gv,version:"v1"},{from:"xear_crm_patients",to:yM,version:"v1"},{from:"patient_documents",to:yv,version:"v1"},{from:"xear_patients_documents",to:yv,version:"v1"},{from:"xear_saved_views",to:jM,version:"v1"},{from:"appointments",to:_M,version:"v1"},{from:"appointmentFilterPresets",to:bM,version:"v1"},{from:"sgkData",to:kM,version:"v1"},{from:"sgk_documents",to:vv,version:"v1"},{from:"xear_sgk_documents",to:vv,version:"v1"},{from:"sgk_reports",to:TM,version:"v1"},{from:"unmatched_documents",to:SM,version:"v1"},{from:"background_processing_status",to:MM,version:"v1"},{from:"inventoryData",to:kv,version:"v1"},{from:"xear_crm_inventory",to:kv,version:"v1"},{from:"inventoryFilterPreset",to:EM,version:"v1"},{from:"cashRecords",to:wv,version:"v1"},{from:"dashboardCashRecords",to:wv,version:"v1"},{from:"incomeRecordTypes",to:CM,version:"v1"},{from:"expenseRecordTypes",to:NM,version:"v1"},{from:"sms_messages",to:wM,version:"v1"},{from:"smsLogs",to:RM,version:"v1"},{from:"notifications",to:FM,version:"v1"},{from:"automationRules",to:PM,version:"v1"},{from:"automationLogs",to:DM,version:"v1"},{from:"xear_deviceMaintenance",to:AM,version:"v1"},{from:"ocrDynamicNames",to:IM,version:"v1"},{from:"patient_form_draft",to:gM,version:"v1"},{from:"appointment_form_draft",to:vM,version:"v1"},{from:"patients_cache",to:xv+".patients",version:"v1"},{from:"appointments_cache",to:xv+".appointments",version:"v1"}],vs=class vs{constructor(){at(this,"migrationVersion","storage_migration_v1")}static getInstance(){return vs.instance||(vs.instance=new vs),vs.instance}async migrate(){if(localStorage.getItem(this.migrationVersion))return;console.log(" Starting storage migration...");let r=0;for(const n of J7)this.migrateKey(n)&&r++;localStorage.setItem(this.migrationVersion,JSON.stringify({completed:!0,timestamp:Date.now(),migratedKeys:r})),console.log(` Storage migration completed. Migrated ${r} keys.`)}migrateKey(t){const r=localStorage.getItem(t.from);if(r===null)return!1;try{let n=r;if(t.transform){const a=JSON.parse(r);n=JSON.stringify(t.transform(a))}return localStorage.setItem(t.to,n),localStorage.removeItem(t.from),console.log(` Migrated: ${t.from}  ${t.to}`),!0}catch(n){return console.error(` Failed to migrate ${t.from}:`,n),!1}}getMigrationStatus(){const t=localStorage.getItem(this.migrationVersion);if(!t)return{completed:!1};try{return JSON.parse(t)}catch{return{completed:!1}}}resetMigration(){localStorage.removeItem(this.migrationVersion),console.log(" Migration status reset")}};at(vs,"instance");let Gh=vs;const Z7=Gh.getInstance();Z7.migrate().then(()=>{bu.createRoot(document.getElementById("root")).render(u.jsx(ts.StrictMode,{children:u.jsx(Pv,{})}))}).catch(e=>{console.error("Storage migration failed:",e),bu.createRoot(document.getElementById("root")).render(u.jsx(ts.StrictMode,{children:u.jsx(Pv,{})}))});
//# sourceMappingURL=index-6404b8cb.js.map
