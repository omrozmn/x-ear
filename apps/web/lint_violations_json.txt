
> @x-ear/web@0.1.0 lint
> eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0 --format=json

[{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/archive/adapters/patient-adapter.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[862,865],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[862,865],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[915,918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[915,918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[977,980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[977,980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1039,1042],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1039,1042],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1505,1508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1505,1508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3266,3269],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3266,3269],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3353,3356],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3353,3356],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\n/**\n * Patient adapter utilities for converting between Orval and Legacy patient types\n * Note: This file has complex type mismatches between Orval and Legacy types\n * Using @ts-nocheck to suppress errors while maintaining functionality\n */\n\nimport { Patient as OrvalPatient } from \"../../api/generated/api.schemas\";\nimport { Patient as LegacyPatient } from '../types/patient';\n\n/**\n * Convert Orval patient to legacy patient format\n */\nexport function convertOrvalToLegacyPatient(orvalPatient: OrvalPatient): LegacyPatient {\n  return {\n    id: orvalPatient.id || '',\n    tcNumber: orvalPatient.tcNumber || '',\n    firstName: orvalPatient.firstName || '',\n    lastName: orvalPatient.lastName || '',\n    phone: orvalPatient.phone || '',\n    email: orvalPatient.email || '',\n    birthDate: orvalPatient.birthDate || '',\n    gender: (orvalPatient as any).gender || '',\n    addressCity: (orvalPatient as any).addressCity || '',\n    addressDistrict: (orvalPatient as any).addressDistrict || '',\n    addressFull: (orvalPatient as any).addressFull || '',\n    status: orvalPatient.status === 'active' ? 'active' : 'inactive',\n    segment: (orvalPatient.segment ?? 'existing') as LegacyPatient['segment'],\n    acquisitionType: orvalPatient.acquisitionType || 'diger',\n    conversionStep: orvalPatient.conversionStep || 'yeni',\n    referredBy: orvalPatient.referredBy || '',\n    priorityScore: orvalPatient.priorityScore || 0,\n    tags: orvalPatient.tags || [],\n    sgkInfo: (orvalPatient.sgkInfo as any) || '',\n    customData: orvalPatient.customData || {},\n    createdAt: orvalPatient.createdAt || new Date().toISOString(),\n    updatedAt: orvalPatient.updatedAt || new Date().toISOString(),\n    // Legacy fields\n    label: `${orvalPatient.firstName || ''} ${orvalPatient.lastName || ''}`.trim() || 'Unnamed Patient',\n    devices: [],\n    notes: []\n  };\n}\n\n/**\n * Convert legacy patient to Orval patient format\n */\nexport function convertLegacyToOrvalPatient(legacyPatient: LegacyPatient): OrvalPatient {\n  return {\n    id: legacyPatient.id,\n    tcNumber: legacyPatient.tcNumber,\n    firstName: legacyPatient.firstName,\n    lastName: legacyPatient.lastName,\n    phone: legacyPatient.phone,\n    email: legacyPatient.email,\n    birthDate: legacyPatient.birthDate,\n    gender: legacyPatient.gender,\n    addressCity: legacyPatient.addressCity,\n    addressDistrict: legacyPatient.addressDistrict,\n    addressFull: legacyPatient.addressFull,\n    status: legacyPatient.status === 'active' ? 'active' : 'inactive',\n    segment: legacyPatient.segment,\n    acquisitionType: legacyPatient.acquisitionType,\n    conversionStep: legacyPatient.conversionStep,\n    referredBy: legacyPatient.referredBy,\n    priorityScore: legacyPatient.priorityScore,\n    tags: legacyPatient.tags,\n    sgkInfo: legacyPatient.sgkInfo,\n    customData: legacyPatient.customData,\n    createdAt: legacyPatient.createdAt,\n    updatedAt: legacyPatient.updatedAt\n  };\n}\n\n/**\n * Create patient request from form data\n */\n// Type for form data with additional properties\ntype PatientFormData = Partial<LegacyPatient> & {\n  gender?: string;\n  addressCity?: string;\n  addressDistrict?: string;\n  addressFull?: string;\n  conversionStep?: string;\n  referredBy?: string | null;\n  customData?: Record<string, any>;\n};\n\nexport function createPatientRequestFromFormData(formData: PatientFormData): any {\n  return {\n    name: formData.name,\n    phone: formData.phone,\n    email: formData.email,\n    birthDate: formData.birthDate,\n    gender: formData.gender || '',\n    addressCity: formData.addressCity || '',\n    addressDistrict: formData.addressDistrict || '',\n    addressFull: formData.addressFull || '',\n    status: formData.status === 'active' ? 'active' : 'inactive',\n    segment: formData.segment,\n    acquisitionType: formData.acquisitionType,\n    conversionStep: formData.conversionStep || 'initial',\n    referredBy: formData.referredBy || null,\n    priorityScore: formData.priorityScore,\n    tags: formData.tags,\n    sgkInfo: formData.sgkInfo || '',\n    customData: formData.customData || {}\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/api/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/api/mock-services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/AuthProvider.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializeAuth'. Either include it or remove the dependency array.","line":17,"column":6,"nodeType":"ArrayExpression","endLine":17,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [initializeAuth]","fix":{"range":[551,553],"text":"[initializeAuth]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect } from 'react';\nimport { useAuthStore } from '../stores/authStore';\nimport { LoginForm } from './LoginForm';\n\ninterface AuthProviderProps {\n  children: React.ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const { isAuthenticated, isLoading, initializeAuth } = useAuthStore();\n\n  console.log('AuthProvider render - isAuthenticated:', isAuthenticated, 'isLoading:', isLoading);\n\n  useEffect(() => {\n    // Uygulama başlangıcında auth durumunu kontrol et\n    initializeAuth();\n  }, []); // Empty dependency array to run only once on mount\n\n  if (isLoading) {\n    console.log('AuthProvider: Showing loading screen');\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Yükleniyor...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    console.log('AuthProvider: Showing login form');\n    return <LoginForm />;\n  }\n\n  console.log('AuthProvider: Rendering children (MainLayout)');\n  return <>{children}</>;\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/CommunicationTemplates.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Filter' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckCircle' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateForm' is assigned a value but never used.","line":192,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":192,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6984,6987],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6984,6987],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":345,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10154,10157],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10154,10157],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":369,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":369,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10917,10920],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10917,10920],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":588,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":588,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19768,19771],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19768,19771],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { getXEarCRMAPIAutoGenerated } from '../api/generated/xEarCRMAPIAutoGenerated';\nimport type { CommunicationTemplate as BaseCommunicationTemplate } from '../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport { Button, Input, Select, Textarea, Checkbox } from '@x-ear/ui-web';\n\ninterface CommunicationTemplate extends BaseCommunicationTemplate {\n  isSystem?: boolean;\n  usageCount?: number;\n}\nimport { \n  Plus, \n  Search, \n  Filter, \n  Edit3, \n  Trash2, \n  Copy, \n  Eye, \n  Mail, \n  MessageSquare, \n  Tag,\n  Save,\n  X,\n  AlertCircle,\n  CheckCircle\n} from 'lucide-react';\n\ninterface TemplateFormData {\n  name: string;\n  description: string;\n  templateType: 'sms' | 'email';\n  category: string;\n  subject: string;\n  bodyText: string;\n  bodyHtml: string;\n  variables: string[];\n  isActive: boolean;\n}\n\nconst CommunicationTemplates: React.FC = () => {\n  // State\n  const [templates, setTemplates] = useState<CommunicationTemplate[]>([]);\n  const [filteredTemplates, setFilteredTemplates] = useState<CommunicationTemplate[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterType, setFilterType] = useState<'all' | 'sms' | 'email'>('all');\n  const [filterCategory, setFilterCategory] = useState('all');\n  const [filterStatus, setFilterStatus] = useState<'all' | 'active' | 'inactive'>('all');\n  \n  // Modal states\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [showPreviewModal, setShowPreviewModal] = useState(false);\n  const [selectedTemplate, setSelectedTemplate] = useState<CommunicationTemplate | null>(null);\n  \n  // Form state\n  const [formData, setFormData] = useState<TemplateFormData>({\n    name: '',\n    description: '',\n    templateType: 'sms',\n    category: '',\n    subject: '',\n    bodyText: '',\n    bodyHtml: '',\n    variables: [],\n    isActive: true\n  });\n  \n  const [formErrors, setFormErrors] = useState<Record<string, string>>({});\n  const [saving, setSaving] = useState(false);\n\n  // Categories\n  const categories = [\n    'appointment_reminder',\n    'appointment_confirmation',\n    'payment_reminder',\n    'welcome_message',\n    'follow_up',\n    'marketing',\n    'system_notification',\n    'custom'\n  ];\n\n  // Load templates\n  useEffect(() => {\n    loadTemplates();\n  }, []);\n\n  // Filter templates\n  useEffect(() => {\n    let filtered = templates;\n\n    if (searchTerm) {\n      filtered = filtered.filter(template =>\n        template.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        template.description?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        template.bodyText?.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    if (filterType !== 'all') {\n      filtered = filtered.filter(template => template.templateType === filterType);\n    }\n\n    if (filterCategory !== 'all') {\n      filtered = filtered.filter(template => template.category === filterCategory);\n    }\n\n    if (filterStatus !== 'all') {\n      filtered = filtered.filter(template => \n        filterStatus === 'active' ? template.isActive : !template.isActive\n      );\n    }\n\n    setFilteredTemplates(filtered);\n  }, [templates, searchTerm, filterType, filterCategory, filterStatus]);\n\n  const loadTemplates = async () => {\n    try {\n      setLoading(true);\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.communicationsListTemplates();\n      \n      if (response.data.success && response.data.data) {\n        // Filter out templates with undefined id\n        const validTemplates = response.data.data.filter(template => template.id !== undefined) as CommunicationTemplate[];\n        setTemplates(validTemplates);\n      } else {\n        setTemplates([]);\n      }\n    } catch (error) {\n      console.error('Error loading templates:', error);\n      setTemplates([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateTemplate = () => {\n    setFormData({\n      name: '',\n      description: '',\n      templateType: 'sms',\n      category: '',\n      subject: '',\n      bodyText: '',\n      bodyHtml: '',\n      variables: [],\n      isActive: true\n    });\n    setFormErrors({});\n    setShowCreateModal(true);\n  };\n\n  const handleEditTemplate = (template: CommunicationTemplate) => {\n    setSelectedTemplate(template);\n    setFormData({\n      name: template.name || '',\n      description: template.description || '',\n      templateType: template.templateType || 'sms',\n      category: template.category || '',\n      subject: template.subject || '',\n      bodyText: template.bodyText || '',\n      bodyHtml: template.bodyHtml || '',\n      variables: template.variables || [],\n      isActive: template.isActive ?? true\n    });\n    setFormErrors({});\n    setShowEditModal(true);\n  };\n\n  const handlePreviewTemplate = (template: CommunicationTemplate) => {\n    setSelectedTemplate(template);\n    setShowPreviewModal(true);\n  };\n\n  const handleDuplicateTemplate = async (template: CommunicationTemplate) => {\n    setFormData({\n      name: `${template.name || 'Şablon'} - Kopya`,\n      description: template.description || '',\n      templateType: template.templateType || 'sms',\n      category: template.category || '',\n      subject: template.subject || '',\n      bodyText: template.bodyText || '',\n      bodyHtml: template.bodyHtml || '',\n      variables: template.variables || [],\n      isActive: true\n    });\n    setFormErrors({});\n    setShowCreateModal(true);\n  };\n\n  const validateForm = (): boolean => {\n    const errors: Record<string, string> = {};\n\n    if (!formData.name.trim()) {\n      errors.name = 'Template name is required';\n    }\n\n    if (!formData.bodyText.trim()) {\n      errors.bodyText = 'Template content is required';\n    }\n\n    if (formData.templateType === 'email' && !formData.subject.trim()) {\n      errors.subject = 'Email subject is required';\n    }\n\n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSaveTemplate = async () => {\n    setSaving(true);\n    setFormErrors({});\n\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      \n      if (selectedTemplate?.id) {\n        // Update existing template\n        const response = await api.communicationsUpdateTemplate(\n          selectedTemplate.id,\n          formData\n        );\n        \n        if (response.data.success) {\n          await loadTemplates();\n          setShowEditModal(false);\n          setSelectedTemplate(null);\n        } else {\n          setFormErrors({ general: 'Güncelleme başarısız' });\n        }\n      } else {\n        // Create new template\n        const response = await api.communicationsCreateTemplate(formData);\n        \n        if (response.data.success) {\n          await loadTemplates();\n          setShowCreateModal(false);\n        } else {\n          setFormErrors({ general: 'Oluşturma başarısız' });\n        }\n      }\n    } catch (error: any) {\n      console.error('Template save error:', error);\n      setFormErrors({ \n        general: error.response?.data?.error || 'Bir hata oluştu' \n      });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDeleteTemplate = async (template: CommunicationTemplate) => {\n    if (!confirm(`Are you sure you want to delete \"${template.name}\"?`)) return;\n\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.communicationsDeleteTemplate(template.id!);\n      \n      if (response.data.success) {\n        await loadTemplates();\n      }\n    } catch (error) {\n      console.error('Error deleting template:', error);\n    }\n  };\n\n  const extractVariables = (text: string): string[] => {\n    const matches = text.match(/\\{\\{([^}]+)\\}\\}/g);\n    return matches ? matches.map(match => match.slice(2, -2).trim()) : [];\n  };\n\n  const handleBodyTextChange = (value: string) => {\n    setFormData(prev => ({\n      ...prev,\n      bodyText: value,\n      variables: extractVariables(value)\n    }));\n  };\n\n  const getCategoryLabel = (category: string) => {\n    const labels: Record<string, string> = {\n      appointment_reminder: 'Randevu Hatırlatması',\n      appointment_confirmation: 'Randevu Onayı',\n      payment_reminder: 'Ödeme Hatırlatması',\n      welcome_message: 'Hoş Geldin Mesajı',\n      follow_up: 'Takip Mesajı',\n      marketing: 'Pazarlama',\n      system_notification: 'Sistem Bildirimi',\n      custom: 'Özel'\n    };\n    return labels[category] || category;\n  };\n\n  const getTypeIcon = (type: string) => {\n    return type === 'email' ? <Mail className=\"w-4 h-4\" /> : <MessageSquare className=\"w-4 h-4\" />;\n  };\n\n  const getTypeColor = (type: string) => {\n    return type === 'email' ? 'text-blue-600' : 'text-green-600';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900\">İletişim Şablonları</h2>\n          <p className=\"text-gray-600\">SMS ve e-posta şablonlarını yönetin</p>\n        </div>\n        <Button\n          onClick={handleCreateTemplate}\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Yeni Şablon\n        </Button>\n      </div>\n\n      {/* Filters */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          {/* Search */}\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n            <Input\n              type=\"text\"\n              placeholder=\"Şablon ara...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n\n          {/* Type Filter */}\n          <Select\n            value={filterType}\n            onChange={(e) => setFilterType(e.target.value as any)}\n            options={[\n              { value: 'all', label: 'Tüm Tipler' },\n              { value: 'sms', label: 'SMS' },\n              { value: 'email', label: 'E-posta' }\n            ]}\n          />\n\n          {/* Category Filter */}\n          <Select\n            value={filterCategory}\n            onChange={(e) => setFilterCategory(e.target.value)}\n            options={[\n              { value: 'all', label: 'Tüm Kategoriler' },\n              ...categories.map(category => ({\n                value: category,\n                label: getCategoryLabel(category)\n              }))\n            ]}\n          />\n\n          {/* Status Filter */}\n          <Select\n            value={filterStatus}\n            onChange={(e) => setFilterStatus(e.target.value as any)}\n            options={[\n              { value: 'all', label: 'Tüm Durumlar' },\n              { value: 'active', label: 'Aktif' },\n              { value: 'inactive', label: 'Pasif' }\n            ]}\n          />\n        </div>\n      </div>\n\n      {/* Templates Grid */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {filteredTemplates.map((template) => (\n          <div key={template.id} className=\"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow\">\n            <div className=\"p-4\">\n              {/* Header */}\n              <div className=\"flex items-start justify-between mb-3\">\n                <div className=\"flex items-center gap-2\">\n                  <span className={getTypeColor(template.templateType || 'sms')}>\n                    {getTypeIcon(template.templateType || 'sms')}\n                  </span>\n                  <h3 className=\"font-semibold text-gray-900 truncate\">{template.name || ''}</h3>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  {template.isSystem && (\n                    <span className=\"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded\">\n                      Sistem\n                    </span>\n                  )}\n                  <span className={`px-2 py-1 text-xs rounded ${\n                    template.isActive \n                      ? 'bg-green-100 text-green-800' \n                      : 'bg-red-100 text-red-800'\n                  }`}>\n                    {template.isActive ? 'Aktif' : 'Pasif'}\n                  </span>\n                </div>\n              </div>\n\n              {/* Description */}\n              {template.description && (\n                <p className=\"text-sm text-gray-600 mb-3 line-clamp-2\">\n                  {template.description}\n                </p>\n              )}\n\n              {/* Category */}\n              {template.category && (\n                <div className=\"flex items-center gap-1 mb-3\">\n                  <Tag className=\"w-3 h-3 text-gray-400\" />\n                  <span className=\"text-xs text-gray-500\">\n                    {getCategoryLabel(template.category)}\n                  </span>\n                </div>\n              )}\n\n              {/* Content Preview */}\n              <div className=\"bg-gray-50 p-3 rounded mb-3\">\n                <p className=\"text-sm text-gray-700 line-clamp-3\">\n                  {template.bodyText}\n                </p>\n              </div>\n\n              {/* Variables */}\n              {template.variables && template.variables.length > 0 && (\n                <div className=\"mb-3\">\n                  <p className=\"text-xs text-gray-500 mb-1\">Değişkenler:</p>\n                  <div className=\"flex flex-wrap gap-1\">\n                    {template.variables?.slice(0, 3).map((variable, index) => (\n                      <span key={index} className=\"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded\">\n                        {variable}\n                      </span>\n                    ))}\n                    {template.variables && template.variables.length > 3 && (\n                      <span className=\"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded\">\n                        +{template.variables.length - 3}\n                      </span>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Stats */}\n              <div className=\"text-xs text-gray-500 mb-4\">\n                Kullanım: {template.usageCount || 0} kez\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    onClick={() => handlePreviewTemplate(template)}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    title=\"Önizle\"\n                  >\n                    <Eye className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleDuplicateTemplate(template)}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    title=\"Kopyala\"\n                  >\n                    <Copy className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    onClick={() => handleEditTemplate(template)}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    title=\"Düzenle\"\n                    disabled={template.isSystem || false}\n                  >\n                    <Edit3 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleDeleteTemplate(template)}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    title=\"Sil\"\n                    disabled={template.isSystem || false}\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Empty State */}\n      {filteredTemplates.length === 0 && (\n        <div className=\"text-center py-12\">\n          <MessageSquare className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Şablon bulunamadı</h3>\n          <p className=\"text-gray-600 mb-4\">\n            {searchTerm || filterType !== 'all' || filterCategory !== 'all' || filterStatus !== 'all'\n              ? 'Arama kriterlerinize uygun şablon bulunamadı.'\n              : 'Henüz hiç şablon oluşturulmamış.'}\n          </p>\n          <Button\n            onClick={handleCreateTemplate}\n          >\n            İlk Şablonu Oluştur\n          </Button>\n        </div>\n      )}\n\n      {/* Create/Edit Modal */}\n      {(showCreateModal || showEditModal) && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h3 className=\"text-lg font-semibold\">\n                  {showCreateModal ? 'Yeni Şablon Oluştur' : 'Şablonu Düzenle'}\n                </h3>\n                <Button\n                  onClick={() => {\n                    setShowCreateModal(false);\n                    setShowEditModal(false);\n                    setSelectedTemplate(null);\n                  }}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </Button>\n              </div>\n\n              {formErrors.general && (\n                <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2\">\n                  <AlertCircle className=\"w-4 h-4 text-red-600\" />\n                  <span className=\"text-red-700 text-sm\">{formErrors.general}</span>\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                {/* Template Name */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Şablon Adı *\n                  </label>\n                  <Input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}\n                    className={formErrors.name ? 'border-red-300' : ''}\n                    placeholder=\"Şablon adını girin\"\n                  />\n                  {formErrors.name && (\n                    <p className=\"text-red-600 text-sm mt-1\">{formErrors.name}</p>\n                  )}\n                </div>\n\n                {/* Description */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Açıklama\n                  </label>\n                  <Input\n                    type=\"text\"\n                    value={formData.description}\n                    onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}\n                    placeholder=\"Şablon açıklaması\"\n                  />\n                </div>\n\n                {/* Type and Category */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Tip *\n                    </label>\n                    <Select\n                      value={formData.templateType}\n                      onChange={(e) => setFormData(prev => ({ ...prev, templateType: e.target.value as any }))}\n                      options={[\n                        { value: 'sms', label: 'SMS' },\n                        { value: 'email', label: 'E-posta' }\n                      ]}\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Kategori\n                    </label>\n                    <Select\n                      value={formData.category}\n                      onChange={(e) => setFormData(prev => ({ ...prev, category: e.target.value }))}\n                      options={[\n                        { value: '', label: 'Kategori seçin' },\n                        ...categories.map(category => ({\n                          value: category,\n                          label: getCategoryLabel(category)\n                        }))\n                      ]}\n                    />\n                  </div>\n                </div>\n\n                {/* Email Subject */}\n                {formData.templateType === 'email' && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      E-posta Konusu *\n                    </label>\n                    <Input\n                      type=\"text\"\n                      value={formData.subject}\n                      onChange={(e) => setFormData(prev => ({ ...prev, subject: e.target.value }))}\n                      className={formErrors.subject ? 'border-red-300' : ''}\n                      placeholder=\"E-posta konusu\"\n                    />\n                    {formErrors.subject && (\n                      <p className=\"text-red-600 text-sm mt-1\">{formErrors.subject}</p>\n                    )}\n                  </div>\n                )}\n\n                {/* Body Text */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    İçerik *\n                  </label>\n                  <Textarea\n                    value={formData.bodyText}\n                    onChange={(e) => handleBodyTextChange(e.target.value)}\n                    rows={6}\n                    className={formErrors.bodyText ? 'border-red-300' : ''}\n                    placeholder=\"Şablon içeriği... Değişkenler için {{değişken_adı}} formatını kullanın\"\n                  />\n                  {formErrors.bodyText && (\n                    <p className=\"text-red-600 text-sm mt-1\">{formErrors.bodyText}</p>\n                  )}\n                  <p className=\"text-gray-500 text-sm mt-1\">\n                    Değişkenler için {`{{değişken_adı}}`} formatını kullanın\n                  </p>\n                </div>\n\n                {/* Variables Preview */}\n                {formData.variables.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Tespit Edilen Değişkenler\n                    </label>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {formData.variables.map((variable, index) => (\n                        <span key={index} className=\"px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded\">\n                          {variable}\n                        </span>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Active Status */}\n                <div className=\"flex items-center gap-2\">\n                  <Checkbox\n                    id=\"isActive\"\n                    checked={formData.isActive}\n                    onChange={(e) => setFormData(prev => ({ ...prev, isActive: e.target.checked }))}\n                  />\n                  <label htmlFor=\"isActive\" className=\"text-sm text-gray-700\">\n                    Şablon aktif\n                  </label>\n                </div>\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex justify-end gap-3 mt-6 pt-4 border-t\">\n                <Button\n                  onClick={() => {\n                    setShowCreateModal(false);\n                    setShowEditModal(false);\n                    setSelectedTemplate(null);\n                  }}\n                  variant=\"outline\"\n                  disabled={saving}\n                >\n                  İptal\n                </Button>\n                <Button\n                  onClick={handleSaveTemplate}\n                  disabled={saving}\n                >\n                  {saving ? (\n                    <>\n                      <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                      Kaydediliyor...\n                    </>\n                  ) : (\n                    <>\n                      <Save className=\"w-4 h-4 mr-2\" />\n                      Kaydet\n                    </>\n                  )}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Preview Modal */}\n      {showPreviewModal && selectedTemplate && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <h3 className=\"text-lg font-semibold\">Şablon Önizleme</h3>\n                <Button\n                  onClick={() => {\n                    setShowPreviewModal(false);\n                    setSelectedTemplate(null);\n                  }}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </Button>\n              </div>\n\n              <div className=\"space-y-4\">\n                {/* Template Info */}\n                <div className=\"bg-gray-50 p-4 rounded-lg\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <span className={getTypeColor(selectedTemplate.templateType || 'sms')}>\n                      {getTypeIcon(selectedTemplate.templateType || 'sms')}\n                    </span>\n                    <h4 className=\"font-semibold\">{selectedTemplate.name || ''}</h4>\n                  </div>\n                  {selectedTemplate.description && (\n                    <p className=\"text-gray-600 text-sm mb-2\">{selectedTemplate.description}</p>\n                  )}\n                  <div className=\"flex items-center gap-4 text-sm text-gray-500\">\n                    <span>Tip: {(selectedTemplate.templateType || 'sms').toUpperCase()}</span>\n                    {selectedTemplate.category && (\n                      <span>Kategori: {getCategoryLabel(selectedTemplate.category)}</span>\n                    )}\n                    <span>Kullanım: {selectedTemplate.usageCount || 0} kez</span>\n                  </div>\n                </div>\n\n                {/* Subject (for email) */}\n                {selectedTemplate.templateType === 'email' && selectedTemplate.subject && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Konu\n                    </label>\n                    <div className=\"p-3 bg-gray-50 rounded border\">\n                      {selectedTemplate.subject}\n                    </div>\n                  </div>\n                )}\n\n                {/* Content */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    İçerik\n                  </label>\n                  <div className=\"p-4 bg-gray-50 rounded border whitespace-pre-wrap\">\n                    {selectedTemplate.bodyText}\n                  </div>\n                </div>\n\n                {/* Variables */}\n                {selectedTemplate.variables && selectedTemplate.variables.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Değişkenler\n                    </label>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {selectedTemplate.variables?.map((variable, index) => (\n                        <span key={index} className=\"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded\">\n                          {variable}\n                        </span>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex justify-end gap-3 mt-6 pt-4 border-t\">\n                <Button\n                  onClick={() => {\n                    setShowPreviewModal(false);\n                    handleEditTemplate(selectedTemplate);\n                  }}\n                  disabled={selectedTemplate.isSystem || false}\n                >\n                  <Edit3 className=\"w-4 h-4 mr-2\" />\n                  Düzenle\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CommunicationTemplates;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/DeviceReplacementHistory.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadReplacements'. Either include it or remove the dependency array.","line":40,"column":6,"nodeType":"ArrayExpression","endLine":40,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [loadReplacements, patientId]","fix":{"range":[928,939],"text":"[loadReplacements, patientId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Badge,\n  Button\n} from '@x-ear/ui-web';\nimport { \n  History, \n  ArrowRight, \n  Calendar, \n  User, \n  FileText, \n  Eye,\n  RefreshCw,\n  AlertCircle,\n  CheckCircle,\n  Clock\n} from 'lucide-react';\nimport { DeviceReplacementHistory as ReplacementHistory } from '../types/device-replacement';\nimport { deviceReplacementService } from '../services/device-replacement.service';\n\ninterface DeviceReplacementHistoryProps {\n  patientId: string;\n  className?: string;\n}\n\nexport const DeviceReplacementHistory: React.FC<DeviceReplacementHistoryProps> = ({\n  patientId,\n  className\n}) => {\n  const [replacements, setReplacements] = useState<ReplacementHistory[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadReplacements();\n  }, [patientId]);\n\n  const loadReplacements = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const data = await deviceReplacementService.getPatientReplacements(patientId);\n      setReplacements(data);\n    } catch (err) {\n      setError('Cihaz değişim geçmişi yüklenirken hata oluştu');\n      console.error('Error loading replacements:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\n      case 'pending_invoice':\n        return <Clock className=\"h-4 w-4 text-yellow-500\" />;\n      case 'cancelled':\n        return <AlertCircle className=\"h-4 w-4 text-red-500\" />;\n      default:\n        return <RefreshCw className=\"h-4 w-4 text-blue-500\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return 'Tamamlandı';\n      case 'pending_invoice':\n        return 'Fatura Bekliyor';\n      case 'cancelled':\n        return 'İptal Edildi';\n      default:\n        return 'İşlemde';\n    }\n  };\n\n  const getStatusVariant = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return 'success';\n      case 'pending_invoice':\n        return 'warning';\n      case 'cancelled':\n        return 'danger';\n      default:\n        return 'secondary';\n    }\n  };\n\n  const handleViewInvoice = (replacement: ReplacementHistory) => {\n    if (replacement.returnInvoiceId) {\n      // Open invoice modal or navigate to invoice page\n      console.log('View invoice:', replacement.returnInvoiceId);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Card className={className}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <History className=\"h-5 w-5\" />\n            Cihaz Değişim Geçmişi\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-center py-8\">\n            <RefreshCw className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n            <span className=\"ml-2 text-muted-foreground\">Yükleniyor...</span>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Card className={className}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <History className=\"h-5 w-5\" />\n            Cihaz Değişim Geçmişi\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-center py-8 text-red-500\">\n            <AlertCircle className=\"h-6 w-6\" />\n            <span className=\"ml-2\">{error}</span>\n          </div>\n          <Button \n            onClick={loadReplacements} \n            variant=\"outline\" \n            className=\"w-full mt-4\"\n          >\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Tekrar Dene\n          </Button>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className={className}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <History className=\"h-5 w-5\" />\n          Cihaz Değişim Geçmişi\n          <Badge variant=\"secondary\" className=\"ml-auto\">\n            {replacements.length} kayıt\n          </Badge>\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        {replacements.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <History className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n            <p>Henüz cihaz değişimi yapılmamış</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {replacements.map((replacement, index) => (\n              <div key={replacement.id} className=\"relative\">\n                {index < replacements.length - 1 && (\n                  <div className=\"absolute left-6 top-16 bottom-0 w-px bg-border\" />\n                )}\n                \n                <div className=\"flex gap-4\">\n                  <div className=\"flex-shrink-0 mt-1\">\n                    {getStatusIcon(replacement.status)}\n                  </div>\n                  \n                  <div className=\"flex-1 space-y-3\">\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          <Badge variant={getStatusVariant(replacement.status)}>\n                            {getStatusLabel(replacement.status)}\n                          </Badge>\n                          <span className=\"text-sm text-muted-foreground\">\n                            {replacement.replacementReason && `• ${replacement.replacementReason}`}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <Calendar className=\"h-3 w-3\" />\n                          {new Date(replacement.createdAt).toLocaleDateString('tr-TR')}\n                          {replacement.replacedBy && (\n                            <>\n                              <User className=\"h-3 w-3 ml-2\" />\n                              {replacement.replacedBy}\n                            </>\n                          )}\n                        </div>\n                      </div>\n                      \n                      {replacement.returnInvoiceId && (\n                        <Button\n                          variant=\"ghost\"\n                          onClick={() => handleViewInvoice(replacement)}\n                        >\n                          <Eye className=\"h-4 w-4 mr-1\" />\n                          Fatura\n                        </Button>\n                      )}\n                    </div>\n\n                    <div className=\"bg-muted/50 rounded-lg p-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"space-y-1\">\n                          <div className=\"text-sm font-medium\">Eski Cihaz</div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            {replacement.oldDeviceInfo.brand} {replacement.oldDeviceInfo.model}\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            SN: {replacement.oldDeviceInfo.serialNumber}\n                          </div>\n                        </div>\n                        \n                        <ArrowRight className=\"h-4 w-4 text-muted-foreground flex-shrink-0 mx-3\" />\n                        \n                        <div className=\"space-y-1\">\n                          <div className=\"text-sm font-medium\">Yeni Cihaz</div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            {replacement.newDeviceInfo.brand} {replacement.newDeviceInfo.model}\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            SN: {replacement.newDeviceInfo.serialNumber}\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {replacement.priceDifference !== 0 && (\n                        <div className=\"mt-2 pt-2 border-t\">\n                          <div className=\"text-xs text-muted-foreground\">\n                            Fiyat Farkı: \n                            <span className={`ml-1 font-medium ${\n                              (replacement.priceDifference || 0) > 0 ? 'text-green-600' : 'text-red-600'\n                            }`}>\n                              {(replacement.priceDifference || 0) > 0 ? '+' : ''}\n                              {(replacement.priceDifference || 0).toLocaleString('tr-TR')} ₺\n                            </span>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    {replacement.notes && (\n                      <div className=\"text-sm text-muted-foreground bg-blue-50 p-2 rounded border-l-2 border-blue-200\">\n                        <FileText className=\"h-3 w-3 inline mr-1\" />\n                        {replacement.notes}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n        \n        <div className=\"border-t my-4\" />\n        \n        <Button \n          onClick={loadReplacements} \n          variant=\"ghost\" \n          className=\"w-full\"\n        >\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\n          Yenile\n        </Button>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default DeviceReplacementHistory;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/ErrorMessage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/GlobalErrorHandler.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":31,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":31,"endColumn":28},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'clearError'. Either include it or remove the dependency array.","line":68,"column":6,"nodeType":"ArrayExpression","endLine":68,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [clearError]","fix":{"range":[2201,2203],"text":"[clearError]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":155,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":155,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useCallback, useState } from 'react';\nimport { Toast } from './ErrorMessage';\nimport { getErrorMessage, isNetworkError, isUnauthorizedError } from '../hooks/useErrorHandler';\n\ninterface GlobalErrorContextType {\n  showError: (error: unknown, options?: ErrorOptions) => void;\n  showSuccess: (message: string, options?: Omit<ErrorOptions, 'type'>) => void;\n  showWarning: (message: string, options?: Omit<ErrorOptions, 'type'>) => void;\n  showInfo: (message: string, options?: Omit<ErrorOptions, 'type'>) => void;\n  clearError: (id: string) => void;\n  clearAllErrors: () => void;\n}\n\ninterface ErrorOptions {\n  title?: string;\n  type?: 'error' | 'warning' | 'info' | 'success';\n  duration?: number; // Auto-dismiss after duration (ms), 0 = no auto-dismiss\n  persistent?: boolean; // Don't auto-dismiss\n  onRetry?: () => void;\n  retryText?: string;\n}\n\ninterface ErrorNotification extends ErrorOptions {\n  id: string;\n  message: string;\n  timestamp: Date;\n}\n\nconst GlobalErrorContext = createContext<GlobalErrorContextType | undefined>(undefined);\n\nexport const useGlobalError = () => {\n  const context = useContext(GlobalErrorContext);\n  if (!context) {\n    throw new Error('useGlobalError must be used within a GlobalErrorProvider');\n  }\n  return context;\n};\n\nexport const GlobalErrorProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [notifications, setNotifications] = useState<ErrorNotification[]>([]);\n\n  const generateId = () => `error-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n  const addNotification = useCallback((\n    message: string,\n    options: ErrorOptions = {}\n  ) => {\n    const id = generateId();\n    const notification: ErrorNotification = {\n      id,\n      message,\n      timestamp: new Date(),\n      type: 'error',\n      duration: 5000, // Default 5 seconds\n      ...options\n    };\n\n    setNotifications(prev => [...prev, notification]);\n\n    // Auto-dismiss if duration is set and not persistent\n    if (notification.duration && notification.duration > 0 && !notification.persistent) {\n      setTimeout(() => {\n        clearError(id);\n      }, notification.duration);\n    }\n\n    return id;\n  }, []);\n\n  const showError = useCallback((error: unknown, options: ErrorOptions = {}) => {\n    let message = getErrorMessage(error);\n    let title = options.title;\n\n    // Customize based on error type\n    if (isNetworkError(error)) {\n      title = title || 'Bağlantı Hatası';\n      message = 'Sunucuya bağlanırken bir hata oluştu. İnternet bağlantınızı kontrol edin.';\n    } else if (isUnauthorizedError(error)) {\n      title = title || 'Yetkilendirme Hatası';\n      message = 'Bu işlem için yetkiniz bulunmuyor. Lütfen tekrar giriş yapın.';\n    }\n\n    addNotification(message, {\n      ...options,\n      type: 'error',\n      title\n    });\n  }, [addNotification]);\n\n  const showSuccess = useCallback((message: string, options: Omit<ErrorOptions, 'type'> = {}) => {\n    addNotification(message, {\n      ...options,\n      type: 'success',\n      duration: options.duration || 3000 // Shorter duration for success\n    });\n  }, [addNotification]);\n\n  const showWarning = useCallback((message: string, options: Omit<ErrorOptions, 'type'> = {}) => {\n    addNotification(message, {\n      ...options,\n      type: 'warning'\n    });\n  }, [addNotification]);\n\n  const showInfo = useCallback((message: string, options: Omit<ErrorOptions, 'type'> = {}) => {\n    addNotification(message, {\n      ...options,\n      type: 'info'\n    });\n  }, [addNotification]);\n\n  const clearError = useCallback((id: string) => {\n    setNotifications(prev => prev.filter(notification => notification.id !== id));\n  }, []);\n\n  const clearAllErrors = useCallback(() => {\n    setNotifications([]);\n  }, []);\n\n  const contextValue: GlobalErrorContextType = {\n    showError,\n    showSuccess,\n    showWarning,\n    showInfo,\n    clearError,\n    clearAllErrors\n  };\n\n  return (\n    <GlobalErrorContext.Provider value={contextValue}>\n      {children}\n      \n      {/* Render notifications */}\n      <div className=\"fixed top-4 right-4 z-50 space-y-2\">\n        {notifications.map((notification) => (\n          <Toast\n            key={notification.id}\n            title={notification.title}\n            message={notification.message}\n            type={notification.type}\n            dismissible={true}\n            onDismiss={() => clearError(notification.id)}\n            onRetry={notification.onRetry}\n            retryText={notification.retryText}\n            position=\"top-right\"\n            className=\"animate-in slide-in-from-right-full duration-300\"\n          />\n        ))}\n      </div>\n    </GlobalErrorContext.Provider>\n  );\n};\n\n// HOC for wrapping components with error handling\nexport const withErrorHandling = <P extends object>(\n  Component: React.ComponentType<P>\n) => {\n  const WrappedComponent = (props: P) => {\n    const { showError } = useGlobalError();\n\n    // Add error boundary-like behavior\n    React.useEffect(() => {\n      const handleUnhandledRejection = (event: PromiseRejectionEvent) => {\n        showError(event.reason, {\n          title: 'Beklenmeyen Hata',\n          persistent: true\n        });\n      };\n\n      const handleError = (event: ErrorEvent) => {\n        showError(event.error, {\n          title: 'JavaScript Hatası',\n          persistent: true\n        });\n      };\n\n      window.addEventListener('unhandledrejection', handleUnhandledRejection);\n      window.addEventListener('error', handleError);\n\n      return () => {\n        window.removeEventListener('unhandledrejection', handleUnhandledRejection);\n        window.removeEventListener('error', handleError);\n      };\n    }, [showError]);\n\n    return <Component {...props} />;\n  };\n\n  WrappedComponent.displayName = `withErrorHandling(${Component.displayName || Component.name})`;\n  return WrappedComponent;\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/LoadingSpinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/LoginForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/MobileNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/OutboxStatus.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PWAInstallPrompt.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientAppointmentsTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorBoundary' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleAppointmentClick' is assigned a value but never used.","line":113,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":113,"endColumn":31},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":113,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4360,4363],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4360,4363],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":126,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4715,4718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4715,4718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":161,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":168,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":175,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":185,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":192,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":198,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":199,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":205,"endColumn":17}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport { usePatientAppointments } from '../hooks/patient/usePatientAppointments';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { AppointmentSchedulingForm } from './forms/AppointmentSchedulingForm';\nimport { Calendar, AlertCircle, Plus, Search, Filter } from 'lucide-react';\nimport { Button } from './ui/Button';\n\ninterface PatientAppointmentsTabProps {\n  patientId: string;\n}\n\nexport const PatientAppointmentsTab: React.FC<PatientAppointmentsTabProps> = ({\n  patientId\n}) => {\n  const { appointments, isLoading: appointmentsLoading, error: appointmentsError } = usePatientAppointments(patientId);\n  const [showSchedulingForm, setShowSchedulingForm] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Search and filter states\n  const [searchTerm, setSearchTerm] = useState('');\n  const [appointmentTypeFilter, setAppointmentTypeFilter] = useState('');\n  const [dateRange, setDateRange] = useState({ start: '', end: '' });\n\n  // Filtered appointments and statistics\n  const { filteredAppointments, filteredStats } = useMemo(() => {\n    let filtered = appointments;\n\n    // Text search\n    if (searchTerm) {\n      filtered = filtered.filter(appointment =>\n        appointment.appointmentType.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        appointment.notes?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        appointment.status.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    // Appointment type filter\n    if (appointmentTypeFilter) {\n      filtered = filtered.filter(appointment => appointment.appointmentType === appointmentTypeFilter);\n    }\n\n    // Date range filter\n    if (dateRange.start || dateRange.end) {\n      filtered = filtered.filter(appointment => {\n        const appointmentDate = new Date(appointment.date);\n        const startDate = dateRange.start ? new Date(dateRange.start) : null;\n        const endDate = dateRange.end ? new Date(dateRange.end) : null;\n\n        if (startDate && appointmentDate < startDate) return false;\n        if (endDate && appointmentDate > endDate) return false;\n        return true;\n      });\n    }\n\n    // Calculate statistics\n    const appointmentTypeCounts = filtered.reduce((acc, appointment) => {\n      acc[appointment.appointmentType] = (acc[appointment.appointmentType] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n\n    const upcomingAppointments = filtered.filter(appointment => {\n      const appointmentDateTime = new Date(`${appointment.date} ${appointment.time}`);\n      return appointmentDateTime > new Date() && appointment.status === 'scheduled';\n    }).length;\n\n    return {\n      filteredAppointments: filtered,\n      filteredStats: {\n        totalAppointments: filtered.length,\n        appointmentTypeCounts,\n        upcomingAppointments\n      }\n    };\n  }, [appointments, searchTerm, appointmentTypeFilter, dateRange]);\n\n  // Get unique appointment types for filter dropdown\n  const appointmentTypes = useMemo(() => {\n    const types = new Set(appointments.map(appointment => appointment.appointmentType));\n    return Array.from(types).sort();\n  }, [appointments]);\n\n  if (appointmentsLoading) {\n    return (\n      <div className=\"p-6\" role=\"status\" aria-label=\"Randevular yükleniyor\">\n        <LoadingSkeleton lines={4} className=\"mb-4\" />\n        <div className=\"grid gap-4\">\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (appointmentsError) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Randevular yüklenirken hata oluştu</h3>\n              <p className=\"mt-1 text-sm text-red-700\">\n                {typeof appointmentsError === 'string' ? appointmentsError : appointmentsError.message}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const handleAppointmentClick = (appointment: any) => {\n    // TODO: Implement appointment detail modal or navigation\n    console.log('Appointment clicked:', appointment);\n  };\n\n  const handleScheduleAppointment = () => {\n    setShowSchedulingForm(true);\n  };\n\n  const handleSchedulingFormClose = () => {\n    setShowSchedulingForm(false);\n  };\n\n  const handleAppointmentSave = async (appointmentData: any) => {\n    setIsSubmitting(true);\n    try {\n      // TODO: Implement appointment save API call\n      console.log('Appointment save:', appointmentData);\n      setShowSchedulingForm(false);\n    } catch (error) {\n      console.error('Appointment save failed:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <Calendar className=\"w-5 h-5 mr-2\" aria-hidden=\"true\" />\n          Hasta Randevuları ({filteredAppointments.length})\n        </h3>\n      </div>\n\n      {/* Search and Filter Controls */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\n        <div className=\"flex items-center mb-4\">\n          <Filter className=\"w-5 h-5 text-gray-400 mr-2\" aria-hidden=\"true\" />\n          <h4 className=\"text-sm font-medium text-gray-900\">Arama ve Filtreleme</h4>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label htmlFor=\"search\" className=\"block text-sm font-medium text-gray-700\">\n              Arama\n            </label>\n            <div className=\"relative mt-1\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" aria-hidden=\"true\" />\n              <input\n                type=\"text\"\n                id=\"search\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                placeholder=\"Randevu türü, notlar veya durum ara...\"\n                className=\"pl-10 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n            </div>\n          </div>\n          <div>\n            <label htmlFor=\"appointmentType\" className=\"block text-sm font-medium text-gray-700\">\n              Randevu Türü\n            </label>\n            <select\n              id=\"appointmentType\"\n              value={appointmentTypeFilter}\n              onChange={(e) => setAppointmentTypeFilter(e.target.value)}\n              className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            >\n              <option value=\"\">Tümü</option>\n              {appointmentTypes.map(type => (\n                <option key={type} value={type}>{type}</option>\n              ))}\n            </select>\n          </div>\n          <div>\n            <label htmlFor=\"dateRange\" className=\"block text-sm font-medium text-gray-700\">\n              Tarih Aralığı\n            </label>\n            <div className=\"grid grid-cols-2 gap-2 mt-1\">\n              <input\n                type=\"date\"\n                id=\"startDate\"\n                value={dateRange.start}\n                onChange={(e) => setDateRange({ ...dateRange, start: e.target.value })}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n              <input\n                type=\"date\"\n                id=\"endDate\"\n                value={dateRange.end}\n                onChange={(e) => setDateRange({ ...dateRange, end: e.target.value })}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {filteredAppointments.length > 0 && (\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <Calendar className=\"w-5 h-5 text-blue-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-blue-600\">Toplam Randevu</p>\n                <p className=\"text-lg font-semibold text-blue-900\">{filteredStats.totalAppointments}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-green-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <Calendar className=\"w-5 h-5 text-green-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-green-600\">Yaklaşan Randevular</p>\n                <p className=\"text-lg font-semibold text-green-900\">{filteredStats.upcomingAppointments}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-purple-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <Calendar className=\"w-5 h-5 text-purple-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-purple-600\">En Çok Randevu Türü</p>\n                <p className=\"text-lg font-semibold text-purple-900\">\n                  {Object.keys(filteredStats.appointmentTypeCounts).length > 0\n                    ? Object.entries(filteredStats.appointmentTypeCounts).reduce((a, b) => a[1] > b[1] ? a : b)[0]\n                    : 'Yok'\n                  }\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {filteredAppointments.length === 0 ? (\n        <div className=\"text-center py-12\" role=\"status\">\n          <Calendar className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Henüz randevu yok</h3>\n          <p className=\"text-gray-500\">\n            Bu hastaya henüz randevu oluşturulmamış.\n          </p>\n        </div>\n      ) : (\n        <div className=\"grid gap-4\" role=\"list\" aria-label=\"Hasta randevuları listesi\">\n          {appointments.map((appointment) => (\n            <div key={appointment.id} role=\"listitem\" className=\"bg-white border border-gray-200 rounded-lg p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-3\">\n                  <Calendar className=\"w-5 h-5 text-blue-500\" />\n                  <div>\n                    <h4 className=\"text-sm font-medium text-gray-900\">\n                      {appointment.appointmentType} - {appointment.date} {appointment.time}\n                    </h4>\n                    <p className=\"text-sm text-gray-500\">\n                      Süre: {appointment.duration} dakika\n                    </p>\n                  </div>\n                </div>\n                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                  appointment.status === 'completed' ? 'bg-green-100 text-green-800' :\n                  appointment.status === 'scheduled' ? 'bg-blue-100 text-blue-800' :\n                  appointment.status === 'cancelled' ? 'bg-red-100 text-red-800' :\n                  'bg-gray-100 text-gray-800'\n                }`}>\n                  {appointment.status === 'completed' ? 'Tamamlandı' :\n                   appointment.status === 'scheduled' ? 'Planlandı' :\n                   appointment.status === 'cancelled' ? 'İptal Edildi' :\n                   appointment.status}\n                </span>\n              </div>\n              {appointment.notes && (\n                <p className=\"mt-2 text-sm text-gray-600\">{appointment.notes}</p>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n      <Button onClick={handleScheduleAppointment} aria-label=\"Yeni randevu oluştur\">\n        <Plus className=\"w-5 h-5\" aria-hidden=\"true\" />\n        Yeni Randevu Oluştur\n      </Button>\n      {showSchedulingForm && (\n        <AppointmentSchedulingForm\n          patientId={patientId}\n          isOpen={showSchedulingForm}\n          onClose={handleSchedulingFormClose}\n          onSave={handleAppointmentSave}\n          isLoading={isSubmitting}\n        />\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientDevicesTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorBoundary' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":209,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":209,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7118,7121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7118,7121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":223,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7588,7591],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7588,7591],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8222,8225],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8222,8225],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { usePatientDevices } from '../hooks/patient/usePatientDevices';\nimport { PatientDeviceCard } from './patient/PatientDeviceCard';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { DeviceAssignmentForm } from './forms/DeviceAssignmentForm';\nimport { DeviceEditModal } from './patient/DeviceEditModal';\nimport { DeviceTrialModal } from './patient/DeviceTrialModal';\nimport { DeviceMaintenanceModal } from './patient/DeviceMaintenanceModal';\nimport { InventoryManagementModal } from './patient/InventoryManagementModal';\nimport { Smartphone, AlertCircle, Plus, Edit, Trash2, RefreshCw, Settings } from 'lucide-react';\nimport { Button } from './ui/Button';\nimport { PatientDevice } from '../types/patient';\n\ninterface DeviceAssignment {\n  id?: string;\n  deviceId: string;\n  patientId: string;\n  assignedDate: string;\n  assignedBy: string;\n  status: 'assigned' | 'trial' | 'returned' | 'defective';\n  ear: 'left' | 'right' | 'both';\n  reason: 'sale' | 'service' | 'repair' | 'trial' | 'replacement' | 'proposal' | 'other';\n  notes?: string;\n  trialEndDate?: string;\n  returnDate?: string;\n  condition?: string;\n  listPrice?: number;\n  salePrice?: number;\n  sgkSupportType?: string;\n  sgkReduction?: number;\n  discountType?: 'none' | 'percentage' | 'amount';\n  discountValue?: number;\n  patientPayment?: number;\n  downPayment?: number;\n  remainingAmount?: number;\n  paymentMethod?: 'cash' | 'card' | 'transfer' | 'installment';\n  installmentCount?: number;\n  monthlyInstallment?: number;\n  serialNumber?: string;\n  serialNumberLeft?: string;\n  serialNumberRight?: string;\n  trialListPrice?: number;\n  trialPrice?: number;\n}\n\ninterface PatientDevicesTabProps {\n  patientId: string;\n  devices?: PatientDevice[];\n  tabCount?: number;\n}\n\nexport const PatientDevicesTab: React.FC<PatientDevicesTabProps> = ({\n  patientId,\n  devices,\n  tabCount\n}) => {\n  // State management\n  const [showAssignmentForm, setShowAssignmentForm] = useState(false);\n  const [editingDevice, setEditingDevice] = useState<PatientDevice | null>(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [showTrialModal, setShowTrialModal] = useState(false);\n  const [showMaintenanceModal, setShowMaintenanceModal] = useState(false);\n  const [showInventoryModal, setShowInventoryModal] = useState(false);\n  const [selectedDevice, setSelectedDevice] = useState<PatientDevice | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [actionError, setActionError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n\n  // Fetch devices data\n  const { data: fetchedDevices = [], isLoading, error } = usePatientDevices(patientId);\n\n  // Use provided devices or fetched devices\n  const devicesList = devices || fetchedDevices;\n\n  // Helper function to convert PatientDevice to DeviceAssignment\n  const convertToDeviceAssignment = (device: PatientDevice | null): DeviceAssignment | null => {\n    if (!device) return null;\n    \n    return {\n      id: device.id,\n      deviceId: device.id,\n      patientId: patientId,\n      assignedDate: device.assignedDate || new Date().toISOString(),\n      assignedBy: device.assignedBy || 'Current User',\n      status: device.status as 'assigned' | 'trial' | 'returned' | 'defective',\n      ear: device.ear === 'bilateral' ? 'both' : (device.ear || 'both') as 'left' | 'right' | 'both',\n      reason: device.reason === 'new' ? 'sale' : device.reason === 'warranty' ? 'service' : device.reason === 'upgrade' ? 'replacement' : (device.reason || 'sale') as 'sale' | 'service' | 'repair' | 'trial' | 'replacement' | 'proposal' | 'other',\n      notes: device.notes,\n      trialEndDate: device.trialEndDate,\n      listPrice: device.listPrice,\n      salePrice: device.salePrice,\n      sgkReduction: device.sgkReduction,\n      patientPayment: device.patientPayment,\n      paymentMethod: device.paymentMethod,\n      serialNumber: device.serialNumber,\n    };\n  };\n\n  // Clear messages after 5 seconds\n  useEffect(() => {\n    if (successMessage || actionError) {\n      const timer = setTimeout(() => {\n        setSuccessMessage(null);\n        setActionError(null);\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [successMessage, actionError]);\n\n  const handleDeviceClick = (device: PatientDevice) => {\n    console.log('Device clicked:', device);\n  };\n\n  const handleAssignDevice = () => {\n    setEditingDevice(null);\n    setShowAssignmentForm(true);\n    setActionError(null);\n  };\n\n  const handleEditDevice = (device: PatientDevice) => {\n    setEditingDevice(device);\n    setShowEditModal(true);\n  };\n\n  const handleEditModalClose = () => {\n    setShowEditModal(false);\n    setEditingDevice(null);\n  };\n\n  const handleDeviceUpdate = async (updatedDevice: PatientDevice) => {\n    try {\n      setActionError(null);\n      // TODO: Implement API call to update device\n      console.log('Updating device:', updatedDevice);\n      \n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      setSuccessMessage('Cihaz başarıyla güncellendi');\n      setShowEditModal(false);\n      setEditingDevice(null);\n      \n      // TODO: Refresh devices list\n    } catch (error) {\n      console.error('Error updating device:', error);\n      setActionError('Cihaz güncellenirken bir hata oluştu');\n    }\n  };\n\n  const handleRemoveDevice = async (deviceId: string) => {\n    try {\n      setActionError(null);\n      // TODO: Implement API call to remove device\n      console.log('Removing device:', deviceId);\n      \n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      setSuccessMessage('Cihaz başarıyla kaldırıldı');\n      \n      // TODO: Refresh devices list\n    } catch (error) {\n      console.error('Error removing device:', error);\n      setActionError('Cihaz kaldırılırken bir hata oluştu');\n    }\n  };\n\n  const handleReplaceDevice = async (deviceId: string) => {\n    try {\n      setActionError(null);\n      // TODO: Implement device replacement logic\n      console.log('Replacing device:', deviceId);\n      setSuccessMessage('Cihaz değiştirme işlemi başlatıldı');\n    } catch (error) {\n      console.error('Error replacing device:', error);\n      setActionError('Cihaz değiştirilirken bir hata oluştu');\n    }\n  };\n\n  const handleStartTrial = (device: PatientDevice) => {\n    setSelectedDevice(device);\n    setShowTrialModal(true);\n  };\n\n  const handleDeviceMaintenance = (device: PatientDevice) => {\n    setSelectedDevice(device);\n    setShowMaintenanceModal(true);\n  };\n\n  const handleInventoryManagement = () => {\n    setShowInventoryModal(true);\n  };\n\n  const handleTrialModalClose = () => {\n    setShowTrialModal(false);\n    setSelectedDevice(null);\n  };\n\n  const handleMaintenanceModalClose = () => {\n    setShowMaintenanceModal(false);\n    setSelectedDevice(null);\n  };\n\n  const handleInventoryModalClose = () => {\n    setShowInventoryModal(false);\n  };\n\n  const handleTrialSave = async (trialData: any) => {\n    try {\n      setActionError(null);\n      console.log('Starting device trial:', trialData);\n      setSuccessMessage('Cihaz deneme süreci başlatıldı');\n      setShowTrialModal(false);\n      setSelectedDevice(null);\n      // TODO: Refresh devices list\n    } catch (error) {\n      console.error('Error starting trial:', error);\n      setActionError('Deneme süreci başlatılırken hata oluştu');\n    }\n  };\n\n  const handleMaintenanceSave = async (maintenanceData: any) => {\n    try {\n      setActionError(null);\n      console.log('Scheduling device maintenance:', maintenanceData);\n      setSuccessMessage('Cihaz bakım kaydı oluşturuldu');\n      setShowMaintenanceModal(false);\n      setSelectedDevice(null);\n      // TODO: Refresh devices list\n    } catch (error) {\n      console.error('Error scheduling maintenance:', error);\n      setActionError('Bakım kaydı oluşturulurken hata oluştu');\n    }\n  };\n\n  const handleAssignmentFormClose = () => {\n    setShowAssignmentForm(false);\n    setEditingDevice(null);\n    setActionError(null);\n  };\n\n  const handleDeviceAssignment = async (assignmentData: any) => {\n    try {\n      setIsSubmitting(true);\n      setActionError(null);\n      \n      if (editingDevice) {\n        // Update existing device\n        console.log('Updating device assignment:', assignmentData);\n        setSuccessMessage('Cihaz ataması başarıyla güncellendi');\n      } else {\n        // Create new device assignment\n        console.log('Creating new device assignment:', assignmentData);\n        setSuccessMessage('Cihaz başarıyla atandı');\n      }\n      \n      setShowAssignmentForm(false);\n      setEditingDevice(null);\n      \n      // TODO: Refresh devices list\n    } catch (error) {\n      console.error('Error in device assignment:', error);\n      setActionError(editingDevice ? 'Cihaz güncellenirken bir hata oluştu' : 'Cihaz atanırken bir hata oluştu');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n            <Smartphone className=\"w-5 h-5 mr-2\" />\n            Hasta Cihazları\n          </h3>\n        </div>\n        <LoadingSkeleton lines={3} className=\"mb-4\" />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Cihazlar yüklenirken hata oluştu</h3>\n              <p className=\"mt-1 text-sm text-red-700\">\n                Lütfen sayfayı yenileyin veya daha sonra tekrar deneyin.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <Smartphone className=\"w-5 h-5 mr-2\" aria-hidden=\"true\" />\n          Hasta Cihazları {tabCount !== undefined && (\n            <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n              {tabCount}\n            </span>\n          )}\n        </h3>\n        <div className=\"flex items-center space-x-2\">\n          <Button\n            onClick={handleInventoryManagement}\n            aria-label=\"Envanter Yönetimi\"\n            className=\"flex items-center justify-center px-3 py-2 rounded-lg bg-purple-500 text-white hover:bg-purple-600\"\n          >\n            <Settings className=\"w-4 h-4 mr-2\" aria-hidden=\"true\" />\n            Envanter\n          </Button>\n          <Button\n            onClick={() => window.location.reload()}\n            aria-label=\"Yenile\"\n            className=\"flex items-center justify-center w-10 h-10 rounded-full bg-gray-500 text-white hover:bg-gray-600\"\n          >\n            <RefreshCw className=\"w-5 h-5\" aria-hidden=\"true\" />\n          </Button>\n          <Button\n            onClick={handleAssignDevice}\n            aria-label=\"Cihaz ata\"\n            className=\"flex items-center justify-center w-10 h-10 rounded-full bg-blue-500 text-white hover:bg-blue-600\"\n          >\n            <Plus className=\"w-5 h-5\" aria-hidden=\"true\" />\n          </Button>\n        </div>\n      </div>\n\n      {successMessage && (\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"w-5 h-5 text-green-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm text-green-800\">{successMessage}</p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {actionError && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <p className=\"text-sm text-red-800\">{actionError}</p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {devicesList.length === 0 ? (\n        <div className=\"text-center py-12\" role=\"status\">\n          <Smartphone className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Henüz cihaz atanmamış</h3>\n          <p className=\"text-gray-500 mb-4\">\n            Bu hastaya henüz cihaz atanmamış. Satış işlemi sonrasında cihazlar burada görünecek.\n          </p>\n          <Button\n            onClick={handleAssignDevice}\n            className=\"bg-blue-500 text-white hover:bg-blue-600\"\n          >\n            <Plus className=\"w-4 h-4 mr-2\" />\n            İlk Cihazı Ata\n          </Button>\n        </div>\n      ) : (\n        <div className=\"grid gap-4\" role=\"list\" aria-label=\"Hasta cihazları listesi\">\n          {devicesList.map((device) => (\n            <div key={device.id} role=\"listitem\" className=\"relative group\">\n              <PatientDeviceCard\n                device={device}\n                onDeviceClick={handleDeviceClick}\n              />\n              \n              {/* Device action overlay */}\n              <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200\">\n                <div className=\"flex items-center space-x-1 bg-white rounded-lg shadow-lg border p-1\">\n                  <Button\n                    onClick={() => handleEditDevice(device)}\n                    className=\"p-2 text-blue-600 hover:bg-blue-50 rounded\"\n                    title=\"Düzenle\"\n                    disabled={isSubmitting}\n                  >\n                    <Edit className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleStartTrial(device)}\n                    className=\"p-2 text-green-600 hover:bg-green-50 rounded\"\n                    title=\"Deneme Başlat\"\n                    disabled={isSubmitting}\n                  >\n                    <Settings className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleDeviceMaintenance(device)}\n                    className=\"p-2 text-yellow-600 hover:bg-yellow-50 rounded\"\n                    title=\"Bakım\"\n                    disabled={isSubmitting}\n                  >\n                    <Settings className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleReplaceDevice(device.id)}\n                    className=\"p-2 text-orange-600 hover:bg-orange-50 rounded\"\n                    title=\"Değiştir\"\n                    disabled={isSubmitting}\n                  >\n                    <RefreshCw className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleRemoveDevice(device.id)}\n                    className=\"p-2 text-red-600 hover:bg-red-50 rounded\"\n                    title=\"Kaldır\"\n                    disabled={isSubmitting}\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {showAssignmentForm && (\n          <DeviceAssignmentForm\n            patientId={patientId}\n            assignment={convertToDeviceAssignment(editingDevice)}\n            isOpen={showAssignmentForm}\n            onClose={handleAssignmentFormClose}\n            onSave={handleDeviceAssignment}\n          />\n        )}\n\n      {showEditModal && (\n        <DeviceEditModal\n          device={editingDevice}\n          open={showEditModal}\n          onClose={handleEditModalClose}\n          onSave={handleDeviceUpdate}\n        />\n      )}\n\n      {showTrialModal && selectedDevice && (\n        <DeviceTrialModal\n          device={selectedDevice}\n          patientId={patientId}\n          open={showTrialModal}\n          onClose={handleTrialModalClose}\n          onSave={handleTrialSave}\n        />\n      )}\n\n      {showMaintenanceModal && selectedDevice && (\n        <DeviceMaintenanceModal\n          device={selectedDevice}\n          open={showMaintenanceModal}\n          onClose={handleMaintenanceModalClose}\n          onSubmit={handleMaintenanceSave}\n        />\n      )}\n\n      {showInventoryModal && (\n        <InventoryManagementModal\n          isOpen={showInventoryModal}\n          onClose={handleInventoryModalClose}\n        />\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientDocumentsTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorBoundary' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Search' is defined but never used.","line":7,"column":64,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":70},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Filter' is defined but never used.","line":7,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":78},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2255,2258],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2255,2258],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleUploadDocument' is assigned a value but never used.","line":64,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2920,2923],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2920,2923],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useMemo\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":91,"column":29,"nodeType":"Identifier","endLine":91,"endColumn":36},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useMemo\" is called conditionally. React Hooks must be called in the exact same order in every component render. Did you accidentally call a React Hook after an early return?","line":124,"column":25,"nodeType":"Identifier","endLine":124,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":173,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":180,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":188,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":198,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":206,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":212,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":213,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":219,"endColumn":17}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport { usePatientDocuments } from '../hooks/patient/usePatientDocuments';\nimport { PatientDocumentCard } from './patient/PatientDocumentCard';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { DocumentUploadForm } from './forms/DocumentUploadForm';\nimport { File, AlertCircle, Clock, FileText, Smartphone, Plus, Search, Filter } from 'lucide-react';\nimport { Button } from './ui/Button';\n\ninterface PatientDocumentsTabProps {\n  patientId: string;\n  tabCount?: number;\n}\n\nexport const PatientDocumentsTab: React.FC<PatientDocumentsTabProps> = ({\n  patientId,\n  tabCount\n}) => {\n  const { documents, isLoading: documentsLoading, error: documentsError } = usePatientDocuments(patientId);\n  const [showUploadForm, setShowUploadForm] = useState(false);\n  const [isUploading, setIsUploading] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [documentTypeFilter, setDocumentTypeFilter] = useState<string>('all');\n  const [dateRange, setDateRange] = useState<{ start: string; end: string }>({\n    start: '',\n    end: ''\n  });\n\n  if (documentsLoading) {\n    return (\n      <div className=\"p-6\" role=\"status\" aria-label=\"Belgeler yükleniyor\">\n        <LoadingSkeleton lines={4} className=\"mb-4\" />\n        <div className=\"grid gap-4\">\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (documentsError) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Belgeler yüklenirken hata oluştu</h3>\n              <p className=\"mt-1 text-sm text-red-700\">\n                {typeof documentsError === 'string' ? documentsError : documentsError.message}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const handleDocumentClick = (document: any) => {\n    // TODO: Implement document preview modal\n    console.log('Document clicked:', document);\n  };\n\n  const handleUploadDocument = () => {\n    setShowUploadForm(true);\n  };\n\n  const handleUploadFormClose = () => {\n    setShowUploadForm(false);\n  };\n\n  const handleDocumentUpload = async (formData: FormData) => {\n    setIsUploading(true);\n    try {\n      // TODO: Implement document upload API call\n      console.log('Document upload:', formData);\n      setShowUploadForm(false);\n    } catch (error) {\n      console.error('Document upload failed:', error);\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const handleDownloadClick = (document: any) => {\n    // TODO: Implement document download\n    console.log('Download document:', document);\n  };\n\n  // Filter and search documents\n  const filteredDocuments = useMemo(() => {\n    let filtered = documents;\n\n    // Search filter\n    if (searchTerm) {\n      filtered = filtered.filter(doc =>\n        doc.fileName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        doc.documentType?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        doc.description?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        doc.tags?.some(tag => tag.toLowerCase().includes(searchTerm.toLowerCase()))\n      );\n    }\n\n    // Document type filter\n    if (documentTypeFilter !== 'all') {\n      filtered = filtered.filter(doc => doc.documentType === documentTypeFilter);\n    }\n\n    // Date range filter\n    if (dateRange.start) {\n      const startDate = new Date(dateRange.start);\n      filtered = filtered.filter(doc => doc.uploadDate && new Date(doc.uploadDate) >= startDate);\n    }\n    if (dateRange.end) {\n      const endDate = new Date(dateRange.end);\n      endDate.setHours(23, 59, 59, 999); // End of day\n      filtered = filtered.filter(doc => doc.uploadDate && new Date(doc.uploadDate) <= endDate);\n    }\n\n    return filtered;\n  }, [documents, searchTerm, documentTypeFilter, dateRange]);\n\n  // Calculate statistics based on filtered documents\n  const filteredStats = useMemo(() => {\n    const documentTypeCounts = filteredDocuments.reduce((acc, doc) => {\n      acc[doc.documentType] = (acc[doc.documentType] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n\n    const totalSize = filteredDocuments.reduce((sum, doc) => sum + (doc.fileSize || 0), 0);\n    const recentDocuments = filteredDocuments.filter(doc =>\n      doc.uploadDate && new Date(doc.uploadDate) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)\n    ).length;\n\n    return { documentTypeCounts, totalSize, recentDocuments };\n  }, [filteredDocuments]);\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <File className=\"w-5 h-5 mr-2\" aria-hidden=\"true\" />\n          Hasta Belgeleri {tabCount !== undefined && (\n            <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800\">\n              {tabCount}\n            </span>\n          )}\n        </h3>\n        {filteredDocuments.length > 0 && (\n          <div className=\"text-right\">\n            <p className=\"text-sm text-gray-600\">Toplam Boyut</p>\n            <p className=\"text-lg font-semibold text-green-600\">{formatFileSize(filteredStats.totalSize)}</p>\n          </div>\n        )}\n      </div>\n\n      {/* Search and Filter Section */}\n      <div className=\"bg-white rounded-lg shadow p-4 mb-6\">\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n          <div>\n            <label htmlFor=\"search\" className=\"block text-sm font-medium text-gray-700\">\n              Belge Ara\n            </label>\n            <div className=\"mt-1\">\n              <input\n                type=\"text\"\n                id=\"search\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                placeholder=\"Belge adını yazın...\"\n              />\n            </div>\n          </div>\n          <div>\n            <label htmlFor=\"documentType\" className=\"block text-sm font-medium text-gray-700\">\n              Belge Tipi\n            </label>\n            <div className=\"mt-1\">\n              <select\n                id=\"documentType\"\n                value={documentTypeFilter}\n                onChange={(e) => setDocumentTypeFilter(e.target.value)}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              >\n                <option value=\"all\">Tümü</option>\n                <option value=\"report\">Raporlar</option>\n                <option value=\"test_result\">Test Sonuçları</option>\n                {/* Add more document types as needed */}\n              </select>\n            </div>\n          </div>\n          <div>\n            <label htmlFor=\"dateRange\" className=\"block text-sm font-medium text-gray-700\">\n              Tarih Aralığı\n            </label>\n            <div className=\"grid grid-cols-2 gap-2 mt-1\">\n              <input\n                type=\"date\"\n                id=\"startDate\"\n                value={dateRange.start}\n                onChange={(e) => setDateRange({ ...dateRange, start: e.target.value })}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n              <input\n                type=\"date\"\n                id=\"endDate\"\n                value={dateRange.end}\n                onChange={(e) => setDateRange({ ...dateRange, end: e.target.value })}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {filteredDocuments.length > 0 && (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <File className=\"w-5 h-5 text-blue-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-blue-600\">Toplam Belge</p>\n                <p className=\"text-lg font-semibold text-blue-900\">{filteredDocuments.length}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-green-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <Clock className=\"w-5 h-5 text-green-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-green-600\">Son 30 Gün</p>\n                <p className=\"text-lg font-semibold text-green-900\">{filteredStats.recentDocuments}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-purple-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <FileText className=\"w-5 h-5 text-purple-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-purple-600\">Raporlar</p>\n                <p className=\"text-lg font-semibold text-purple-900\">{filteredStats.documentTypeCounts['report'] || 0}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-orange-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <Smartphone className=\"w-5 h-5 text-orange-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-orange-600\">Test Sonuçları</p>\n                <p className=\"text-lg font-semibold text-orange-900\">{filteredStats.documentTypeCounts['test_result'] || 0}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {filteredDocuments.length === 0 ? (\n        <div className=\"text-center py-12\" role=\"status\">\n          <File className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            {documents.length === 0 ? 'Henüz belge yok' : 'Filtreye uygun belge bulunamadı'}\n          </h3>\n          <p className=\"text-gray-500\">\n            {documents.length === 0\n              ? 'Bu hastaya ait henüz hiçbir belge yüklenmemiş.'\n              : 'Arama kriterlerinizi değiştirerek daha fazla sonuç görebilirsiniz.'\n            }\n          </p>\n        </div>\n      ) : (\n        <div className=\"grid gap-4\" role=\"list\" aria-label=\"Hasta belgeleri listesi\">\n          {filteredDocuments.map((document) => (\n            <div key={document.id} role=\"listitem\">\n              <PatientDocumentCard\n                document={document}\n                onDocumentClick={handleDocumentClick}\n                onDownloadClick={handleDownloadClick}\n              />\n            </div>\n          ))}\n        </div>\n      )}\n\n      <div className=\"mt-6\">\n        <Button\n          onClick={() => setShowUploadForm(true)}\n          className=\"w-full sm:w-auto\"\n          variant=\"primary\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" aria-hidden=\"true\" />\n          Yeni Belge Yükle\n        </Button>\n      </div>\n\n      {showUploadForm && (\n        <DocumentUploadForm\n          patientId={patientId}\n          isOpen={showUploadForm}\n          onClose={handleUploadFormClose}\n          onUpload={handleDocumentUpload}\n          isLoading={isUploading}\n        />\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientHeader.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":110,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4232,4235],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4232,4235],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { User, Phone, Mail, MapPin, Calendar, Tag } from 'lucide-react';\nimport { Patient } from '../types/patient';\n\ninterface PatientHeaderProps {\n  patient?: Patient;\n  isLoading?: boolean;\n}\n\nexport const PatientHeader: React.FC<PatientHeaderProps> = ({ patient, isLoading }) => {\n  if (isLoading || !patient) {\n    return (\n      <div className=\"bg-white shadow-sm border-b border-gray-200 p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"w-16 h-16 bg-gray-300 rounded-full\"></div>\n            <div className=\"flex-1\">\n              <div className=\"h-6 bg-gray-300 rounded w-48 mb-2\"></div>\n              <div className=\"h-4 bg-gray-300 rounded w-32\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const getInitials = (firstName?: string, lastName?: string) => {\n    const first = firstName?.charAt(0) || '';\n    const last = lastName?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase() || 'N/A';\n  };\n\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return 'N/A';\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const getStatusColor = (status?: string) => {\n    switch (status) {\n      case 'active':\n        return 'bg-green-100 text-green-800';\n      case 'inactive':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  return (\n    <div className=\"bg-white shadow-sm border-b border-gray-200 p-6\">\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          {/* Avatar */}\n          <div className=\"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-xl font-semibold\">\n            {getInitials(patient.firstName, patient.lastName)}\n          </div>\n          \n          {/* Patient Info */}\n          <div className=\"flex-1\">\n            <div className=\"flex items-center space-x-3 mb-2\">\n              <h1 className=\"text-2xl font-bold text-gray-900\">\n          {patient.firstName || ''} {patient.lastName || ''}\n        </h1>\n              <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(patient.status)}`}>\n                {patient.status === 'ACTIVE' ? 'Aktif' : 'Pasif'}\n              </span>\n            </div>\n            \n            {/* Contact Info */}\n            <div className=\"flex flex-wrap items-center gap-4 text-sm text-gray-600\">\n              <div className=\"flex items-center space-x-1\">\n                <User className=\"w-4 h-4\" />\n                <span>TC: {patient.tcNumber}</span>\n              </div>\n              \n              {patient.phone && (\n                <div className=\"flex items-center space-x-1\">\n                  <Phone className=\"w-4 h-4\" />\n                  <span>{patient.phone}</span>\n                </div>\n              )}\n              \n              {patient.email && (\n                <div className=\"flex items-center space-x-1\">\n                  <Mail className=\"w-4 h-4\" />\n                  <span>{patient.email}</span>\n                </div>\n              )}\n              \n              {patient.birthDate && (\n                <div className=\"flex items-center space-x-1\">\n                  <Calendar className=\"w-4 h-4\" />\n                  <span>Doğum: {formatDate(patient.birthDate)}</span>\n                </div>\n              )}\n            </div>\n            \n            {/* Address */}\n            {(patient.address || patient.addressFull) && (\n              <div className=\"flex items-center space-x-1 mt-2 text-sm text-gray-600\">\n                <MapPin className=\"w-4 h-4\" />\n                <span>\n                  {(() => {\n                    // Handle address as object or string\n                    const address = patient.address || patient.addressFull;\n                    if (typeof address === 'string') {\n                      return address;\n                    } else if (typeof address === 'object' && address !== null) {\n                      // Handle address object with city, district, fullAddress\n                      const addressObj = address as any;\n                      return addressObj.fullAddress || \n                             `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                             'Adres bilgisi yok';\n                    }\n                    return 'Adres bilgisi yok';\n                  })()}\n                </span>\n              </div>\n            )}\n          </div>\n        </div>\n        \n        {/* Tags and Additional Info */}\n        <div className=\"flex flex-col items-end space-y-2\">\n          {patient.tags && patient.tags.length > 0 && (\n            <div className=\"flex flex-wrap gap-1\">\n              {patient.tags.map((tag, index) => (\n                <span\n                  key={index}\n                  className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800\"\n                >\n                  <Tag className=\"w-3 h-3 mr-1\" />\n                  {tag}\n                </span>\n              ))}\n            </div>\n          )}\n          \n          {patient.segment && (\n            <div className=\"text-sm text-gray-600\">\n              <span className=\"font-medium\">Segment:</span> {patient.segment}\n            </div>\n          )}\n          \n          {patient.acquisitionType && (\n            <div className=\"text-sm text-gray-600\">\n              <span className=\"font-medium\">Kaynak:</span> {patient.acquisitionType}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientHearingTestsTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorBoundary' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleTestClick' is assigned a value but never used.","line":46,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1616,1619],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1616,1619],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { usePatientHearingTests } from '../hooks/patient/usePatientHearingTests';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { Activity, AlertCircle } from 'lucide-react';\n\ninterface PatientHearingTestsTabProps {\n  patientId: string;\n}\n\nexport const PatientHearingTestsTab: React.FC<PatientHearingTestsTabProps> = ({\n  patientId\n}) => {\n  const { hearingTests, isLoading: testsLoading, error: testsError } = usePatientHearingTests(patientId);\n\n  if (testsLoading) {\n    return (\n      <div className=\"p-6\" role=\"status\" aria-label=\"İşitme testleri yükleniyor\">\n        <LoadingSkeleton lines={4} className=\"mb-4\" />\n        <div className=\"grid gap-4\">\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (testsError) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">İşitme testleri yüklenirken hata oluştu</h3>\n              <p className=\"mt-1 text-sm text-red-700\">\n                {typeof testsError === 'string' ? testsError : testsError.message}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const handleTestClick = (test: any) => {\n    // TODO: Implement test detail modal or navigation\n    console.log('Test clicked:', test);\n  };\n\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return 'Belirtilmemiş';\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <Activity className=\"w-5 h-5 mr-2\" aria-hidden=\"true\" />\n          İşitme Testleri ({hearingTests.length})\n        </h3>\n      </div>\n\n      {hearingTests.length === 0 ? (\n        <div className=\"text-center py-12\" role=\"status\">\n          <Activity className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Henüz test yok</h3>\n          <p className=\"text-gray-500\">\n            Bu hastaya henüz işitme testi uygulanmamış.\n          </p>\n        </div>\n      ) : (\n        <div className=\"grid gap-4\" role=\"list\" aria-label=\"Hasta işitme testleri listesi\">\n          {hearingTests.map((test) => (\n            <div key={test.id} role=\"listitem\" className=\"bg-white border border-gray-200 rounded-lg p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-3\">\n                  <Activity className=\"w-5 h-5 text-purple-500\" />\n                  <div>\n                    <h4 className=\"text-sm font-medium text-gray-900\">\n                      {test.testType} - {formatDate(test.testDate)}\n                    </h4>\n                    {test.conductedBy && (\n                      <p className=\"text-sm text-gray-500\">\n                        Test eden: {test.conductedBy}\n                      </p>\n                    )}\n                  </div>\n                </div>\n              </div>\n              {test.notes && (\n                <p className=\"mt-2 text-sm text-gray-600\">{test.notes}</p>\n              )}\n              {test.results && (\n                <div className=\"mt-2\">\n                  <p className=\"text-xs text-gray-500\">Test sonuçları mevcut</p>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientNotesTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorBoundary' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleNoteClick' is assigned a value but never used.","line":145,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":145,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":145,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4885,4888],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4885,4888],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":158,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5175,5178],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5175,5178],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":201,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":208,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":215,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":225,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":231,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":241,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":248,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":254,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":255,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":261,"endColumn":17}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport { usePatientNotes } from '../hooks/patient/usePatientNotes';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { PatientNoteForm } from './forms/PatientNoteForm';\nimport { FileText, AlertCircle, Plus, Search, Filter } from 'lucide-react';\nimport { Button } from './ui/Button';\nimport { patientApiService } from '../services/patient/patient-api.service';\n\ninterface PatientNotesTabProps {\n  patientId: string;\n}\n\nexport const PatientNotesTab: React.FC<PatientNotesTabProps> = ({\n  patientId\n}) => {\n  const { notes, isLoading: notesLoading, error: notesError } = usePatientNotes(patientId);\n  const [showNoteForm, setShowNoteForm] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Search and filter states\n  const [searchTerm, setSearchTerm] = useState('');\n  const [noteTypeFilter, setNoteTypeFilter] = useState('');\n  const [categoryFilter, setCategoryFilter] = useState('');\n  const [dateRange, setDateRange] = useState({ start: '', end: '' });\n\n  // Filtered notes and statistics\n  const { filteredNotes, filteredStats } = useMemo(() => {\n    let filtered = notes;\n\n    // Text search\n    if (searchTerm) {\n      filtered = filtered.filter(note =>\n        note.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        note.content.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        note.tags?.some(tag => tag.toLowerCase().includes(searchTerm.toLowerCase()))\n      );\n    }\n\n    // Note type filter\n    if (noteTypeFilter) {\n      filtered = filtered.filter(note => note.noteType === noteTypeFilter);\n    }\n\n    // Category filter\n    if (categoryFilter) {\n      filtered = filtered.filter(note => note.category === categoryFilter);\n    }\n\n    // Date range filter\n    if (dateRange.start || dateRange.end) {\n      filtered = filtered.filter(note => {\n        const noteDate = new Date(note.createdAt);\n        const startDate = dateRange.start ? new Date(dateRange.start) : null;\n        const endDate = dateRange.end ? new Date(dateRange.end) : null;\n\n        if (startDate && noteDate < startDate) return false;\n        if (endDate && noteDate > endDate) return false;\n        return true;\n      });\n    }\n\n    // Calculate statistics\n    const noteTypeCounts = filtered.reduce((acc, note) => {\n      acc[note.noteType] = (acc[note.noteType] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n\n    const categoryCounts = filtered.reduce((acc, note) => {\n      acc[note.category] = (acc[note.category] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n\n    const recentNotes = filtered.filter(note => {\n      const noteDate = new Date(note.createdAt);\n      const thirtyDaysAgo = new Date();\n      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n      return noteDate > thirtyDaysAgo;\n    }).length;\n\n    return {\n      filteredNotes: filtered,\n      filteredStats: {\n        totalNotes: filtered.length,\n        noteTypeCounts,\n        categoryCounts,\n        recentNotes\n      }\n    };\n  }, [notes, searchTerm, noteTypeFilter, categoryFilter, dateRange]);\n\n  // Get unique note types and categories for filter dropdowns\n  const noteTypes = useMemo(() => {\n    const types = new Set(notes.map(note => note.noteType));\n    return Array.from(types).sort();\n  }, [notes]);\n\n  const categories = useMemo(() => {\n    const cats = new Set(notes.map(note => note.category));\n    return Array.from(cats).sort();\n  }, [notes]);\n\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return '';\n    const date = new Date(dateString);\n    return date.toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  if (notesLoading) {\n    return (\n      <div className=\"p-6\" role=\"status\" aria-label=\"Notlar yükleniyor\">\n        <LoadingSkeleton lines={4} className=\"mb-4\" />\n        <div className=\"grid gap-4\">\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (notesError) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Notlar yüklenirken hata oluştu</h3>\n              <p className=\"mt-1 text-sm text-red-700\">\n                {typeof notesError === 'string' ? notesError : notesError.message}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const handleNoteClick = (note: any) => {\n    // TODO: Implement note detail modal or navigation\n    console.log('Note clicked:', note);\n  };\n\n  const handleAddNote = () => {\n    setShowNoteForm(true);\n  };\n\n  const handleNoteFormClose = () => {\n    setShowNoteForm(false);\n  };\n\n  const handleNoteSave = async (noteData: any) => {\n    setIsSubmitting(true);\n    try {\n      await patientApiService.createNote(patientId, noteData);\n      setShowNoteForm(false);\n      \n      // Refresh notes data by refetching\n      // Since we don't have a refresh prop, we'll need to refetch the data\n      // This would typically be handled by the parent component or a data fetching hook\n      console.log('Note saved successfully');\n    } catch (error) {\n      console.error('Note save failed:', error);\n      throw error;\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <FileText className=\"w-5 h-5 mr-2\" aria-hidden=\"true\" />\n          Hasta Notları ({filteredNotes.length})\n        </h3>\n        <Button onClick={handleAddNote} aria-label=\"Not ekle\">\n          <Plus className=\"w-5 h-5\" />\n        </Button>\n      </div>\n\n      {/* Search and Filter Controls */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\n        <div className=\"flex items-center mb-4\">\n          <Filter className=\"w-5 h-5 text-gray-400 mr-2\" aria-hidden=\"true\" />\n          <h4 className=\"text-sm font-medium text-gray-900\">Arama ve Filtreleme</h4>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <div>\n            <label htmlFor=\"search\" className=\"block text-sm font-medium text-gray-700\">\n              Arama\n            </label>\n            <div className=\"relative mt-1\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" aria-hidden=\"true\" />\n              <input\n                type=\"text\"\n                id=\"search\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                placeholder=\"Başlık, içerik veya etiket ara...\"\n                className=\"pl-10 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n            </div>\n          </div>\n          <div>\n            <label htmlFor=\"noteType\" className=\"block text-sm font-medium text-gray-700\">\n              Not Türü\n            </label>\n            <select\n              id=\"noteType\"\n              value={noteTypeFilter}\n              onChange={(e) => setNoteTypeFilter(e.target.value)}\n              className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            >\n              <option value=\"\">Tümü</option>\n              {noteTypes.map(type => (\n                <option key={type} value={type}>{type}</option>\n              ))}\n            </select>\n          </div>\n          <div>\n            <label htmlFor=\"category\" className=\"block text-sm font-medium text-gray-700\">\n              Kategori\n            </label>\n            <select\n              id=\"category\"\n              value={categoryFilter}\n              onChange={(e) => setCategoryFilter(e.target.value)}\n              className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            >\n              <option value=\"\">Tümü</option>\n              {categories.map(cat => (\n                <option key={cat} value={cat}>{cat}</option>\n              ))}\n            </select>\n          </div>\n          <div>\n            <label htmlFor=\"dateRange\" className=\"block text-sm font-medium text-gray-700\">\n              Tarih Aralığı\n            </label>\n            <div className=\"grid grid-cols-2 gap-2 mt-1\">\n              <input\n                type=\"date\"\n                id=\"startDate\"\n                value={dateRange.start}\n                onChange={(e) => setDateRange({ ...dateRange, start: e.target.value })}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n              <input\n                type=\"date\"\n                id=\"endDate\"\n                value={dateRange.end}\n                onChange={(e) => setDateRange({ ...dateRange, end: e.target.value })}\n                className=\"block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {filteredNotes.length > 0 && (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <FileText className=\"w-5 h-5 text-blue-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-blue-600\">Toplam Not</p>\n                <p className=\"text-lg font-semibold text-blue-900\">{filteredStats.totalNotes}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-green-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <FileText className=\"w-5 h-5 text-green-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-green-600\">Son 30 Gün</p>\n                <p className=\"text-lg font-semibold text-green-900\">{filteredStats.recentNotes}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-purple-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <FileText className=\"w-5 h-5 text-purple-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-purple-600\">En Çok Not Türü</p>\n                <p className=\"text-lg font-semibold text-purple-900\">\n                  {Object.keys(filteredStats.noteTypeCounts).length > 0\n                    ? Object.entries(filteredStats.noteTypeCounts).reduce((a, b) => a[1] > b[1] ? a : b)[0]\n                    : 'Yok'\n                  }\n                </p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-orange-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <FileText className=\"w-5 h-5 text-orange-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-orange-600\">En Çok Kategori</p>\n                <p className=\"text-lg font-semibold text-orange-900\">\n                  {Object.keys(filteredStats.categoryCounts).length > 0\n                    ? Object.entries(filteredStats.categoryCounts).reduce((a, b) => a[1] > b[1] ? a : b)[0]\n                    : 'Yok'\n                  }\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {filteredNotes.length === 0 ? (\n        <div className=\"text-center py-12\" role=\"status\">\n          <FileText className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            {notes.length === 0 ? 'Henüz not yok' : 'Filtreye uygun not bulunamadı'}\n          </h3>\n          <p className=\"text-gray-500\">\n            {notes.length === 0\n              ? 'Bu hasta için henüz not girilmemiş.'\n              : 'Arama kriterlerinizi değiştirerek daha fazla sonuç görebilirsiniz.'\n            }\n          </p>\n        </div>\n      ) : (\n        <div className=\"grid gap-4\" role=\"list\" aria-label=\"Hasta notları listesi\">\n          {filteredNotes.map((note) => (\n            <div key={note.id} role=\"listitem\" className=\"bg-white border border-gray-200 rounded-lg p-4\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <div className=\"flex items-center space-x-3\">\n                  <FileText className=\"w-5 h-5 text-green-500\" />\n                  <div>\n                    <h4 className=\"text-sm font-medium text-gray-900\">{note.title}</h4>\n                    <p className=\"text-sm text-gray-500\">\n                      {note.noteType} • {note.category} • {formatDate(note.createdAt)}\n                    </p>\n                  </div>\n                </div>\n                {note.isPrivate && (\n                  <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800\">\n                    Özel\n                  </span>\n                )}\n              </div>\n              <p className=\"text-sm text-gray-600 line-clamp-3\">{note.content}</p>\n              {note.tags && note.tags.length > 0 && (\n                <div className=\"mt-2 flex flex-wrap gap-1\">\n                  {note.tags.map((tag, index) => (\n                    <span key={index} className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800\">\n                      {tag}\n                    </span>\n                  ))}\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n      {showNoteForm && (\n        <PatientNoteForm\n          patientId={patientId}\n          isOpen={showNoteForm}\n          onClose={handleNoteFormClose}\n          onSave={handleNoteSave}\n          isLoading={isSubmitting}\n        />\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientOverviewTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Phone' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Mail' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":7}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Patient } from '../types/patient';\nimport {\n  User,\n  Phone,\n  Mail,\n  MapPin,\n  Tag,\n  AlertCircle,\n  CheckCircle\n} from 'lucide-react';\n\ninterface PatientOverviewTabProps {\n  patient: Patient;\n}\n\nexport const PatientOverviewTab: React.FC<PatientOverviewTabProps> = ({ patient }) => {\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return 'Belirtilmemiş';\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Personal Information */}\n      <div className=\"bg-gray-50 rounded-lg p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <User className=\"w-5 h-5 mr-2\" />\n          Kişisel Bilgiler\n        </h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Ad Soyad</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.firstName || ''} {patient.lastName || ''}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">TC Kimlik No</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.tcNumber}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Telefon</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.phone || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">E-posta</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.email || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Doğum Tarihi</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{formatDate(patient.birthDate)}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Cinsiyet</label>\n            <p className=\"mt-1 text-sm text-gray-900\">Belirtilmemiş</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Address Information */}\n      <div className=\"bg-gray-50 rounded-lg p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <MapPin className=\"w-5 h-5 mr-2\" />\n          Adres Bilgileri\n        </h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div className=\"md:col-span-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">Tam Adres</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.addressFull || 'Belirtilmemiş'}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Additional Information */}\n      <div className=\"bg-gray-50 rounded-lg p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <Tag className=\"w-5 h-5 mr-2\" />\n          Ek Bilgiler\n        </h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Durum</label>\n            <p className=\"mt-1\">\n              <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                patient.status === 'ACTIVE' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\n              }`}>\n                {patient.status === 'ACTIVE' ? (\n                  <CheckCircle className=\"w-3 h-3 mr-1\" />\n                ) : (\n                  <AlertCircle className=\"w-3 h-3 mr-1\" />\n                )}\n                {patient.status === 'ACTIVE' ? 'Aktif' : 'Pasif'}\n              </span>\n            </p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Segment</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.segment || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Edinim Türü</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.acquisitionType || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Öncelik Skoru</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.priorityScore || 'Belirtilmemiş'}</p>\n          </div>\n        </div>\n\n        {patient.tags && patient.tags.length > 0 && (\n          <div className=\"mt-4\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Etiketler</label>\n            <div className=\"flex flex-wrap gap-2\">\n              {patient.tags.map((tag, index) => (\n                <span\n                  key={index}\n                  className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\"\n                >\n                  {tag}\n                </span>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientSalesTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorBoundary' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1589,1592],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1589,1592],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2022,2025],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2022,2025],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3076,3079],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3076,3079],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3281,3284],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3281,3284],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3932,3935],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3932,3935],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":129,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4044,4047],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4044,4047],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":134,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4164,4167],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4164,4167],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":139,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4286,4289],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4286,4289],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4415,4418],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4415,4418],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":200,"column":9,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":206,"endColumn":18}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { usePatientSales } from '../hooks/patient/usePatientSales';\nimport { useSalesFilters } from '../hooks/patient/useSalesFilters';\nimport { PatientSaleForm } from './forms/PatientSaleForm';\nimport { InvoiceModal } from './modals/InvoiceModal';\nimport { CollectionModal } from './modals/CollectionModal';\nimport { PromissoryNotesModal } from './modals/PromissoryNotesModal';\nimport { InstallmentModal } from './modals/InstallmentModal';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { SalesStatistics } from './patient/SalesStatistics';\nimport { SalesFilters } from './patient/SalesFilters';\nimport { SalesList } from './patient/SalesList';\nimport { patientApiService } from '../services/patient/patient-api.service';\nimport { DollarSign, AlertCircle, Plus } from 'lucide-react';\n\ninterface PatientSalesTabProps {\n  patientId: string;\n  tabCount?: number;\n}\n\nexport const PatientSalesTab: React.FC<PatientSalesTabProps> = ({\n  patientId,\n  tabCount\n}) => {\n  const { sales, isLoading: salesLoading, error: salesError, refresh } = usePatientSales(patientId);\n  const {\n    searchTerm,\n    setSearchTerm,\n    statusFilter,\n    setStatusFilter,\n    paymentMethodFilter,\n    setPaymentMethodFilter,\n    dateFrom,\n    setDateFrom,\n    dateTo,\n    setDateTo,\n    showFilters,\n    setShowFilters,\n    filteredSales,\n    clearFilters\n  } = useSalesFilters(sales);\n  \n  const [showSaleForm, setShowSaleForm] = useState(false);\n  const [editingSale, setEditingSale] = useState<any>(null);\n  const [isSaving, setIsSaving] = useState(false);\n  \n  // Modal states\n  const [showInvoiceModal, setShowInvoiceModal] = useState(false);\n  const [showCollectionModal, setShowCollectionModal] = useState(false);\n  const [showPromissoryNotesModal, setShowPromissoryNotesModal] = useState(false);\n  const [showInstallmentModal, setShowInstallmentModal] = useState(false);\n  const [selectedSale, setSelectedSale] = useState<any>(null);\n\n  if (salesLoading) {\n    return (\n      <div className=\"p-6\" role=\"status\" aria-label=\"Satışlar yükleniyor\">\n        <LoadingSkeleton lines={4} className=\"mb-4\" />\n        <div className=\"grid gap-4\">\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n          <div className=\"h-32 bg-gray-100 rounded animate-pulse\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (salesError) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Satışlar yüklenirken hata oluştu</h3>\n              <p className=\"mt-2 text-sm text-red-700\">\n                Lütfen sayfayı yenileyin veya daha sonra tekrar deneyin.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const handleSaleClick = (sale: any) => {\n    setEditingSale(sale);\n    setShowSaleForm(true);\n  };\n\n  const handleCreateSale = () => {\n    setEditingSale(null);\n    setShowSaleForm(true);\n  };\n\n  const handleSaveSale = async (saleData: any) => {\n    setIsSaving(true);\n    try {\n      if (editingSale) {\n        await patientApiService.updateSale(editingSale.id, saleData);\n      } else {\n        await patientApiService.createSale(patientId, saleData);\n      }\n      \n      setShowSaleForm(false);\n      setEditingSale(null);\n      \n      if (refresh) {\n        refresh(patientId);\n      }\n    } catch (error) {\n      console.error('Failed to save sale:', error);\n      throw error;\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleCloseForm = () => {\n    setShowSaleForm(false);\n    setEditingSale(null);\n  };\n\n  // Modal handlers\n  const handleShowInvoice = (sale: any) => {\n    setSelectedSale(sale);\n    setShowInvoiceModal(true);\n  };\n\n  const handleShowCollection = (sale: any) => {\n    setSelectedSale(sale);\n    setShowCollectionModal(true);\n  };\n\n  const handleShowPromissoryNotes = (sale: any) => {\n    setSelectedSale(sale);\n    setShowPromissoryNotesModal(true);\n  };\n\n  const handleShowInstallments = (sale: any) => {\n    setSelectedSale(sale);\n    setShowInstallmentModal(true);\n  };\n\n  const handleCollectPayment = async (paymentData: any) => {\n    try {\n      console.log('Collecting payment:', paymentData);\n      setShowCollectionModal(false);\n      setSelectedSale(null);\n      \n      if (refresh) {\n        refresh(patientId);\n      }\n    } catch (error) {\n      console.error('Failed to collect payment:', error);\n      throw error;\n    }\n  };\n\n  const handleCollectPromissoryNote = async (noteId: string, amount: number, paymentMethod: string) => {\n    try {\n      console.log('Collecting promissory note:', { noteId, amount, paymentMethod });\n      setShowPromissoryNotesModal(false);\n      setSelectedSale(null);\n      \n      if (refresh) {\n        refresh(patientId);\n      }\n    } catch (error) {\n      console.error('Failed to collect promissory note:', error);\n      throw error;\n    }\n  };\n\n  const handlePayInstallment = async (installmentId: string, amount: number, paymentMethod: string) => {\n    try {\n      console.log('Paying installment:', { installmentId, amount, paymentMethod });\n      setShowInstallmentModal(false);\n      setSelectedSale(null);\n      \n      if (refresh) {\n        refresh(patientId);\n      }\n    } catch (error) {\n      console.error('Failed to pay installment:', error);\n      throw error;\n    }\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <DollarSign className=\"w-5 h-5 mr-2\" aria-hidden=\"true\" />\n          Hasta Satışları {tabCount !== undefined && (\n            <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n              {tabCount}\n            </span>\n          )}\n        </h3>\n        <button\n          onClick={handleCreateSale}\n          className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Yeni Satış\n        </button>\n      </div>\n\n      <SalesFilters\n        searchTerm={searchTerm}\n        onSearchChange={setSearchTerm}\n        statusFilter={statusFilter}\n        onStatusFilterChange={setStatusFilter}\n        paymentMethodFilter={paymentMethodFilter}\n        onPaymentMethodFilterChange={setPaymentMethodFilter}\n        dateFrom={dateFrom}\n        onDateFromChange={setDateFrom}\n        dateTo={dateTo}\n        onDateToChange={setDateTo}\n        showFilters={showFilters}\n        onToggleFilters={() => setShowFilters(!showFilters)}\n        filteredCount={filteredSales.length}\n        totalCount={sales.length}\n        onClearFilters={clearFilters}\n      />\n\n      <SalesStatistics sales={filteredSales} isVisible={filteredSales.length > 0} />\n\n      <SalesList\n        sales={sales}\n        filteredSales={filteredSales}\n        onSaleClick={handleSaleClick}\n        onCreateInvoice={handleShowInvoice}\n        onViewInvoice={handleShowInvoice}\n        onManagePromissoryNotes={handleShowPromissoryNotes}\n        onCollectPayment={handleShowCollection}\n        onManageInstallments={handleShowInstallments}\n      />\n      \n      {/* Sale Form Modal */}\n      <PatientSaleForm\n        patientId={patientId}\n        sale={editingSale}\n        isOpen={showSaleForm}\n        onClose={handleCloseForm}\n        onSave={handleSaveSale}\n        isLoading={isSaving}\n      />\n\n      {/* Invoice Modal */}\n      <InvoiceModal\n        isOpen={showInvoiceModal}\n        onClose={() => {\n          setShowInvoiceModal(false);\n          setSelectedSale(null);\n        }}\n        patientId={selectedSale?.patientId}\n        onSuccess={(invoice) => {\n          console.log('Invoice created:', invoice);\n        }}\n        onError={(error) => {\n          console.error('Invoice creation error:', error);\n        }}\n      />\n\n      {/* Collection Modal */}\n      <CollectionModal\n        isOpen={showCollectionModal}\n        onClose={() => {\n          setShowCollectionModal(false);\n          setSelectedSale(null);\n        }}\n        sale={selectedSale}\n        onCollectPayment={handleCollectPayment}\n      />\n\n      {/* Promissory Notes Modal */}\n      <PromissoryNotesModal\n        isOpen={showPromissoryNotesModal}\n        onClose={() => {\n          setShowPromissoryNotesModal(false);\n          setSelectedSale(null);\n        }}\n        sale={selectedSale}\n        onCollectNote={handleCollectPromissoryNote}\n      />\n\n      {/* Installment Modal */}\n      <InstallmentModal\n        isOpen={showInstallmentModal}\n        onClose={() => {\n          setShowInstallmentModal(false);\n          setSelectedSale(null);\n        }}\n        sale={selectedSale}\n        onPayInstallment={handlePayInstallment}\n      />\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientTabContent.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientTabContent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientDeviceCard' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientSaleCard' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientTimelineCard' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientDocumentCard' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDate' is assigned a value but never used.","line":43,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":19}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Patient } from '../types/patient';\nimport { PatientDeviceCard } from './patient/PatientDeviceCard';\nimport { PatientSaleCard } from './patient/PatientSaleCard';\nimport { PatientTimelineCard } from './patient/PatientTimelineCard';\nimport { PatientDocumentCard } from './patient/PatientDocumentCard';\nimport { PatientOverviewTab } from './PatientOverviewTab';\nimport { PatientDevicesTab } from './PatientDevicesTab';\nimport { PatientSalesTab } from './PatientSalesTab';\nimport { PatientTimelineTab } from './PatientTimelineTab';\nimport { PatientDocumentsTab } from './PatientDocumentsTab';\nimport { PatientAppointmentsTab } from './PatientAppointmentsTab';\nimport { PatientHearingTestsTab } from './PatientHearingTestsTab';\nimport { PatientNotesTab } from './PatientNotesTab';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { Clock } from 'lucide-react';interface PatientTabContentProps {\n  activeTab: string;\n  patient?: Patient;\n  isLoading?: boolean;\n  tabCounts?: {\n    devices: number;\n    sales: number;\n    timeline: number;\n    documents: number;\n  };\n}\n\nexport const PatientTabContent: React.FC<PatientTabContentProps> = ({ \n  activeTab, \n  patient, \n  isLoading,\n  tabCounts \n}) => {\n  if (isLoading || !patient) {\n    return (\n      <div className=\"p-6\" role=\"status\" aria-label=\"Hasta bilgileri yükleniyor\">\n        <LoadingSkeleton lines={6} />\n      </div>\n    );\n  }\n\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return 'Belirtilmemiş';\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const renderComingSoon = (tabName: string) => (\n    <div className=\"p-6 text-center\">\n      <div className=\"max-w-sm mx-auto\">\n        <Clock className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">{tabName} Yakında Gelecek</h3>\n        <p className=\"text-gray-500\">\n          Bu özellik şu anda geliştirme aşamasında. Yakında kullanıma sunulacak.\n        </p>\n      </div>\n    </div>\n  );\n\n  switch (activeTab) {\n    case 'overview':\n      return (\n        <ErrorBoundary>\n          <PatientOverviewTab patient={patient} />\n        </ErrorBoundary>\n      );\n    case 'devices':\n      return (\n        <ErrorBoundary>\n          <PatientDevicesTab\n            patientId={patient?.id || ''}\n            devices={patient?.devices}\n            tabCount={tabCounts?.devices}\n          />\n        </ErrorBoundary>\n      );\n    case 'sales':\n      return (\n        <ErrorBoundary>\n          <PatientSalesTab\n            patientId={patient?.id || ''}\n            tabCount={tabCounts?.sales}\n          />\n        </ErrorBoundary>\n      );\n    case 'timeline':\n      return (\n        <ErrorBoundary>\n          <PatientTimelineTab\n            patientId={patient?.id || ''}\n            tabCount={tabCounts?.timeline}\n          />\n        </ErrorBoundary>\n      );\n    case 'documents':\n      return (\n        <ErrorBoundary>\n          <PatientDocumentsTab\n            patientId={patient?.id || ''}\n            tabCount={tabCounts?.documents}\n          />\n        </ErrorBoundary>\n      );\n    case 'appointments':\n      return (\n        <ErrorBoundary>\n          <PatientAppointmentsTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'tests':\n      return (\n        <ErrorBoundary>\n          <PatientHearingTestsTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'notes':\n      return (\n        <ErrorBoundary>\n          <PatientNotesTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'settings':\n      return renderComingSoon('Ayarlar');\n    default:\n      return (\n        <ErrorBoundary>\n          <PatientOverviewTab patient={patient} />\n        </ErrorBoundary>\n      );\n  }\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientTabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/PatientTimelineTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorBoundary' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Filter' is defined but never used.","line":6,"column":69,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":75},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":88,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3194,3197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3194,3197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":171,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":177,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":180,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":191,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":192,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":198,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":199,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":205,"endColumn":13}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport { usePatientTimeline } from '../hooks/patient/usePatientTimeline';\nimport { PatientTimelineCard } from './patient/PatientTimelineCard';\nimport { LoadingSkeleton } from './common/LoadingSkeleton';\nimport { ErrorBoundary } from './common/ErrorBoundary';\nimport { Activity, AlertCircle, Calendar, User, DollarSign, Search, Filter } from 'lucide-react';\n\ninterface PatientTimelineTabProps {\n  patientId: string;\n  tabCount?: number;\n}\n\nexport const PatientTimelineTab: React.FC<PatientTimelineTabProps> = ({\n  patientId,\n  tabCount\n}) => {\n  const { timeline, isLoading: timelineLoading, error: timelineError } = usePatientTimeline(patientId);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [eventTypeFilter, setEventTypeFilter] = useState<string>('all');\n  const [dateRange, setDateRange] = useState<{ start: string; end: string }>({\n    start: '',\n    end: ''\n  });\n\n  // Filter and search logic\n  const filteredTimeline = useMemo(() => {\n    let filtered = timeline;\n\n    // Search filter\n    if (searchTerm) {\n      filtered = filtered.filter(event =>\n        event.description?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        event.eventType?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        event.details?.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    // Event type filter\n    if (eventTypeFilter !== 'all') {\n      filtered = filtered.filter(event => event.eventType === eventTypeFilter);\n    }\n\n    // Date range filter\n    if (dateRange.start) {\n      const startDate = new Date(dateRange.start);\n      filtered = filtered.filter(event => event.timestamp && new Date(event.timestamp) >= startDate);\n    }\n    if (dateRange.end) {\n      const endDate = new Date(dateRange.end);\n      endDate.setHours(23, 59, 59, 999); // End of day\n      filtered = filtered.filter(event => event.timestamp && new Date(event.timestamp) <= endDate);\n    }\n\n    return filtered;\n  }, [timeline, searchTerm, eventTypeFilter, dateRange]);\n\n  if (timelineLoading) {\n    return (\n      <div className=\"p-6\" role=\"status\" aria-label=\"Zaman çizelgesi yükleniyor\">\n        <LoadingSkeleton lines={4} className=\"mb-4\" />\n        <div className=\"space-y-4\">\n          <div className=\"h-24 bg-gray-100 rounded animate-pulse\"></div>\n          <div className=\"h-24 bg-gray-100 rounded animate-pulse\"></div>\n          <div className=\"h-24 bg-gray-100 rounded animate-pulse\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (timelineError) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\" role=\"alert\">\n          <div className=\"flex\">\n            <AlertCircle className=\"w-5 h-5 text-red-400\" aria-hidden=\"true\" />\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Zaman çizelgesi yüklenirken hata oluştu</h3>\n              <p className=\"mt-1 text-sm text-red-700\">\n                {typeof timelineError === 'string' ? timelineError : timelineError.message}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const handleEventClick = (event: any) => {\n    // TODO: Implement event detail modal or navigation\n    console.log('Event clicked:', event);\n  };\n\n  // Sort timeline by date (newest first)\n  const sortedTimeline = [...filteredTimeline].sort((a, b) =>\n    new Date(b.eventDate).getTime() - new Date(a.eventDate).getTime()\n  );\n\n  // Calculate statistics\n  const eventTypeCounts = timeline.reduce((acc, event) => {\n    acc[event.eventType] = (acc[event.eventType] || 0) + 1;\n    return acc;\n  }, {} as Record<string, number>);\n\n  const recentEvents = timeline.filter(event =>\n    new Date(event.eventDate) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)\n  ).length;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <Activity className=\"w-5 h-5 mr-2\" aria-hidden=\"true\" />\n          Zaman Çizelgesi {tabCount !== undefined && (\n            <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800\">\n              {tabCount}\n            </span>\n          )}\n        </h3>\n        {timeline.length > 0 && (\n          <div className=\"text-right\">\n            <p className=\"text-sm text-gray-600\">Son 30 Gün</p>\n            <p className=\"text-lg font-semibold text-blue-600\">{recentEvents} olay</p>\n          </div>\n        )}\n      </div>\n\n      {timeline.length > 0 && (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <Activity className=\"w-5 h-5 text-blue-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-blue-600\">Toplam Olay</p>\n                <p className=\"text-lg font-semibold text-blue-900\">{timeline.length}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-green-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <Calendar className=\"w-5 h-5 text-green-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-green-600\">Son 30 Gün</p>\n                <p className=\"text-lg font-semibold text-green-900\">{recentEvents}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-purple-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <User className=\"w-5 h-5 text-purple-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-purple-600\">Randevu</p>\n                <p className=\"text-lg font-semibold text-purple-900\">{eventTypeCounts['appointment'] || 0}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-orange-50 p-4 rounded-lg\">\n            <div className=\"flex items-center\">\n              <DollarSign className=\"w-5 h-5 text-orange-500 mr-2\" />\n              <div>\n                <p className=\"text-sm text-orange-600\">Satış</p>\n                <p className=\"text-lg font-semibold text-orange-900\">{eventTypeCounts['sale'] || 0}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex flex-col sm:flex-row gap-4 mb-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-3 w-5 h-5 text-gray-400\" aria-hidden=\"true\" />\n          <input\n            type=\"text\"\n            placeholder=\"Olay ara...\"\n            className=\"block w-full pl-10 pr-4 py-2 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n        </div>\n        <div className=\"flex gap-2\">\n          <select\n            value={eventTypeFilter}\n            onChange={(e) => setEventTypeFilter(e.target.value)}\n            className=\"px-3 py-2 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n          >\n            <option value=\"all\">Tüm Olay Türleri</option>\n            <option value=\"appointment\">Randevu</option>\n            <option value=\"sale\">Satış</option>\n            <option value=\"device_assignment\">Cihaz Atama</option>\n            <option value=\"note\">Not</option>\n            <option value=\"document\">Doküman</option>\n          </select>\n          <input\n            type=\"date\"\n            placeholder=\"Başlangıç tarihi\"\n            className=\"px-3 py-2 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n            value={dateRange.start}\n            onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n          />\n          <input\n            type=\"date\"\n            placeholder=\"Bitiş tarihi\"\n            className=\"px-3 py-2 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n            value={dateRange.end}\n            onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n          />\n        </div>\n      </div>\n\n      {filteredTimeline.length === 0 ? (\n        <div className=\"text-center py-12\" role=\"status\">\n          <Activity className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            {timeline.length === 0 ? 'Henüz olay yok' : 'Filtreye uygun olay bulunamadı'}\n          </h3>\n          <p className=\"text-gray-500\">\n            {timeline.length === 0\n              ? 'Bu hastayla ilgili henüz hiçbir olay kaydedilmemiş.'\n              : 'Arama kriterlerinizi değiştirerek daha fazla sonuç görebilirsiniz.'\n            }\n          </p>\n        </div>\n      ) : (\n        <div className=\"space-y-4\" role=\"list\" aria-label=\"Hasta zaman çizelgesi\">\n          {sortedTimeline.map((event) => (\n            <div key={event.id} role=\"listitem\">\n              <PatientTimelineCard\n                event={event}\n                onEventClick={handleEventClick}\n              />\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/ResponsiveLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/SGKDocumentList.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MoreHorizontal' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onDocumentSelect' is defined but never used.","line":39,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_onWorkflowUpdate' is defined but never used.","line":42,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_setSelectedStatus' is assigned a value but never used.","line":51,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":44},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3178,3181],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3178,3181],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3201,3204],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3201,3204],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadDocuments'. Either include it or remove the dependency array.","line":297,"column":6,"nodeType":"ArrayExpression","endLine":297,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [patientId, filters, loadDocuments]","fix":{"range":[9174,9194],"text":"[patientId, filters, loadDocuments]"}}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":471,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":480,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":543,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":552,"endColumn":32}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { Button, Input, Select } from '@x-ear/ui-web';\nimport { \n  SGKDocument, \n  SGKDocumentFilters, \n  SGKSearchResult,\n  SGKWorkflowStatus,\n  SGKDocumentType\n} from '../types/sgk';\nimport sgkService from '../services/sgk/sgk.service';\nimport { \n  Download, \n  Trash2, \n  CheckSquare, \n  Square, \n  MoreHorizontal,\n  Eye,\n  Edit\n} from 'lucide-react';\nimport DocumentViewer from './DocumentViewer';\n\ntype SGKProcessingStatus = 'pending' | 'processing' | 'completed' | 'failed';\n\ninterface SGKDocumentListProps {\n  patientId?: string;\n  filters?: SGKDocumentFilters;\n  onDocumentSelect?: (document: SGKDocument) => void;\n  onDocumentEdit?: (document: SGKDocument) => void;\n  onDocumentDelete?: (documentId: string) => void;\n  onWorkflowUpdate?: (documentId: string, status: SGKWorkflowStatus) => void;\n  showActions?: boolean;\n  compact?: boolean;\n}\n\nexport const SGKDocumentList: React.FC<SGKDocumentListProps> = ({\n  patientId,\n  filters: externalFilters,\n  onDocumentSelect,\n  onDocumentEdit,\n  onDocumentDelete,\n  onWorkflowUpdate: _onWorkflowUpdate,\n  showActions = true,\n  compact = false\n}) => {\n  const [documents, setDocuments] = useState<SGKDocument[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedType, setSelectedType] = useState<SGKDocumentType | ''>('');\n  const [selectedStatus, _setSelectedStatus] = useState<SGKWorkflowStatus | ''>('');\n  const [selectedProcessingStatus, setSelectedProcessingStatus] = useState<SGKProcessingStatus | ''>('');\n  const [sortBy, setSortBy] = useState<'date' | 'name' | 'type' | 'status'>('date');\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\n  \n  // Batch operations state\n  const [selectedDocuments, setSelectedDocuments] = useState<Set<string>>(new Set());\n  const [showBatchActions, setShowBatchActions] = useState(false);\n  const [batchLoading, setBatchLoading] = useState(false);\n  \n  // Document viewer state\n  const [viewerDocument, setViewerDocument] = useState<SGKDocument | null>(null);\n  const [showViewer, setShowViewer] = useState(false);\n\n  // Load documents function\n  const filters = useMemo(() => ({\n    ...externalFilters,\n    patientId,\n    search: searchTerm || undefined,\n    documentType: selectedType || undefined,\n    status: selectedStatus || undefined,\n    processingStatus: selectedProcessingStatus || undefined\n  }), [externalFilters, patientId, searchTerm, selectedType, selectedStatus, selectedProcessingStatus]);\n\n  const loadDocuments = async () => {\n    if (!patientId) return;\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      const result: SGKSearchResult = await sgkService.listDocuments(patientId, filters);\n      setDocuments(result.documents);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Belgeler yüklenirken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const sortedDocuments = useMemo(() => {\n    const sorted = [...documents];\n    \n    sorted.sort((a, b) => {\n      let aValue: any;\n      let bValue: any;\n\n      switch (sortBy) {\n        case 'name':\n          aValue = a.filename;\n          bValue = b.filename;\n          break;\n        case 'type':\n          aValue = a.documentType;\n          bValue = b.documentType;\n          break;\n        case 'status':\n          aValue = a.processingStatus;\n          bValue = b.processingStatus;\n          break;\n        case 'date':\n        default:\n          aValue = new Date(a.createdAt);\n          bValue = new Date(b.createdAt);\n          break;\n      }\n\n      if (aValue === undefined || aValue === null) aValue = '';\n      if (bValue === undefined || bValue === null) bValue = '';\n\n      if (aValue < bValue) return sortOrder === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortOrder === 'asc' ? 1 : -1;\n      return 0;\n    });\n\n    return sorted;\n  }, [documents, sortBy, sortOrder]);\n\n  const getDocumentTypeLabel = (type: SGKDocumentType): string => {\n    const labels: Record<SGKDocumentType, string> = {\n      recete: 'E-Reçete',\n      rapor: 'Rapor',\n      belge: 'Belge',\n      fatura: 'Fatura',\n      teslim: 'Teslim Belgesi',\n      iade: 'İade Belgesi'\n    };\n    return labels[type] || type;\n  };\n\n  const getProcessingStatusColor = (status: SGKProcessingStatus): string => {\n    switch (status) {\n      case 'pending': return 'bg-yellow-100 text-yellow-800';\n      case 'processing': return 'bg-blue-100 text-blue-800';\n      case 'completed': return 'bg-green-100 text-green-800';\n      case 'failed': return 'bg-red-100 text-red-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getProcessingStatusLabel = (status: SGKProcessingStatus): string => {\n    const labels: Record<SGKProcessingStatus, string> = {\n      pending: 'Bekliyor',\n      processing: 'İşleniyor',\n      completed: 'Tamamlandı',\n      failed: 'Başarısız'\n    };\n    return labels[status] || status;\n  };\n\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  const formatDate = (dateString: string): string => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Batch operations handlers\n  const handleSelectAll = () => {\n    if (selectedDocuments.size === sortedDocuments.length) {\n      setSelectedDocuments(new Set());\n    } else {\n      setSelectedDocuments(new Set(sortedDocuments.map(doc => doc.id)));\n    }\n  };\n\n  const handleSelectDocument = (documentId: string) => {\n    const newSelected = new Set(selectedDocuments);\n    if (newSelected.has(documentId)) {\n      newSelected.delete(documentId);\n    } else {\n      newSelected.add(documentId);\n    }\n    setSelectedDocuments(newSelected);\n  };\n\n  const handleBulkDelete = async () => {\n    if (selectedDocuments.size === 0) return;\n    \n    const confirmMessage = `${selectedDocuments.size} belgeyi silmek istediğinizden emin misiniz?`;\n    if (!window.confirm(confirmMessage)) return;\n\n    setBatchLoading(true);\n    try {\n      const deletePromises = Array.from(selectedDocuments).map(id => \n        sgkService.deleteDocument(id)\n      );\n      await Promise.all(deletePromises);\n      \n      await loadDocuments();\n      setSelectedDocuments(new Set());\n      setShowBatchActions(false);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Toplu silme işlemi başarısız');\n    } finally {\n      setBatchLoading(false);\n    }\n  };\n\n  const handleBulkDownload = async () => {\n    if (selectedDocuments.size === 0) return;\n    \n    setBatchLoading(true);\n    try {\n      const selectedDocs = sortedDocuments.filter(doc => selectedDocuments.has(doc.id));\n      \n      // Create a zip file or download individually\n      for (const doc of selectedDocs) {\n        if (doc.fileUrl) {\n          const link = document.createElement('a');\n          link.href = doc.fileUrl;\n          link.download = doc.filename;\n          document.body.appendChild(link);\n          link.click();\n          document.body.removeChild(link);\n          \n          // Add small delay between downloads\n          await new Promise(resolve => setTimeout(resolve, 500));\n        }\n      }\n      \n      setSelectedDocuments(new Set());\n      setShowBatchActions(false);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Toplu indirme işlemi başarısız');\n    } finally {\n      setBatchLoading(false);\n    }\n  };\n\n  const handleBulkStatusUpdate = async (status: SGKWorkflowStatus) => {\n    if (selectedDocuments.size === 0) return;\n    \n    setBatchLoading(true);\n    try {\n      const updatePromises = Array.from(selectedDocuments).map(id => \n        sgkService.updateDocumentStatus(id, status)\n      );\n      await Promise.all(updatePromises);\n      \n      await loadDocuments();\n      setSelectedDocuments(new Set());\n      setShowBatchActions(false);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Toplu durum güncelleme başarısız');\n    } finally {\n      setBatchLoading(false);\n    }\n  };\n\n  // Document viewer handlers\n  const handleViewDocument = (document: SGKDocument) => {\n    setViewerDocument(document);\n    setShowViewer(true);\n  };\n\n  const handleDownloadDocument = (document: SGKDocument) => {\n    if (document.fileUrl) {\n      const link = document.createElement('a');\n      link.href = document.fileUrl;\n      link.download = document.filename;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    }\n  };\n\n  // Update showBatchActions when selection changes\n  useEffect(() => {\n    setShowBatchActions(selectedDocuments.size > 0);\n  }, [selectedDocuments]);\n\n  // Load documents on mount and filter changes\n  useEffect(() => {\n    loadDocuments();\n  }, [patientId, filters]);\n\n  // Handle sorting\n  const handleSort = (field: 'date' | 'name' | 'type' | 'status') => {\n    if (sortBy === field) {\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortBy(field);\n      setSortOrder('asc');\n    }\n  };\n\n  // Handle delete\n  const handleDelete = async (documentId: string) => {\n    if (!window.confirm('Bu belgeyi silmek istediğinizden emin misiniz?')) return;\n    \n    try {\n      await sgkService.deleteDocument(documentId);\n      await loadDocuments();\n      onDocumentDelete?.(documentId);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Belge silinirken hata oluştu');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-2 text-gray-600\">Belgeler yükleniyor...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n        <div className=\"flex\">\n          <div className=\"flex-shrink-0\">\n            <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n          <div className=\"ml-3\">\n            <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n            <p className=\"mt-1 text-sm text-red-700\">{error}</p>\n\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Filters */}\n      {!compact && (\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div>\n              <Input\n                placeholder=\"Belge ara...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full\"\n              />\n            </div>\n            <div>\n              <Select\n                value={selectedType}\n                onValueChange={setSelectedType}\n                placeholder=\"Belge türü\"\n              >\n                <option value=\"\">Tüm türler</option>\n                <option value=\"recete\">E-Reçete</option>\n                <option value=\"rapor\">Rapor</option>\n                <option value=\"belge\">Belge</option>\n                <option value=\"fatura\">Fatura</option>\n                <option value=\"teslim\">Teslim Belgesi</option>\n                <option value=\"iade\">İade Belgesi</option>\n              </Select>\n            </div>\n            <div>\n              <Select\n                value={selectedProcessingStatus}\n                onValueChange={setSelectedProcessingStatus}\n                placeholder=\"İşlem durumu\"\n              >\n                <option value=\"\">Tüm durumlar</option>\n                <option value=\"pending\">Bekliyor</option>\n                <option value=\"processing\">İşleniyor</option>\n                <option value=\"completed\">Tamamlandı</option>\n                <option value=\"failed\">Başarısız</option>\n              </Select>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Batch Actions Bar */}\n      {showBatchActions && (\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-4\">\n              <span className=\"text-sm font-medium text-blue-900\">\n                {selectedDocuments.size} belge seçildi\n              </span>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setSelectedDocuments(new Set())}\n                disabled={batchLoading}\n              >\n                Seçimi Temizle\n              </Button>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleBulkDownload}\n                disabled={batchLoading}\n                className=\"flex items-center space-x-1\"\n              >\n                <Download className=\"w-4 h-4\" />\n                <span>İndir</span>\n              </Button>\n              \n              <Select\n                value=\"\"\n                onValueChange={handleBulkStatusUpdate}\n                placeholder=\"Durum Güncelle\"\n                disabled={batchLoading}\n              >\n                <option value=\"pending\">Bekliyor</option>\n                <option value=\"processing\">İşleniyor</option>\n                <option value=\"completed\">Tamamlandı</option>\n                <option value=\"failed\">Başarısız</option>\n              </Select>\n              \n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleBulkDelete}\n                disabled={batchLoading}\n                className=\"flex items-center space-x-1 text-red-600 hover:text-red-700\"\n              >\n                <Trash2 className=\"w-4 h-4\" />\n                <span>Sil</span>\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Document List */}\n      <div className=\"bg-white rounded-lg shadow-sm border overflow-hidden\">\n        {sortedDocuments.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n            </svg>\n            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Belge bulunamadı</h3>\n            <p className=\"mt-1 text-sm text-gray-500\">\n              Filtreleri değiştirerek tekrar deneyin.\n            </p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left\">\n                    <button\n                      onClick={handleSelectAll}\n                      className=\"flex items-center justify-center w-5 h-5 text-gray-500 hover:text-gray-700\"\n                    >\n                      {selectedDocuments.size === sortedDocuments.length ? (\n                        <CheckSquare className=\"w-4 h-4\" />\n                      ) : (\n                        <Square className=\"w-4 h-4\" />\n                      )}\n                    </button>\n                  </th>\n                  <th \n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                    onClick={() => handleSort('name')}\n                  >\n                    Belge Adı\n                    {sortBy === 'name' && (\n                      <span className=\"ml-1\">\n                        {sortOrder === 'asc' ? '↑' : '↓'}\n                      </span>\n                    )}\n                  </th>\n                  <th \n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                    onClick={() => handleSort('type')}\n                  >\n                    Tür\n                    {sortBy === 'type' && (\n                      <span className=\"ml-1\">\n                        {sortOrder === 'asc' ? '↑' : '↓'}\n                      </span>\n                    )}\n                  </th>\n                  <th \n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                    onClick={() => handleSort('status')}\n                  >\n                    Durum\n                    {sortBy === 'status' && (\n                      <span className=\"ml-1\">\n                        {sortOrder === 'asc' ? '↑' : '↓'}\n                      </span>\n                    )}\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Boyut\n                  </th>\n                  <th \n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                    onClick={() => handleSort('date')}\n                  >\n                    Tarih\n                    {sortBy === 'date' && (\n                      <span className=\"ml-1\">\n                        {sortOrder === 'asc' ? '↑' : '↓'}\n                      </span>\n                    )}\n                  </th>\n                  {showActions && (\n                    <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      İşlemler\n                    </th>\n                  )}\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {sortedDocuments.map((document) => (\n                  <tr \n                    key={document.id} \n                    className={`hover:bg-gray-50 ${selectedDocuments.has(document.id) ? 'bg-blue-50' : ''}`}\n                  >\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <button\n                        onClick={() => handleSelectDocument(document.id)}\n                        className=\"flex items-center justify-center w-5 h-5 text-gray-500 hover:text-gray-700\"\n                      >\n                        {selectedDocuments.has(document.id) ? (\n                          <CheckSquare className=\"w-4 h-4 text-blue-600\" />\n                        ) : (\n                          <Square className=\"w-4 h-4\" />\n                        )}\n                      </button>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 h-8 w-8\">\n                          <div className=\"h-8 w-8 bg-blue-100 rounded-lg flex items-center justify-center\">\n                            <svg className=\"h-4 w-4 text-blue-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                            </svg>\n                          </div>\n                        </div>\n                        <div className=\"ml-4\">\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {document.filename}\n                          </div>\n                          {document.extractedInfo?.patientName && (\n                            <div className=\"text-sm text-gray-500\">\n                              {document.extractedInfo.patientName}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                        {getDocumentTypeLabel(document.documentType)}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getProcessingStatusColor(document.processingStatus)}`}>\n                        {getProcessingStatusLabel(document.processingStatus)}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                      {formatFileSize(document.fileSize || 0)}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                      {formatDate(document.createdAt)}\n                    </td>\n                    {showActions && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                        <div className=\"flex items-center justify-end space-x-2\">\n                          <Button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleViewDocument(document);\n                            }}\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"text-blue-600 hover:text-blue-900\"\n                          >\n                            <Eye className=\"w-4 h-4\" />\n                          </Button>\n                          \n                          {onDocumentEdit && (\n                            <Button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                onDocumentEdit(document);\n                              }}\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              className=\"text-gray-600 hover:text-gray-900\"\n                            >\n                              <Edit className=\"w-4 h-4\" />\n                            </Button>\n                          )}\n                          \n                          <Button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleDelete(document.id);\n                            }}\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"text-red-600 hover:text-red-900\"\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </td>\n                    )}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n      {/* Summary */}\n      {!compact && sortedDocuments.length > 0 && (\n        <div className=\"text-sm text-gray-500 text-center\">\n          Toplam {sortedDocuments.length} belge gösteriliyor\n          {selectedDocuments.size > 0 && (\n            <span className=\"ml-2 text-blue-600\">\n              • {selectedDocuments.size} seçili\n            </span>\n          )}\n        </div>\n      )}\n\n      {/* Document Viewer Modal */}\n      <DocumentViewer\n        document={viewerDocument}\n        isOpen={showViewer}\n        onClose={() => {\n          setShowViewer(false);\n          setViewerDocument(null);\n        }}\n        onDownload={handleDownloadDocument}\n      />\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/SGKUpload.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'validateFile'. Either include it or remove the dependency array.","line":101,"column":6,"nodeType":"ArrayExpression","endLine":101,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [onUploadError, validateFile]","fix":{"range":[2887,2915],"text":"[onUploadError, validateFile]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React, { useState, useRef, useCallback } from 'react';\nimport { Button, Input, Select, Textarea } from '@x-ear/ui-web';\nimport { \n  SGKDocument, \n  SGKDocumentType, \n  SGKDocumentFormData,\n  SGKValidation,\n  OCRProcessingResult\n} from '../types/sgk';\nimport sgkService from '../services/sgk/sgk.service';\n\ninterface SGKUploadProps {\n  patientId?: string;\n  onUploadComplete?: (document: SGKDocument) => void;\n  onUploadError?: (error: string) => void;\n  allowedTypes?: SGKDocumentType[];\n  maxFileSize?: number; // in bytes\n  autoProcess?: boolean;\n  compact?: boolean;\n}\n\nexport const SGKUpload: React.FC<SGKUploadProps> = ({\n  patientId,\n  onUploadComplete,\n  onUploadError,\n  allowedTypes = ['recete', 'rapor', 'belge', 'fatura', 'teslim', 'iade'],\n  maxFileSize = 10 * 1024 * 1024, // 10MB\n  autoProcess = true,\n  compact = false\n}) => {\n  const [formData, setFormData] = useState<SGKDocumentFormData>({\n    patientId: patientId || '',\n    documentType: 'recete',\n    autoProcess\n  });\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [dragActive, setDragActive] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const [validation, setValidation] = useState<SGKValidation | null>(null);\n  const [ocrResult, setOcrResult] = useState<OCRProcessingResult | null>(null);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n  \n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const getDocumentTypeLabel = (type: SGKDocumentType): string => {\n    const labels: Record<SGKDocumentType, string> = {\n      recete: 'E-Reçete',\n      rapor: 'Rapor',\n      belge: 'Belge',\n      fatura: 'Fatura',\n      teslim: 'Teslim Belgesi',\n      iade: 'İade Belgesi'\n    };\n    return labels[type] || type;\n  };\n\n  const validateFile = (file: File): string | null => {\n    if (file.size > maxFileSize) {\n      return `Dosya boyutu ${Math.round(maxFileSize / 1024 / 1024)}MB'dan büyük olamaz`;\n    }\n\n    const allowedMimeTypes = [\n      'image/jpeg',\n      'image/png',\n      'image/gif',\n      'image/webp',\n      'application/pdf',\n      'image/tiff'\n    ];\n\n    if (!allowedMimeTypes.includes(file.type)) {\n      return 'Desteklenmeyen dosya formatı. JPG, PNG, PDF, TIFF dosyaları yükleyebilirsiniz.';\n    }\n\n    return null;\n  };\n\n  const handleFileSelect = useCallback((file: File) => {\n    const error = validateFile(file);\n    if (error) {\n      onUploadError?.(error);\n      return;\n    }\n\n    setSelectedFile(file);\n    setFormData(prev => ({ ...prev, file }));\n\n    // Create preview for images\n    if (file.type.startsWith('image/')) {\n      const url = URL.createObjectURL(file);\n      setPreviewUrl(url);\n    } else {\n      setPreviewUrl(null);\n    }\n\n    // Clear previous results\n    setOcrResult(null);\n    setValidation(null);\n  }, [maxFileSize, onUploadError]);\n\n  const handleDrag = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === 'dragenter' || e.type === 'dragover') {\n      setDragActive(true);\n    } else if (e.type === 'dragleave') {\n      setDragActive(false);\n    }\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFileSelect(e.dataTransfer.files[0]);\n    }\n  }, [handleFileSelect]);\n\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFileSelect(e.target.files[0]);\n    }\n  };\n\n  const processWithOCR = async (file: File): Promise<OCRProcessingResult | null> => {\n    if (!file.type.startsWith('image/')) {\n      return null;\n    }\n\n    try {\n      setProcessing(true);\n      const result = await sgkService.processDocument({\n        imagePath: URL.createObjectURL(file),\n        documentType: formData.documentType,\n        patientId: formData.patientId,\n        autoCrop: true,\n        enhanceImage: true\n      });\n      setOcrResult(result);\n      return result;\n    } catch (error) {\n      console.error('OCR processing failed:', error);\n      return null;\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    // Validate form\n    const validationResult = sgkService.validateDocument(formData);\n    setValidation(validationResult);\n\n    if (!validationResult.isValid) {\n      return;\n    }\n\n    try {\n      setUploading(true);\n\n      // Process with OCR if enabled and file is an image\n      let ocrData: OCRProcessingResult | null = null;\n      if (autoProcess && selectedFile) {\n        ocrData = await processWithOCR(selectedFile);\n      }\n\n      // Create document\n      const documentData = {\n        patientId: formData.patientId,\n        filename: selectedFile?.name || 'document',\n        documentType: formData.documentType,\n        fileSize: selectedFile?.size || 0,\n        mimeType: selectedFile?.type || 'application/octet-stream',\n        processingStatus: 'pending' as const,\n        uploadedBy: 'current-user',\n        uploadedAt: new Date().toISOString(),\n        notes: formData.notes,\n        ocrText: ocrData?.extractedText,\n        extractedInfo: ocrData?.extractedInfo\n      };\n\n      const document = await sgkService.createDocument(documentData);\n      \n      // Create workflow\n      await sgkService.createWorkflow(document.id, document.patientId);\n\n      onUploadComplete?.(document);\n      \n      // Reset form\n      setFormData({\n        patientId: patientId || '',\n        documentType: 'recete',\n        autoProcess\n      });\n      setSelectedFile(null);\n      setPreviewUrl(null);\n      setOcrResult(null);\n      setValidation(null);\n      \n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Upload failed';\n      onUploadError?.(errorMessage);\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        {/* Patient Selection */}\n        {!patientId && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Hasta <span className=\"text-red-500\">*</span>\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.patientId}\n              onChange={(e) => setFormData(prev => ({ ...prev, patientId: e.target.value }))}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                validation?.errors.patientId ? 'border-red-300' : 'border-gray-300'\n              }`}\n              placeholder=\"Hasta ID'si girin\"\n            />\n            {validation?.errors.patientId && (\n              <p className=\"mt-1 text-sm text-red-600\">{validation.errors.patientId}</p>\n            )}\n          </div>\n        )}\n\n        {/* Document Type */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Belge Türü <span className=\"text-red-500\">*</span>\n          </label>\n          <Select\n            value={formData.documentType}\n            onChange={(e) => setFormData(prev => ({ ...prev, documentType: e.target.value as SGKDocumentType }))}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          >\n            {allowedTypes.map(type => (\n              <option key={type} value={type}>\n                {getDocumentTypeLabel(type)}\n              </option>\n            ))}\n          </Select>\n        </div>\n\n        {/* File Upload */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Dosya {!formData.notes && <span className=\"text-red-500\">*</span>}\n          </label>\n          \n          <div\n            className={`relative border-2 border-dashed rounded-lg p-6 transition-colors ${\n              dragActive \n                ? 'border-blue-400 bg-blue-50' \n                : validation?.errors.file\n                ? 'border-red-300 bg-red-50'\n                : 'border-gray-300 hover:border-gray-400'\n            }`}\n            onDragEnter={handleDrag}\n            onDragLeave={handleDrag}\n            onDragOver={handleDrag}\n            onDrop={handleDrop}\n          >\n            <Input\n              ref={fileInputRef}\n              type=\"file\"\n              onChange={handleFileInputChange}\n              accept=\"image/*,.pdf\"\n              className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\n            />\n            \n            {selectedFile ? (\n              <div className=\"text-center\">\n                <div className=\"flex items-center justify-center mb-2\">\n                  <svg className=\"h-8 w-8 text-green-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                  </svg>\n                </div>\n                <p className=\"text-sm font-medium text-gray-900\">{selectedFile.name}</p>\n                <p className=\"text-xs text-gray-500\">{formatFileSize(selectedFile.size)}</p>\n                <Button\n                  type=\"button\"\n                  onClick={() => {\n                    setSelectedFile(null);\n                    setPreviewUrl(null);\n                    setOcrResult(null);\n                    if (fileInputRef.current) {\n                      fileInputRef.current.value = '';\n                    }\n                  }}\n                  className=\"mt-2 text-sm text-red-600 hover:text-red-500\"\n                  variant='default'>\n                  Kaldır\n                </Button>\n              </div>\n            ) : (\n              <div className=\"text-center\">\n                <svg className=\"mx-auto h-12 w-12 text-gray-400\" stroke=\"currentColor\" fill=\"none\" viewBox=\"0 0 48 48\">\n                  <path d=\"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                </svg>\n                <div className=\"mt-4\">\n                  <p className=\"text-sm text-gray-600\">\n                    <span className=\"font-medium text-blue-600 hover:text-blue-500\">Dosya seçin</span>\n                    {' '}veya sürükleyip bırakın\n                  </p>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    PNG, JPG, PDF dosyaları (max {Math.round(maxFileSize / 1024 / 1024)}MB)\n                  </p>\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {validation?.errors.file && (\n            <p className=\"mt-1 text-sm text-red-600\">{validation.errors.file}</p>\n          )}\n        </div>\n\n        {/* Preview */}\n        {previewUrl && !compact && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Önizleme\n            </label>\n            <div className=\"border border-gray-200 rounded-lg p-4\">\n              <img\n                src={previewUrl}\n                alt=\"Preview\"\n                className=\"max-w-full h-auto max-h-64 mx-auto rounded\"\n              />\n            </div>\n          </div>\n        )}\n\n        {/* OCR Results */}\n        {ocrResult && !compact && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              OCR Sonuçları\n            </label>\n            <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\n              <div className=\"text-sm\">\n                <div className=\"mb-2\">\n                  <span className=\"font-medium\">Güven Skoru:</span>\n                  <span className={`ml-2 px-2 py-1 rounded text-xs ${\n                    ocrResult.confidence > 0.8 ? 'bg-green-100 text-green-800' :\n                    ocrResult.confidence > 0.6 ? 'bg-yellow-100 text-yellow-800' :\n                    'bg-red-100 text-red-800'\n                  }`}>\n                    {Math.round(ocrResult.confidence * 100)}%\n                  </span>\n                </div>\n                \n                {ocrResult.extractedInfo && (\n                  <div className=\"space-y-1\">\n                    {ocrResult.extractedInfo.patientName && (\n                      <div><span className=\"font-medium\">Hasta Adı:</span> {ocrResult.extractedInfo.patientName}</div>\n                    )}\n                    {ocrResult.extractedInfo.tcNumber && (\n                      <div><span className=\"font-medium\">TC No:</span> {ocrResult.extractedInfo.tcNumber}</div>\n                    )}\n                    {ocrResult.extractedInfo.prescriptionNumber && (\n                      <div><span className=\"font-medium\">Reçete No:</span> {ocrResult.extractedInfo.prescriptionNumber}</div>\n                    )}\n                    {ocrResult.extractedInfo.reportNumber && (\n                      <div><span className=\"font-medium\">Rapor No:</span> {ocrResult.extractedInfo.reportNumber}</div>\n                    )}\n                  </div>\n                )}\n                \n                {ocrResult.extractedText && (\n                  <details className=\"mt-3\">\n                    <summary className=\"cursor-pointer font-medium\">Çıkarılan Metin</summary>\n                    <div className=\"mt-2 p-2 bg-white border rounded text-xs whitespace-pre-wrap\">\n                      {ocrResult.extractedText}\n                    </div>\n                  </details>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Notes */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <Textarea\n            value={formData.notes || ''}\n            onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n            rows={3}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            placeholder=\"Belge ile ilgili notlar...\"\n          />\n        </div>\n\n        {/* Auto Process Option */}\n        {!compact && (\n          <div className=\"flex items-center\">\n            <Input\n              type=\"checkbox\"\n              id=\"autoProcess\"\n              checked={formData.autoProcess || false}\n              onChange={(e) => setFormData(prev => ({ ...prev, autoProcess: e.target.checked }))}\n              className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n            />\n            <label htmlFor=\"autoProcess\" className=\"ml-2 block text-sm text-gray-900\">\n              Otomatik OCR işlemi yap (görüntü dosyaları için)\n            </label>\n          </div>\n        )}\n\n        {/* Submit Button */}\n        <div className=\"flex items-center justify-end space-x-3\">\n          <Button\n            type=\"submit\"\n            disabled={uploading || processing}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50\"\n            variant='default'>\n            {uploading ? (\n              <>\n                <svg className=\"animate-spin -ml-1 mr-3 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n                Yükleniyor...\n              </>\n            ) : processing ? (\n              <>\n                <svg className=\"animate-spin -ml-1 mr-3 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n                İşleniyor...\n              </>\n            ) : (\n              'Yükle'\n            )}\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/SGKWorkflow.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadWorkflow'. Either include it or remove the dependency array.","line":37,"column":6,"nodeType":"ArrayExpression","endLine":37,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [document.id, initialWorkflow, loadWorkflow]","fix":{"range":[1123,1153],"text":"[document.id, initialWorkflow, loadWorkflow]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React, { useState, useEffect } from 'react';\nimport { Button, Select, Textarea } from '@x-ear/ui-web';\nimport { \n  SGKWorkflow as SGKWorkflowType, \n  SGKWorkflowStatus, \n  SGKDocument\n} from '../types/sgk';\nimport sgkService from '../services/sgk/sgk.service';\n\ninterface SGKWorkflowProps {\n  document: SGKDocument;\n  workflow?: SGKWorkflowType;\n  onWorkflowUpdate?: (workflow: SGKWorkflowType) => void;\n  readOnly?: boolean;\n  compact?: boolean;\n}\n\nexport const SGKWorkflow: React.FC<SGKWorkflowProps> = ({\n  document,\n  workflow: initialWorkflow,\n  onWorkflowUpdate,\n  readOnly = false,\n  compact = false\n}) => {\n  const [workflow, setWorkflow] = useState<SGKWorkflowType | null>(initialWorkflow || null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [showStatusModal, setShowStatusModal] = useState(false);\n  const [selectedStatus, setSelectedStatus] = useState<SGKWorkflowStatus>('draft');\n  const [statusNotes, setStatusNotes] = useState('');\n\n  useEffect(() => {\n    if (!initialWorkflow) {\n      loadWorkflow();\n    }\n  }, [document.id, initialWorkflow]);\n\n  const loadWorkflow = async () => {\n    try {\n      setLoading(true);\n      const workflowData = await sgkService.getWorkflow(document.id);\n      setWorkflow(workflowData);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load workflow');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStatusColor = (status: SGKWorkflowStatus): string => {\n    switch (status) {\n      case 'draft': return 'bg-gray-100 text-gray-800';\n      case 'submitted': return 'bg-blue-100 text-blue-800';\n      case 'under_review': return 'bg-yellow-100 text-yellow-800';\n      case 'approved': return 'bg-green-100 text-green-800';\n      case 'rejected': return 'bg-red-100 text-red-800';\n      case 'paid': return 'bg-purple-100 text-purple-800';\n      case 'completed': return 'bg-emerald-100 text-emerald-800';\n      case 'cancelled': return 'bg-gray-100 text-gray-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusLabel = (status: SGKWorkflowStatus): string => {\n    const labels: Record<SGKWorkflowStatus, string> = {\n      draft: 'Taslak',\n      submitted: 'Gönderildi',\n      under_review: 'İnceleniyor',\n      approved: 'Onaylandı',\n      rejected: 'Reddedildi',\n      paid: 'Ödendi',\n      completed: 'Tamamlandı',\n      cancelled: 'İptal Edildi'\n    };\n    return labels[status] || status;\n  };\n\n  const getAvailableStatuses = (currentStatus: SGKWorkflowStatus): SGKWorkflowStatus[] => {\n    switch (currentStatus) {\n      case 'draft':\n        return ['submitted', 'cancelled'];\n      case 'submitted':\n        return ['under_review', 'rejected', 'cancelled'];\n      case 'under_review':\n        return ['approved', 'rejected'];\n      case 'approved':\n        return ['paid', 'cancelled'];\n      case 'paid':\n        return ['completed'];\n      case 'rejected':\n        return ['submitted'];\n      case 'completed':\n        return [];\n      case 'cancelled':\n        return ['draft'];\n      default:\n        return [];\n    }\n  };\n\n  const handleStatusUpdate = async () => {\n    if (!workflow) return;\n\n    try {\n      setLoading(true);\n      const updatedWorkflow = await sgkService.updateWorkflowStatus(\n        workflow.id,\n        selectedStatus,\n        statusNotes || undefined\n      );\n      setWorkflow(updatedWorkflow);\n      onWorkflowUpdate?.(updatedWorkflow);\n      setShowStatusModal(false);\n      setStatusNotes('');\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to update status');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatDate = (dateString: string): string => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const formatDuration = (startDate: string, endDate?: string): string => {\n    const start = new Date(startDate);\n    const end = endDate ? new Date(endDate) : new Date();\n    const diffMs = end.getTime() - start.getTime();\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n    const diffHours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n\n    if (diffDays > 0) {\n      return `${diffDays} gün ${diffHours} saat`;\n    } else if (diffHours > 0) {\n      return `${diffHours} saat`;\n    } else {\n      return 'Az önce';\n    }\n  };\n\n  const isDeadlineApproaching = (deadline?: string): boolean => {\n    if (!deadline) return false;\n    const deadlineDate = new Date(deadline);\n    const now = new Date();\n    const diffDays = Math.ceil((deadlineDate.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n    return diffDays <= 7 && diffDays > 0;\n  };\n\n  const isOverdue = (deadline?: string): boolean => {\n    if (!deadline) return false;\n    const deadlineDate = new Date(deadline);\n    const now = new Date();\n    return deadlineDate < now;\n  };\n\n  if (loading && !workflow) {\n    return (\n      <div className=\"flex items-center justify-center p-4\">\n        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-2 text-gray-600\">İş akışı yükleniyor...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n        <div className=\"flex\">\n          <div className=\"flex-shrink-0\">\n            <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n          <div className=\"ml-3\">\n            <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n            <p className=\"mt-1 text-sm text-red-700\">{error}</p>\n            <Button\n              onClick={() => setError(null)}\n              className=\"mt-2 text-sm text-red-600 hover:text-red-500\"\n              variant='default'>\n              Tekrar dene\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!workflow) {\n    return (\n      <div className=\"bg-gray-50 border border-gray-200 rounded-md p-4\">\n        <div className=\"text-center\">\n          <svg className=\"mx-auto h-8 w-8 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n          </svg>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">İş akışı bulunamadı</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Bu belge için henüz bir iş akışı oluşturulmamış.\n          </p>\n          {!readOnly && (\n            <Button\n              onClick={async () => {\n                try {\n                  const newWorkflow = await sgkService.createWorkflow(document.id, document.patientId);\n                  setWorkflow(newWorkflow);\n                  onWorkflowUpdate?.(newWorkflow);\n                } catch (err) {\n                  setError(err instanceof Error ? err.message : 'Failed to create workflow');\n                }\n              }}\n              className=\"mt-3 inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n              variant='default'>\n              İş Akışı Oluştur\n            </Button>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Current Status */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(workflow.currentStatus)}`}>\n              {getStatusLabel(workflow.currentStatus)}\n            </span>\n            {workflow.deadline && (\n              <div className=\"flex items-center text-sm text-gray-500\">\n                <svg className=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                </svg>\n                <span className={`${isOverdue(workflow.deadline) ? 'text-red-600 font-medium' : isDeadlineApproaching(workflow.deadline) ? 'text-yellow-600 font-medium' : ''}`}>\n                  {formatDate(workflow.deadline)}\n                  {isOverdue(workflow.deadline) && ' (Gecikmiş)'}\n                  {isDeadlineApproaching(workflow.deadline) && !isOverdue(workflow.deadline) && ' (Yaklaşıyor)'}\n                </span>\n              </div>\n            )}\n          </div>\n\n          {!readOnly && getAvailableStatuses(workflow.currentStatus).length > 0 && (\n            <Button\n              onClick={() => setShowStatusModal(true)}\n              disabled={loading}\n              className=\"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50\"\n              variant='default'>\n              Durumu Güncelle\n            </Button>\n          )}\n        </div>\n\n        {/* Key Dates */}\n        {!compact && (\n          <div className=\"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n            {workflow.submittedDate && (\n              <div>\n                <span className=\"text-gray-500\">Gönderim:</span>\n                <div className=\"font-medium\">{formatDate(workflow.submittedDate)}</div>\n              </div>\n            )}\n            {workflow.approvalDate && (\n              <div>\n                <span className=\"text-gray-500\">Onay:</span>\n                <div className=\"font-medium\">{formatDate(workflow.approvalDate)}</div>\n              </div>\n            )}\n            {workflow.paymentDate && (\n              <div>\n                <span className=\"text-gray-500\">Ödeme:</span>\n                <div className=\"font-medium\">{formatDate(workflow.paymentDate)}</div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {/* Status History */}\n      {!compact && (\n        <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\n          <h4 className=\"text-sm font-medium text-gray-900 mb-3\">Durum Geçmişi</h4>\n          <div className=\"flow-root\">\n            <ul className=\"-mb-8\">\n              {workflow.statusHistory.map((entry, index) => (\n                <li key={index}>\n                  <div className=\"relative pb-8\">\n                    {index !== workflow.statusHistory.length - 1 && (\n                      <span className=\"absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200\" aria-hidden=\"true\" />\n                    )}\n                    <div className=\"relative flex space-x-3\">\n                      <div>\n                        <span className={`h-8 w-8 rounded-full flex items-center justify-center ring-8 ring-white ${getStatusColor(entry.status)}`}>\n                          <svg className=\"h-4 w-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <circle cx=\"10\" cy=\"10\" r=\"3\" />\n                          </svg>\n                        </span>\n                      </div>\n                      <div className=\"min-w-0 flex-1 pt-1.5 flex justify-between space-x-4\">\n                        <div>\n                          <p className=\"text-sm text-gray-900\">\n                            <span className=\"font-medium\">{getStatusLabel(entry.status)}</span>\n                            {entry.notes && (\n                              <span className=\"text-gray-500\"> - {entry.notes}</span>\n                            )}\n                          </p>\n                          <p className=\"text-xs text-gray-500\">\n                            {entry.userName || 'Sistem'}\n                            {entry.systemGenerated && ' (Otomatik)'}\n                          </p>\n                        </div>\n                        <div className=\"text-right text-xs text-gray-500 whitespace-nowrap\">\n                          <time dateTime={entry.timestamp}>\n                            {formatDate(entry.timestamp)}\n                          </time>\n                          <div>\n                            {index > 0 && formatDuration(workflow.statusHistory[index - 1].timestamp, entry.timestamp)}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </li>\n              ))}\n            </ul>\n          </div>\n        </div>\n      )}\n      {/* Status Update Modal */}\n      {showStatusModal && (\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\n          <div className=\"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white\">\n            <div className=\"mt-3\">\n              <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n                Durum Güncelle\n              </h3>\n              \n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Yeni Durum\n                </label>\n                <Select\n                  value={selectedStatus}\n                  onChange={(e) => setSelectedStatus(e.target.value as SGKWorkflowStatus)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  {getAvailableStatuses(workflow.currentStatus).map(status => (\n                    <option key={status} value={status}>\n                      {getStatusLabel(status)}\n                    </option>\n                  ))}\n                </Select>\n              </div>\n\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Notlar (İsteğe bağlı)\n                </label>\n                <Textarea\n                  value={statusNotes}\n                  onChange={(e) => setStatusNotes(e.target.value)}\n                  rows={3}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"Durum değişikliği ile ilgili notlar...\"\n                />\n              </div>\n\n              <div className=\"flex items-center justify-end space-x-3\">\n                <Button\n                  onClick={() => {\n                    setShowStatusModal(false);\n                    setStatusNotes('');\n                  }}\n                  className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500\"\n                  variant='default'>\n                  İptal\n                </Button>\n                <Button\n                  onClick={handleStatusUpdate}\n                  disabled={loading}\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50\"\n                  variant='default'>\n                  {loading ? 'Güncelleniyor...' : 'Güncelle'}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/__tests__/LoginForm.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/appointments/AppointmentCalendar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_view' is defined but never used.","line":26,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_aptIndex' is defined but never used.","line":223,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":74}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from '@x-ear/ui-web';\nimport React, { useState, useMemo } from 'react';\nimport { Appointment, CalendarView } from '../../types/appointment';\nimport { useAppointments } from '../../hooks/useAppointments';\nimport { AppointmentModal } from './AppointmentModal';\n\ninterface AppointmentCalendarProps {\n  className?: string;\n  onAppointmentClick?: (appointment: Appointment) => void;\n  onDateClick?: (date: string) => void;\n  view?: CalendarView;\n  selectedDate?: Date;\n}\n\ninterface CalendarDay {\n  date: Date;\n  isCurrentMonth: boolean;\n  isToday: boolean;\n  appointments: Appointment[];\n}\n\nexport const AppointmentCalendar: React.FC<AppointmentCalendarProps> = ({\n  className = '',\n  onAppointmentClick,\n  onDateClick,\n  view: _view,\n  selectedDate = new Date()\n}) => {\n  const { appointments, loading } = useAppointments();\n  const [currentDate, setCurrentDate] = useState(selectedDate);\n  const [selectedAppointment, setSelectedAppointment] = useState<Appointment | null>(null);\n  const [showModal, setShowModal] = useState(false);\n  const [modalMode, setModalMode] = useState<'view' | 'create'>('view');\n\n  // Generate calendar days for the current month\n  const calendarDays = useMemo(() => {\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth();\n    \n    // First day of the month\n    const firstDay = new Date(year, month, 1);\n    // Last day of the month\n    const lastDay = new Date(year, month + 1, 0);\n    \n    // Start from the first day of the week containing the first day of the month\n    const startDate = new Date(firstDay);\n    startDate.setDate(startDate.getDate() - firstDay.getDay());\n    \n    // End at the last day of the week containing the last day of the month\n    const endDate = new Date(lastDay);\n    endDate.setDate(endDate.getDate() + (6 - lastDay.getDay()));\n    \n    const days: CalendarDay[] = [];\n    const currentDateObj = new Date(startDate);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    \n    while (currentDateObj <= endDate) {\n      const dateStr = currentDateObj.toISOString().split('T')[0];\n      const dayAppointments = appointments.filter(apt => apt.date === dateStr);\n      \n      days.push({\n        date: new Date(currentDateObj),\n        isCurrentMonth: currentDateObj.getMonth() === month,\n        isToday: currentDateObj.getTime() === today.getTime(),\n        appointments: dayAppointments\n      });\n      \n      currentDateObj.setDate(currentDateObj.getDate() + 1);\n    }\n    \n    return days;\n  }, [currentDate, appointments]);\n\n  const navigateMonth = (direction: 'prev' | 'next') => {\n    setCurrentDate(prev => {\n      const newDate = new Date(prev);\n      if (direction === 'prev') {\n        newDate.setMonth(newDate.getMonth() - 1);\n      } else {\n        newDate.setMonth(newDate.getMonth() + 1);\n      }\n      return newDate;\n    });\n  };\n\n  const goToToday = () => {\n    setCurrentDate(new Date());\n  };\n\n  const handleDayClick = (day: CalendarDay) => {\n    const dateStr = day.date.toISOString().split('T')[0];\n    onDateClick?.(dateStr);\n    \n    if (day.appointments.length === 0) {\n      // Create new appointment for this date\n      setSelectedAppointment(null);\n      setModalMode('create');\n      setShowModal(true);\n    } else if (day.appointments.length === 1) {\n      // Show single appointment\n      setSelectedAppointment(day.appointments[0]);\n      setModalMode('view');\n      setShowModal(true);\n    }\n    // For multiple appointments, we could show a list or the first one\n  };\n\n  const handleAppointmentClick = (appointment: Appointment, e: React.MouseEvent) => {\n    e.stopPropagation();\n    setSelectedAppointment(appointment);\n    setModalMode('view');\n    setShowModal(true);\n    onAppointmentClick?.(appointment);\n  };\n\n  const getStatusColor = (status: string): string => {\n    const colors = {\n      scheduled: 'bg-blue-500',\n      confirmed: 'bg-green-500',\n      completed: 'bg-gray-500',\n      cancelled: 'bg-red-500',\n      no_show: 'bg-orange-500',\n      rescheduled: 'bg-yellow-500'\n    };\n    return colors[status as keyof typeof colors] || 'bg-gray-500';\n  };\n\n  const formatMonthYear = (date: Date): string => {\n    return date.toLocaleDateString('tr-TR', { \n      month: 'long', \n      year: 'numeric' \n    });\n  };\n\n  const weekDays = ['Pz', 'Pt', 'Sa', 'Ça', 'Pe', 'Cu', 'Ct'];\n\n  if (loading) {\n    return (\n      <div className={`appointment-calendar ${className}`}>\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`appointment-calendar ${className}`}>\n      {/* Calendar Header */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center space-x-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">\n            {formatMonthYear(currentDate)}\n          </h2>\n          <Button\n            onClick={goToToday}\n            className=\"px-3 py-1 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            variant='default'>\n            Bugün\n          </Button>\n        </div>\n        \n        <div className=\"flex items-center space-x-2\">\n          <Button\n            onClick={() => navigateMonth('prev')}\n            className=\"p-2 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-md\"\n            variant='default'>\n            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n            </svg>\n          </Button>\n          <Button\n            onClick={() => navigateMonth('next')}\n            className=\"p-2 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-md\"\n            variant='default'>\n            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n            </svg>\n          </Button>\n        </div>\n      </div>\n      {/* Calendar Grid */}\n      <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n        {/* Week Days Header */}\n        <div className=\"grid grid-cols-7 bg-gray-50\">\n          {weekDays.map(day => (\n            <div key={day} className=\"px-4 py-3 text-center text-sm font-medium text-gray-700\">\n              {day}\n            </div>\n          ))}\n        </div>\n\n        {/* Calendar Days */}\n        <div className=\"grid grid-cols-7 divide-y divide-gray-200\">\n          {calendarDays.map((day, index) => (\n            <div\n              key={index}\n              onClick={() => handleDayClick(day)}\n              className={`\n                min-h-[120px] p-2 cursor-pointer hover:bg-gray-50 transition-colors\n                ${!day.isCurrentMonth ? 'bg-gray-50 text-gray-400' : 'bg-white'}\n                ${day.isToday ? 'bg-blue-50' : ''}\n              `}\n            >\n              {/* Day Number */}\n              <div className=\"flex items-center justify-between mb-1\">\n                <span className={`\n                  text-sm font-medium\n                  ${day.isToday ? 'text-blue-600' : day.isCurrentMonth ? 'text-gray-900' : 'text-gray-400'}\n                `}>\n                  {day.date.getDate()}\n                </span>\n                {day.appointments.length > 0 && (\n                  <span className=\"text-xs text-gray-500\">\n                    {day.appointments.length}\n                  </span>\n                )}\n              </div>\n\n              {/* Appointments */}\n              <div className=\"space-y-1\">\n                {day.appointments.slice(0, 3).map((appointment, _aptIndex) => (\n                  <div\n                    key={appointment.id}\n                    onClick={(e) => handleAppointmentClick(appointment, e)}\n                    className={`\n                      px-2 py-1 rounded text-xs text-white cursor-pointer hover:opacity-80 transition-opacity\n                      ${getStatusColor(appointment.status)}\n                    `}\n                    title={`${appointment.time} - ${appointment.patientName} - ${appointment.title}`}\n                  >\n                    <div className=\"truncate\">\n                      {appointment.time.substring(0, 5)} {appointment.patientName}\n                    </div>\n                  </div>\n                ))}\n                \n                {day.appointments.length > 3 && (\n                  <div className=\"text-xs text-gray-500 text-center\">\n                    +{day.appointments.length - 3} daha\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n      {/* Legend */}\n      <div className=\"mt-4 flex flex-wrap items-center gap-4 text-xs\">\n        <div className=\"flex items-center\">\n          <div className=\"w-3 h-3 bg-blue-500 rounded mr-2\"></div>\n          <span>Planlandı</span>\n        </div>\n        <div className=\"flex items-center\">\n          <div className=\"w-3 h-3 bg-green-500 rounded mr-2\"></div>\n          <span>Onaylandı</span>\n        </div>\n        <div className=\"flex items-center\">\n          <div className=\"w-3 h-3 bg-gray-500 rounded mr-2\"></div>\n          <span>Tamamlandı</span>\n        </div>\n        <div className=\"flex items-center\">\n          <div className=\"w-3 h-3 bg-red-500 rounded mr-2\"></div>\n          <span>İptal</span>\n        </div>\n        <div className=\"flex items-center\">\n          <div className=\"w-3 h-3 bg-orange-500 rounded mr-2\"></div>\n          <span>Gelmedi</span>\n        </div>\n        <div className=\"flex items-center\">\n          <div className=\"w-3 h-3 bg-yellow-500 rounded mr-2\"></div>\n          <span>Ertelendi</span>\n        </div>\n      </div>\n      {/* Appointment Modal */}\n      <AppointmentModal\n        appointment={selectedAppointment || undefined}\n        isOpen={showModal}\n        onClose={() => setShowModal(false)}\n        mode={modalMode}\n        initialDate={selectedAppointment?.date}\n        initialTime={selectedAppointment?.time}\n      />\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/appointments/AppointmentForm.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'formData.title'. Either include it or remove the dependency array.","line":91,"column":6,"nodeType":"ArrayExpression","endLine":91,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [formData.title, formData.type]","fix":{"range":[2973,2988],"text":"[formData.title, formData.type]"}}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":244,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":261,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":329,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":345,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":356,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":367,"endColumn":22}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Textarea } from '@x-ear/ui-web';\nimport React, { useState, useEffect } from 'react';\nimport { Appointment, CreateAppointmentData, UpdateAppointmentData, AppointmentType, AppointmentStatus } from '../../types/appointment';\nimport { useAppointments } from '../../hooks/useAppointments';\nimport { usePatients } from '../../hooks/patient/usePatients';\n\ninterface AppointmentFormProps {\n  appointment?: Appointment;\n  patientId?: string;\n  onSave?: (appointment: Appointment) => void;\n  onCancel?: () => void;\n  mode?: 'create' | 'edit';\n  className?: string;\n}\n\ninterface FormData {\n  patientId: string;\n  patientName: string;\n  date: string;\n  time: string;\n  duration: number;\n  type: AppointmentType;\n  status: AppointmentStatus;\n  title: string;\n  notes: string;\n  clinician: string;\n  clinicianId: string;\n  location: string;\n  branchId: string;\n}\n\ninterface FormErrors {\n  patientId?: string;\n  date?: string;\n  time?: string;\n  duration?: string;\n  type?: string;\n  title?: string;\n}\n\nexport const AppointmentForm: React.FC<AppointmentFormProps> = ({\n  appointment,\n  patientId,\n  onSave,\n  onCancel,\n  mode = 'create',\n  className = ''\n}) => {\n  const { createAppointment, updateAppointment, creating, updating, error } = useAppointments();\n  const { data: patientsData } = usePatients();\n  const { patients = [] } = patientsData || {};\n\n  const [formData, setFormData] = useState<FormData>({\n    patientId: patientId || appointment?.patientId || '',\n    patientName: appointment?.patientName || '',\n    date: appointment?.date || new Date().toISOString().split('T')[0],\n    time: appointment?.time || '09:00',\n    duration: appointment?.duration || 30,\n    type: appointment?.type || 'consultation',\n    status: appointment?.status || 'scheduled',\n    title: appointment?.title || '',\n    notes: appointment?.notes || '',\n    clinician: appointment?.clinician || '',\n    clinicianId: appointment?.clinicianId || '',\n    location: appointment?.location || '',\n    branchId: appointment?.branchId || ''\n  });\n\n  const [errors, setErrors] = useState<FormErrors>({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Update patient name when patient is selected\n  useEffect(() => {\n    if (formData.patientId && patients.length > 0) {\n      const selectedPatient = patients.find(p => p.id === formData.patientId);\n      if (selectedPatient) {\n        const patientName = selectedPatient.firstName && selectedPatient.lastName \n          ? `${selectedPatient.firstName} ${selectedPatient.lastName}`\n          : `${selectedPatient.firstName || selectedPatient.lastName || 'İsimsiz Hasta'}`;\n        \n        setFormData(prev => ({ ...prev, patientName }));\n      }\n    }\n  }, [formData.patientId, patients]);\n\n  // Auto-generate title based on type\n  useEffect(() => {\n    if (!formData.title || formData.title === getTypeLabel(formData.type)) {\n      setFormData(prev => ({ ...prev, title: getTypeLabel(formData.type) }));\n    }\n  }, [formData.type]);\n\n  const getTypeLabel = (type: AppointmentType): string => {\n    const labels = {\n      consultation: 'Konsültasyon',\n      follow_up: 'Kontrol Muayenesi',\n      trial: 'Deneme Başlangıç',\n      delivery: 'Cihaz Teslimi',\n      control_visit: 'Kontrol Ziyareti',\n      battery_renewal: 'Pil Yenileme',\n      repair: 'Tamir',\n      fitting: 'Cihaz Ayarı',\n      assessment: 'Değerlendirme'\n    };\n    return labels[type] || type;\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: FormErrors = {};\n\n    if (!formData.patientId) {\n      newErrors.patientId = 'Hasta seçimi zorunludur';\n    }\n\n    if (!formData.date) {\n      newErrors.date = 'Tarih zorunludur';\n    } else {\n      const appointmentDate = new Date(formData.date);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      if (appointmentDate < today) {\n        newErrors.date = 'Geçmiş tarih seçilemez';\n      }\n    }\n\n    if (!formData.time) {\n      newErrors.time = 'Saat zorunludur';\n    } else if (!/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(formData.time)) {\n      newErrors.time = 'Geçerli bir saat formatı giriniz (HH:MM)';\n    }\n\n    if (!formData.duration || formData.duration <= 0) {\n      newErrors.duration = 'Süre 0\\'dan büyük olmalıdır';\n    } else if (formData.duration > 480) {\n      newErrors.duration = 'Süre 8 saatten fazla olamaz';\n    }\n\n    if (!formData.type) {\n      newErrors.type = 'Randevu türü zorunludur';\n    }\n\n    if (!formData.title.trim()) {\n      newErrors.title = 'Başlık zorunludur';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleInputChange = (field: keyof FormData, value: string | number) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    \n    // Clear error when user starts typing\n    if (errors[field as keyof FormErrors]) {\n      setErrors(prev => ({ ...prev, [field]: undefined }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsSubmitting(true);\n\n    try {\n      if (mode === 'create') {\n        const appointmentData: CreateAppointmentData = {\n          patientId: formData.patientId,\n          patientName: formData.patientName,\n          date: formData.date,\n          time: formData.time,\n          duration: formData.duration,\n          type: formData.type,\n          status: formData.status,\n          title: formData.title.trim(),\n          notes: formData.notes.trim() || undefined,\n          clinician: formData.clinician.trim() || undefined,\n          clinicianId: formData.clinicianId.trim() || undefined,\n          location: formData.location.trim() || undefined,\n          branchId: formData.branchId.trim() || undefined,\n          createdBy: 'current-user' // TODO: Get from auth context\n        };\n\n        const newAppointment = await createAppointment(appointmentData);\n        onSave?.(newAppointment);\n      } else if (appointment) {\n        const updateData: Partial<UpdateAppointmentData> = {\n          patientId: formData.patientId,\n          patientName: formData.patientName,\n          date: formData.date,\n          time: formData.time,\n          duration: formData.duration,\n          type: formData.type,\n          status: formData.status,\n          title: formData.title.trim(),\n          notes: formData.notes.trim() || undefined,\n          clinician: formData.clinician.trim() || undefined,\n          clinicianId: formData.clinicianId.trim() || undefined,\n          location: formData.location.trim() || undefined,\n          branchId: formData.branchId.trim() || undefined\n        };\n\n        const updatedAppointment = await updateAppointment(appointment.id, updateData);\n        onSave?.(updatedAppointment);\n      }\n    } catch (error) {\n      console.error('Failed to save appointment:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const isLoading = creating || updating || isSubmitting;\n\n  return (\n    <div className={`appointment-form ${className}`}>\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n            <div className=\"flex\">\n              <div className=\"flex-shrink-0\">\n                <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                </svg>\n              </div>\n              <div className=\"ml-3\">\n                <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n                <div className=\"mt-2 text-sm text-red-700\">{error}</div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {/* Patient Selection */}\n          <div className=\"md:col-span-2\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Hasta *\n            </label>\n            <select\n              value={formData.patientId}\n              onChange={(e) => handleInputChange('patientId', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.patientId ? 'border-red-300' : 'border-gray-300'\n              }`}\n              disabled={!!patientId} // Disable if patientId is provided as prop\n            >\n              <option value=\"\">Hasta seçiniz</option>\n              {patients.map(patient => (\n                <option key={patient.id} value={patient.id}>\n                  {patient.firstName && patient.lastName \n                    ? `${patient.firstName} ${patient.lastName}` \n                    : `${patient.firstName || patient.lastName || 'İsimsiz Hasta'}`\n                  } - {patient.phone || 'Telefon yok'}\n                </option>\n              ))}\n            </select>\n            {errors.patientId && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.patientId}</p>\n            )}\n          </div>\n\n          {/* Date */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Tarih *\n            </label>\n            <Input\n              type=\"date\"\n              value={formData.date}\n              onChange={(e) => handleInputChange('date', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.date ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.date && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.date}</p>\n            )}\n          </div>\n\n          {/* Time */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Saat *\n            </label>\n            <Input\n              type=\"time\"\n              value={formData.time}\n              onChange={(e) => handleInputChange('time', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.time ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.time && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.time}</p>\n            )}\n          </div>\n\n          {/* Duration */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Süre (dakika) *\n            </label>\n            <Input\n              type=\"number\"\n              min=\"15\"\n              max=\"480\"\n              step=\"15\"\n              value={formData.duration}\n              onChange={(e) => handleInputChange('duration', parseInt(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.duration ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.duration && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.duration}</p>\n            )}\n          </div>\n\n          {/* Type */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Randevu Türü *\n            </label>\n            <select\n              value={formData.type}\n              onChange={(e) => handleInputChange('type', e.target.value as AppointmentType)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.type ? 'border-red-300' : 'border-gray-300'\n              }`}\n            >\n              <option value=\"consultation\">Konsültasyon</option>\n              <option value=\"follow_up\">Kontrol Muayenesi</option>\n              <option value=\"trial\">Deneme Başlangıç</option>\n              <option value=\"delivery\">Cihaz Teslimi</option>\n              <option value=\"control_visit\">Kontrol Ziyareti</option>\n              <option value=\"battery_renewal\">Pil Yenileme</option>\n              <option value=\"repair\">Tamir</option>\n              <option value=\"fitting\">Cihaz Ayarı</option>\n              <option value=\"assessment\">Değerlendirme</option>\n            </select>\n            {errors.type && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.type}</p>\n            )}\n          </div>\n\n          {/* Status */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Durum\n            </label>\n            <select\n              value={formData.status}\n              onChange={(e) => handleInputChange('status', e.target.value as AppointmentStatus)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"scheduled\">Planlandı</option>\n              <option value=\"confirmed\">Onaylandı</option>\n              <option value=\"completed\">Tamamlandı</option>\n              <option value=\"cancelled\">İptal Edildi</option>\n              <option value=\"no_show\">Gelmedi</option>\n              <option value=\"rescheduled\">Ertelendi</option>\n            </select>\n          </div>\n\n          {/* Title */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Başlık *\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.title}\n              onChange={(e) => handleInputChange('title', e.target.value)}\n              placeholder=\"Randevu başlığı\"\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.title ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.title && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.title}</p>\n            )}\n          </div>\n\n          {/* Clinician */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Doktor\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.clinician}\n              onChange={(e) => handleInputChange('clinician', e.target.value)}\n              placeholder=\"Doktor adı\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n\n          {/* Location */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Lokasyon\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.location}\n              onChange={(e) => handleInputChange('location', e.target.value)}\n              placeholder=\"Muayene odası, şube vb.\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n\n          {/* Notes */}\n          <div className=\"md:col-span-2\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Notlar\n            </label>\n            <Textarea\n              value={formData.notes}\n              onChange={(e) => handleInputChange('notes', e.target.value)}\n              placeholder=\"Randevu ile ilgili notlar...\"\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200\">\n          {onCancel && (\n            <Button\n              type=\"button\"\n              onClick={onCancel}\n              disabled={isLoading}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50\"\n              variant='default'>\n              İptal\n            </Button>\n          )}\n          <Button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 flex items-center\"\n            variant='default'>\n            {isLoading && (\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n            )}\n            {mode === 'create' ? 'Randevu Oluştur' : 'Randevuyu Güncelle'}\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/appointments/AppointmentFormModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[156,159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[156,159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[186,189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[186,189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[875,878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[875,878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Modal, Button, Input } from '@x-ear/ui-web';\n\ntype Props = {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (data: any) => void;\n  initialData?: any;\n};\n\nexport function AppointmentFormModal({ open, onClose, onSubmit, initialData }: Props) {\n  const [title, setTitle] = React.useState(initialData?.title ?? '');\n\n  React.useEffect(() => {\n    setTitle(initialData?.title ?? '');\n  }, [initialData]);\n\n  function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    onSubmit({ ...initialData, title });\n  }\n\n  return (\n    <Modal isOpen={open} onClose={onClose} title={initialData ? 'Edit Appointment' : 'New Appointment'}>\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700\">Title</label>\n          <Input value={title} onChange={(e: any) => setTitle(e.target.value)} />\n        </div>\n\n        <div className=\"flex justify-end space-x-2\">\n          <Button type=\"button\" variant=\"ghost\" onClick={onClose}>\n            Cancel\n          </Button>\n          <Button type=\"submit\">Save</Button>\n        </div>\n      </form>\n    </Modal>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/appointments/AppointmentList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_rescheduleAppointment' is assigned a value but never used.","line":41,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":50},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1260,1263],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1260,1263],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select } from '@x-ear/ui-web';\nimport React, { useState, useMemo } from 'react';\nimport { Appointment, AppointmentFilters, AppointmentStatus, AppointmentType } from '../../types/appointment';\nimport { useAppointments } from '../../hooks/useAppointments';\n\ninterface AppointmentListProps {\n  patientId?: string;\n  showFilters?: boolean;\n  showActions?: boolean;\n  onAppointmentClick?: (appointment: Appointment) => void;\n  onEditAppointment?: (appointment: Appointment) => void;\n  onDeleteAppointment?: (appointment: Appointment) => void;\n  className?: string;\n}\n\nexport const AppointmentList: React.FC<AppointmentListProps> = ({\n  patientId,\n  showFilters = true,\n  showActions = true,\n  onAppointmentClick,\n  onEditAppointment,\n  onDeleteAppointment,\n  className = ''\n}) => {\n  const [filters, setFilters] = useState<AppointmentFilters>({\n    patientId,\n    status: undefined,\n    type: undefined,\n    startDate: '',\n    endDate: '',\n    search: ''\n  });\n\n  const {\n    appointments,\n    loading,\n    error: _error,\n    cancelAppointment,\n    completeAppointment,\n    markNoShow,\n    rescheduleAppointment: _rescheduleAppointment\n  } = useAppointments({ filters });\n\n  const handleFilterChange = (key: keyof AppointmentFilters, value: any) => {\n    setFilters(prev => ({ ...prev, [key]: value }));\n  };\n\n  const getStatusColor = (status: AppointmentStatus): string => {\n    const colors = {\n      scheduled: 'bg-blue-100 text-blue-800',\n      confirmed: 'bg-green-100 text-green-800',\n      completed: 'bg-gray-100 text-gray-800',\n      cancelled: 'bg-red-100 text-red-800',\n      no_show: 'bg-orange-100 text-orange-800',\n      rescheduled: 'bg-purple-100 text-purple-800'\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n\n  const getStatusLabel = (status: AppointmentStatus): string => {\n    const labels = {\n      scheduled: 'Planlandı',\n      confirmed: 'Onaylandı',\n      completed: 'Tamamlandı',\n      cancelled: 'İptal Edildi',\n      no_show: 'Gelmedi',\n      rescheduled: 'Ertelendi'\n    };\n    return labels[status] || status;\n  };\n\n  const getTypeLabel = (type: AppointmentType): string => {\n    const labels = {\n      consultation: 'Konsültasyon',\n      follow_up: 'Kontrol',\n      trial: 'Deneme',\n      delivery: 'Teslim',\n      control_visit: 'Kontrol Ziyareti',\n      battery_renewal: 'Pil Yenileme',\n      repair: 'Tamir',\n      fitting: 'Ayar',\n      assessment: 'Değerlendirme'\n    };\n    return labels[type] || type;\n  };\n\n  const formatDate = (date: string): string => {\n    return new Date(date).toLocaleDateString('tr-TR', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric'\n    });\n  };\n\n  const formatTime = (time: string): string => {\n    return time.substring(0, 5); // HH:MM format\n  };\n\n  const handleStatusChange = async (appointment: Appointment, newStatus: AppointmentStatus) => {\n    try {\n      switch (newStatus) {\n        case 'cancelled':\n          await cancelAppointment(appointment.id, 'Kullanıcı tarafından iptal edildi');\n          break;\n        case 'completed':\n          await completeAppointment(appointment.id, 'Randevu tamamlandı');\n          break;\n        case 'no_show':\n          await markNoShow(appointment.id);\n          break;\n      }\n    } catch (error) {\n      console.error('Failed to update appointment status:', error);\n    }\n  };\n\n  const sortedAppointments = useMemo(() => {\n    return [...appointments].sort((a, b) => {\n      const dateA = new Date(`${a.date}T${a.time}`);\n      const dateB = new Date(`${b.date}T${b.time}`);\n      return dateA.getTime() - dateB.getTime();\n    });\n  }, [appointments]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-2 text-gray-600\">Randevular yükleniyor...</span>\n      </div>\n    );\n  }\n\n  if (_error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n        <div className=\"flex\">\n          <div className=\"flex-shrink-0\">\n            <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n          <div className=\"ml-3\">\n            <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n            <div className=\"mt-2 text-sm text-red-700\">{_error}</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`appointment-list ${className}`}>\n      {/* Filters */}\n      {showFilters && (\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border border-gray-200 mb-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            <div>\n              <Select\n                label=\"Durum\"\n                value={filters.status || ''}\n                onChange={(e) => handleFilterChange('status', e.target.value || undefined)}\n                options={[\n                  { value: \"\", label: \"Tümü\" },\n                  { value: \"scheduled\", label: \"Planlandı\" },\n                  { value: \"confirmed\", label: \"Onaylandı\" },\n                  { value: \"completed\", label: \"Tamamlandı\" },\n                  { value: \"cancelled\", label: \"İptal Edildi\" },\n                  { value: \"no_show\", label: \"Gelmedi\" }\n                ]}\n                fullWidth\n              />\n            </div>\n\n            <div>\n              <Select\n                label=\"Tür\"\n                value={filters.type || ''}\n                onChange={(e) => handleFilterChange('type', e.target.value || undefined)}\n                options={[\n                  { value: \"\", label: \"Tümü\" },\n                  { value: \"consultation\", label: \"Konsültasyon\" },\n                  { value: \"follow_up\", label: \"Kontrol\" },\n                  { value: \"trial\", label: \"Deneme\" },\n                  { value: \"delivery\", label: \"Teslim\" },\n                  { value: \"control_visit\", label: \"Kontrol Ziyareti\" },\n                  { value: \"battery_renewal\", label: \"Pil Yenileme\" },\n                  { value: \"repair\", label: \"Tamir\" },\n                  { value: \"fitting\", label: \"Ayar\" },\n                  { value: \"assessment\", label: \"Değerlendirme\" }\n                ]}\n                fullWidth\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Başlangıç Tarihi\n              </label>\n              <Input\n                type=\"date\"\n                value={filters.startDate || ''}\n                onChange={(e) => handleFilterChange('startDate', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Bitiş Tarihi\n              </label>\n              <Input\n                type=\"date\"\n                value={filters.endDate || ''}\n                onChange={(e) => handleFilterChange('endDate', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n          </div>\n\n          <div className=\"mt-4\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Arama\n            </label>\n            <Input\n              type=\"text\"\n              placeholder=\"Hasta adı, doktor, notlar...\"\n              value={filters.search || ''}\n              onChange={(e) => handleFilterChange('search', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n        </div>\n      )}\n      {/* Appointment List */}\n      {sortedAppointments.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4h3a2 2 0 012 2v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2h3z\" />\n          </svg>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Randevu bulunamadı</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Belirtilen kriterlere uygun randevu bulunmuyor.\n          </p>\n        </div>\n      ) : (\n        <div className=\"bg-white shadow-sm rounded-lg overflow-hidden\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Hasta\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Tarih & Saat\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Tür\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Durum\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Doktor\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Süre\n                  </th>\n                  {showActions && (\n                    <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      İşlemler\n                    </th>\n                  )}\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {sortedAppointments.map((appointment) => (\n                  <tr\n                    key={appointment.id}\n                    className={`hover:bg-gray-50 ${onAppointmentClick ? 'cursor-pointer' : ''}`}\n                    onClick={() => onAppointmentClick?.(appointment)}\n                  >\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 h-10 w-10\">\n                          <div className=\"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center\">\n                            <span className=\"text-sm font-medium text-blue-800\">\n                              {appointment.patientName?.split(' ').map(n => n[0]).join('').toUpperCase() || 'N/A'}\n                            </span>\n                          </div>\n                        </div>\n                        <div className=\"ml-4\">\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {appointment.patientName || 'İsimsiz Hasta'}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">\n                            ID: {appointment.patientId}\n                          </div>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"text-sm text-gray-900\">\n                        {formatDate(appointment.date)}\n                      </div>\n                      <div className=\"text-sm text-gray-500\">\n                        {formatTime(appointment.time)} ({appointment.duration} dk)\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"text-sm text-gray-900\">\n                        {getTypeLabel(appointment.type)}\n                      </div>\n                      {appointment.title && appointment.title !== getTypeLabel(appointment.type) && (\n                        <div className=\"text-sm text-gray-500\">\n                          {appointment.title}\n                        </div>\n                      )}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(appointment.status)}`}>\n                        {getStatusLabel(appointment.status)}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {appointment.clinician || '-'}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {appointment.duration} dakika\n                    </td>\n                    {showActions && (\n                      <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                        <div className=\"flex items-center justify-end space-x-2\">\n                          {appointment.status === 'scheduled' && (\n                            <>\n                              <Button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleStatusChange(appointment, 'completed');\n                                }}\n                                className=\"text-green-600 hover:text-green-900 text-xs\"\n                                title=\"Tamamla\"\n                                variant='default'>\n                                Tamamla\n                              </Button>\n                              <Button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleStatusChange(appointment, 'no_show');\n                                }}\n                                className=\"text-orange-600 hover:text-orange-900 text-xs\"\n                                title=\"Gelmedi\"\n                                variant='default'>\n                                Gelmedi\n                              </Button>\n                              <Button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleStatusChange(appointment, 'cancelled');\n                                }}\n                                className=\"text-red-600 hover:text-red-900 text-xs\"\n                                title=\"İptal Et\"\n                                variant='default'>\n                                İptal\n                              </Button>\n                            </>\n                          )}\n                          {onEditAppointment && (\n                            <Button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                onEditAppointment(appointment);\n                              }}\n                              className=\"text-blue-600 hover:text-blue-900 text-xs\"\n                              title=\"Düzenle\"\n                              variant='default'>\n                              Düzenle\n                            </Button>\n                          )}\n                          {onDeleteAppointment && (\n                            <Button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                onDeleteAppointment(appointment);\n                              }}\n                              className=\"text-red-600 hover:text-red-900 text-xs\"\n                              title=\"Sil\"\n                              variant='default'>\n                              Sil\n                            </Button>\n                          )}\n                        </div>\n                      </td>\n                    )}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n      {/* Summary */}\n      <div className=\"mt-4 text-sm text-gray-500 text-center\">\n        Toplam {sortedAppointments.length} randevu gösteriliyor\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/appointments/AppointmentModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_initialDate' is defined but never used.","line":23,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_initialTime' is defined but never used.","line":24,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_savedAppointment' is defined but never used.","line":107,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":107,"endColumn":53}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from '@x-ear/ui-web';\nimport React, { useState } from 'react';\nimport { Appointment, AppointmentStatus } from '../../types/appointment';\nimport { useAppointments } from '../../hooks/useAppointments';\nimport { AppointmentForm } from './AppointmentForm';\n\ninterface AppointmentModalProps {\n  appointment?: Appointment;\n  isOpen: boolean;\n  onClose: () => void;\n  mode?: 'view' | 'edit' | 'create';\n  patientId?: string;\n  initialDate?: string;\n  initialTime?: string;\n}\n\nexport const AppointmentModal: React.FC<AppointmentModalProps> = ({\n  appointment,\n  isOpen,\n  onClose,\n  mode = 'view',\n  patientId,\n  initialDate: _initialDate,\n  initialTime: _initialTime\n}) => {\n  const { updateAppointment, deleteAppointment, updating, deleting } = useAppointments();\n  const [currentMode, setCurrentMode] = useState(mode);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n\n  if (!isOpen) return null;\n\n  const getStatusColor = (status: AppointmentStatus): string => {\n    const colors = {\n      scheduled: 'bg-blue-100 text-blue-800',\n      confirmed: 'bg-green-100 text-green-800',\n      completed: 'bg-gray-100 text-gray-800',\n      cancelled: 'bg-red-100 text-red-800',\n      no_show: 'bg-orange-100 text-orange-800',\n      rescheduled: 'bg-yellow-100 text-yellow-800'\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n\n  const getStatusLabel = (status: AppointmentStatus): string => {\n    const labels = {\n      scheduled: 'Planlandı',\n      confirmed: 'Onaylandı',\n      completed: 'Tamamlandı',\n      cancelled: 'İptal Edildi',\n      no_show: 'Gelmedi',\n      rescheduled: 'Ertelendi'\n    };\n    return labels[status] || status;\n  };\n\n  const getTypeLabel = (type: string): string => {\n    const labels = {\n      consultation: 'Konsültasyon',\n      follow_up: 'Kontrol Muayenesi',\n      trial: 'Deneme Başlangıç',\n      delivery: 'Cihaz Teslimi',\n      control_visit: 'Kontrol Ziyareti',\n      battery_renewal: 'Pil Yenileme',\n      repair: 'Tamir',\n      fitting: 'Cihaz Ayarı',\n      assessment: 'Değerlendirme'\n    };\n    return labels[type as keyof typeof labels] || type;\n  };\n\n  const formatDate = (date: string): string => {\n    return new Date(date).toLocaleDateString('tr-TR', {\n      weekday: 'long',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const formatTime = (time: string): string => {\n    return time.substring(0, 5); // HH:MM format\n  };\n\n  const handleStatusChange = async (newStatus: AppointmentStatus) => {\n    if (!appointment) return;\n\n    try {\n      await updateAppointment(appointment.id, { status: newStatus });\n      // Modal will be updated via the hook's state management\n    } catch (error) {\n      console.error('Failed to update appointment status:', error);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!appointment) return;\n\n    try {\n      await deleteAppointment(appointment.id);\n      setShowDeleteConfirm(false);\n      onClose();\n    } catch (error) {\n      console.error('Failed to delete appointment:', error);\n    }\n  };\n\n  const handleSave = (_savedAppointment: Appointment) => {\n    setCurrentMode('view');\n    // The appointment will be updated via the hook's state management\n  };\n\n  const handleCancel = () => {\n    if (currentMode === 'create') {\n      onClose();\n    } else {\n      setCurrentMode('view');\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 overflow-y-auto\">\n      <div className=\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n        {/* Background overlay */}\n        <div \n          className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\"\n          onClick={onClose}\n        />\n\n        {/* Modal positioning */}\n        <span className=\"hidden sm:inline-block sm:align-middle sm:h-screen\" aria-hidden=\"true\">\n          &#8203;\n        </span>\n\n        {/* Modal content */}\n        <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full\">\n          {/* Header */}\n          <div className=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\n                {currentMode === 'create' && 'Yeni Randevu'}\n                {currentMode === 'edit' && 'Randevuyu Düzenle'}\n                {currentMode === 'view' && 'Randevu Detayları'}\n              </h3>\n              <Button\n                onClick={onClose}\n                className=\"text-gray-400 hover:text-gray-600 focus:outline-none\"\n                variant='default'>\n                <svg className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </Button>\n            </div>\n\n            {/* Content */}\n            {currentMode === 'view' && appointment ? (\n              <div className=\"space-y-6\">\n                {/* Patient Info */}\n                <div className=\"bg-gray-50 rounded-lg p-4\">\n                  <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Hasta Bilgileri</h4>\n                  <p className=\"text-lg font-semibold text-gray-900\">{appointment.patientName}</p>\n                  <p className=\"text-sm text-gray-600\">ID: {appointment.patientId}</p>\n                </div>\n\n                {/* Appointment Details */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Tarih</label>\n                    <p className=\"mt-1 text-sm text-gray-900\">{formatDate(appointment.date)}</p>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Saat</label>\n                    <p className=\"mt-1 text-sm text-gray-900\">{formatTime(appointment.time)}</p>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Süre</label>\n                    <p className=\"mt-1 text-sm text-gray-900\">{appointment.duration} dakika</p>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Tür</label>\n                    <p className=\"mt-1 text-sm text-gray-900\">{getTypeLabel(appointment.type)}</p>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Durum</label>\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(appointment.status)}`}>\n                      {getStatusLabel(appointment.status)}\n                    </span>\n                  </div>\n                  {appointment.clinician && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700\">Doktor</label>\n                      <p className=\"mt-1 text-sm text-gray-900\">{appointment.clinician}</p>\n                    </div>\n                  )}\n                  {appointment.location && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700\">Lokasyon</label>\n                      <p className=\"mt-1 text-sm text-gray-900\">{appointment.location}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Title */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Başlık</label>\n                  <p className=\"mt-1 text-sm text-gray-900\">{appointment.title}</p>\n                </div>\n\n                {/* Notes */}\n                {appointment.notes && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Notlar</label>\n                    <p className=\"mt-1 text-sm text-gray-900 whitespace-pre-wrap\">{appointment.notes}</p>\n                  </div>\n                )}\n\n                {/* Timestamps */}\n                <div className=\"text-xs text-gray-500 space-y-1\">\n                  <p>Oluşturulma: {new Date(appointment.createdAt).toLocaleString('tr-TR')}</p>\n                  {appointment.updatedAt !== appointment.createdAt && (\n                    <p>Güncelleme: {new Date(appointment.updatedAt).toLocaleString('tr-TR')}</p>\n                  )}\n                </div>\n\n                {/* Quick Status Actions */}\n                {!['completed', 'cancelled'].includes(appointment.status) && (\n                  <div className=\"bg-gray-50 rounded-lg p-4\">\n                    <h4 className=\"text-sm font-medium text-gray-900 mb-3\">Hızlı İşlemler</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {appointment.status !== 'confirmed' && (\n                        <Button\n                          onClick={() => handleStatusChange('confirmed')}\n                          disabled={updating}\n                          className=\"px-3 py-1 text-xs font-medium text-green-700 bg-green-100 rounded-full hover:bg-green-200 disabled:opacity-50\"\n                          variant='default'>\n                          Onayla\n                        </Button>\n                      )}\n                      <Button\n                        onClick={() => handleStatusChange('completed')}\n                        disabled={updating}\n                        className=\"px-3 py-1 text-xs font-medium text-gray-700 bg-gray-100 rounded-full hover:bg-gray-200 disabled:opacity-50\"\n                        variant='default'>\n                        Tamamla\n                      </Button>\n                      <Button\n                        onClick={() => handleStatusChange('no_show')}\n                        disabled={updating}\n                        className=\"px-3 py-1 text-xs font-medium text-orange-700 bg-orange-100 rounded-full hover:bg-orange-200 disabled:opacity-50\"\n                        variant='default'>\n                        Gelmedi\n                      </Button>\n                      <Button\n                        onClick={() => handleStatusChange('rescheduled')}\n                        disabled={updating}\n                        className=\"px-3 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 rounded-full hover:bg-yellow-200 disabled:opacity-50\"\n                        variant='default'>\n                        Ertele\n                      </Button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <AppointmentForm\n                appointment={currentMode === 'edit' ? appointment : undefined}\n                patientId={patientId}\n                mode={currentMode === 'create' ? 'create' : 'edit'}\n                onSave={handleSave}\n                onCancel={handleCancel}\n              />\n            )}\n          </div>\n\n          {/* Footer Actions */}\n          {currentMode === 'view' && appointment && (\n            <div className=\"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse\">\n              <Button\n                onClick={() => setCurrentMode('edit')}\n                className=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm\"\n                variant='default'>\n                Düzenle\n              </Button>\n              <Button\n                onClick={() => setShowDeleteConfirm(true)}\n                className=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-red-700 hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm\"\n                variant='default'>\n                Sil\n              </Button>\n              <Button\n                onClick={onClose}\n                className=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm\"\n                variant='default'>\n                Kapat\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n      {/* Delete Confirmation Modal */}\n      {showDeleteConfirm && (\n        <div className=\"fixed inset-0 z-60 overflow-y-auto\">\n          <div className=\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n            <div className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\" />\n            <span className=\"hidden sm:inline-block sm:align-middle sm:h-screen\" aria-hidden=\"true\">&#8203;</span>\n            <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full\">\n              <div className=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n                <div className=\"sm:flex sm:items-start\">\n                  <div className=\"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10\">\n                    <svg className=\"h-6 w-6 text-red-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z\" />\n                    </svg>\n                  </div>\n                  <div className=\"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left\">\n                    <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\n                      Randevuyu Sil\n                    </h3>\n                    <div className=\"mt-2\">\n                      <p className=\"text-sm text-gray-500\">\n                        Bu randevuyu silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.\n                      </p>\n                      {appointment && (\n                        <div className=\"mt-3 p-3 bg-gray-50 rounded-md\">\n                          <p className=\"text-sm font-medium text-gray-900\">{appointment.patientName}</p>\n                          <p className=\"text-sm text-gray-600\">{formatDate(appointment.date)} - {formatTime(appointment.time)}</p>\n                          <p className=\"text-sm text-gray-600\">{appointment.title}</p>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className=\"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse\">\n                <Button\n                  onClick={handleDelete}\n                  disabled={deleting}\n                  className=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50\"\n                  variant='default'>\n                  {deleting ? 'Siliniyor...' : 'Sil'}\n                </Button>\n                <Button\n                  onClick={() => setShowDeleteConfirm(false)}\n                  disabled={deleting}\n                  className=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm disabled:opacity-50\"\n                  variant='default'>\n                  İptal\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/appointments/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/common/ErrorBoundary.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":80,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":86,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":87,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":93,"endColumn":24},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":105,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":105,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3365,3368],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3365,3368],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { Component, ReactNode } from 'react';\nimport { AlertTriangle, RefreshCw, Home } from 'lucide-react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: React.ErrorInfo) => void;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n  errorInfo?: React.ErrorInfo;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    this.setState({ error, errorInfo });\n    \n    // Log error to console in development\n    if (process.env.NODE_ENV === 'development') {\n      console.error('ErrorBoundary caught an error:', error, errorInfo);\n    }\n\n    // Call optional error handler\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    }\n  }\n\n  handleRetry = () => {\n    this.setState({ hasError: false, error: undefined, errorInfo: undefined });\n  };\n\n  handleGoHome = () => {\n    window.location.href = '/';\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // Use custom fallback if provided\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      // Default error UI\n      return (\n        <div className=\"min-h-[400px] flex items-center justify-center p-6\">\n          <div className=\"text-center max-w-md\">\n            <div className=\"mb-6\">\n              <AlertTriangle className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                Bir Hata Oluştu\n              </h2>\n              <p className=\"text-gray-600 mb-4\">\n                Sayfa yüklenirken beklenmeyen bir hata oluştu. Lütfen sayfayı yenilemeyi deneyin.\n              </p>\n            </div>\n\n            {process.env.NODE_ENV === 'development' && this.state.error && (\n              <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-left\">\n                <h3 className=\"font-medium text-red-800 mb-2\">Hata Detayları:</h3>\n                <pre className=\"text-xs text-red-700 overflow-auto max-h-32\">\n                  {this.state.error.toString()}\n                  {this.state.errorInfo?.componentStack}\n                </pre>\n              </div>\n            )}\n\n            <div className=\"flex gap-3 justify-center\">\n              <button\n                onClick={this.handleRetry}\n                className=\"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n              >\n                <RefreshCw className=\"w-4 h-4 mr-2\" />\n                Tekrar Dene\n              </button>\n              <button\n                onClick={this.handleGoHome}\n                className=\"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\n              >\n                <Home className=\"w-4 h-4 mr-2\" />\n                Ana Sayfa\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Hook version for functional components\nexport const useErrorHandler = () => {\n  const handleError = React.useCallback((error: Error, errorInfo?: any) => {\n    console.error('Error caught by error handler:', error, errorInfo);\n    \n    // You can add error reporting service here\n    // Example: Sentry.captureException(error);\n  }, []);\n\n  return handleError;\n};\n\nexport default ErrorBoundary;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/common/LoadingSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/common/SearchHighlight.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/communication/CommunicationAnalytics.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Users' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Clock' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'XCircle' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AlertTriangle' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Filter' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":9},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":279,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":288,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":350,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":358,"endColumn":22}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport {\n  TrendingUp,\n  TrendingDown,\n  MessageSquare,\n  Mail,\n  Users,\n  Clock,\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  Calendar,\n  Filter,\n  Download,\n  RefreshCw\n} from 'lucide-react';\nimport { Card, Button, Badge } from '@x-ear/ui-web';\n\ninterface CommunicationStats {\n  totalMessages: number;\n  totalSMS: number;\n  totalEmails: number;\n  deliveryRate: number;\n  openRate: number;\n  clickRate: number;\n  failureRate: number;\n  avgResponseTime: number;\n  totalCost: number;\n  activeTemplates: number;\n  activeCampaigns: number;\n}\n\ninterface TimeSeriesData {\n  date: string;\n  sms: number;\n  email: number;\n  delivered: number;\n  failed: number;\n  cost: number;\n}\n\ninterface ChannelData {\n  name: string;\n  value: number;\n  color: string;\n}\n\ninterface TemplateUsage {\n  templateName: string;\n  usageCount: number;\n  successRate: number;\n  category: string;\n}\n\ninterface CampaignPerformance {\n  campaignName: string;\n  totalSent: number;\n  delivered: number;\n  opened: number;\n  clicked: number;\n  cost: number;\n  roi: number;\n}\n\ninterface CommunicationAnalyticsProps {\n  dateRange?: {\n    startDate: string;\n    endDate: string;\n  };\n  onRefresh?: () => void;\n}\n\nconst COLORS = {\n  primary: '#3B82F6',\n  success: '#10B981',\n  warning: '#F59E0B',\n  danger: '#EF4444',\n  info: '#06B6D4',\n  purple: '#8B5CF6'\n};\n\n\nexport default function CommunicationAnalytics({ dateRange, onRefresh }: CommunicationAnalyticsProps) {\n  const [loading, setLoading] = useState(false);\n  const [stats, setStats] = useState<CommunicationStats>({\n    totalMessages: 0,\n    totalSMS: 0,\n    totalEmails: 0,\n    deliveryRate: 0,\n    openRate: 0,\n    clickRate: 0,\n    failureRate: 0,\n    avgResponseTime: 0,\n    totalCost: 0,\n    activeTemplates: 0,\n    activeCampaigns: 0\n  });\n\n  const [timeSeriesData, setTimeSeriesData] = useState<TimeSeriesData[]>([]);\n  const [channelData, setChannelData] = useState<ChannelData[]>([]);\n  const [templateUsage, setTemplateUsage] = useState<TemplateUsage[]>([]);\n  const [campaignPerformance, setCampaignPerformance] = useState<CampaignPerformance[]>([]);\n  \n  const [selectedMetric, setSelectedMetric] = useState<'volume' | 'delivery' | 'cost'>('volume');\n  const [selectedPeriod, setSelectedPeriod] = useState<'7d' | '30d' | '90d' | 'custom'>('30d');\n\n  // Fetch analytics data\n  const fetchAnalytics = async () => {\n    setLoading(true);\n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      // Mock data - in real implementation, this would come from API\n      const mockStats: CommunicationStats = {\n        totalMessages: 15420,\n        totalSMS: 9850,\n        totalEmails: 5570,\n        deliveryRate: 94.2,\n        openRate: 68.5,\n        clickRate: 12.3,\n        failureRate: 5.8,\n        avgResponseTime: 2.4,\n        totalCost: 1250.75,\n        activeTemplates: 24,\n        activeCampaigns: 8\n      };\n\n      const mockTimeSeriesData: TimeSeriesData[] = Array.from({ length: 30 }, (_, i) => {\n        const date = new Date();\n        date.setDate(date.getDate() - (29 - i));\n        return {\n          date: date.toISOString().split('T')[0],\n          sms: Math.floor(Math.random() * 200) + 100,\n          email: Math.floor(Math.random() * 150) + 50,\n          delivered: Math.floor(Math.random() * 300) + 200,\n          failed: Math.floor(Math.random() * 20) + 5,\n          cost: Math.random() * 50 + 20\n        };\n      });\n\n      const mockChannelData: ChannelData[] = [\n        { name: 'SMS', value: mockStats.totalSMS, color: COLORS.primary },\n        { name: 'E-posta', value: mockStats.totalEmails, color: COLORS.success }\n      ];\n\n      const mockTemplateUsage: TemplateUsage[] = [\n        { templateName: 'Randevu Hatırlatması', usageCount: 2450, successRate: 96.2, category: 'Randevu' },\n        { templateName: 'Ödeme Bildirimi', usageCount: 1890, successRate: 94.8, category: 'Ödeme' },\n        { templateName: 'Hoş Geldiniz Mesajı', usageCount: 1650, successRate: 98.1, category: 'Karşılama' },\n        { templateName: 'Tedavi Sonrası Takip', usageCount: 1420, successRate: 92.5, category: 'Takip' },\n        { templateName: 'Kampanya Bildirimi', usageCount: 980, successRate: 87.3, category: 'Pazarlama' }\n      ];\n\n      const mockCampaignPerformance: CampaignPerformance[] = [\n        { campaignName: 'Yaz Kampanyası 2024', totalSent: 5000, delivered: 4750, opened: 3200, clicked: 640, cost: 450, roi: 2.8 },\n        { campaignName: 'Randevu Hatırlatma', totalSent: 3200, delivered: 3100, opened: 2800, clicked: 420, cost: 280, roi: 1.9 },\n        { campaignName: 'Yeni Hasta Karşılama', totalSent: 2800, delivered: 2650, opened: 2100, clicked: 315, cost: 220, roi: 2.1 },\n        { campaignName: 'Tedavi Takip', totalSent: 2100, delivered: 2000, opened: 1680, clicked: 252, cost: 180, roi: 1.6 }\n      ];\n\n      setStats(mockStats);\n      setTimeSeriesData(mockTimeSeriesData);\n      setChannelData(mockChannelData);\n      setTemplateUsage(mockTemplateUsage);\n      setCampaignPerformance(mockCampaignPerformance);\n    } catch (error) {\n      console.error('Failed to fetch analytics:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchAnalytics();\n  }, [dateRange, selectedPeriod]);\n\n  // Calculate trends\n  const trends = useMemo(() => {\n    if (timeSeriesData.length < 2) return {};\n    \n    const recent = timeSeriesData.slice(-7);\n    const previous = timeSeriesData.slice(-14, -7);\n    \n    const recentAvg = recent.reduce((sum, item) => sum + item.sms + item.email, 0) / recent.length;\n    const previousAvg = previous.reduce((sum, item) => sum + item.sms + item.email, 0) / previous.length;\n    \n    const volumeTrend = ((recentAvg - previousAvg) / previousAvg) * 100;\n    \n    const recentDeliveryRate = recent.reduce((sum, item) => sum + (item.delivered / (item.sms + item.email)), 0) / recent.length * 100;\n    const previousDeliveryRate = previous.reduce((sum, item) => sum + (item.delivered / (item.sms + item.email)), 0) / previous.length * 100;\n    \n    const deliveryTrend = recentDeliveryRate - previousDeliveryRate;\n    \n    return {\n      volume: volumeTrend,\n      delivery: deliveryTrend,\n      cost: Math.random() * 20 - 10 // Mock trend\n    };\n  }, [timeSeriesData]);\n\n  const StatCard = ({ \n    title, \n    value, \n    icon: Icon, \n    trend, \n    format = 'number',\n    color = 'blue' \n  }: {\n    title: string;\n    value: number;\n    icon: React.ElementType;\n    trend?: number;\n    format?: 'number' | 'percentage' | 'currency' | 'time';\n    color?: 'blue' | 'green' | 'yellow' | 'red' | 'purple';\n  }) => {\n    const formatValue = (val: number) => {\n      switch (format) {\n        case 'percentage':\n          return `%${val.toFixed(1)}`;\n        case 'currency':\n          return `₺${val.toLocaleString('tr-TR', { minimumFractionDigits: 2 })}`;\n        case 'time':\n          return `${val.toFixed(1)}s`;\n        default:\n          return val.toLocaleString('tr-TR');\n      }\n    };\n\n    const colorClasses = {\n      blue: 'bg-blue-50 text-blue-600',\n      green: 'bg-green-50 text-green-600',\n      yellow: 'bg-yellow-50 text-yellow-600',\n      red: 'bg-red-50 text-red-600',\n      purple: 'bg-purple-50 text-purple-600'\n    };\n\n    return (\n      <Card className=\"p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm font-medium text-gray-600\">{title}</p>\n            <p className=\"text-2xl font-bold text-gray-900 mt-2\">\n              {formatValue(value)}\n            </p>\n            {trend !== undefined && (\n              <div className=\"flex items-center mt-2\">\n                {trend > 0 ? (\n                  <TrendingUp className=\"h-4 w-4 text-green-500 mr-1\" />\n                ) : (\n                  <TrendingDown className=\"h-4 w-4 text-red-500 mr-1\" />\n                )}\n                <span className={`text-sm ${trend > 0 ? 'text-green-600' : 'text-red-600'}`}>\n                  {Math.abs(trend).toFixed(1)}%\n                </span>\n              </div>\n            )}\n          </div>\n          <div className={`p-3 rounded-lg ${colorClasses[color]}`}>\n            <Icon className=\"h-6 w-6\" />\n          </div>\n        </div>\n      </Card>\n    );\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-900\">İletişim Analitikleri</h2>\n          <p className=\"text-gray-600 mt-1\">\n            İletişim performansınızı izleyin ve optimize edin\n          </p>\n        </div>\n        \n        <div className=\"flex items-center space-x-3\">\n          <select\n            value={selectedPeriod}\n            onChange={(e) => setSelectedPeriod(e.target.value as '7d' | '30d' | '90d' | 'custom')}\n            className=\"w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          >\n            <option value=\"7d\">Son 7 Gün</option>\n            <option value=\"30d\">Son 30 Gün</option>\n            <option value=\"90d\">Son 90 Gün</option>\n            <option value=\"custom\">Özel</option>\n          </select>\n          \n          <Button\n            variant=\"outline\"\n            onClick={() => {\n              fetchAnalytics();\n              onRefresh?.();\n            }}\n            disabled={loading}\n            className=\"flex items-center\"\n          >\n            <RefreshCw className={`h-4 w-4 mr-2 ${loading ? 'animate-spin' : ''}`} />\n            Yenile\n          </Button>\n          \n          <Button variant=\"outline\" className=\"flex items-center\">\n            <Download className=\"h-4 w-4 mr-2\" />\n            Dışa Aktar\n          </Button>\n        </div>\n      </div>\n\n      {/* Key Metrics */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <StatCard\n          title=\"Toplam Mesaj\"\n          value={stats.totalMessages}\n          icon={MessageSquare}\n          trend={trends.volume}\n          color=\"blue\"\n        />\n        <StatCard\n          title=\"Teslimat Oranı\"\n          value={stats.deliveryRate}\n          icon={CheckCircle}\n          trend={trends.delivery}\n          format=\"percentage\"\n          color=\"green\"\n        />\n        <StatCard\n          title=\"Açılma Oranı\"\n          value={stats.openRate}\n          icon={Mail}\n          format=\"percentage\"\n          color=\"purple\"\n        />\n        <StatCard\n          title=\"Toplam Maliyet\"\n          value={stats.totalCost}\n          icon={TrendingUp}\n          trend={trends.cost}\n          format=\"currency\"\n          color=\"yellow\"\n        />\n      </div>\n\n      {/* Charts Row */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Time Series Chart */}\n        <Card className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">Mesaj Hacmi Trendi</h3>\n            <select\n              value={selectedMetric}\n              onChange={(e) => setSelectedMetric(e.target.value as 'volume' | 'delivery' | 'cost')}\n              className=\"w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"volume\">Hacim</option>\n              <option value=\"delivery\">Teslimat</option>\n              <option value=\"cost\">Maliyet</option>\n            </select>\n          </div>\n          \n          {/* Simple Chart Placeholders */}\n          <div className=\"h-64 bg-gray-50 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-300\">\n            <div className=\"text-center\">\n              <div className=\"text-gray-400 mb-2\">📊</div>\n              <p className=\"text-gray-500 text-sm\">\n                {selectedMetric === 'volume' && 'SMS ve E-posta Hacmi Grafiği'}\n                {selectedMetric === 'delivery' && 'Teslimat Oranı Grafiği'}\n                {selectedMetric === 'cost' && 'Maliyet Analizi Grafiği'}\n              </p>\n              <p className=\"text-xs text-gray-400 mt-1\">\n                Grafik kütüphanesi yüklendikten sonra görüntülenecek\n              </p>\n            </div>\n          </div>\n        </Card>\n\n        {/* Channel Distribution */}\n        <Card className=\"p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Kanal Dağılımı</h3>\n          \n          {/* Simple Pie Chart Placeholder */}\n          <div className=\"h-64 bg-gray-50 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-300 mb-4\">\n            <div className=\"text-center\">\n              <div className=\"text-gray-400 mb-2\">🥧</div>\n              <p className=\"text-gray-500 text-sm\">Kanal Dağılımı Grafiği</p>\n              <p className=\"text-xs text-gray-400 mt-1\">\n                Grafik kütüphanesi yüklendikten sonra görüntülenecek\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"space-y-2\">\n            {channelData.map((item, index) => (\n              <div key={index} className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <div \n                    className=\"w-3 h-3 rounded-full mr-2\" \n                    style={{ backgroundColor: item.color }}\n                  />\n                  <span className=\"text-sm text-gray-600\">{item.name}</span>\n                </div>\n                <span className=\"text-sm font-medium\">{item.value.toLocaleString('tr-TR')}</span>\n              </div>\n            ))}\n          </div>\n        </Card>\n      </div>\n\n      {/* Template Usage */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Şablon Kullanım İstatistikleri</h3>\n        \n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Şablon Adı\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Kategori\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Kullanım\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Başarı Oranı\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Performans\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {templateUsage.map((template, index) => (\n                <tr key={index}>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm font-medium text-gray-900\">{template.templateName}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <Badge variant=\"secondary\">{template.category}</Badge>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {template.usageCount.toLocaleString('tr-TR')}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    %{template.successRate.toFixed(1)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <div className=\"w-16 bg-gray-200 rounded-full h-2 mr-2\">\n                        <div \n                          className=\"bg-green-600 h-2 rounded-full\" \n                          style={{ width: `${template.successRate}%` }}\n                        />\n                      </div>\n                      <span className=\"text-sm text-gray-600\">\n                        {template.successRate > 95 ? 'Mükemmel' : \n                         template.successRate > 90 ? 'İyi' : \n                         template.successRate > 80 ? 'Orta' : 'Düşük'}\n                      </span>\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </Card>\n\n      {/* Campaign Performance */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Kampanya Performansı</h3>\n        \n        {/* Simple Bar Chart Placeholder */}\n        <div className=\"h-64 bg-gray-50 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-300 mb-4\">\n          <div className=\"text-center\">\n            <div className=\"text-gray-400 mb-2\">📊</div>\n            <p className=\"text-gray-500 text-sm\">Kampanya Performans Grafiği</p>\n            <p className=\"text-xs text-gray-400 mt-1\">\n              Grafik kütüphanesi yüklendikten sonra görüntülenecek\n            </p>\n          </div>\n        </div>\n\n        {/* Campaign Performance Table */}\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Kampanya\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Gönderilen\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Teslim Edilen\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Açılan\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Tıklanan\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  ROI\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {campaignPerformance.map((campaign, index) => (\n                <tr key={index}>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm font-medium text-gray-900\">{campaign.campaignName}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {campaign.totalSent.toLocaleString('tr-TR')}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {campaign.delivered.toLocaleString('tr-TR')}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {campaign.opened.toLocaleString('tr-TR')}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {campaign.clicked.toLocaleString('tr-TR')}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <Badge variant={campaign.roi > 2 ? 'success' : campaign.roi > 1.5 ? 'warning' : 'secondary'}>\n                      {campaign.roi.toFixed(1)}x\n                    </Badge>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/communication/CommunicationCenter.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Filter' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'History' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MoreVertical' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Eye' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Edit' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Trash2' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Download' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Upload' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patients' is defined but never used.","line":89,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onRefresh' is defined but never used.","line":90,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'updateMessage' is assigned a value but never used.","line":96,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'saveTemplate' is assigned a value but never used.","line":98,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":98,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'updateTemplate' is assigned a value but never used.","line":99,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":99,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'deleteTemplate' is assigned a value but never used.","line":100,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":100,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'templates' is assigned a value but never used.","line":107,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":107,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'campaigns' is assigned a value but never used.","line":108,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setCampaigns' is assigned a value but never used.","line":108,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'selectedTemplate' is assigned a value but never used.","line":110,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setSelectedTemplate' is assigned a value but never used.","line":110,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'selectedCampaign' is assigned a value but never used.","line":111,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setSelectedCampaign' is assigned a value but never used.","line":111,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isLoading' is assigned a value but never used.","line":121,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":121,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'sendMessage' is assigned a value but never used.","line":291,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":291,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":477,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":477,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16180,16183],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16180,16183],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":524,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":524,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17960,17963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17960,17963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":539,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":539,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18540,18543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18540,18543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":557,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":557,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19342,19345],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19342,19345],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":28,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useMemo, useEffect } from 'react';\nimport { \n  MessageSquare, \n  Mail, \n  Send, \n  Users, \n  Calendar, \n  Filter, \n  Search, \n  Plus,\n  Settings,\n  History,\n  BarChart3,\n  FileText,\n  Clock,\n  CheckCircle,\n  AlertCircle,\n  XCircle,\n  MoreVertical,\n  Eye,\n  Edit,\n  Trash2,\n  Download,\n  Upload,\n  Wifi,\n  WifiOff,\n  RefreshCw\n} from 'lucide-react';\nimport { Button, Modal, useModal, Card, Badge, Input, Select, Tabs, useToastHelpers } from '@x-ear/ui-web';\nimport { Patient } from '../../types/patient';\nimport CommunicationTemplates from './CommunicationTemplates';\nimport CommunicationAnalytics from './CommunicationAnalytics';\nimport { useCommunicationOfflineSync } from '../../hooks/useCommunicationOfflineSync';\n\ninterface CommunicationCenterProps {\n  patients: Patient[];\n  onRefresh: () => void;\n}\n\ninterface CommunicationMessage {\n  id: string;\n  type: 'sms' | 'email';\n  recipient: string;\n  recipientName?: string;\n  patientId?: string;\n  subject?: string;\n  content: string;\n  templateId?: string;\n  scheduledAt?: string;\n  sentAt?: string;\n  deliveredAt?: string;\n  status: 'draft' | 'scheduled' | 'sent' | 'delivered' | 'failed';\n  errorMessage?: string;\n  campaignId?: string;\n  messageType: 'manual' | 'appointment_reminder' | 'campaign' | 'automated';\n  createdAt: string;\n  updatedAt?: string;\n}\n\ninterface CommunicationTemplate {\n  id: string;\n  name: string;\n  type: 'sms' | 'email';\n  subject?: string;\n  content: string;\n  variables: string[];\n  category: 'appointment' | 'reminder' | 'marketing' | 'notification' | 'custom';\n  isActive: boolean;\n  createdAt: string;\n  updatedAt?: string;\n}\n\ninterface CommunicationCampaign {\n  id: string;\n  name: string;\n  type: 'sms' | 'email';\n  templateId: string;\n  targetPatients: string[];\n  scheduledAt?: string;\n  status: 'draft' | 'scheduled' | 'running' | 'completed' | 'paused' | 'cancelled';\n  sentCount: number;\n  deliveredCount: number;\n  failedCount: number;\n  createdAt: string;\n  updatedAt?: string;\n}\n\nexport const CommunicationCenter: React.FC<CommunicationCenterProps> = ({\n  patients,\n  onRefresh\n}) => {\n  // Offline sync hook\n  const { \n    syncStatus, \n    saveMessage, \n    updateMessage, \n    getMessages, \n    saveTemplate, \n    updateTemplate, \n    deleteTemplate, \n    getTemplates, \n    forcSync \n  } = useCommunicationOfflineSync();\n\n  const [activeTab, setActiveTab] = useState<'messages' | 'templates' | 'campaigns' | 'analytics'>('messages');\n  const [messages, setMessages] = useState<CommunicationMessage[]>([]);\n  const [templates, setTemplates] = useState<CommunicationTemplate[]>([]);\n  const [campaigns, setCampaigns] = useState<CommunicationCampaign[]>([]);\n  const [selectedMessage, setSelectedMessage] = useState<CommunicationMessage | null>(null);\n  const [selectedTemplate, setSelectedTemplate] = useState<CommunicationTemplate | null>(null);\n  const [selectedCampaign, setSelectedCampaign] = useState<CommunicationCampaign | null>(null);\n  \n  // Filters\n  const [filterType, setFilterType] = useState<'all' | 'sms' | 'email'>('all');\n  const [filterStatus, setFilterStatus] = useState<'all' | 'draft' | 'scheduled' | 'sent' | 'delivered' | 'failed'>('all');\n  const [filterMessageType, setFilterMessageType] = useState<'all' | 'manual' | 'appointment_reminder' | 'campaign' | 'automated'>('all');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [dateRange, setDateRange] = useState({ start: '', end: '' });\n  \n  // Loading states\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSending, setIsSending] = useState(false);\n  \n  // Modals\n  const composeModal = useModal();\n  const campaignModal = useModal();\n  const detailModal = useModal();\n  const settingsModal = useModal();\n  \n  const { success, error } = useToastHelpers();\n\n  // Filtrelenmiş mesajlar\n  const filteredMessages = useMemo(() => {\n    return messages.filter(message => {\n      // Tip filtresi\n      if (filterType !== 'all' && message.type !== filterType) return false;\n      \n      // Durum filtresi\n      if (filterStatus !== 'all' && message.status !== filterStatus) return false;\n      \n      // Mesaj tipi filtresi\n      if (filterMessageType !== 'all' && message.messageType !== filterMessageType) return false;\n      \n      // Arama filtresi\n      if (searchTerm) {\n        const searchLower = searchTerm.toLowerCase();\n        const matchesSearch = \n          message.recipient?.toLowerCase().includes(searchLower) ||\n          message.recipientName?.toLowerCase().includes(searchLower) ||\n          message.content?.toLowerCase().includes(searchLower) ||\n          message.subject?.toLowerCase().includes(searchLower);\n        if (!matchesSearch) return false;\n      }\n      \n      // Tarih aralığı filtresi\n      if (dateRange.start && message.createdAt < dateRange.start) return false;\n      if (dateRange.end && message.createdAt > dateRange.end) return false;\n      \n      return true;\n    });\n  }, [messages, filterType, filterStatus, filterMessageType, searchTerm, dateRange]);\n\n  // Durum ikonları\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'draft': return <FileText className=\"w-4 h-4 text-gray-500\" />;\n      case 'scheduled': return <Clock className=\"w-4 h-4 text-blue-500\" />;\n      case 'sent': return <Send className=\"w-4 h-4 text-yellow-500\" />;\n      case 'delivered': return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n      case 'failed': return <XCircle className=\"w-4 h-4 text-red-500\" />;\n      default: return <AlertCircle className=\"w-4 h-4 text-gray-500\" />;\n    }\n  };\n\n  // Durum renkleri\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'draft': return 'bg-gray-100 text-gray-800';\n      case 'scheduled': return 'bg-blue-100 text-blue-800';\n      case 'sent': return 'bg-yellow-100 text-yellow-800';\n      case 'delivered': return 'bg-green-100 text-green-800';\n      case 'failed': return 'bg-red-100 text-red-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  // Durum etiketleri\n  const getStatusLabel = (status: string) => {\n    switch (status) {\n      case 'draft': return 'Taslak';\n      case 'scheduled': return 'Zamanlandı';\n      case 'sent': return 'Gönderildi';\n      case 'delivered': return 'Teslim Edildi';\n      case 'failed': return 'Başarısız';\n      default: return 'Bilinmeyen';\n    }\n  };\n\n  // Mesaj tipi etiketleri\n  const getMessageTypeLabel = (type: string) => {\n    switch (type) {\n      case 'manual': return 'Manuel';\n      case 'appointment_reminder': return 'Randevu Hatırlatması';\n      case 'campaign': return 'Kampanya';\n      case 'automated': return 'Otomatik';\n      default: return 'Bilinmeyen';\n    }\n  };\n\n  // İstatistikler\n  const stats = useMemo(() => {\n    const total = messages.length;\n    const sent = messages.filter(m => m.status === 'sent' || m.status === 'delivered').length;\n    const delivered = messages.filter(m => m.status === 'delivered').length;\n    const failed = messages.filter(m => m.status === 'failed').length;\n    const scheduled = messages.filter(m => m.status === 'scheduled').length;\n    \n    return {\n      total,\n      sent,\n      delivered,\n      failed,\n      scheduled,\n      deliveryRate: total > 0 ? Math.round((delivered / total) * 100) : 0,\n      successRate: sent > 0 ? Math.round((delivered / sent) * 100) : 0\n    };\n  }, [messages]);\n\n  // Load data from offline storage on component mount\n  useEffect(() => {\n    const loadOfflineData = () => {\n      try {\n        const offlineMessages = getMessages({});\n        const offlineTemplates = getTemplates({});\n        \n        // Convert hook's CommunicationTemplate to component's CommunicationTemplate\n        const convertedTemplates: CommunicationTemplate[] = offlineTemplates.map(template => ({\n          id: template.id,\n          name: template.name,\n          type: template.templateType,\n          subject: template.subject,\n          content: template.bodyText,\n          variables: template.variables,\n          category: template.category as 'appointment' | 'reminder' | 'marketing' | 'notification' | 'custom',\n          isActive: template.isActive,\n          createdAt: template.createdAt,\n          updatedAt: template.updatedAt\n        }));\n        \n        setMessages(offlineMessages);\n        setTemplates(convertedTemplates);\n      } catch (err) {\n        console.error('Failed to load offline data:', err);\n        error('Çevrimdışı veriler yüklenirken hata oluştu');\n      }\n    };\n\n    loadOfflineData();\n  }, [getMessages, getTemplates, error]);\n\n  // Fetch data from API\n  const fetchData = async () => {\n    if (!syncStatus.isOnline) {\n      // Use offline data when offline\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      // Simulate API calls\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      // In a real implementation, these would be actual API calls\n      // const [messagesData, templatesData, campaignsData] = await Promise.all([\n      //   fetchMessages(),\n      //   fetchTemplates(),\n      //   fetchCampaigns()\n      // ]);\n      \n      success('Veriler başarıyla yüklendi');\n    } catch (err) {\n      console.error('Failed to fetch data:', err);\n      error('Veriler yüklenirken hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Mesaj gönder\n  const sendMessage = useCallback(async (messageData: Partial<CommunicationMessage>) => {\n    setIsSending(true);\n    \n    try {\n      const newMessage: CommunicationMessage = {\n        id: Date.now().toString(),\n        type: messageData.type || 'sms',\n        recipient: messageData.recipient || '',\n        recipientName: messageData.recipientName,\n        patientId: messageData.patientId,\n        subject: messageData.subject,\n        content: messageData.content || '',\n        templateId: messageData.templateId,\n        scheduledAt: messageData.scheduledAt,\n        status: messageData.scheduledAt ? 'scheduled' : 'sent',\n        messageType: messageData.messageType || 'manual',\n        createdAt: new Date().toISOString(),\n        sentAt: messageData.scheduledAt ? undefined : new Date().toISOString()\n      };\n      \n      // Save to offline storage\n      await saveMessage(newMessage);\n      \n      setMessages(prev => [newMessage, ...prev]);\n      success('Mesaj başarıyla gönderildi');\n      composeModal.closeModal();\n      \n    } catch (err) {\n      error('Mesaj gönderme sırasında hata oluştu');\n    } finally {\n      setIsSending(false);\n    }\n  }, [success, error, composeModal, saveMessage]);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Başlık ve Kontroller */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          <div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">İletişim Merkezi</h2>\n            <p className=\"text-sm text-gray-600 mt-1\">\n              SMS ve e-posta iletişimlerini yönetin\n            </p>\n          </div>\n          \n          {/* Sync Status Indicator */}\n          <div className=\"flex items-center space-x-2\">\n            {syncStatus.isOnline ? (\n              <div className=\"flex items-center text-green-600\">\n                <Wifi className=\"h-4 w-4 mr-1\" />\n                <span className=\"text-sm\">Çevrimiçi</span>\n              </div>\n            ) : (\n              <div className=\"flex items-center text-orange-600\">\n                <WifiOff className=\"h-4 w-4 mr-1\" />\n                <span className=\"text-sm\">Çevrimdışı</span>\n              </div>\n            )}\n            \n            {syncStatus.isSyncing && (\n              <div className=\"flex items-center text-blue-600\">\n                <RefreshCw className=\"h-4 w-4 mr-1 animate-spin\" />\n                <span className=\"text-sm\">Senkronize ediliyor...</span>\n              </div>\n            )}\n            \n            {(syncStatus.pendingCount.messages > 0 || \n              syncStatus.pendingCount.templates > 0 || \n              syncStatus.pendingCount.outbox > 0) && (\n              <div className=\"flex items-center text-amber-600\">\n                <AlertCircle className=\"h-4 w-4 mr-1\" />\n                <span className=\"text-sm\">\n                  {syncStatus.pendingCount.messages + syncStatus.pendingCount.templates + syncStatus.pendingCount.outbox} bekleyen değişiklik\n                </span>\n              </div>\n            )}\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-3\">\n          {/* Force Sync Button */}\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={forcSync}\n            disabled={syncStatus.isSyncing || !syncStatus.isOnline}\n            className=\"flex items-center\"\n          >\n            <RefreshCw className={`h-4 w-4 mr-2 ${syncStatus.isSyncing ? 'animate-spin' : ''}`} />\n            Senkronize Et\n          </Button>\n          \n          <Button\n            variant=\"outline\"\n            onClick={() => settingsModal.openModal()}\n          >\n            <Settings className=\"w-4 h-4 mr-2\" />\n            Ayarlar\n          </Button>\n          \n          <Button\n            onClick={() => composeModal.openModal()}\n          >\n            <Plus className=\"w-4 h-4 mr-2\" />\n            Yeni Mesaj\n          </Button>\n        </div>\n      </div>\n\n      {/* İstatistikler */}\n      <div className=\"grid grid-cols-1 md:grid-cols-6 gap-4\">\n        <Card className=\"p-4\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-blue-100 rounded-lg\">\n              <MessageSquare className=\"w-5 h-5 text-blue-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Toplam</p>\n              <p className=\"text-xl font-semibold\">{stats.total}</p>\n            </div>\n          </div>\n        </Card>\n        \n        <Card className=\"p-4\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-yellow-100 rounded-lg\">\n              <Send className=\"w-5 h-5 text-yellow-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Gönderilen</p>\n              <p className=\"text-xl font-semibold\">{stats.sent}</p>\n            </div>\n          </div>\n        </Card>\n        \n        <Card className=\"p-4\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-green-100 rounded-lg\">\n              <CheckCircle className=\"w-5 h-5 text-green-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Teslim Edilen</p>\n              <p className=\"text-xl font-semibold\">{stats.delivered}</p>\n            </div>\n          </div>\n        </Card>\n        \n        <Card className=\"p-4\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-red-100 rounded-lg\">\n              <XCircle className=\"w-5 h-5 text-red-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Başarısız</p>\n              <p className=\"text-xl font-semibold\">{stats.failed}</p>\n            </div>\n          </div>\n        </Card>\n        \n        <Card className=\"p-4\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-purple-100 rounded-lg\">\n              <Clock className=\"w-5 h-5 text-purple-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Zamanlanmış</p>\n              <p className=\"text-xl font-semibold\">{stats.scheduled}</p>\n            </div>\n          </div>\n        </Card>\n        \n        <Card className=\"p-4\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-indigo-100 rounded-lg\">\n              <BarChart3 className=\"w-5 h-5 text-indigo-600\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Başarı Oranı</p>\n              <p className=\"text-xl font-semibold\">%{stats.successRate}</p>\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Sekmeler */}\n      <Tabs value={activeTab} onValueChange={(value) => setActiveTab(value as any)}>\n        <Tabs.List>\n          <Tabs.Trigger value=\"messages\">\n            <MessageSquare className=\"w-4 h-4 mr-2\" />\n            Mesajlar\n          </Tabs.Trigger>\n          <Tabs.Trigger value=\"templates\">\n            <FileText className=\"w-4 h-4 mr-2\" />\n            Şablonlar\n          </Tabs.Trigger>\n          <Tabs.Trigger value=\"campaigns\">\n            <Users className=\"w-4 h-4 mr-2\" />\n            Kampanyalar\n          </Tabs.Trigger>\n          <Tabs.Trigger value=\"analytics\">\n            <BarChart3 className=\"w-4 h-4 mr-2\" />\n            Analitik\n          </Tabs.Trigger>\n        </Tabs.List>\n\n        {/* Mesajlar Sekmesi */}\n        <Tabs.Content value=\"messages\">\n          <div className=\"space-y-4\">\n            {/* Filtreler */}\n            <Card className=\"p-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Arama\n                  </label>\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                    <Input\n                      placeholder=\"Mesaj ara...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      className=\"pl-10\"\n                    />\n                  </div>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Tip\n                  </label>\n                  <Select\n                    value={filterType}\n                    onChange={(value) => setFilterType(value as any)}\n                    options={[\n                      { value: 'all', label: 'Tümü' },\n                      { value: 'sms', label: 'SMS' },\n                      { value: 'email', label: 'E-posta' }\n                    ]}\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Durum\n                  </label>\n                  <Select\n                    value={filterStatus}\n                    onChange={(value) => setFilterStatus(value as any)}\n                    options={[\n                      { value: 'all', label: 'Tümü' },\n                      { value: 'draft', label: 'Taslak' },\n                      { value: 'scheduled', label: 'Zamanlandı' },\n                      { value: 'sent', label: 'Gönderildi' },\n                      { value: 'delivered', label: 'Teslim Edildi' },\n                      { value: 'failed', label: 'Başarısız' }\n                    ]}\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Mesaj Tipi\n                  </label>\n                  <Select\n                    value={filterMessageType}\n                    onChange={(value) => setFilterMessageType(value as any)}\n                    options={[\n                      { value: 'all', label: 'Tümü' },\n                      { value: 'manual', label: 'Manuel' },\n                      { value: 'appointment_reminder', label: 'Randevu Hatırlatması' },\n                      { value: 'campaign', label: 'Kampanya' },\n                      { value: 'automated', label: 'Otomatik' }\n                    ]}\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Tarih Aralığı\n                  </label>\n                  <div className=\"flex space-x-2\">\n                    <Input\n                      type=\"date\"\n                      value={dateRange.start}\n                      onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n                      className=\"text-sm\"\n                    />\n                    <Input\n                      type=\"date\"\n                      value={dateRange.end}\n                      onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n                      className=\"text-sm\"\n                    />\n                  </div>\n                </div>\n              </div>\n            </Card>\n\n            {/* Mesaj Listesi */}\n            {filteredMessages.length > 0 ? (\n              <div className=\"space-y-3\">\n                {filteredMessages.map(message => (\n                  <Card key={message.id} className=\"p-4 hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-3 mb-2\">\n                          <div className=\"flex items-center space-x-2\">\n                            {message.type === 'sms' ? (\n                              <MessageSquare className=\"w-4 h-4 text-blue-500\" />\n                            ) : (\n                              <Mail className=\"w-4 h-4 text-green-500\" />\n                            )}\n                            <span className=\"font-medium\">{message.type.toUpperCase()}</span>\n                          </div>\n                          \n                          <Badge className={getStatusColor(message.status)}>\n                            <div className=\"flex items-center space-x-1\">\n                              {getStatusIcon(message.status)}\n                              <span>{getStatusLabel(message.status)}</span>\n                            </div>\n                          </Badge>\n                          \n                          <Badge variant=\"secondary\">\n                            {getMessageTypeLabel(message.messageType)}\n                          </Badge>\n                        </div>\n                        \n                        <div className=\"space-y-1\">\n                          <div className=\"flex items-center space-x-2\">\n                            <span className=\"text-sm text-gray-600\">Alıcı:</span>\n                            <span className=\"font-medium\">\n                              {message.recipientName || message.recipient}\n                            </span>\n                            {message.recipientName && (\n                              <span className=\"text-sm text-gray-500\">({message.recipient})</span>\n                            )}\n                          </div>\n                          \n                          {message.subject && (\n                            <div className=\"flex items-center space-x-2\">\n                              <span className=\"text-sm text-gray-600\">Konu:</span>\n                              <span className=\"font-medium\">{message.subject}</span>\n                            </div>\n                          )}\n                          \n                          <div className=\"text-sm text-gray-700 line-clamp-2\">\n                            {message.content}\n                          </div>\n                          \n                          <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n                            <span>Oluşturulma: {new Date(message.createdAt).toLocaleString('tr-TR')}</span>\n                            {message.sentAt && (\n                              <span>Gönderilme: {new Date(message.sentAt).toLocaleString('tr-TR')}</span>\n                            )}\n                            {message.deliveredAt && (\n                              <span>Teslim: {new Date(message.deliveredAt).toLocaleString('tr-TR')}</span>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex items-center space-x-2 ml-4\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setSelectedMessage(message);\n                            detailModal.openModal();\n                          }}\n                        >\n                          Detay\n                        </Button>\n                        \n                        {message.status === 'failed' && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => {\n                              // Yeniden gönder\n                            }}\n                          >\n                            Yeniden Gönder\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <Card className=\"p-8 text-center\">\n                <MessageSquare className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                  Mesaj bulunamadı\n                </h3>\n                <p className=\"text-gray-600 mb-4\">\n                  Henüz gönderilmiş mesaj yok veya filtre kriterlerine uygun mesaj bulunamadı.\n                </p>\n                <Button onClick={() => composeModal.openModal()}>\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  İlk Mesajı Gönder\n                </Button>\n              </Card>\n            )}\n          </div>\n        </Tabs.Content>\n\n        {/* Şablonlar Sekmesi */}\n        <Tabs.Content value=\"templates\">\n          <CommunicationTemplates />\n        </Tabs.Content>\n\n        {/* Kampanyalar Sekmesi */}\n        <Tabs.Content value=\"campaigns\">\n          <div className=\"space-y-4\">\n            <div className=\"flex justify-end\">\n              <Button onClick={() => campaignModal.openModal()}>\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Yeni Kampanya\n              </Button>\n            </div>\n            \n            <Card className=\"p-8 text-center\">\n              <Users className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                Kampanya bulunamadı\n              </h3>\n              <p className=\"text-gray-600 mb-4\">\n                Henüz oluşturulmuş kampanya yok.\n              </p>\n              <Button onClick={() => campaignModal.openModal()}>\n                <Plus className=\"w-4 h-4 mr-2\" />\n                İlk Kampanyayı Oluştur\n              </Button>\n            </Card>\n          </div>\n        </Tabs.Content>\n\n        {/* Analitik Sekmesi */}\n        <Tabs.Content value=\"analytics\">\n          <CommunicationAnalytics \n            dateRange={{\n              startDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),\n              endDate: new Date().toISOString()\n            }}\n            onRefresh={fetchData}\n          />\n        </Tabs.Content>\n      </Tabs>\n\n      {/* Mesaj Oluştur Modal */}\n      <Modal\n        isOpen={composeModal.isOpen}\n        onClose={composeModal.closeModal}\n        title=\"Yeni Mesaj Oluştur\"\n        size=\"lg\"\n      >\n        <div className=\"space-y-4\">\n          <p className=\"text-gray-600\">\n            Mesaj oluşturma formu yakında eklenecek.\n          </p>\n          \n          <div className=\"flex justify-end space-x-3\">\n            <Button\n              variant=\"outline\"\n              onClick={composeModal.closeModal}\n            >\n              İptal\n            </Button>\n            <Button\n              onClick={() => composeModal.closeModal()}\n              loading={isSending}\n            >\n              Gönder\n            </Button>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Detay Modal */}\n      <Modal\n        isOpen={detailModal.isOpen}\n        onClose={detailModal.closeModal}\n        title=\"Mesaj Detayları\"\n        size=\"lg\"\n      >\n        {selectedMessage && (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div><strong>Tip:</strong> {selectedMessage.type.toUpperCase()}</div>\n              <div><strong>Durum:</strong> {getStatusLabel(selectedMessage.status)}</div>\n              <div><strong>Alıcı:</strong> {selectedMessage.recipientName || selectedMessage.recipient}</div>\n              <div><strong>Mesaj Tipi:</strong> {getMessageTypeLabel(selectedMessage.messageType)}</div>\n            </div>\n            \n            {selectedMessage.subject && (\n              <div>\n                <strong>Konu:</strong>\n                <p className=\"mt-1\">{selectedMessage.subject}</p>\n              </div>\n            )}\n            \n            <div>\n              <strong>İçerik:</strong>\n              <p className=\"mt-1 whitespace-pre-wrap\">{selectedMessage.content}</p>\n            </div>\n            \n            <div className=\"grid grid-cols-2 gap-4 text-sm text-gray-600\">\n              <div><strong>Oluşturulma:</strong> {new Date(selectedMessage.createdAt).toLocaleString('tr-TR')}</div>\n              {selectedMessage.sentAt && (\n                <div><strong>Gönderilme:</strong> {new Date(selectedMessage.sentAt).toLocaleString('tr-TR')}</div>\n              )}\n              {selectedMessage.deliveredAt && (\n                <div><strong>Teslim:</strong> {new Date(selectedMessage.deliveredAt).toLocaleString('tr-TR')}</div>\n              )}\n              {selectedMessage.errorMessage && (\n                <div className=\"col-span-2\"><strong>Hata:</strong> {selectedMessage.errorMessage}</div>\n              )}\n            </div>\n          </div>\n        )}\n      </Modal>\n    </div>\n  );\n};\n\nexport default CommunicationCenter;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/communication/CommunicationTemplates.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setTemplates' is assigned a value but never used.","line":19,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2472,2475],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2472,2475],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2993,2996],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2993,2996],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Plus, FileText, Edit, Trash2, Search } from 'lucide-react';\nimport { Button, Card, Badge, Input, Select } from '@x-ear/ui-web';\n\ninterface CommunicationTemplate {\n  id: string;\n  name: string;\n  type: 'sms' | 'email';\n  subject?: string;\n  content: string;\n  variables: string[];\n  category: 'appointment' | 'reminder' | 'marketing' | 'notification' | 'custom';\n  isActive: boolean;\n  createdAt: string;\n  updatedAt?: string;\n}\n\nconst CommunicationTemplates: React.FC = () => {\n  const [templates, setTemplates] = useState<CommunicationTemplate[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterType, setFilterType] = useState<'all' | 'sms' | 'email'>('all');\n  const [filterCategory, setFilterCategory] = useState<'all' | 'appointment' | 'reminder' | 'marketing' | 'notification' | 'custom'>('all');\n\n  const filteredTemplates = templates.filter(template => {\n    if (filterType !== 'all' && template.type !== filterType) return false;\n    if (filterCategory !== 'all' && template.category !== filterCategory) return false;\n    if (searchTerm && !template.name.toLowerCase().includes(searchTerm.toLowerCase())) return false;\n    return true;\n  });\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Başlık ve Yeni Şablon Butonu */}\n      <div className=\"flex justify-between items-center\">\n        <h3 className=\"text-lg font-medium text-gray-900\">İletişim Şablonları</h3>\n        <Button>\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Yeni Şablon\n        </Button>\n      </div>\n\n      {/* Filtreler */}\n      <Card className=\"p-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Arama\n            </label>\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n              <Input\n                placeholder=\"Şablon ara...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Tip\n            </label>\n            <Select\n              value={filterType}\n              onChange={(value) => setFilterType(value as any)}\n              options={[\n                { value: 'all', label: 'Tümü' },\n                { value: 'sms', label: 'SMS' },\n                { value: 'email', label: 'E-posta' }\n              ]}\n              fullWidth\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Kategori\n            </label>\n            <Select\n              value={filterCategory}\n              onChange={(value) => setFilterCategory(value as any)}\n              options={[\n                { value: 'all', label: 'Tümü' },\n                { value: 'appointment', label: 'Randevu' },\n                { value: 'reminder', label: 'Hatırlatma' },\n                { value: 'marketing', label: 'Pazarlama' },\n                { value: 'notification', label: 'Bildirim' },\n                { value: 'custom', label: 'Özel' }\n              ]}\n              fullWidth\n            />\n          </div>\n        </div>\n      </Card>\n\n      {/* Şablonlar Listesi */}\n      {filteredTemplates.length === 0 ? (\n        <Card className=\"p-8 text-center\">\n          <FileText className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            Şablon bulunamadı\n          </h3>\n          <p className=\"text-gray-600 mb-4\">\n            Henüz oluşturulmuş şablon yok veya arama kriterlerinize uygun şablon bulunamadı.\n          </p>\n          <Button>\n            <Plus className=\"w-4 h-4 mr-2\" />\n            İlk Şablonu Oluştur\n          </Button>\n        </Card>\n      ) : (\n        <div className=\"grid gap-4\">\n          {filteredTemplates.map((template) => (\n            <Card key={template.id} className=\"p-4\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-3 mb-2\">\n                    <h4 className=\"text-lg font-medium text-gray-900\">{template.name}</h4>\n                    <Badge variant={template.type === 'sms' ? 'default' : 'secondary'}>\n                      {template.type === 'sms' ? 'SMS' : 'E-posta'}\n                    </Badge>\n                    <Badge variant=\"secondary\">\n                      {template.category}\n                    </Badge>\n                    {!template.isActive && (\n                      <Badge variant=\"danger\">Pasif</Badge>\n                    )}\n                  </div>\n                  \n                  {template.subject && (\n                    <p className=\"text-sm text-gray-600 mb-2\">\n                      <strong>Konu:</strong> {template.subject}\n                    </p>\n                  )}\n                  \n                  <p className=\"text-sm text-gray-700 line-clamp-2 mb-2\">\n                    {template.content}\n                  </p>\n                  \n                  {template.variables.length > 0 && (\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <span className=\"text-xs text-gray-500\">Değişkenler:</span>\n                      {template.variables.map((variable, index) => (\n                        <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                          {variable}\n                        </Badge>\n                      ))}\n                    </div>\n                  )}\n                  \n                  <p className=\"text-xs text-gray-500\">\n                    Oluşturulma: {new Date(template.createdAt).toLocaleString('tr-TR')}\n                  </p>\n                </div>\n                \n                <div className=\"flex items-center space-x-2 ml-4\">\n                  <Button variant=\"outline\" size=\"sm\">\n                    <Edit className=\"w-4 h-4\" />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\">\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CommunicationTemplates;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/dashboard/CashRegisterCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/dashboard/CashRegisterModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":80,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":83,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3132,3135],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3132,3135],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select, Textarea } from '@x-ear/ui-web';\nimport React, { useState } from 'react';\nimport { DollarSign, CreditCard, Smartphone, User } from 'lucide-react';\nimport { Modal } from '../../../../../packages/ui-web/src/components/ui/Modal';\n\ninterface CashRegisterModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSubmit: (data: CashRegisterData) => void;\n}\n\ninterface CashRegisterData {\n  type: 'income' | 'expense';\n  recordType: 'cash' | 'card' | 'transfer';\n  patientId?: string;\n  amount: number;\n  description: string;\n}\n\nexport const CashRegisterModal: React.FC<CashRegisterModalProps> = ({\n  isOpen,\n  onClose,\n  onSubmit,\n}) => {\n  const [formData, setFormData] = useState<CashRegisterData>({\n    type: 'income',\n    recordType: 'cash',\n    amount: 0,\n    description: '',\n  });\n\n  const handleSubmit = () => {\n    if (formData.amount > 0 && formData.description.trim()) {\n      onSubmit(formData);\n      onClose();\n      // Reset form\n      setFormData({\n        type: 'income',\n        recordType: 'cash',\n        amount: 0,\n        description: '',\n      });\n    }\n  };\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      onSave={handleSubmit}\n      title=\"Kasa İşlemi\"\n      size=\"md\"\n      saveButtonText=\"Kaydet\"\n      cancelButtonText=\"İptal\"\n    >\n      <div className=\"space-y-6\">\n        {/* Transaction Type */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            İşlem Türü\n          </label>\n          <div className=\"flex space-x-4\">\n            <Button\n              type=\"button\"\n              onClick={() => setFormData({ ...formData, type: 'income' })}\n              className={`flex-1 py-2 px-4 rounded-lg border ${\n                formData.type === 'income'\n                  ? 'bg-green-50 border-green-200 text-green-700'\n                  : 'bg-gray-50 border-gray-200 text-gray-700'\n              }`}\n              variant='default'>\n              Gelir\n            </Button>\n            <Button\n              type=\"button\"\n              onClick={() => setFormData({ ...formData, type: 'expense' })}\n              className={`flex-1 py-2 px-4 rounded-lg border ${\n                formData.type === 'expense'\n                  ? 'bg-red-50 border-red-200 text-red-700'\n                  : 'bg-gray-50 border-gray-200 text-gray-700'\n              }`}\n              variant='default'>\n              Gider\n            </Button>\n          </div>\n        </div>\n\n        {/* Record Type */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Kayıt Türü\n          </label>\n          <div className=\"grid grid-cols-3 gap-3\">\n            {[\n              { value: 'cash', label: 'Nakit', icon: DollarSign },\n              { value: 'card', label: 'Kart', icon: CreditCard },\n              { value: 'transfer', label: 'Havale', icon: Smartphone },\n            ].map(({ value, label, icon: Icon }) => (\n              <Button\n                key={value}\n                type=\"button\"\n                onClick={() => setFormData({ ...formData, recordType: value as any })}\n                className={`flex flex-col items-center py-3 px-2 rounded-lg border ${\n                  formData.recordType === value\n                    ? 'bg-blue-50 border-blue-200 text-blue-700'\n                    : 'bg-gray-50 border-gray-200 text-gray-700'\n                }`}\n                variant='default'>\n                <Icon className=\"w-5 h-5 mb-1\" />\n                <span className=\"text-sm\">{label}</span>\n              </Button>\n            ))}\n          </div>\n        </div>\n\n        {/* Patient Selection (Optional) */}\n        <div>\n          <div className=\"relative\">\n            <User className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n            <Select\n              label=\"Hasta (Opsiyonel)\"\n              value={formData.patientId || ''}\n              onChange={(e) => setFormData({ ...formData, patientId: e.target.value || undefined })}\n              options={[\n                { value: \"\", label: \"Hasta seçin...\" },\n                { value: \"1\", label: \"Ahmet Yılmaz\" },\n                { value: \"2\", label: \"Ayşe Kaya\" },\n                { value: \"3\", label: \"Mehmet Demir\" }\n              ]}\n              className=\"pl-10\"\n              fullWidth\n            />\n          </div>\n        </div>\n\n        {/* Amount */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Tutar (₺)\n          </label>\n          <Input\n            type=\"number\"\n            value={formData.amount || ''}\n            onChange={(e) => setFormData({ ...formData, amount: parseFloat(e.target.value) || 0 })}\n            className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            placeholder=\"0.00\"\n            min=\"0\"\n            step=\"0.01\"\n          />\n        </div>\n\n        {/* Description */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Açıklama\n          </label>\n          <Textarea\n            value={formData.description}\n            onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n            className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            placeholder=\"İşlem açıklaması...\"\n            rows={3}\n          />\n        </div>\n      </div>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/dashboard/DashboardStats.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/dashboard/KPICard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/dashboard/PricingCalculatorCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/dashboard/PricingCalculatorModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/dashboard/QuickStatsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/forms/AppointmentSchedulingForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AlertCircle' is defined but never used.","line":4,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":54},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1364,1367],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1364,1367],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getAppointmentTypeText' is assigned a value but never used.","line":149,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":149,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getStatusText' is assigned a value but never used.","line":166,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":166,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":211,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":217,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":232,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":243,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":260,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":278,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":291,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":302,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":293,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":293,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9921,9924],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9921,9924],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":312,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":320,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":336,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":342,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":355,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":361,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":371,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":381,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":373,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":373,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13495,13498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13495,13498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button } from '../ui/Button';\nimport { Modal } from '../ui/Modal';\nimport { Calendar, Clock, User, FileText, AlertCircle, MapPin } from 'lucide-react';\n\ninterface Appointment {\n  id?: string;\n  patientId: string;\n  appointmentDate: string;\n  appointmentTime: string;\n  duration: number; // dakika cinsinden\n  doctorId: string;\n  doctorName: string;\n  appointmentType: 'consultation' | 'fitting' | 'follow_up' | 'repair' | 'other';\n  status: 'scheduled' | 'confirmed' | 'completed' | 'cancelled' | 'no_show';\n  notes?: string;\n  location?: string;\n  createdBy: string;\n  createdAt: string;\n}\n\ninterface AppointmentSchedulingFormProps {\n  patientId: string;\n  appointment?: Appointment | null;\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (appointmentData: Partial<Appointment>) => Promise<void>;\n  isLoading?: boolean;\n}\n\nexport const AppointmentSchedulingForm: React.FC<AppointmentSchedulingFormProps> = ({\n  patientId,\n  appointment,\n  isOpen,\n  onClose,\n  onSave,\n  isLoading = false\n}) => {\n  const [formData, setFormData] = useState<Partial<Appointment>>({\n    patientId,\n    appointmentDate: '',\n    appointmentTime: '',\n    duration: 30,\n    status: 'scheduled',\n    createdBy: 'current_user' // TODO: Get from auth context\n  });\n\n  const [availableDoctors, setAvailableDoctors] = useState<any[]>([]);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Reset form when modal opens/closes or appointment changes\n  useEffect(() => {\n    if (isOpen) {\n      if (appointment) {\n        // Edit mode\n        setFormData({\n          ...appointment,\n          appointmentDate: appointment.appointmentDate.split('T')[0], // Convert to date input format\n          appointmentTime: appointment.appointmentTime.substring(0, 5) // Convert to time input format (HH:MM)\n        });\n      } else {\n        // Create mode\n        setFormData({\n          patientId,\n          appointmentDate: '',\n          appointmentTime: '',\n          duration: 30,\n          status: 'scheduled',\n          createdBy: 'current_user' // TODO: Get from auth context\n        });\n      }\n      setErrors({});\n    }\n  }, [isOpen, appointment, patientId]);\n\n  // Load available doctors\n  useEffect(() => {\n    if (isOpen) {\n      // TODO: Load available doctors from API\n      setAvailableDoctors([\n        { id: '1', name: 'Dr. Ahmet Yılmaz', specialty: 'Kulak Burun Boğaz', title: 'Uzman Dr.' },\n        { id: '2', name: 'Dr. Ayşe Kaya', specialty: 'Audioloji', title: 'Uzman Dr.' },\n        { id: '3', name: 'Dr. Mehmet Demir', specialty: 'Kulak Burun Boğaz', title: 'Prof. Dr.' }\n      ]);\n    }\n  }, [isOpen]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.appointmentDate) {\n      newErrors.appointmentDate = 'Randevu tarihi zorunludur';\n    }\n\n    if (!formData.appointmentTime) {\n      newErrors.appointmentTime = 'Randevu saati zorunludur';\n    }\n\n    if (!formData.doctorId) {\n      newErrors.doctorId = 'Doktor seçimi zorunludur';\n    }\n\n    if (!formData.appointmentType) {\n      newErrors.appointmentType = 'Randevu türü zorunludur';\n    }\n\n    if (!formData.duration || formData.duration < 15) {\n      newErrors.duration = 'Geçerli bir süre giriniz (minimum 15 dakika)';\n    }\n\n    // Geçmiş tarih kontrolü\n    if (formData.appointmentDate) {\n      const appointmentDateTime = new Date(`${formData.appointmentDate}T${formData.appointmentTime || '00:00'}`);\n      const now = new Date();\n\n      if (appointmentDateTime < now) {\n        newErrors.appointmentDate = 'Geçmiş tarihli randevu oluşturamazsınız';\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      return;\n    }\n\n    try {\n      // Combine date and time for backend\n      const appointmentDateTime = `${formData.appointmentDate}T${formData.appointmentTime}:00`;\n\n      const appointmentData = {\n        ...formData,\n        appointmentDate: appointmentDateTime,\n        appointmentTime: formData.appointmentTime\n      };\n\n      await onSave(appointmentData);\n      onClose();\n    } catch (error) {\n      console.error('Randevu kaydedilirken hata:', error);\n    }\n  };\n\n  const getAppointmentTypeText = (type: string): string => {\n    switch (type) {\n      case 'consultation':\n        return 'Konsultasyon';\n      case 'fitting':\n        return 'Cihaz Uygulaması';\n      case 'follow_up':\n        return 'Kontrol';\n      case 'repair':\n        return 'Tamirat';\n      case 'other':\n        return 'Diğer';\n      default:\n        return type;\n    }\n  };\n\n  const getStatusText = (status: string): string => {\n    switch (status) {\n      case 'scheduled':\n        return 'Planlandı';\n      case 'confirmed':\n        return 'Onaylandı';\n      case 'completed':\n        return 'Tamamlandı';\n      case 'cancelled':\n        return 'İptal Edildi';\n      case 'no_show':\n        return 'Gelmedi';\n      default:\n        return status;\n    }\n  };\n\n  const generateTimeSlots = (): string[] => {\n    const slots: string[] = [];\n    for (let hour = 8; hour <= 17; hour++) {\n      for (let minute = 0; minute < 60; minute += 30) {\n        const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n        slots.push(timeString);\n      }\n    }\n    return slots;\n  };\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      title={appointment ? 'Randevuyu Düzenle' : 'Yeni Randevu Oluştur'}\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Tarih ve Saat */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Randevu Tarihi *\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"date\"\n                value={formData.appointmentDate || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, appointmentDate: e.target.value }))}\n                min={new Date().toISOString().split('T')[0]}\n                className={`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.appointmentDate ? 'border-red-300' : ''}`}\n              />\n              {errors.appointmentDate && (\n                <p className=\"mt-1 text-sm text-red-600\">{errors.appointmentDate}</p>\n              )}\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Randevu Saati *\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <Clock className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <select\n                value={formData.appointmentTime || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, appointmentTime: e.target.value }))}\n                className={`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.appointmentTime ? 'border-red-300' : ''}`}\n              >\n                <option value=\"\">Saat seçin...</option>\n                {generateTimeSlots().map((time) => (\n                  <option key={time} value={time}>\n                    {time}\n                  </option>\n                ))}\n              </select>\n              {errors.appointmentTime && (\n                <p className=\"mt-1 text-sm text-red-600\">{errors.appointmentTime}</p>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Doktor Seçimi */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Doktor *\n          </label>\n          <div className=\"relative\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n              <User className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <select\n              value={formData.doctorId || ''}\n              onChange={(e) => {\n                const selectedDoctor = availableDoctors.find(d => d.id === e.target.value);\n                setFormData(prev => ({\n                  ...prev,\n                  doctorId: e.target.value,\n                  doctorName: selectedDoctor ? selectedDoctor.name : ''\n                }));\n              }}\n              className={`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.doctorId ? 'border-red-300' : ''}`}\n            >\n              <option value=\"\">Doktor seçin...</option>\n              {availableDoctors.map((doctor) => (\n                <option key={doctor.id} value={doctor.id}>\n                  {doctor.title} {doctor.name} - {doctor.specialty}\n                </option>\n              ))}\n            </select>\n            {errors.doctorId && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.doctorId}</p>\n            )}\n          </div>\n        </div>\n\n        {/* Randevu Türü ve Süre */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Randevu Türü *\n            </label>\n            <select\n              value={formData.appointmentType || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, appointmentType: e.target.value as any }))}\n              className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.appointmentType ? 'border-red-300' : ''}`}\n            >\n              <option value=\"\">Tür seçin...</option>\n              <option value=\"consultation\">Konsultasyon</option>\n              <option value=\"fitting\">Cihaz Uygulaması</option>\n              <option value=\"follow_up\">Kontrol</option>\n              <option value=\"repair\">Tamirat</option>\n              <option value=\"other\">Diğer</option>\n            </select>\n            {errors.appointmentType && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.appointmentType}</p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Süre (dakika) *\n            </label>\n            <input\n              type=\"number\"\n              min=\"15\"\n              max=\"240\"\n              step=\"15\"\n              value={formData.duration || 30}\n              onChange={(e) => setFormData(prev => ({ ...prev, duration: parseInt(e.target.value) }))}\n              className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.duration ? 'border-red-300' : ''}`}\n            />\n            {errors.duration && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.duration}</p>\n            )}\n          </div>\n        </div>\n\n        {/* Konum */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Konum\n          </label>\n          <div className=\"relative\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n              <MapPin className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <input\n              type=\"text\"\n              value={formData.location || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, location: e.target.value }))}\n              placeholder=\"Randevu yeri (örn: Klinik, Hastane)\"\n              className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Notlar */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <div className=\"relative\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 pt-3 flex items-start pointer-events-none\">\n              <FileText className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <textarea\n              value={formData.notes || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n              placeholder=\"Randevu ile ilgili notlar...\"\n              rows={3}\n              className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Durum (sadece düzenleme modunda göster) */}\n        {appointment && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Durum\n            </label>\n            <select\n              value={formData.status || 'scheduled'}\n              onChange={(e) => setFormData(prev => ({ ...prev, status: e.target.value as any }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n              <option value=\"scheduled\">Planlandı</option>\n              <option value=\"confirmed\">Onaylandı</option>\n              <option value=\"completed\">Tamamlandı</option>\n              <option value=\"cancelled\">İptal Edildi</option>\n              <option value=\"no_show\">Gelmedi</option>\n            </select>\n          </div>\n        )}\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end space-x-3 pt-6 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={onClose}\n            disabled={isLoading}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"min-w-[120px]\"\n          >\n            {isLoading ? 'Kaydediliyor...' : (appointment ? 'Güncelle' : 'Randevu Oluştur')}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/forms/DeviceAssignmentForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Package' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":10},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'calculateSalePrice'. Either include it or remove the dependency array.","line":210,"column":6,"nodeType":"ArrayExpression","endLine":210,"endColumn":98,"suggestions":[{"desc":"Update the dependencies array to be: [formData.listPrice, formData.discountType, formData.discountValue, formData.sgkSupportType, calculateSalePrice]","fix":{"range":[5961,6053],"text":"[formData.listPrice, formData.discountType, formData.discountValue, formData.sgkSupportType, calculateSalePrice]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'calculateRemainingAmount'. Either include it or remove the dependency array.","line":217,"column":6,"nodeType":"ArrayExpression","endLine":217,"endColumn":67,"suggestions":[{"desc":"Update the dependencies array to be: [formData.patientPayment, formData.downPayment, formData.ear, calculateRemainingAmount]","fix":{"range":[6253,6314],"text":"[formData.patientPayment, formData.downPayment, formData.ear, calculateRemainingAmount]"}}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":358,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":364,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":432,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":439,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":437,"column":91,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":437,"endColumn":94,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14210,14213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14210,14213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":457,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":470,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":459,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":459,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15080,15083],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15080,15083],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":486,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":495,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":499,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":508,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":512,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":521,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":538,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":546,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":550,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":565,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":573,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":578,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":582,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":590,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":584,"column":100,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":584,"endColumn":103,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21413,21416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21413,21416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":594,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":603,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":634,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":639,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":643,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":651,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":668,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":673,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":678,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":686,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":691,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":696,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":707,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":717,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":709,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":709,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27096,27099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27096,27099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":727,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":747,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":751,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":756,"endColumn":21},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":773,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":778,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":793,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":799,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":817,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":824,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":822,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":822,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[32279,32282],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[32279,32282],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":851,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":856,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":874,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":879,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":890,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":901,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":914,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":920,"endColumn":15}],"suppressedMessages":[],"errorCount":32,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button } from '../ui/Button';\nimport { Modal } from '../ui/Modal';\nimport { \n  Headphones, \n  Calendar, \n  User, \n  FileText, \n  AlertCircle, \n  CheckCircle, \n  Search,\n  CreditCard,\n  Calculator,\n  Package\n} from 'lucide-react';\n\ninterface DeviceInventoryItem {\n  id: string;\n  uniqueId?: string;\n  brand: string;\n  model: string;\n  price: number;\n  ear: 'left' | 'right' | 'both' | 'bilateral';\n  direction?: 'left' | 'right' | 'both';\n  availableInventory: number;\n  serialNumbers?: string[];\n  availableSerials?: string[];\n  barcode?: string;\n  category: string;\n  status: 'available' | 'out_of_stock';\n}\n\ninterface DeviceAssignment {\n  id?: string;\n  deviceId: string;\n  patientId: string;\n  assignedDate: string;\n  assignedBy: string;\n  status: 'assigned' | 'trial' | 'returned' | 'defective';\n  ear: 'left' | 'right' | 'both';\n  reason: 'sale' | 'service' | 'repair' | 'trial' | 'replacement' | 'proposal' | 'other';\n  notes?: string;\n  trialEndDate?: string;\n  returnDate?: string;\n  condition?: string;\n  // Pricing fields\n  listPrice?: number;\n  salePrice?: number;\n  sgkSupportType?: string;\n  sgkReduction?: number;\n  discountType?: 'none' | 'percentage' | 'amount';\n  discountValue?: number;\n  patientPayment?: number;\n  downPayment?: number;\n  remainingAmount?: number;\n  paymentMethod?: 'cash' | 'card' | 'transfer' | 'installment';\n  installmentCount?: number;\n  monthlyInstallment?: number;\n  // Serial numbers\n  serialNumber?: string;\n  serialNumberLeft?: string;\n  serialNumberRight?: string;\n  // Trial pricing\n  trialListPrice?: number;\n  trialPrice?: number;\n}\n\ninterface DeviceAssignmentFormProps {\n  patientId: string;\n  assignment?: DeviceAssignment | null;\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (assignmentData: Partial<DeviceAssignment>) => Promise<void>;\n  isLoading?: boolean;\n}\n\nexport const DeviceAssignmentForm: React.FC<DeviceAssignmentFormProps> = ({\n  patientId,\n  assignment,\n  isOpen,\n  onClose,\n  onSave,\n  isLoading = false\n}) => {\n  const [formData, setFormData] = useState<Partial<DeviceAssignment>>({\n    patientId,\n    assignedDate: new Date().toISOString().split('T')[0],\n    status: 'assigned',\n    assignedBy: 'current_user', // TODO: Get from auth context\n    ear: 'left',\n    reason: 'sale',\n    discountType: 'none',\n    paymentMethod: 'cash'\n  });\n\n  const [availableDevices, setAvailableDevices] = useState<DeviceInventoryItem[]>([]);\n  const [filteredDevices, setFilteredDevices] = useState<DeviceInventoryItem[]>([]);\n  const [selectedDevice, setSelectedDevice] = useState<DeviceInventoryItem | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // SGK support amounts (default values)\n  const sgkAmounts = {\n    'under4_parent_working': 6104.44,\n    'under4_parent_retired': 7630.56,\n    'age5_12_parent_working': 5426.17,\n    'age5_12_parent_retired': 6782.72,\n    'age13_18_parent_working': 5087.04,\n    'age13_18_parent_retired': 6358.88,\n    'over18_working': 3391.36,\n    'over18_retired': 4239.20\n  };\n\n  // Reset form when modal opens/closes or assignment changes\n  useEffect(() => {\n    if (isOpen) {\n      if (assignment) {\n        // Edit mode\n        setFormData({\n          ...assignment,\n          assignedDate: assignment.assignedDate.split('T')[0] // Convert to date input format\n        });\n      } else {\n        // Create mode\n        setFormData({\n          patientId,\n          assignedDate: new Date().toISOString().split('T')[0],\n          status: 'assigned',\n          assignedBy: 'current_user', // TODO: Get from auth context\n          ear: 'left',\n          reason: 'sale',\n          discountType: 'none',\n          paymentMethod: 'cash'\n        });\n      }\n      setErrors({});\n      setSearchTerm('');\n      setSelectedDevice(null);\n    }\n  }, [isOpen, assignment, patientId]);\n\n  // Load available devices\n  useEffect(() => {\n    if (isOpen) {\n      // TODO: Load available devices from API - for now using mock data\n      const mockDevices: DeviceInventoryItem[] = [\n        {\n          id: '1',\n          brand: 'Phonak',\n          model: 'Audeo B90',\n          price: 15000,\n          ear: 'right',\n          availableInventory: 5,\n          serialNumbers: ['PH001', 'PH002', 'PH003'],\n          availableSerials: ['PH001', 'PH002', 'PH003'],\n          barcode: 'BC001',\n          category: 'hearing_aid',\n          status: 'available'\n        },\n        {\n          id: '2',\n          brand: 'Oticon',\n          model: 'Opn S',\n          price: 18000,\n          ear: 'left',\n          availableInventory: 3,\n          serialNumbers: ['OT001', 'OT002'],\n          availableSerials: ['OT001', 'OT002'],\n          barcode: 'BC002',\n          category: 'hearing_aid',\n          status: 'available'\n        },\n        {\n          id: '3',\n          brand: 'Widex',\n          model: 'Beyond 440',\n          price: 20000,\n          ear: 'both',\n          availableInventory: 8,\n          serialNumbers: ['WX001', 'WX002', 'WX003', 'WX004'],\n          availableSerials: ['WX001', 'WX002', 'WX003', 'WX004'],\n          barcode: 'BC003',\n          category: 'hearing_aid',\n          status: 'available'\n        }\n      ];\n      setAvailableDevices(mockDevices);\n      setFilteredDevices(mockDevices);\n    }\n  }, [isOpen]);\n\n  // Filter devices based on search term\n  useEffect(() => {\n    if (!searchTerm.trim()) {\n      setFilteredDevices(availableDevices);\n    } else {\n      const filtered = availableDevices.filter(device => {\n        const searchText = `${device.brand} ${device.model} ${device.barcode || ''}`.toLowerCase();\n        return searchText.includes(searchTerm.toLowerCase());\n      });\n      setFilteredDevices(filtered);\n    }\n  }, [searchTerm, availableDevices]);\n\n  // Calculate pricing when relevant fields change\n  useEffect(() => {\n    if (formData.listPrice) {\n      calculateSalePrice();\n    }\n  }, [formData.listPrice, formData.discountType, formData.discountValue, formData.sgkSupportType]);\n\n  // Calculate remaining amount when down payment changes\n  useEffect(() => {\n    if (formData.patientPayment && formData.downPayment !== undefined) {\n      calculateRemainingAmount();\n    }\n  }, [formData.patientPayment, formData.downPayment, formData.ear]);\n\n  const calculateSalePrice = () => {\n    const listPrice = formData.listPrice || 0;\n    const discountType = formData.discountType || 'none';\n    const discountValue = formData.discountValue || 0;\n    const sgkType = formData.sgkSupportType || '';\n\n    let salePrice = listPrice;\n\n    // Apply discount\n    if (discountType === 'percentage' && discountValue > 0) {\n      const discountAmount = (listPrice * discountValue) / 100;\n      salePrice = Math.max(0, listPrice - discountAmount);\n    } else if (discountType === 'amount' && discountValue > 0) {\n      salePrice = Math.max(0, listPrice - discountValue);\n    }\n\n    // Calculate SGK reduction from list price\n    let sgkReduction = 0;\n    if (sgkType && sgkType !== '' && sgkType !== 'no_coverage') {\n      const sgkAmount = sgkAmounts[sgkType as keyof typeof sgkAmounts] || 0;\n      sgkReduction = Math.min(sgkAmount, listPrice);\n    }\n\n    // Calculate patient payment\n    const quantity = formData.ear === 'both' ? 2 : 1;\n    const patientPayment = Math.max(0, (salePrice - sgkReduction) * quantity);\n\n    setFormData(prev => ({\n      ...prev,\n      salePrice,\n      sgkReduction,\n      patientPayment\n    }));\n  };\n\n  const calculateRemainingAmount = () => {\n    const patientPayment = formData.patientPayment || 0;\n    const downPayment = formData.downPayment || 0;\n    const remainingAmount = Math.max(0, patientPayment - downPayment);\n\n    setFormData(prev => ({\n      ...prev,\n      remainingAmount\n    }));\n  };\n\n  const handleDeviceSelect = (device: DeviceInventoryItem) => {\n    setSelectedDevice(device);\n    setFormData(prev => ({\n      ...prev,\n      deviceId: device.id,\n      listPrice: device.price,\n      trialListPrice: device.price,\n      trialPrice: device.price\n    }));\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.deviceId) {\n      newErrors.deviceId = 'Cihaz seçimi zorunludur';\n    }\n\n    if (!formData.assignedDate) {\n      newErrors.assignedDate = 'Atama tarihi zorunludur';\n    }\n\n    if (!formData.status) {\n      newErrors.status = 'Durum seçimi zorunludur';\n    }\n\n    if (!formData.reason) {\n      newErrors.reason = 'Atama sebebi zorunludur';\n    }\n\n    if (formData.status === 'trial' && !formData.trialEndDate) {\n      newErrors.trialEndDate = 'Deneme bitiş tarihi zorunludur';\n    }\n\n    if (['sale', 'proposal'].includes(formData.reason || '') && formData.paymentMethod && !formData.paymentMethod) {\n      newErrors.paymentMethod = 'Ödeme yöntemi seçimi zorunludur';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      return;\n    }\n\n    try {\n      await onSave(formData);\n      onClose();\n    } catch (error) {\n      console.error('Cihaz ataması kaydedilirken hata:', error);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'assigned':\n        return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n      case 'trial':\n        return <Calendar className=\"w-4 h-4 text-blue-500\" />;\n      case 'returned':\n        return <User className=\"w-4 h-4 text-gray-500\" />;\n      case 'defective':\n        return <AlertCircle className=\"w-4 h-4 text-red-500\" />;\n      default:\n        return <Headphones className=\"w-4 h-4 text-gray-400\" />;\n    }\n  };\n\n  const showPricingSection = ['sale', 'proposal'].includes(formData.reason || '');\n  const showTrialPricingSection = formData.reason === 'trial';\n  const showDownPaymentSection = formData.reason === 'sale';\n  const showPaymentSection = ['sale', 'proposal'].includes(formData.reason || '');\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      title={assignment ? 'Cihaz Atamasını Düzenle' : 'Yeni Cihaz Ataması'}\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Device Search and Selection */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Cihaz Arama ve Seçimi *\n          </label>\n          <div className=\"relative mb-4\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n              <Search className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <input\n              type=\"text\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              placeholder=\"Cihaz ara (marka, model, barkod)...\"\n              className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n\n          {/* Device List */}\n          <div className=\"max-h-64 overflow-y-auto border border-gray-200 rounded-md\">\n            <div className=\"grid grid-cols-1 gap-2 p-2\">\n              {filteredDevices.map((device) => (\n                <div\n                  key={device.id}\n                  onClick={() => handleDeviceSelect(device)}\n                  className={`p-3 border rounded-lg cursor-pointer transition-all hover:shadow-md ${\n                    selectedDevice?.id === device.id\n                      ? 'border-blue-500 bg-blue-50 shadow-lg'\n                      : 'border-gray-300 hover:border-blue-300'\n                  }`}\n                >\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-xs font-medium text-gray-600 uppercase\">\n                        {device.ear === 'left' ? 'Sol' : device.ear === 'right' ? 'Sağ' : 'Bilateral'}\n                      </span>\n                    </div>\n                    {device.availableInventory > 0 ? (\n                      <span className=\"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800\">\n                        ✓ Stokta\n                      </span>\n                    ) : (\n                      <span className=\"px-2 py-1 text-xs rounded-full bg-red-100 text-red-800\">\n                        ⚠️ Stokta Yok\n                      </span>\n                    )}\n                  </div>\n                  \n                  <h4 className=\"font-semibold text-sm text-gray-900 mb-1\">\n                    {device.brand} {device.model}\n                  </h4>\n                  \n                  {device.barcode && (\n                    <p className=\"text-xs font-mono bg-gray-100 text-gray-700 px-2 py-1 rounded mb-1\">\n                      {device.barcode}\n                    </p>\n                  )}\n                  \n                  <div className=\"flex justify-between items-center mt-2 text-xs\">\n                    <span className=\"text-gray-600\">Stok: {device.availableInventory}</span>\n                    <span className=\"text-gray-700 font-medium\">₺{device.price.toLocaleString()}</span>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n          {errors.deviceId && (\n            <p className=\"mt-1 text-sm text-red-600\">{errors.deviceId}</p>\n          )}\n        </div>\n\n        {/* Ear Selection */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Kulak Seçimi *\n          </label>\n          <div className=\"flex gap-2\">\n            {[\n              { value: 'left', label: 'Sol' },\n              { value: 'right', label: 'Sağ' },\n              { value: 'both', label: 'İkisi (Bilateral)' }\n            ].map((ear) => (\n              <label key={ear.value} className=\"flex-1\">\n                <input\n                  type=\"radio\"\n                  name=\"ear\"\n                  value={ear.value}\n                  checked={formData.ear === ear.value}\n                  onChange={(e) => setFormData(prev => ({ ...prev, ear: e.target.value as any }))}\n                  className=\"sr-only\"\n                />\n                <div className={`px-6 py-3 text-center border-2 rounded-lg cursor-pointer transition-all ${\n                  formData.ear === ear.value\n                    ? 'border-blue-500 bg-blue-50 text-blue-700'\n                    : 'border-gray-300 hover:border-blue-500 hover:bg-blue-50'\n                }`}>\n                  <span className=\"text-sm font-medium\">{ear.label}</span>\n                </div>\n              </label>\n            ))}\n          </div>\n        </div>\n\n        {/* Assignment Reason */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Atama Sebebi *\n          </label>\n          <select\n            value={formData.reason || ''}\n            onChange={(e) => setFormData(prev => ({ ...prev, reason: e.target.value as any }))}\n            className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.reason ? 'border-red-300' : ''}`}\n          >\n            <option value=\"\">Sebep seçin...</option>\n            <option value=\"sale\">Satış</option>\n            <option value=\"service\">Servis</option>\n            <option value=\"repair\">Tamir</option>\n            <option value=\"trial\">Deneme</option>\n            <option value=\"replacement\">Değişim</option>\n            <option value=\"proposal\">Teklif</option>\n            <option value=\"other\">Diğer</option>\n          </select>\n          {errors.reason && (\n            <p className=\"mt-1 text-sm text-red-600\">{errors.reason}</p>\n          )}\n        </div>\n\n        {/* Serial Number Selection */}\n        {selectedDevice && selectedDevice.availableSerials && selectedDevice.availableSerials.length > 0 && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Seri Numarası (İsteğe Bağlı)\n            </label>\n            {formData.ear === 'both' ? (\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-xs text-gray-600 mb-1\">Sol Kulak Seri No</label>\n                  <select\n                    value={formData.serialNumberLeft || ''}\n                    onChange={(e) => setFormData(prev => ({ ...prev, serialNumberLeft: e.target.value }))}\n                    className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                  >\n                    <option value=\"\">Sol seri seçin (opsiyonel)</option>\n                    {selectedDevice.availableSerials.map(serial => (\n                      <option key={serial} value={serial}>{serial}</option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-xs text-gray-600 mb-1\">Sağ Kulak Seri No</label>\n                  <select\n                    value={formData.serialNumberRight || ''}\n                    onChange={(e) => setFormData(prev => ({ ...prev, serialNumberRight: e.target.value }))}\n                    className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                  >\n                    <option value=\"\">Sağ seri seçin (opsiyonel)</option>\n                    {selectedDevice.availableSerials.map(serial => (\n                      <option key={serial} value={serial}>{serial}</option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n            ) : (\n              <select\n                value={formData.serialNumber || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, serialNumber: e.target.value }))}\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n              >\n                <option value=\"\">Seri numarası seçin (opsiyonel)</option>\n                {selectedDevice.availableSerials.map(serial => (\n                  <option key={serial} value={serial}>{serial}</option>\n                ))}\n              </select>\n            )}\n          </div>\n        )}\n\n        {/* Pricing Section (for sale/proposal) */}\n        {showPricingSection && (\n          <div className=\"border border-gray-200 rounded-lg p-4\">\n            <div className=\"flex items-center mb-4\">\n              <Calculator className=\"w-5 h-5 text-blue-500 mr-2\" />\n              <h3 className=\"text-lg font-medium text-gray-900\">Fiyatlandırma</h3>\n            </div>\n            \n            {/* First Row: Liste Fiyatı and SGK Desteği */}\n            <div className=\"grid grid-cols-3 gap-4 mb-3\">\n              <div className=\"col-span-2\">\n                <label className=\"block text-xs text-gray-600 mb-1\">Liste Fiyatı</label>\n                <input\n                  type=\"number\"\n                  value={formData.listPrice || ''}\n                  onChange={(e) => setFormData(prev => ({ ...prev, listPrice: parseFloat(e.target.value) || 0 }))}\n                  step=\"0.01\"\n                  min=\"0\"\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                  placeholder=\"0.00\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">SGK Desteği</label>\n                <select\n                  value={formData.sgkSupportType || ''}\n                  onChange={(e) => setFormData(prev => ({ ...prev, sgkSupportType: e.target.value }))}\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 text-sm\"\n                >\n                  <option value=\"\">Yok</option>\n                  <option value=\"no_coverage\">Hakkı yok</option>\n                  <option value=\"under4_parent_working\">0-4 yaş, çalışan</option>\n                  <option value=\"under4_parent_retired\">0-4 yaş, emekli</option>\n                  <option value=\"age5_12_parent_working\">5-12 yaş, çalışan</option>\n                  <option value=\"age5_12_parent_retired\">5-12 yaş, emekli</option>\n                  <option value=\"age13_18_parent_working\">13-18 yaş, çalışan</option>\n                  <option value=\"age13_18_parent_retired\">13-18 yaş, emekli</option>\n                  <option value=\"over18_working\">18+ yaş, çalışan</option>\n                  <option value=\"over18_retired\">18+ yaş, emekli</option>\n                </select>\n              </div>\n            </div>\n            \n            {/* Second Row: Satış Fiyatı, İndirim Type, İndirim Miktarı */}\n            <div className=\"grid grid-cols-4 gap-3 mb-3\">\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Satış Fiyatı</label>\n                <input\n                  type=\"number\"\n                  value={formData.salePrice?.toFixed(2) || '0.00'}\n                  readOnly\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">İndirim</label>\n                <select\n                  value={formData.discountType || 'none'}\n                  onChange={(e) => setFormData(prev => ({ ...prev, discountType: e.target.value as any }))}\n                  className=\"w-full border border-gray-300 rounded-md px-2 py-2 text-sm\"\n                >\n                  <option value=\"none\">İndirim Yok</option>\n                  <option value=\"percentage\">Oran (%)</option>\n                  <option value=\"amount\">Miktar (₺)</option>\n                </select>\n              </div>\n              <div className=\"col-span-2\">\n                <label className=\"block text-xs text-gray-600 mb-1\">İndirim Miktarı</label>\n                <input\n                  type=\"number\"\n                  value={formData.discountValue || ''}\n                  onChange={(e) => setFormData(prev => ({ ...prev, discountValue: parseFloat(e.target.value) || 0 }))}\n                  step=\"0.01\"\n                  min=\"0\"\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                  placeholder=\"0\"\n                  disabled={formData.discountType === 'none'}\n                />\n              </div>\n            </div>\n\n            {/* Patient Payment Display */}\n            <div className=\"bg-blue-50 p-3 rounded-md\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-sm font-medium text-blue-900\">Hasta Ödemesi:</span>\n                <span className=\"text-lg font-bold text-blue-900\">\n                  ₺{formData.patientPayment?.toFixed(2) || '0.00'}\n                </span>\n              </div>\n              {formData.sgkReduction && formData.sgkReduction > 0 && (\n                <div className=\"text-xs text-blue-700 mt-1\">\n                  SGK İndirimi: ₺{formData.sgkReduction.toFixed(2)}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Trial Pricing Section */}\n        {showTrialPricingSection && (\n          <div className=\"border border-gray-200 rounded-lg p-4\">\n            <div className=\"flex items-center mb-4\">\n              <Calendar className=\"w-5 h-5 text-blue-500 mr-2\" />\n              <h3 className=\"text-lg font-medium text-gray-900\">Deneme Fiyatlandırması</h3>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Liste Fiyatı</label>\n                <input\n                  type=\"number\"\n                  value={formData.trialListPrice?.toFixed(2) || '0.00'}\n                  readOnly\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Deneme Fiyatı</label>\n                <input\n                  type=\"number\"\n                  value={formData.trialPrice || ''}\n                  onChange={(e) => setFormData(prev => ({ ...prev, trialPrice: parseFloat(e.target.value) || 0 }))}\n                  step=\"0.01\"\n                  min=\"0\"\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                  placeholder=\"0.00\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">Hastanın deneme süresince ödeyeceği tutar</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Down Payment Section */}\n        {showDownPaymentSection && (\n          <div className=\"border border-gray-200 rounded-lg p-4\">\n            <div className=\"flex items-center mb-4\">\n              <CreditCard className=\"w-5 h-5 text-green-500 mr-2\" />\n              <h3 className=\"text-lg font-medium text-gray-900\">Ödeme Bilgileri</h3>\n            </div>\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Ödenecek Tutar (₺)</label>\n                <input\n                  type=\"number\"\n                  value={formData.patientPayment?.toFixed(2) || '0.00'}\n                  readOnly\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">SGK indirimi sonrası hasta ödemesi</p>\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Ön Ödeme (₺)</label>\n                <input\n                  type=\"number\"\n                  value={formData.downPayment || ''}\n                  onChange={(e) => setFormData(prev => ({ ...prev, downPayment: parseFloat(e.target.value) || 0 }))}\n                  step=\"0.01\"\n                  min=\"0\"\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                  placeholder=\"0.00\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">Peşin ödenen tutar</p>\n              </div>\n              <div>\n                <label className=\"block text-xs text-gray-600 mb-1\">Kalan Tutar (₺)</label>\n                <input\n                  type=\"number\"\n                  value={formData.remainingAmount?.toFixed(2) || '0.00'}\n                  readOnly\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">Ön ödeme sonrası kalan tutar</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Payment Method Section */}\n        {showPaymentSection && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Ödeme Yöntemi</label>\n            <select\n              value={formData.paymentMethod || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, paymentMethod: e.target.value as any }))}\n              className={`w-full border border-gray-300 rounded-md px-3 py-2 ${errors.paymentMethod ? 'border-red-300' : ''}`}\n            >\n              <option value=\"\">Ödeme yöntemini seçiniz</option>\n              <option value=\"cash\">Nakit</option>\n              <option value=\"card\">Kredi Kartı</option>\n              <option value=\"transfer\">Havale/EFT</option>\n              <option value=\"installment\">Taksit</option>\n            </select>\n            {errors.paymentMethod && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.paymentMethod}</p>\n            )}\n\n            {/* Installment Options */}\n            {formData.paymentMethod === 'installment' && (\n              <div className=\"mt-4 grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-xs text-gray-600 mb-1\">Taksit Sayısı</label>\n                  <select\n                    value={formData.installmentCount || ''}\n                    onChange={(e) => {\n                      const count = parseInt(e.target.value);\n                      const monthly = formData.remainingAmount ? formData.remainingAmount / count : 0;\n                      setFormData(prev => ({ \n                        ...prev, \n                        installmentCount: count,\n                        monthlyInstallment: monthly\n                      }));\n                    }}\n                    className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                  >\n                    <option value=\"\">Taksit seçin</option>\n                    <option value=\"3\">3 Taksit</option>\n                    <option value=\"6\">6 Taksit</option>\n                    <option value=\"9\">9 Taksit</option>\n                    <option value=\"12\">12 Taksit</option>\n                    <option value=\"18\">18 Taksit</option>\n                    <option value=\"24\">24 Taksit</option>\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-xs text-gray-600 mb-1\">Aylık Taksit</label>\n                  <input\n                    type=\"number\"\n                    value={formData.monthlyInstallment?.toFixed(2) || '0.00'}\n                    readOnly\n                    className=\"w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50\"\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Assignment Information */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Atama Tarihi *\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"date\"\n                value={formData.assignedDate || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, assignedDate: e.target.value }))}\n                className={`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.assignedDate ? 'border-red-300' : ''}`}\n              />\n              {errors.assignedDate && (\n                <p className=\"mt-1 text-sm text-red-600\">{errors.assignedDate}</p>\n              )}\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Atayan Kişi\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <User className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"text\"\n                value={formData.assignedBy || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, assignedBy: e.target.value }))}\n                placeholder=\"Atayan kişi adı\"\n                className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Status Selection */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Durum *\n          </label>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n            {[\n              { value: 'assigned', label: 'Atandı' },\n              { value: 'trial', label: 'Deneme' },\n              { value: 'returned', label: 'İade Edildi' },\n              { value: 'defective', label: 'Arızalı' }\n            ].map((status) => (\n              <label key={status.value} className=\"relative\">\n                <input\n                  type=\"radio\"\n                  name=\"status\"\n                  value={status.value}\n                  checked={formData.status === status.value}\n                  onChange={(e) => setFormData(prev => ({ ...prev, status: e.target.value as any }))}\n                  className=\"sr-only\"\n                />\n                <div className={`flex items-center justify-center p-3 border rounded-lg cursor-pointer transition-colors ${\n                  formData.status === status.value\n                    ? 'border-blue-500 bg-blue-50 text-blue-700'\n                    : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                }`}>\n                  {getStatusIcon(status.value)}\n                  <span className=\"ml-2 text-sm font-medium\">{status.label}</span>\n                </div>\n              </label>\n            ))}\n          </div>\n          {errors.status && (\n            <p className=\"mt-1 text-sm text-red-600\">{errors.status}</p>\n          )}\n        </div>\n\n        {/* Trial End Date */}\n        {formData.status === 'trial' && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Deneme Bitiş Tarihi *\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"date\"\n                value={formData.trialEndDate || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, trialEndDate: e.target.value }))}\n                className={`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.trialEndDate ? 'border-red-300' : ''}`}\n              />\n              {errors.trialEndDate && (\n                <p className=\"mt-1 text-sm text-red-600\">{errors.trialEndDate}</p>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Return Date */}\n        {formData.status === 'returned' && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              İade Tarihi\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"date\"\n                value={formData.returnDate || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, returnDate: e.target.value }))}\n                className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              />\n            </div>\n          </div>\n        )}\n\n        {/* Device Condition */}\n        {(formData.status === 'returned' || formData.status === 'defective') && (\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Cihaz Durumu\n            </label>\n            <select\n              value={formData.condition || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, condition: e.target.value }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n              <option value=\"\">Durum seçin...</option>\n              <option value=\"excellent\">Mükemmel</option>\n              <option value=\"good\">İyi</option>\n              <option value=\"fair\">Orta</option>\n              <option value=\"poor\">Kötü</option>\n              <option value=\"damaged\">Hasarlı</option>\n            </select>\n          </div>\n        )}\n\n        {/* Notes */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <div className=\"relative\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 pt-3 flex items-start pointer-events-none\">\n              <FileText className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <textarea\n              value={formData.notes || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n              placeholder=\"Cihaz ataması ile ilgili notlar...\"\n              rows={3}\n              className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end space-x-3 pt-6 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={onClose}\n            disabled={isLoading}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"min-w-[120px]\"\n          >\n            {isLoading ? 'Kaydediliyor...' : (assignment ? 'Güncelle' : 'Cihazı Ata')}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/forms/DocumentUploadForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'FileText' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientDocument' is defined but never used.","line":6,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getDocumentTypeText' is assigned a value but never used.","line":155,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":155,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":199,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":205,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":259,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":271,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":282,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":288,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":296,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":302,"endColumn":13}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef } from 'react';\nimport { Button } from '../ui/Button';\nimport { Modal } from '../ui/Modal';\nimport { FileText, Upload, X, AlertCircle, CheckCircle } from 'lucide-react';\n\ninterface PatientDocument {\n  id?: string;\n  patientId: string;\n  documentType: 'sgk_report' | 'prescription' | 'medical_report' | 'invoice' | 'receipt' | 'other';\n  fileName: string;\n  fileSize: number;\n  mimeType: string;\n  uploadedBy: string;\n  uploadedAt: string;\n  description?: string;\n  tags?: string[];\n}\n\ninterface DocumentUploadFormProps {\n  patientId: string;\n  isOpen: boolean;\n  onClose: () => void;\n  onUpload: (documentData: FormData) => Promise<void>;\n  isLoading?: boolean;\n}\n\nexport const DocumentUploadForm: React.FC<DocumentUploadFormProps> = ({\n  patientId,\n  isOpen,\n  onClose,\n  onUpload,\n  isLoading = false\n}) => {\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [documentType, setDocumentType] = useState<string>('');\n  const [description, setDescription] = useState<string>('');\n  const [tags, setTags] = useState<string>('');\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [dragActive, setDragActive] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const resetForm = () => {\n    setSelectedFile(null);\n    setDocumentType('');\n    setDescription('');\n    setTags('');\n    setErrors({});\n    setDragActive(false);\n  };\n\n  const handleClose = () => {\n    resetForm();\n    onClose();\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!selectedFile) {\n      newErrors.file = 'Dosya seçimi zorunludur';\n    }\n\n    if (!documentType) {\n      newErrors.documentType = 'Doküman türü seçimi zorunludur';\n    }\n\n    // Dosya boyutu kontrolü (10MB)\n    if (selectedFile && selectedFile.size > 10 * 1024 * 1024) {\n      newErrors.file = 'Dosya boyutu 10MB\\'dan büyük olamaz';\n    }\n\n    // Dosya türü kontrolü\n    if (selectedFile) {\n      const allowedTypes = [\n        'application/pdf',\n        'image/jpeg',\n        'image/png',\n        'image/gif',\n        'application/msword',\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n        'text/plain'\n      ];\n\n      if (!allowedTypes.includes(selectedFile.type)) {\n        newErrors.file = 'Desteklenmeyen dosya türü. PDF, resim veya doküman dosyaları kabul edilir.';\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleFileSelect = (file: File) => {\n    setSelectedFile(file);\n    setErrors(prev => ({ ...prev, file: '' }));\n  };\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === 'dragenter' || e.type === 'dragover') {\n      setDragActive(true);\n    } else if (e.type === 'dragleave') {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFileSelect(e.dataTransfer.files[0]);\n    }\n  };\n\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFileSelect(e.target.files[0]);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      return;\n    }\n\n    try {\n      const formData = new FormData();\n      formData.append('file', selectedFile!);\n      formData.append('patientId', patientId);\n      formData.append('documentType', documentType);\n      formData.append('description', description);\n      formData.append('tags', tags);\n      formData.append('uploadedBy', 'current_user'); // TODO: Get from auth context\n\n      await onUpload(formData);\n      handleClose();\n    } catch (error) {\n      console.error('Doküman yüklenirken hata:', error);\n    }\n  };\n\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  const getDocumentTypeText = (type: string): string => {\n    switch (type) {\n      case 'sgk_report':\n        return 'SGK Raporu';\n      case 'prescription':\n        return 'Reçete';\n      case 'medical_report':\n        return 'Tıbbi Rapor';\n      case 'invoice':\n        return 'Fatura';\n      case 'receipt':\n        return 'Makbuz';\n      case 'other':\n        return 'Diğer';\n      default:\n        return type;\n    }\n  };\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={handleClose}\n      title=\"Doküman Yükle\"\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Dosya Yükleme Alanı */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Dosya Seçimi *\n          </label>\n          <div\n            className={`relative border-2 border-dashed rounded-lg p-6 text-center transition-colors ${\n              dragActive\n                ? 'border-blue-400 bg-blue-50'\n                : selectedFile\n                ? 'border-green-400 bg-green-50'\n                : 'border-gray-300 hover:border-gray-400'\n            }`}\n            onDragEnter={handleDrag}\n            onDragLeave={handleDrag}\n            onDragOver={handleDrag}\n            onDrop={handleDrop}\n          >\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              onChange={handleFileInputChange}\n              accept=\".pdf,.jpg,.jpeg,.png,.gif,.doc,.docx,.txt\"\n              className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\n            />\n\n            {selectedFile ? (\n              <div className=\"flex flex-col items-center\">\n                <CheckCircle className=\"w-12 h-12 text-green-500 mb-4\" />\n                <p className=\"text-sm font-medium text-gray-900 mb-1\">\n                  {selectedFile.name}\n                </p>\n                <p className=\"text-xs text-gray-500\">\n                  {formatFileSize(selectedFile.size)}\n                </p>\n                <Button\n                  type=\"button\"\n                  variant=\"secondary\"\n                  onClick={() => setSelectedFile(null)}\n                  className=\"mt-3\"\n                >\n                  <X className=\"w-4 h-4 mr-1\" />\n                  Kaldır\n                </Button>\n              </div>\n            ) : (\n              <div className=\"flex flex-col items-center\">\n                <Upload className=\"w-12 h-12 text-gray-400 mb-4\" />\n                <p className=\"text-sm font-medium text-gray-900 mb-1\">\n                  Dosyayı sürükleyin veya tıklayın\n                </p>\n                <p className=\"text-xs text-gray-500\">\n                  PDF, resim veya doküman dosyaları (max 10MB)\n                </p>\n                <Button\n                  type=\"button\"\n                  variant=\"secondary\"\n                  onClick={() => fileInputRef.current?.click()}\n                  className=\"mt-3\"\n                >\n                  Dosya Seç\n                </Button>\n              </div>\n            )}\n          </div>\n          {errors.file && (\n            <p className=\"mt-2 text-sm text-red-600 flex items-center\">\n              <AlertCircle className=\"w-4 h-4 mr-1\" />\n              {errors.file}\n            </p>\n          )}\n        </div>\n\n        {/* Doküman Türü */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Doküman Türü *\n          </label>\n          <select\n            value={documentType}\n            onChange={(e) => setDocumentType(e.target.value)}\n            className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.documentType ? 'border-red-300' : ''}`}\n          >\n            <option value=\"\">Doküman türü seçin...</option>\n            <option value=\"sgk_report\">SGK Raporu</option>\n            <option value=\"prescription\">Reçete</option>\n            <option value=\"medical_report\">Tıbbi Rapor</option>\n            <option value=\"invoice\">Fatura</option>\n            <option value=\"receipt\">Makbuz</option>\n            <option value=\"other\">Diğer</option>\n          </select>\n          {errors.documentType && (\n            <p className=\"mt-1 text-sm text-red-600\">{errors.documentType}</p>\n          )}\n        </div>\n\n        {/* Açıklama */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Açıklama\n          </label>\n          <textarea\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n            placeholder=\"Doküman hakkında açıklama...\"\n            rows={3}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n          />\n        </div>\n\n        {/* Etiketler */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Etiketler\n          </label>\n          <input\n            type=\"text\"\n            value={tags}\n            onChange={(e) => setTags(e.target.value)}\n            placeholder=\"Virgülle ayrılmış etiketler (örn: önemli, acil, kontrol)\"\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n          />\n          <p className=\"mt-1 text-xs text-gray-500\">\n            Etiketler dokümanın aranmasını kolaylaştırır\n          </p>\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end space-x-3 pt-6 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={handleClose}\n            disabled={isLoading}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isLoading || !selectedFile}\n            className=\"min-w-[120px]\"\n          >\n            {isLoading ? 'Yükleniyor...' : 'Yükle'}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/forms/DynamicInvoiceForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'InvoiceFormSchema' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has unnecessary dependencies: 'formData.invoiceType' and 'formData.scenario'. Either exclude them or remove the dependency array.","line":105,"column":6,"nodeType":"ArrayExpression","endLine":105,"endColumn":57,"suggestions":[{"desc":"Update the dependencies array to be: [formData]","fix":{"range":[3022,3073],"text":"[formData]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":108,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3208,3211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3208,3211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3900,3903],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3900,3903],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":244,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7553,7556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7553,7556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":248,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":248,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7676,7679],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7676,7679],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8413,8416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8413,8416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'validateForm'. Either include it or remove the dependency array.","line":333,"column":6,"nodeType":"ArrayExpression","endLine":333,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [formData, items, validateForm, visibleSections]","fix":{"range":[9762,9796],"text":"[formData, items, validateForm, visibleSections]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":505,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":505,"endColumn":24}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select, Textarea } from '@x-ear/ui-web';\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { \n  InvoiceFormSchema, \n  InvoiceFormData, \n  InvoiceFieldDefinition, \n  InvoiceFieldSection,\n  InvoiceFormValidationResult,\n  InvoiceFormValidationError\n} from '../../types/invoice-schema';\nimport { InvoiceValidationUtils } from '../../utils/invoice-validation';\nimport { INVOICE_FORM_SCHEMA } from '../../data/invoice-schema';\n\ninterface DynamicInvoiceFormProps {\n  onSubmit: (data: InvoiceFormData) => void;\n  onValidationChange?: (result: InvoiceFormValidationResult) => void;\n  onFormDataChange?: (data: InvoiceFormData) => void;\n  initialData?: Partial<InvoiceFormData>;\n  disabled?: boolean;\n  className?: string;\n}\n\ninterface InvoiceItem {\n  id: string;\n  description: string;\n  quantity: number;\n  unitPrice: number;\n  taxRate: number;\n  total: number;\n}\n\nexport const DynamicInvoiceForm: React.FC<DynamicInvoiceFormProps> = ({\n  onSubmit,\n  onValidationChange,\n  onFormDataChange,\n  initialData = {},\n  disabled = false,\n  className = ''\n}) => {\n  const [formData, setFormData] = useState<InvoiceFormData>({\n    invoiceType: initialData.invoiceType || 'individual',\n    scenario: initialData.scenario || 'device_sale',\n    ...initialData\n  });\n\n  const [items, setItems] = useState<InvoiceItem[]>([\n    {\n      id: '1',\n      description: '',\n      quantity: 1,\n      unitPrice: 0,\n      taxRate: 18,\n      total: 0\n    }\n  ]);\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [touched, setTouched] = useState<Record<string, boolean>>({});\n\n  // Check if a section should be visible based on conditions\n  const shouldShowSection = (section: InvoiceFieldSection, data: InvoiceFormData): boolean => {\n    if (!section.conditional) return true;\n\n    const { dependsOn, condition, value } = section.conditional;\n    const fieldValue = data[dependsOn];\n\n    switch (condition) {\n      case 'equals':\n        return fieldValue === value;\n      case 'not_equals':\n        return fieldValue !== value;\n      case 'contains':\n        return String(fieldValue).includes(String(value));\n      default:\n        return true;\n    }\n  };\n\n  // Get visible sections based on invoice type and conditions\n  const visibleSections = useMemo(() => {\n    const schema = INVOICE_FORM_SCHEMA;\n    const invoiceTypeConfig = schema.invoiceTypes[formData.invoiceType];\n    \n    if (!invoiceTypeConfig) return [];\n\n    const sections: InvoiceFieldSection[] = [];\n    \n    // Add required sections\n    invoiceTypeConfig.requiredFields.forEach(sectionKey => {\n      const section = schema.fieldDefinitions[sectionKey];\n      if (section) {\n        sections.push(section);\n      }\n    });\n\n    // Add conditional sections\n    invoiceTypeConfig.conditionalFields.forEach(sectionKey => {\n      const section = schema.fieldDefinitions[sectionKey];\n      if (section && shouldShowSection(section, formData)) {\n        sections.push(section);\n      }\n    });\n\n    return sections;\n  }, [formData.invoiceType, formData.scenario, formData]);\n\n  // Check if a field should be visible based on conditions\n  const shouldShowField = (field: InvoiceFieldDefinition, sectionData: any): boolean => {\n    if (!field.conditional) return true;\n\n    const { dependsOn, condition, value } = field.conditional;\n    const fieldValue = sectionData[dependsOn];\n\n    switch (condition) {\n      case 'equals':\n        return fieldValue === value;\n      case 'not_equals':\n        return fieldValue !== value;\n      case 'contains':\n        return String(fieldValue).includes(String(value));\n      case 'greater_than':\n        return Number(fieldValue) > Number(value);\n      case 'less_than':\n        return Number(fieldValue) < Number(value);\n      default:\n        return true;\n    }\n  };\n\n  // Validate a single field\n  const validateField = (field: InvoiceFieldDefinition, value: any): string | null => {\n    if (field.required && (!value || value === '')) {\n      return `${field.label} alanı zorunludur`;\n    }\n\n    if (!value) return null;\n\n    const validation = field.validation;\n    if (!validation) return null;\n\n    // Pattern validation\n    if (validation.pattern && !new RegExp(validation.pattern).test(String(value))) {\n      if (field.id === 'tc_number') {\n        return InvoiceValidationUtils.validateTCKN(String(value)) \n          ? null \n          : 'Geçersiz T.C. Kimlik Numarası';\n      }\n      if (field.id === 'tax_number') {\n        return InvoiceValidationUtils.validateTurkishTaxNumber(String(value))\n          ? null\n          : 'Geçersiz Vergi Kimlik Numarası';\n      }\n      if (field.id === 'postal_code') {\n        return InvoiceValidationUtils.validateTurkishPostalCode(String(value))\n          ? null\n          : 'Geçersiz posta kodu';\n      }\n      return `${field.label} formatı geçersiz`;\n    }\n\n    // Email validation\n    if (field.type === 'email' && !InvoiceValidationUtils.validateEmail(String(value))) {\n      return 'Geçersiz e-posta adresi';\n    }\n\n    // Phone validation\n    if (field.type === 'tel' && !InvoiceValidationUtils.validateTurkishPhone(String(value))) {\n      return 'Geçersiz telefon numarası';\n    }\n\n    // Length validation\n    if (validation.minLength && String(value).length < validation.minLength) {\n      return `${field.label} en az ${validation.minLength} karakter olmalıdır`;\n    }\n    if (validation.maxLength && String(value).length > validation.maxLength) {\n      return `${field.label} en fazla ${validation.maxLength} karakter olmalıdır`;\n    }\n\n    // Number range validation\n    if (validation.min !== undefined && Number(value) < validation.min) {\n      return `${field.label} en az ${validation.min} olmalıdır`;\n    }\n    if (validation.max !== undefined && Number(value) > validation.max) {\n      return `${field.label} en fazla ${validation.max} olmalıdır`;\n    }\n\n    return null;\n  };\n\n  // Validate entire form\n  const validateForm = (): InvoiceFormValidationResult => {\n    const validationErrors: InvoiceFormValidationError[] = [];\n    const newErrors: Record<string, string> = {};\n\n    visibleSections.forEach(section => {\n      const sectionData = formData[section.name] || {};\n      \n      Object.values(section.fields).forEach(field => {\n        if (shouldShowField(field, sectionData)) {\n          const fieldValue = sectionData[field.id];\n          const error = validateField(field, fieldValue);\n          \n          if (error) {\n            const fieldKey = `${section.name}.${field.id}`;\n            newErrors[fieldKey] = error;\n            validationErrors.push({\n              field: field.id,\n              section: section.name,\n              message: error,\n              type: field.required && (!fieldValue || fieldValue === '') ? 'required' : 'pattern'\n            });\n          }\n        }\n      });\n    });\n\n    // Validate items\n    if (items.length === 0 || items.every(item => !item.description)) {\n      newErrors['items'] = 'En az bir fatura kalemi eklemelisiniz';\n      validationErrors.push({\n        field: 'items_list',\n        section: 'items',\n        message: 'En az bir fatura kalemi eklemelisiniz',\n        type: 'required'\n      });\n    }\n\n    setErrors(newErrors);\n\n    const result: InvoiceFormValidationResult = {\n      isValid: validationErrors.length === 0,\n      errors: validationErrors,\n      warnings: []\n    };\n\n    if (onValidationChange) {\n      onValidationChange(result);\n    }\n\n    return result;\n  };\n\n  // Handle field change\n  const handleFieldChange = (sectionName: string, fieldId: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [sectionName]: {\n        ...(prev[sectionName] as Record<string, any> || {}),\n        [fieldId]: value\n      }\n    }));\n\n    // Mark field as touched\n    const fieldKey = `${sectionName}.${fieldId}`;\n    setTouched(prev => ({ ...prev, [fieldKey]: true }));\n\n    // Clear error for this field\n    if (errors[fieldKey]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[fieldKey];\n        return newErrors;\n      });\n    }\n  };\n\n  // Handle invoice type change\n  const handleInvoiceTypeChange = (type: string) => {\n    setFormData(prev => ({\n      invoiceType: type,\n      scenario: prev.scenario,\n      // Clear other sections when type changes\n    }));\n  };\n\n  // Handle item changes\n  const handleItemChange = (index: number, field: keyof InvoiceItem, value: any) => {\n    setItems(prev => {\n      const newItems = [...prev];\n      newItems[index] = {\n        ...newItems[index],\n        [field]: value\n      };\n      \n      // Recalculate total\n      if (field === 'quantity' || field === 'unitPrice' || field === 'taxRate') {\n        const item = newItems[index];\n        const subtotal = item.quantity * item.unitPrice;\n        const tax = subtotal * (item.taxRate / 100);\n        newItems[index].total = subtotal + tax;\n      }\n      \n      return newItems;\n    });\n  };\n\n  // Add new item\n  const addItem = () => {\n    setItems(prev => [...prev, {\n      id: Date.now().toString(),\n      description: '',\n      quantity: 1,\n      unitPrice: 0,\n      taxRate: 18,\n      total: 0\n    }]);\n  };\n\n  // Remove item\n  const removeItem = (index: number) => {\n    if (items.length > 1) {\n      setItems(prev => prev.filter((_, i) => i !== index));\n    }\n  };\n\n  // Handle form submission\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    const validation = validateForm();\n    if (validation.isValid) {\n      const submitData: InvoiceFormData = {\n        ...formData,\n        items: items.filter(item => item.description.trim() !== '')\n      };\n      onSubmit(submitData);\n    }\n  };\n\n  // Validate on mount and when form data changes\n  useEffect(() => {\n    validateForm();\n  }, [formData, items, visibleSections]);\n\n  // Call onFormDataChange when form data changes\n  useEffect(() => {\n    if (onFormDataChange) {\n      const submitData: InvoiceFormData = {\n        ...formData,\n        items: items.filter(item => item.description.trim() !== '')\n      };\n      onFormDataChange(submitData);\n    }\n  }, [formData, items, onFormDataChange]);\n\n  // Render field based on type\n  const renderField = (section: InvoiceFieldSection, field: InvoiceFieldDefinition) => {\n    const sectionData = formData[section.name] || {};\n    const fieldValue = sectionData[field.id] || field.defaultValue || '';\n    const fieldKey = `${section.name}.${field.id}`;\n    const hasError = errors[fieldKey] && touched[fieldKey];\n\n    if (!shouldShowField(field, sectionData)) {\n      return null;\n    }\n\n    const commonInputProps = {\n      id: field.id,\n      name: field.id,\n      value: fieldValue,\n      disabled,\n      className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n        hasError ? 'border-red-500' : 'border-gray-300'\n      }`,\n      placeholder: field.placeholder,\n      onChange: (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n        const value = field.type === 'checkbox' \n          ? (e.target as HTMLInputElement).checked\n          : field.type === 'number' \n            ? parseFloat(e.target.value) || 0\n            : e.target.value;\n        handleFieldChange(section.name, field.id, value);\n      }\n    };\n\n    const selectProps = {\n      value: fieldValue,\n      disabled,\n      onChange: (e: React.ChangeEvent<HTMLSelectElement>) => {\n        handleFieldChange(section.name, field.id, e.target.value);\n      },\n      options: field.options?.map(option => ({\n        value: option.value,\n        label: option.text,\n        disabled: option.disabled\n      })) || [],\n      error: hasError ? errors[fieldKey] : undefined,\n      fullWidth: true\n    };\n\n    let fieldElement;\n\n    switch (field.type) {\n      case 'select':\n        fieldElement = (\n          <Select {...selectProps} />\n        );\n        break;\n\n      case 'textarea':\n        fieldElement = (\n          <Textarea \n            {...commonInputProps}\n            rows={3}\n          />\n        );\n        break;\n\n      case 'checkbox':\n        fieldElement = (\n          <Input\n            type=\"checkbox\"\n            id={field.id}\n            name={field.id}\n            checked={!!fieldValue}\n            disabled={disabled}\n            className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500\"\n            onChange={(e) => handleFieldChange(section.name, field.id, e.target.checked)}\n          />\n        );\n        break;\n\n      default:\n        fieldElement = (\n          <Input\n            type={field.type}\n            {...commonInputProps}\n          />\n        );\n    }\n\n    return (\n      <div key={field.id} className=\"mb-4\">\n        <label htmlFor={field.id} className=\"block text-sm font-medium text-gray-700 mb-1\">\n          {field.label}\n          {field.required && <span className=\"text-red-500 ml-1\">*</span>}\n        </label>\n        \n        {field.type === 'checkbox' ? (\n          <div className=\"flex items-center\">\n            {fieldElement}\n            <label htmlFor={field.id} className=\"ml-2 text-sm text-gray-700\">\n              {field.label}\n            </label>\n          </div>\n        ) : (\n          fieldElement\n        )}\n        \n        {field.helpText && (\n          <p className=\"mt-1 text-xs text-gray-500\">{field.helpText}</p>\n        )}\n        \n        {hasError && (\n          <p className=\"mt-1 text-xs text-red-500\">{errors[fieldKey]}</p>\n        )}\n      </div>\n    );\n  };\n\n  // Calculate totals\n  const totals = useMemo(() => {\n    const subtotal = items.reduce((sum, item) => sum + (item.quantity * item.unitPrice), 0);\n    const totalTax = items.reduce((sum, item) => {\n      const itemSubtotal = item.quantity * item.unitPrice;\n      return sum + (itemSubtotal * (item.taxRate / 100));\n    }, 0);\n    const total = subtotal + totalTax;\n\n    return { subtotal, totalTax, total };\n  }, [items]);\n\n  return (\n    <form onSubmit={handleSubmit} className={`space-y-6 ${className}`}>\n      {/* Invoice Type Selection */}\n      <div className=\"bg-white p-6 rounded-lg shadow-sm border\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Fatura Tipi</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          {Object.entries(INVOICE_FORM_SCHEMA.invoiceTypes).map(([key, config]) => (\n            <label key={key} className=\"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50\">\n              <Input\n                type=\"radio\"\n                name=\"invoiceType\"\n                value={key}\n                checked={formData.invoiceType === key}\n                onChange={(e) => handleInvoiceTypeChange(e.target.value)}\n                disabled={disabled}\n                className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500\"\n              />\n              <div className=\"ml-3\">\n                <div className=\"text-sm font-medium text-gray-900\">{config.name}</div>\n                {config.description && (\n                  <div className=\"text-xs text-gray-500\">{config.description}</div>\n                )}\n              </div>\n            </label>\n          ))}\n        </div>\n      </div>\n      {/* Scenario Selection */}\n      <div className=\"bg-white p-6 rounded-lg shadow-sm border\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Senaryo</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {Object.entries(INVOICE_FORM_SCHEMA.scenarios)\n            .filter(([_, scenario]) => scenario.applicableTypes.includes(formData.invoiceType))\n            .map(([key, scenario]) => (\n              <label key={key} className=\"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50\">\n                <Input\n                  type=\"radio\"\n                  name=\"scenario\"\n                  value={key}\n                  checked={formData.scenario === key}\n                  onChange={(e) => handleFieldChange('', 'scenario', e.target.value)}\n                  disabled={disabled}\n                  className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500\"\n                />\n                <div className=\"ml-3\">\n                  <div className=\"text-sm font-medium text-gray-900\">{scenario.name}</div>\n                  {scenario.description && (\n                    <div className=\"text-xs text-gray-500\">{scenario.description}</div>\n                  )}\n                </div>\n              </label>\n            ))}\n        </div>\n      </div>\n      {/* Dynamic Sections */}\n      {visibleSections.map(section => (\n        <div key={section.name} className=\"bg-white p-6 rounded-lg shadow-sm border\">\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">{section.title}</h3>\n          {section.description && (\n            <p className=\"text-sm text-gray-600 mb-4\">{section.description}</p>\n          )}\n          \n          {section.name === 'items' ? (\n            // Special handling for items section\n            (<div className=\"space-y-4\">\n              {items.map((item, index) => (\n                <div key={item.id} className=\"p-4 border rounded-lg bg-gray-50\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-6 gap-4\">\n                    <div className=\"md:col-span-2\">\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Açıklama <span className=\"text-red-500\">*</span>\n                      </label>\n                      <Input\n                        type=\"text\"\n                        value={item.description}\n                        onChange={(e) => handleItemChange(index, 'description', e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        placeholder=\"Ürün/hizmet açıklaması\"\n                        disabled={disabled}\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Miktar <span className=\"text-red-500\">*</span>\n                      </label>\n                      <Input\n                        type=\"number\"\n                        min=\"1\"\n                        value={item.quantity}\n                        onChange={(e) => handleItemChange(index, 'quantity', parseFloat(e.target.value) || 1)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        disabled={disabled}\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Birim Fiyat <span className=\"text-red-500\">*</span>\n                      </label>\n                      <Input\n                        type=\"number\"\n                        min=\"0\"\n                        step=\"0.01\"\n                        value={item.unitPrice}\n                        onChange={(e) => handleItemChange(index, 'unitPrice', parseFloat(e.target.value) || 0)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        disabled={disabled}\n                      />\n                    </div>\n                    <div>\n                      <Select\n                        label=\"KDV (%)\"\n                        value={item.taxRate.toString()}\n                        onChange={(e) => handleItemChange(index, 'taxRate', parseFloat(e.target.value))}\n                        options={[\n                          { value: \"0\", label: \"0%\" },\n                          { value: \"1\", label: \"1%\" },\n                          { value: \"8\", label: \"8%\" },\n                          { value: \"18\", label: \"18%\" }\n                        ]}\n                        disabled={disabled}\n                        fullWidth\n                      />\n                    </div>\n                    <div className=\"flex items-end\">\n                      <div className=\"flex-1\">\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Toplam\n                        </label>\n                        <div className=\"px-3 py-2 bg-gray-100 border border-gray-300 rounded-md text-right\">\n                          {InvoiceValidationUtils.formatTurkishCurrency(item.total)}\n                        </div>\n                      </div>\n                      {items.length > 1 && (\n                        <Button\n                          type=\"button\"\n                          onClick={() => removeItem(index)}\n                          className=\"ml-2 p-2 text-red-600 hover:text-red-800 focus:outline-none\"\n                          disabled={disabled}\n                          variant='default'>\n                          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                          </svg>\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ))}\n              <Button\n                type=\"button\"\n                onClick={addItem}\n                className=\"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-gray-400 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                disabled={disabled}\n                variant='default'>\n                + Yeni Kalem Ekle\n              </Button>\n              {errors.items && (\n                <p className=\"text-sm text-red-500\">{errors.items}</p>\n              )}\n              {/* Totals */}\n              <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span>Ara Toplam:</span>\n                    <span>{InvoiceValidationUtils.formatTurkishCurrency(totals.subtotal)}</span>\n                  </div>\n                  <div className=\"flex justify-between text-sm\">\n                    <span>KDV:</span>\n                    <span>{InvoiceValidationUtils.formatTurkishCurrency(totals.totalTax)}</span>\n                  </div>\n                  <div className=\"flex justify-between text-lg font-semibold border-t pt-2\">\n                    <span>Genel Toplam:</span>\n                    <span>{InvoiceValidationUtils.formatTurkishCurrency(totals.total)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>)\n          ) : (\n            // Regular section fields\n            (<div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {Object.values(section.fields).map(field => renderField(section, field))}\n            </div>)\n          )}\n        </div>\n      ))}\n      {/* Submit Button */}\n      <div className=\"flex justify-end space-x-4\">\n        <Button\n          type=\"submit\"\n          disabled={disabled || Object.keys(errors).length > 0}\n          className=\"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          variant='default'>\n          Fatura Oluştur\n        </Button>\n      </div>\n    </form>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/forms/PatientNoteForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckCircle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":52},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getPriorityText' is assigned a value but never used.","line":163,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":163,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getCategoryText' is assigned a value but never used.","line":178,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":178,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":209,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":216,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":233,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":240,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":265,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":272,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":270,"column":98,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":270,"endColumn":101,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8000,8003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8000,8003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":290,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":299,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8960,8963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8960,8963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":306,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":311,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":331,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":337,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":342,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":349,"endColumn":15}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button } from '../ui/Button';\nimport { Modal } from '../ui/Modal';\nimport { FileText, AlertTriangle, Info, CheckCircle, User } from 'lucide-react';\n\ninterface PatientNote {\n  id?: string;\n  patientId: string;\n  title: string;\n  content: string;\n  priority: 'low' | 'medium' | 'high' | 'critical';\n  category: 'medical' | 'administrative' | 'technical' | 'general';\n  isPrivate: boolean;\n  createdBy: string;\n  createdAt: string;\n  updatedAt?: string;\n  tags?: string[];\n}\n\ninterface PatientNoteFormProps {\n  patientId: string;\n  note?: PatientNote | null;\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (noteData: Partial<PatientNote>) => Promise<void>;\n  isLoading?: boolean;\n}\n\nexport const PatientNoteForm: React.FC<PatientNoteFormProps> = ({\n  patientId,\n  note,\n  isOpen,\n  onClose,\n  onSave,\n  isLoading = false\n}) => {\n  const [formData, setFormData] = useState<Partial<PatientNote>>({\n    patientId,\n    title: '',\n    content: '',\n    priority: 'medium',\n    category: 'general',\n    isPrivate: false,\n    createdBy: 'current_user', // TODO: Get from auth context\n    tags: []\n  });\n\n  const [tagInput, setTagInput] = useState<string>('');\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Reset form when modal opens/closes or note changes\n  useEffect(() => {\n    if (isOpen) {\n      if (note) {\n        // Edit mode\n        setFormData({\n          ...note,\n          tags: note.tags || []\n        });\n        setTagInput('');\n      } else {\n        // Create mode\n        setFormData({\n          patientId,\n          title: '',\n          content: '',\n          priority: 'medium',\n          category: 'general',\n          isPrivate: false,\n          createdBy: 'current_user', // TODO: Get from auth context\n          tags: []\n        });\n        setTagInput('');\n      }\n      setErrors({});\n    }\n  }, [isOpen, note, patientId]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.title?.trim()) {\n      newErrors.title = 'Not başlığı zorunludur';\n    }\n\n    if (!formData.content?.trim()) {\n      newErrors.content = 'Not içeriği zorunludur';\n    }\n\n    if (formData.title && formData.title.length > 100) {\n      newErrors.title = 'Başlık 100 karakterden uzun olamaz';\n    }\n\n    if (formData.content && formData.content.length > 2000) {\n      newErrors.content = 'İçerik 2000 karakterden uzun olamaz';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      return;\n    }\n\n    try {\n      const noteData = {\n        ...formData,\n        title: formData.title?.trim(),\n        content: formData.content?.trim(),\n        tags: formData.tags || []\n      };\n\n      await onSave(noteData);\n      onClose();\n    } catch (error) {\n      console.error('Not kaydedilirken hata:', error);\n    }\n  };\n\n  const addTag = () => {\n    if (tagInput.trim() && !formData.tags?.includes(tagInput.trim())) {\n      setFormData(prev => ({\n        ...prev,\n        tags: [...(prev.tags || []), tagInput.trim()]\n      }));\n      setTagInput('');\n    }\n  };\n\n  const removeTag = (tagToRemove: string) => {\n    setFormData(prev => ({\n      ...prev,\n      tags: prev.tags?.filter(tag => tag !== tagToRemove) || []\n    }));\n  };\n\n  const handleTagInputKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      addTag();\n    }\n  };\n\n  const getPriorityIcon = (priority: string) => {\n    switch (priority) {\n      case 'low':\n        return <Info className=\"w-4 h-4 text-blue-500\" />;\n      case 'medium':\n        return <Info className=\"w-4 h-4 text-yellow-500\" />;\n      case 'high':\n        return <AlertTriangle className=\"w-4 h-4 text-orange-500\" />;\n      case 'critical':\n        return <AlertTriangle className=\"w-4 h-4 text-red-500\" />;\n      default:\n        return <Info className=\"w-4 h-4 text-gray-400\" />;\n    }\n  };\n\n  const getPriorityText = (priority: string): string => {\n    switch (priority) {\n      case 'low':\n        return 'Düşük';\n      case 'medium':\n        return 'Orta';\n      case 'high':\n        return 'Yüksek';\n      case 'critical':\n        return 'Kritik';\n      default:\n        return priority;\n    }\n  };\n\n  const getCategoryText = (category: string): string => {\n    switch (category) {\n      case 'medical':\n        return 'Tıbbi';\n      case 'administrative':\n        return 'İdari';\n      case 'technical':\n        return 'Teknik';\n      case 'general':\n        return 'Genel';\n      default:\n        return category;\n    }\n  };\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      title={note ? 'Notu Düzenle' : 'Yeni Not Ekle'}\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Başlık */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Başlık *\n          </label>\n          <div className=\"relative\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n              <FileText className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <input\n              type=\"text\"\n              value={formData.title || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, title: e.target.value }))}\n              placeholder=\"Not başlığı...\"\n              maxLength={100}\n              className={`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.title ? 'border-red-300' : ''}`}\n            />\n            <div className=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\n              <span className=\"text-xs text-gray-400\">\n                {(formData.title?.length || 0)}/100\n              </span>\n            </div>\n          </div>\n          {errors.title && (\n            <p className=\"mt-1 text-sm text-red-600\">{errors.title}</p>\n          )}\n        </div>\n\n        {/* İçerik */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            İçerik *\n          </label>\n          <textarea\n            value={formData.content || ''}\n            onChange={(e) => setFormData(prev => ({ ...prev, content: e.target.value }))}\n            placeholder=\"Not içeriği...\"\n            rows={6}\n            maxLength={2000}\n            className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.content ? 'border-red-300' : ''}`}\n          />\n          <div className=\"flex justify-between items-center mt-1\">\n            {errors.content && (\n              <p className=\"text-sm text-red-600\">{errors.content}</p>\n            )}\n            <span className=\"text-xs text-gray-400 ml-auto\">\n              {(formData.content?.length || 0)}/2000\n            </span>\n          </div>\n        </div>\n\n        {/* Öncelik ve Kategori */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Öncelik\n            </label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              {[\n                { value: 'low', label: 'Düşük' },\n                { value: 'medium', label: 'Orta' },\n                { value: 'high', label: 'Yüksek' },\n                { value: 'critical', label: 'Kritik' }\n              ].map((priority) => (\n                <label key={priority.value} className=\"relative\">\n                  <input\n                    type=\"radio\"\n                    name=\"priority\"\n                    value={priority.value}\n                    checked={formData.priority === priority.value}\n                    onChange={(e) => setFormData(prev => ({ ...prev, priority: e.target.value as any }))}\n                    className=\"sr-only\"\n                  />\n                  <div className={`flex items-center justify-center p-2 border rounded-lg cursor-pointer transition-colors text-sm ${\n                    formData.priority === priority.value\n                      ? 'border-blue-500 bg-blue-50 text-blue-700'\n                      : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                  }`}>\n                    {getPriorityIcon(priority.value)}\n                    <span className=\"ml-1\">{priority.label}</span>\n                  </div>\n                </label>\n              ))}\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Kategori\n            </label>\n            <select\n              value={formData.category || 'general'}\n              onChange={(e) => setFormData(prev => ({ ...prev, category: e.target.value as any }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n              <option value=\"medical\">Tıbbi</option>\n              <option value=\"administrative\">İdari</option>\n              <option value=\"technical\">Teknik</option>\n              <option value=\"general\">Genel</option>\n            </select>\n          </div>\n        </div>\n\n        {/* Gizlilik */}\n        <div>\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={formData.isPrivate || false}\n              onChange={(e) => setFormData(prev => ({ ...prev, isPrivate: e.target.checked }))}\n              className=\"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              <User className=\"w-4 h-4 inline mr-1\" />\n              Özel not (sadece yetkili kişiler görebilir)\n            </span>\n          </label>\n        </div>\n\n        {/* Etiketler */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Etiketler\n          </label>\n          <div className=\"flex flex-wrap gap-2 mb-2\">\n            {formData.tags?.map((tag, index) => (\n              <span\n                key={index}\n                className=\"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800\"\n              >\n                {tag}\n                <button\n                  type=\"button\"\n                  onClick={() => removeTag(tag)}\n                  className=\"ml-1 text-blue-600 hover:text-blue-800\"\n                >\n                  ×\n                </button>\n              </span>\n            ))}\n          </div>\n          <div className=\"flex gap-2\">\n            <input\n              type=\"text\"\n              value={tagInput}\n              onChange={(e) => setTagInput(e.target.value)}\n              onKeyPress={handleTagInputKeyPress}\n              placeholder=\"Etiket ekleyin...\"\n              className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n            <Button\n              type=\"button\"\n              onClick={addTag}\n              disabled={!tagInput.trim()}\n              variant=\"secondary\"\n            >\n              Ekle\n            </Button>\n          </div>\n          <p className=\"mt-1 text-xs text-gray-500\">\n            Enter tuşuna basarak veya \"Ekle\" butonuna tıklayarak etiket ekleyin\n          </p>\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end space-x-3 pt-6 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={onClose}\n            disabled={isLoading}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"min-w-[120px]\"\n          >\n            {isLoading ? 'Kaydediliyor...' : (note ? 'Güncelle' : 'Not Ekle')}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/forms/PatientSaleForm.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":214,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":223,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":235,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":242,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":248,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":254,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":262,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":268,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":276,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":282,"endColumn":25},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":289,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":296,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":303,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":309,"endColumn":25},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":316,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":322,"endColumn":25},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":333,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":338,"endColumn":27},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":350,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":355,"endColumn":27},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":367,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":372,"endColumn":27},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":384,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":389,"endColumn":27},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":426,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":432,"endColumn":21},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":460,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":466,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":473,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":479,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":489,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":499,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":513,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":518,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":535,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":540,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":553,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":559,"endColumn":15}],"suppressedMessages":[],"errorCount":19,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { PatientSale } from '../../hooks/patient/usePatientSales';\nimport { Button } from '../ui/Button';\nimport { Modal } from '../ui/Modal';\nimport { DollarSign, Calculator, Percent, CreditCard, Calendar, FileText, Plus, X } from 'lucide-react';\n\ninterface PatientSaleFormProps {\n  patientId: string;\n  sale?: PatientSale | null;\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (saleData: Partial<PatientSale>) => Promise<void>;\n  isLoading?: boolean;\n}\n\ninterface DeviceSelection {\n  id: string;\n  name: string;\n  brand: string;\n  model: string;\n  ear: 'left' | 'right';\n  listPrice: number;\n  salePrice: number;\n  sgkCoverageAmount: number;\n  patientResponsibleAmount: number;\n}\n\nexport const PatientSaleForm: React.FC<PatientSaleFormProps> = ({\n  patientId,\n  sale,\n  isOpen,\n  onClose,\n  onSave,\n  isLoading = false\n}) => {\n  const [formData, setFormData] = useState<Partial<PatientSale>>({\n    patientId,\n    saleDate: new Date().toISOString().split('T')[0],\n    paymentStatus: 'pending',\n    status: 'pending',\n    discountAmount: 0,\n    paidAmount: 0,\n    sgkCoverage: 0,\n    totalAmount: 0,\n    finalAmount: 0\n  });\n\n  const [devices, setDevices] = useState<DeviceSelection[]>([]);\n  const [selectedProduct, setSelectedProduct] = useState<string>('');\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Reset form when modal opens/closes or sale changes\n  useEffect(() => {\n    if (isOpen) {\n      if (sale) {\n        // Edit mode\n        setFormData({\n          ...sale,\n          saleDate: sale.saleDate.split('T')[0] // Convert to date input format\n        });\n        // TODO: Load devices from sale data\n        setDevices(sale.devices?.map(d => ({\n          id: d.id,\n          name: d.name,\n          brand: d.brand,\n          model: d.model,\n          ear: (d.ear as 'left' | 'right') || 'right',\n          listPrice: d.listPrice || 0,\n          salePrice: d.salePrice || 0,\n          sgkCoverageAmount: d.sgkCoverageAmount || 0,\n          patientResponsibleAmount: d.patientResponsibleAmount || 0\n        })) || []);\n      } else {\n        // Create mode\n        setFormData({\n          patientId,\n          saleDate: new Date().toISOString().split('T')[0],\n          paymentStatus: 'pending',\n          status: 'pending',\n          discountAmount: 0,\n          paidAmount: 0,\n          sgkCoverage: 0,\n          totalAmount: 0,\n          finalAmount: 0\n        });\n        setDevices([]);\n      }\n      setSelectedProduct('');\n      setErrors({});\n    }\n  }, [isOpen, sale, patientId]);\n\n  // Calculate totals when devices or discount changes\n  useEffect(() => {\n    const totalListPrice = devices.reduce((sum, device) => sum + device.listPrice, 0);\n    const totalSalePrice = devices.reduce((sum, device) => sum + device.salePrice, 0);\n    const totalSgkCoverage = devices.reduce((sum, device) => sum + device.sgkCoverageAmount, 0);\n\n    const discountAmount = formData.discountAmount || 0;\n    const finalAmount = Math.max(0, totalSalePrice - discountAmount);\n\n    setFormData(prev => ({\n      ...prev,\n      listPriceTotal: totalListPrice,\n      totalAmount: totalSalePrice,\n      finalAmount,\n      sgkCoverage: totalSgkCoverage,\n      patientPayment: finalAmount - totalSgkCoverage\n    }));\n  }, [devices, formData.discountAmount]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!selectedProduct.trim()) {\n      newErrors.productId = 'Ürün seçimi zorunludur';\n    }\n\n    if (devices.length === 0) {\n      newErrors.devices = 'En az bir cihaz seçilmelidir';\n    }\n\n    if (!formData.saleDate) {\n      newErrors.saleDate = 'Satış tarihi zorunludur';\n    }\n\n    if (!formData.paymentMethod) {\n      newErrors.paymentMethod = 'Ödeme yöntemi zorunludur';\n    }\n\n    if ((formData.discountAmount || 0) > (formData.totalAmount || 0)) {\n      newErrors.discountAmount = 'İndirim tutarı toplam tutardan fazla olamaz';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      return;\n    }\n\n    try {\n      const saleData: Partial<PatientSale> = {\n        ...formData,\n        productId: selectedProduct,\n        devices: devices.map(d => ({\n          id: d.id,\n          name: d.name,\n          brand: d.brand,\n          model: d.model,\n          ear: d.ear,\n          listPrice: d.listPrice,\n          salePrice: d.salePrice,\n          sgkCoverageAmount: d.sgkCoverageAmount,\n          patientResponsibleAmount: d.patientResponsibleAmount\n        }))\n      };\n\n      await onSave(saleData);\n      onClose();\n    } catch (error) {\n      console.error('Satış kaydedilirken hata:', error);\n    }\n  };\n\n  const addDevice = () => {\n    const newDevice: DeviceSelection = {\n      id: `device_${Date.now()}`,\n      name: '',\n      brand: '',\n      model: '',\n      ear: 'right',\n      listPrice: 0,\n      salePrice: 0,\n      sgkCoverageAmount: 0,\n      patientResponsibleAmount: 0\n    };\n    setDevices([...devices, newDevice]);\n  };\n\n  const removeDevice = (index: number) => {\n    setDevices(devices.filter((_, i) => i !== index));\n  };\n\n  const updateDevice = (index: number, updates: Partial<DeviceSelection>) => {\n    setDevices(devices.map((device, i) =>\n      i === index ? { ...device, ...updates } : device\n    ));\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      title={sale ? 'Satış Düzenle' : 'Yeni Satış'}\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Ürün Seçimi */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Ürün *\n          </label>\n          <select\n            value={selectedProduct}\n            onChange={(e) => setSelectedProduct(e.target.value)}\n            className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.productId ? 'border-red-300' : ''}`}\n          >\n            <option value=\"\">Ürün seçin...</option>\n            <option value=\"hearing_aid_basic\">Temel İşitme Cihazı</option>\n            <option value=\"hearing_aid_advanced\">Gelişmiş İşitme Cihazı</option>\n            <option value=\"hearing_aid_premium\">Premium İşitme Cihazı</option>\n          </select>\n          {errors.productId && (\n            <p className=\"mt-1 text-sm text-red-600\">{errors.productId}</p>\n          )}\n        </div>\n\n        {/* Cihaz Seçimi */}\n        <div>\n          <div className=\"flex items-center justify-between mb-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n              Cihazlar *\n            </label>\n            <button\n              type=\"button\"\n              onClick={addDevice}\n              className=\"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              <Plus className=\"w-4 h-4 mr-1\" />\n              Cihaz Ekle\n            </button>\n          </div>\n\n          {devices.length === 0 ? (\n            <div className=\"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg\">\n              <p className=\"text-gray-500\">Henüz cihaz eklenmemiş</p>\n              <button\n                type=\"button\"\n                onClick={addDevice}\n                className=\"mt-2 inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\"\n              >\n                İlk Cihazı Ekle\n              </button>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {devices.map((device, index) => (\n                <div key={device.id} className=\"border border-gray-200 rounded-lg p-4\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <h4 className=\"text-sm font-medium\">Cihaz {index + 1}</h4>\n                    <button\n                      type=\"button\"\n                      onClick={() => removeDevice(index)}\n                      className=\"text-red-600 hover:text-red-700 p-1\"\n                    >\n                      <X className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Cihaz Adı\n                      </label>\n                      <input\n                        type=\"text\"\n                        value={device.name}\n                        onChange={(e) => updateDevice(index, { name: e.target.value })}\n                        placeholder=\"Örn: İşitme Cihazı\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                      />\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Kulak\n                      </label>\n                      <select\n                        value={device.ear}\n                        onChange={(e) => updateDevice(index, { ear: e.target.value as 'left' | 'right' })}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                      >\n                        <option value=\"right\">Sağ Kulak</option>\n                        <option value=\"left\">Sol Kulak</option>\n                      </select>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Marka\n                      </label>\n                      <input\n                        type=\"text\"\n                        value={device.brand}\n                        onChange={(e) => updateDevice(index, { brand: e.target.value })}\n                        placeholder=\"Örn: Phonak\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                      />\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Model\n                      </label>\n                      <input\n                        type=\"text\"\n                        value={device.model}\n                        onChange={(e) => updateDevice(index, { model: e.target.value })}\n                        placeholder=\"Örn: Audeo B90\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                      />\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Liste Fiyatı\n                      </label>\n                      <div className=\"relative\">\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                          <DollarSign className=\"w-4 h-4 text-gray-400\" />\n                        </div>\n                        <input\n                          type=\"number\"\n                          value={device.listPrice}\n                          onChange={(e) => updateDevice(index, { listPrice: Number(e.target.value) })}\n                          className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Satış Fiyatı\n                      </label>\n                      <div className=\"relative\">\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                          <DollarSign className=\"w-4 h-4 text-gray-400\" />\n                        </div>\n                        <input\n                          type=\"number\"\n                          value={device.salePrice}\n                          onChange={(e) => updateDevice(index, { salePrice: Number(e.target.value) })}\n                          className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        SGK Desteği\n                      </label>\n                      <div className=\"relative\">\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                          <DollarSign className=\"w-4 h-4 text-gray-400\" />\n                        </div>\n                        <input\n                          type=\"number\"\n                          value={device.sgkCoverageAmount}\n                          onChange={(e) => updateDevice(index, { sgkCoverageAmount: Number(e.target.value) })}\n                          className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Hasta Payı\n                      </label>\n                      <div className=\"relative\">\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                          <DollarSign className=\"w-4 h-4 text-gray-400\" />\n                        </div>\n                        <input\n                          type=\"number\"\n                          value={device.patientResponsibleAmount}\n                          onChange={(e) => updateDevice(index, { patientResponsibleAmount: Number(e.target.value) })}\n                          className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {errors.devices && (\n            <p className=\"mt-1 text-sm text-red-600\">{errors.devices}</p>\n          )}\n        </div>\n\n        {/* Fiyat Özeti */}\n        {devices.length > 0 && (\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\n            <h4 className=\"text-sm font-medium text-gray-900 mb-3 flex items-center\">\n              <Calculator className=\"w-4 h-4 mr-2\" />\n              Fiyat Özeti\n            </h4>\n\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span>Liste Fiyatı Toplamı:</span>\n                <span>{formatCurrency(formData.listPriceTotal || 0)}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Satış Fiyatı Toplamı:</span>\n                <span>{formatCurrency(formData.totalAmount || 0)}</span>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"relative flex-1\">\n                  <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                    <Percent className=\"w-4 h-4 text-gray-400\" />\n                  </div>\n                  <input\n                    type=\"number\"\n                    value={formData.discountAmount || 0}\n                    onChange={(e) => setFormData(prev => ({ ...prev, discountAmount: Number(e.target.value) }))}\n                    placeholder=\"İndirim tutarı\"\n                    className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-between font-medium text-lg border-t pt-2\">\n                <span>Net Tutar:</span>\n                <span>{formatCurrency(formData.finalAmount || 0)}</span>\n              </div>\n\n              <div className=\"flex justify-between text-green-600\">\n                <span>SGK Desteği:</span>\n                <span>-{formatCurrency(formData.sgkCoverage || 0)}</span>\n              </div>\n\n              <div className=\"flex justify-between font-medium text-blue-600 border-t pt-2\">\n                <span>Hasta Ödeme Tutarı:</span>\n                <span>{formatCurrency((formData.patientPayment || 0))}</span>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* SGK Bilgileri */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              SGK Şeması\n            </label>\n            <input\n              type=\"text\"\n              value={formData.sgkScheme || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, sgkScheme: e.target.value }))}\n              placeholder=\"Örn: SGK-1\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              SGK Grubu\n            </label>\n            <input\n              type=\"text\"\n              value={formData.sgkGroup || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, sgkGroup: e.target.value }))}\n              placeholder=\"Örn: Grup A\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Ödeme Bilgileri */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Ödeme Yöntemi *\n            </label>\n            <select\n              value={formData.paymentMethod || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, paymentMethod: e.target.value }))}\n              className={`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.paymentMethod ? 'border-red-300' : ''}`}\n            >\n              <option value=\"\">Seçin...</option>\n              <option value=\"cash\">Nakit</option>\n              <option value=\"card\">Kredi Kartı</option>\n              <option value=\"installment\">Taksit</option>\n              <option value=\"insurance\">Sigorta</option>\n            </select>\n            {errors.paymentMethod && (\n              <p className=\"mt-1 text-sm text-red-600\">{errors.paymentMethod}</p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Satış Tarihi *\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"date\"\n                value={formData.saleDate || ''}\n                onChange={(e) => setFormData(prev => ({ ...prev, saleDate: e.target.value }))}\n                className={`w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${errors.saleDate ? 'border-red-300' : ''}`}\n              />\n              {errors.saleDate && (\n                <p className=\"mt-1 text-sm text-red-600\">{errors.saleDate}</p>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Ödenen Tutar */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Ödenen Tutar\n          </label>\n          <div className=\"relative\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n              <CreditCard className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <input\n              type=\"number\"\n              value={formData.paidAmount || 0}\n              onChange={(e) => setFormData(prev => ({ ...prev, paidAmount: Number(e.target.value) }))}\n              className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Notlar */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <div className=\"relative\">\n            <div className=\"absolute inset-y-0 left-0 pl-3 pt-3 flex items-start pointer-events-none\">\n              <FileText className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <textarea\n              value={formData.notes || ''}\n              onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n              placeholder=\"Satış ile ilgili notlar...\"\n              rows={3}\n              className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end space-x-3 pt-6 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={onClose}\n            disabled={isLoading}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isLoading}\n            className=\"min-w-[120px]\"\n          >\n            {isLoading ? 'Kaydediliyor...' : (sale ? 'Güncelle' : 'Satış Oluştur')}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/inventory/AdvancedFilters.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Package' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AlertTriangle' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2850,2853],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2850,2853],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":146,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":146,"endColumn":58},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":392,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":405,"endColumn":26}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Card, Input, Select, Button, Checkbox, Badge } from '@x-ear/ui-web';\nimport { \n  Search, \n  Filter, \n  X, \n  ChevronDown, \n  ChevronUp,\n  Calendar,\n  DollarSign,\n  Package,\n  AlertTriangle\n} from 'lucide-react';\nimport { InventoryCategory, InventoryStatus } from '@/types/inventory';\n\nexport interface AdvancedFiltersProps {\n  filters: InventoryFilters;\n  onFiltersChange: (filters: InventoryFilters) => void;\n  onClearFilters: () => void;\n  categories: string[];\n  brands: string[];\n  suppliers: string[];\n  isExpanded?: boolean;\n  onToggleExpanded?: () => void;\n}\n\nexport interface InventoryFilters {\n  search?: string;\n  category?: InventoryCategory;\n  brand?: string;\n  status?: InventoryStatus;\n  supplier?: string;\n  priceRange?: {\n    min?: number;\n    max?: number;\n  };\n  dateRange?: {\n    start?: string;\n    end?: string;\n  };\n  stockStatus?: 'all' | 'in_stock' | 'low_stock' | 'out_of_stock' | 'on_trial';\n  features?: string[];\n  warrantyPeriod?: string;\n  lowStock?: boolean;\n  outOfStock?: boolean;\n  hasTrials?: boolean;\n}\n\nconst stockStatusOptions = [\n  { value: 'all', label: 'Tüm Durumlar' },\n  { value: 'in_stock', label: 'Stokta Var' },\n  { value: 'low_stock', label: 'Düşük Stok' },\n  { value: 'out_of_stock', label: 'Stok Yok' },\n  { value: 'on_trial', label: 'Deneme Aşamasında' }\n];\n\nconst warrantyOptions = [\n  { value: '', label: 'Tüm Garanti Süreleri' },\n  { value: '6 months', label: '6 Ay' },\n  { value: '1 year', label: '1 Yıl' },\n  { value: '2 years', label: '2 Yıl' },\n  { value: '3 years', label: '3 Yıl' },\n  { value: '5 years', label: '5 Yıl' }\n];\n\nconst dateRangePresets = [\n  { value: 'today', label: 'Bugün' },\n  { value: 'week', label: 'Bu Hafta' },\n  { value: 'month', label: 'Bu Ay' },\n  { value: 'quarter', label: 'Bu Çeyrek' },\n  { value: 'year', label: 'Bu Yıl' },\n  { value: 'custom', label: 'Özel Tarih' }\n];\n\nexport const AdvancedFilters: React.FC<AdvancedFiltersProps> = ({\n  filters,\n  onFiltersChange,\n  onClearFilters,\n  categories,\n  brands,\n  suppliers,\n  isExpanded = false,\n  onToggleExpanded\n}) => {\n  const [localFilters, setLocalFilters] = useState<InventoryFilters>(filters);\n  const [selectedFeatures, setSelectedFeatures] = useState<string[]>(filters.features || []);\n  const [showCustomDateRange, setShowCustomDateRange] = useState(false);\n\n  // Available features - in a real app, this would come from API\n  const availableFeatures = [\n    'Bluetooth', 'Şarj Edilebilir', 'Su Geçirmez', 'Gürültü Önleme',\n    'Telecoil', 'Directional Microphone', 'Feedback Cancellation',\n    'Wind Noise Reduction', 'Tinnitus Masker', 'Remote Control'\n  ];\n\n  useEffect(() => {\n    setLocalFilters(filters);\n    setSelectedFeatures(filters.features || []);\n  }, [filters]);\n\n  const handleFilterChange = (key: keyof InventoryFilters, value: any) => {\n    const newFilters = { ...localFilters, [key]: value };\n    setLocalFilters(newFilters);\n    onFiltersChange(newFilters);\n  };\n\n  const handlePriceRangeChange = (type: 'min' | 'max', value: string) => {\n    const numValue = value === '' ? undefined : parseFloat(value);\n    const newPriceRange = {\n      ...localFilters.priceRange,\n      [type]: numValue\n    };\n    handleFilterChange('priceRange', newPriceRange);\n  };\n\n  const handleDateRangeChange = (type: 'start' | 'end', value: string) => {\n    const newDateRange = {\n      ...localFilters.dateRange,\n      [type]: value || undefined\n    };\n    handleFilterChange('dateRange', newDateRange);\n  };\n\n  const handleDatePresetChange = (preset: string) => {\n    if (preset === 'custom') {\n      setShowCustomDateRange(true);\n      return;\n    }\n\n    setShowCustomDateRange(false);\n    const today = new Date();\n    let startDate: Date;\n    const endDate = today;\n\n    switch (preset) {\n      case 'today':\n        startDate = today;\n        break;\n      case 'week':\n        startDate = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);\n        break;\n      case 'month':\n        startDate = new Date(today.getFullYear(), today.getMonth(), 1);\n        break;\n      case 'quarter':\n        const quarter = Math.floor(today.getMonth() / 3);\n        startDate = new Date(today.getFullYear(), quarter * 3, 1);\n        break;\n      case 'year':\n        startDate = new Date(today.getFullYear(), 0, 1);\n        break;\n      default:\n        return;\n    }\n\n    handleFilterChange('dateRange', {\n      start: startDate.toISOString().split('T')[0],\n      end: endDate.toISOString().split('T')[0]\n    });\n  };\n\n  const handleFeatureToggle = (feature: string) => {\n    const newFeatures = selectedFeatures.includes(feature)\n      ? selectedFeatures.filter(f => f !== feature)\n      : [...selectedFeatures, feature];\n    \n    setSelectedFeatures(newFeatures);\n    handleFilterChange('features', newFeatures);\n  };\n\n  const clearAllFilters = () => {\n    setLocalFilters({});\n    setSelectedFeatures([]);\n    setShowCustomDateRange(false);\n    onClearFilters();\n  };\n\n  const getActiveFilterCount = () => {\n    let count = 0;\n    if (localFilters.search) count++;\n    if (localFilters.category) count++;\n    if (localFilters.brand) count++;\n    if (localFilters.status) count++;\n    if (localFilters.supplier) count++;\n    if (localFilters.priceRange?.min || localFilters.priceRange?.max) count++;\n    if (localFilters.dateRange?.start || localFilters.dateRange?.end) count++;\n    if (localFilters.stockStatus && localFilters.stockStatus !== 'all') count++;\n    if (localFilters.features && localFilters.features.length > 0) count++;\n    if (localFilters.warrantyPeriod) count++;\n    if (localFilters.lowStock || localFilters.outOfStock || localFilters.hasTrials) count++;\n    return count;\n  };\n\n  const categoryOptions = categories.map(cat => ({ value: cat, label: cat }));\n  const brandOptions = brands.map(brand => ({ value: brand, label: brand }));\n  const supplierOptions = suppliers.map(supplier => ({ value: supplier, label: supplier }));\n\n  return (\n    <Card className=\"p-4\">\n      {/* Filter Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <div className=\"flex items-center space-x-2\">\n          <Filter className=\"w-5 h-5 text-gray-500\" />\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n            Gelişmiş Filtreler\n          </h3>\n          {getActiveFilterCount() > 0 && (\n            <Badge variant=\"secondary\" className=\"ml-2\">\n              {getActiveFilterCount()} aktif filtre\n            </Badge>\n          )}\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          {getActiveFilterCount() > 0 && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={clearAllFilters}\n              className=\"text-red-600 hover:text-red-700\"\n            >\n              <X className=\"w-4 h-4 mr-1\" />\n              Temizle\n            </Button>\n          )}\n          {onToggleExpanded && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onToggleExpanded}\n            >\n              {isExpanded ? (\n                <ChevronUp className=\"w-4 h-4\" />\n              ) : (\n                <ChevronDown className=\"w-4 h-4\" />\n              )}\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Basic Filters - Always Visible */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            Arama\n          </label>\n          <Input\n            placeholder=\"Ürün adı, marka, model, barkod...\"\n            value={localFilters.search || ''}\n            onChange={(e) => handleFilterChange('search', e.target.value)}\n            leftIcon={<Search className=\"w-4 h-4\" />}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            Kategori\n          </label>\n          <Select\n            value={localFilters.category || ''}\n            onChange={(value) => handleFilterChange('category', value || undefined)}\n            options={[{ value: '', label: 'Tüm Kategoriler' }, ...categoryOptions]}\n            placeholder=\"Kategori seçin\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            Marka\n          </label>\n          <Select\n            value={localFilters.brand || ''}\n            onChange={(value) => handleFilterChange('brand', value || undefined)}\n            options={[{ value: '', label: 'Tüm Markalar' }, ...brandOptions]}\n            placeholder=\"Marka seçin\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            Stok Durumu\n          </label>\n          <Select\n            value={localFilters.stockStatus || 'all'}\n            onChange={(e) => handleFilterChange('stockStatus', e.target.value)}\n            options={stockStatusOptions}\n          />\n        </div>\n      </div>\n\n      {/* Advanced Filters - Collapsible */}\n      {isExpanded && (\n        <div className=\"space-y-6 border-t pt-4\">\n          {/* Price Range */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              <DollarSign className=\"w-4 h-4 inline mr-1\" />\n              Fiyat Aralığı\n            </label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <Input\n                type=\"number\"\n                placeholder=\"Min fiyat\"\n                value={localFilters.priceRange?.min || ''}\n                onChange={(e) => handlePriceRangeChange('min', e.target.value)}\n                min=\"0\"\n                step=\"0.01\"\n              />\n              <Input\n                type=\"number\"\n                placeholder=\"Max fiyat\"\n                value={localFilters.priceRange?.max || ''}\n                onChange={(e) => handlePriceRangeChange('max', e.target.value)}\n                min=\"0\"\n                step=\"0.01\"\n              />\n            </div>\n          </div>\n\n          {/* Date Range */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              <Calendar className=\"w-4 h-4 inline mr-1\" />\n              Tarih Aralığı\n            </label>\n            <div className=\"space-y-2\">\n              <Select\n                value={showCustomDateRange ? 'custom' : ''}\n                onChange={(e) => {\n                  const preset = e.target.value;\n                  if (preset === 'custom') {\n                    setShowCustomDateRange(true);\n                  } else {\n                    setShowCustomDateRange(false);\n                    handleDatePresetChange(preset);\n                  }\n                }}\n                options={dateRangePresets}\n                placeholder=\"Tarih aralığı seçin\"\n              />\n              {showCustomDateRange && (\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <Input\n                    type=\"date\"\n                    value={localFilters.dateRange?.start || ''}\n                    onChange={(e) => handleDateRangeChange('start', e.target.value)}\n                  />\n                  <Input\n                    type=\"date\"\n                    value={localFilters.dateRange?.end || ''}\n                    onChange={(e) => handleDateRangeChange('end', e.target.value)}\n                  />\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Additional Filters */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                Tedarikçi\n              </label>\n              <Select\n                value={localFilters.supplier || ''}\n                onChange={(value) => handleFilterChange('supplier', value || undefined)}\n                options={[{ value: '', label: 'Tüm Tedarikçiler' }, ...supplierOptions]}\n                placeholder=\"Tedarikçi seçin\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                Garanti Süresi\n              </label>\n              <Select\n                value={localFilters.warrantyPeriod || ''}\n                onChange={(value) => handleFilterChange('warrantyPeriod', value || undefined)}\n                options={warrantyOptions}\n                placeholder=\"Garanti süresi seçin\"\n              />\n            </div>\n          </div>\n\n          {/* Features */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Özellikler\n            </label>\n            <div className=\"flex flex-wrap gap-2\">\n              {availableFeatures.map((feature) => (\n                <button\n                  key={feature}\n                  onClick={() => handleFeatureToggle(feature)}\n                  className=\"cursor-pointer hover:bg-opacity-80\"\n                >\n                  <Badge\n                    variant={selectedFeatures.includes(feature) ? \"default\" : \"secondary\"}\n                  >\n                    {feature}\n                    {selectedFeatures.includes(feature) && (\n                      <X className=\"w-3 h-3 ml-1\" />\n                    )}\n                  </Badge>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Quick Filters */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Hızlı Filtreler\n            </label>\n            <div className=\"flex flex-wrap gap-4\">\n              <Checkbox\n                checked={localFilters.lowStock || false}\n                onChange={(e) => handleFilterChange('lowStock', e.target.checked)}\n                label=\"Düşük Stok\"\n              />\n              <Checkbox\n                checked={localFilters.outOfStock || false}\n                onChange={(e) => handleFilterChange('outOfStock', e.target.checked)}\n                label=\"Stok Yok\"\n              />\n              <Checkbox\n                checked={localFilters.hasTrials || false}\n                onChange={(e) => handleFilterChange('hasTrials', e.target.checked)}\n                label=\"Deneme Aşamasında\"\n              />\n            </div>\n          </div>\n        </div>\n      )}\n    </Card>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/inventory/InventoryForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3910,3913],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3910,3913],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select, Textarea } from '@x-ear/ui-web';\nimport React, { useState, useEffect } from 'react';\nimport { Save, X, AlertCircle } from 'lucide-react';\nimport { \n  InventoryFormData, \n  InventoryCategory, \n  InventoryType, \n  EarDirection,\n  InventoryItem,\n  CreateInventoryData,\n  UpdateInventoryData\n} from '../../types/inventory';\nimport { inventoryService } from '../../services/inventory.service';\n\ninterface InventoryFormProps {\n  item?: InventoryItem;\n  onSave: (item: InventoryItem) => void;\n  onCancel: () => void;\n  className?: string;\n}\n\nexport const InventoryForm: React.FC<InventoryFormProps> = ({\n  item,\n  onSave,\n  onCancel,\n  className = ''\n}) => {\n  const [formData, setFormData] = useState<InventoryFormData>({\n    name: '',\n    brand: '',\n    model: '',\n    category: 'hearing_aid',\n    type: undefined,\n    barcode: '',\n    supplier: '',\n    description: '',\n    availableInventory: 0,\n    reorderLevel: 5,\n    price: 0,\n    cost: 0,\n    features: [],\n    ear: undefined,\n    sgkCode: '',\n    isMinistryTracked: false,\n    warranty: 12,\n    location: '',\n    notes: ''\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [featureInput, setFeatureInput] = useState('');\n\n  useEffect(() => {\n    if (item) {\n      setFormData({\n        name: item.name,\n        brand: item.brand,\n        model: item.model || '',\n        category: item.category,\n        type: item.type,\n        barcode: item.barcode || '',\n        supplier: item.supplier || '',\n        description: item.description || '',\n        availableInventory: item.availableInventory,\n        reorderLevel: item.reorderLevel,\n        price: item.price,\n        cost: item.cost || 0,\n        features: item.features || [],\n        ear: item.ear,\n        sgkCode: item.sgkCode || '',\n        isMinistryTracked: item.isMinistryTracked || false,\n        warranty: item.warranty || 12,\n        location: item.location || '',\n        notes: item.notes || ''\n      });\n    }\n  }, [item]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.name.trim()) {\n      newErrors.name = 'Ürün adı gereklidir';\n    }\n\n    if (!formData.brand.trim()) {\n      newErrors.brand = 'Marka gereklidir';\n    }\n\n    if (formData.availableInventory < 0) {\n      newErrors.availableInventory = 'Stok miktarı negatif olamaz';\n    }\n\n    if (formData.reorderLevel < 0) {\n      newErrors.reorderLevel = 'Yeniden sipariş seviyesi negatif olamaz';\n    }\n\n    if (formData.price <= 0) {\n      newErrors.price = 'Fiyat sıfırdan büyük olmalıdır';\n    }\n\n    if (formData.cost && formData.cost < 0) {\n      newErrors.cost = 'Maliyet negatif olamaz';\n    }\n\n    if (formData.warranty && formData.warranty < 0) {\n      newErrors.warranty = 'Garanti süresi negatif olamaz';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n    try {\n      let savedItem: InventoryItem;\n      \n      if (item) {\n        // Update existing item\n        const updateData: UpdateInventoryData = {\n          id: item.id,\n          ...formData\n        };\n        savedItem = await inventoryService.updateItem(item.id, updateData);\n      } else {\n        // Create new item\n        const createData: CreateInventoryData = formData;\n        savedItem = await inventoryService.createItem(createData);\n      }\n      \n      onSave(savedItem);\n    } catch (error) {\n      console.error('Save failed:', error);\n      setErrors({ \n        submit: error instanceof Error ? error.message : 'Kaydetme işlemi başarısız oldu' \n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleInputChange = (field: keyof InventoryFormData, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  const addFeature = () => {\n    if (featureInput.trim() && !formData.features?.includes(featureInput.trim())) {\n      setFormData(prev => ({\n        ...prev,\n        features: [...(prev.features || []), featureInput.trim()]\n      }));\n      setFeatureInput('');\n    }\n  };\n\n  const removeFeature = (feature: string) => {\n    setFormData(prev => ({\n      ...prev,\n      features: prev.features?.filter(f => f !== feature) || []\n    }));\n  };\n\n  const categoryTypes: Record<InventoryCategory, InventoryType[]> = {\n    hearing_aid: ['digital_programmable', 'rechargeable_digital'],\n    battery: ['zinc_air'],\n    accessory: ['maintenance_kit'],\n    ear_mold: ['custom_silicone'],\n    cleaning_supplies: ['maintenance_kit'],\n    amplifiers: ['wireless_amplifier']\n  };\n\n  return (\n    <div className={`bg-white rounded-lg shadow-lg ${className}`}>\n      <div className=\"px-6 py-4 border-b border-gray-200\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">\n          {item ? 'Ürün Düzenle' : 'Yeni Ürün Ekle'}\n        </h2>\n      </div>\n      <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n        {errors.submit && (\n          <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n            <div className=\"flex\">\n              <AlertCircle className=\"h-5 w-5 text-red-400\" />\n              <div className=\"ml-3\">\n                <p className=\"text-sm text-red-800\">{errors.submit}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Basic Information */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Ürün Adı *\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.name}\n              onChange={(e) => handleInputChange('name', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.name ? 'border-red-300' : 'border-gray-300'\n              }`}\n              placeholder=\"Ürün adını girin\"\n            />\n            {errors.name && <p className=\"mt-1 text-sm text-red-600\">{errors.name}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Marka *\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.brand}\n              onChange={(e) => handleInputChange('brand', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.brand ? 'border-red-300' : 'border-gray-300'\n              }`}\n              placeholder=\"Marka adını girin\"\n            />\n            {errors.brand && <p className=\"mt-1 text-sm text-red-600\">{errors.brand}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Model\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.model}\n              onChange={(e) => handleInputChange('model', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Model adını girin\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Barkod\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.barcode}\n              onChange={(e) => handleInputChange('barcode', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Barkod numarasını girin\"\n            />\n          </div>\n        </div>\n\n        {/* Category and Type */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <Select\n              label=\"Kategori *\"\n              value={formData.category}\n              onChange={(e) => {\n                const category = e.target.value as InventoryCategory;\n                handleInputChange('category', category);\n                // Reset type when category changes\n                handleInputChange('type', undefined);\n              }}\n              options={[\n                { value: \"hearing_aid\", label: \"İşitme Cihazı\" },\n                { value: \"battery\", label: \"Pil\" },\n                { value: \"accessory\", label: \"Aksesuar\" },\n                { value: \"ear_mold\", label: \"Kulak Kalıbı\" },\n                { value: \"cleaning_supplies\", label: \"Temizlik Malzemeleri\" },\n                { value: \"amplifiers\", label: \"Amplifikatör\" }\n              ]}\n              fullWidth\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Tip\n            </label>\n            <Select\n              value={formData.type || ''}\n              onChange={(e) => handleInputChange('type', e.target.value as InventoryType || undefined)}\n              options={[\n                { value: '', label: 'Tip seçin' },\n                ...(categoryTypes[formData.category]?.map(type => ({\n                  value: type,\n                  label: type === 'digital_programmable' ? 'Dijital Programlanabilir' :\n                         type === 'rechargeable_digital' ? 'Şarj Edilebilir Dijital' :\n                         type === 'zinc_air' ? 'Çinko Hava' :\n                         type === 'custom_silicone' ? 'Özel Silikon' :\n                         type === 'maintenance_kit' ? 'Bakım Kiti' :\n                         type === 'wireless_amplifier' ? 'Kablosuz Amplifikatör' : type\n                })) || [])\n              ]}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Stock and Pricing */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Mevcut Stok *\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              value={formData.availableInventory}\n              onChange={(e) => handleInputChange('availableInventory', parseInt(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.availableInventory ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.availableInventory && <p className=\"mt-1 text-sm text-red-600\">{errors.availableInventory}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Yeniden Sipariş Seviyesi *\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              value={formData.reorderLevel}\n              onChange={(e) => handleInputChange('reorderLevel', parseInt(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.reorderLevel ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.reorderLevel && <p className=\"mt-1 text-sm text-red-600\">{errors.reorderLevel}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Satış Fiyatı (₺) *\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.price}\n              onChange={(e) => handleInputChange('price', parseFloat(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.price ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.price && <p className=\"mt-1 text-sm text-red-600\">{errors.price}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Maliyet (₺)\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.cost}\n              onChange={(e) => handleInputChange('cost', parseFloat(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                errors.cost ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {errors.cost && <p className=\"mt-1 text-sm text-red-600\">{errors.cost}</p>}\n          </div>\n        </div>\n\n        {/* Additional Information */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Tedarikçi\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.supplier}\n              onChange={(e) => handleInputChange('supplier', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Tedarikçi adını girin\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Konum\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.location}\n              onChange={(e) => handleInputChange('location', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Depo konumunu girin\"\n            />\n          </div>\n        </div>\n\n        {/* Hearing Aid Specific */}\n        {formData.category === 'hearing_aid' && (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Kulak Yönü\n              </label>\n              <Select\n                value={formData.ear || ''}\n                onChange={(e) => handleInputChange('ear', e.target.value as EarDirection || undefined)}\n                options={[\n                  { value: '', label: 'Seçin' },\n                  { value: 'left', label: 'Sol' },\n                  { value: 'right', label: 'Sağ' },\n                  { value: 'both', label: 'Her İkisi' }\n                ]}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Garanti (Ay)\n              </label>\n              <Input\n                type=\"number\"\n                min=\"0\"\n                value={formData.warranty}\n                onChange={(e) => handleInputChange('warranty', parseInt(e.target.value) || 0)}\n                className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                  errors.warranty ? 'border-red-300' : 'border-gray-300'\n                }`}\n              />\n              {errors.warranty && <p className=\"mt-1 text-sm text-red-600\">{errors.warranty}</p>}\n            </div>\n          </div>\n        )}\n\n        {/* SGK Information */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              SGK Kodu\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.sgkCode}\n              onChange={(e) => handleInputChange('sgkCode', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"SGK kodunu girin\"\n            />\n          </div>\n\n          <div className=\"flex items-center\">\n            <label className=\"flex items-center\">\n              <Input\n                type=\"checkbox\"\n                checked={formData.isMinistryTracked}\n                onChange={(e) => handleInputChange('isMinistryTracked', e.target.checked)}\n                className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n              />\n              <span className=\"ml-2 text-sm text-gray-700\">Bakanlık takipli</span>\n            </label>\n          </div>\n        </div>\n\n        {/* Features */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Özellikler\n          </label>\n          <div className=\"flex space-x-2 mb-2\">\n            <Input\n              type=\"text\"\n              value={featureInput}\n              onChange={(e) => setFeatureInput(e.target.value)}\n              onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addFeature())}\n              className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Özellik ekleyin ve Enter'a basın\"\n            />\n            <Button\n              type=\"button\"\n              onClick={addFeature}\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\n              variant='default'>\n              Ekle\n            </Button>\n          </div>\n          <div className=\"flex flex-wrap gap-2\">\n            {formData.features?.map((feature, index) => (\n              <span\n                key={index}\n                className=\"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800\"\n              >\n                {feature}\n                <Button\n                  type=\"button\"\n                  onClick={() => removeFeature(feature)}\n                  className=\"ml-2 text-blue-600 hover:text-blue-800\"\n                  variant='default'>\n                  <X className=\"h-3 w-3\" />\n                </Button>\n              </span>\n            ))}\n          </div>\n        </div>\n\n        {/* Description and Notes */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Açıklama\n            </label>\n            <Textarea\n              value={formData.description}\n              onChange={(e) => handleInputChange('description', e.target.value)}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Ürün açıklamasını girin\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Notlar\n            </label>\n            <Textarea\n              value={formData.notes}\n              onChange={(e) => handleInputChange('notes', e.target.value)}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Ek notlar girin\"\n            />\n          </div>\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end space-x-3 pt-6 border-t border-gray-200\">\n          <Button\n            type=\"button\"\n            onClick={onCancel}\n            className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors\"\n            variant='default'>\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={loading}\n            className=\"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            variant='default'>\n            <Save className=\"h-4 w-4 mr-2\" />\n            {loading ? 'Kaydediliyor...' : 'Kaydet'}\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default InventoryForm;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/inventory/InventoryList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_updatedItems' is defined but never used.","line":45,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":66}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from '@x-ear/ui-web';\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { InventoryItem, InventoryFilters, InventoryStatus } from '../../types/inventory';\nimport { inventoryService } from '../../services/inventory.service';\nimport { SearchHighlight } from '../common/SearchHighlight';\n\ninterface InventoryListProps {\n  filters?: InventoryFilters & { enableFuzzySearch?: boolean; maxResults?: number };\n  onItemSelect?: (item: InventoryItem) => void;\n  onItemEdit?: (item: InventoryItem) => void;\n  onItemDelete?: (item: InventoryItem) => void;\n  className?: string;\n}\n\nexport const InventoryList: React.FC<InventoryListProps> = ({\n  filters = {},\n  onItemSelect,\n  onItemEdit,\n  onItemDelete,\n  className = ''\n}) => {\n  const [items, setItems] = useState<InventoryItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [sortField, setSortField] = useState<keyof InventoryItem>('name');\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('asc');\n\n  useEffect(() => {\n    const loadItems = async () => {\n      try {\n        setLoading(true);\n        const result = await inventoryService.searchItems(filters);\n        setItems(result.items);\n        setError(null);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load inventory');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadItems();\n\n    // Subscribe to inventory changes\n    const unsubscribe = inventoryService.subscribe((_updatedItems) => {\n      // Re-apply filters when items change\n      loadItems();\n    });\n\n    return unsubscribe;\n  }, [filters]);\n\n  const sortedItems = useMemo(() => {\n    return [...items].sort((a, b) => {\n      const aValue = a[sortField];\n      const bValue = b[sortField];\n      \n      // Handle undefined values\n      if (aValue === undefined && bValue === undefined) return 0;\n      if (aValue === undefined) return 1;\n      if (bValue === undefined) return -1;\n      \n      if (aValue === bValue) return 0;\n      \n      const comparison = aValue < bValue ? -1 : 1;\n      return sortDirection === 'asc' ? comparison : -comparison;\n    });\n  }, [items, sortField, sortDirection]);\n\n  const handleSort = (field: keyof InventoryItem) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const getStatusColor = (status: InventoryStatus) => {\n    switch (status) {\n      case 'available':\n        return 'text-green-600 bg-green-100';\n      case 'low_stock':\n        return 'text-yellow-600 bg-yellow-100';\n      case 'out_of_stock':\n        return 'text-red-600 bg-red-100';\n      default:\n        return 'text-gray-600 bg-gray-100';\n    }\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  if (loading) {\n    return (\n      <div className={`flex items-center justify-center p-8 ${className}`}>\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-2 text-gray-600\">Loading inventory...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={`bg-red-50 border border-red-200 rounded-md p-4 ${className}`}>\n        <div className=\"flex\">\n          <div className=\"flex-shrink-0\">\n            <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n          <div className=\"ml-3\">\n            <h3 className=\"text-sm font-medium text-red-800\">Error loading inventory</h3>\n            <div className=\"mt-2 text-sm text-red-700\">{error}</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (items.length === 0) {\n    return (\n      <div className={`text-center py-12 ${className}`}>\n        <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\" />\n        </svg>\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No inventory items</h3>\n        <p className=\"mt-1 text-sm text-gray-500\">Get started by adding your first inventory item.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`bg-white shadow overflow-hidden sm:rounded-md ${className}`}>\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('name')}\n              >\n                <div className=\"flex items-center\">\n                  Name\n                  {sortField === 'name' && (\n                    <svg className={`ml-1 h-4 w-4 ${sortDirection === 'asc' ? 'transform rotate-180' : ''}`} fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                    </svg>\n                  )}\n                </div>\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Category\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Brand\n              </th>\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('availableInventory')}\n              >\n                <div className=\"flex items-center\">\n                  Stock\n                  {sortField === 'availableInventory' && (\n                    <svg className={`ml-1 h-4 w-4 ${sortDirection === 'asc' ? 'transform rotate-180' : ''}`} fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                    </svg>\n                  )}\n                </div>\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Status\n              </th>\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('price')}\n              >\n                <div className=\"flex items-center\">\n                  Price\n                  {sortField === 'price' && (\n                    <svg className={`ml-1 h-4 w-4 ${sortDirection === 'asc' ? 'transform rotate-180' : ''}`} fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                    </svg>\n                  )}\n                </div>\n              </th>\n              <th className=\"relative px-6 py-3\">\n                <span className=\"sr-only\">Actions</span>\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {sortedItems.map((item) => (\n              <tr \n                key={item.id} \n                className=\"hover:bg-gray-50 cursor-pointer\"\n                onClick={() => onItemSelect?.(item)}\n              >\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <div className=\"flex items-center\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        <SearchHighlight \n                          text={item.name} \n                          searchTerm={filters.search || ''} \n                        />\n                      </div>\n                      {item.model && (\n                        <div className=\"text-sm text-gray-500\">\n                          <SearchHighlight \n                            text={item.model} \n                            searchTerm={filters.search || ''} \n                          />\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {item.category}\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  <SearchHighlight \n                    text={item.brand} \n                    searchTerm={filters.search || ''} \n                  />\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  <div className=\"flex items-center\">\n                    <span className={`font-medium ${\n                      item.availableInventory <= item.reorderLevel \n                        ? 'text-red-600' \n                        : 'text-gray-900'\n                    }`}>\n                      {item.availableInventory}\n                    </span>\n                    <span className=\"text-gray-500 ml-1\">/ {item.totalInventory}</span>\n                  </div>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(item.status || 'available')}`}>\n                    {(item.status || 'available').replace('_', ' ')}\n                  </span>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {formatCurrency(item.price)}\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                  <div className=\"flex items-center space-x-2\">\n                    {onItemEdit && (\n                      <Button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          onItemEdit(item);\n                        }}\n                        className=\"text-indigo-600 hover:text-indigo-900\"\n                        variant='default'>\n                        Edit\n                      </Button>\n                    )}\n                    {onItemDelete && (\n                      <Button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          onItemDelete(item);\n                        }}\n                        className=\"text-red-600 hover:text-red-900\"\n                        variant='default'>\n                        Delete\n                      </Button>\n                    )}\n                  </div>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/inventory/InventoryStats.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/invoice/EFaturaXMLGenerator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/invoice/InvoiceBulkOperations.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EFaturaSubmissionData' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EFaturaIntegratorResponse' is defined but never used.","line":4,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":58},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[416,419],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[416,419],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'executeBulkAction'. Either include it or remove the dependency array.","line":124,"column":6,"nodeType":"ArrayExpression","endLine":124,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [executeBulkAction]","fix":{"range":[3385,3387],"text":"[executeBulkAction]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'processCancelInvoices', 'processDeleteInvoices', 'processExportInvoices', 'processSendInvoices', and 'processSendToGIB'. Either include them or remove the dependency array.","line":179,"column":6,"nodeType":"ArrayExpression","endLine":179,"endColumn":61,"suggestions":[{"desc":"Update the dependencies array to be: [onBulkActionComplete, processSendInvoices, processSendToGIB, processCancelInvoices, processExportInvoices, processDeleteInvoices]","fix":{"range":[4721,4776],"text":"[onBulkActionComplete, processSendInvoices, processSendToGIB, processCancelInvoices, processExportInvoices, processDeleteInvoices]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":409,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":409,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11844,11847],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11844,11847],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":488,"column":95,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":488,"endColumn":98,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14705,14708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14705,14708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select } from '@x-ear/ui-web';\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Invoice, InvoiceBulkAction, InvoiceExportOptions } from '../../types/invoice';\nimport { EFaturaSubmissionData, EFaturaIntegratorResponse } from '../../types/efatura';\n\ninterface InvoiceBulkOperationsProps {\n  selectedInvoices: Invoice[];\n  onBulkActionComplete?: (action: string, results: any) => void;\n  onSelectionClear?: () => void;\n  className?: string;\n}\n\ninterface BulkOperationState {\n  isProcessing: boolean;\n  currentAction: string | null;\n  progress: number;\n  results: BulkOperationResult[];\n  error: string | null;\n}\n\ninterface BulkOperationResult {\n  invoiceId: string;\n  invoiceNumber: string;\n  success: boolean;\n  message?: string;\n  error?: string;\n}\n\nexport const InvoiceBulkOperations: React.FC<InvoiceBulkOperationsProps> = ({\n  selectedInvoices,\n  onBulkActionComplete,\n  onSelectionClear,\n  className = ''\n}) => {\n  const [state, setState] = useState<BulkOperationState>({\n    isProcessing: false,\n    currentAction: null,\n    progress: 0,\n    results: [],\n    error: null\n  });\n\n  const [exportOptions, setExportOptions] = useState<InvoiceExportOptions>({\n    format: 'excel',\n    includeItems: true,\n    includePayments: false\n  });\n\n  const [confirmationDialog, setConfirmationDialog] = useState<{\n    isOpen: boolean;\n    action: InvoiceBulkAction | null;\n    message: string;\n  }>({\n    isOpen: false,\n    action: null,\n    message: ''\n  });\n\n  // Available bulk actions\n  const bulkActions: InvoiceBulkAction[] = [\n    {\n      type: 'send',\n      label: 'Faturaları Gönder',\n      icon: '📤',\n      requiresConfirmation: true,\n      confirmationMessage: 'Seçili faturaları göndermek istediğinizden emin misiniz?'\n    },\n    {\n      type: 'send_to_gib',\n      label: 'GİB\\'e Toplu Gönder',\n      icon: '🏛️',\n      requiresConfirmation: true,\n      confirmationMessage: 'Seçili faturaları GİB\\'e göndermek istediğinizden emin misiniz?'\n    },\n    {\n      type: 'cancel',\n      label: 'Faturaları İptal Et',\n      icon: '❌',\n      requiresConfirmation: true,\n      confirmationMessage: 'Seçili faturaları iptal etmek istediğinizden emin misiniz? Bu işlem geri alınamaz.'\n    },\n    {\n      type: 'export',\n      label: 'Dışa Aktar',\n      icon: '📊',\n      requiresConfirmation: false,\n      confirmationMessage: ''\n    },\n    {\n      type: 'delete',\n      label: 'Sil',\n      icon: '🗑️',\n      requiresConfirmation: true,\n      confirmationMessage: 'Seçili faturaları silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.'\n    }\n  ];\n\n  // Calculate statistics\n  const statistics = useMemo(() => {\n    const totalAmount = selectedInvoices.reduce((sum, invoice) => sum + (invoice.grandTotal || 0), 0);\n    const statusCounts = selectedInvoices.reduce((counts, invoice) => {\n      counts[invoice.status] = (counts[invoice.status] || 0) + 1;\n      return counts;\n    }, {} as Record<string, number>);\n\n    return {\n      count: selectedInvoices.length,\n      totalAmount,\n      statusCounts\n    };\n  }, [selectedInvoices]);\n\n  const handleBulkAction = useCallback(async (action: InvoiceBulkAction) => {\n    if (action.requiresConfirmation) {\n      setConfirmationDialog({\n        isOpen: true,\n        action,\n        message: action.confirmationMessage\n      });\n      return;\n    }\n\n    await executeBulkAction(action);\n  }, []);\n\n  const executeBulkAction = useCallback(async (action: InvoiceBulkAction) => {\n    setState(prev => ({\n      ...prev,\n      isProcessing: true,\n      currentAction: action.label,\n      progress: 0,\n      results: [],\n      error: null\n    }));\n\n    try {\n      let results: BulkOperationResult[] = [];\n\n      switch (action.type) {\n        case 'send':\n          results = await processSendInvoices();\n          break;\n        case 'send_to_gib':\n          results = await processSendToGIB();\n          break;\n        case 'cancel':\n          results = await processCancelInvoices();\n          break;\n        case 'export':\n          await processExportInvoices();\n          break;\n        case 'delete':\n          results = await processDeleteInvoices();\n          break;\n        default:\n          throw new Error(`Unsupported action: ${action.type}`);\n      }\n\n      setState(prev => ({\n        ...prev,\n        isProcessing: false,\n        currentAction: null,\n        progress: 100,\n        results\n      }));\n\n      if (onBulkActionComplete) {\n        onBulkActionComplete(action.type, results);\n      }\n\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        isProcessing: false,\n        currentAction: null,\n        error: error instanceof Error ? error.message : 'Bilinmeyen hata'\n      }));\n    }\n  }, [selectedInvoices, exportOptions, onBulkActionComplete]);\n\n  const processSendInvoices = async (): Promise<BulkOperationResult[]> => {\n    const results: BulkOperationResult[] = [];\n    \n    for (let i = 0; i < selectedInvoices.length; i++) {\n      const invoice = selectedInvoices[i];\n      \n      try {\n        // Simulate API call to send invoice\n        await new Promise(resolve => setTimeout(resolve, 500));\n        \n        // Mock success/failure\n        const success = Math.random() > 0.1; // 90% success rate\n        \n        results.push({\n          invoiceId: invoice.id,\n          invoiceNumber: invoice.invoiceNumber,\n          success,\n          message: success ? 'Fatura başarıyla gönderildi' : undefined,\n          error: success ? undefined : 'Gönderim hatası'\n        });\n\n        setState(prev => ({\n          ...prev,\n          progress: ((i + 1) / selectedInvoices.length) * 100\n        }));\n      } catch (error) {\n        results.push({\n          invoiceId: invoice.id,\n          invoiceNumber: invoice.invoiceNumber,\n          success: false,\n          error: error instanceof Error ? error.message : 'Bilinmeyen hata'\n        });\n      }\n    }\n\n    return results;\n  };\n\n  const processSendToGIB = async (): Promise<BulkOperationResult[]> => {\n    const results: BulkOperationResult[] = [];\n    \n    // Group invoices into batches of 10 for GIB submission\n    const batchSize = 10;\n    const batches: Invoice[][] = [];\n    \n    for (let i = 0; i < selectedInvoices.length; i += batchSize) {\n      batches.push(selectedInvoices.slice(i, i + batchSize));\n    }\n\n    for (let batchIndex = 0; batchIndex < batches.length; batchIndex++) {\n      const batch = batches[batchIndex];\n      \n      try {\n        // Simulate batch submission to GIB via integrator\n        await new Promise(resolve => setTimeout(resolve, 2000));\n        \n        // Mock batch results\n        batch.forEach(invoice => {\n          const success = Math.random() > 0.05; // 95% success rate for GIB\n          results.push({\n            invoiceId: invoice.id,\n            invoiceNumber: invoice.invoiceNumber,\n            success,\n            message: success ? 'GİB\\'e başarıyla gönderildi' : undefined,\n            error: success ? undefined : 'GİB gönderim hatası'\n          });\n        });\n\n        setState(prev => ({\n          ...prev,\n          progress: ((batchIndex + 1) / batches.length) * 100\n        }));\n      } catch (error) {\n        batch.forEach(invoice => {\n          results.push({\n            invoiceId: invoice.id,\n            invoiceNumber: invoice.invoiceNumber,\n            success: false,\n            error: error instanceof Error ? error.message : 'Batch gönderim hatası'\n          });\n        });\n      }\n    }\n\n    return results;\n  };\n\n  const processCancelInvoices = async (): Promise<BulkOperationResult[]> => {\n    const results: BulkOperationResult[] = [];\n    \n    for (let i = 0; i < selectedInvoices.length; i++) {\n      const invoice = selectedInvoices[i];\n      \n      try {\n        // Check if invoice can be cancelled\n        if (invoice.status === 'paid' || invoice.status === 'cancelled') {\n          results.push({\n            invoiceId: invoice.id,\n            invoiceNumber: invoice.invoiceNumber,\n            success: false,\n            error: 'Ödenen veya iptal edilmiş fatura iptal edilemez'\n          });\n          continue;\n        }\n\n        // Simulate API call to cancel invoice\n        await new Promise(resolve => setTimeout(resolve, 300));\n        \n        results.push({\n          invoiceId: invoice.id,\n          invoiceNumber: invoice.invoiceNumber,\n          success: true,\n          message: 'Fatura başarıyla iptal edildi'\n        });\n\n        setState(prev => ({\n          ...prev,\n          progress: ((i + 1) / selectedInvoices.length) * 100\n        }));\n      } catch (error) {\n        results.push({\n          invoiceId: invoice.id,\n          invoiceNumber: invoice.invoiceNumber,\n          success: false,\n          error: error instanceof Error ? error.message : 'İptal hatası'\n        });\n      }\n    }\n\n    return results;\n  };\n\n  const processExportInvoices = async (): Promise<void> => {\n    // Simulate export processing\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    const exportData = selectedInvoices.map(invoice => ({\n      'Fatura No': invoice.invoiceNumber,\n      'Hasta': invoice.patientName,\n      'Tarih': invoice.issueDate,\n      'Tutar': invoice.grandTotal,\n      'Durum': invoice.status,\n      'Ödeme Yöntemi': invoice.paymentMethod || 'Belirtilmemiş'\n    }));\n\n    // Create and download file based on format\n    let content: string;\n    let fileName: string;\n    let mimeType: string;\n\n    switch (exportOptions.format) {\n      case 'csv':\n        content = convertToCSV(exportData);\n        fileName = `faturalar_${new Date().toISOString().split('T')[0]}.csv`;\n        mimeType = 'text/csv';\n        break;\n      case 'excel':\n        // For simplicity, we'll export as CSV with Excel-compatible format\n        content = convertToCSV(exportData);\n        fileName = `faturalar_${new Date().toISOString().split('T')[0]}.csv`;\n        mimeType = 'application/vnd.ms-excel';\n        break;\n      case 'pdf':\n        content = 'PDF export not implemented yet';\n        fileName = `faturalar_${new Date().toISOString().split('T')[0]}.pdf`;\n        mimeType = 'application/pdf';\n        break;\n      default:\n        throw new Error('Desteklenmeyen export formatı');\n    }\n\n    // Download file\n    const blob = new Blob([content], { type: mimeType });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = fileName;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  };\n\n  const processDeleteInvoices = async (): Promise<BulkOperationResult[]> => {\n    const results: BulkOperationResult[] = [];\n    \n    for (let i = 0; i < selectedInvoices.length; i++) {\n      const invoice = selectedInvoices[i];\n      \n      try {\n        // Check if invoice can be deleted\n        if (invoice.status === 'paid') {\n          results.push({\n            invoiceId: invoice.id,\n            invoiceNumber: invoice.invoiceNumber,\n            success: false,\n            error: 'Ödenen fatura silinemez'\n          });\n          continue;\n        }\n\n        // Simulate API call to delete invoice\n        await new Promise(resolve => setTimeout(resolve, 200));\n        \n        results.push({\n          invoiceId: invoice.id,\n          invoiceNumber: invoice.invoiceNumber,\n          success: true,\n          message: 'Fatura başarıyla silindi'\n        });\n\n        setState(prev => ({\n          ...prev,\n          progress: ((i + 1) / selectedInvoices.length) * 100\n        }));\n      } catch (error) {\n        results.push({\n          invoiceId: invoice.id,\n          invoiceNumber: invoice.invoiceNumber,\n          success: false,\n          error: error instanceof Error ? error.message : 'Silme hatası'\n        });\n      }\n    }\n\n    return results;\n  };\n\n  const convertToCSV = (data: any[]): string => {\n    if (data.length === 0) return '';\n    \n    const headers = Object.keys(data[0]);\n    const csvContent = [\n      headers.join(','),\n      ...data.map(row => \n        headers.map(header => {\n          const value = row[header];\n          // Escape commas and quotes in CSV\n          return typeof value === 'string' && (value.includes(',') || value.includes('\"'))\n            ? `\"${value.replace(/\"/g, '\"\"')}\"`\n            : value;\n        }).join(',')\n      )\n    ].join('\\n');\n    \n    return csvContent;\n  };\n\n  const confirmAction = useCallback(() => {\n    if (confirmationDialog.action) {\n      executeBulkAction(confirmationDialog.action);\n    }\n    setConfirmationDialog({ isOpen: false, action: null, message: '' });\n  }, [confirmationDialog.action, executeBulkAction]);\n\n  const cancelAction = useCallback(() => {\n    setConfirmationDialog({ isOpen: false, action: null, message: '' });\n  }, []);\n\n  if (selectedInvoices.length === 0) {\n    return (\n      <div className={`bulk-operations-empty ${className}`}>\n        <p className=\"text-gray-500 text-center py-4\">\n          Toplu işlem yapmak için fatura seçiniz\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`invoice-bulk-operations ${className}`}>\n      {/* Selection Summary */}\n      <div className=\"selection-summary bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">\n        <div className=\"flex justify-between items-center mb-2\">\n          <h3 className=\"font-medium text-blue-900\">\n            {statistics.count} fatura seçildi\n          </h3>\n          <Button\n            onClick={onSelectionClear}\n            className=\"text-blue-600 hover:text-blue-800 text-sm\"\n            variant='default'>\n            Seçimi Temizle\n          </Button>\n        </div>\n        \n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n          <div>\n            <span className=\"text-gray-600\">Toplam Tutar:</span>\n            <div className=\"font-medium\">₺{statistics.totalAmount.toLocaleString('tr-TR', { minimumFractionDigits: 2 })}</div>\n          </div>\n          \n          {Object.entries(statistics.statusCounts).map(([status, count]) => (\n            <div key={status}>\n              <span className=\"text-gray-600\">{getStatusLabel(status)}:</span>\n              <div className=\"font-medium\">{count}</div>\n            </div>\n          ))}\n        </div>\n      </div>\n      {/* Export Options */}\n      <div className=\"export-options mb-4\">\n        <h4 className=\"font-medium mb-2\">Dışa Aktarma Seçenekleri</h4>\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium mb-1\">Format</label>\n            <Select\n              value={exportOptions.format}\n              onChange={(e) => setExportOptions(prev => ({ ...prev, format: e.target.value as any }))}\n              options={[\n                { value: 'excel', label: 'Excel' },\n                { value: 'csv', label: 'CSV' },\n                { value: 'pdf', label: 'PDF' },\n                { value: 'xml', label: 'XML' }\n              ]}\n              className=\"w-full px-3 py-1 border rounded\"\n            />\n          </div>\n          \n          <label className=\"flex items-center\">\n            <Input\n              type=\"checkbox\"\n              checked={exportOptions.includeItems}\n              onChange={(e) => setExportOptions(prev => ({ ...prev, includeItems: e.target.checked }))}\n              className=\"mr-2\"\n            />\n            Kalem Detayları\n          </label>\n          \n          <label className=\"flex items-center\">\n            <Input\n              type=\"checkbox\"\n              checked={exportOptions.includePayments}\n              onChange={(e) => setExportOptions(prev => ({ ...prev, includePayments: e.target.checked }))}\n              className=\"mr-2\"\n            />\n            Ödeme Bilgileri\n          </label>\n        </div>\n      </div>\n      {/* Bulk Actions */}\n      <div className=\"bulk-actions mb-4\">\n        <h4 className=\"font-medium mb-2\">Toplu İşlemler</h4>\n        <div className=\"flex flex-wrap gap-2\">\n          {bulkActions.map((action) => (\n            <Button\n              key={action.type}\n              onClick={() => handleBulkAction(action)}\n              disabled={state.isProcessing}\n              className={`px-4 py-2 rounded text-sm font-medium disabled:opacity-50 ${\n                action.type === 'delete' || action.type === 'cancel'\n                  ? 'bg-red-600 text-white hover:bg-red-700'\n                  : action.type === 'send_to_gib'\n                  ? 'bg-purple-600 text-white hover:bg-purple-700'\n                  : 'bg-blue-600 text-white hover:bg-blue-700'\n              }`}\n              variant='default'>\n              {action.icon} {action.label}\n            </Button>\n          ))}\n        </div>\n      </div>\n      {/* Progress Indicator */}\n      {state.isProcessing && (\n        <div className=\"progress-indicator bg-gray-50 border rounded-lg p-4 mb-4\">\n          <div className=\"flex justify-between items-center mb-2\">\n            <span className=\"font-medium\">{state.currentAction}</span>\n            <span className=\"text-sm text-gray-600\">{Math.round(state.progress)}%</span>\n          </div>\n          <div className=\"w-full bg-gray-200 rounded-full h-2\">\n            <div\n              className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n              style={{ width: `${state.progress}%` }}\n            />\n          </div>\n        </div>\n      )}\n      {/* Error Display */}\n      {state.error && (\n        <div className=\"error-message bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\n          <h5 className=\"font-medium text-red-800 mb-1\">Hata</h5>\n          <p className=\"text-red-700\">{state.error}</p>\n        </div>\n      )}\n      {/* Results */}\n      {state.results.length > 0 && (\n        <div className=\"operation-results\">\n          <h4 className=\"font-medium mb-2\">İşlem Sonuçları</h4>\n          <div className=\"results-list bg-gray-50 border rounded-lg p-4 max-h-96 overflow-auto\">\n            {state.results.map((result) => (\n              <div\n                key={result.invoiceId}\n                className={`result-item flex justify-between items-center py-2 px-3 mb-2 rounded ${\n                  result.success ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\n                }`}\n              >\n                <span className=\"font-medium\">{result.invoiceNumber}</span>\n                <span className=\"text-sm\">\n                  {result.success ? result.message : result.error}\n                </span>\n              </div>\n            ))}\n          </div>\n          \n          <div className=\"results-summary mt-2 text-sm text-gray-600\">\n            Başarılı: {state.results.filter(r => r.success).length} / \n            Başarısız: {state.results.filter(r => !r.success).length}\n          </div>\n        </div>\n      )}\n      {/* Confirmation Dialog */}\n      {confirmationDialog.isOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\n            <h3 className=\"font-medium text-lg mb-4\">İşlemi Onayla</h3>\n            <p className=\"text-gray-700 mb-6\">{confirmationDialog.message}</p>\n            <div className=\"flex justify-end gap-3\">\n              <Button\n                onClick={cancelAction}\n                className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50\"\n                variant='default'>\n                İptal\n              </Button>\n              <Button\n                onClick={confirmAction}\n                className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\n                variant='default'>\n                Onayla\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Helper function to get status label in Turkish\nfunction getStatusLabel(status: string): string {\n  const statusLabels: Record<string, string> = {\n    'draft': 'Taslak',\n    'sent': 'Gönderildi',\n    'approved': 'Onaylandı',\n    'rejected': 'Reddedildi',\n    'cancelled': 'İptal',\n    'paid': 'Ödendi',\n    'overdue': 'Gecikmiş'\n  };\n  return statusLabels[status] || status;\n}\n\nexport default InvoiceBulkOperations;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/invoices/InvoiceForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4588,4591],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4588,4591],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":165,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5389,5392],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5389,5392],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select, Textarea } from '@x-ear/ui-web';\nimport { useState, useEffect } from 'react';\nimport { Invoice, InvoiceType, InvoiceStatus, CreateInvoiceData, UpdateInvoiceData } from '../../types/invoice';\nimport { Patient } from '../../types/patient';\nimport { usePatients } from '../../hooks/patient/usePatients';\n\ninterface InvoiceFormProps {\n  invoice?: Invoice;\n  onSubmit: (data: CreateInvoiceData | UpdateInvoiceData) => void;\n  onCancel: () => void;\n  isLoading?: boolean;\n}\n\ninterface InvoiceFormData {\n  patientId?: string;\n  patientName: string;\n  patientPhone?: string;\n  patientTcNumber?: string;\n  invoiceNumber: string;\n  type: InvoiceType;\n  issueDate: string;\n  dueDate: string;\n  items: Array<{\n    name: string;\n    description?: string;\n    quantity: number;\n    unitPrice: number;\n    discount?: number;\n    discountType?: 'percentage' | 'amount';\n    taxRate: number;\n  }>;\n  notes: string;\n  billingAddress: {\n    name: string;\n    address: string;\n    city: string;\n    postalCode: string;\n    country: string;\n    taxNumber?: string;\n    taxOffice?: string;\n  };\n  shippingAddress: {\n    name: string;\n    address: string;\n    city: string;\n    postalCode: string;\n    country: string;\n  };\n  currency: string;\n  exchangeRate: number;\n  status: InvoiceStatus;\n}\n\nexport default function InvoiceForm({ invoice, onSubmit, onCancel, isLoading = false }: InvoiceFormProps) {\n  const [formData, setFormData] = useState<InvoiceFormData>({\n    patientId: invoice?.patientId || '',\n    patientName: invoice?.patientName || '',\n    invoiceNumber: invoice?.invoiceNumber || '',\n    type: (invoice?.type === 'standard' || invoice?.type === 'credit_note' || invoice?.type === 'debit_note' ? 'sale' : invoice?.type as InvoiceType) || 'sale',\n    issueDate: invoice?.issueDate || new Date().toISOString().split('T')[0],\n    dueDate: invoice?.dueDate || '',\n    items: invoice?.items?.map(item => ({\n      name: item.name,\n      description: item.description,\n      quantity: item.quantity,\n      unitPrice: item.unitPrice,\n      discount: item.discount,\n      discountType: item.discountType,\n      taxRate: item.taxRate,\n    })) || [],\n    notes: invoice?.notes || '',\n    billingAddress: {\n      name: invoice?.billingAddress?.name || '',\n      address: invoice?.billingAddress?.address || '',\n      city: invoice?.billingAddress?.city || '',\n      postalCode: invoice?.billingAddress?.postalCode || '',\n      country: invoice?.billingAddress?.country || 'Türkiye',\n      taxNumber: invoice?.billingAddress?.taxNumber || '',\n      taxOffice: invoice?.billingAddress?.taxOffice || ''\n    },\n    shippingAddress: {\n      name: invoice?.shippingAddress?.name || '',\n      address: invoice?.shippingAddress?.address || '',\n      city: invoice?.shippingAddress?.city || '',\n      postalCode: invoice?.shippingAddress?.postalCode || '',\n      country: invoice?.shippingAddress?.country || 'Türkiye'\n    },\n    currency: invoice?.currency || 'TRY',\n    exchangeRate: invoice?.exchangeRate || 1,\n    status: invoice?.status || 'draft'\n  });\n\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\n  const [patientSearch, setPatientSearch] = useState('');\n  const [patientResults, setPatientResults] = useState<Patient[]>([]);\n  const [showPatientDropdown, setShowPatientDropdown] = useState(false);\n\n  const searchPatientsQuery = usePatients(patientSearch.length >= 2 ? { search: patientSearch } : {});\n\n  // Search patients\n  useEffect(() => {\n    if (patientSearch.length >= 2 && searchPatientsQuery.data) {\n      setPatientResults(searchPatientsQuery.data.patients || []);\n      setShowPatientDropdown(true);\n    } else {\n      setPatientResults([]);\n      setShowPatientDropdown(false);\n    }\n  }, [patientSearch, searchPatientsQuery.data]);\n\n  const handlePatientSelect = (patient: Patient) => {\n    setFormData(prev => ({\n      ...prev,\n      patientId: patient.id,\n      patientName: `${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta',\n      patientPhone: patient.phone,\n      patientTcNumber: patient.tcNumber,\n      billingAddress: {\n        ...prev.billingAddress,\n        name: `${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta',\n        address: patient.addressFull || '',\n        city: '',\n        postalCode: ''\n      }\n    }));\n    setPatientSearch(`${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta');\n    setShowPatientDropdown(false);\n  };\n\n  // Form handlers\n  const handleInputChange = (field: keyof InvoiceFormData, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (validationErrors[field]) {\n      setValidationErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  const handleAddressChange = (type: 'billingAddress' | 'shippingAddress', field: string, value: string) => {\n    setFormData(prev => ({\n      ...prev,\n      [type]: {\n        ...prev[type],\n        [field]: value\n      }\n    }));\n  };\n\n  // Item management\n  const addItem = () => {\n    const newItem = {\n      name: '',\n      description: '',\n      quantity: 1,\n      unitPrice: 0,\n      discount: 0,\n      discountType: 'percentage' as const,\n      taxRate: 18\n    };\n    setFormData(prev => ({\n      ...prev,\n      items: [...prev.items, newItem]\n    }));\n  };\n\n  const updateItem = (index: number, field: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      items: prev.items.map((item, i) => \n        i === index ? { ...item, [field]: value } : item\n      )\n    }));\n  };\n\n  const removeItem = (index: number) => {\n    setFormData(prev => ({\n      ...prev,\n      items: prev.items.filter((_, i) => i !== index)\n    }));\n  };\n\n  // Calculations\n  const calculateItemTotal = (item: InvoiceFormData['items'][0]) => {\n    const subtotal = item.quantity * item.unitPrice;\n    const discountAmount = item.discountType === 'percentage' \n      ? subtotal * (item.discount || 0) / 100\n      : (item.discount || 0);\n    const afterDiscount = subtotal - discountAmount;\n    const taxAmount = afterDiscount * item.taxRate / 100;\n    return afterDiscount + taxAmount;\n  };\n\n  const calculateTotals = () => {\n    const subtotal = formData.items.reduce((sum, item) => sum + (item.quantity * item.unitPrice), 0);\n    const totalDiscount = formData.items.reduce((sum, item) => {\n      const itemSubtotal = item.quantity * item.unitPrice;\n      return sum + (item.discountType === 'percentage' \n        ? itemSubtotal * (item.discount || 0) / 100\n        : (item.discount || 0));\n    }, 0);\n    const afterDiscount = subtotal - totalDiscount;\n    const totalTax = formData.items.reduce((sum, item) => {\n      const itemSubtotal = item.quantity * item.unitPrice;\n      const itemDiscount = item.discountType === 'percentage' \n        ? itemSubtotal * (item.discount || 0) / 100\n        : (item.discount || 0);\n      const itemAfterDiscount = itemSubtotal - itemDiscount;\n      return sum + (itemAfterDiscount * item.taxRate / 100);\n    }, 0);\n    const grandTotal = afterDiscount + totalTax;\n\n    return { subtotal, totalDiscount, totalTax, grandTotal };\n  };\n\n  // Validation\n  const validateForm = (): boolean => {\n    const errors: Record<string, string> = {};\n\n    if (!formData.patientName.trim()) {\n      errors.patientName = 'Hasta adı gereklidir';\n    }\n\n    if (!formData.invoiceNumber.trim()) {\n      errors.invoiceNumber = 'Fatura numarası gereklidir';\n    }\n\n    if (!formData.issueDate) {\n      errors.issueDate = 'Fatura tarihi gereklidir';\n    }\n\n    if (formData.items.length === 0) {\n      errors.items = 'En az bir kalem eklemelisiniz';\n    }\n\n    formData.items.forEach((item, index) => {\n      if (!item.name.trim()) {\n        errors[`item_${index}_name`] = 'Kalem adı gereklidir';\n      }\n      if (item.quantity <= 0) {\n        errors[`item_${index}_quantity`] = 'Miktar 0\\'dan büyük olmalıdır';\n      }\n      if (item.unitPrice < 0) {\n        errors[`item_${index}_unitPrice`] = 'Birim fiyat negatif olamaz';\n      }\n    });\n\n    if (!formData.billingAddress.name.trim()) {\n      errors.billingAddress_name = 'Fatura adresi adı gereklidir';\n    }\n\n    if (!formData.billingAddress.address.trim()) {\n      errors.billingAddress_address = 'Fatura adresi gereklidir';\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  // Submit\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    const submitData = {\n      type: formData.type,\n      patientId: formData.patientId || undefined,\n      patientName: formData.patientName,\n      billingAddress: {\n        name: formData.billingAddress.name,\n        address: formData.billingAddress.address,\n        city: formData.billingAddress.city,\n        postalCode: formData.billingAddress.postalCode || undefined,\n        country: formData.billingAddress.country,\n        taxNumber: formData.billingAddress.taxNumber || undefined,\n        taxOffice: formData.billingAddress.taxOffice || undefined\n      },\n      shippingAddress: formData.shippingAddress.name ? {\n        name: formData.shippingAddress.name,\n        address: formData.shippingAddress.address,\n        city: formData.shippingAddress.city,\n        postalCode: formData.shippingAddress.postalCode || undefined,\n        country: formData.shippingAddress.country\n      } : undefined,\n      issueDate: formData.issueDate,\n      dueDate: formData.dueDate || undefined,\n      items: formData.items.map(item => ({\n        name: item.name,\n        description: item.description,\n        quantity: item.quantity,\n        unitPrice: item.unitPrice,\n        discount: item.discount,\n        discountType: item.discountType,\n        taxRate: item.taxRate\n      })),\n      notes: formData.notes || undefined,\n      currency: formData.currency,\n      exchangeRate: formData.exchangeRate\n    };\n\n    if (invoice) {\n      onSubmit({ ...submitData, id: invoice.id, status: formData.status } as UpdateInvoiceData);\n    } else {\n      onSubmit(submitData as CreateInvoiceData);\n    }\n  };\n\n  const totals = calculateTotals();\n\n  return (\n    <div className=\"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h2 className=\"text-2xl font-bold text-gray-900\">\n          {invoice ? 'Fatura Düzenle' : 'Yeni Fatura'}\n        </h2>\n        <div className=\"flex space-x-3\">\n          <Button\n            type=\"button\"\n            onClick={onCancel}\n            className=\"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500\"\n            variant='default'>\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            form=\"invoice-form\"\n            disabled={isLoading}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50\"\n            variant='default'>\n            {isLoading ? 'Kaydediliyor...' : (invoice ? 'Güncelle' : 'Kaydet')}\n          </Button>\n        </div>\n      </div>\n      <form id=\"invoice-form\" onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Basic Information */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Fatura Numarası *\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.invoiceNumber}\n              onChange={(e) => handleInputChange('invoiceNumber', e.target.value)}\n              className={`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                validationErrors.invoiceNumber ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {validationErrors.invoiceNumber && (\n              <p className=\"mt-1 text-sm text-red-600\">{validationErrors.invoiceNumber}</p>\n            )}\n          </div>\n\n          <div>\n            <Select\n              label=\"Fatura Tipi\"\n              value={formData.type}\n              onChange={(e) => handleInputChange('type', e.target.value as InvoiceType)}\n              options={[\n                { value: \"sale\", label: \"Satış Faturası\" },\n                { value: \"service\", label: \"Hizmet Faturası\" },\n                { value: \"proforma\", label: \"Proforma Fatura\" },\n                { value: \"return\", label: \"İade Faturası\" },\n                { value: \"replacement\", label: \"Değişim Faturası\" },\n                { value: \"sgk\", label: \"SGK Faturası\" }\n              ]}\n              fullWidth\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Fatura Tarihi *\n            </label>\n            <Input\n              type=\"date\"\n              value={formData.issueDate}\n              onChange={(e) => handleInputChange('issueDate', e.target.value)}\n              className={`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                validationErrors.issueDate ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {validationErrors.issueDate && (\n              <p className=\"mt-1 text-sm text-red-600\">{validationErrors.issueDate}</p>\n            )}\n          </div>\n        </div>\n\n        {/* Patient Selection */}\n        <div className=\"relative\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Hasta *\n          </label>\n          <div className=\"flex space-x-2\">\n            <Input\n              type=\"text\"\n              value={formData.patientName}\n              onChange={(e) => {\n                handleInputChange('patientName', e.target.value);\n                setPatientSearch(e.target.value);\n              }}\n              placeholder=\"Hasta adı yazın veya arayın...\"\n              className={`flex-1 px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                validationErrors.patientName ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            <Button\n              type=\"button\"\n              onClick={() => setShowPatientDropdown(!showPatientDropdown)}\n              className=\"px-3 py-2 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n              variant='default'>\n              🔍\n            </Button>\n          </div>\n          \n          {showPatientDropdown && patientResults.length > 0 && (\n            <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\">\n              {patientResults.map((patient: Patient) => (\n                <Button\n                  key={patient.id}\n                  type=\"button\"\n                  onClick={() => handlePatientSelect(patient)}\n                  className=\"w-full px-4 py-2 text-left hover:bg-gray-100 focus:bg-gray-100 focus:outline-none\"\n                  variant='default'>\n                  <div className=\"font-medium\">{`${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta'}</div>\n                  <div className=\"text-sm text-gray-500\">{patient.phone}</div>\n                </Button>\n              ))}\n            </div>\n          )}\n          \n          {validationErrors.patientName && (\n            <p className=\"mt-1 text-sm text-red-600\">{validationErrors.patientName}</p>\n          )}\n        </div>\n\n        {/* Invoice Items */}\n        <div>\n          <div className=\"flex justify-between items-center mb-4\">\n            <h3 className=\"text-lg font-medium text-gray-900\">Fatura Kalemleri</h3>\n            <Button\n              type=\"button\"\n              onClick={addItem}\n              className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500\"\n              variant='default'>\n              + Kalem Ekle\n            </Button>\n          </div>\n\n          {formData.items.length === 0 ? (\n            <div className=\"text-center py-8 text-gray-500\">\n              Henüz kalem eklenmemiş. Yukarıdaki butona tıklayarak kalem ekleyin.\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {formData.items.map((item, index) => (\n                <div key={index} className=\"border border-gray-200 rounded-lg p-4\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-6 gap-4\">\n                    <div className=\"md:col-span-2\">\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Kalem Adı *\n                      </label>\n                      <Input\n                        type=\"text\"\n                        value={item.name}\n                        onChange={(e) => updateItem(index, 'name', e.target.value)}\n                        className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                          validationErrors[`item_${index}_name`] ? 'border-red-300' : 'border-gray-300'\n                        }`}\n                      />\n                      {validationErrors[`item_${index}_name`] && (\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors[`item_${index}_name`]}</p>\n                      )}\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Miktar *\n                      </label>\n                      <Input\n                        type=\"number\"\n                        min=\"0\"\n                        step=\"0.01\"\n                        value={item.quantity}\n                        onChange={(e) => updateItem(index, 'quantity', parseFloat(e.target.value) || 0)}\n                        className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                          validationErrors[`item_${index}_quantity`] ? 'border-red-300' : 'border-gray-300'\n                        }`}\n                      />\n                      {validationErrors[`item_${index}_quantity`] && (\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors[`item_${index}_quantity`]}</p>\n                      )}\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Birim Fiyat *\n                      </label>\n                      <Input\n                        type=\"number\"\n                        min=\"0\"\n                        step=\"0.01\"\n                        value={item.unitPrice}\n                        onChange={(e) => updateItem(index, 'unitPrice', parseFloat(e.target.value) || 0)}\n                        className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                          validationErrors[`item_${index}_unitPrice`] ? 'border-red-300' : 'border-gray-300'\n                        }`}\n                      />\n                      {validationErrors[`item_${index}_unitPrice`] && (\n                        <p className=\"mt-1 text-sm text-red-600\">{validationErrors[`item_${index}_unitPrice`]}</p>\n                      )}\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        KDV (%)\n                      </label>\n                      <Input\n                        type=\"number\"\n                        min=\"0\"\n                        max=\"100\"\n                        value={item.taxRate}\n                        onChange={(e) => updateItem(index, 'taxRate', parseFloat(e.target.value) || 0)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n                      />\n                    </div>\n\n                    <div className=\"flex items-end\">\n                      <Button\n                        type=\"button\"\n                        onClick={() => removeItem(index)}\n                        className=\"w-full px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500\"\n                        variant='default'>\n                        Sil\n                      </Button>\n                    </div>\n                  </div>\n\n                  <div className=\"mt-2 text-right text-sm text-gray-600\">\n                    Toplam: {calculateItemTotal(item).toFixed(2)} {formData.currency}\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {validationErrors.items && (\n            <p className=\"mt-2 text-sm text-red-600\">{validationErrors.items}</p>\n          )}\n        </div>\n\n        {/* Billing Address */}\n        <div>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Fatura Adresi</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Ad/Unvan *\n              </label>\n              <Input\n                type=\"text\"\n                value={formData.billingAddress.name}\n                onChange={(e) => handleAddressChange('billingAddress', 'name', e.target.value)}\n                className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                  validationErrors.billingAddress_name ? 'border-red-300' : 'border-gray-300'\n                }`}\n              />\n              {validationErrors.billingAddress_name && (\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.billingAddress_name}</p>\n              )}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Şehir\n              </label>\n              <Input\n                type=\"text\"\n                value={formData.billingAddress.city}\n                onChange={(e) => handleAddressChange('billingAddress', 'city', e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n              />\n            </div>\n\n            <div className=\"md:col-span-2\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Adres *\n              </label>\n              <Textarea\n                value={formData.billingAddress.address}\n                onChange={(e) => handleAddressChange('billingAddress', 'address', e.target.value)}\n                rows={3}\n                className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${\n                  validationErrors.billingAddress_address ? 'border-red-300' : 'border-gray-300'\n                }`}\n              />\n              {validationErrors.billingAddress_address && (\n                <p className=\"mt-1 text-sm text-red-600\">{validationErrors.billingAddress_address}</p>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Notes */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <Textarea\n            value={formData.notes}\n            onChange={(e) => handleInputChange('notes', e.target.value)}\n            rows={3}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n            placeholder=\"Fatura ile ilgili notlarınızı buraya yazabilirsiniz...\"\n          />\n        </div>\n\n        {/* Totals */}\n        <div className=\"bg-gray-50 p-4 rounded-lg\">\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Fatura Özeti</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between\">\n              <span>Ara Toplam:</span>\n              <span>{totals.subtotal.toFixed(2)} {formData.currency}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Toplam İndirim:</span>\n              <span>-{totals.totalDiscount.toFixed(2)} {formData.currency}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Toplam KDV:</span>\n              <span>{totals.totalTax.toFixed(2)} {formData.currency}</span>\n            </div>\n            <div className=\"flex justify-between text-lg font-bold border-t pt-2\">\n              <span>Genel Toplam:</span>\n              <span>{totals.grandTotal.toFixed(2)} {formData.currency}</span>\n            </div>\n          </div>\n        </div>\n      </form>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/invoices/InvoiceList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'compact' is assigned a value but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":10},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadInvoices'. Either include it or remove the dependency array.","line":54,"column":6,"nodeType":"ArrayExpression","endLine":54,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [currentPage, loadInvoices]","fix":{"range":[1616,1629],"text":"[currentPage, loadInvoices]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadInvoices'. Either include it or remove the dependency array.","line":69,"column":6,"nodeType":"ArrayExpression","endLine":69,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [searchTerm, filters, loadInvoices]","fix":{"range":[1941,1962],"text":"[searchTerm, filters, loadInvoices]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input } from '@x-ear/ui-web';\nimport { useState, useEffect } from 'react';\nimport { Invoice, InvoiceFilters, InvoiceStatus } from '../../types/invoice';\nimport { invoiceService } from '../../services/invoice.service';\n\ninterface InvoiceListProps {\n  onInvoiceSelect?: (invoice: Invoice) => void;\n  filters?: InvoiceFilters;\n  showActions?: boolean;\n  compact?: boolean;\n}\n\nexport function InvoiceList({ \n  onInvoiceSelect, \n  filters, \n  showActions = true, \n  compact = false \n}: InvoiceListProps) {\n  const [invoices, setInvoices] = useState<Invoice[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedInvoice, setSelectedInvoice] = useState<Invoice | null>(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n\n  // Load invoices\n  const loadInvoices = async (searchFilters?: InvoiceFilters) => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const result = await invoiceService.getInvoices({\n        ...filters,\n        ...searchFilters,\n        page: currentPage,\n        limit: 10\n      });\n      \n      setInvoices(result.invoices);\n      setTotalPages(result.totalPages);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Faturalar yüklenirken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Initialize data and handle search\n  useEffect(() => {\n    invoiceService.initializeData().then(() => {\n      loadInvoices();\n    });\n  }, [currentPage]);\n\n  useEffect(() => {\n    const delayedSearch = setTimeout(() => {\n      if (searchTerm.trim()) {\n        loadInvoices({\n          ...filters,\n          search: searchTerm.trim()\n        });\n      } else {\n        loadInvoices(filters);\n      }\n    }, 300);\n\n    return () => clearTimeout(delayedSearch);\n  }, [searchTerm, filters]);\n\n  const handleInvoiceClick = (invoice: Invoice) => {\n    setSelectedInvoice(invoice);\n    onInvoiceSelect?.(invoice);\n  };\n\n  const handleDeleteInvoice = async (invoice: Invoice, event: React.MouseEvent) => {\n    event.stopPropagation();\n    \n    if (window.confirm(`${invoice.invoiceNumber} numaralı faturayı silmek istediğinizden emin misiniz?`)) {\n      try {\n        await invoiceService.deleteInvoice(invoice.id);\n        loadInvoices(); // Reload list\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Fatura silinirken hata oluştu');\n      }\n    }\n  };\n\n  const handleStatusChange = async (invoice: Invoice, newStatus: InvoiceStatus) => {\n    try {\n      if (newStatus === 'sent') {\n        await invoiceService.sendInvoice(invoice.id);\n      } else if (newStatus === 'paid') {\n        await invoiceService.markAsPaid(invoice.id);\n      } else if (newStatus === 'cancelled') {\n        await invoiceService.cancelInvoice(invoice.id);\n      }\n      loadInvoices(); // Reload list\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Fatura durumu güncellenirken hata oluştu');\n    }\n  };\n\n  const getStatusColor = (status: InvoiceStatus): string => {\n    switch (status) {\n      case 'draft': return 'bg-gray-100 text-gray-800';\n      case 'sent': return 'bg-blue-100 text-blue-800';\n      case 'paid': return 'bg-green-100 text-green-800';\n      case 'overdue': return 'bg-red-100 text-red-800';\n      case 'cancelled': return 'bg-red-100 text-red-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusText = (status: InvoiceStatus): string => {\n    switch (status) {\n      case 'draft': return 'Taslak';\n      case 'sent': return 'Gönderildi';\n      case 'paid': return 'Ödendi';\n      case 'overdue': return 'Vadesi Geçti';\n      case 'cancelled': return 'İptal';\n      default: return status;\n    }\n  };\n\n  const formatCurrency = (amount: number): string => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string): string => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-2 text-gray-600\">Faturalar yükleniyor...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n        <div className=\"flex\">\n          <div className=\"flex-shrink-0\">\n            <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n          <div className=\"ml-3\">\n            <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n            <div className=\"mt-2 text-sm text-red-700\">{error}</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Search Bar */}\n      <div className=\"flex items-center space-x-4\">\n        <div className=\"flex-1\">\n          <Input\n            type=\"text\"\n            placeholder=\"Fatura ara (numara, müşteri adı, vergi no...)\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        </div>\n      </div>\n      {/* Invoice List */}\n      <div className=\"bg-white shadow overflow-hidden sm:rounded-md\">\n        <ul className=\"divide-y divide-gray-200\">\n          {invoices.length === 0 ? (\n            <li className=\"px-6 py-8 text-center text-gray-500\">\n              Fatura bulunamadı\n            </li>\n          ) : (\n            invoices.map((invoice) => (\n              <li\n                key={invoice.id}\n                className={`px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors ${\n                  selectedInvoice?.id === invoice.id ? 'bg-blue-50' : ''\n                }`}\n                onClick={() => handleInvoiceClick(invoice)}\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-2\">\n                          <p className=\"text-sm font-medium text-gray-900 truncate\">\n                            {invoice.invoiceNumber}\n                          </p>\n                          <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusColor(invoice.status)}`}>\n                            {getStatusText(invoice.status)}\n                          </span>\n                        </div>\n                        <div className=\"mt-1 flex items-center space-x-4 text-sm text-gray-500\">\n                          <span>{invoice.patientName}</span>\n                          {invoice.billingAddress?.taxNumber && (\n                            <span>VN: {invoice.billingAddress?.taxNumber}</span>\n                          )}\n                          <span>{formatDate(invoice.createdAt || '')}</span>\n                          {invoice.dueDate && (\n                            <span>Vade: {formatDate(invoice.dueDate)}</span>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-right\">\n                      <p className=\"text-sm font-medium text-gray-900\">\n                        {formatCurrency(invoice.grandTotal || 0)}\n                      </p>\n                      <p className=\"text-xs text-gray-500\">\n                        {invoice.items?.length || 0} kalem\n                      </p>\n                    </div>\n                    \n                    {showActions && (\n                      <div className=\"flex items-center space-x-2\">\n                        {/* Status Actions */}\n                        {invoice.status === 'draft' && (\n                          <Button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleStatusChange(invoice, 'sent');\n                            }}\n                            className=\"text-blue-600 hover:text-blue-800 text-sm font-medium\"\n                            variant='default'>\n                            Gönder\n                          </Button>\n                        )}\n                        \n                        {invoice.status === 'sent' && (\n                          <Button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleStatusChange(invoice, 'paid');\n                            }}\n                            className=\"text-green-600 hover:text-green-800 text-sm font-medium\"\n                            variant='default'>\n                            Ödendi\n                          </Button>\n                        )}\n                        \n                        {['draft', 'sent'].includes(invoice.status) && (\n                          <Button\n                            onClick={(e) => handleDeleteInvoice(invoice, e)}\n                            className=\"text-red-600 hover:text-red-800 text-sm font-medium\"\n                            variant='default'>\n                            Sil\n                          </Button>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </li>\n            ))\n          )}\n        </ul>\n      </div>\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex items-center justify-between px-4 py-3 bg-white border-t border-gray-200 sm:px-6\">\n          <div className=\"flex-1 flex justify-between sm:hidden\">\n            <Button\n              onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n              disabled={currentPage === 1}\n              className=\"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              variant='default'>\n              Önceki\n            </Button>\n            <Button\n              onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n              disabled={currentPage === totalPages}\n              className=\"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              variant='default'>\n              Sonraki\n            </Button>\n          </div>\n          <div className=\"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-700\">\n                Sayfa <span className=\"font-medium\">{currentPage}</span> / <span className=\"font-medium\">{totalPages}</span>\n              </p>\n            </div>\n            <div>\n              <nav className=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\" aria-label=\"Pagination\">\n                <Button\n                  onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                  disabled={currentPage === 1}\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  variant='default'>\n                  Önceki\n                </Button>\n                <Button\n                  onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n                  disabled={currentPage === totalPages}\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  variant='default'>\n                  Sonraki\n                </Button>\n              </nav>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/layout/MainLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserCircle' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":13},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":135,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3781,3784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3781,3784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":194,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":194,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5857,5860],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5857,5860],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":228,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7070,7073],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7070,7073],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":230,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":230,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7149,7152],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7149,7152],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'toggleSidebar'. Either include it or remove the dependency array.","line":232,"column":6,"nodeType":"ArrayExpression","endLine":232,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [toggleSidebar]","fix":{"range":[7181,7183],"text":"[toggleSidebar]"}}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from '@x-ear/ui-web';\nimport * as React from 'react';\nimport { useState, useEffect } from 'react';\nimport { Link, useNavigate } from '@tanstack/react-router';\nimport { \n  BarChart3, \n  Users, \n  Calendar, \n  Package, \n  Building2, \n  FileText, \n  Wallet, \n  Megaphone, \n  Building, \n  PieChart, \n  Bot, \n  Settings, \n  ChevronRight, \n  Menu, \n  Sun, \n  Moon, \n  Bell, \n  User, \n  UserCircle, \n  LogOut,\n  ChevronDown\n} from 'lucide-react';\nimport { useAuthStore } from '../../stores/authStore';\n\ninterface User {\n  id: string;\n  email: string;\n  name: string;\n  role?: string;\n}\n\ninterface MainLayoutProps {\n  children?: React.ReactNode;\n}\n\nexport const MainLayout: React.FC<MainLayoutProps> = ({ children }) => {\n  const { user } = useAuthStore();\n  console.log('MainLayout render - user:', user);\n  \n  const navigate = useNavigate();\n  \n  const [sidebarCollapsed, setSidebarCollapsed] = useState(() => {\n    const saved = localStorage.getItem('sidebarCollapsed');\n    return saved ? JSON.parse(saved) : false;\n  });\n\n  const [darkMode, setDarkMode] = useState(() => {\n    const saved = localStorage.getItem('darkMode');\n    return saved ? JSON.parse(saved) : false;\n  });\n\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\n  const [expandedMenus, setExpandedMenus] = useState<{[key: string]: boolean}>({});\n\n  useEffect(() => {\n    localStorage.setItem('sidebarCollapsed', JSON.stringify(sidebarCollapsed));\n  }, [sidebarCollapsed]);\n\n  useEffect(() => {\n    localStorage.setItem('darkMode', JSON.stringify(darkMode));\n    if (darkMode) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }, [darkMode]);\n\n  const toggleSidebar = () => {\n    setSidebarCollapsed(!sidebarCollapsed);\n  };\n\n  const toggleDarkMode = () => {\n    setDarkMode(!darkMode);\n  };\n\n  const toggleUserDropdown = () => {\n    setShowUserDropdown(!showUserDropdown);\n  };\n\n  const toggleSubmenu = (menuKey: string) => {\n    setExpandedMenus(prev => ({\n      ...prev,\n      [menuKey]: !prev[menuKey]\n    }));\n  };\n\n  const menuItems = [\n    { key: 'dashboard', label: 'Dashboard', icon: BarChart3, href: '/' },\n    { key: 'patients', label: 'Hastalar', icon: Users, href: '/patients' },\n    { key: 'appointments', label: 'Randevular', icon: Calendar, href: '/appointments' },\n    { key: 'inventory', label: 'Envanter', icon: Package, href: '/inventory' },\n    { key: 'suppliers', label: 'Tedarikçiler', icon: Building2, href: '/suppliers' },\n    { \n      key: 'invoices', \n      label: 'Fatura', \n      icon: FileText, \n      submenu: [\n        { label: 'Satışlar', href: '/invoices' },\n        { label: 'Alışlar', href: '/invoices/purchases' },\n        { label: 'Yeni Fatura', href: '/invoices/new' },\n        { label: 'Ödeme Takibi', href: '/invoices/payments' }\n      ]\n    },\n    { key: 'cashflow', label: 'Kasa', icon: Wallet, href: '/cashflow' },\n    { key: 'campaigns', label: 'Kampanyalar', icon: Megaphone, href: '/campaigns' },\n    { \n      key: 'sgk', \n      label: 'SGK', \n      icon: Building, \n      submenu: [\n        { label: 'SGK Raporları', href: '/sgk' },\n        { label: 'Hasta Eşleştirme', href: '/sgk/matching' },\n        { label: 'Belge Yükleme', href: '/sgk/upload' }\n      ]\n    },\n    { \n      key: 'reports', \n      label: 'Raporlar', \n      icon: PieChart, \n      submenu: [\n        { label: 'Genel Raporlar', href: '/reports' },\n        { label: 'Satış Raporları', href: '/reports/sales' },\n        { label: 'Hasta Raporları', href: '/reports/patients' }\n      ]\n    },\n    { key: 'automation', label: 'Otomasyon', icon: Bot, href: '/automation' },\n    { key: 'settings', label: 'Ayarlar', icon: Settings, href: '/settings' }\n  ];\n\n  const renderMenuItem = (item: any) => {\n    const hasSubmenu = item.submenu && item.submenu.length > 0;\n    const isExpanded = expandedMenus[item.key];\n\n    return (\n      <li key={item.key} style={{ marginBottom: '0.25rem' }}>\n        <div\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            padding: '0.75rem 1rem',\n            color: darkMode ? '#d1d5db' : '#374151',\n            textDecoration: 'none',\n            borderRadius: '0.375rem',\n            cursor: 'pointer',\n            transition: 'all 0.2s ease',\n            backgroundColor: 'transparent'\n          }}\n          onClick={() => {\n            if (hasSubmenu) {\n              toggleSubmenu(item.key);\n            } else {\n              navigate({ to: item.href });\n            }\n          }}\n          onMouseEnter={(e) => {\n            e.currentTarget.style.backgroundColor = darkMode ? '#374151' : '#f3f4f6';\n            e.currentTarget.style.color = darkMode ? '#ffffff' : '#1f2937';\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.backgroundColor = 'transparent';\n            e.currentTarget.style.color = darkMode ? '#d1d5db' : '#374151';\n          }}\n        >\n          <span style={{ marginRight: sidebarCollapsed ? '0' : '0.75rem' }}>\n            <item.icon size={20} />\n          </span>\n          {!sidebarCollapsed && (\n            <>\n              <span style={{ flex: 1 }}>{item.label}</span>\n              {hasSubmenu && (\n                <span style={{ \n                  transform: isExpanded ? 'rotate(90deg)' : 'rotate(0deg)',\n                  transition: 'transform 0.2s ease'\n                }}>\n                  <ChevronRight size={16} />\n                </span>\n              )}\n            </>\n          )}\n        </div>\n        \n        {hasSubmenu && !sidebarCollapsed && isExpanded && (\n          <ul style={{ \n            listStyle: 'none', \n            padding: 0, \n            margin: '0.25rem 0 0 2rem',\n            borderLeft: `2px solid ${darkMode ? '#374151' : '#e5e7eb'}`\n          }}>\n            {item.submenu.map((subItem: any, index: number) => (\n              <li key={index}>\n                <Link\n                  to={subItem.href}\n                  style={{\n                    display: 'block',\n                    padding: '0.5rem 1rem',\n                    color: darkMode ? '#9ca3af' : '#6b7280',\n                    textDecoration: 'none',\n                    fontSize: '0.875rem',\n                    borderRadius: '0.375rem',\n                    transition: 'all 0.2s ease'\n                  }}\n                  onMouseEnter={(e) => {\n                    e.currentTarget.style.backgroundColor = darkMode ? '#374151' : '#f3f4f6';\n                    e.currentTarget.style.color = darkMode ? '#ffffff' : '#1f2937';\n                  }}\n                  onMouseLeave={(e) => {\n                    e.currentTarget.style.backgroundColor = 'transparent';\n                    e.currentTarget.style.color = darkMode ? '#9ca3af' : '#6b7280';\n                  }}\n                >\n                  {subItem.label}\n                </Link>\n              </li>\n            ))}\n          </ul>\n        )}\n      </li>\n    );\n  };\n\n  // Make toggleSidebar available globally for legacy compatibility\n  useEffect(() => {\n    (window as any).toggleSidebar = toggleSidebar;\n    return () => {\n      delete (window as any).toggleSidebar;\n    };\n  }, []);\n\n  return (\n    <div style={{ \n      display: 'flex', \n      minHeight: '100vh',\n      backgroundColor: darkMode ? '#111827' : '#ffffff',\n      color: darkMode ? '#ffffff' : '#000000'\n    }}>\n      {/* Sidebar */}\n      <nav style={{\n        width: sidebarCollapsed ? '80px' : '240px',\n        backgroundColor: darkMode ? '#1f2937' : '#ffffff',\n        borderRight: `1px solid ${darkMode ? '#374151' : '#e5e7eb'}`,\n        transition: 'width 0.3s ease',\n        position: 'fixed',\n        height: '100vh',\n        overflowY: 'auto',\n        zIndex: 1000\n      }}>\n        <div style={{ \n          padding: '1rem',\n          borderBottom: `1px solid ${darkMode ? '#374151' : '#e5e7eb'}`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: sidebarCollapsed ? 'center' : 'space-between'\n        }}>\n          <Button\n            onClick={toggleSidebar}\n            style={{\n              background: 'none',\n              border: 'none',\n              cursor: 'pointer',\n              padding: '0.5rem',\n              borderRadius: '0.375rem',\n              color: darkMode ? '#ffffff' : '#1f2937',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center'\n            }}\n            variant='ghost'>\n            <Menu size={20} />\n          </Button>\n          {!sidebarCollapsed && (\n            <h2 style={{ \n              margin: 0, \n              fontSize: '1.25rem',\n              fontWeight: 'bold',\n              color: darkMode ? '#ffffff' : '#1f2937'\n            }}>\n              X-EAR CRM\n            </h2>\n          )}\n        </div>\n        \n        <ul style={{ \n          listStyle: 'none', \n          padding: '1rem 0.5rem', \n          margin: 0 \n        }}>\n          {menuItems.map(renderMenuItem)}\n        </ul>\n      </nav>\n      {/* Main Content */}\n      <div style={{ \n        flex: 1, \n        display: 'flex', \n        flexDirection: 'column',\n        marginLeft: sidebarCollapsed ? '80px' : '240px',\n        transition: 'margin-left 0.3s ease'\n      }}>\n        {/* Header */}\n        <header style={{\n          backgroundColor: darkMode ? '#1f2937' : '#ffffff',\n          padding: '1rem 2rem',\n          borderBottom: `1px solid ${darkMode ? '#374151' : '#e5e7eb'}`,\n          boxShadow: '0 1px 3px 0 rgba(0, 0, 0, 0.1)',\n          position: 'sticky',\n          top: 0,\n          zIndex: 999\n        }}>\n          <div style={{ \n            display: 'flex', \n            justifyContent: 'space-between', \n            alignItems: 'center' \n          }}>\n            <h1 style={{ \n              margin: 0, \n              fontSize: '1.5rem',\n              color: darkMode ? '#ffffff' : '#1f2937',\n              fontWeight: '600'\n            }}>\n              Dashboard\n            </h1>\n            \n            <div style={{ \n              display: 'flex', \n              alignItems: 'center', \n              gap: '1rem' \n            }}>\n              {/* Dark Mode Toggle */}\n              <Button\n                onClick={toggleDarkMode}\n                style={{\n                  background: 'none',\n                  border: 'none',\n                  cursor: 'pointer',\n                  padding: '0.5rem',\n                  borderRadius: '0.375rem',\n                  color: darkMode ? '#ffffff' : '#1f2937',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n                title={darkMode ? 'Açık Tema' : 'Koyu Tema'}\n                variant='ghost'>\n                {darkMode ? <Sun size={20} /> : <Moon size={20} />}\n              </Button>\n\n              {/* Notifications */}\n              <Button\n                style={{\n                  position: 'relative',\n                  background: 'none',\n                  border: 'none',\n                  cursor: 'pointer',\n                  padding: '0.5rem',\n                  borderRadius: '0.375rem',\n                  color: darkMode ? '#ffffff' : '#1f2937',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n                title=\"Bildirimler\"\n                variant='ghost'>\n                <Bell size={20} />\n                <span style={{\n                  position: 'absolute',\n                  top: '0.25rem',\n                  right: '0.25rem',\n                  width: '8px',\n                  height: '8px',\n                  backgroundColor: '#ef4444',\n                  borderRadius: '50%'\n                }}></span>\n              </Button>\n\n              {/* User Menu */}\n              <div style={{ position: 'relative' }}>\n                <Button\n                  onClick={toggleUserDropdown}\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '0.5rem',\n                    background: 'none',\n                    border: 'none',\n                    cursor: 'pointer',\n                    padding: '0.5rem',\n                    borderRadius: '0.375rem',\n                    backgroundColor: darkMode ? '#374151' : '#f3f4f6'\n                  }}\n                  variant='ghost'>\n                  <div style={{\n                    width: '32px',\n                    height: '32px',\n                    borderRadius: '50%',\n                    backgroundColor: '#3b82f6',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    color: 'white',\n                    fontWeight: 'bold',\n                    fontSize: '0.875rem'\n                  }}>\n                    <User size={16} />\n                  </div>\n                  <div style={{ \n                    textAlign: 'left',\n                    color: darkMode ? '#ffffff' : '#1f2937'\n                  }}>\n                    <div style={{ fontSize: '0.875rem', fontWeight: '500' }}>\n                      {user?.name || 'User'}\n                    </div>\n                    <div style={{ fontSize: '0.75rem', opacity: 0.7 }}>\n                      {user?.role || 'Guest'}\n                    </div>\n                  </div>\n                  <ChevronDown size={12} style={{ \n                    color: darkMode ? '#ffffff' : '#1f2937'\n                  }} />\n                </Button>\n\n                {/* User Dropdown */}\n                {showUserDropdown && (\n                  <div style={{\n                    position: 'absolute',\n                    top: '100%',\n                    right: 0,\n                    marginTop: '0.5rem',\n                    backgroundColor: darkMode ? '#1f2937' : '#ffffff',\n                    border: `1px solid ${darkMode ? '#374151' : '#e5e7eb'}`,\n                    borderRadius: '0.5rem',\n                    boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1)',\n                    minWidth: '200px',\n                    zIndex: 1000\n                  }}>\n                    <div style={{ padding: '0.5rem 0' }}>\n                      <a\n                        href=\"/profile\"\n                        style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          padding: '0.75rem 1rem',\n                          color: darkMode ? '#ffffff' : '#1f2937',\n                          textDecoration: 'none',\n                          fontSize: '0.875rem',\n                          borderBottom: `1px solid ${darkMode ? '#374151' : '#e5e7eb'}`,\n                          backgroundColor: 'transparent',\n                          transition: 'background-color 0.2s ease'\n                        }}\n                        onMouseEnter={(e) => {\n                          e.currentTarget.style.backgroundColor = darkMode ? '#374151' : '#f3f4f6';\n                        }}\n                        onMouseLeave={(e) => {\n                          e.currentTarget.style.backgroundColor = 'transparent';\n                        }}\n                      >\n                        <User size={16} style={{ marginRight: '0.5rem' }} />\n                        <span>Profil</span>\n                      </a>\n                      <a\n                        href=\"/settings\"\n                        style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          padding: '0.75rem 1rem',\n                          color: darkMode ? '#ffffff' : '#1f2937',\n                          textDecoration: 'none',\n                          fontSize: '0.875rem',\n                          borderBottom: `1px solid ${darkMode ? '#374151' : '#e5e7eb'}`,\n                          backgroundColor: 'transparent',\n                          transition: 'background-color 0.2s ease'\n                        }}\n                        onMouseEnter={(e) => {\n                          e.currentTarget.style.backgroundColor = darkMode ? '#374151' : '#f3f4f6';\n                        }}\n                        onMouseLeave={(e) => {\n                          e.currentTarget.style.backgroundColor = 'transparent';\n                        }}\n                      >\n                        <Settings size={16} style={{ marginRight: '0.5rem' }} />\n                        <span>Ayarlar</span>\n                      </a>\n                      <Button\n                        onClick={() => {\n                          localStorage.removeItem('token');\n                          localStorage.removeItem('refreshToken');\n                          window.location.href = '/login';\n                        }}\n                        style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          width: '100%',\n                          padding: '0.75rem 1rem',\n                          color: '#ef4444',\n                          background: 'none',\n                          border: 'none',\n                          textAlign: 'left',\n                          fontSize: '0.875rem',\n                          cursor: 'pointer',\n                          backgroundColor: 'transparent',\n                          transition: 'background-color 0.2s ease'\n                        }}\n                        onMouseEnter={(e) => {\n                          e.currentTarget.style.backgroundColor = darkMode ? '#374151' : '#f3f4f6';\n                        }}\n                        onMouseLeave={(e) => {\n                          e.currentTarget.style.backgroundColor = 'transparent';\n                        }}\n                        variant='ghost'>\n                        <LogOut size={16} style={{ marginRight: '0.5rem' }} />\n                        <span>Çıkış Yap</span>\n                      </Button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </header>\n\n        {/* Content */}\n        <main style={{ \n          flex: 1, \n          padding: '2rem',\n          backgroundColor: darkMode ? '#111827' : '#f9fafb',\n          minHeight: 'calc(100vh - 80px)'\n        }}>\n          {children}\n        </main>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/modals/CollectionModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LoadingSkeleton' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CreditCard' is defined but never used.","line":5,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Banknote' is defined but never used.","line":5,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2656,2659],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2656,2659],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getPaymentMethodText' is assigned a value but never used.","line":105,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":105,"endColumn":29},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":162,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":172,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":180,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":190,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":201,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":207,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":216,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":226,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":234,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":240,"endColumn":15}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Modal } from '../ui/Modal';\nimport { Button } from '../ui/Button';\nimport { LoadingSkeleton } from '../common/LoadingSkeleton';\nimport { Receipt, CreditCard, Banknote, DollarSign, Calendar } from 'lucide-react';\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/api';\nimport type { PaymentRecord, Sale } from '../../api/generated/api.schemas';\n\ninterface CollectionModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  sale: Sale;\n  onCollectPayment?: (paymentData: PaymentRecord) => Promise<void>;\n}\n\nexport const CollectionModal: React.FC<CollectionModalProps> = ({\n  isOpen,\n  onClose,\n  sale,\n  onCollectPayment\n}) => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [paymentData, setPaymentData] = useState({\n    amount: 0,\n    paymentMethod: 'cash',\n    paymentDate: new Date().toISOString().split('T')[0],\n    referenceNumber: '',\n    notes: ''\n  });\n\n  useEffect(() => {\n    if (isOpen && sale) {\n      // Calculate remaining amount from sale data\n      const remainingAmount = (sale.totalAmount || 0) - (sale.patientPayment || 0);\n      setPaymentData(prev => ({\n        ...prev,\n        amount: remainingAmount\n      }));\n      setError(null);\n    }\n  }, [isOpen, sale]);\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (paymentData.amount <= 0) {\n      setError('Geçerli bir tutar giriniz');\n      return;\n    }\n\n    const remainingAmount = (sale.totalAmount || 0) - (sale.patientPayment || 0);\n    if (paymentData.amount > remainingAmount) {\n      setError('Ödeme tutarı kalan tutardan fazla olamaz');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      \n      // Create payment plan for the sale\n      const paymentPlanData = {\n        amount: paymentData.amount,\n        paymentMethod: paymentData.paymentMethod,\n        paymentDate: paymentData.paymentDate,\n        referenceNumber: paymentData.referenceNumber,\n        notes: paymentData.notes,\n        status: 'COMPLETED' as const,\n        paymentType: 'COLLECTION'\n      };\n\n      const response = await api.salesCreateSalePaymentPlan(\n        sale.id!,\n        paymentPlanData\n      );\n\n      // Call the callback if provided\n      if (onCollectPayment) {\n        await onCollectPayment(response.data);\n      }\n\n      onClose();\n    } catch (err: any) {\n      console.error('Payment collection error:', err);\n      setError(\n        err?.response?.data?.error || \n        err?.message || \n        'Ödeme kaydedilemedi'\n      );\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const getPaymentMethodText = (method: string) => {\n    switch (method) {\n      case 'cash': return 'Nakit';\n      case 'card': return 'Kredi Kartı';\n      case 'transfer': return 'Havale/EFT';\n      case 'check': return 'Çek';\n      default: return method;\n    }\n  };\n\n  const remainingAmount = (sale?.totalAmount || 0) - (sale?.patientPayment || 0);\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      title=\"Ödeme Tahsilat\"\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n            <p className=\"text-red-800\">{error}</p>\n          </div>\n        )}\n\n        {/* Sale Summary */}\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n          <h3 className=\"font-medium text-blue-900 mb-3 flex items-center\">\n            <Receipt className=\"w-4 h-4 mr-2\" />\n            Satış Bilgileri\n          </h3>\n          <div className=\"space-y-2 text-sm text-blue-800\">\n            <div className=\"flex justify-between\">\n              <span>Toplam Tutar:</span>\n              <span className=\"font-medium\">{formatCurrency(sale?.totalAmount || 0)}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Ödenen Tutar:</span>\n              <span className=\"font-medium\">{formatCurrency(sale?.patientPayment || 0)}</span>\n            </div>\n            <div className=\"flex justify-between border-t pt-2\">\n              <span className=\"font-medium\">Kalan Tutar:</span>\n              <span className=\"font-bold text-red-600\">{formatCurrency(remainingAmount)}</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Payment Form */}\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Tahsilat Tutarı\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <DollarSign className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                min=\"0\"\n                max={remainingAmount}\n                value={paymentData.amount}\n                onChange={(e) => setPaymentData(prev => ({ ...prev, amount: parseFloat(e.target.value) || 0 }))}\n                className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"0.00\"\n                required\n              />\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Ödeme Yöntemi\n            </label>\n            <select\n              value={paymentData.paymentMethod}\n              onChange={(e) => setPaymentData(prev => ({ ...prev, paymentMethod: e.target.value }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              required\n            >\n              <option value=\"cash\">Nakit</option>\n              <option value=\"card\">Kredi Kartı</option>\n              <option value=\"transfer\">Havale/EFT</option>\n              <option value=\"check\">Çek</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Ödeme Tarihi\n            </label>\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n              </div>\n              <input\n                type=\"date\"\n                value={paymentData.paymentDate}\n                onChange={(e) => setPaymentData(prev => ({ ...prev, paymentDate: e.target.value }))}\n                className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                required\n              />\n            </div>\n          </div>\n\n          {(paymentData.paymentMethod === 'card' || paymentData.paymentMethod === 'transfer' || paymentData.paymentMethod === 'check') && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Referans Numarası\n              </label>\n              <input\n                type=\"text\"\n                value={paymentData.referenceNumber}\n                onChange={(e) => setPaymentData(prev => ({ ...prev, referenceNumber: e.target.value }))}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                placeholder={\n                  paymentData.paymentMethod === 'card' ? 'İşlem numarası' :\n                  paymentData.paymentMethod === 'transfer' ? 'Dekont numarası' :\n                  'Çek numarası'\n                }\n              />\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Notlar\n            </label>\n            <textarea\n              value={paymentData.notes}\n              onChange={(e) => setPaymentData(prev => ({ ...prev, notes: e.target.value }))}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              placeholder=\"Ödeme ile ilgili notlar...\"\n            />\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex justify-end space-x-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={onClose}\n            disabled={isLoading}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isLoading || paymentData.amount <= 0}\n          >\n            {isLoading ? 'Kaydediliyor...' : `${formatCurrency(paymentData.amount)} Tahsil Et`}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/modals/InstallmentModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":5,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[616,619],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[616,619],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchInstallments'. Either include it or remove the dependency array.","line":44,"column":6,"nodeType":"ArrayExpression","endLine":44,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [fetchInstallments, isOpen, sale?.id]","fix":{"range":[1307,1325],"text":"[fetchInstallments, isOpen, sale?.id]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'totalPaid' is assigned a value but never used.","line":137,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":137,"endColumn":18},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":269,"column":31,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":277,"endColumn":33},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":283,"column":31,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":291,"endColumn":40}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Modal } from '../ui/Modal';\nimport { Button } from '../ui/Button';\nimport { LoadingSkeleton } from '../common/LoadingSkeleton';\nimport { RefreshCw, Calendar, DollarSign, CheckCircle, Clock, AlertCircle, CreditCard } from 'lucide-react';\n\ninterface Installment {\n  id: string;\n  installmentNumber: number;\n  amount: number;\n  paidAmount: number;\n  dueDate: string;\n  status: 'pending' | 'paid' | 'partial' | 'overdue';\n  paymentDate?: string;\n  paymentMethod?: string;\n}\n\ninterface InstallmentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  sale: any;\n  onPayInstallment?: (installmentId: string, amount: number, paymentMethod: string) => Promise<void>;\n}\n\nexport const InstallmentModal: React.FC<InstallmentModalProps> = ({\n  isOpen,\n  onClose,\n  sale,\n  onPayInstallment\n}) => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [installments, setInstallments] = useState<Installment[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [payingInstallmentId, setPayingInstallmentId] = useState<string | null>(null);\n  const [paymentData, setPaymentData] = useState({\n    amount: 0,\n    paymentMethod: 'cash'\n  });\n\n  useEffect(() => {\n    if (isOpen && sale?.id) {\n      fetchInstallments();\n    }\n  }, [isOpen, sale?.id]);\n\n  const fetchInstallments = async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      // TODO: Implement API call to fetch installments\n      const response = await fetch(`/api/sales/${sale.id}/installments`);\n      if (!response.ok) throw new Error('Taksitler yüklenemedi');\n      const data = await response.json();\n      setInstallments(data.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Bir hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'paid': return 'bg-green-100 text-green-800';\n      case 'partial': return 'bg-yellow-100 text-yellow-800';\n      case 'overdue': return 'bg-red-100 text-red-800';\n      default: return 'bg-blue-100 text-blue-800';\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'paid': return 'Ödendi';\n      case 'partial': return 'Kısmi';\n      case 'overdue': return 'Gecikmiş';\n      default: return 'Bekliyor';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'paid': return <CheckCircle className=\"w-4 h-4\" />;\n      case 'overdue': return <AlertCircle className=\"w-4 h-4\" />;\n      default: return <Clock className=\"w-4 h-4\" />;\n    }\n  };\n\n  const isOverdue = (dueDate: string, status: string) => {\n    if (status === 'paid') return false;\n    return new Date(dueDate) < new Date();\n  };\n\n  const handlePayInstallment = async (installmentId: string) => {\n    if (paymentData.amount <= 0) {\n      setError('Geçerli bir tutar giriniz');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      await onPayInstallment?.(installmentId, paymentData.amount, paymentData.paymentMethod);\n      setPayingInstallmentId(null);\n      setPaymentData({ amount: 0, paymentMethod: 'cash' });\n      await fetchInstallments(); // Refresh installments\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Ödeme kaydedilemedi');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const startPayment = (installment: Installment) => {\n    setPayingInstallmentId(installment.id);\n    setPaymentData({\n      amount: installment.amount - installment.paidAmount,\n      paymentMethod: 'cash'\n    });\n    setError(null);\n  };\n\n  const totalInstallments = installments.length;\n  const paidInstallments = installments.filter(i => i.status === 'paid').length;\n  const overdueInstallments = installments.filter(i => isOverdue(i.dueDate, i.status)).length;\n  const totalPaid = installments.reduce((sum, i) => sum + i.paidAmount, 0);\n  const totalRemaining = installments.reduce((sum, i) => sum + (i.amount - i.paidAmount), 0);\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      title=\"Taksit Yönetimi\"\n    >\n      <div className=\"space-y-6\">\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n            <p className=\"text-red-800\">{error}</p>\n          </div>\n        )}\n\n        {/* Summary Cards */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          <div className=\"bg-blue-50 p-3 rounded-lg\">\n            <div className=\"flex items-center\">\n              <RefreshCw className=\"w-4 h-4 text-blue-500 mr-2\" />\n              <div>\n                <p className=\"text-xs text-blue-600\">Toplam Taksit</p>\n                <p className=\"text-lg font-semibold text-blue-900\">{totalInstallments}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-green-50 p-3 rounded-lg\">\n            <div className=\"flex items-center\">\n              <CheckCircle className=\"w-4 h-4 text-green-500 mr-2\" />\n              <div>\n                <p className=\"text-xs text-green-600\">Ödenen</p>\n                <p className=\"text-lg font-semibold text-green-900\">{paidInstallments}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-red-50 p-3 rounded-lg\">\n            <div className=\"flex items-center\">\n              <AlertCircle className=\"w-4 h-4 text-red-500 mr-2\" />\n              <div>\n                <p className=\"text-xs text-red-600\">Gecikmiş</p>\n                <p className=\"text-lg font-semibold text-red-900\">{overdueInstallments}</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"bg-purple-50 p-3 rounded-lg\">\n            <div className=\"flex items-center\">\n              <DollarSign className=\"w-4 h-4 text-purple-500 mr-2\" />\n              <div>\n                <p className=\"text-xs text-purple-600\">Kalan</p>\n                <p className=\"text-sm font-semibold text-purple-900\">{formatCurrency(totalRemaining)}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Installments List */}\n        <div className=\"space-y-4\">\n          <h3 className=\"font-medium text-gray-900\">Taksit Detayları</h3>\n\n          {isLoading ? (\n            <LoadingSkeleton lines={4} />\n          ) : installments.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <RefreshCw className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n              <p className=\"text-gray-600\">Taksit planı bulunamadı</p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {installments.map((installment) => (\n                <div \n                  key={installment.id} \n                  className={`border rounded-lg p-4 ${\n                    isOverdue(installment.dueDate, installment.status) \n                      ? 'border-red-200 bg-red-50' \n                      : 'border-gray-200'\n                  }`}\n                >\n                  <div className=\"flex justify-between items-start mb-3\">\n                    <div className=\"flex items-center\">\n                      {getStatusIcon(installment.status)}\n                      <span className=\"ml-2 font-medium\">\n                        {installment.installmentNumber}. Taksit\n                      </span>\n                      {isOverdue(installment.dueDate, installment.status) && (\n                        <span className=\"ml-2 text-xs text-red-600 font-medium\">\n                          (Gecikmiş)\n                        </span>\n                      )}\n                    </div>\n                    <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(installment.status)}`}>\n                      {getStatusText(installment.status)}\n                    </span>\n                  </div>\n\n                  <div className=\"grid grid-cols-2 gap-4 text-sm mb-3\">\n                    <div>\n                      <span className=\"text-gray-600\">Tutar:</span>\n                      <span className=\"ml-2 font-medium\">{formatCurrency(installment.amount)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-600\">Vade:</span>\n                      <span className=\"ml-2\">{formatDate(installment.dueDate)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-600\">Ödenen:</span>\n                      <span className=\"ml-2 text-green-600\">{formatCurrency(installment.paidAmount)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-600\">Kalan:</span>\n                      <span className=\"ml-2 text-red-600\">{formatCurrency(installment.amount - installment.paidAmount)}</span>\n                    </div>\n                  </div>\n\n                  {installment.paymentDate && (\n                    <div className=\"text-sm text-gray-600 mb-3\">\n                      <span>Ödeme Tarihi: {formatDate(installment.paymentDate)}</span>\n                      {installment.paymentMethod && (\n                        <span className=\"ml-4\">Yöntem: {installment.paymentMethod}</span>\n                      )}\n                    </div>\n                  )}\n\n                  {installment.status !== 'paid' && (\n                    <div className=\"border-t pt-3\">\n                      {payingInstallmentId === installment.id ? (\n                        <div className=\"space-y-3\">\n                          <div className=\"grid grid-cols-2 gap-3\">\n                            <div>\n                              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                                Ödeme Tutarı\n                              </label>\n                              <input\n                                type=\"number\"\n                                step=\"0.01\"\n                                min=\"0\"\n                                max={installment.amount - installment.paidAmount}\n                                value={paymentData.amount}\n                                onChange={(e) => setPaymentData(prev => ({ ...prev, amount: parseFloat(e.target.value) || 0 }))}\n                                className=\"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                              />\n                            </div>\n                            <div>\n                              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                                Ödeme Yöntemi\n                              </label>\n                              <select\n                                value={paymentData.paymentMethod}\n                                onChange={(e) => setPaymentData(prev => ({ ...prev, paymentMethod: e.target.value }))}\n                                className=\"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                              >\n                                <option value=\"cash\">Nakit</option>\n                                <option value=\"card\">Kart</option>\n                                <option value=\"transfer\">Havale</option>\n                              </select>\n                            </div>\n                          </div>\n                          <div className=\"flex space-x-2\">\n                            <Button\n                              onClick={() => handlePayInstallment(installment.id)}\n                              disabled={isLoading || paymentData.amount <= 0}\n                              className=\"text-sm px-3 py-1\"\n                            >\n                              {isLoading ? 'Kaydediliyor...' : 'Öde'}\n                            </Button>\n                            <Button\n                              variant=\"secondary\"\n                              onClick={() => setPayingInstallmentId(null)}\n                              className=\"text-sm px-3 py-1\"\n                            >\n                              İptal\n                            </Button>\n                          </div>\n                        </div>\n                      ) : (\n                        <Button\n                          variant=\"secondary\"\n                          onClick={() => startPayment(installment)}\n                          className=\"text-sm\"\n                        >\n                          <CreditCard className=\"w-3 h-3 mr-1\" />\n                          Öde\n                        </Button>\n                      )}\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex justify-end pt-4 border-t\">\n          <Button variant=\"secondary\" onClick={onClose}>\n            Kapat\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/modals/InvoiceModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[538,541],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[538,541],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'scenario' is assigned a value but never used.","line":224,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":224,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":227,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6767,6770],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6767,6770],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":228,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6797,6800],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6797,6800],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":230,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":230,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6926,6929],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6926,6929],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":245,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7510,7513],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7510,7513],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":261,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":261,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8144,8147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8144,8147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":275,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":275,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8566,8569],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8566,8569],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":279,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":279,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8693,8696],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8693,8696],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'deviceInfo' is assigned a value but never used.","line":280,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":280,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":290,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":290,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9023,9026],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9023,9026],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9105,9108],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9105,9108],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'sgkInfo' is assigned a value but never used.","line":293,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":293,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":303,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9455,9458],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9455,9458],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":303,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9474,9477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9474,9477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":313,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":313,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9731,9734],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9731,9734],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":317,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":317,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9941,9944],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9941,9944],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from '@x-ear/ui-web';\nimport React, { useState, useEffect } from 'react';\nimport { DynamicInvoiceForm } from '../forms/DynamicInvoiceForm';\nimport { InvoiceFormData, InvoiceFormValidationResult } from '../../types/invoice-schema';\nimport { InvoiceService } from '../../services/invoice.service';\nimport { CreateInvoiceData, Invoice } from '../../types/invoice';\nimport { InvoicePreviewModal } from './InvoicePreviewModal';\n\ninterface InvoiceModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: (invoice: any) => void;\n  onError?: (error: string) => void;\n  initialData?: Partial<InvoiceFormData>;\n  patientId?: string;\n  deviceId?: string;\n  mode?: 'create' | 'quick' | 'template';\n  title?: string;\n}\n\nexport const InvoiceModal: React.FC<InvoiceModalProps> = ({\n  isOpen,\n  onClose,\n  onSuccess,\n  onError,\n  initialData,\n  patientId,\n  deviceId,\n  mode = 'create',\n  title\n}) => {\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [validationResult, setValidationResult] = useState<InvoiceFormValidationResult | null>(null);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [createdInvoice, setCreatedInvoice] = useState<Invoice | null>(null);\n  const [showPreview, setShowPreview] = useState(false);\n  const [isGeneratingPdf, setIsGeneratingPdf] = useState(false);\n  const [currentFormData, setCurrentFormData] = useState<InvoiceFormData | null>(null);\n\n  // Reset state when modal opens/closes\n  useEffect(() => {\n    if (isOpen) {\n      setIsSubmitting(false);\n      setValidationResult(null);\n      setSubmitError(null);\n      setCreatedInvoice(null);\n      setShowPreview(false);\n      setIsGeneratingPdf(false);\n      setCurrentFormData(null);\n    }\n  }, [isOpen]);\n\n  // Handle form submission\n  const handleSubmit = async (formData: InvoiceFormData) => {\n    if (!validationResult?.isValid) {\n      setSubmitError('Lütfen form hatalarını düzeltin');\n      return;\n    }\n\n    setIsSubmitting(true);\n    setSubmitError(null);\n\n    try {\n      // Convert form data to invoice creation data\n      const invoiceData = convertFormDataToInvoiceData(formData);\n      \n      // Add patient and device IDs if provided\n      if (patientId) {\n        invoiceData.patientId = patientId;\n      }\n      if (deviceId) {\n        invoiceData.deviceId = deviceId;\n      }\n\n      // Create invoice using service\n      const invoiceService = new InvoiceService();\n      const createdInvoice = await invoiceService.createInvoice(invoiceData);\n      \n      setCreatedInvoice(createdInvoice);\n\n      // Success callback\n      if (onSuccess) {\n        onSuccess(createdInvoice);\n      }\n\n      // Close modal\n      onClose();\n\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Fatura oluşturulurken bir hata oluştu';\n      setSubmitError(errorMessage);\n      \n      if (onError) {\n        onError(errorMessage);\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Handle preview\n  const handlePreview = async () => {\n    if (!validationResult?.isValid || !currentFormData) {\n      setSubmitError('Lütfen form hatalarını düzeltin');\n      return;\n    }\n\n    setIsSubmitting(true);\n    setSubmitError(null);\n\n    try {\n      // Convert form data to invoice creation data\n      const invoiceData = convertFormDataToInvoiceData(currentFormData);\n      \n      // Add patient and device IDs if provided\n      if (patientId) {\n        invoiceData.patientId = patientId;\n      }\n      if (deviceId) {\n        invoiceData.deviceId = deviceId;\n      }\n\n      // Create invoice using service\n      const invoiceService = new InvoiceService();\n      const createdInvoice = await invoiceService.createInvoice(invoiceData);\n      \n      setCreatedInvoice(createdInvoice);\n      setShowPreview(true);\n\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Fatura oluşturulurken bir hata oluştu';\n      setSubmitError(errorMessage);\n      \n      if (onError) {\n        onError(errorMessage);\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Handle PDF generation and download\n  const handleGeneratePdf = async () => {\n    if (!createdInvoice) {\n      setSubmitError('Önce fatura oluşturulmalı');\n      return;\n    }\n\n    setIsGeneratingPdf(true);\n    try {\n      const invoiceService = new InvoiceService();\n      const result = await invoiceService.generateInvoicePdf(createdInvoice.id);\n      \n      if (result.success && result.data) {\n        const filename = `fatura-${createdInvoice.invoiceNumber}.pdf`;\n        invoiceService.downloadPdfBlob(result.data, filename);\n      } else {\n        const errorMessage = result.error || 'PDF oluşturulamadı';\n        setSubmitError(errorMessage);\n        if (onError) {\n          onError(errorMessage);\n        }\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'PDF oluşturulurken bir hata oluştu';\n      setSubmitError(errorMessage);\n      if (onError) {\n        onError(errorMessage);\n      }\n    } finally {\n      setIsGeneratingPdf(false);\n    }\n  };\n\n  // Handle print\n  const handlePrint = async () => {\n    if (!createdInvoice) {\n      setSubmitError('Önce fatura oluşturulmalı');\n      return;\n    }\n\n    try {\n      const invoiceService = new InvoiceService();\n      const result = await invoiceService.generateInvoicePdf(createdInvoice.id);\n      \n      if (result.success && result.data) {\n        // Open PDF in new window for printing\n        const pdfUrl = window.URL.createObjectURL(result.data);\n        const printWindow = window.open(pdfUrl, '_blank');\n        if (printWindow) {\n          printWindow.onload = () => {\n            printWindow.print();\n            window.URL.revokeObjectURL(pdfUrl);\n          };\n        }\n      } else {\n        const errorMessage = result.error || 'PDF oluşturulamadı';\n        setSubmitError(errorMessage);\n        if (onError) {\n          onError(errorMessage);\n        }\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Yazdırma sırasında bir hata oluştu';\n      setSubmitError(errorMessage);\n      if (onError) {\n        onError(errorMessage);\n      }\n    }\n  };\n\n  // Handle preview modal close\n  const handlePreviewClose = () => {\n    setShowPreview(false);\n    // Success callback when preview is closed\n    if (onSuccess && createdInvoice) {\n      onSuccess(createdInvoice);\n    }\n    onClose();\n  };\n\n  // Convert form data to invoice creation data\n  const convertFormDataToInvoiceData = (formData: InvoiceFormData): CreateInvoiceData => {\n    const { invoiceType, scenario, items, ...sections } = formData;\n\n    // Extract customer/company info based on invoice type\n    let customerInfo: any = {};\n    let deviceInfo: any = {};\n    if (invoiceType === 'individual' && sections.customer_info) {\n      const customerData = sections.customer_info as any;\n      customerInfo = {\n        type: 'individual',\n        firstName: customerData.first_name || '',\n        lastName: customerData.last_name || '',\n        tcNumber: customerData.tc_number || '',\n        email: customerData.email || '',\n        phone: customerData.phone || '',\n        address: {\n          street: customerData.address || '',\n          city: customerData.city || '',\n          postalCode: customerData.postal_code || ''\n        }\n      };\n    } else if (invoiceType === 'corporate' && sections.company_info) {\n      const companyData = sections.company_info as any;\n      customerInfo = {\n        type: 'corporate',\n        companyName: companyData.company_name || '',\n        taxNumber: companyData.tax_number || '',\n        taxOffice: companyData.tax_office || '',\n        contactPerson: companyData.contact_person || '',\n        email: companyData.email || '',\n        phone: companyData.phone || '',\n        address: {\n          street: companyData.address || '',\n          city: companyData.city || '',\n          postalCode: companyData.postal_code || ''\n        }\n      };\n    } else if (invoiceType === 'export' && sections.export_info) {\n      const exportData = sections.export_info as any;\n      customerInfo = {\n        type: 'export',\n        companyName: exportData.company_name || '',\n        country: exportData.country || '',\n        currency: exportData.currency || 'USD',\n        exchangeRate: exportData.exchange_rate || 1,\n        address: {\n          street: exportData.address || ''\n        }\n      };\n    }\n\n    // Extract invoice details\n    const invoiceDetails = sections.invoice_details as any || {};\n\n    // Extract device information\n    if (sections.device_info) {\n      const deviceData = sections.device_info as any;\n      deviceInfo = {\n        brand: deviceData.device_brand || '',\n        model: deviceData.device_model || '',\n        serial: deviceData.device_serial || '',\n        side: deviceData.device_side || '',\n        warrantyPeriod: deviceData.warranty_period || 0\n      };\n    }\n\n    // Extract SGK information\n    let sgkInfo: any = {};\n    if (sections.sgk_info) {\n      const sgkData = sections.sgk_info as any;\n      sgkInfo = {\n        hasCoverage: sgkData.has_sgk_coverage || false,\n        approvalNumber: sgkData.approval_number || '',\n        reportDate: sgkData.report_date || '',\n        doctorName: sgkData.doctor_name || '',\n        hospitalName: sgkData.hospital_name || ''\n      };\n    }\n\n    // Convert items\n    const invoiceItems = (items as any[])?.map((item: any) => ({\n      name: item.description || '',\n      description: item.description,\n      quantity: item.quantity,\n      unitPrice: item.unitPrice,\n      taxRate: item.taxRate,\n      total: item.total\n    })) || [];\n\n    return {\n      type: invoiceType as any,\n      status: 'draft',\n      issueDate: invoiceDetails.invoice_date || new Date().toISOString().split('T')[0],\n      dueDate: invoiceDetails.due_date,\n      paymentMethod: invoiceDetails.payment_method as any,\n      notes: invoiceDetails.notes,\n      customerName: customerInfo.firstName ? `${customerInfo.firstName} ${customerInfo.lastName || ''}`.trim() : customerInfo.companyName,\n      customerTaxNumber: customerInfo.taxNumber,\n      customerAddress: customerInfo.address,\n      items: invoiceItems\n    };\n  };\n\n  // Handle validation changes\n  const handleValidationChange = (result: InvoiceFormValidationResult) => {\n    setValidationResult(result);\n  };\n\n  // Handle form data changes\n  const handleFormDataChange = (formData: InvoiceFormData) => {\n    setCurrentFormData(formData);\n  };\n\n  // Handle modal close\n  const handleClose = () => {\n    onClose();\n  };\n\n  // Determine modal title\n  const getModalTitle = () => {\n    if (title) return title;\n    \n    switch (mode) {\n      case 'quick':\n        return 'Hızlı Fatura Oluştur';\n      case 'template':\n        return 'Şablondan Fatura Oluştur';\n      default:\n        return 'Yeni Fatura Oluştur';\n    }\n  };\n\n  // Handle backdrop click\n  const handleBackdropClick = (e: React.MouseEvent) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <>\n    <div \n      className=\"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center p-4\"\n      onClick={handleBackdropClick}\n    >\n      <div \n        className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Modal Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">\n            {getModalTitle()}\n          </h2>\n          <Button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-md p-1\"\n            variant='default'>\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </Button>\n        </div>\n\n        {/* Modal Body */}\n        <div className=\"flex-1 overflow-y-auto p-6\">\n          {submitError && (\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-md\">\n              <div className=\"flex\">\n                <div className=\"flex-shrink-0\">\n                  <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                  </svg>\n                </div>\n                <div className=\"ml-3\">\n                  <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n                  <div className=\"mt-2 text-sm text-red-700\">\n                    {submitError}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <DynamicInvoiceForm\n            onSubmit={handleSubmit}\n            onValidationChange={handleValidationChange}\n            onFormDataChange={handleFormDataChange}\n            initialData={initialData}\n            disabled={isSubmitting}\n          />\n        </div>\n\n        {/* Modal Footer */}\n        <div className=\"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50\">\n          <div className=\"flex items-center space-x-4\">\n            {validationResult && !validationResult.isValid && (\n              <div className=\"text-sm text-red-600\">\n                {validationResult.errors.length} hata bulundu\n              </div>\n            )}\n            {validationResult?.isValid && (\n              <div className=\"text-sm text-green-600 flex items-center\">\n                <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                </svg>\n                Form geçerli\n              </div>\n            )}\n          </div>\n\n          <div className=\"flex items-center space-x-3\">\n            <Button\n              type=\"button\"\n              onClick={handleClose}\n              disabled={isSubmitting}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50\"\n              variant='default'>\n              İptal\n            </Button>\n            \n            {/* Preview Button */}\n            <Button\n              type=\"button\"\n              onClick={handlePreview}\n              disabled={isSubmitting || !validationResult?.isValid}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center\"\n              variant='default'>\n              {isSubmitting ? (\n                <>\n                  <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-gray-600\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                  </svg>\n                  Hazırlanıyor...\n                </>\n              ) : (\n                <>\n                  <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                  </svg>\n                  Önizle\n                </>\n              )}\n            </Button>\n\n            {/* Create and Download PDF Button */}\n            {createdInvoice && (\n              <Button\n                type=\"button\"\n                onClick={handleGeneratePdf}\n                disabled={isGeneratingPdf}\n                className=\"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center\"\n                variant='default'>\n                {isGeneratingPdf ? (\n                  <>\n                    <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                    </svg>\n                    PDF Oluşturuluyor...\n                  </>\n                ) : (\n                  <>\n                    <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                    </svg>\n                    PDF İndir\n                  </>\n                )}\n              </Button>\n            )}\n\n            {/* Print Button */}\n            {createdInvoice && (\n              <Button\n                type=\"button\"\n                onClick={handlePrint}\n                className=\"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 flex items-center\"\n                variant='default'>\n                <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z\" />\n                </svg>\n                Yazdır\n              </Button>\n            )}\n\n            <Button\n              type=\"submit\"\n              form=\"invoice-form\"\n              disabled={isSubmitting || !validationResult?.isValid}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center\"\n              variant='default'>\n              {isSubmitting ? (\n                <>\n                  <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                  </svg>\n                  Oluşturuluyor...\n                </>\n              ) : (\n                'Fatura Oluştur'\n              )}\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    {/* Invoice Preview Modal */}\n    <InvoicePreviewModal\n      isOpen={showPreview}\n      onClose={handlePreviewClose}\n      invoice={createdInvoice}\n      onError={onError}\n    />\n    </>\n  );\n};\n\n// Quick Invoice Modal - Simplified version for quick invoice creation\nexport const QuickInvoiceModal: React.FC<Omit<InvoiceModalProps, 'mode'>> = (props) => {\n  return <InvoiceModal {...props} mode=\"quick\" title=\"Hızlı Fatura Oluştur\" />;\n};\n\n// Template Invoice Modal - For creating invoices from templates\nexport const TemplateInvoiceModal: React.FC<Omit<InvoiceModalProps, 'mode'>> = (props) => {\n  return <InvoiceModal {...props} mode=\"template\" title=\"Şablondan Fatura Oluştur\" />;\n};\n\n// Device Invoice Modal - For creating invoices for device sales\ninterface DeviceInvoiceModalProps extends Omit<InvoiceModalProps, 'initialData'> {\n  deviceInfo: {\n    id: string;\n    name: string;\n    serial: string;\n    price: number;\n    brand?: string;\n    model?: string;\n  };\n  patientInfo?: {\n    id: string;\n    name: string;\n    tcNumber?: string;\n    phone?: string;\n    email?: string;\n  };\n}\n\nexport const DeviceInvoiceModal: React.FC<DeviceInvoiceModalProps> = ({\n  deviceInfo,\n  patientInfo,\n  ...props\n}) => {\n  // Prepare initial data with device and patient information\n  const initialData: Partial<InvoiceFormData> = {\n    invoiceType: 'device',\n    scenario: 'device_sale',\n    device_info: {\n      device_brand: deviceInfo.brand || '',\n      device_model: deviceInfo.model || '',\n      device_serial: deviceInfo.serial,\n      device_price: deviceInfo.price\n    },\n    customer_info: patientInfo ? {\n      first_name: patientInfo.name.split(' ')[0] || '',\n      last_name: patientInfo.name.split(' ').slice(1).join(' ') || '',\n      tc_number: patientInfo.tcNumber || '',\n      phone: patientInfo.phone || '',\n      email: patientInfo.email || ''\n    } : {},\n    items: [{\n      description: deviceInfo.name,\n      quantity: 1,\n      unitPrice: deviceInfo.price,\n      taxRate: 18, // Default KDV rate\n      total: deviceInfo.price * 1.18\n    }]\n  };\n\n  return (\n    <InvoiceModal \n      {...props} \n      mode=\"create\" \n      title=\"Cihaz Satış Faturası\" \n      initialData={initialData}\n    />\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/modals/InvoicePreviewModal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'generatePdf'. Either include it or remove the dependency array.","line":41,"column":6,"nodeType":"ArrayExpression","endLine":41,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, invoice, generatePdf]","fix":{"range":[1053,1070],"text":"[isOpen, invoice, generatePdf]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from '@x-ear/ui-web';\nimport React, { useState, useEffect } from 'react';\nimport { Invoice } from '../../types/invoice';\nimport { invoiceService } from '../../services/invoice.service';\n\ninterface InvoicePreviewModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  invoice: Invoice | null;\n  onPrint?: () => void;\n  onDownload?: () => void;\n  onError?: (error: string) => void;\n}\n\nexport const InvoicePreviewModal: React.FC<InvoicePreviewModalProps> = ({\n  isOpen,\n  onClose,\n  invoice,\n  onPrint,\n  onDownload,\n  onError\n}) => {\n  const [isGeneratingPdf, setIsGeneratingPdf] = useState(false);\n  const [pdfBlob, setPdfBlob] = useState<Blob | null>(null);\n  const [pdfUrl, setPdfUrl] = useState<string | null>(null);\n\n  // Clean up PDF URL when modal closes or invoice changes\n  useEffect(() => {\n    return () => {\n      if (pdfUrl) {\n        window.URL.revokeObjectURL(pdfUrl);\n      }\n    };\n  }, [pdfUrl]);\n\n  // Generate PDF when invoice changes\n  useEffect(() => {\n    if (isOpen && invoice) {\n      generatePdf();\n    }\n  }, [isOpen, invoice]);\n\n  const generatePdf = async () => {\n    if (!invoice) return;\n\n    setIsGeneratingPdf(true);\n    try {\n      const result = await invoiceService.generateInvoicePdf(invoice.id);\n      \n      if (result.success && result.data) {\n        setPdfBlob(result.data);\n        const url = window.URL.createObjectURL(result.data);\n        setPdfUrl(url);\n      } else {\n        const errorMessage = result.error || 'PDF oluşturulamadı';\n        if (onError) {\n          onError(errorMessage);\n        }\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'PDF oluşturulurken bir hata oluştu';\n      if (onError) {\n        onError(errorMessage);\n      }\n    } finally {\n      setIsGeneratingPdf(false);\n    }\n  };\n\n  const handlePrint = () => {\n    if (pdfUrl) {\n      // Open PDF in new window for printing\n      const printWindow = window.open(pdfUrl, '_blank');\n      if (printWindow) {\n        printWindow.onload = () => {\n          printWindow.print();\n        };\n      }\n    }\n    if (onPrint) {\n      onPrint();\n    }\n  };\n\n  const handleDownload = () => {\n    if (pdfBlob && invoice) {\n      const filename = `fatura-${invoice.invoiceNumber}.pdf`;\n      invoiceService.downloadPdfBlob(pdfBlob, filename);\n    }\n    if (onDownload) {\n      onDownload();\n    }\n  };\n\n  const handlePreview = () => {\n    if (pdfBlob) {\n      invoiceService.previewPdfBlob(pdfBlob);\n    }\n  };\n\n  // Handle backdrop click\n  const handleBackdropClick = (e: React.MouseEvent) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  if (!isOpen || !invoice) return null;\n\n  return (\n    <div \n      className=\"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center p-4\"\n      onClick={handleBackdropClick}\n    >\n      <div \n        className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Modal Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n          <div>\n            <h2 className=\"text-xl font-semibold text-gray-900\">\n              Fatura Önizleme\n            </h2>\n            <p className=\"text-sm text-gray-600 mt-1\">\n              {invoice.invoiceNumber} - {invoice.customerName}\n            </p>\n          </div>\n          <Button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-md p-1\"\n            variant='default'>\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </Button>\n        </div>\n\n        {/* Modal Body */}\n        <div className=\"flex-1 overflow-hidden flex flex-col\">\n          {isGeneratingPdf ? (\n            <div className=\"flex-1 flex items-center justify-center\">\n              <div className=\"text-center\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n                <p className=\"text-gray-600\">PDF oluşturuluyor...</p>\n              </div>\n            </div>\n          ) : pdfUrl ? (\n            <div className=\"flex-1 p-4\">\n              <iframe\n                src={pdfUrl}\n                className=\"w-full h-full border border-gray-300 rounded-lg\"\n                title=\"Fatura Önizleme\"\n              />\n            </div>\n          ) : (\n            <div className=\"flex-1 flex items-center justify-center\">\n              <div className=\"text-center\">\n                <svg className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                </svg>\n                <p className=\"text-gray-600 mb-4\">PDF önizleme yüklenemedi</p>\n                <Button\n                  onClick={generatePdf}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n                  variant='default'>\n                  Tekrar Dene\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Modal Footer */}\n        <div className=\"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50\">\n          <div className=\"flex items-center space-x-2 text-sm text-gray-600\">\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n            <span>Fatura: {invoice.invoiceNumber}</span>\n            <span>•</span>\n            <span>Tutar: {(invoice.totalAmount ?? 0).toLocaleString('tr-TR')} {invoice.currency}</span>\n          </div>\n\n          <div className=\"flex items-center space-x-3\">\n            <Button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              variant='default'>\n              Kapat\n            </Button>\n            \n            {pdfBlob && (\n              <>\n                <Button\n                  type=\"button\"\n                  onClick={handlePreview}\n                  className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  variant='default'>\n                  Yeni Sekmede Aç\n                </Button>\n                \n                <Button\n                  type=\"button\"\n                  onClick={handleDownload}\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500\"\n                  variant='default'>\n                  <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                  </svg>\n                  İndir\n                </Button>\n                \n                <Button\n                  type=\"button\"\n                  onClick={handlePrint}\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  variant='default'>\n                  <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z\" />\n                  </svg>\n                  Yazdır\n                </Button>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/modals/PromissoryNotesModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":5,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[653,656],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[653,656],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[778,781],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[778,781],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onCreateNote' is defined but never used.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'showCreateForm' is assigned a value but never used.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPromissoryNotes'. Either include it or remove the dependency array.","line":47,"column":6,"nodeType":"ArrayExpression","endLine":47,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPromissoryNotes, isOpen, sale?.id]","fix":{"range":[1461,1479],"text":"[fetchPromissoryNotes, isOpen, sale?.id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1810,1813],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1810,1813],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":219,"column":31,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":227,"endColumn":33},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":233,"column":31,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":241,"endColumn":40}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Modal } from '../ui/Modal';\nimport { Button } from '../ui/Button';\nimport { LoadingSkeleton } from '../common/LoadingSkeleton';\nimport { Banknote, Calendar, DollarSign, CheckCircle, Clock, AlertCircle, Plus } from 'lucide-react';\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/api';\n\ninterface PromissoryNote {\n  id: string;\n  amount: number;\n  paidAmount: number;\n  dueDate: string;\n  status: 'pending' | 'paid' | 'partial' | 'overdue';\n  referenceNumber?: string;\n  notes?: string;\n}\n\ninterface PromissoryNotesModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  sale: any;\n  onCollectNote?: (noteId: string, amount: number, paymentMethod: string) => Promise<void>;\n  onCreateNote?: (noteData: any) => Promise<void>;\n}\n\nexport const PromissoryNotesModal: React.FC<PromissoryNotesModalProps> = ({\n  isOpen,\n  onClose,\n  sale,\n  onCollectNote,\n  onCreateNote\n}) => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [notes, setNotes] = useState<PromissoryNote[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [collectingNoteId, setCollectingNoteId] = useState<string | null>(null);\n  const [collectionData, setCollectionData] = useState({\n    amount: 0,\n    paymentMethod: 'cash'\n  });\n\n  useEffect(() => {\n    if (isOpen && sale?.id) {\n      fetchPromissoryNotes();\n    }\n  }, [isOpen, sale?.id]);\n\n  const fetchPromissoryNotes = async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.paymentsGetSalePromissoryNotes(sale.id);\n      // API response type is void, so we'll handle the actual data structure\n      setNotes((response as any)?.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Bir hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'paid': return 'bg-green-100 text-green-800';\n      case 'partial': return 'bg-yellow-100 text-yellow-800';\n      case 'overdue': return 'bg-red-100 text-red-800';\n      default: return 'bg-blue-100 text-blue-800';\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'paid': return 'Ödendi';\n      case 'partial': return 'Kısmi';\n      case 'overdue': return 'Gecikmiş';\n      default: return 'Bekliyor';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'paid': return <CheckCircle className=\"w-4 h-4\" />;\n      case 'overdue': return <AlertCircle className=\"w-4 h-4\" />;\n      default: return <Clock className=\"w-4 h-4\" />;\n    }\n  };\n\n  const handleCollectNote = async (noteId: string) => {\n    if (collectionData.amount <= 0) {\n      setError('Geçerli bir tutar giriniz');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      await onCollectNote?.(noteId, collectionData.amount, collectionData.paymentMethod);\n      setCollectingNoteId(null);\n      setCollectionData({ amount: 0, paymentMethod: 'cash' });\n      await fetchPromissoryNotes(); // Refresh notes\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Ödeme kaydedilemedi');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const startCollection = (note: PromissoryNote) => {\n    setCollectingNoteId(note.id);\n    setCollectionData({\n      amount: note.amount - note.paidAmount,\n      paymentMethod: 'cash'\n    });\n    setError(null);\n  };\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      title=\"Senet Yönetimi\"\n    >\n      <div className=\"space-y-6\">\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n            <p className=\"text-red-800\">{error}</p>\n          </div>\n        )}\n\n        {/* Sale Summary */}\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n          <h3 className=\"font-medium text-blue-900 mb-2\">Satış Bilgileri</h3>\n          <div className=\"space-y-1 text-sm text-blue-800\">\n            <p><strong>Satış ID:</strong> {sale?.id}</p>\n            <p><strong>Toplam Tutar:</strong> {formatCurrency(sale?.totalAmount || 0)}</p>\n            <p><strong>Kalan Tutar:</strong> {formatCurrency(sale?.remainingAmount || 0)}</p>\n          </div>\n        </div>\n\n        {/* Notes List */}\n        <div className=\"space-y-4\">\n          <div className=\"flex justify-between items-center\">\n            <h3 className=\"font-medium text-gray-900\">Senetler</h3>\n            <Button\n              variant=\"secondary\"\n              onClick={() => setShowCreateForm(true)}\n              className=\"text-sm\"\n            >\n              <Plus className=\"w-4 h-4 mr-1\" />\n              Yeni Senet\n            </Button>\n          </div>\n\n          {isLoading ? (\n            <LoadingSkeleton lines={3} />\n          ) : notes.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <Banknote className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n              <p className=\"text-gray-600\">Henüz senet bulunmuyor</p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {notes.map((note) => (\n                <div key={note.id} className=\"border border-gray-200 rounded-lg p-4\">\n                  <div className=\"flex justify-between items-start mb-3\">\n                    <div className=\"flex items-center\">\n                      {getStatusIcon(note.status)}\n                      <span className=\"ml-2 font-medium\">\n                        Senet #{note.referenceNumber || note.id.slice(-6)}\n                      </span>\n                    </div>\n                    <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(note.status)}`}>\n                      {getStatusText(note.status)}\n                    </span>\n                  </div>\n\n                  <div className=\"grid grid-cols-2 gap-4 text-sm mb-3\">\n                    <div>\n                      <span className=\"text-gray-600\">Tutar:</span>\n                      <span className=\"ml-2 font-medium\">{formatCurrency(note.amount)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-600\">Vade:</span>\n                      <span className=\"ml-2\">{formatDate(note.dueDate)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-600\">Ödenen:</span>\n                      <span className=\"ml-2 text-green-600\">{formatCurrency(note.paidAmount)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-600\">Kalan:</span>\n                      <span className=\"ml-2 text-red-600\">{formatCurrency(note.amount - note.paidAmount)}</span>\n                    </div>\n                  </div>\n\n                  {note.status !== 'paid' && (\n                    <div className=\"border-t pt-3\">\n                      {collectingNoteId === note.id ? (\n                        <div className=\"space-y-3\">\n                          <div className=\"grid grid-cols-2 gap-3\">\n                            <div>\n                              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                                Tahsilat Tutarı\n                              </label>\n                              <input\n                                type=\"number\"\n                                step=\"0.01\"\n                                min=\"0\"\n                                max={note.amount - note.paidAmount}\n                                value={collectionData.amount}\n                                onChange={(e) => setCollectionData(prev => ({ ...prev, amount: parseFloat(e.target.value) || 0 }))}\n                                className=\"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                              />\n                            </div>\n                            <div>\n                              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                                Ödeme Yöntemi\n                              </label>\n                              <select\n                                value={collectionData.paymentMethod}\n                                onChange={(e) => setCollectionData(prev => ({ ...prev, paymentMethod: e.target.value }))}\n                                className=\"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\n                              >\n                                <option value=\"cash\">Nakit</option>\n                                <option value=\"card\">Kart</option>\n                                <option value=\"transfer\">Havale</option>\n                              </select>\n                            </div>\n                          </div>\n                          <div className=\"flex space-x-2\">\n                            <Button\n                              onClick={() => handleCollectNote(note.id)}\n                              disabled={isLoading || collectionData.amount <= 0}\n                              className=\"text-sm px-3 py-1\"\n                            >\n                              {isLoading ? 'Kaydediliyor...' : 'Tahsil Et'}\n                            </Button>\n                            <Button\n                              variant=\"secondary\"\n                              onClick={() => setCollectingNoteId(null)}\n                              className=\"text-sm px-3 py-1\"\n                            >\n                              İptal\n                            </Button>\n                          </div>\n                        </div>\n                      ) : (\n                        <Button\n                          variant=\"secondary\"\n                          onClick={() => startCollection(note)}\n                          className=\"text-sm\"\n                        >\n                          <DollarSign className=\"w-3 h-3 mr-1\" />\n                          Tahsil Et\n                        </Button>\n                      )}\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex justify-end pt-4 border-t\">\n          <Button variant=\"secondary\" onClick={onClose}>\n            Kapat\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/DeviceEditModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Percent' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AlertCircle' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'X' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":4},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Plus' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Minus' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":8},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[700,703],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[700,703],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setSgkAmounts' is assigned a value but never used.","line":59,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'calculateRemainingAmount' is assigned a value but never used.","line":197,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":197,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":205,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":205,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5867,5870],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5867,5870],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":325,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":331,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":384,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":397,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":413,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":424,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":438,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":445,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":454,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":467,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":484,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":495,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":508,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":513,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":531,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":539,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":550,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":558,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":571,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":579,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":590,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":597,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":619,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":631,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":644,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":650,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":656,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":662,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":663,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":668,"endColumn":20}],"suppressedMessages":[],"errorCount":24,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { PatientDevice } from '../../types/patient';\nimport { Modal } from '../ui/Modal';\nimport {\n  Search,\n  Calendar,\n  DollarSign,\n  CreditCard,\n  Percent,\n  Calculator,\n  Clock,\n  FileText,\n  AlertCircle,\n  CheckCircle,\n  X,\n  Plus,\n  Minus\n} from 'lucide-react';\n\ninterface DeviceEditModalProps {\n  open: boolean;\n  device: PatientDevice | null;\n  onClose: () => void;\n  onSave: (device: PatientDevice) => void;\n}\n\ninterface DeviceInventoryItem {\n  id: string;\n  brand: string;\n  model: string;\n  type: 'hearing_aid' | 'cochlear_implant' | 'bone_anchored';\n  listPrice: number;\n  availableSerials: string[];\n  specifications?: Record<string, any>;\n}\n\ninterface ExtendedFormData extends Partial<PatientDevice> {\n  discountValue?: number;\n  discountType?: 'amount' | 'percentage';\n  downPayment?: number;\n}\n\nexport const DeviceEditModal: React.FC<DeviceEditModalProps> = ({\n  open,\n  device,\n  onClose,\n  onSave\n}) => {\n  // Form state\n  const [formData, setFormData] = useState<ExtendedFormData>({});\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  \n  // Device selection and inventory\n  const [availableDevices, setAvailableDevices] = useState<DeviceInventoryItem[]>([]);\n  const [deviceSearch, setDeviceSearch] = useState('');\n  const [selectedDevice, setSelectedDevice] = useState<DeviceInventoryItem | null>(null);\n  \n  // SGK and pricing\n  const [sgkAmounts, setSgkAmounts] = useState({\n    hearingAid: 2500,\n    cochlearImplant: 15000,\n    boneAnchored: 8000\n  });\n  \n  // Mock device inventory\n  useEffect(() => {\n    const mockDevices: DeviceInventoryItem[] = [\n      {\n        id: '1',\n        brand: 'Phonak',\n        model: 'Audéo Paradise P90',\n        type: 'hearing_aid',\n        listPrice: 12000,\n        availableSerials: ['PH001', 'PH002', 'PH003', 'PH004']\n      },\n      {\n        id: '2',\n        brand: 'Oticon',\n        model: 'More 1',\n        type: 'hearing_aid',\n        listPrice: 11500,\n        availableSerials: ['OT001', 'OT002', 'OT003']\n      },\n      {\n        id: '3',\n        brand: 'Cochlear',\n        model: 'Nucleus 8',\n        type: 'cochlear_implant',\n        listPrice: 45000,\n        availableSerials: ['CO001', 'CO002']\n      },\n      {\n        id: '4',\n        brand: 'Baha',\n        model: 'Attract System',\n        type: 'bone_anchored',\n        listPrice: 25000,\n        availableSerials: ['BA001', 'BA002']\n      }\n    ];\n    setAvailableDevices(mockDevices);\n  }, []);\n\n  // Initialize form data when device changes\n  useEffect(() => {\n    if (device) {\n      setFormData({\n        ...device,\n        // Ensure all required fields have default values\n        ear: device.ear || device.side || 'left',\n        reason: device.reason || 'new',\n        status: device.status || 'assigned',\n        assignedDate: device.assignedDate || new Date().toISOString().split('T')[0],\n        listPrice: device.listPrice || device.price || 0,\n        salePrice: device.salePrice || device.price || 0,\n        sgkReduction: device.sgkReduction || 0,\n        patientPayment: device.patientPayment || 0,\n        paymentMethod: device.paymentMethod || 'cash',\n        discountValue: 0,\n        discountType: 'amount',\n        downPayment: 0\n      });\n      \n      // Find and set the selected device\n      const foundDevice = availableDevices.find(d => \n        d.brand === device.brand && d.model === device.model\n      );\n      if (foundDevice) {\n        setSelectedDevice(foundDevice);\n      }\n    } else {\n      // Reset form for new device\n      setFormData({\n        id: `device_${Date.now()}`,\n        brand: '',\n        model: '',\n        serialNumber: '',\n        ear: 'left',\n        type: 'hearing_aid',\n        status: 'assigned',\n        assignedDate: new Date().toISOString().split('T')[0],\n        reason: 'new',\n        listPrice: 0,\n        salePrice: 0,\n        sgkReduction: 0,\n        patientPayment: 0,\n        paymentMethod: 'cash',\n        notes: '',\n        discountValue: 0,\n        discountType: 'amount',\n        downPayment: 0\n      });\n      setSelectedDevice(null);\n    }\n    setErrors({});\n  }, [device, open, availableDevices]);\n\n  const filteredDevices = availableDevices.filter(device =>\n    `${device.brand} ${device.model}`.toLowerCase().includes(deviceSearch.toLowerCase())\n  );\n\n  const handleDeviceSelect = (device: DeviceInventoryItem) => {\n    setSelectedDevice(device);\n    setFormData(prev => ({\n      ...prev,\n      brand: device.brand,\n      model: device.model,\n      type: device.type,\n      listPrice: device.listPrice,\n      salePrice: device.listPrice,\n      serialNumber: '', // Reset serial number when device changes\n    }));\n    \n    // Auto-calculate SGK reduction based on device type\n    const sgkAmount = sgkAmounts[device.type === 'hearing_aid' ? 'hearingAid' : \n                                device.type === 'cochlear_implant' ? 'cochlearImplant' : 'boneAnchored'];\n    \n    setFormData(prev => ({\n      ...prev,\n      sgkReduction: Math.min(sgkAmount, device.listPrice),\n      patientPayment: Math.max(0, device.listPrice - Math.min(sgkAmount, device.listPrice))\n    }));\n  };\n\n  const calculateSalePrice = () => {\n    const listPrice = formData.listPrice || 0;\n    const discountValue = formData.discountValue || 0;\n    const discountType = formData.discountType || 'amount';\n    \n    if (discountType === 'percentage') {\n      return listPrice * (1 - discountValue / 100);\n    } else {\n      return listPrice - discountValue;\n    }\n  };\n\n  const calculateRemainingAmount = () => {\n    const salePrice = formData.salePrice || calculateSalePrice();\n    const sgkReduction = formData.sgkReduction || 0;\n    const downPayment = formData.downPayment || 0;\n    \n    return Math.max(0, salePrice - sgkReduction - downPayment);\n  };\n\n  const handleInputChange = (field: keyof ExtendedFormData, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    \n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n    \n    // Auto-calculate dependent fields\n    if (field === 'listPrice' || field === 'discountValue' || field === 'discountType') {\n      const newSalePrice = calculateSalePrice();\n      setFormData(prev => ({\n        ...prev,\n        salePrice: newSalePrice,\n        patientPayment: Math.max(0, newSalePrice - (prev.sgkReduction || 0))\n      }));\n    }\n    \n    if (field === 'sgkReduction') {\n      const salePrice = formData.salePrice || calculateSalePrice();\n      setFormData(prev => ({\n        ...prev,\n        patientPayment: Math.max(0, salePrice - (value || 0))\n      }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.brand) newErrors.brand = 'Marka seçimi zorunludur';\n    if (!formData.model) newErrors.model = 'Model seçimi zorunludur';\n    if (!formData.serialNumber) newErrors.serialNumber = 'Seri numarası zorunludur';\n    if (!formData.ear) newErrors.ear = 'Kulak seçimi zorunludur';\n    if (!formData.assignedDate) newErrors.assignedDate = 'Atama tarihi zorunludur';\n    if (!formData.reason) newErrors.reason = 'Atama sebebi zorunludur';\n    \n    // Validate pricing\n    if ((formData.listPrice || 0) <= 0) {\n      newErrors.listPrice = 'Liste fiyatı 0\\'dan büyük olmalıdır';\n    }\n    \n    if ((formData.salePrice || 0) > (formData.listPrice || 0)) {\n      newErrors.salePrice = 'Satış fiyatı liste fiyatından büyük olamaz';\n    }\n    \n    if ((formData.sgkReduction || 0) > (formData.salePrice || 0)) {\n      newErrors.sgkReduction = 'SGK katkısı satış fiyatından büyük olamaz';\n    }\n    \n    // Validate serial number availability\n    if (selectedDevice && formData.serialNumber) {\n      const isSerialAvailable = selectedDevice.availableSerials.includes(formData.serialNumber);\n      const isCurrentSerial = device?.serialNumber === formData.serialNumber;\n      \n      if (!isSerialAvailable && !isCurrentSerial) {\n        newErrors.serialNumber = 'Bu seri numarası mevcut değil';\n      }\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    const deviceData: PatientDevice = {\n      id: formData.id || `device_${Date.now()}`,\n      brand: formData.brand!,\n      model: formData.model!,\n      serialNumber: formData.serialNumber!,\n      side: formData.ear as 'left' | 'right' | 'both',\n      ear: formData.ear,\n      type: formData.type!,\n      status: formData.status!,\n      assignedDate: formData.assignedDate,\n      reason: formData.reason,\n      listPrice: formData.listPrice,\n      salePrice: formData.salePrice,\n      sgkReduction: formData.sgkReduction,\n      patientPayment: formData.patientPayment,\n      paymentMethod: formData.paymentMethod,\n      trialEndDate: formData.status === 'trial' ? formData.trialEndDate : undefined,\n      notes: formData.notes,\n      assignedBy: 'Current User', // TODO: Get from auth context\n      purchaseDate: formData.assignedDate, // For compatibility\n      price: formData.salePrice // For compatibility\n    };\n    \n    onSave(deviceData);\n  };\n\n  const handleClose = () => {\n    setFormData({});\n    setErrors({});\n    setSelectedDevice(null);\n    setDeviceSearch('');\n    onClose();\n  };\n\n  if (!open) return null;\n\n  return (\n    <Modal\n      open={open}\n      title={device ? 'Cihaz Düzenle' : 'Yeni Cihaz Ekle'}\n      onClose={handleClose}\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Device Search and Selection */}\n        <div className=\"space-y-4\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Cihaz Seçimi</h3>\n          \n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n            <input\n              type=\"text\"\n              placeholder=\"Cihaz ara (marka, model)...\"\n              value={deviceSearch}\n              onChange={(e) => setDeviceSearch(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n          \n          {deviceSearch && (\n            <div className=\"max-h-48 overflow-y-auto border border-gray-200 rounded-lg\">\n              {filteredDevices.map((device) => (\n                <div\n                  key={device.id}\n                  onClick={() => handleDeviceSelect(device)}\n                  className={`p-3 cursor-pointer hover:bg-gray-50 border-b border-gray-100 last:border-b-0 ${\n                    selectedDevice?.id === device.id ? 'bg-blue-50 border-blue-200' : ''\n                  }`}\n                >\n                  <div className=\"flex justify-between items-center\">\n                    <div>\n                      <p className=\"font-medium text-gray-900\">{device.brand} {device.model}</p>\n                      <p className=\"text-sm text-gray-500 capitalize\">{device.type.replace('_', ' ')}</p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"font-medium text-gray-900\">{device.listPrice.toLocaleString('tr-TR')} ₺</p>\n                      <p className=\"text-sm text-gray-500\">{device.availableSerials.length} adet mevcut</p>\n                    </div>\n                  </div>\n                </div>\n              ))}\n              {filteredDevices.length === 0 && (\n                <div className=\"p-4 text-center text-gray-500\">\n                  Arama kriterinize uygun cihaz bulunamadı\n                </div>\n              )}\n            </div>\n          )}\n          \n          {selectedDevice && (\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n              <div className=\"flex items-center space-x-2 mb-2\">\n                <CheckCircle className=\"w-5 h-5 text-blue-600\" />\n                <span className=\"font-medium text-blue-900\">Seçili Cihaz</span>\n              </div>\n              <p className=\"text-blue-800\">{selectedDevice.brand} {selectedDevice.model}</p>\n              <p className=\"text-sm text-blue-600\">{selectedDevice.listPrice.toLocaleString('tr-TR')} ₺</p>\n            </div>\n          )}\n          \n          {errors.brand && <p className=\"text-red-600 text-sm\">{errors.brand}</p>}\n        </div>\n\n        {/* Serial Number Selection */}\n        {selectedDevice && (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n              Seri Numarası *\n            </label>\n            <select\n              value={formData.serialNumber || ''}\n              onChange={(e) => handleInputChange('serialNumber', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.serialNumber ? 'border-red-300' : 'border-gray-300'\n              }`}\n            >\n              <option value=\"\">Seri numarası seçin</option>\n              {selectedDevice.availableSerials.map((serial) => (\n                <option key={serial} value={serial}>\n                  {serial}\n                </option>\n              ))}\n            </select>\n            {errors.serialNumber && <p className=\"text-red-600 text-sm\">{errors.serialNumber}</p>}\n          </div>\n        )}\n\n        {/* Ear Selection */}\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">\n            Kulak Seçimi *\n          </label>\n          <div className=\"grid grid-cols-3 gap-3\">\n            {[\n              { value: 'left', label: 'Sol Kulak', color: 'blue' },\n              { value: 'right', label: 'Sağ Kulak', color: 'red' },\n              { value: 'both', label: 'Bilateral', color: 'purple' }\n            ].map((option) => (\n              <button\n                key={option.value}\n                type=\"button\"\n                onClick={() => handleInputChange('ear', option.value)}\n                className={`p-3 rounded-lg border-2 text-sm font-medium transition-colors ${\n                  formData.ear === option.value\n                    ? `border-${option.color}-500 bg-${option.color}-50 text-${option.color}-700`\n                    : 'border-gray-200 bg-white text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                {option.label}\n              </button>\n            ))}\n          </div>\n          {errors.ear && <p className=\"text-red-600 text-sm\">{errors.ear}</p>}\n        </div>\n\n        {/* Assignment Details */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n              Atama Tarihi *\n            </label>\n            <div className=\"relative\">\n              <Calendar className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n              <input\n                type=\"date\"\n                value={formData.assignedDate || ''}\n                onChange={(e) => handleInputChange('assignedDate', e.target.value)}\n                className={`w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                  errors.assignedDate ? 'border-red-300' : 'border-gray-300'\n                }`}\n              />\n            </div>\n            {errors.assignedDate && <p className=\"text-red-600 text-sm\">{errors.assignedDate}</p>}\n          </div>\n\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n              Atama Sebebi *\n            </label>\n            <select\n              value={formData.reason || ''}\n              onChange={(e) => handleInputChange('reason', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.reason ? 'border-red-300' : 'border-gray-300'\n              }`}\n            >\n              <option value=\"\">Sebep seçin</option>\n              <option value=\"new\">Yeni Hasta</option>\n              <option value=\"replacement\">Değişim</option>\n              <option value=\"upgrade\">Yükseltme</option>\n              <option value=\"trial\">Deneme</option>\n              <option value=\"warranty\">Garanti</option>\n            </select>\n            {errors.reason && <p className=\"text-red-600 text-sm\">{errors.reason}</p>}\n          </div>\n        </div>\n\n        {/* Status Selection */}\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">\n            Durum\n          </label>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n            {[\n              { value: 'assigned', label: 'Atandı', color: 'green' },\n              { value: 'trial', label: 'Deneme', color: 'blue' },\n              { value: 'returned', label: 'İade', color: 'yellow' },\n              { value: 'defective', label: 'Arızalı', color: 'red' }\n            ].map((status) => (\n              <button\n                key={status.value}\n                type=\"button\"\n                onClick={() => handleInputChange('status', status.value)}\n                className={`p-2 rounded-lg border text-sm font-medium transition-colors ${\n                  formData.status === status.value\n                    ? `border-${status.color}-500 bg-${status.color}-50 text-${status.color}-700`\n                    : 'border-gray-200 bg-white text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                {status.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Trial End Date (if status is trial) */}\n        {formData.status === 'trial' && (\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n              Deneme Bitiş Tarihi\n            </label>\n            <div className=\"relative\">\n              <Clock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n              <input\n                type=\"date\"\n                value={formData.trialEndDate || ''}\n                onChange={(e) => handleInputChange('trialEndDate', e.target.value)}\n                className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              />\n            </div>\n          </div>\n        )}\n\n        {/* Pricing Section */}\n        <div className=\"space-y-4\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <DollarSign className=\"w-5 h-5 mr-2\" />\n            Fiyatlandırma\n          </h3>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <label className=\"block text-sm font-medium text-gray-700\">\n                Liste Fiyatı *\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"number\"\n                  value={formData.listPrice || ''}\n                  onChange={(e) => handleInputChange('listPrice', parseFloat(e.target.value) || 0)}\n                  className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                    errors.listPrice ? 'border-red-300' : 'border-gray-300'\n                  }`}\n                  placeholder=\"0\"\n                />\n                <span className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500\">₺</span>\n              </div>\n              {errors.listPrice && <p className=\"text-red-600 text-sm\">{errors.listPrice}</p>}\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"block text-sm font-medium text-gray-700\">\n                Satış Fiyatı\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"number\"\n                  value={formData.salePrice || ''}\n                  onChange={(e) => handleInputChange('salePrice', parseFloat(e.target.value) || 0)}\n                  className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                    errors.salePrice ? 'border-red-300' : 'border-gray-300'\n                  }`}\n                  placeholder=\"0\"\n                />\n                <span className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500\">₺</span>\n              </div>\n              {errors.salePrice && <p className=\"text-red-600 text-sm\">{errors.salePrice}</p>}\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <label className=\"block text-sm font-medium text-gray-700\">\n                SGK Katkısı\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"number\"\n                  value={formData.sgkReduction || ''}\n                  onChange={(e) => handleInputChange('sgkReduction', parseFloat(e.target.value) || 0)}\n                  className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                    errors.sgkReduction ? 'border-red-300' : 'border-gray-300'\n                  }`}\n                  placeholder=\"0\"\n                />\n                <span className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500\">₺</span>\n              </div>\n              {errors.sgkReduction && <p className=\"text-red-600 text-sm\">{errors.sgkReduction}</p>}\n            </div>\n\n            <div className=\"space-y-2\">\n              <label className=\"block text-sm font-medium text-gray-700\">\n                Hasta Ödemesi\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"number\"\n                  value={formData.patientPayment || ''}\n                  onChange={(e) => handleInputChange('patientPayment', parseFloat(e.target.value) || 0)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50\"\n                  placeholder=\"0\"\n                  readOnly\n                />\n                <span className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500\">₺</span>\n              </div>\n              <p className=\"text-xs text-gray-500\">Otomatik hesaplanır (Satış Fiyatı - SGK Katkısı)</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Payment Method */}\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">\n            Ödeme Yöntemi\n          </label>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n            {[\n              { value: 'cash', label: 'Nakit', icon: DollarSign },\n              { value: 'card', label: 'Kart', icon: CreditCard },\n              { value: 'transfer', label: 'Havale', icon: Calculator },\n              { value: 'installment', label: 'Taksit', icon: Calendar }\n            ].map((method) => {\n              const Icon = method.icon;\n              return (\n                <button\n                  key={method.value}\n                  type=\"button\"\n                  onClick={() => handleInputChange('paymentMethod', method.value)}\n                  className={`p-3 rounded-lg border text-sm font-medium transition-colors flex items-center justify-center space-x-2 ${\n                    formData.paymentMethod === method.value\n                      ? 'border-blue-500 bg-blue-50 text-blue-700'\n                      : 'border-gray-200 bg-white text-gray-700 hover:border-gray-300'\n                  }`}\n                >\n                  <Icon className=\"w-4 h-4\" />\n                  <span>{method.label}</span>\n                </button>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* Notes */}\n        <div className=\"space-y-2\">\n          <label className=\"block text-sm font-medium text-gray-700\">\n            Notlar\n          </label>\n          <div className=\"relative\">\n            <FileText className=\"absolute left-3 top-3 text-gray-400 w-4 h-4\" />\n            <textarea\n              value={formData.notes || ''}\n              onChange={(e) => handleInputChange('notes', e.target.value)}\n              rows={3}\n              className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n              placeholder=\"Cihaz ataması ile ilgili notlar...\"\n            />\n          </div>\n        </div>\n\n        {/* Form Actions */}\n        <div className=\"flex justify-end space-x-3 pt-6 border-t border-gray-200\">\n          <button\n            type=\"button\"\n            onClick={handleClose}\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            İptal\n          </button>\n          <button\n            type=\"submit\"\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            {device ? 'Güncelle' : 'Kaydet'}\n          </button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/DeviceMaintenanceModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1839,1842],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1839,1842],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Modal } from '../ui/Modal';\nimport { Button } from '../ui/Button';\nimport { Input, Select, Textarea } from '@x-ear/ui-web';\nimport { PatientDevice } from '../../types/patient';\nimport { Wrench, Calendar, Clock, DollarSign, User, AlertTriangle, CheckCircle, Loader2 } from 'lucide-react';\n\ninterface DeviceMaintenanceModalProps {\n  open: boolean;\n  onClose: () => void;\n  device: PatientDevice | null;\n  onSubmit: (maintenanceData: DeviceMaintenanceData) => Promise<void>;\n  isLoading?: boolean;\n}\n\nexport interface DeviceMaintenanceData {\n  id?: string;\n  deviceId: string;\n  maintenanceType: 'repair' | 'cleaning' | 'calibration' | 'replacement' | 'other';\n  description: string;\n  scheduledDate: string;\n  estimatedDuration: number; // in days\n  cost?: number;\n  technician?: string;\n  priority: 'low' | 'medium' | 'high' | 'urgent';\n  notes?: string;\n  status: 'scheduled' | 'in_progress' | 'completed' | 'cancelled';\n  createdAt?: string;\n  updatedAt?: string;\n}\n\nexport const DeviceMaintenanceModal: React.FC<DeviceMaintenanceModalProps> = ({\n  open,\n  onClose,\n  device,\n  onSubmit,\n  isLoading = false\n}) => {\n  const [formData, setFormData] = useState<DeviceMaintenanceData>({\n    deviceId: device?.id || '',\n    maintenanceType: 'repair',\n    description: '',\n    scheduledDate: new Date().toISOString().split('T')[0],\n    estimatedDuration: 1,\n    priority: 'medium',\n    status: 'scheduled',\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [saving, setSaving] = useState(false);\n\n  useEffect(() => {\n    if (device && open) {\n      setFormData(prev => ({\n        ...prev,\n        deviceId: device.id,\n      }));\n    }\n    setErrors({});\n  }, [device, open]);\n\n  const handleInputChange = (field: keyof DeviceMaintenanceData, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value,\n    }));\n    \n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({\n        ...prev,\n        [field]: '',\n      }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.description.trim()) {\n      newErrors.description = 'Bakım açıklaması gereklidir';\n    }\n\n    if (!formData.scheduledDate) {\n      newErrors.scheduledDate = 'Planlanan tarih gereklidir';\n    }\n\n    // Check if scheduled date is in the past\n    const scheduledDate = new Date(formData.scheduledDate);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    \n    if (scheduledDate < today) {\n      newErrors.scheduledDate = 'Planlanan tarih bugünden önce olamaz';\n    }\n\n    if (formData.estimatedDuration <= 0) {\n      newErrors.estimatedDuration = 'Tahmini süre pozitif bir değer olmalıdır';\n    }\n\n    if (formData.estimatedDuration > 365) {\n      newErrors.estimatedDuration = 'Tahmini süre 365 günden fazla olamaz';\n    }\n\n    if (formData.cost && formData.cost < 0) {\n      newErrors.cost = 'Maliyet negatif olamaz';\n    }\n\n    if (formData.technician && formData.technician.trim().length < 2) {\n      newErrors.technician = 'Teknisyen adı en az 2 karakter olmalıdır';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setSaving(true);\n    try {\n      // Prepare data for backend API\n      const maintenanceData = {\n        ...formData,\n        // Convert date to ISO format for backend\n        scheduledDate: new Date(formData.scheduledDate).toISOString(),\n      };\n\n      await onSubmit(maintenanceData);\n      onClose();\n    } catch (error) {\n      console.error('Maintenance save error:', error);\n      setErrors({ submit: 'Bakım kaydedilirken bir hata oluştu' });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleClose = () => {\n    setFormData({\n      deviceId: device?.id || '',\n      maintenanceType: 'repair',\n      description: '',\n      scheduledDate: new Date().toISOString().split('T')[0],\n      estimatedDuration: 1,\n      priority: 'medium',\n      status: 'scheduled',\n    });\n    setErrors({});\n    onClose();\n  };\n\n  const title = device \n    ? `Cihaz Bakımı - ${device.brand} ${device.model} (${device.serialNumber})`\n    : 'Cihaz Bakımı';\n\n  const maintenanceTypeOptions = [\n    { value: 'repair', label: 'Onarım' },\n    { value: 'cleaning', label: 'Temizlik' },\n    { value: 'calibration', label: 'Kalibrasyon' },\n    { value: 'replacement', label: 'Parça Değişimi' },\n    { value: 'other', label: 'Diğer' },\n  ];\n\n  const priorityOptions = [\n    { value: 'low', label: 'Düşük' },\n    { value: 'medium', label: 'Orta' },\n    { value: 'high', label: 'Yüksek' },\n    { value: 'urgent', label: 'Acil' },\n  ];\n\n  const statusOptions = [\n    { value: 'scheduled', label: 'Planlandı' },\n    { value: 'in_progress', label: 'Devam Ediyor' },\n    { value: 'completed', label: 'Tamamlandı' },\n    { value: 'cancelled', label: 'İptal Edildi' },\n  ];\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'urgent': return 'text-red-600 bg-red-50';\n      case 'high': return 'text-orange-600 bg-orange-50';\n      case 'medium': return 'text-yellow-600 bg-yellow-50';\n      case 'low': return 'text-green-600 bg-green-50';\n      default: return 'text-gray-600 bg-gray-50';\n    }\n  };\n\n  const getEstimatedEndDate = () => {\n    if (formData.scheduledDate && formData.estimatedDuration) {\n      const startDate = new Date(formData.scheduledDate);\n      const endDate = new Date(startDate);\n      endDate.setDate(startDate.getDate() + formData.estimatedDuration);\n      return endDate.toLocaleDateString('tr-TR');\n    }\n    return null;\n  };\n\n  return (\n    <Modal\n      open={open}\n      onClose={handleClose}\n      title={title}\n    >\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Device Information */}\n        {device && (\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\n            <h3 className=\"text-sm font-medium text-gray-900 mb-3 flex items-center\">\n              <Wrench className=\"w-4 h-4 mr-2\" />\n              Cihaz Bilgileri\n            </h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n              <div>\n                <span className=\"text-gray-600\">Cihaz:</span>\n                <span className=\"ml-2 font-medium\">{device.brand} {device.model}</span>\n              </div>\n              <div>\n                <span className=\"text-gray-600\">Seri No:</span>\n                <span className=\"ml-2 font-medium\">{device.serialNumber}</span>\n              </div>\n              {device.warrantyExpiry && (\n                <div className=\"col-span-2\">\n                  <span className=\"text-gray-600\">Garanti Bitiş:</span>\n                  <span className=\"ml-2 font-medium\">\n                    {new Date(device.warrantyExpiry).toLocaleDateString('tr-TR')}\n                  </span>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Maintenance Type and Priority */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <Select\n              label=\"Bakım Türü *\"\n              value={formData.maintenanceType}\n              onChange={(e) => handleInputChange('maintenanceType', e.target.value)}\n              options={maintenanceTypeOptions}\n              disabled={saving}\n              error={errors.maintenanceType}\n            />\n          </div>\n          <div>\n            <Select\n              label=\"Öncelik *\"\n              value={formData.priority}\n              onChange={(e) => handleInputChange('priority', e.target.value)}\n              options={priorityOptions}\n              disabled={saving}\n            />\n            {formData.priority && (\n              <div className={`mt-2 px-2 py-1 rounded text-xs font-medium ${getPriorityColor(formData.priority)}`}>\n                {priorityOptions.find(opt => opt.value === formData.priority)?.label} Öncelik\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Description */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Bakım Açıklaması *\n          </label>\n          <Textarea\n            value={formData.description}\n            onChange={(e) => handleInputChange('description', e.target.value)}\n            placeholder=\"Yapılacak bakım işlemlerini detaylı olarak açıklayın\"\n            rows={3}\n            disabled={saving}\n            error={errors.description}\n          />\n        </div>\n\n        {/* Scheduling */}\n        <div className=\"bg-blue-50 p-4 rounded-lg\">\n          <h3 className=\"text-sm font-medium text-gray-900 mb-3 flex items-center\">\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Planlama\n          </h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Planlanan Tarih *\n              </label>\n              <Input\n                type=\"date\"\n                value={formData.scheduledDate}\n                onChange={(e) => handleInputChange('scheduledDate', e.target.value)}\n                error={errors.scheduledDate}\n                disabled={saving}\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Tahmini Süre (Gün) *\n              </label>\n              <Input\n                type=\"number\"\n                min=\"1\"\n                max=\"365\"\n                value={formData.estimatedDuration}\n                onChange={(e) => handleInputChange('estimatedDuration', parseInt(e.target.value) || 1)}\n                error={errors.estimatedDuration}\n                disabled={saving}\n              />\n            </div>\n          </div>\n          {getEstimatedEndDate() && (\n            <div className=\"mt-3 p-2 bg-blue-100 rounded text-sm text-blue-800\">\n              <Clock className=\"w-4 h-4 inline mr-1\" />\n              Tahmini bitiş tarihi: {getEstimatedEndDate()}\n            </div>\n          )}\n        </div>\n\n        {/* Cost and Technician */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\">\n              <DollarSign className=\"w-4 h-4 mr-1\" />\n              Tahmini Maliyet (₺)\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.cost || ''}\n              onChange={(e) => handleInputChange('cost', e.target.value ? parseFloat(e.target.value) : undefined)}\n              placeholder=\"0.00\"\n              error={errors.cost}\n              disabled={saving}\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\">\n              <User className=\"w-4 h-4 mr-1\" />\n              Teknisyen\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.technician || ''}\n              onChange={(e) => handleInputChange('technician', e.target.value)}\n              placeholder=\"Teknisyen adı\"\n              error={errors.technician}\n              disabled={saving}\n            />\n          </div>\n        </div>\n\n        {/* Status */}\n        <div>\n          <Select\n            label=\"Durum *\"\n            value={formData.status}\n            onChange={(e) => handleInputChange('status', e.target.value)}\n            options={statusOptions}\n            disabled={saving}\n          />\n        </div>\n\n        {/* Notes */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <Textarea\n            value={formData.notes || ''}\n            onChange={(e) => handleInputChange('notes', e.target.value)}\n            placeholder=\"Ek notlar ve özel talimatlar\"\n            rows={2}\n            disabled={saving}\n          />\n        </div>\n\n        {/* Error Display */}\n        {errors.submit && (\n          <div className=\"p-3 bg-red-50 border border-red-200 rounded-md\">\n            <div className=\"flex items-center\">\n              <AlertTriangle className=\"w-4 h-4 text-red-500 mr-2\" />\n              <span className=\"text-sm text-red-700\">{errors.submit}</span>\n            </div>\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"flex justify-end space-x-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={handleClose}\n            disabled={saving}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            variant=\"primary\"\n            disabled={saving || isLoading}\n          >\n            {saving ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Kaydediliyor...\n              </>\n            ) : (\n              <>\n                <CheckCircle className=\"w-4 h-4 mr-2\" />\n                Bakım Planla\n              </>\n            )}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/DeviceTrialModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[892,895],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[892,895],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":155,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4846,4849],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4846,4849],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Modal } from '../ui/Modal';\nimport { Button } from '../ui/Button';\nimport { Input, Select, Textarea } from '@x-ear/ui-web';\nimport { Calendar, Clock, FileText, AlertCircle, CheckCircle, Loader2 } from 'lucide-react';\n\ninterface DeviceTrial {\n  id?: string;\n  patientId: string;\n  deviceId: string;\n  deviceName?: string;\n  brand: string;\n  model: string;\n  serialNumber?: string;\n  startDate: string;\n  endDate: string;\n  extendedUntil?: string;\n  status: 'active' | 'completed' | 'cancelled';\n  result?: 'purchased' | 'returned' | 'extended';\n  notes?: string;\n  trialPrice?: number;\n  listPrice?: number;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\ninterface DeviceTrialModalProps {\n  open: boolean;\n  onClose: () => void;\n  onSave: (trialData: Partial<DeviceTrial>) => Promise<void>;\n  trial?: DeviceTrial | null;\n  device?: any;\n  patientId: string;\n  isLoading?: boolean;\n}\n\nexport const DeviceTrialModal: React.FC<DeviceTrialModalProps> = ({\n  open,\n  onClose,\n  onSave,\n  trial,\n  device,\n  patientId,\n  isLoading = false\n}) => {\n  const [formData, setFormData] = useState<Partial<DeviceTrial>>({\n    patientId,\n    startDate: new Date().toISOString().split('T')[0],\n    endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n    status: 'active',\n    trialPrice: 0\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [saving, setSaving] = useState(false);\n\n  useEffect(() => {\n    if (trial) {\n      setFormData({\n        ...trial,\n        startDate: trial.startDate?.split('T')[0] || new Date().toISOString().split('T')[0],\n        endDate: trial.endDate?.split('T')[0] || new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n        extendedUntil: trial.extendedUntil?.split('T')[0] || ''\n      });\n    } else if (device) {\n      // Pre-populate with device information\n      setFormData({\n        patientId,\n        deviceId: device.id,\n        deviceName: `${device.brand || ''} ${device.model || ''}`.trim(),\n        brand: device.brand || '',\n        model: device.model || '',\n        serialNumber: device.serialNumber || '',\n        startDate: new Date().toISOString().split('T')[0],\n        endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n        status: 'active',\n        trialPrice: device.price ? parseFloat(device.price) * 0.1 : 0, // 10% of device price as trial fee\n        listPrice: device.price ? parseFloat(device.price) : 0\n      });\n    } else {\n      setFormData({\n        patientId,\n        startDate: new Date().toISOString().split('T')[0],\n        endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n        status: 'active',\n        trialPrice: 0\n      });\n    }\n    setErrors({});\n  }, [trial, device, patientId, open]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.brand?.trim()) {\n      newErrors.brand = 'Marka gereklidir';\n    }\n\n    if (!formData.model?.trim()) {\n      newErrors.model = 'Model gereklidir';\n    }\n\n    if (!formData.startDate) {\n      newErrors.startDate = 'Başlangıç tarihi gereklidir';\n    }\n\n    if (!formData.endDate) {\n      newErrors.endDate = 'Bitiş tarihi gereklidir';\n    }\n\n    if (formData.startDate && formData.endDate && new Date(formData.startDate) >= new Date(formData.endDate)) {\n      newErrors.endDate = 'Bitiş tarihi başlangıç tarihinden sonra olmalıdır';\n    }\n\n    if (formData.extendedUntil && formData.endDate && new Date(formData.extendedUntil) <= new Date(formData.endDate)) {\n      newErrors.extendedUntil = 'Uzatma tarihi bitiş tarihinden sonra olmalıdır';\n    }\n\n    if (formData.trialPrice && formData.trialPrice < 0) {\n      newErrors.trialPrice = 'Deneme ücreti negatif olamaz';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setSaving(true);\n    try {\n      // Prepare data for backend API\n      const trialData = {\n        ...formData,\n        // Convert dates to ISO format for backend\n        startDate: formData.startDate ? new Date(formData.startDate).toISOString() : undefined,\n        endDate: formData.endDate ? new Date(formData.endDate).toISOString() : undefined,\n        extendedUntil: formData.extendedUntil ? new Date(formData.extendedUntil).toISOString() : undefined,\n      };\n\n      await onSave(trialData);\n      onClose();\n    } catch (error) {\n      console.error('Trial save error:', error);\n      setErrors({ submit: 'Deneme kaydedilirken bir hata oluştu' });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleInputChange = (field: keyof DeviceTrial, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  const getTrialDuration = () => {\n    if (formData.startDate && formData.endDate) {\n      const start = new Date(formData.startDate);\n      const end = new Date(formData.endDate);\n      const diffTime = Math.abs(end.getTime() - start.getTime());\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n      return diffDays;\n    }\n    return 0;\n  };\n\n  return (\n    <Modal open={open} onClose={onClose} title={trial ? 'Deneme Düzenle' : 'Yeni Deneme Başlat'}>\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        {/* Device Information */}\n        <div className=\"bg-gray-50 p-4 rounded-lg\">\n          <h3 className=\"text-sm font-medium text-gray-900 mb-3 flex items-center\">\n            <FileText className=\"w-4 h-4 mr-2\" />\n            Cihaz Bilgileri\n          </h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Marka *\n              </label>\n              <Input\n                value={formData.brand || ''}\n                onChange={(e) => handleInputChange('brand', e.target.value)}\n                placeholder=\"Cihaz markası\"\n                error={errors.brand}\n                disabled={saving}\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Model *\n              </label>\n              <Input\n                value={formData.model || ''}\n                onChange={(e) => handleInputChange('model', e.target.value)}\n                placeholder=\"Cihaz modeli\"\n                error={errors.model}\n                disabled={saving}\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Seri Numarası\n              </label>\n              <Input\n                value={formData.serialNumber || ''}\n                onChange={(e) => handleInputChange('serialNumber', e.target.value)}\n                placeholder=\"Seri numarası\"\n                disabled={saving}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Trial Period */}\n        <div className=\"bg-blue-50 p-4 rounded-lg\">\n          <h3 className=\"text-sm font-medium text-gray-900 mb-3 flex items-center\">\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Deneme Süresi\n          </h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Başlangıç Tarihi *\n              </label>\n              <Input\n                type=\"date\"\n                value={formData.startDate || ''}\n                onChange={(e) => handleInputChange('startDate', e.target.value)}\n                error={errors.startDate}\n                disabled={saving}\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Bitiş Tarihi *\n              </label>\n              <Input\n                type=\"date\"\n                value={formData.endDate || ''}\n                onChange={(e) => handleInputChange('endDate', e.target.value)}\n                error={errors.endDate}\n                disabled={saving}\n              />\n            </div>\n            {formData.status === 'active' && (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Uzatma Tarihi\n                </label>\n                <Input\n                  type=\"date\"\n                  value={formData.extendedUntil || ''}\n                  onChange={(e) => handleInputChange('extendedUntil', e.target.value)}\n                  error={errors.extendedUntil}\n                  disabled={saving}\n                />\n              </div>\n            )}\n          </div>\n          {getTrialDuration() > 0 && (\n            <div className=\"mt-3 p-2 bg-blue-100 rounded text-sm text-blue-800\">\n              <Clock className=\"w-4 h-4 inline mr-1\" />\n              Deneme süresi: {getTrialDuration()} gün\n            </div>\n          )}\n        </div>\n\n        {/* Pricing */}\n        <div className=\"bg-green-50 p-4 rounded-lg\">\n          <h3 className=\"text-sm font-medium text-gray-900 mb-3\">\n            Fiyatlandırma\n          </h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Deneme Ücreti (₺)\n              </label>\n              <Input\n                type=\"number\"\n                step=\"0.01\"\n                min=\"0\"\n                value={formData.trialPrice || ''}\n                onChange={(e) => handleInputChange('trialPrice', parseFloat(e.target.value) || 0)}\n                placeholder=\"0.00\"\n                error={errors.trialPrice}\n                disabled={saving}\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Liste Fiyatı (₺)\n              </label>\n              <Input\n                type=\"number\"\n                step=\"0.01\"\n                min=\"0\"\n                value={formData.listPrice || ''}\n                onChange={(e) => handleInputChange('listPrice', parseFloat(e.target.value) || 0)}\n                placeholder=\"0.00\"\n                disabled={saving}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Status and Result */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <Select\n              label=\"Durum\"\n              value={formData.status || 'active'}\n              onChange={(e) => handleInputChange('status', e.target.value)}\n              disabled={saving}\n              options={[\n                { value: 'active', label: 'Aktif' },\n                { value: 'completed', label: 'Tamamlandı' },\n                { value: 'cancelled', label: 'İptal Edildi' }\n              ]}\n            />\n          </div>\n          {formData.status === 'completed' && (\n            <div>\n              <Select\n                label=\"Sonuç\"\n                value={formData.result || ''}\n                onChange={(e) => handleInputChange('result', e.target.value)}\n                disabled={saving}\n                options={[\n                  { value: '', label: 'Seçiniz' },\n                  { value: 'purchased', label: 'Satın Alındı' },\n                  { value: 'returned', label: 'İade Edildi' },\n                  { value: 'extended', label: 'Uzatıldı' }\n                ]}\n              />\n            </div>\n          )}\n        </div>\n\n        {/* Notes */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <Textarea\n            value={formData.notes || ''}\n            onChange={(e) => handleInputChange('notes', e.target.value)}\n            placeholder=\"Deneme ile ilgili notlar...\"\n            rows={3}\n            disabled={saving}\n          />\n        </div>\n\n        {/* Error Display */}\n        {errors.submit && (\n          <div className=\"p-3 bg-red-50 border border-red-200 rounded-md\">\n            <div className=\"flex items-center\">\n              <AlertCircle className=\"w-4 h-4 text-red-500 mr-2\" />\n              <span className=\"text-sm text-red-700\">{errors.submit}</span>\n            </div>\n          </div>\n        )}\n\n        {/* Actions */}\n        <div className=\"flex justify-end space-x-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={onClose}\n            disabled={saving}\n          >\n            İptal\n          </Button>\n          <Button\n            type=\"submit\"\n            variant=\"primary\"\n            disabled={saving || isLoading}\n          >\n            {saving ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Kaydediliyor...\n              </>\n            ) : (\n              <>\n                <CheckCircle className=\"w-4 h-4 mr-2\" />\n                {trial ? 'Güncelle' : 'Deneme Başlat'}\n              </>\n            )}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/InventoryManagementModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'X' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":4},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isLoading' is assigned a value but never used.","line":76,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":12},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadInventory'. Either include it or remove the dependency array.","line":124,"column":6,"nodeType":"ArrayExpression","endLine":124,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, loadInventory]","fix":{"range":[2866,2874],"text":"[isOpen, loadInventory]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Input, Select, Textarea, Modal } from '@x-ear/ui-web';\nimport { \n  Search, \n  Plus, \n  Edit, \n  Trash2, \n  X, \n  CheckCircle, \n  Loader2, \n  Filter, \n  RefreshCw,\n  AlertCircle,\n  Package\n} from 'lucide-react';\n\nexport interface InventoryItem {\n  id: string;\n  name: string;\n  brand: string;\n  model: string;\n  category: string;\n  type: string;\n  serialNumbers: string[];\n  totalStock: number;\n  availableStock: number;\n  assignedStock: number;\n  price: number;\n  listPrice: number;\n  sgkPrice: number;\n  warrantyPeriod: number;\n  isActive: boolean;\n  notes?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface InventoryManagementModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onInventoryUpdate?: (items: InventoryItem[]) => void;\n  isLoading?: boolean;\n}\n\ninterface InventoryFormData {\n  name: string;\n  brand: string;\n  model: string;\n  category: string;\n  type: string;\n  totalStock: number;\n  price: number;\n  listPrice: number;\n  sgkPrice: number;\n  warrantyPeriod: number;\n  notes: string;\n}\n\ninterface FormErrors {\n  name?: string;\n  brand?: string;\n  model?: string;\n  category?: string;\n  type?: string;\n  totalStock?: string;\n  price?: string;\n  listPrice?: string;\n  sgkPrice?: string;\n  warrantyPeriod?: string;\n}\n\nexport const InventoryManagementModal: React.FC<InventoryManagementModalProps> = ({\n  isOpen,\n  onClose,\n  onInventoryUpdate,\n  isLoading = false\n}) => {\n  const [inventory, setInventory] = useState<InventoryItem[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [categoryFilter, setCategoryFilter] = useState('');\n  const [typeFilter, setTypeFilter] = useState('');\n  const [showAddForm, setShowAddForm] = useState(false);\n  const [editingItem, setEditingItem] = useState<InventoryItem | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const [formErrors, setFormErrors] = useState<FormErrors>({});\n\n  const [formData, setFormData] = useState<InventoryFormData>({\n    name: '',\n    brand: '',\n    model: '',\n    category: '',\n    type: '',\n    totalStock: 0,\n    price: 0,\n    listPrice: 0,\n    sgkPrice: 0,\n    warrantyPeriod: 12,\n    notes: ''\n  });\n\n  // Clear messages after 3 seconds\n  useEffect(() => {\n    if (successMessage) {\n      const timer = setTimeout(() => setSuccessMessage(null), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [successMessage]);\n\n  useEffect(() => {\n    if (error) {\n      const timer = setTimeout(() => setError(null), 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [error]);\n\n  // Load inventory data\n  useEffect(() => {\n    if (isOpen) {\n      loadInventory();\n    }\n  }, [isOpen]);\n\n  const loadInventory = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      // Simulate API call with mock data\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      const mockInventory: InventoryItem[] = [\n        {\n          id: '1',\n          name: 'Hearing Aid Premium',\n          brand: 'AudioTech',\n          model: 'AT-2024',\n          category: 'hearing_aid',\n          type: 'behind_ear',\n          serialNumbers: ['AT001', 'AT002', 'AT003'],\n          totalStock: 15,\n          availableStock: 12,\n          assignedStock: 3,\n          price: 2500,\n          listPrice: 3000,\n          sgkPrice: 2200,\n          warrantyPeriod: 24,\n          isActive: true,\n          notes: 'Premium model with advanced noise cancellation',\n          createdAt: '2024-01-15T10:00:00Z',\n          updatedAt: '2024-01-20T14:30:00Z'\n        },\n        {\n          id: '2',\n          name: 'Cochlear Implant Basic',\n          brand: 'CochlearCorp',\n          model: 'CC-100',\n          category: 'cochlear_implant',\n          type: 'internal',\n          serialNumbers: ['CC001', 'CC002'],\n          totalStock: 8,\n          availableStock: 6,\n          assignedStock: 2,\n          price: 15000,\n          listPrice: 18000,\n          sgkPrice: 14000,\n          warrantyPeriod: 60,\n          isActive: true,\n          notes: 'Basic cochlear implant for severe hearing loss',\n          createdAt: '2024-01-10T09:00:00Z',\n          updatedAt: '2024-01-18T16:45:00Z'\n        }\n      ];\n      \n      setInventory(mockInventory);\n      onInventoryUpdate?.(mockInventory);\n    } catch (err) {\n      setError('Failed to load inventory. Please try again.');\n      console.error('Error loading inventory:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const errors: FormErrors = {};\n    \n    if (!formData.name.trim()) {\n      errors.name = 'Name is required';\n    } else if (formData.name.length < 2) {\n      errors.name = 'Name must be at least 2 characters';\n    }\n    \n    if (!formData.brand.trim()) {\n      errors.brand = 'Brand is required';\n    }\n    \n    if (!formData.model.trim()) {\n      errors.model = 'Model is required';\n    }\n    \n    if (!formData.category) {\n      errors.category = 'Category is required';\n    }\n    \n    if (!formData.type) {\n      errors.type = 'Type is required';\n    }\n    \n    if (formData.totalStock < 0) {\n      errors.totalStock = 'Stock cannot be negative';\n    }\n    \n    if (formData.price < 0) {\n      errors.price = 'Price cannot be negative';\n    }\n    \n    if (formData.listPrice < formData.price) {\n      errors.listPrice = 'List price should be greater than or equal to price';\n    }\n    \n    if (formData.sgkPrice < 0) {\n      errors.sgkPrice = 'SGK price cannot be negative';\n    }\n    \n    if (formData.warrantyPeriod < 1 || formData.warrantyPeriod > 120) {\n      errors.warrantyPeriod = 'Warranty period must be between 1 and 120 months';\n    }\n    \n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleAddItem = async () => {\n    if (!validateForm()) return;\n    \n    setSaving(true);\n    setError(null);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      const newItem: InventoryItem = {\n        id: Date.now().toString(),\n        ...formData,\n        serialNumbers: [],\n        availableStock: formData.totalStock,\n        assignedStock: 0,\n        isActive: true,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n      };\n      \n      const updatedInventory = [...inventory, newItem];\n      setInventory(updatedInventory);\n      onInventoryUpdate?.(updatedInventory);\n      \n      setShowAddForm(false);\n      resetForm();\n      setSuccessMessage('Item added successfully!');\n    } catch (err) {\n      setError('Failed to add item. Please try again.');\n      console.error('Error adding item:', err);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleEditItem = async () => {\n    if (!editingItem || !validateForm()) return;\n    \n    setSaving(true);\n    setError(null);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      const updatedItem: InventoryItem = {\n        ...editingItem,\n        ...formData,\n        updatedAt: new Date().toISOString()\n      };\n      \n      const updatedInventory = inventory.map(item => \n        item.id === editingItem.id ? updatedItem : item\n      );\n      \n      setInventory(updatedInventory);\n      onInventoryUpdate?.(updatedInventory);\n      \n      setEditingItem(null);\n      resetForm();\n      setSuccessMessage('Item updated successfully!');\n    } catch (err) {\n      setError('Failed to update item. Please try again.');\n      console.error('Error updating item:', err);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDeleteItem = async (id: string) => {\n    if (!confirm('Are you sure you want to delete this item?')) return;\n    \n    setSaving(true);\n    setError(null);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      const updatedInventory = inventory.filter(item => item.id !== id);\n      setInventory(updatedInventory);\n      onInventoryUpdate?.(updatedInventory);\n      \n      setSuccessMessage('Item deleted successfully!');\n    } catch (err) {\n      setError('Failed to delete item. Please try again.');\n      console.error('Error deleting item:', err);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const resetForm = () => {\n    setFormData({\n      name: '',\n      brand: '',\n      model: '',\n      category: '',\n      type: '',\n      totalStock: 0,\n      price: 0,\n      listPrice: 0,\n      sgkPrice: 0,\n      warrantyPeriod: 12,\n      notes: ''\n    });\n    setFormErrors({});\n  };\n\n  const startEdit = (item: InventoryItem) => {\n    setEditingItem(item);\n    setFormData({\n      name: item.name,\n      brand: item.brand,\n      model: item.model,\n      category: item.category,\n      type: item.type,\n      totalStock: item.totalStock,\n      price: item.price,\n      listPrice: item.listPrice,\n      sgkPrice: item.sgkPrice,\n      warrantyPeriod: item.warrantyPeriod,\n      notes: item.notes || ''\n    });\n    setFormErrors({});\n  };\n\n  const cancelEdit = () => {\n    setEditingItem(null);\n    setShowAddForm(false);\n    resetForm();\n  };\n\n  // Filter inventory based on search and filters\n  const filteredInventory = inventory.filter(item => {\n    const matchesSearch = item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         item.brand.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         item.model.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesCategory = !categoryFilter || item.category === categoryFilter;\n    const matchesType = !typeFilter || item.type === typeFilter;\n    \n    return matchesSearch && matchesCategory && matchesType;\n  });\n\n  const categoryOptions = [\n    { value: '', label: 'All Categories' },\n    { value: 'hearing_aid', label: 'Hearing Aid' },\n    { value: 'cochlear_implant', label: 'Cochlear Implant' },\n    { value: 'bone_anchored', label: 'Bone Anchored' },\n    { value: 'accessories', label: 'Accessories' }\n  ];\n\n  const typeOptions = [\n    { value: '', label: 'All Types' },\n    { value: 'behind_ear', label: 'Behind the Ear (BTE)' },\n    { value: 'in_ear', label: 'In the Ear (ITE)' },\n    { value: 'in_canal', label: 'In the Canal (ITC)' },\n    { value: 'completely_in_canal', label: 'Completely in Canal (CIC)' },\n    { value: 'internal', label: 'Internal' },\n    { value: 'external', label: 'External' }\n  ];\n\n  const getStockStatus = (item: InventoryItem) => {\n    const stockPercentage = (item.availableStock / item.totalStock) * 100;\n    if (stockPercentage <= 10) return { color: 'text-red-600', label: 'Critical' };\n    if (stockPercentage <= 25) return { color: 'text-yellow-600', label: 'Low' };\n    return { color: 'text-green-600', label: 'Good' };\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title=\"Inventory Management\"\n      size=\"xl\"\n      className=\"max-w-7xl\"\n    >\n      <div className=\"space-y-6\">\n        {/* Status Messages */}\n        {error && (\n          <div className=\"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700\">\n            <AlertCircle className=\"w-5 h-5 flex-shrink-0\" />\n            <span>{error}</span>\n          </div>\n        )}\n        \n        {successMessage && (\n          <div className=\"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700\">\n            <CheckCircle className=\"w-5 h-5 flex-shrink-0\" />\n            <span>{successMessage}</span>\n          </div>\n        )}\n\n        {/* Header Actions */}\n        <div className=\"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center\">\n          <div className=\"flex items-center gap-2\">\n            <Package className=\"w-6 h-6 text-blue-600\" />\n            <h2 className=\"text-xl font-semibold\">Inventory Items</h2>\n            {loading && <Loader2 className=\"w-5 h-5 animate-spin text-blue-600\" />}\n          </div>\n          \n          <div className=\"flex flex-wrap gap-2\">\n            <Button\n              onClick={loadInventory}\n              disabled={loading}\n              variant=\"outline\"\n              size=\"sm\"\n            >\n              <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} />\n              Refresh\n            </Button>\n            <Button\n              onClick={() => setShowAddForm(true)}\n              disabled={loading || saving}\n              size=\"sm\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Add Item\n            </Button>\n          </div>\n        </div>\n\n        {/* Search and Filters */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n            <Input\n              placeholder=\"Search items...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-10\"\n              disabled={loading}\n            />\n          </div>\n          \n          <Select\n            label=\"\"\n            options={categoryOptions}\n            value={categoryFilter}\n            onChange={(e) => setCategoryFilter(e.target.value)}\n            disabled={loading}\n          />\n          \n          <Select\n            label=\"\"\n            options={typeOptions}\n            value={typeFilter}\n            onChange={(e) => setTypeFilter(e.target.value)}\n            disabled={loading}\n          />\n          \n          <div className=\"flex items-center gap-2 text-sm text-gray-600\">\n            <Filter className=\"w-4 h-4\" />\n            <span>{filteredInventory.length} of {inventory.length} items</span>\n          </div>\n        </div>\n\n         {/* Inventory Table */}\n         {loading ? (\n           <div className=\"flex items-center justify-center py-12\">\n             <div className=\"text-center\">\n               <Loader2 className=\"w-8 h-8 animate-spin text-blue-600 mx-auto mb-2\" />\n               <p className=\"text-gray-600\">Loading inventory...</p>\n             </div>\n           </div>\n         ) : (\n           <div className=\"overflow-x-auto\">\n             <table className=\"w-full border-collapse\">\n               <thead>\n                 <tr className=\"bg-gray-50\">\n                   <th className=\"text-left p-3 font-medium border-b\">Item Details</th>\n                   <th className=\"text-left p-3 font-medium border-b\">Stock Status</th>\n                   <th className=\"text-left p-3 font-medium border-b\">Pricing</th>\n                   <th className=\"text-left p-3 font-medium border-b\">Warranty</th>\n                   <th className=\"text-center p-3 font-medium border-b\">Actions</th>\n                 </tr>\n               </thead>\n               <tbody>\n                 {filteredInventory.map((item) => {\n                   const stockStatus = getStockStatus(item);\n                   return (\n                     <tr key={item.id} className=\"border-b hover:bg-gray-50\">\n                       <td className=\"p-3 border-b\">\n                         <div className=\"space-y-1\">\n                           <div className=\"font-medium text-gray-900\">{item.name}</div>\n                           <div className=\"text-sm text-gray-600\">{item.brand} - {item.model}</div>\n                           <div className=\"text-xs text-gray-500\">\n                             {categoryOptions.find(c => c.value === item.category)?.label} • \n                             {typeOptions.find(t => t.value === item.type)?.label}\n                           </div>\n                         </div>\n                       </td>\n                       <td className=\"p-3 border-b\">\n                         <div className=\"space-y-1\">\n                           <div className=\"text-sm\">\n                             <span className=\"font-medium\">Available:</span> {item.availableStock}\n                           </div>\n                           <div className=\"text-sm\">\n                             <span className=\"font-medium\">Total:</span> {item.totalStock}\n                           </div>\n                           <div className={`text-xs font-medium ${stockStatus.color}`}>\n                             {stockStatus.label}\n                           </div>\n                         </div>\n                       </td>\n                       <td className=\"p-3 border-b\">\n                         <div className=\"space-y-1 text-sm\">\n                           <div><span className=\"font-medium\">Price:</span> ₺{item.price.toLocaleString()}</div>\n                           <div><span className=\"font-medium\">List:</span> ₺{item.listPrice.toLocaleString()}</div>\n                           <div><span className=\"font-medium\">SGK:</span> ₺{item.sgkPrice.toLocaleString()}</div>\n                         </div>\n                       </td>\n                       <td className=\"p-3 border-b\">\n                         <div className=\"text-sm\">\n                           {item.warrantyPeriod} months\n                         </div>\n                       </td>\n                       <td className=\"p-3 border-b\">\n                         <div className=\"flex justify-center gap-2\">\n                           <Button\n                             onClick={() => startEdit(item)}\n                             variant=\"outline\"\n                             size=\"sm\"\n                             disabled={saving}\n                           >\n                             <Edit className=\"w-4 h-4\" />\n                           </Button>\n                           <Button\n                             onClick={() => handleDeleteItem(item.id)}\n                             variant=\"outline\"\n                             size=\"sm\"\n                             disabled={saving}\n                             className=\"text-red-600 hover:text-red-700 hover:border-red-300\"\n                           >\n                             {saving ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Trash2 className=\"w-4 h-4\" />}\n                           </Button>\n                         </div>\n                       </td>\n                     </tr>\n                   );\n                 })}\n               </tbody>\n             </table>\n             \n             {filteredInventory.length === 0 && !loading && (\n               <div className=\"text-center py-8 text-gray-500\">\n                 {inventory.length === 0 ? 'No inventory items found.' : 'No items match your search criteria.'}\n               </div>\n             )}\n           </div>\n         )}\n\n        {/* Add/Edit Item Modal */}\n        {(showAddForm || editingItem) && (\n          <Modal\n            isOpen={true}\n            onClose={cancelEdit}\n            title={editingItem ? 'Edit Item' : 'Add New Item'}\n            size=\"lg\"\n          >\n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <Input\n                  label=\"Item Name\"\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  error={formErrors.name}\n                  disabled={saving}\n                  required\n                />\n                \n                <Input\n                  label=\"Brand\"\n                  value={formData.brand}\n                  onChange={(e) => setFormData({ ...formData, brand: e.target.value })}\n                  error={formErrors.brand}\n                  disabled={saving}\n                  required\n                />\n                \n                <Input\n                  label=\"Model\"\n                  value={formData.model}\n                  onChange={(e) => setFormData({ ...formData, model: e.target.value })}\n                  error={formErrors.model}\n                  disabled={saving}\n                  required\n                />\n                \n                <Select\n                  label=\"Category\"\n                  options={categoryOptions.filter(opt => opt.value !== '')}\n                  value={formData.category}\n                  onChange={(e) => setFormData({ ...formData, category: e.target.value })}\n                  error={formErrors.category}\n                  disabled={saving}\n                  required\n                />\n                \n                <Select\n                  label=\"Type\"\n                  options={typeOptions.filter(opt => opt.value !== '')}\n                  value={formData.type}\n                  onChange={(e) => setFormData({ ...formData, type: e.target.value })}\n                  error={formErrors.type}\n                  disabled={saving}\n                  required\n                />\n                \n                <Input\n                  label=\"Total Stock\"\n                  type=\"number\"\n                  value={formData.totalStock}\n                  onChange={(e) => setFormData({ ...formData, totalStock: parseInt(e.target.value) || 0 })}\n                  error={formErrors.totalStock}\n                  disabled={saving}\n                  min=\"0\"\n                  required\n                />\n                \n                <Input\n                  label=\"Price (₺)\"\n                  type=\"number\"\n                  value={formData.price}\n                  onChange={(e) => setFormData({ ...formData, price: parseFloat(e.target.value) || 0 })}\n                  error={formErrors.price}\n                  disabled={saving}\n                  min=\"0\"\n                  step=\"0.01\"\n                  required\n                />\n                \n                <Input\n                  label=\"List Price (₺)\"\n                  type=\"number\"\n                  value={formData.listPrice}\n                  onChange={(e) => setFormData({ ...formData, listPrice: parseFloat(e.target.value) || 0 })}\n                  error={formErrors.listPrice}\n                  disabled={saving}\n                  min=\"0\"\n                  step=\"0.01\"\n                  required\n                />\n                \n                <Input\n                  label=\"SGK Price (₺)\"\n                  type=\"number\"\n                  value={formData.sgkPrice}\n                  onChange={(e) => setFormData({ ...formData, sgkPrice: parseFloat(e.target.value) || 0 })}\n                  error={formErrors.sgkPrice}\n                  disabled={saving}\n                  min=\"0\"\n                  step=\"0.01\"\n                  required\n                />\n                \n                <Input\n                  label=\"Warranty Period (months)\"\n                  type=\"number\"\n                  value={formData.warrantyPeriod}\n                  onChange={(e) => setFormData({ ...formData, warrantyPeriod: parseInt(e.target.value) || 12 })}\n                  error={formErrors.warrantyPeriod}\n                  disabled={saving}\n                  min=\"1\"\n                  max=\"120\"\n                  required\n                />\n              </div>\n              \n              <Textarea\n                label=\"Notes\"\n                value={formData.notes}\n                onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                disabled={saving}\n                rows={3}\n              />\n              \n              <div className=\"flex justify-end gap-3 pt-4\">\n                <Button\n                  onClick={cancelEdit}\n                  variant=\"outline\"\n                  disabled={saving}\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={editingItem ? handleEditItem : handleAddItem}\n                  disabled={saving}\n                >\n                  {saving ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      {editingItem ? 'Updating...' : 'Adding...'}\n                    </>\n                  ) : (\n                    editingItem ? 'Update Item' : 'Add Item'\n                  )}\n                </Button>\n              </div>\n            </div>\n          </Modal>\n        )}\n      </div>\n    </Modal>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/PatientDeviceCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/PatientDocumentCard.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":148,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":154,"endColumn":20}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React from 'react';\nimport { PatientDocument } from '../../hooks/patient/usePatientDocuments';\nimport {\n  FileText,\n  File,\n  Download,\n  Calendar,\n  User,\n  Tag,\n  FileImage,\n  FileVideo,\n  FileAudio,\n  Archive\n} from 'lucide-react';\n\ninterface PatientDocumentCardProps {\n  document: PatientDocument;\n  onDocumentClick?: (document: PatientDocument) => void;\n  onDownloadClick?: (document: PatientDocument) => void;\n}\n\nexport const PatientDocumentCard: React.FC<PatientDocumentCardProps> = ({\n  document,\n  onDocumentClick,\n  onDownloadClick\n}) => {\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n\n  const formatFileSize = (bytes?: number) => {\n    if (!bytes) return '';\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(1024));\n    return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];\n  };\n\n  const getDocumentIcon = (mimeType?: string) => {\n    if (!mimeType) return <File className=\"w-5 h-5\" />;\n\n    if (mimeType.startsWith('image/')) return <FileImage className=\"w-5 h-5\" />;\n    if (mimeType.startsWith('video/')) return <FileVideo className=\"w-5 h-5\" />;\n    if (mimeType.startsWith('audio/')) return <FileAudio className=\"w-5 h-5\" />;\n    if (mimeType.includes('pdf') || mimeType.includes('document')) return <FileText className=\"w-5 h-5\" />;\n    if (mimeType.includes('zip') || mimeType.includes('rar')) return <Archive className=\"w-5 h-5\" />;\n\n    return <File className=\"w-5 h-5\" />;\n  };\n\n  const getDocumentTypeColor = (documentType: string) => {\n    switch (documentType) {\n      case 'medical_record':\n        return 'bg-red-100 text-red-800';\n      case 'prescription':\n        return 'bg-blue-100 text-blue-800';\n      case 'test_result':\n        return 'bg-green-100 text-green-800';\n      case 'invoice':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'consent':\n        return 'bg-purple-100 text-purple-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getDocumentTypeText = (documentType: string) => {\n    switch (documentType) {\n      case 'medical_record':\n        return 'Tıbbi Kayıt';\n      case 'prescription':\n        return 'Reçete';\n      case 'test_result':\n        return 'Test Sonucu';\n      case 'invoice':\n        return 'Fatura';\n      case 'consent':\n        return 'Onam Formu';\n      default:\n        return 'Diğer';\n    }\n  };\n\n  const getStatusColor = (status?: string) => {\n    switch (status) {\n      case 'completed':\n        return 'bg-green-100 text-green-800';\n      case 'processing':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'failed':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusText = (status?: string) => {\n    switch (status) {\n      case 'completed':\n        return 'Tamamlandı';\n      case 'processing':\n        return 'İşleniyor';\n      case 'failed':\n        return 'Başarısız';\n      default:\n        return 'Bilinmiyor';\n    }\n  };\n\n  return (\n    <div\n      className=\"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\"\n      role=\"article\"\n      aria-label={`Belge: ${document.title}`}\n    >\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex items-center\">\n          <div className=\"text-blue-500 mr-3\">\n            {getDocumentIcon(document.mimeType)}\n          </div>\n          <div className=\"min-w-0 flex-1\">\n            <h4\n              className=\"text-sm font-medium text-gray-900 truncate cursor-pointer hover:text-blue-600\"\n              onClick={() => onDocumentClick?.(document)}\n              role=\"button\"\n              tabIndex={0}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' || e.key === ' ') {\n                  e.preventDefault();\n                  onDocumentClick?.(document);\n                }\n              }}\n            >\n              {document.title}\n            </h4>\n            <p className=\"text-xs text-gray-500 truncate\">\n              {document.originalName || document.fileName}\n            </p>\n          </div>\n        </div>\n\n        <div className=\"flex items-center space-x-2\">\n          <button\n            onClick={() => onDownloadClick?.(document)}\n            className=\"p-1 text-gray-400 hover:text-blue-500 transition-colors\"\n            aria-label={`${document.title} dosyasını indir`}\n          >\n            <Download className=\"w-4 h-4\" />\n          </button>\n        </div>\n      </div>\n\n      <div className=\"space-y-2\">\n        {document.description && (\n          <p className=\"text-sm text-gray-600 line-clamp-2\">\n            {document.description}\n          </p>\n        )}\n\n        <div className=\"flex items-center justify-between text-xs text-gray-500\">\n          <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getDocumentTypeColor(document.documentType)}`}>\n            {getDocumentTypeText(document.documentType)}\n          </span>\n          {document.status && (\n            <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(document.status)}`}>\n              {getStatusText(document.status)}\n            </span>\n          )}\n        </div>\n\n        <div className=\"flex items-center justify-between text-xs text-gray-500\">\n          <div className=\"flex items-center\">\n            <Calendar className=\"w-3 h-3 mr-1\" aria-hidden=\"true\" />\n            {formatDate(document.uploadDate)}\n          </div>\n          {document.fileSize && (\n            <span>{formatFileSize(document.fileSize)}</span>\n          )}\n        </div>\n\n        <div className=\"flex items-center justify-between text-xs text-gray-500\">\n          {document.createdBy && (\n            <div className=\"flex items-center\">\n              <User className=\"w-3 h-3 mr-1\" aria-hidden=\"true\" />\n              {document.createdBy}\n            </div>\n          )}\n          {document.mimeType && (\n            <span className=\"text-xs bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded\">\n              {document.mimeType}\n            </span>\n          )}\n        </div>\n\n        {document.tags && document.tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-1 mt-2\">\n            {document.tags.slice(0, 3).map((tag, index) => (\n              <span\n                key={index}\n                className=\"inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-700\"\n              >\n                <Tag className=\"w-3 h-3 mr-1\" />\n                {tag}\n              </span>\n            ))}\n            {document.tags.length > 3 && (\n              <span className=\"text-xs text-gray-500\">\n                +{document.tags.length - 3} daha\n              </span>\n            )}\n          </div>\n        )}\n\n        {document.metadata && Object.keys(document.metadata).length > 0 && (\n          <div className=\"mt-2 pt-2 border-t border-gray-100\">\n            <p className=\"text-xs text-gray-500 mb-1\">Ek bilgiler:</p>\n            <div className=\"text-xs text-gray-600\">\n              {Object.entries(document.metadata).slice(0, 2).map(([key, value]) => (\n                <div key={key} className=\"inline-block mr-3\">\n                  <span className=\"font-medium\">{key}:</span> {String(value)}\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/PatientOverviewTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Phone' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Mail' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":7}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Patient } from '../../types/patient/patient-base.types';\nimport {\n  User,\n  Phone,\n  Mail,\n  MapPin,\n  Tag,\n  AlertCircle,\n  CheckCircle\n} from 'lucide-react';\n\ninterface PatientOverviewTabProps {\n  patient: Patient;\n}\n\nexport const PatientOverviewTab: React.FC<PatientOverviewTabProps> = ({ patient }) => {\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return 'Belirtilmemiş';\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Personal Information */}\n      <div className=\"bg-gray-50 rounded-lg p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <User className=\"w-5 h-5 mr-2\" />\n          Kişisel Bilgiler\n        </h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Ad Soyad</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.firstName || ''} {patient.lastName || ''}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">TC Kimlik No</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.tcNumber}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Telefon</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.phone || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">E-posta</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.email || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Doğum Tarihi</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{formatDate(patient.birthDate)}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Cinsiyet</label>\n            <p className=\"mt-1 text-sm text-gray-900\">Belirtilmemiş</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Address Information */}\n      <div className=\"bg-gray-50 rounded-lg p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <MapPin className=\"w-5 h-5 mr-2\" />\n          Adres Bilgileri\n        </h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div className=\"md:col-span-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">Tam Adres</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.addressFull || 'Belirtilmemiş'}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Additional Information */}\n      <div className=\"bg-gray-50 rounded-lg p-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <Tag className=\"w-5 h-5 mr-2\" />\n          Ek Bilgiler\n        </h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Durum</label>\n            <p className=\"mt-1\">\n              <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                patient.status === 'ACTIVE' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\n              }`}>\n                {patient.status === 'ACTIVE' ? (\n                  <CheckCircle className=\"w-3 h-3 mr-1\" />\n                ) : (\n                  <AlertCircle className=\"w-3 h-3 mr-1\" />\n                )}\n                {patient.status === 'ACTIVE' ? 'Aktif' : 'Pasif'}\n              </span>\n            </p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Segment</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.segment || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Edinim Türü</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.acquisitionType || 'Belirtilmemiş'}</p>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Öncelik Skoru</label>\n            <p className=\"mt-1 text-sm text-gray-900\">{patient.priorityScore || 'Belirtilmemiş'}</p>\n          </div>\n        </div>\n\n        {patient.tags && patient.tags.length > 0 && (\n          <div className=\"mt-4\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Etiketler</label>\n            <div className=\"flex flex-wrap gap-2\">\n              {patient.tags.map((tag, index) => (\n                <span\n                  key={index}\n                  className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\"\n                >\n                  {tag}\n                </span>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/PatientSaleCard.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TrendingUp' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'showActions' is assigned a value but never used.","line":39,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setShowActions' is assigned a value but never used.","line":39,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":37}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React, { useState } from 'react';\nimport { PatientSale } from '../../hooks/patient/usePatientSales';\nimport {\n  DollarSign,\n  Calendar,\n  User,\n  Package,\n  CreditCard,\n  TrendingUp,\n  TrendingDown,\n  FileText,\n  Eye,\n  Receipt,\n  Banknote,\n  RefreshCw\n} from 'lucide-react';\nimport { Button } from '../ui/Button';\n\ninterface PatientSaleCardProps {\n  sale: PatientSale;\n  onSaleClick?: (sale: PatientSale) => void;\n  onCreateInvoice?: (sale: PatientSale) => void;\n  onViewInvoice?: (sale: PatientSale) => void;\n  onManagePromissoryNotes?: (sale: PatientSale) => void;\n  onCollectPayment?: (sale: PatientSale) => void;\n  onManageInstallments?: (sale: PatientSale) => void;\n}\n\nexport const PatientSaleCard: React.FC<PatientSaleCardProps> = ({\n  sale,\n  onSaleClick,\n  onCreateInvoice,\n  onViewInvoice,\n  onManagePromissoryNotes,\n  onCollectPayment,\n  onManageInstallments\n}) => {\n  const [showActions, setShowActions] = useState(false);\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const getPaymentStatusColor = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return 'bg-green-100 text-green-800';\n      case 'pending':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'cancelled':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getPaymentStatusText = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return 'Tamamlandı';\n      case 'pending':\n        return 'Bekliyor';\n      case 'cancelled':\n        return 'İptal Edildi';\n      default:\n        return status;\n    }\n  };\n\n  const getPaymentMethodText = (method?: string) => {\n    switch (method) {\n      case 'cash':\n        return 'Nakit';\n      case 'card':\n        return 'Kart';\n      case 'installment':\n        return 'Taksit';\n      case 'insurance':\n        return 'Sigorta';\n      default:\n        return method || 'Belirtilmemiş';\n    }\n  };\n\n  return (\n    <div\n      className=\"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer\"\n      onClick={() => onSaleClick?.(sale)}\n      role=\"button\"\n      tabIndex={0}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          onSaleClick?.(sale);\n        }\n      }}\n      aria-label={`Satış: ${sale.productId || 'Ürün'} - ${formatCurrency(sale.totalAmount)}`}\n    >\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex items-center\">\n          <Package className=\"w-5 h-5 text-blue-500 mr-2\" aria-hidden=\"true\" />\n          <h4 className=\"text-sm font-medium text-gray-900 truncate\">\n            {sale.productId || 'Ürün Satışı'}\n          </h4>\n        </div>\n        <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getPaymentStatusColor(sale.paymentStatus)}`}>\n          {getPaymentStatusText(sale.paymentStatus)}\n        </span>\n      </div>\n\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between\">\n          <span className=\"text-sm text-gray-600\">Toplam Tutar:</span>\n          <span className=\"text-sm font-semibold text-gray-900\">\n            {formatCurrency(sale.totalAmount)}\n          </span>\n        </div>\n\n        {sale.discountAmount > 0 && (\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm text-gray-600\">İndirim:</span>\n            <span className=\"text-sm text-green-600 flex items-center\">\n              <TrendingDown className=\"w-3 h-3 mr-1\" />\n              -{formatCurrency(sale.discountAmount)}\n            </span>\n          </div>\n        )}\n\n        <div className=\"flex items-center justify-between\">\n          <span className=\"text-sm text-gray-600\">Net Tutar:</span>\n          <span className=\"text-sm font-semibold text-blue-600\">\n            {formatCurrency(sale.finalAmount)}\n          </span>\n        </div>\n\n        {sale.paidAmount > 0 && (\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm text-gray-600\">Ödenen:</span>\n            <span className=\"text-sm text-green-600\">\n              {formatCurrency(sale.paidAmount)}\n            </span>\n          </div>\n        )}\n\n        {sale.remainingAmount && sale.remainingAmount > 0 && (\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm text-gray-600\">Kalan:</span>\n            <span className=\"text-sm text-red-600\">\n              {formatCurrency(sale.remainingAmount)}\n            </span>\n          </div>\n        )}\n\n        <div className=\"flex items-center text-sm text-gray-600\">\n          <Calendar className=\"w-4 h-4 mr-1\" aria-hidden=\"true\" />\n          {formatDate(sale.saleDate)}\n        </div>\n\n        {sale.paymentMethod && (\n          <div className=\"flex items-center text-sm text-gray-600\">\n            <CreditCard className=\"w-4 h-4 mr-1\" aria-hidden=\"true\" />\n            {getPaymentMethodText(sale.paymentMethod)}\n          </div>\n        )}\n\n        {sale.soldBy && (\n          <div className=\"flex items-center text-sm text-gray-600\">\n            <User className=\"w-4 h-4 mr-1\" aria-hidden=\"true\" />\n            {sale.soldBy}\n          </div>\n        )}\n\n        {sale.sgkCoverage && sale.sgkCoverage > 0 && (\n          <div className=\"flex items-center text-sm text-blue-600\">\n            <DollarSign className=\"w-4 h-4 mr-1\" aria-hidden=\"true\" />\n            SGK Desteği: {formatCurrency(sale.sgkCoverage)}\n          </div>\n        )}\n\n        {sale.devices && sale.devices.length > 0 && (\n          <div className=\"mt-3 pt-3 border-t border-gray-100\">\n            <p className=\"text-xs text-gray-500 mb-2\">Cihazlar:</p>\n            <div className=\"space-y-1\">\n              {sale.devices.slice(0, 2).map((device, index) => (\n                <div key={index} className=\"text-xs text-gray-600 flex items-center\">\n                  <Smartphone className=\"w-3 h-3 mr-1\" />\n                  {device.name} {device.ear && `(${device.ear})`}\n                </div>\n              ))}\n              {sale.devices.length > 2 && (\n                <div className=\"text-xs text-gray-500\">\n                  +{sale.devices.length - 2} daha...\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {sale.paymentPlan && (\n          <div className=\"mt-3 pt-3 border-t border-gray-100\">\n            <p className=\"text-xs text-gray-500 mb-1\">Taksit Planı:</p>\n            <div className=\"text-xs text-gray-600\">\n              {sale.paymentPlan.installmentCount} taksit × {formatCurrency(sale.paymentPlan.installmentAmount)}\n            </div>\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"mt-4 pt-3 border-t border-gray-100\">\n          <div className=\"flex flex-wrap gap-2\">\n            {/* Invoice Actions */}\n            {!sale.invoiceId ? (\n              <Button\n                variant=\"secondary\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onCreateInvoice?.(sale);\n                }}\n                className=\"text-xs px-2 py-1\"\n              >\n                <FileText className=\"w-3 h-3 mr-1\" />\n                Fatura Oluştur\n              </Button>\n            ) : (\n              <Button\n                variant=\"secondary\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onViewInvoice?.(sale);\n                }}\n                className=\"text-xs px-2 py-1\"\n              >\n                <Eye className=\"w-3 h-3 mr-1\" />\n                Fatura Önizle\n              </Button>\n            )}\n\n            {/* Payment Collection */}\n            {sale.remainingAmount && sale.remainingAmount > 0 && (\n              <Button\n                variant=\"secondary\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onCollectPayment?.(sale);\n                }}\n                className=\"text-xs px-2 py-1\"\n              >\n                <Receipt className=\"w-3 h-3 mr-1\" />\n                Tahsilat\n              </Button>\n            )}\n\n            {/* Promissory Notes */}\n            {sale.paymentMethod === 'installment' && (\n              <Button\n                variant=\"secondary\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onManagePromissoryNotes?.(sale);\n                }}\n                className=\"text-xs px-2 py-1\"\n              >\n                <Banknote className=\"w-3 h-3 mr-1\" />\n                Senetler\n              </Button>\n            )}\n\n            {/* Installment Management */}\n            {sale.paymentPlan && (\n              <Button\n                variant=\"secondary\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  onManageInstallments?.(sale);\n                }}\n                className=\"text-xs px-2 py-1\"\n              >\n                <RefreshCw className=\"w-3 h-3 mr-1\" />\n                Taksitler\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/PatientTimelineCard.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React from 'react';\nimport { TimelineEvent } from '../../hooks/patient/usePatientTimeline';\nimport {\n  Calendar,\n  User,\n  FileText,\n  Smartphone,\n  DollarSign,\n  Stethoscope,\n  CreditCard,\n  MessageSquare,\n  Activity\n} from 'lucide-react';\n\ninterface PatientTimelineCardProps {\n  event: TimelineEvent;\n  onEventClick?: (event: TimelineEvent) => void;\n}\n\nexport const PatientTimelineCard: React.FC<PatientTimelineCardProps> = ({\n  event,\n  onEventClick\n}) => {\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const getEventIcon = (eventType: string) => {\n    switch (eventType) {\n      case 'appointment':\n        return <Calendar className=\"w-4 h-4\" />;\n      case 'sale':\n        return <DollarSign className=\"w-4 h-4\" />;\n      case 'device_assignment':\n        return <Smartphone className=\"w-4 h-4\" />;\n      case 'note':\n        return <MessageSquare className=\"w-4 h-4\" />;\n      case 'test':\n      case 'hearing_test':\n        return <Stethoscope className=\"w-4 h-4\" />;\n      case 'payment':\n        return <CreditCard className=\"w-4 h-4\" />;\n      case 'document':\n        return <FileText className=\"w-4 h-4\" />;\n      case 'activity':\n        return <Activity className=\"w-4 h-4\" />;\n      default:\n        return <Activity className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getEventTypeColor = (eventType: string) => {\n    switch (eventType) {\n      case 'appointment':\n        return 'bg-blue-100 text-blue-800';\n      case 'sale':\n        return 'bg-green-100 text-green-800';\n      case 'device_assignment':\n        return 'bg-purple-100 text-purple-800';\n      case 'note':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'test':\n      case 'hearing_test':\n        return 'bg-red-100 text-red-800';\n      case 'payment':\n        return 'bg-indigo-100 text-indigo-800';\n      case 'document':\n        return 'bg-cyan-100 text-cyan-800';\n      case 'activity':\n        return 'bg-gray-100 text-gray-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getEventTypeText = (eventType: string) => {\n    switch (eventType) {\n      case 'appointment':\n        return 'Randevu';\n      case 'sale':\n        return 'Satış';\n      case 'device_assignment':\n        return 'Cihaz Atama';\n      case 'note':\n        return 'Not';\n      case 'test':\n      case 'hearing_test':\n        return 'İşitme Testi';\n      case 'payment':\n        return 'Ödeme';\n      case 'document':\n        return 'Belge';\n      case 'activity':\n        return 'Aktivite';\n      default:\n        return eventType;\n    }\n  };\n\n  const getSourceBadge = (source?: string) => {\n    if (!source) return null;\n    return (\n      <span className=\"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 text-gray-600 ml-2\">\n        {source === 'activity_log' ? 'Log' : 'Manuel'}\n      </span>\n    );\n  };\n\n  return (\n    <div\n      className=\"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer\"\n      onClick={() => onEventClick?.(event)}\n      role=\"button\"\n      tabIndex={0}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          onEventClick?.(event);\n        }\n      }}\n      aria-label={`Olay: ${event.title} - ${getEventTypeText(event.eventType)}`}\n    >\n      <div className=\"flex items-start space-x-3\">\n        <div className={`p-2 rounded-full ${getEventTypeColor(event.eventType)}`}>\n          {getEventIcon(event.eventType)}\n        </div>\n\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center justify-between mb-1\">\n            <h4 className=\"text-sm font-medium text-gray-900 truncate\">\n              {event.title}\n            </h4>\n            <div className=\"flex items-center\">\n              {getSourceBadge(event.source)}\n              <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-2 ${getEventTypeColor(event.eventType)}`}>\n                {getEventTypeText(event.eventType)}\n              </span>\n            </div>\n          </div>\n\n          {event.description && (\n            <p className=\"text-sm text-gray-600 mb-2 line-clamp-2\">\n              {event.description}\n            </p>\n          )}\n\n          {event.details && Object.keys(event.details).length > 0 && (\n            <div className=\"text-xs text-gray-500 mb-2\">\n              {Object.entries(event.details).slice(0, 2).map(([key, value]) => (\n                <div key={key} className=\"inline-block mr-3\">\n                  <span className=\"font-medium\">{key}:</span> {String(value)}\n                </div>\n              ))}\n            </div>\n          )}\n\n          <div className=\"flex items-center justify-between text-xs text-gray-500\">\n            <div className=\"flex items-center\">\n              <Calendar className=\"w-3 h-3 mr-1\" aria-hidden=\"true\" />\n              {formatDate(event.eventDate)}\n            </div>\n\n            <div className=\"flex items-center space-x-3\">\n              {event.category && (\n                <span className=\"text-xs bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded\">\n                  {event.category}\n                </span>\n              )}\n              {event.user && (\n                <div className=\"flex items-center\">\n                  <User className=\"w-3 h-3 mr-1\" aria-hidden=\"true\" />\n                  {event.user}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/SalesFilters.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":48,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":54,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":56,"column":9,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":66,"endColumn":18},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":75,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":84,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":91,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":101,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":108,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":113,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":120,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":125,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":135,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":140,"endColumn":20}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Search, Filter } from 'lucide-react';\n\ninterface SalesFiltersProps {\n  searchTerm: string;\n  onSearchChange: (value: string) => void;\n  statusFilter: string;\n  onStatusFilterChange: (value: string) => void;\n  paymentMethodFilter: string;\n  onPaymentMethodFilterChange: (value: string) => void;\n  dateFrom: string;\n  onDateFromChange: (value: string) => void;\n  dateTo: string;\n  onDateToChange: (value: string) => void;\n  showFilters: boolean;\n  onToggleFilters: () => void;\n  filteredCount: number;\n  totalCount: number;\n  onClearFilters: () => void;\n}\n\nexport const SalesFilters: React.FC<SalesFiltersProps> = ({\n  searchTerm,\n  onSearchChange,\n  statusFilter,\n  onStatusFilterChange,\n  paymentMethodFilter,\n  onPaymentMethodFilterChange,\n  dateFrom,\n  onDateFromChange,\n  dateTo,\n  onDateToChange,\n  showFilters,\n  onToggleFilters,\n  filteredCount,\n  totalCount,\n  onClearFilters\n}) => {\n  const hasActiveFilters = searchTerm || statusFilter !== 'all' || paymentMethodFilter !== 'all' || dateFrom || dateTo;\n\n  return (\n    <div className=\"mb-6 space-y-4\">\n      <div className=\"flex items-center space-x-4\">\n        <div className=\"flex-1 relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <Search className=\"w-4 h-4 text-gray-400\" />\n          </div>\n          <input\n            type=\"text\"\n            placeholder=\"Satışlarda ara... (ürün, ödeme yöntemi, satıcı, notlar)\"\n            value={searchTerm}\n            onChange={(e) => onSearchChange(e.target.value)}\n            className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n          />\n        </div>\n        <button\n          onClick={onToggleFilters}\n          className={`inline-flex items-center px-3 py-2 border rounded-md text-sm font-medium ${\n            showFilters\n              ? 'border-blue-500 text-blue-700 bg-blue-50'\n              : 'border-gray-300 text-gray-700 bg-white hover:bg-gray-50'\n          }`}\n        >\n          <Filter className=\"w-4 h-4 mr-2\" />\n          Filtreler\n        </button>\n      </div>\n\n      {showFilters && (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Durum\n            </label>\n            <select\n              value={statusFilter}\n              onChange={(e) => onStatusFilterChange(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n              <option value=\"all\">Tümü</option>\n              <option value=\"completed\">Tamamlandı</option>\n              <option value=\"pending\">Bekliyor</option>\n              <option value=\"cancelled\">İptal Edildi</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Ödeme Yöntemi\n            </label>\n            <select\n              value={paymentMethodFilter}\n              onChange={(e) => onPaymentMethodFilterChange(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            >\n              <option value=\"all\">Tümü</option>\n              <option value=\"cash\">Nakit</option>\n              <option value=\"card\">Kredi Kartı</option>\n              <option value=\"installment\">Taksit</option>\n              <option value=\"insurance\">Sigorta</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Başlangıç Tarihi\n            </label>\n            <input\n              type=\"date\"\n              value={dateFrom}\n              onChange={(e) => onDateFromChange(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Bitiş Tarihi\n            </label>\n            <input\n              type=\"date\"\n              value={dateTo}\n              onChange={(e) => onDateToChange(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n      )}\n\n      {hasActiveFilters && (\n        <div className=\"flex items-center justify-between text-sm text-gray-600\">\n          <span>\n            {filteredCount} / {totalCount} satış gösteriliyor\n          </span>\n          <button\n            onClick={onClearFilters}\n            className=\"text-blue-600 hover:text-blue-800 font-medium\"\n          >\n            Filtreleri Temizle\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/SalesList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[160,163],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[160,163],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[184,187],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[184,187],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[213,216],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[213,216],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[253,256],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[253,256],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[291,294],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[291,294],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[339,342],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[339,342],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[380,383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[380,383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[425,428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[425,428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { DollarSign } from 'lucide-react';\nimport { PatientSaleCard } from './PatientSaleCard';\n\ninterface SalesListProps {\n  sales: any[];\n  filteredSales: any[];\n  onSaleClick: (sale: any) => void;\n  onCreateInvoice: (sale: any) => void;\n  onViewInvoice: (sale: any) => void;\n  onManagePromissoryNotes: (sale: any) => void;\n  onCollectPayment: (sale: any) => void;\n  onManageInstallments: (sale: any) => void;\n}\n\nexport const SalesList: React.FC<SalesListProps> = ({\n  sales,\n  filteredSales,\n  onSaleClick,\n  onCreateInvoice,\n  onViewInvoice,\n  onManagePromissoryNotes,\n  onCollectPayment,\n  onManageInstallments\n}) => {\n  if (filteredSales.length === 0) {\n    return (\n      <div className=\"text-center py-12\" role=\"status\">\n        <DollarSign className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n          {sales.length === 0 ? 'Henüz satış yapılmamış' : 'Filtreye uygun satış bulunamadı'}\n        </h3>\n        <p className=\"text-gray-500\">\n          {sales.length === 0 \n            ? 'Bu hastaya henüz satış işlemi gerçekleştirilmemiş.'\n            : 'Lütfen filtre kriterlerinizi kontrol edin.'\n          }\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid gap-4\" role=\"list\" aria-label=\"Hasta satışları listesi\">\n      {filteredSales.map((sale) => (\n        <div key={sale.id} role=\"listitem\">\n          <PatientSaleCard\n            sale={sale}\n            onSaleClick={onSaleClick}\n            onCreateInvoice={onCreateInvoice}\n            onViewInvoice={onViewInvoice}\n            onManagePromissoryNotes={onManagePromissoryNotes}\n            onCollectPayment={onCollectPayment}\n            onManageInstallments={onManageInstallments}\n          />\n        </div>\n      ))}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patient/SalesStatistics.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AlertCircle' is defined but never used.","line":2,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[158,161],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[158,161],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'completedSales' is assigned a value but never used.","line":16,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'pendingSales' is assigned a value but never used.","line":17,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cancelledSales' is assigned a value but never used.","line":18,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":23}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { DollarSign, AlertCircle, CheckCircle, Clock, TrendingUp } from 'lucide-react';\n\ninterface SalesStatisticsProps {\n  sales: any[];\n  isVisible: boolean;\n}\n\nexport const SalesStatistics: React.FC<SalesStatisticsProps> = ({ sales, isVisible }) => {\n  // Calculate statistics\n  const totalRevenue = sales.reduce((sum, sale) => sum + (sale.totalAmount || 0), 0);\n  const totalPaid = sales.reduce((sum, sale) => sum + (sale.paidAmount || 0), 0);\n  const totalPending = totalRevenue - totalPaid;\n  const totalSGKSupport = sales.reduce((sum, sale) => sum + (sale.sgkSupport || 0), 0);\n\n  const completedSales = sales.filter(sale => sale.status === 'completed').length;\n  const pendingSales = sales.filter(sale => sale.status === 'pending').length;\n  const cancelledSales = sales.filter(sale => sale.status === 'cancelled').length;\n\n  if (!isVisible) return null;\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n      <div className=\"bg-green-50 p-4 rounded-lg\">\n        <div className=\"flex items-center\">\n          <DollarSign className=\"w-5 h-5 text-green-500 mr-2\" />\n          <div>\n            <p className=\"text-sm text-green-600\">Toplam Gelir</p>\n            <p className=\"text-lg font-semibold text-green-900\">\n              {new Intl.NumberFormat('tr-TR', {\n                style: 'currency',\n                currency: 'TRY'\n              }).format(totalRevenue)}\n            </p>\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"bg-blue-50 p-4 rounded-lg\">\n        <div className=\"flex items-center\">\n          <CheckCircle className=\"w-5 h-5 text-blue-500 mr-2\" />\n          <div>\n            <p className=\"text-sm text-blue-600\">Tahsil Edilen</p>\n            <p className=\"text-lg font-semibold text-blue-900\">\n              {new Intl.NumberFormat('tr-TR', {\n                style: 'currency',\n                currency: 'TRY'\n              }).format(totalPaid)}\n            </p>\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"bg-yellow-50 p-4 rounded-lg\">\n        <div className=\"flex items-center\">\n          <Clock className=\"w-5 h-5 text-yellow-500 mr-2\" />\n          <div>\n            <p className=\"text-sm text-yellow-600\">Bekleyen Tahsilat</p>\n            <p className=\"text-lg font-semibold text-yellow-900\">\n              {new Intl.NumberFormat('tr-TR', {\n                style: 'currency',\n                currency: 'TRY'\n              }).format(totalPending)}\n            </p>\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"bg-purple-50 p-4 rounded-lg\">\n        <div className=\"flex items-center\">\n          <TrendingUp className=\"w-5 h-5 text-purple-500 mr-2\" />\n          <div>\n            <p className=\"text-sm text-purple-600\">SGK Desteği</p>\n            <p className=\"text-lg font-semibold text-purple-900\">\n              {new Intl.NumberFormat('tr-TR', {\n                style: 'currency',\n                currency: 'TRY'\n              }).format(totalSGKSupport)}\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/LazyPatientCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Eye' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":270,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":270,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8791,8794],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8791,8794],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { memo, useCallback, useRef, useEffect, useMemo } from 'react';\nimport { Button, Badge } from '@x-ear/ui-web';\nimport { \n  User, \n  Phone, \n  Mail, \n  MessageSquare,\n  Eye,\n  Edit,\n  Trash2,\n  Calendar,\n  MapPin,\n  Clock\n} from 'lucide-react';\nimport { Patient } from '../../types/patient';\nimport { useLazyLoading } from '../../hooks/useVirtualScroll';\n\ninterface LazyPatientCardProps {\n  patient: Patient;\n  isSelected?: boolean;\n  onSelect?: (patientId: string) => void;\n  onClick?: (patient: Patient) => void;\n  onEdit?: (patient: Patient) => void;\n  onDelete?: (patient: Patient) => void;\n  onCommunication?: (patient: Patient) => void;\n  variant?: 'compact' | 'detailed';\n  showActions?: boolean;\n  className?: string;\n}\n\nconst LazyPatientCard: React.FC<LazyPatientCardProps> = memo(({\n  patient,\n  isSelected = false,\n  onSelect,\n  onClick,\n  onEdit,\n  onDelete,\n  onCommunication,\n  variant = 'compact',\n  showActions = true,\n  className = ''\n}) => {\n  const cardRef = useRef<HTMLDivElement>(null);\n  \n  const { observerRef, isVisible } = useLazyLoading({\n    threshold: 0.1,\n    rootMargin: '50px'\n  });\n\n  // Set up intersection observer\n  useEffect(() => {\n    if (cardRef.current && patient.id) {\n      const cleanup = observerRef(cardRef.current, patient.id);\n      return cleanup;\n    }\n  }, [observerRef, patient.id]);\n\n  // Format phone number\n  const formatPhone = useCallback((phone?: string) => {\n    if (!phone) return '-';\n    const cleaned = phone.replace(/\\D/g, '');\n    if (cleaned.length === 11 && cleaned.startsWith('0')) {\n      return `${cleaned.slice(0, 4)} ${cleaned.slice(4, 7)} ${cleaned.slice(7, 9)} ${cleaned.slice(9)}`;\n    }\n    return phone;\n  }, []);\n\n  // Get patient display name\n  const displayName = useMemo(() => {\n    if (patient.firstName && patient.lastName) {\n      return `${patient.firstName} ${patient.lastName}`;\n    }\n    return `${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta';\n  }, [patient.firstName, patient.lastName]);\n\n  // Get status badge\n  const getStatusBadge = useCallback((status?: string) => {\n    switch (status) {\n      case 'active':\n        return <Badge variant=\"success\" size=\"sm\">Aktif</Badge>;\n      case 'inactive':\n        return <Badge variant=\"warning\" size=\"sm\">Pasif</Badge>;\n      case 'archived':\n        return <Badge variant=\"secondary\" size=\"sm\">Arşiv</Badge>;\n      default:\n        return <Badge variant=\"default\" size=\"sm\">{status}</Badge>;\n    }\n  }, []);\n\n  // Get label badge\n  const getLabelBadge = useCallback((label?: string) => {\n    switch (label) {\n      case 'yeni':\n        return <Badge variant=\"primary\" size=\"sm\">Yeni</Badge>;\n      case 'arama-bekliyor':\n        return <Badge variant=\"warning\" size=\"sm\">Arama Bekliyor</Badge>;\n      case 'randevu-verildi':\n        return <Badge variant=\"primary\" size=\"sm\">Randevu Verildi</Badge>;\n      case 'deneme-yapildi':\n        return <Badge variant=\"success\" size=\"sm\">Deneme Yapıldı</Badge>;\n      case 'kontrol-hastasi':\n        return <Badge variant=\"secondary\" size=\"sm\">Kontrol Hastası</Badge>;\n      case 'satis-tamamlandi':\n        return <Badge variant=\"success\" size=\"sm\">Satış Tamamlandı</Badge>;\n      default:\n        return <Badge variant=\"default\" size=\"sm\">{label}</Badge>;\n    }\n  }, []);\n\n  // Handle card click\n  const handleCardClick = useCallback(() => {\n    if (onClick) {\n      onClick(patient);\n    } else if (onSelect) {\n      onSelect(patient.id || '');\n    }\n  }, [onClick, onSelect, patient]);\n\n  // Handle action clicks\n  const handleEdit = useCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n    onEdit?.(patient);\n  }, [onEdit, patient]);\n\n  const handleDelete = useCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n    onDelete?.(patient);\n  }, [onDelete, patient]);\n\n  const handleCommunication = useCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n    onCommunication?.(patient);\n  }, [onCommunication, patient]);\n\n  // Show loading skeleton if not visible\n  if (!isVisible) {\n    return (\n      <div \n        ref={cardRef}\n        className={`bg-white rounded-lg border border-gray-200 p-4 animate-pulse ${className}`}\n      >\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"w-10 h-10 bg-gray-200 rounded-full\"></div>\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      ref={cardRef}\n      className={`\n        bg-white rounded-lg border border-gray-200 p-4 transition-all duration-200\n        hover:shadow-md hover:border-blue-300 cursor-pointer\n        ${isSelected ? 'ring-2 ring-blue-500 border-blue-500' : ''}\n        ${className}\n      `}\n      onClick={handleCardClick}\n    >\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex items-center space-x-3 flex-1 min-w-0\">\n          {/* Avatar */}\n          <div className=\"flex-shrink-0\">\n            <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\n              <User className=\"w-5 h-5 text-blue-600\" />\n            </div>\n          </div>\n\n          {/* Patient Info */}\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-center space-x-2 mb-1\">\n              <h3 className=\"text-sm font-medium text-gray-900 truncate\">\n                {displayName}\n              </h3>\n              {getStatusBadge(patient.status)}\n            </div>\n\n            <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n              {patient.phone && (\n                <div className=\"flex items-center\">\n                  <Phone className=\"w-3 h-3 mr-1\" />\n                  <span>{formatPhone(patient.phone)}</span>\n                </div>\n              )}\n              {patient.email && (\n                <div className=\"flex items-center\">\n                  <Mail className=\"w-3 h-3 mr-1\" />\n                  <span className=\"truncate\">{patient.email}</span>\n                </div>\n              )}\n            </div>\n\n            {/* Labels and Tags */}\n            <div className=\"flex items-center space-x-2 mt-2\">\n              {getLabelBadge(patient.label)}\n              {patient.tags && patient.tags.length > 0 && (\n                <div className=\"flex space-x-1\">\n                  {patient.tags.slice(0, 2).map((tag, index) => (\n                    <span\n                      key={index}\n                      className=\"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded\"\n                    >\n                      {tag}\n                    </span>\n                  ))}\n                  {patient.tags.length > 2 && (\n                    <span className=\"text-xs text-gray-400\">\n                      +{patient.tags.length - 2}\n                    </span>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        {showActions && (\n          <div className=\"flex items-center space-x-1 ml-2\">\n            {onCommunication && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleCommunication}\n                className=\"p-1 h-8 w-8\"\n              >\n                <MessageSquare className=\"w-4 h-4\" />\n              </Button>\n            )}\n            {onEdit && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleEdit}\n                className=\"p-1 h-8 w-8\"\n              >\n                <Edit className=\"w-4 h-4\" />\n              </Button>\n            )}\n            {onDelete && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleDelete}\n                className=\"p-1 h-8 w-8 text-red-600 hover:text-red-700\"\n              >\n                <Trash2 className=\"w-4 h-4\" />\n              </Button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Additional Info for Detailed Variant */}\n      {variant === 'detailed' && (\n        <div className=\"mt-3 pt-3 border-t border-gray-100\">\n          <div className=\"space-y-2\">\n            {(patient.addressFull || patient.address) && (\n              <div className=\"flex items-center text-xs text-gray-500\">\n                <MapPin className=\"w-3 h-3 mr-1\" />\n                <span className=\"truncate\">\n                  <span className=\"truncate\">\n                    {(() => {\n                      const address = patient.address;\n                      if (typeof address === 'object' && address !== null) {\n                        const addressObj = address as any;\n                        return addressObj.fullAddress || \n                               `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                               'Adres bilgisi yok';\n                      }\n                      return patient.addressFull || address || 'Adres bilgisi yok';\n                    })()}\n                  </span>\n                </span>\n              </div>\n            )}\n            \n            {patient.devices && patient.devices.length > 0 && (\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-xs text-green-600 font-medium\">\n                  {patient.devices.length} cihaz\n                </span>\n                {patient.lastContactDate && (\n                  <div className=\"flex items-center text-xs text-gray-500\">\n                    <Clock className=\"w-3 h-3 mr-1\" />\n                    Son iletişim: {new Date(patient.lastContactDate).toLocaleDateString('tr-TR')}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {patient.notes && patient.notes.length > 0 && (\n              <p className=\"text-xs text-gray-600 line-clamp-2\">\n                {patient.notes[0].text}\n              </p>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n});\n\nLazyPatientCard.displayName = 'LazyPatientCard';\n\nexport default LazyPatientCard;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientAdvancedSearch.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SEARCH_FIELDS' is assigned a value but never used.","line":46,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SORT_OPTIONS' is assigned a value but never used.","line":90,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'availableTags' is assigned a value but never used.","line":122,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":122,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setAvailableTags' is assigned a value but never used.","line":122,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":122,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'editQueryModal' is assigned a value but never used.","line":129,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":129,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'warning' is assigned a value but never used.","line":132,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":132,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'extractedTags' is assigned a value but never used.","line":148,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":148,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":256,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":256,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7727,7730],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7727,7730],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":257,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":257,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7750,7753],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7750,7753],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'newQuery' is assigned a value but never used.","line":291,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":291,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":313,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":313,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9420,9423],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9420,9423],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":330,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":330,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10022,10025],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10022,10025],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":341,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":341,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10347,10350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10347,10350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":359,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":359,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10863,10866],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10863,10866],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'toggleTag' is assigned a value but never used.","line":365,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":365,"endColumn":18},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":484,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":492,"endColumn":17}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useMemo, useEffect } from 'react';\nimport { Search, Filter, X, MapPin, User, FileText, Save, Star, Clock, Trash2 } from 'lucide-react';\nimport { Button, Input, Checkbox, Badge, Card, Modal, useModal, Textarea, useToastHelpers } from '@x-ear/ui-web';\nimport { Patient } from '../../types/patient';\nimport { fuzzySearch, FuzzySearchOptions } from '../../utils/fuzzy-search';\nimport { savedQueries, SavedQuery } from '../../utils/saved-queries';\n\ninterface PatientAdvancedSearchProps {\n  patients: Patient[];\n  onFilteredResults: (results: Patient[]) => void;\n  onClearFilters: () => void;\n}\n\ninterface SearchFilters {\n  query: string;\n  fuzzySearch: boolean;\n  fuzzyThreshold: number;\n  ageRange: {\n    min: number | null;\n    max: number | null;\n  };\n  dateRange: {\n    start: string;\n    end: string;\n  };\n  location: string;\n  tags: string[];\n  segment: string;\n  status: string;\n  hasPhone: boolean | null;\n  hasEmail: boolean | null;\n  hasNotes: boolean | null;\n  sortBy: string;\n  sortOrder: 'asc' | 'desc';\n}\n\ninterface SearchField {\n  id: keyof SearchFilters;\n  label: string;\n  type: 'text' | 'number' | 'select' | 'date' | 'checkbox' | 'tags';\n  icon: React.ReactNode;\n  options?: { label: string; value: string }[];\n  placeholder?: string;\n}\n\nconst SEARCH_FIELDS: SearchField[] = [\n  {\n    id: 'query',\n    label: 'Genel Arama',\n    type: 'text',\n    icon: <Search className=\"w-4 h-4\" />,\n    placeholder: 'Ad, telefon, e-posta ile ara...'\n  },\n  {\n    id: 'location',\n    label: 'Konum',\n    type: 'text',\n    icon: <MapPin className=\"w-4 h-4\" />,\n    placeholder: 'Şehir, ilçe, mahalle...'\n  },\n  {\n    id: 'segment',\n    label: 'Segment',\n    type: 'select',\n    icon: <User className=\"w-4 h-4\" />,\n    options: [\n      { label: 'Tümü', value: '' },\n      { label: 'VIP', value: 'vip' },\n      { label: 'Yeni', value: 'new' },\n      { label: 'Deneme', value: 'trial' },\n      { label: 'Satın Alınmış', value: 'purchased' },\n      { label: 'Kontrol', value: 'control' },\n      { label: 'Yenileme', value: 'renewal' },\n      { label: 'Mevcut', value: 'existing' }\n    ]\n  },\n  {\n    id: 'status',\n    label: 'Durum',\n    type: 'select',\n    icon: <FileText className=\"w-4 h-4\" />,\n    options: [\n      { label: 'Tümü', value: '' },\n      { label: 'Aktif', value: 'active' },\n      { label: 'Pasif', value: 'inactive' }\n    ]\n  }\n];\n\nconst SORT_OPTIONS = [\n  { label: 'Ad (A-Z)', value: 'name' },\n  { label: 'Kayıt Tarihi', value: 'createdAt' },\n  { label: 'Son Güncelleme', value: 'updatedAt' },\n  { label: 'Yaş', value: 'age' },\n  { label: 'Telefon', value: 'phone' }\n];\n\nconst DEFAULT_FILTERS: SearchFilters = {\n  query: '',\n  fuzzySearch: true,\n  fuzzyThreshold: 0.6,\n  ageRange: { min: null, max: null },\n  dateRange: { start: '', end: '' },\n  location: '',\n  tags: [],\n  segment: '',\n  status: '',\n  hasPhone: null,\n  hasEmail: null,\n  hasNotes: null,\n  sortBy: 'name',\n  sortOrder: 'asc'\n};\n\nexport const PatientAdvancedSearch: React.FC<PatientAdvancedSearchProps> = ({\n  patients,\n  onFilteredResults,\n  onClearFilters\n}) => {\n  const [filters, setFilters] = useState<SearchFilters>(DEFAULT_FILTERS);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [availableTags, setAvailableTags] = useState<string[]>([]);\n  const [savedQueriesList, setSavedQueriesList] = useState<SavedQuery[]>([]);\n  const [showSavedQueries, setShowSavedQueries] = useState(false);\n  const [selectedSavedQuery, setSelectedSavedQuery] = useState<SavedQuery | null>(null);\n  \n  // Modals\n  const saveQueryModal = useModal();\n  const editQueryModal = useModal();\n  \n  // Toast helpers\n  const { success, error, warning } = useToastHelpers();\n  \n  // Save query form state\n  const [saveQueryForm, setSaveQueryForm] = useState({\n    name: '',\n    description: '',\n    isDefault: false,\n    tags: [] as string[]\n  });\n\n  // Load saved queries on mount\n  useEffect(() => {\n    setSavedQueriesList(savedQueries.load());\n  }, []);\n\n  // Mevcut etiketleri çıkar\n  const extractedTags = useMemo(() => {\n    const tagSet = new Set<string>();\n    patients.forEach(patient => {\n      patient.tags?.forEach(tag => tagSet.add(tag));\n    });\n    return Array.from(tagSet).sort();\n  }, [patients]);\n\n  // Filtrelenmiş sonuçları hesapla\n  const filteredResults = useMemo(() => {\n    let results = [...patients];\n\n    // Fuzzy search implementation\n    if (filters.query.trim()) {\n      if (filters.fuzzySearch) {\n        const fuzzyOptions: FuzzySearchOptions = {\n          threshold: filters.fuzzyThreshold,\n          keys: ['name', 'phone', 'email', 'address', 'tcNumber'],\n          includeScore: true\n        };\n        \n        const fuzzyResults = fuzzySearch(results, filters.query, fuzzyOptions);\n        results = fuzzyResults.map(result => result.item);\n      } else {\n        // Exact search (existing logic)\n        const query = filters.query.toLowerCase();\n        results = results.filter(patient => {\n          const address = typeof patient.address === 'string' ? patient.address : patient.addressFull;\n          return patient.firstName?.toLowerCase().includes(query) ||\n            patient.lastName?.toLowerCase().includes(query) ||\n            patient.phone?.toLowerCase().includes(query) ||\n            patient.email?.toLowerCase().includes(query) ||\n            address?.toLowerCase().includes(query);\n        });\n      }\n    }\n\n    // Yaş aralığı\n    if (filters.ageRange.min !== null || filters.ageRange.max !== null) {\n      results = results.filter(patient => {\n        if (!patient.birthDate) return false;\n        const age = new Date().getFullYear() - new Date(patient.birthDate).getFullYear();\n        if (filters.ageRange.min !== null && age < filters.ageRange.min) return false;\n        if (filters.ageRange.max !== null && age > filters.ageRange.max) return false;\n        return true;\n      });\n    }\n\n    // Tarih aralığı\n    if (filters.dateRange.start || filters.dateRange.end) {\n      results = results.filter(patient => {\n        if (!patient.createdAt) return false;\n        const createdDate = new Date(patient.createdAt);\n        if (filters.dateRange.start && createdDate < new Date(filters.dateRange.start)) return false;\n        if (filters.dateRange.end && createdDate > new Date(filters.dateRange.end)) return false;\n        return true;\n      });\n    }\n\n    // Konum\n    if (filters.location.trim()) {\n      const location = filters.location.toLowerCase();\n      results = results.filter(patient => {\n        const address = typeof patient.address === 'string' ? patient.address : patient.addressFull;\n        return address?.toLowerCase().includes(location);\n      });\n    }\n\n    // Etiketler\n    if (filters.tags.length > 0) {\n      results = results.filter(patient =>\n        filters.tags.some(tag => patient.tags?.includes(tag))\n      );\n    }\n\n    // Segment\n    if (filters.segment) {\n      results = results.filter(patient => patient.segment === filters.segment);\n    }\n\n    // Durum\n    if (filters.status) {\n      results = results.filter(patient => patient.status === filters.status);\n    }\n\n    // Telefon varlığı\n    if (filters.hasPhone !== null) {\n      results = results.filter(patient =>\n        filters.hasPhone ? !!patient.phone : !patient.phone\n      );\n    }\n\n    // E-posta varlığı\n    if (filters.hasEmail !== null) {\n      results = results.filter(patient =>\n        filters.hasEmail ? !!patient.email : !patient.email\n      );\n    }\n\n    // Not varlığı\n    if (filters.hasNotes !== null) {\n      results = results.filter(patient =>\n        filters.hasNotes ? (patient.notes && patient.notes.length > 0) : (!patient.notes || patient.notes.length === 0)\n      );\n    }\n\n    // Sıralama\n    results.sort((a, b) => {\n      let aValue: any;\n      let bValue: any;\n\n      if (filters.sortBy === 'name') {\n        aValue = `${a.firstName} ${a.lastName}`.toLowerCase();\n        bValue = `${b.firstName} ${b.lastName}`.toLowerCase();\n      } else if (filters.sortBy === 'age') {\n        aValue = a.birthDate ? new Date().getFullYear() - new Date(a.birthDate).getFullYear() : 0;\n        bValue = b.birthDate ? new Date().getFullYear() - new Date(b.birthDate).getFullYear() : 0;\n      } else {\n        aValue = a[filters.sortBy as keyof Patient];\n        bValue = b[filters.sortBy as keyof Patient];\n      }\n\n      if (typeof aValue === 'string') {\n        aValue = aValue.toLowerCase();\n        bValue = bValue?.toLowerCase() || '';\n      }\n\n      if (aValue < bValue) return filters.sortOrder === 'asc' ? -1 : 1;\n      if (aValue > bValue) return filters.sortOrder === 'asc' ? 1 : -1;\n      return 0;\n    });\n\n    return results;\n  }, [patients, filters]);\n\n  // Save current search as a saved query\n  const handleSaveQuery = useCallback(async () => {\n    try {\n      if (!saveQueryForm.name.trim()) {\n        error('Sorgu adı gereklidir');\n        return;\n      }\n\n      const newQuery = savedQueries.create(\n        saveQueryForm.name,\n        filters.query,\n        filters,\n        {\n          description: saveQueryForm.description,\n          isDefault: saveQueryForm.isDefault,\n          tags: saveQueryForm.tags\n        }\n      );\n\n      setSavedQueriesList(savedQueries.load());\n      success('Sorgu başarıyla kaydedildi');\n      saveQueryModal.closeModal();\n      \n      // Reset form\n      setSaveQueryForm({\n        name: '',\n        description: '',\n        isDefault: false,\n        tags: []\n      });\n    } catch (err: any) {\n      error(err.message || 'Sorgu kaydedilemedi');\n    }\n  }, [saveQueryForm, filters, success, error, saveQueryModal]);\n\n  // Load a saved query\n  const handleLoadSavedQuery = useCallback((query: SavedQuery) => {\n    try {\n      // Use the saved query to increment usage count\n      savedQueries.use(query.id);\n      \n      // Apply the saved filters\n      setFilters(query.filters as SearchFilters);\n      setSelectedSavedQuery(query);\n      \n      success(`\"${query.name}\" sorgusu yüklendi`);\n      setSavedQueriesList(savedQueries.load()); // Refresh to update usage count\n    } catch (err: any) {\n      error(err.message || 'Sorgu yüklenemedi');\n    }\n  }, [success, error]);\n\n  // Delete a saved query\n  const handleDeleteSavedQuery = useCallback((queryId: string) => {\n    try {\n      savedQueries.delete(queryId);\n      setSavedQueriesList(savedQueries.load());\n      success('Sorgu silindi');\n    } catch (err: any) {\n      error(err.message || 'Sorgu silinemedi');\n    }\n  }, [success, error]);\n\n  // Filtreleri uygula\n  const applyFilters = useCallback(() => {\n    onFilteredResults(filteredResults);\n  }, [filteredResults, onFilteredResults]);\n\n  // Filtreleri temizle\n  const clearFilters = useCallback(() => {\n    setFilters(DEFAULT_FILTERS);\n    setSelectedSavedQuery(null);\n    onClearFilters();\n  }, [onClearFilters]);\n\n  // Filtre değerini güncelle\n  const updateFilter = useCallback((key: keyof SearchFilters, value: any) => {\n    setFilters(prev => ({ ...prev, [key]: value }));\n    setSelectedSavedQuery(null); // Clear selected query when filters change\n  }, []);\n\n  // Etiket ekle/çıkar\n  const toggleTag = useCallback((tag: string) => {\n    setFilters(prev => ({\n      ...prev,\n      tags: prev.tags.includes(tag)\n        ? prev.tags.filter(t => t !== tag)\n        : [...prev.tags, tag]\n    }));\n    setSelectedSavedQuery(null);\n  }, []);\n\n  // Aktif filtre sayısı\n  const activeFilterCount = useMemo(() => {\n    let count = 0;\n    if (filters.query.trim()) count++;\n    if (filters.ageRange.min !== null || filters.ageRange.max !== null) count++;\n    if (filters.dateRange.start || filters.dateRange.end) count++;\n    if (filters.location.trim()) count++;\n    if (filters.tags.length > 0) count++;\n    if (filters.segment) count++;\n    if (filters.status) count++;\n    if (filters.hasPhone !== null) count++;\n    if (filters.hasEmail !== null) count++;\n    if (filters.hasNotes !== null) count++;\n    return count;\n  }, [filters]);\n\n  // Otomatik filtreleme\n  React.useEffect(() => {\n    applyFilters();\n  }, [applyFilters]);\n\n  return (\n    <Card className=\"mb-6\">\n      <div className=\"p-4\">\n        {/* Header with Search Input and Controls */}\n        <div className=\"flex items-center space-x-4 mb-4\">\n          <div className=\"flex-1 relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n            <Input\n              value={filters.query}\n              onChange={(e) => updateFilter('query', e.target.value)}\n              placeholder=\"Hasta ara... (fuzzy search aktif)\"\n              className=\"pl-10 pr-4\"\n            />\n          </div>\n          \n          {/* Fuzzy Search Toggle */}\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              checked={filters.fuzzySearch}\n              onChange={(checked) => updateFilter('fuzzySearch', checked)}\n            />\n            <span className=\"text-sm text-gray-600\">Fuzzy Search</span>\n          </div>\n          \n          {/* Saved Queries Button */}\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowSavedQueries(!showSavedQueries)}\n            className=\"relative\"\n          >\n            <Star className=\"w-4 h-4 mr-1\" />\n            Kayıtlı Sorgular\n            {savedQueriesList.length > 0 && (\n              <Badge variant=\"secondary\" className=\"ml-2\">\n                {savedQueriesList.length}\n              </Badge>\n            )}\n          </Button>\n          \n          {/* Save Current Query Button */}\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={saveQueryModal.openModal}\n            disabled={!filters.query.trim() && Object.values(filters).every(v => \n              v === '' || v === null || v === false || (Array.isArray(v) && v.length === 0)\n            )}\n          >\n            <Save className=\"w-4 h-4 mr-1\" />\n            Kaydet\n          </Button>\n          \n          {/* Expand/Collapse Button */}\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setIsExpanded(!isExpanded)}\n          >\n            <Filter className=\"w-4 h-4 mr-1\" />\n            {isExpanded ? 'Gizle' : 'Filtreler'}\n            {activeFilterCount > 0 && (\n              <Badge variant=\"primary\" className=\"ml-2\">\n                {activeFilterCount}\n              </Badge>\n            )}\n          </Button>\n          \n          {activeFilterCount > 0 && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={clearFilters}\n              className=\"text-gray-500 hover:text-gray-700\"\n            >\n              <X className=\"w-4 h-4\" />\n              Temizle\n            </Button>\n          )}\n        </div>\n\n        {/* Fuzzy Search Threshold */}\n        {filters.fuzzySearch && (\n          <div className=\"mb-4 p-3 bg-blue-50 rounded-lg\">\n            <div className=\"flex items-center justify-between\">\n              <label className=\"text-sm font-medium text-blue-900\">\n                Fuzzy Search Hassasiyeti: {Math.round(filters.fuzzyThreshold * 100)}%\n              </label>\n              <input\n                type=\"range\"\n                min=\"0.1\"\n                max=\"1\"\n                step=\"0.1\"\n                value={filters.fuzzyThreshold}\n                onChange={(e) => updateFilter('fuzzyThreshold', parseFloat(e.target.value))}\n                className=\"w-32\"\n              />\n            </div>\n            <p className=\"text-xs text-blue-700 mt-1\">\n              Düşük değer: Daha esnek arama, Yüksek değer: Daha kesin arama\n            </p>\n          </div>\n        )}\n\n        {/* Saved Queries Panel */}\n        {showSavedQueries && (\n          <div className=\"mb-4 p-4 bg-gray-50 rounded-lg\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <h3 className=\"font-medium text-gray-900\">Kayıtlı Sorgular</h3>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setShowSavedQueries(false)}\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n            \n            {savedQueriesList.length === 0 ? (\n              <p className=\"text-sm text-gray-500 text-center py-4\">\n                Henüz kayıtlı sorgu yok\n              </p>\n            ) : (\n              <div className=\"space-y-2 max-h-64 overflow-y-auto\">\n                {savedQueriesList.map((query) => (\n                  <div\n                    key={query.id}\n                    className={`flex items-center justify-between p-3 rounded-lg border ${\n                      selectedSavedQuery?.id === query.id \n                        ? 'border-blue-300 bg-blue-50' \n                        : 'border-gray-200 bg-white'\n                    }`}\n                  >\n                    <div className=\"flex-1 cursor-pointer\" onClick={() => handleLoadSavedQuery(query)}>\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"font-medium text-sm\">{query.name}</span>\n                        {query.isDefault && (\n                          <Badge variant=\"primary\" size=\"sm\">Varsayılan</Badge>\n                        )}\n                        <Badge variant=\"secondary\" size=\"sm\">\n                          {query.usageCount} kullanım\n                        </Badge>\n                      </div>\n                      {query.description && (\n                        <p className=\"text-xs text-gray-600 mt-1\">{query.description}</p>\n                      )}\n                      <div className=\"flex items-center space-x-4 text-xs text-gray-500 mt-1\">\n                        <span>\"{query.query}\"</span>\n                        {query.lastUsed && (\n                          <span className=\"flex items-center\">\n                            <Clock className=\"w-3 h-3 mr-1\" />\n                            {query.lastUsed.toLocaleDateString()}\n                          </span>\n                        )}\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex items-center space-x-1\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleDeleteSavedQuery(query.id)}\n                        className=\"text-red-600 hover:text-red-700\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* ... existing expanded filters section ... */}\n\n        {/* Save Query Modal */}\n        <Modal\n          isOpen={saveQueryModal.isOpen}\n          onClose={saveQueryModal.closeModal}\n          title=\"Sorguyu Kaydet\"\n          size=\"md\"\n        >\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Sorgu Adı *\n              </label>\n              <Input\n                value={saveQueryForm.name}\n                onChange={(e) => setSaveQueryForm(prev => ({ ...prev, name: e.target.value }))}\n                placeholder=\"Örn: VIP müşteriler, Aktif hastalar...\"\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Açıklama\n              </label>\n              <Textarea\n                value={saveQueryForm.description}\n                onChange={(e) => setSaveQueryForm(prev => ({ ...prev, description: e.target.value }))}\n                placeholder=\"Bu sorgunun ne için kullanıldığını açıklayın...\"\n                rows={3}\n              />\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                checked={saveQueryForm.isDefault}\n                onChange={(e) => setSaveQueryForm(prev => ({ ...prev, isDefault: e.target.checked }))}\n              />\n              <span className=\"text-sm text-gray-700\">Varsayılan sorgu olarak işaretle</span>\n            </div>\n            \n            <div className=\"bg-gray-50 p-3 rounded-lg\">\n              <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Kaydedilecek Filtreler:</h4>\n              <div className=\"text-xs text-gray-600 space-y-1\">\n                {filters.query && <div>• Arama: \"{filters.query}\"</div>}\n                {filters.segment && <div>• Segment: {filters.segment}</div>}\n                {filters.status && <div>• Durum: {filters.status}</div>}\n                {filters.tags.length > 0 && <div>• Etiketler: {filters.tags.join(', ')}</div>}\n                {filters.location && <div>• Konum: {filters.location}</div>}\n                {(filters.ageRange.min || filters.ageRange.max) && (\n                  <div>• Yaş: {filters.ageRange.min || 0}-{filters.ageRange.max || '∞'}</div>\n                )}\n              </div>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3\">\n              <Button variant=\"outline\" onClick={saveQueryModal.closeModal}>\n                İptal\n              </Button>\n              <Button onClick={handleSaveQuery}>\n                <Save className=\"w-4 h-4 mr-2\" />\n                Kaydet\n              </Button>\n            </div>\n          </div>\n        </Modal>\n\n        {/* Results Summary */}\n        <div className=\"flex items-center justify-between text-sm text-gray-600 mt-4\">\n          <span>\n            {filteredResults.length} hasta bulundu\n            {patients.length !== filteredResults.length && ` (${patients.length} toplam)`}\n          </span>\n          {selectedSavedQuery && (\n            <div className=\"flex items-center space-x-2\">\n              <Star className=\"w-4 h-4 text-yellow-500\" />\n              <span className=\"text-blue-600\">\"{selectedSavedQuery.name}\" sorgusu aktif</span>\n            </div>\n          )}\n        </div>\n      </div>\n    </Card>\n  );\n};\n\nexport default PatientAdvancedSearch;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientAppointmentsTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppointmentsRescheduleAppointmentBody' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onPatientUpdate' is defined but never used.","line":21,"column":90,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":105},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAppointments'. Either include it or remove the dependency array.","line":35,"column":6,"nodeType":"ArrayExpression","endLine":35,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [loadAppointments, patient.id]","fix":{"range":[1332,1344],"text":"[loadAppointments, patient.id]"}}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":173,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":184,"endColumn":22}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Calendar, Plus, Edit, X, Check, CheckCircle, XCircle, AlertCircle } from 'lucide-react';\nimport { Button, Badge, Input, Textarea } from '@x-ear/ui-web';\nimport { Patient } from '../../types/patient';\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/xEarCRMAPIAutoGenerated';\nimport type { \n  Appointment, \n  AppointmentsGetAppointmentsParams,\n  AppointmentsCreateAppointmentBody,\n  AppointmentsCancelAppointmentBody,\n  AppointmentsCompleteAppointmentBody,\n  AppointmentsRescheduleAppointmentBody,\n  AppointmentsListAppointments200\n} from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\n\ninterface PatientAppointmentsTabProps {\n  patient: Patient;\n  onPatientUpdate: (patient: Patient) => void;\n}\n\nexport const PatientAppointmentsTab: React.FC<PatientAppointmentsTabProps> = ({ patient, onPatientUpdate }) => {\n  const [showBookingForm, setShowBookingForm] = useState(false);\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [filters, setFilters] = useState({\n    status: 'all',\n    dateRange: 'all',\n    search: ''\n  });\n\n  // Load appointments for this patient\n  useEffect(() => {\n    loadAppointments();\n  }, [patient.id]);\n\n  const loadAppointments = async () => {\n    if (!patient.id) return;\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const params: AppointmentsGetAppointmentsParams = {\n        patient_id: patient.id,\n        page: 1,\n        per_page: 20 // Reduced from 100 to 20 to minimize data transfer\n      };\n      \n      const response = await api.appointmentsGetAppointments(params) as { data?: AppointmentsListAppointments200 };\n      setAppointments(response.data?.data || []);\n    } catch (err) {\n      console.error('Error loading appointments:', err);\n      setError('Randevular yüklenirken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter appointments based on current filters\n  const filteredAppointments = appointments.filter(appointment => {\n    if (filters.status !== 'all' && appointment.status !== filters.status) {\n      return false;\n    }\n    \n    if (filters.search && !appointment.notes?.toLowerCase().includes(filters.search.toLowerCase())) {\n      return false;\n    }\n    \n    return true;\n  });\n\n  const handleNewAppointment = async (appointmentData: AppointmentsCreateAppointmentBody) => {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      await api.appointmentsCreateAppointment(appointmentData);\n      await loadAppointments();\n      setShowBookingForm(false);\n    } catch (err) {\n      console.error('Error creating appointment:', err);\n      setError('Randevu oluşturulurken hata oluştu');\n    }\n  };\n\n  const handleCancelAppointment = async (appointmentId: string, reason?: string) => {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const cancelData: AppointmentsCancelAppointmentBody = { reason };\n      await api.appointmentsCancelAppointment(appointmentId, cancelData);\n      await loadAppointments();\n    } catch (err) {\n      console.error('Error canceling appointment:', err);\n      setError('Randevu iptal edilirken hata oluştu');\n    }\n  };\n\n  const handleConfirmAppointment = async (appointmentId: string, notes?: string) => {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const completeData: AppointmentsCompleteAppointmentBody = { notes };\n      await api.appointmentsCompleteAppointment(appointmentId, completeData);\n      await loadAppointments();\n    } catch (err) {\n      console.error('Error completing appointment:', err);\n      setError('Randevu tamamlanırken hata oluştu');\n    }\n  };\n\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'scheduled':\n        return <Badge className=\"bg-blue-100 text-blue-800\">Planlandı</Badge>;\n      case 'confirmed':\n        return <Badge className=\"bg-green-100 text-green-800\">Onaylandı</Badge>;\n      case 'completed':\n        return <Badge className=\"bg-gray-100 text-gray-800\">Tamamlandı</Badge>;\n      case 'cancelled':\n        return <Badge className=\"bg-red-100 text-red-800\">İptal</Badge>;\n      case 'no_show':\n        return <Badge className=\"bg-orange-100 text-orange-800\">Gelmedi</Badge>;\n      default:\n        return <Badge className=\"bg-gray-100 text-gray-800\">Bilinmiyor</Badge>;\n    }\n  };\n\n  const getStatusIcon = (status?: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n      case 'cancelled':\n        return <XCircle className=\"w-4 h-4 text-red-500\" />;\n      default:\n        return <AlertCircle className=\"w-4 h-4 text-blue-500\" />;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Randevular yükleniyor...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Actions */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h3 className=\"text-lg font-medium text-gray-900\">Randevular</h3>\n          <p className=\"text-sm text-gray-600\">\n            {filteredAppointments.length} randevu bulundu\n          </p>\n        </div>\n        <Button \n          onClick={() => setShowBookingForm(true)}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Yeni Randevu\n        </Button>\n      </div>\n\n      {/* Filters */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Durum</label>\n            <select \n              value={filters.status}\n              onChange={(e) => setFilters(prev => ({ ...prev, status: e.target.value }))}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"all\">Tümü</option>\n              <option value=\"scheduled\">Planlandı</option>\n              <option value=\"confirmed\">Onaylandı</option>\n              <option value=\"completed\">Tamamlandı</option>\n              <option value=\"cancelled\">İptal</option>\n              <option value=\"no_show\">Gelmedi</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Tarih</label>\n            <Input\n              type=\"date\"\n              value={filters.dateRange === 'all' ? '' : filters.dateRange}\n              onChange={(e) => setFilters(prev => ({ ...prev, dateRange: e.target.value || 'all' }))}\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Arama</label>\n            <Input\n              type=\"text\"\n              placeholder=\"Notlarda ara...\"\n              value={filters.search}\n              onChange={(e) => setFilters(prev => ({ ...prev, search: e.target.value }))}\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n          <div className=\"flex\">\n            <XCircle className=\"h-5 w-5 text-red-400\" />\n            <div className=\"ml-3\">\n              <p className=\"text-sm text-red-800\">{error}</p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Appointments List */}\n      <div className=\"space-y-4\">\n        {filteredAppointments.length > 0 ? (\n          filteredAppointments.map((appointment) => (\n            <div key={appointment.id} className=\"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-3 mb-2\">\n                    {getStatusIcon(appointment.status)}\n                    <div>\n                      <p className=\"font-medium text-gray-900\">\n                        {appointment.date} - {appointment.time}\n                      </p>\n                      <p className=\"text-sm text-gray-600\">\n                        Süre: {appointment.duration || 30} dakika\n                      </p>\n                    </div>\n                    {getStatusBadge(appointment.status)}\n                  </div>\n\n                  {appointment.appointmentType && (\n                    <p className=\"text-sm text-gray-600 mb-1\">\n                      <strong>Tür:</strong> {appointment.appointmentType}\n                    </p>\n                  )}\n\n                  {appointment.clinicianId && (\n                    <p className=\"text-sm text-gray-600 mb-1\">\n                      <strong>Doktor:</strong> {appointment.clinicianId}\n                    </p>\n                  )}\n\n                  {appointment.notes && (\n                    <p className=\"text-sm text-gray-600\">\n                      <strong>Notlar:</strong> {appointment.notes}\n                    </p>\n                  )}\n                </div>\n\n                <div className=\"flex items-center space-x-2 ml-4\">\n                  {appointment.status === 'SCHEDULED' && (\n                    <>\n                      <Button\n                        onClick={() => appointment.id && handleConfirmAppointment(appointment.id)}\n                        className=\"p-2 text-green-600 hover:bg-green-50\"\n                        title=\"Tamamla\"\n                      >\n                        <Check className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        onClick={() => appointment.id && handleCancelAppointment(appointment.id, 'Hasta tarafından iptal edildi')}\n                        className=\"p-2 text-red-600 hover:bg-red-50\"\n                        title=\"İptal Et\"\n                      >\n                        <X className=\"w-4 h-4\" />\n                      </Button>\n                    </>\n                  )}\n                  <Button\n                    className=\"p-2 text-gray-600 hover:bg-gray-50\"\n                    title=\"Düzenle\"\n                  >\n                    <Edit className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          ))\n        ) : (\n          <div className=\"text-center py-8 text-gray-500\">\n            <Calendar className=\"w-12 h-12 mx-auto mb-4 text-gray-300\" />\n            <p>{filters.status !== 'all' || filters.dateRange !== 'all' ? 'Filtre kriterlerine uygun randevu bulunamadı.' : 'Henüz randevu bulunmamaktadır.'}</p>\n          </div>\n        )}\n      </div>\n\n      {/* New Appointment Form Modal */}\n      {showBookingForm && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-medium\">Yeni Randevu</h3>\n              <Button\n                onClick={() => setShowBookingForm(false)}\n                className=\"p-1 text-gray-400 hover:text-gray-600\"\n              >\n                <X className=\"w-5 h-5\" />\n              </Button>\n            </div>\n\n            <form onSubmit={(e) => {\n              e.preventDefault();\n              const formData = new FormData(e.currentTarget);\n              const appointmentData: AppointmentsCreateAppointmentBody = {\n                patient_id: patient.id || '',\n                date: formData.get('date') as string,\n                time: formData.get('time') as string,\n                duration: parseInt(formData.get('duration') as string) || 30,\n                type: formData.get('type') as string,\n                notes: formData.get('notes') as string\n              };\n              handleNewAppointment(appointmentData);\n            }}>\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Tarih</label>\n                  <Input type=\"date\" name=\"date\" required />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Saat</label>\n                  <Input type=\"time\" name=\"time\" required />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Süre (dakika)</label>\n                  <Input type=\"number\" name=\"duration\" defaultValue=\"30\" min=\"15\" max=\"180\" />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Randevu Türü</label>\n                  <Input type=\"text\" name=\"type\" placeholder=\"Kontrol, Muayene, vb.\" />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notlar</label>\n                  <Textarea name=\"notes\" rows={3} placeholder=\"Randevu notları...\" />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <Button\n                  type=\"button\"\n                  onClick={() => setShowBookingForm(false)}\n                  className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n                >\n                  İptal\n                </Button>\n                <Button\n                  type=\"submit\"\n                  className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md\"\n                >\n                  Randevu Oluştur\n                </Button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientBulkActions.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Plus' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Edit3' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":8},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[927,930],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[927,930],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1211,1214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1211,1214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'inputValues' is assigned a value but never used.","line":83,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":83,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2291,2294],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2291,2294],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'executeAction'. Either include it or remove the dependency array.","line":290,"column":6,"nodeType":"ArrayExpression","endLine":290,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [disabled, executeAction, loading]","fix":{"range":[8085,8104],"text":"[disabled, executeAction, loading]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8182,8185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8182,8185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":389,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":395,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":398,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":405,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":423,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":455,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":472,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":478,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":511,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":518,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":521,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":533,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":538,"column":27,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":545,"endColumn":29},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":550,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":557,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":564,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":570,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":571,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":597,"endColumn":24}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useMemo } from 'react'\nimport { \n  Tag, \n  MessageSquare, \n  Download, \n  Trash2, \n  Archive, \n  UserCheck, \n  UserX, \n  Mail, \n  FileText, \n  Calendar, \n  CheckSquare, \n  X, \n  AlertTriangle,\n  Users,\n  Send,\n  Plus,\n  Edit3\n} from 'lucide-react'\n\ninterface PatientBulkActionsProps {\n  selectedPatients: string[]\n  totalPatients: number\n  onSelectAll: () => void\n  onDeselectAll: () => void\n  onBulkAddTag: (tag: string) => Promise<void>\n  onBulkRemoveTag: (tag: string) => Promise<void>\n  onBulkSendSMS: (message: string, phoneNumbers: string[]) => Promise<void>\n  onBulkSendEmail: (subject: string, message: string, emails: string[]) => Promise<void>\n  onBulkExport: (format: 'csv' | 'excel' | 'pdf') => Promise<void>\n  onBulkStatusChange: (status: 'active' | 'inactive' | 'archived') => Promise<void>\n  onBulkDelete: () => Promise<void>\n  onBulkScheduleAppointment: (appointmentData: any) => Promise<void>\n  onBulkAssignToSegment: (segment: string) => Promise<void>\n  availableTags?: string[]\n  availableSegments?: string[]\n  className?: string\n  loading?: boolean\n  disabled?: boolean\n}\n\ninterface BulkAction {\n  id: string\n  name: string\n  icon: React.ComponentType<any>\n  color: string\n  bgColor: string\n  description: string\n  requiresConfirmation?: boolean\n  requiresInput?: boolean\n  inputType?: 'text' | 'textarea' | 'select' | 'multiselect'\n  inputPlaceholder?: string\n  inputOptions?: { value: string; label: string }[]\n  category: 'communication' | 'data' | 'status' | 'organization' | 'dangerous'\n  minSelection?: number\n  maxSelection?: number\n}\n\nexport const PatientBulkActions: React.FC<PatientBulkActionsProps> = ({\n  selectedPatients,\n  totalPatients,\n  onSelectAll,\n  onDeselectAll,\n  onBulkAddTag,\n  onBulkRemoveTag,\n  onBulkSendSMS,\n  onBulkSendEmail,\n  onBulkExport,\n  onBulkStatusChange,\n  onBulkDelete,\n  onBulkScheduleAppointment,\n  onBulkAssignToSegment,\n  availableTags = [],\n  availableSegments = [],\n  className = \"\",\n  loading = false,\n  disabled = false\n}) => {\n  const [showActionModal, setShowActionModal] = useState(false)\n  const [currentAction, setCurrentAction] = useState<BulkAction | null>(null)\n  const [inputValue, setInputValue] = useState('')\n  const [inputValues, setInputValues] = useState<Record<string, any>>({})\n  const [isProcessing, setIsProcessing] = useState(false)\n\n  const selectedCount = selectedPatients.length\n\n  // Define available bulk actions based on legacy system\n  const bulkActions: BulkAction[] = useMemo(() => [\n    // Communication Actions\n    {\n      id: 'add-tag',\n      name: 'Etiket Ekle',\n      icon: Tag,\n      color: 'text-blue-600',\n      bgColor: 'bg-blue-100',\n      description: 'Seçili hastalara etiket ekle',\n      requiresInput: true,\n      inputType: 'select',\n      inputPlaceholder: 'Etiket seçin veya yeni etiket yazın',\n      inputOptions: availableTags.map(tag => ({ value: tag, label: tag })),\n      category: 'organization',\n      minSelection: 1\n    },\n    {\n      id: 'remove-tag',\n      name: 'Etiket Kaldır',\n      icon: Tag,\n      color: 'text-orange-600',\n      bgColor: 'bg-orange-100',\n      description: 'Seçili hastalardan etiket kaldır',\n      requiresInput: true,\n      inputType: 'select',\n      inputPlaceholder: 'Kaldırılacak etiketi seçin',\n      inputOptions: availableTags.map(tag => ({ value: tag, label: tag })),\n      category: 'organization',\n      minSelection: 1\n    },\n    {\n      id: 'send-sms',\n      name: 'SMS Gönder',\n      icon: MessageSquare,\n      color: 'text-green-600',\n      bgColor: 'bg-green-100',\n      description: 'Seçili hastalara SMS gönder',\n      requiresInput: true,\n      inputType: 'textarea',\n      inputPlaceholder: 'SMS mesajınızı yazın...',\n      category: 'communication',\n      minSelection: 1,\n      maxSelection: 100\n    },\n    {\n      id: 'send-email',\n      name: 'E-posta Gönder',\n      icon: Mail,\n      color: 'text-purple-600',\n      bgColor: 'bg-purple-100',\n      description: 'Seçili hastalara e-posta gönder',\n      requiresInput: true,\n      inputType: 'textarea',\n      inputPlaceholder: 'E-posta mesajınızı yazın...',\n      category: 'communication',\n      minSelection: 1,\n      maxSelection: 50\n    },\n    \n    // Data Actions\n    {\n      id: 'export-csv',\n      name: 'CSV Dışa Aktar',\n      icon: Download,\n      color: 'text-indigo-600',\n      bgColor: 'bg-indigo-100',\n      description: 'Seçili hastaları CSV formatında dışa aktar',\n      category: 'data',\n      minSelection: 1\n    },\n    {\n      id: 'export-excel',\n      name: 'Excel Dışa Aktar',\n      icon: FileText,\n      color: 'text-indigo-600',\n      bgColor: 'bg-indigo-100',\n      description: 'Seçili hastaları Excel formatında dışa aktar',\n      category: 'data',\n      minSelection: 1\n    },\n    \n    // Status Actions\n    {\n      id: 'activate',\n      name: 'Aktifleştir',\n      icon: UserCheck,\n      color: 'text-green-600',\n      bgColor: 'bg-green-100',\n      description: 'Seçili hastaları aktif duruma getir',\n      requiresConfirmation: true,\n      category: 'status',\n      minSelection: 1\n    },\n    {\n      id: 'deactivate',\n      name: 'Pasifleştir',\n      icon: UserX,\n      color: 'text-yellow-600',\n      bgColor: 'bg-yellow-100',\n      description: 'Seçili hastaları pasif duruma getir',\n      requiresConfirmation: true,\n      category: 'status',\n      minSelection: 1\n    },\n    {\n      id: 'archive',\n      name: 'Arşivle',\n      icon: Archive,\n      color: 'text-gray-600',\n      bgColor: 'bg-gray-100',\n      description: 'Seçili hastaları arşivle',\n      requiresConfirmation: true,\n      category: 'status',\n      minSelection: 1\n    },\n    \n    // Organization Actions\n    {\n      id: 'assign-segment',\n      name: 'Segment Ata',\n      icon: Users,\n      color: 'text-cyan-600',\n      bgColor: 'bg-cyan-100',\n      description: 'Seçili hastaları bir segmente ata',\n      requiresInput: true,\n      inputType: 'select',\n      inputPlaceholder: 'Segment seçin',\n      inputOptions: availableSegments.map(segment => ({ value: segment, label: segment })),\n      category: 'organization',\n      minSelection: 1\n    },\n    {\n      id: 'schedule-appointment',\n      name: 'Randevu Planla',\n      icon: Calendar,\n      color: 'text-pink-600',\n      bgColor: 'bg-pink-100',\n      description: 'Seçili hastalar için randevu planla',\n      requiresInput: true,\n      inputType: 'text',\n      inputPlaceholder: 'Randevu notları (opsiyonel)',\n      category: 'organization',\n      minSelection: 1,\n      maxSelection: 20\n    },\n    \n    // Dangerous Actions\n    {\n      id: 'delete',\n      name: 'Sil',\n      icon: Trash2,\n      color: 'text-red-600',\n      bgColor: 'bg-red-100',\n      description: 'Seçili hastaları kalıcı olarak sil',\n      requiresConfirmation: true,\n      category: 'dangerous',\n      minSelection: 1\n    }\n  ], [availableTags, availableSegments])\n\n  // Filter actions based on selection count\n  const availableActions = useMemo(() => {\n    return bulkActions.filter(action => {\n      if (action.minSelection && selectedCount < action.minSelection) return false\n      if (action.maxSelection && selectedCount > action.maxSelection) return false\n      return true\n    })\n  }, [bulkActions, selectedCount])\n\n  // Group actions by category\n  const actionsByCategory = useMemo(() => {\n    const grouped: Record<string, BulkAction[]> = {}\n    availableActions.forEach(action => {\n      if (!grouped[action.category]) {\n        grouped[action.category] = []\n      }\n      grouped[action.category].push(action)\n    })\n    return grouped\n  }, [availableActions])\n\n  const categoryLabels = {\n    communication: 'İletişim',\n    data: 'Veri İşlemleri',\n    status: 'Durum Değişiklikleri',\n    organization: 'Organizasyon',\n    dangerous: 'Tehlikeli İşlemler'\n  }\n\n  const handleActionClick = useCallback((action: BulkAction) => {\n    if (disabled || loading) return\n\n    setCurrentAction(action)\n    setInputValue('')\n    setInputValues({})\n    \n    if (action.requiresInput || action.requiresConfirmation) {\n      setShowActionModal(true)\n    } else {\n      executeAction(action)\n    }\n  }, [disabled, loading])\n\n  const executeAction = useCallback(async (action: BulkAction, inputData?: any) => {\n    if (!action || selectedCount === 0) return\n\n    setIsProcessing(true)\n    \n    try {\n      switch (action.id) {\n        case 'add-tag':\n          await onBulkAddTag(inputData || inputValue)\n          break\n        case 'remove-tag':\n          await onBulkRemoveTag(inputData || inputValue)\n          break\n        case 'send-sms':\n          // In real implementation, you'd get phone numbers from selected patients\n          await onBulkSendSMS(inputData || inputValue, [])\n          break\n        case 'send-email':\n          // In real implementation, you'd get emails from selected patients\n          await onBulkSendEmail('Toplu E-posta', inputData || inputValue, [])\n          break\n        case 'export-csv':\n          await onBulkExport('csv')\n          break\n        case 'export-excel':\n          await onBulkExport('excel')\n          break\n        case 'activate':\n          await onBulkStatusChange('active')\n          break\n        case 'deactivate':\n          await onBulkStatusChange('inactive')\n          break\n        case 'archive':\n          await onBulkStatusChange('archived')\n          break\n        case 'assign-segment':\n          await onBulkAssignToSegment(inputData || inputValue)\n          break\n        case 'schedule-appointment':\n          await onBulkScheduleAppointment({ notes: inputData || inputValue })\n          break\n        case 'delete':\n          await onBulkDelete()\n          break\n      }\n      \n      setShowActionModal(false)\n      setCurrentAction(null)\n    } catch (error) {\n      console.error('Bulk action failed:', error)\n      // Handle error (show toast, etc.)\n    } finally {\n      setIsProcessing(false)\n    }\n  }, [\n    selectedCount,\n    inputValue,\n    onBulkAddTag,\n    onBulkRemoveTag,\n    onBulkSendSMS,\n    onBulkSendEmail,\n    onBulkExport,\n    onBulkStatusChange,\n    onBulkDelete,\n    onBulkScheduleAppointment,\n    onBulkAssignToSegment\n  ])\n\n  const handleConfirmAction = useCallback(() => {\n    if (currentAction) {\n      executeAction(currentAction, inputValue)\n    }\n  }, [currentAction, inputValue, executeAction])\n\n  if (selectedCount === 0) {\n    return (\n      <div className={`bg-gray-50 border border-gray-200 rounded-lg p-4 ${className}`}>\n        <div className=\"flex items-center justify-center text-gray-500\">\n          <CheckSquare className=\"w-5 h-5 mr-2\" />\n          <span>Toplu işlem yapmak için hasta seçin</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className={`bg-white border border-gray-200 rounded-lg shadow-sm ${className}`}>\n      {/* Header */}\n      <div className=\"px-4 py-3 border-b border-gray-200 bg-blue-50\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center\">\n            <CheckSquare className=\"w-5 h-5 text-blue-600 mr-2\" />\n            <span className=\"font-medium text-blue-900\">\n              {selectedCount} hasta seçili\n            </span>\n            {selectedCount < totalPatients && (\n              <button\n                onClick={onSelectAll}\n                className=\"ml-3 text-sm text-blue-600 hover:text-blue-800 underline\"\n                disabled={disabled || loading}\n              >\n                Tümünü seç ({totalPatients})\n              </button>\n            )}\n          </div>\n          <button\n            onClick={onDeselectAll}\n            className=\"text-sm text-gray-600 hover:text-gray-800 flex items-center\"\n            disabled={disabled || loading}\n          >\n            <X className=\"w-4 h-4 mr-1\" />\n            Seçimi temizle\n          </button>\n        </div>\n      </div>\n\n      {/* Actions */}\n      <div className=\"p-4\">\n        {Object.entries(actionsByCategory).map(([category, actions]) => (\n          <div key={category} className=\"mb-6 last:mb-0\">\n            <h4 className=\"text-sm font-medium text-gray-700 mb-3\">\n              {categoryLabels[category as keyof typeof categoryLabels]}\n            </h4>\n            <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-3\">\n              {actions.map((action) => {\n                const Icon = action.icon\n                const isDisabled = disabled || loading || isProcessing\n                const isDangerous = action.category === 'dangerous'\n                \n                return (\n                  <button\n                    key={action.id}\n                    onClick={() => handleActionClick(action)}\n                    disabled={isDisabled}\n                    className={`\n                      relative p-3 rounded-lg border transition-all duration-200\n                      ${isDisabled \n                        ? 'opacity-50 cursor-not-allowed' \n                        : 'hover:shadow-md hover:-translate-y-0.5'\n                      }\n                      ${isDangerous \n                        ? 'border-red-200 hover:border-red-300 hover:bg-red-50' \n                        : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'\n                      }\n                    `}\n                    title={action.description}\n                  >\n                    <div className=\"flex flex-col items-center text-center\">\n                      <div className={`w-8 h-8 ${action.bgColor} rounded-full flex items-center justify-center mb-2`}>\n                        <Icon className={`w-4 h-4 ${action.color}`} />\n                      </div>\n                      <span className=\"text-xs font-medium text-gray-700 leading-tight\">\n                        {action.name}\n                      </span>\n                    </div>\n                    \n                    {/* Selection limits indicator */}\n                    {(action.minSelection || action.maxSelection) && (\n                      <div className=\"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\">\n                        {action.maxSelection ? `≤${action.maxSelection}` : `≥${action.minSelection}`}\n                      </div>\n                    )}\n                  </button>\n                )\n              })}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Action Modal */}\n      {showActionModal && currentAction && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full mx-4\">\n            <div className=\"px-6 py-4 border-b border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-lg font-medium text-gray-900\">\n                  {currentAction.name}\n                </h3>\n                <button\n                  onClick={() => setShowActionModal(false)}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                  disabled={isProcessing}\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n              </div>\n            </div>\n            \n            <div className=\"px-6 py-4\">\n              <p className=\"text-sm text-gray-600 mb-4\">\n                {currentAction.description}\n              </p>\n              \n              {currentAction.category === 'dangerous' && (\n                <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 mb-4\">\n                  <div className=\"flex items-center\">\n                    <AlertTriangle className=\"w-5 h-5 text-red-600 mr-2\" />\n                    <span className=\"text-sm font-medium text-red-800\">\n                      Bu işlem geri alınamaz!\n                    </span>\n                  </div>\n                </div>\n              )}\n              \n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4\">\n                <span className=\"text-sm text-blue-800\">\n                  <strong>{selectedCount}</strong> hasta etkilenecek\n                </span>\n              </div>\n\n              {currentAction.requiresInput && (\n                <div className=\"mb-4\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    {currentAction.inputPlaceholder}\n                  </label>\n                  \n                  {currentAction.inputType === 'textarea' ? (\n                    <textarea\n                      value={inputValue}\n                      onChange={(e) => setInputValue(e.target.value)}\n                      placeholder={currentAction.inputPlaceholder}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      rows={4}\n                      disabled={isProcessing}\n                    />\n                  ) : currentAction.inputType === 'select' ? (\n                    <div>\n                      <select\n                        value={inputValue}\n                        onChange={(e) => setInputValue(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                        disabled={isProcessing}\n                      >\n                        <option value=\"\">Seçin...</option>\n                        {currentAction.inputOptions?.map((option) => (\n                          <option key={option.value} value={option.value}>\n                            {option.label}\n                          </option>\n                        ))}\n                      </select>\n                      \n                      {/* Allow custom input for tags */}\n                      {(currentAction.id === 'add-tag' || currentAction.id === 'remove-tag') && (\n                        <div className=\"mt-2\">\n                          <input\n                            type=\"text\"\n                            value={inputValue}\n                            onChange={(e) => setInputValue(e.target.value)}\n                            placeholder=\"Veya yeni etiket yazın...\"\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                            disabled={isProcessing}\n                          />\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <input\n                      type=\"text\"\n                      value={inputValue}\n                      onChange={(e) => setInputValue(e.target.value)}\n                      placeholder={currentAction.inputPlaceholder}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      disabled={isProcessing}\n                    />\n                  )}\n                </div>\n              )}\n            </div>\n            \n            <div className=\"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3\">\n              <button\n                onClick={() => setShowActionModal(false)}\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                disabled={isProcessing}\n              >\n                İptal\n              </button>\n              <button\n                onClick={handleConfirmAction}\n                disabled={isProcessing || (currentAction.requiresInput && !inputValue.trim())}\n                className={`\n                  px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2\n                  ${currentAction.category === 'dangerous'\n                    ? 'bg-red-600 hover:bg-red-700 focus:ring-red-500'\n                    : 'bg-blue-600 hover:bg-blue-700 focus:ring-blue-500'\n                  }\n                  ${(isProcessing || (currentAction.requiresInput && !inputValue.trim()))\n                    ? 'opacity-50 cursor-not-allowed'\n                    : ''\n                  }\n                `}\n              >\n                {isProcessing ? (\n                  <div className=\"flex items-center\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                    İşleniyor...\n                  </div>\n                ) : (\n                  <>\n                    <Send className=\"w-4 h-4 mr-2 inline\" />\n                    {currentAction.name}\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientBulkOperations.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[727,730],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[727,730],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'activeAction' is assigned a value but never used.","line":82,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4077,4080],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4077,4080],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":180,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5257,5260],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5257,5260],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":206,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6216,6219],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6216,6219],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":216,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6366,6369],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6366,6369],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":256,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":256,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7534,7537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7534,7537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":423,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":431,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":451,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":451,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14085,14088],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14085,14088],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback } from 'react';\nimport { Upload, Download, Users, Tag, MessageSquare, Trash2, FileText, AlertCircle } from 'lucide-react';\nimport { Button, Modal, useModal, Input, Select, Textarea, useToastHelpers } from '@x-ear/ui-web';\nimport { Patient } from '../../types/patient';\n\n\ninterface PatientBulkOperationsProps {\n  selectedPatients: Patient[];\n  onClearSelection: () => void;\n  onRefresh: () => void;\n}\n\ninterface BulkAction {\n  id: string;\n  label: string;\n  icon: React.ReactNode;\n  description: string;\n  requiresConfirmation: boolean;\n  color: 'primary' | 'secondary' | 'danger' | 'warning';\n}\n\ninterface CSVImportData {\n  file: File | null;\n  mapping: Record<string, string>;\n  preview: any[];\n  errors: string[];\n}\n\nconst BULK_ACTIONS: BulkAction[] = [\n  {\n    id: 'export-csv',\n    label: 'CSV Dışa Aktar',\n    icon: <Download className=\"w-4 h-4\" />,\n    description: 'Seçili hastaları CSV formatında dışa aktar',\n    requiresConfirmation: false,\n    color: 'primary'\n  },\n  {\n    id: 'bulk-tag',\n    label: 'Toplu Etiketleme',\n    icon: <Tag className=\"w-4 h-4\" />,\n    description: 'Seçili hastalara toplu etiket ekle/çıkar',\n    requiresConfirmation: false,\n    color: 'secondary'\n  },\n  {\n    id: 'bulk-sms',\n    label: 'Toplu SMS',\n    icon: <MessageSquare className=\"w-4 h-4\" />,\n    description: 'Seçili hastalara toplu SMS gönder',\n    requiresConfirmation: true,\n    color: 'primary'\n  },\n  {\n    id: 'bulk-delete',\n    label: 'Toplu Silme',\n    icon: <Trash2 className=\"w-4 h-4\" />,\n    description: 'Seçili hastaları kalıcı olarak sil',\n    requiresConfirmation: true,\n    color: 'danger'\n  }\n];\n\nconst CSV_FIELD_MAPPING = {\n  'name': 'Ad Soyad',\n  'phone': 'Telefon',\n  'email': 'E-posta',\n  'birthDate': 'Doğum Tarihi',\n  'address': 'Adres',\n  'notes': 'Notlar',\n  'tags': 'Etiketler',\n  'segment': 'Segment',\n  'status': 'Durum'\n};\n\nexport const PatientBulkOperations: React.FC<PatientBulkOperationsProps> = ({\n  selectedPatients,\n  onClearSelection,\n  onRefresh\n}) => {\n  const { success, error, warning } = useToastHelpers();\n  const [activeAction, setActiveAction] = useState<string | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  \n  // CSV Import State\n  const [csvImport, setCsvImport] = useState<CSVImportData>({\n    file: null,\n    mapping: {},\n    preview: [],\n    errors: []\n  });\n  \n  // Bulk Actions State\n  const [bulkTagData, setBulkTagData] = useState({\n    action: 'add' as 'add' | 'remove',\n    tags: [] as string[],\n    newTag: ''\n  });\n  \n  const [bulkSmsData, setBulkSmsData] = useState({\n    message: '',\n    template: '',\n    sendTime: 'now' as 'now' | 'scheduled',\n    scheduledTime: ''\n  });\n\n  // Modals\n  const exportModal = useModal();\n  const importModal = useModal();\n  const tagModal = useModal();\n  const smsModal = useModal();\n  const deleteModal = useModal();\n\n  const handleActionClick = useCallback((actionId: string) => {\n    setActiveAction(actionId);\n    \n    switch (actionId) {\n      case 'export-csv':\n        exportModal.openModal();\n        break;\n      case 'import-csv':\n        importModal.openModal();\n        break;\n      case 'bulk-tag':\n        tagModal.openModal();\n        break;\n      case 'bulk-sms':\n        smsModal.openModal();\n        break;\n      case 'bulk-delete':\n        deleteModal.openModal();\n        break;\n    }\n  }, [exportModal, importModal, tagModal, smsModal, deleteModal]);\n\n  const handleCSVExport = useCallback(async () => {\n    try {\n      setIsProcessing(true);\n      \n      // Mock CSV export - gerçek API entegrasyonu için backend endpoint gerekli\n      const csvData = selectedPatients.map(patient => ({\n        'Ad Soyad': `${patient.firstName} ${patient.lastName}`,\n        'Telefon': patient.phone || '',\n        'E-posta': patient.email || '',\n        'TC No': patient.tcNumber || '',\n        'Doğum Tarihi': patient.birthDate || '',\n        'Adres': (() => {\n          const address = patient.address;\n          if (typeof address === 'object' && address !== null) {\n            const addressObj = address as any;\n            return addressObj.fullAddress || \n                   `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                   '';\n          }\n          return patient.addressFull || address || '';\n        })(),\n        'Durum': patient.status || 'active'\n      }));\n      \n      const headers = Object.keys(csvData[0] || {});\n      const csvContent = [\n        headers.join(','),\n        ...csvData.map(row => headers.map(header => `\"${row[header as keyof typeof row] || ''}\"`).join(','))\n      ].join('\\n');\n      \n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n      const link = document.createElement('a');\n      const url = URL.createObjectURL(blob);\n      link.setAttribute('href', url);\n      link.setAttribute('download', `hastalar_export_${new Date().toISOString().split('T')[0]}.csv`);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n      \n      success(`${selectedPatients.length} hasta verisi CSV formatında dışa aktarıldı`);\n      exportModal.closeModal();\n      \n    } catch (err: any) {\n      console.error('CSV export error:', err);\n      error('CSV dışa aktarma sırasında hata oluştu');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [selectedPatients, success, error, exportModal]);\n\n  const handleCSVImport = useCallback(async (file: File) => {\n    try {\n      setIsProcessing(true);\n      \n      // Önce dosyayı okuyup preview oluştur\n      const text = await file.text();\n      const lines = text.split('\\n').filter(line => line.trim());\n      \n      if (lines.length < 2) {\n        throw new Error('CSV dosyası en az 2 satır içermelidir (başlık + veri)');\n      }\n      \n      const headers = lines[0].split(',').map(h => h.replace(/\"/g, '').trim());\n      const preview = lines.slice(1, 6).map(line => {\n        const values = line.split(',').map(v => v.replace(/\"/g, '').trim());\n        return headers.reduce((obj, header, index) => {\n          obj[header] = values[index] || '';\n          return obj;\n        }, {} as any);\n      });\n      \n      setCsvImport({\n        file,\n        mapping: {},\n        preview,\n        errors: []\n      });\n      \n    } catch (err: any) {\n      console.error('CSV read error:', err);\n      error('CSV dosyası okunurken hata oluştu');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [error]);\n\n  const handleCSVImportSubmit = useCallback(async () => {\n    if (!csvImport.file) return;\n    \n    try {\n      setIsProcessing(true);\n      \n      // Mock import - gerçek API entegrasyonu için backend endpoint gerekli\n      await new Promise(resolve => setTimeout(resolve, 2000)); // Simulate API call\n      \n      const mockResult = {\n        created: Math.floor(Math.random() * 10) + 1,\n        updated: Math.floor(Math.random() * 5),\n        errors: []\n      };\n      \n      if (mockResult.errors.length > 0) {\n        warning(`${mockResult.created + mockResult.updated} hasta işlendi, ${mockResult.errors.length} hata oluştu`);\n      } else {\n        success(`${mockResult.created} yeni hasta eklendi, ${mockResult.updated} hasta güncellendi`);\n      }\n      \n      importModal.closeModal();\n      onRefresh();\n      \n      // CSV import state'ini temizle\n      setCsvImport({\n        file: null,\n        mapping: {},\n        preview: [],\n        errors: []\n      });\n      \n    } catch (err: any) {\n      console.error('CSV import error:', err);\n      error('CSV içe aktarma sırasında hata oluştu');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [csvImport.file, success, warning, error, importModal, onRefresh]);\n\n  const handleBulkTag = useCallback(async () => {\n    try {\n      setIsProcessing(true);\n      \n      // API çağrısı simülasyonu\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      const action = bulkTagData.action === 'add' ? 'eklendi' : 'kaldırıldı';\n      success(`${selectedPatients.length} hastaya etiket ${action}`);\n      \n      tagModal.closeModal();\n      onRefresh();\n      \n    } catch (err) {\n      error('Toplu etiketleme sırasında hata oluştu');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [bulkTagData, selectedPatients.length, success, error, tagModal, onRefresh]);\n\n  const handleBulkSMS = useCallback(async () => {\n    try {\n      setIsProcessing(true);\n      \n      // API çağrısı simülasyonu\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      success(`${selectedPatients.length} hastaya SMS gönderildi`);\n      \n      smsModal.closeModal();\n      onRefresh();\n      \n    } catch (err) {\n      error('Toplu SMS gönderimi sırasında hata oluştu');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [selectedPatients.length, success, error, smsModal, onRefresh]);\n\n  const handleBulkDelete = useCallback(async () => {\n    try {\n      setIsProcessing(true);\n      \n      // API çağrısı simülasyonu\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      success(`${selectedPatients.length} hasta silindi`);\n      \n      deleteModal.closeModal();\n      onClearSelection();\n      onRefresh();\n      \n    } catch (err) {\n      error('Toplu silme sırasında hata oluştu');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [selectedPatients.length, success, error, deleteModal, onClearSelection, onRefresh]);\n\n  if (selectedPatients.length === 0) {\n    return null;\n  }\n\n  return (\n    <>\n      {/* Bulk Operations Bar */}\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Users className=\"w-5 h-5 text-blue-600\" />\n              <span className=\"font-medium text-blue-900\">\n                {selectedPatients.length} hasta seçildi\n              </span>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              {BULK_ACTIONS.map(action => (\n                <Button\n                  key={action.id}\n                  variant={action.color === 'danger' ? 'danger' : action.color === 'primary' ? 'primary' : 'secondary'}\n                  size=\"sm\"\n                  onClick={() => handleActionClick(action.id)}\n                  disabled={isProcessing}\n                >\n                  {action.icon}\n                  {action.label}\n                </Button>\n              ))}\n              \n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => handleActionClick('import-csv')}\n                disabled={isProcessing}\n              >\n                <Upload className=\"w-4 h-4\" />\n                CSV İçe Aktar\n              </Button>\n            </div>\n          </div>\n          \n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={onClearSelection}\n          >\n            Seçimi Temizle\n          </Button>\n        </div>\n      </div>\n\n      {/* CSV Export Modal */}\n      <Modal\n        isOpen={exportModal.isOpen}\n        onClose={exportModal.closeModal}\n        title=\"CSV Dışa Aktarma\"\n        size=\"md\"\n      >\n        <div className=\"space-y-4\">\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\n            <h4 className=\"font-medium text-gray-900 mb-2\">Dışa Aktarılacak Veriler</h4>\n            <div className=\"grid grid-cols-2 gap-2 text-sm text-gray-600\">\n              {Object.values(CSV_FIELD_MAPPING).map(field => (\n                <div key={field} className=\"flex items-center space-x-2\">\n                  <FileText className=\"w-3 h-3\" />\n                  <span>{field}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n          \n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"outline\" onClick={exportModal.closeModal}>\n              İptal\n            </Button>\n            <Button \n              onClick={handleCSVExport}\n              loading={isProcessing}\n            >\n              <Download className=\"w-4 h-4 mr-2\" />\n              Dışa Aktar\n            </Button>\n          </div>\n        </div>\n      </Modal>\n\n      {/* CSV Import Modal */}\n      <Modal\n        isOpen={importModal.isOpen}\n        onClose={importModal.closeModal}\n        title=\"CSV İçe Aktarma\"\n        size=\"lg\"\n      >\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              CSV Dosyası Seç\n            </label>\n            <input\n              type=\"file\"\n              accept=\".csv\"\n              onChange={(e) => {\n                const file = e.target.files?.[0];\n                if (file) handleCSVImport(file);\n              }}\n              className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\n            />\n          </div>\n          \n          {csvImport.preview.length > 0 && (\n            <div>\n              <h4 className=\"font-medium text-gray-900 mb-2\">Önizleme</h4>\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      {Object.keys(csvImport.preview[0]).map(header => (\n                        <th key={header} className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase\">\n                          {header}\n                        </th>\n                      ))}\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\n                    {csvImport.preview.map((row, index) => (\n                      <tr key={index}>\n                        {Object.values(row).map((value: any, cellIndex) => (\n                          <td key={cellIndex} className=\"px-3 py-2 text-sm text-gray-900\">\n                            {value}\n                          </td>\n                        ))}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n          \n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"outline\" onClick={importModal.closeModal}>\n              İptal\n            </Button>\n            <Button \n              disabled={!csvImport.file}\n              loading={isProcessing}\n              onClick={handleCSVImportSubmit}\n            >\n              <Upload className=\"w-4 h-4 mr-2\" />\n              İçe Aktar\n            </Button>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Bulk Tag Modal */}\n      <Modal\n        isOpen={tagModal.isOpen}\n        onClose={tagModal.closeModal}\n        title=\"Toplu Etiketleme\"\n        size=\"md\"\n      >\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              İşlem Türü\n            </label>\n            <Select\n              value={bulkTagData.action}\n              onChange={(e) => setBulkTagData(prev => ({ ...prev, action: e.target.value as 'add' | 'remove' }))}\n              options={[\n                { label: 'Etiket Ekle', value: 'add' },\n                { label: 'Etiket Kaldır', value: 'remove' }\n              ]}\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Yeni Etiket Ekle\n            </label>\n            <div className=\"flex space-x-2\">\n              <Input\n                value={bulkTagData.newTag}\n                onChange={(e) => setBulkTagData(prev => ({ ...prev, newTag: e.target.value }))}\n                placeholder=\"Etiket adı...\"\n              />\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  if (bulkTagData.newTag.trim()) {\n                    setBulkTagData(prev => ({\n                      ...prev,\n                      tags: [...prev.tags, prev.newTag.trim()],\n                      newTag: ''\n                    }));\n                  }\n                }}\n              >\n                Ekle\n              </Button>\n            </div>\n          </div>\n          \n          {bulkTagData.tags.length > 0 && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Seçili Etiketler\n              </label>\n              <div className=\"flex flex-wrap gap-2\">\n                {bulkTagData.tags.map((tag, index) => (\n                  <div\n                    key={index}\n                    className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200\"\n                    onClick={() => setBulkTagData(prev => ({\n                      ...prev,\n                      tags: prev.tags.filter((_, i) => i !== index)\n                    }))}\n                  >\n                    {tag} ×\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n          \n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"outline\" onClick={tagModal.closeModal}>\n              İptal\n            </Button>\n            <Button \n              onClick={handleBulkTag}\n              loading={isProcessing}\n              disabled={bulkTagData.tags.length === 0}\n            >\n              <Tag className=\"w-4 h-4 mr-2\" />\n              Uygula\n            </Button>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Bulk SMS Modal */}\n      <Modal\n        isOpen={smsModal.isOpen}\n        onClose={smsModal.closeModal}\n        title=\"Toplu SMS Gönderimi\"\n        size=\"md\"\n      >\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              SMS Mesajı\n            </label>\n            <Textarea\n              value={bulkSmsData.message}\n              onChange={(e) => setBulkSmsData(prev => ({ ...prev, message: e.target.value }))}\n              placeholder=\"SMS mesajınızı yazın...\"\n              rows={4}\n            />\n            <div className=\"text-sm text-gray-500 mt-1\">\n              {bulkSmsData.message.length}/160 karakter\n            </div>\n          </div>\n          \n          <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\n            <div className=\"flex items-start space-x-2\">\n              <AlertCircle className=\"w-5 h-5 text-yellow-600 mt-0.5\" />\n              <div className=\"text-sm text-yellow-800\">\n                <strong>Uyarı:</strong> {selectedPatients.length} hastaya SMS gönderilecek. \n                Bu işlem geri alınamaz ve SMS ücreti uygulanacaktır.\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"outline\" onClick={smsModal.closeModal}>\n              İptal\n            </Button>\n            <Button \n              onClick={handleBulkSMS}\n              loading={isProcessing}\n              disabled={!bulkSmsData.message.trim()}\n            >\n              <MessageSquare className=\"w-4 h-4 mr-2\" />\n              SMS Gönder\n            </Button>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Bulk Delete Modal */}\n      <Modal\n        isOpen={deleteModal.isOpen}\n        onClose={deleteModal.closeModal}\n        title=\"Toplu Silme Onayı\"\n        size=\"md\"\n      >\n        <div className=\"space-y-4\">\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n            <div className=\"flex items-start space-x-3\">\n              <AlertCircle className=\"w-6 h-6 text-red-600 mt-0.5\" />\n              <div>\n                <h4 className=\"font-medium text-red-900\">Dikkat!</h4>\n                <p className=\"text-sm text-red-800 mt-1\">\n                  {selectedPatients.length} hasta kalıcı olarak silinecek. \n                  Bu işlem geri alınamaz ve tüm hasta verileri kaybolacaktır.\n                </p>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"space-y-2\">\n            <h5 className=\"font-medium text-gray-900\">Silinecek Hastalar:</h5>\n            <div className=\"max-h-32 overflow-y-auto space-y-1\">\n              {selectedPatients.slice(0, 10).map(patient => (\n                <div key={patient.id} className=\"text-sm text-gray-600\">\n                  • {`${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta'} ({patient.phone})\n                </div>\n              ))}\n              {selectedPatients.length > 10 && (\n                <div className=\"text-sm text-gray-500\">\n                  ... ve {selectedPatients.length - 10} hasta daha\n                </div>\n              )}\n            </div>\n          </div>\n          \n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"outline\" onClick={deleteModal.closeModal}>\n              İptal\n            </Button>\n            <Button \n              variant=\"danger\"\n              onClick={handleBulkDelete}\n              loading={isProcessing}\n            >\n              <Trash2 className=\"w-4 h-4 mr-2\" />\n              Sil\n            </Button>\n          </div>\n        </div>\n      </Modal>\n    </>\n  );\n};\n\nexport default PatientBulkOperations;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'User' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MapPin' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CreditCard' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Clock' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Heart' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":8},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":154,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":164,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":167,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":177,"endColumn":34},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":181,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":191,"endColumn":34},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":270,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":280,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":283,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":293,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":297,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":307,"endColumn":32}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button, Badge, Checkbox } from '@x-ear/ui-web';\nimport { \n  User, \n  Phone, \n  Mail, \n  Calendar, \n  MapPin, \n  CreditCard,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  MoreVertical,\n  Eye,\n  Edit,\n  Trash2,\n  Heart,\n  Activity,\n  Shield\n} from 'lucide-react';\nimport { PatientSearchItem } from '../../types/patient/patient-search.types';\n\ninterface PatientCardProps {\n  patient: PatientSearchItem;\n  selected?: boolean;\n  onSelect?: (patientId: string) => void;\n  onClick?: (patient: PatientSearchItem) => void;\n  onEdit?: (patient: PatientSearchItem) => void;\n  onDelete?: (patient: PatientSearchItem) => void;\n  showSelection?: boolean;\n  showActions?: boolean;\n  compact?: boolean;\n  className?: string;\n}\n\n/**\n * PatientCard Component\n * Displays patient information in a card format\n */\nexport function PatientCard({\n  patient,\n  selected = false,\n  onSelect,\n  onClick,\n  onEdit,\n  onDelete,\n  showSelection = false,\n  showActions = true,\n  compact = false,\n  className = ''\n}: PatientCardProps) {\n  const [showMenu, setShowMenu] = useState(false);\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'active':\n        return <Badge variant=\"success\" size=\"sm\">Aktif</Badge>;\n      case 'inactive':\n        return <Badge variant=\"warning\" size=\"sm\">Pasif</Badge>;\n      case 'archived':\n        return <Badge variant=\"secondary\" size=\"sm\">Arşiv</Badge>;\n      default:\n        return <Badge variant=\"secondary\" size=\"sm\">{status}</Badge>;\n    }\n  };\n\n  const getSegmentColor = (segment: string) => {\n    switch (segment) {\n      case 'premium':\n        return 'bg-purple-100 text-purple-800 border-purple-200';\n      case 'standard':\n        return 'bg-blue-100 text-blue-800 border-blue-200';\n      case 'basic':\n        return 'bg-gray-100 text-gray-800 border-gray-200';\n      default:\n        return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const formatCurrency = (amount: number) => {\n    return `₺${amount.toLocaleString('tr-TR')}`;\n  };\n\n  const getInitials = (firstName?: string, lastName?: string) => {\n    const first = firstName?.charAt(0) || '';\n    const last = lastName?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase() || 'N/A';\n  };\n\n  const handleCardClick = (e: React.MouseEvent) => {\n    // Don't trigger card click if clicking on interactive elements\n    if ((e.target as HTMLElement).closest('button, input, [role=\"button\"]')) {\n      return;\n    }\n    onClick?.(patient);\n  };\n\n  if (compact) {\n    return (\n      <div\n        className={`bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-all cursor-pointer ${\n          selected ? 'ring-2 ring-blue-500 border-blue-300' : ''\n        } ${className}`}\n        onClick={handleCardClick}\n      >\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            {showSelection && (\n              <Checkbox\n                checked={selected}\n                onChange={() => onSelect?.(patient.id)}\n                onClick={(e) => e.stopPropagation()}\n              />\n            )}\n            \n            <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-medium\">\n              {getInitials(patient.firstName, patient.lastName)}\n            </div>\n            \n            <div>\n              <h3 className=\"text-sm font-medium text-gray-900\">\n                {patient.firstName || ''} {patient.lastName || ''}\n              </h3>\n              <p className=\"text-xs text-gray-500\">\n                {formatDate(patient.registrationDate)}\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center space-x-2\">\n            {getStatusBadge(patient.status)}\n            \n            {showActions && (\n              <div className=\"relative\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    setShowMenu(!showMenu);\n                  }}\n                  className=\"p-1\"\n                >\n                  <MoreVertical className=\"h-4 w-4\" />\n                </Button>\n                \n                {showMenu && (\n                  <div className=\"absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10\">\n                    <div className=\"py-1\">\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          onClick?.(patient);\n                          setShowMenu(false);\n                        }}\n                        className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center\"\n                      >\n                        <Eye className=\"h-4 w-4 mr-2\" />\n                        Görüntüle\n                      </button>\n                      \n                      {onEdit && (\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            onEdit(patient);\n                            setShowMenu(false);\n                          }}\n                          className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center\"\n                        >\n                          <Edit className=\"h-4 w-4 mr-2\" />\n                          Düzenle\n                        </button>\n                      )}\n                      \n                      {onDelete && (\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            onDelete(patient);\n                            setShowMenu(false);\n                          }}\n                          className=\"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center\"\n                        >\n                          <Trash2 className=\"h-4 w-4 mr-2\" />\n                          Sil\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className={`bg-white rounded-lg border border-gray-200 hover:shadow-lg transition-all cursor-pointer ${\n        selected ? 'ring-2 ring-blue-500 border-blue-300' : ''\n      } ${className}`}\n      onClick={handleCardClick}\n    >\n      {/* Header */}\n      <div className=\"p-6 pb-4\">\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            {showSelection && (\n              <Checkbox\n                checked={selected}\n                onChange={() => onSelect?.(patient.id)}\n                onClick={(e) => e.stopPropagation()}\n              />\n            )}\n            \n            <div className=\"h-16 w-16 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white text-xl font-medium\">\n              {getInitials(patient.firstName, patient.lastName)}\n            </div>\n            \n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">\n                {patient.firstName || ''} {patient.lastName || ''}\n              </h3>\n              \n              <div className=\"flex items-center space-x-2 mt-1\">\n                {getStatusBadge(patient.status)}\n                \n                <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${\n                  getSegmentColor(patient.segment)\n                }`}>\n                  {patient.segment}\n                </span>\n              </div>\n              \n              {patient.priority > 0 && (\n                <div className=\"mt-2\">\n                  <Badge variant=\"warning\" size=\"sm\">\n                    <AlertCircle className=\"h-3 w-3 mr-1\" />\n                    Yüksek Öncelik ({patient.priority})\n                  </Badge>\n                </div>\n              )}\n            </div>\n          </div>\n          \n          {showActions && (\n            <div className=\"relative\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  setShowMenu(!showMenu);\n                }}\n                className=\"p-2\"\n              >\n                <MoreVertical className=\"h-5 w-5\" />\n              </Button>\n              \n              {showMenu && (\n                <div className=\"absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-10\">\n                  <div className=\"py-1\">\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        onClick?.(patient);\n                        setShowMenu(false);\n                      }}\n                      className=\"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center\"\n                    >\n                      <Eye className=\"h-4 w-4 mr-3\" />\n                      Detayları Görüntüle\n                    </button>\n                    \n                    {onEdit && (\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          onEdit(patient);\n                          setShowMenu(false);\n                        }}\n                        className=\"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center\"\n                      >\n                        <Edit className=\"h-4 w-4 mr-3\" />\n                        Düzenle\n                      </button>\n                    )}\n                    \n                    {onDelete && (\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          onDelete(patient);\n                          setShowMenu(false);\n                        }}\n                        className=\"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center\"\n                      >\n                        <Trash2 className=\"h-4 w-4 mr-3\" />\n                        Sil\n                      </button>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"px-6 pb-4\">\n        <div className=\"grid grid-cols-2 gap-4\">\n          {/* Contact Info */}\n           <div className=\"space-y-2\">\n             {patient.phone && (\n               <div className=\"flex items-center text-sm text-gray-600\">\n                 <Phone className=\"h-4 w-4 mr-2 text-gray-400\" />\n                 {patient.phone}\n               </div>\n             )}\n             \n             {patient.email && (\n               <div className=\"flex items-center text-sm text-gray-600\">\n                 <Mail className=\"h-4 w-4 mr-2 text-gray-400\" />\n                 {patient.email}\n               </div>\n             )}\n           </div>\n          \n          {/* Stats */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center text-sm text-gray-600\">\n              <Calendar className=\"h-4 w-4 mr-2 text-gray-400\" />\n              Kayıt: {formatDate(patient.registrationDate)}\n            </div>\n            \n            {patient.deviceCount > 0 && (\n              <div className=\"flex items-center text-sm text-gray-600\">\n                <Activity className=\"h-4 w-4 mr-2 text-gray-400\" />\n                {patient.deviceCount} Cihaz\n              </div>\n            )}\n            \n            {patient.hasInsurance && (\n              <div className=\"flex items-center text-sm text-green-600\">\n                <Shield className=\"h-4 w-4 mr-2\" />\n                Sigortalı\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Footer */}\n      <div className=\"px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg\">\n        <div className=\"flex items-center justify-between\">\n          {/* Labels */}\n          <div className=\"flex flex-wrap gap-1\">\n            {patient.labels && patient.labels.length > 0 && (\n              patient.labels.slice(0, 3).map((label, index) => (\n                <span\n                  key={index}\n                  className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800\"\n                >\n                  {label}\n                </span>\n              ))\n            )}\n            \n            {patient.labels && patient.labels.length > 3 && (\n              <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-600\">\n                +{patient.labels.length - 3}\n              </span>\n            )}\n          </div>\n          \n          {/* Balance */}\n          <div className=\"text-right\">\n            {patient.outstandingBalance > 0 ? (\n              <div className=\"text-sm font-medium text-red-600\">\n                Borç: {formatCurrency(patient.outstandingBalance)}\n              </div>\n            ) : (\n              <div className=\"flex items-center text-sm text-green-600\">\n                <CheckCircle className=\"h-4 w-4 mr-1\" />\n                Bakiye Temiz\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientCommunicationIntegration.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Plus' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Filter' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Search' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getTemplates' is assigned a value but never used.","line":110,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":313,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":325,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":326,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":338,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":350,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":357,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":362,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":369,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":383,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":392,"endColumn":28}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Communication Integration Component\n * Integrates patient management with communication center\n */\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { \n  MessageSquare, \n  Mail, \n  Send, \n  Clock, \n  CheckCircle, \n  AlertCircle,\n  History,\n  Plus,\n  Filter,\n  Search,\n  Calendar,\n  User,\n  Phone,\n  AtSign\n} from 'lucide-react';\nimport { Button, Card, Badge, Input, Select, Textarea, Checkbox, useToastHelpers } from '@x-ear/ui-web';\nimport { Patient } from '../../types/patient';\nimport { useCommunicationOfflineSync } from '../../hooks/useCommunicationOfflineSync';\n\ninterface PatientCommunicationIntegrationProps {\n  patient: Patient;\n  onClose?: () => void;\n}\n\ninterface CommunicationMessage {\n  id: string;\n  type: 'sms' | 'email';\n  recipient: string;\n  recipientName?: string;\n  patientId?: string;\n  subject?: string;\n  content: string;\n  templateId?: string;\n  scheduledAt?: string;\n  sentAt?: string;\n  deliveredAt?: string;\n  status: 'draft' | 'scheduled' | 'sent' | 'delivered' | 'failed';\n  errorMessage?: string;\n  messageType: 'manual' | 'appointment_reminder' | 'campaign' | 'automated';\n  createdAt: string;\n  updatedAt?: string;\n}\n\ninterface QuickMessageTemplate {\n  id: string;\n  name: string;\n  type: 'sms' | 'email';\n  content: string;\n  subject?: string;\n  category: 'appointment' | 'reminder' | 'follow_up' | 'general';\n}\n\nconst QUICK_TEMPLATES: QuickMessageTemplate[] = [\n  {\n    id: 'appointment_reminder',\n    name: 'Randevu Hatırlatması',\n    type: 'sms',\n    content: 'Sayın {{patientName}}, {{appointmentDate}} tarihinde saat {{appointmentTime}}\\'da randevunuz bulunmaktadır. Teşekkürler.',\n    category: 'appointment'\n  },\n  {\n    id: 'follow_up',\n    name: 'Tedavi Sonrası Takip',\n    type: 'sms',\n    content: 'Sayın {{patientName}}, tedaviniz sonrası durumunuz nasıl? Herhangi bir sorunuz varsa bize ulaşabilirsiniz.',\n    category: 'follow_up'\n  },\n  {\n    id: 'payment_reminder',\n    name: 'Ödeme Hatırlatması',\n    type: 'sms',\n    content: 'Sayın {{patientName}}, {{amount}} TL tutarındaki ödemenizin son tarihi {{dueDate}}\\'dir. Teşekkürler.',\n    category: 'reminder'\n  },\n  {\n    id: 'welcome_email',\n    name: 'Hoş Geldiniz E-postası',\n    type: 'email',\n    subject: 'Kliniğimize Hoş Geldiniz',\n    content: 'Sayın {{patientName}},\\n\\nKliniğimizi tercih ettiğiniz için teşekkür ederiz. Size en iyi hizmeti sunmak için buradayız.\\n\\nSaygılarımızla,\\nKlinik Ekibi',\n    category: 'general'\n  }\n];\n\nexport const PatientCommunicationIntegration: React.FC<PatientCommunicationIntegrationProps> = ({\n  patient,\n  onClose\n}) => {\n  const [activeTab, setActiveTab] = useState<'send' | 'history'>('send');\n  const [messageType, setMessageType] = useState<'sms' | 'email'>('sms');\n  const [selectedTemplate, setSelectedTemplate] = useState<string>('');\n  const [messageContent, setMessageContent] = useState('');\n  const [messageSubject, setMessageSubject] = useState('');\n  const [scheduleDate, setScheduleDate] = useState('');\n  const [scheduleTime, setScheduleTime] = useState('');\n  const [isScheduled, setIsScheduled] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n\n  const { \n    getMessages,\n    getTemplates,\n    saveMessage, \n    syncStatus\n  } = useCommunicationOfflineSync();\n\n  const { success, error } = useToastHelpers();\n\n  // Patient'a ait mesajları filtrele\n  const patientMessages = useMemo(() => {\n    const allMessages = getMessages();\n    return allMessages.filter(message => \n      message.patientId === patient.id ||\n      message.recipient === patient.phone ||\n      message.recipient === patient.email\n    );\n  }, [getMessages, patient.id, patient.phone, patient.email]);\n\n  // Filtrelenmiş mesajlar\n  const filteredMessages = useMemo(() => {\n    return patientMessages.filter(message => {\n      // Durum filtresi\n      if (statusFilter !== 'all' && message.status !== statusFilter) return false;\n      \n      // Arama filtresi\n      if (searchTerm) {\n        const searchLower = searchTerm.toLowerCase();\n        const matchesSearch = \n          message.content?.toLowerCase().includes(searchLower) ||\n          message.subject?.toLowerCase().includes(searchLower);\n        if (!matchesSearch) return false;\n      }\n      \n      return true;\n    });\n  }, [patientMessages, statusFilter, searchTerm]);\n\n  // Template seçildiğinde içeriği doldur\n  const handleTemplateSelect = useCallback((templateId: string) => {\n    setSelectedTemplate(templateId);\n    \n    const template = QUICK_TEMPLATES.find(t => t.id === templateId);\n    if (template) {\n      // Template değişkenlerini hasta bilgileriyle değiştir\n      let content = template.content;\n      const patientFullName = `${patient.firstName || ''} ${patient.lastName || ''}`.trim();\n      content = content.replace(/\\{\\{patientName\\}\\}/g, patientFullName || '');\n      content = content.replace(/\\{\\{patientPhone\\}\\}/g, patient.phone || '');\n      content = content.replace(/\\{\\{patientEmail\\}\\}/g, patient.email || '');\n      \n      setMessageContent(content);\n      setMessageSubject(template.subject || '');\n      setMessageType(template.type);\n    }\n  }, [patient]);\n\n  // Mesaj gönder\n  const handleSendMessage = useCallback(async () => {\n    if (!messageContent.trim()) {\n      error('Mesaj içeriği boş olamaz');\n      return;\n    }\n\n    const recipient = messageType === 'sms' ? patient.phone : patient.email;\n    if (!recipient) {\n      error(`Hasta ${messageType === 'sms' ? 'telefon numarası' : 'e-posta adresi'} bulunamadı`);\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const scheduledAt = isScheduled && scheduleDate && scheduleTime \n        ? new Date(`${scheduleDate}T${scheduleTime}`).toISOString()\n        : undefined;\n\n      const messageData: Omit<CommunicationMessage, 'id' | 'createdAt'> = {\n        type: messageType,\n        recipient,\n        recipientName: `${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta',\n        patientId: patient.id,\n        subject: messageType === 'email' ? messageSubject : undefined,\n        content: messageContent,\n        templateId: selectedTemplate || undefined,\n        scheduledAt,\n        status: scheduledAt ? 'scheduled' : 'sent',\n        messageType: 'manual',\n        sentAt: scheduledAt ? undefined : new Date().toISOString()\n      };\n\n      await saveMessage({\n        ...messageData,\n        id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        createdAt: new Date().toISOString()\n      });\n\n      success(scheduledAt ? 'Mesaj zamanlandı' : 'Mesaj gönderildi');\n      \n      // Form'u temizle\n      setMessageContent('');\n      setMessageSubject('');\n      setSelectedTemplate('');\n      setIsScheduled(false);\n      setScheduleDate('');\n      setScheduleTime('');\n      \n    } catch (err) {\n      error('Mesaj gönderme sırasında hata oluştu: ' + (err instanceof Error ? err.message : 'Bilinmeyen hata'));\n    } finally {\n      setIsLoading(false);\n    }\n  }, [\n    messageContent, \n    messageType, \n    patient, \n    messageSubject, \n    isScheduled, \n    scheduleDate, \n    scheduleTime, \n    selectedTemplate,\n    saveMessage,\n    success,\n    error\n  ]);\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'sent': return <Send className=\"w-4 h-4 text-blue-500\" />;\n      case 'delivered': return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n      case 'failed': return <AlertCircle className=\"w-4 h-4 text-red-500\" />;\n      case 'scheduled': return <Clock className=\"w-4 h-4 text-yellow-500\" />;\n      default: return <Clock className=\"w-4 h-4 text-gray-500\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    switch (status) {\n      case 'sent': return 'Gönderildi';\n      case 'delivered': return 'Teslim Edildi';\n      case 'failed': return 'Başarısız';\n      case 'scheduled': return 'Zamanlandı';\n      case 'draft': return 'Taslak';\n      default: return status;\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'sent': return 'bg-blue-100 text-blue-800';\n      case 'delivered': return 'bg-green-100 text-green-800';\n      case 'failed': return 'bg-red-100 text-red-800';\n      case 'scheduled': return 'bg-yellow-100 text-yellow-800';\n      case 'draft': return 'bg-gray-100 text-gray-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  if (!syncStatus) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">İletişim sistemi yükleniyor...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Hasta Bilgileri */}\n      <Card className=\"p-4\">\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"p-3 bg-blue-100 rounded-full\">\n            <User className=\"w-6 h-6 text-blue-600\" />\n          </div>\n          <div className=\"flex-1\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">{`${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta'}</h3>\n            <div className=\"flex items-center space-x-4 text-sm text-gray-600 mt-1\">\n              {patient.phone && (\n                <div className=\"flex items-center space-x-1\">\n                  <Phone className=\"w-4 h-4\" />\n                  <span>{patient.phone}</span>\n                </div>\n              )}\n              {patient.email && (\n                <div className=\"flex items-center space-x-1\">\n                  <AtSign className=\"w-4 h-4\" />\n                  <span>{patient.email}</span>\n                </div>\n              )}\n            </div>\n          </div>\n          {onClose && (\n            <Button variant=\"outline\" size=\"sm\" onClick={onClose}>\n              Kapat\n            </Button>\n          )}\n        </div>\n      </Card>\n\n      {/* Tab Navigation */}\n      <div className=\"border-b border-gray-200\">\n        <nav className=\"-mb-px flex space-x-8\">\n          <button\n            onClick={() => setActiveTab('send')}\n            className={`py-2 px-1 border-b-2 font-medium text-sm ${\n              activeTab === 'send'\n                ? 'border-blue-500 text-blue-600'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n            }`}\n          >\n            <div className=\"flex items-center space-x-2\">\n              <Send className=\"w-4 h-4\" />\n              <span>Mesaj Gönder</span>\n            </div>\n          </button>\n          <button\n            onClick={() => setActiveTab('history')}\n            className={`py-2 px-1 border-b-2 font-medium text-sm ${\n              activeTab === 'history'\n                ? 'border-blue-500 text-blue-600'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n            }`}\n          >\n            <div className=\"flex items-center space-x-2\">\n              <History className=\"w-4 h-4\" />\n              <span>Mesaj Geçmişi ({patientMessages.length})</span>\n            </div>\n          </button>\n        </nav>\n      </div>\n\n      {/* Send Message Tab */}\n      {activeTab === 'send' && (\n        <div className=\"space-y-6\">\n          {/* Message Type Selection */}\n          <Card className=\"p-4\">\n            <h4 className=\"text-sm font-medium text-gray-900 mb-3\">Mesaj Türü</h4>\n            <div className=\"flex space-x-4\">\n              <label className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  name=\"messageType\"\n                  value=\"sms\"\n                  checked={messageType === 'sms'}\n                  onChange={(e) => setMessageType(e.target.value as 'sms' | 'email')}\n                  className=\"mr-2\"\n                />\n                <MessageSquare className=\"w-4 h-4 mr-1\" />\n                SMS\n              </label>\n              <label className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  name=\"messageType\"\n                  value=\"email\"\n                  checked={messageType === 'email'}\n                  onChange={(e) => setMessageType(e.target.value as 'sms' | 'email')}\n                  className=\"mr-2\"\n                />\n                <Mail className=\"w-4 h-4 mr-1\" />\n                E-posta\n              </label>\n            </div>\n          </Card>\n\n          {/* Quick Templates */}\n          <Card className=\"p-4\">\n            <h4 className=\"text-sm font-medium text-gray-900 mb-3\">Hızlı Şablonlar</h4>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n              {QUICK_TEMPLATES\n                .filter(template => template.type === messageType)\n                .map(template => (\n                  <button\n                    key={template.id}\n                    onClick={() => handleTemplateSelect(template.id)}\n                    className={`p-3 text-left border rounded-lg hover:bg-gray-50 transition-colors ${\n                      selectedTemplate === template.id ? 'border-blue-500 bg-blue-50' : 'border-gray-200'\n                    }`}\n                  >\n                    <div className=\"font-medium text-sm text-gray-900\">{template.name}</div>\n                    <div className=\"text-xs text-gray-600 mt-1 line-clamp-2\">{template.content}</div>\n                  </button>\n                ))}\n            </div>\n          </Card>\n\n          {/* Message Compose */}\n          <Card className=\"p-4\">\n            <div className=\"space-y-4\">\n              {messageType === 'email' && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Konu\n                  </label>\n                  <Input\n                    value={messageSubject}\n                    onChange={(e) => setMessageSubject(e.target.value)}\n                    placeholder=\"E-posta konusu\"\n                  />\n                </div>\n              )}\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Mesaj İçeriği\n                </label>\n                <Textarea\n                  value={messageContent}\n                  onChange={(e) => setMessageContent(e.target.value)}\n                  placeholder={`${messageType === 'sms' ? 'SMS' : 'E-posta'} içeriğini yazın...`}\n                  rows={messageType === 'sms' ? 4 : 8}\n                  className=\"resize-none\"\n                />\n                {messageType === 'sms' && (\n                  <div className=\"text-xs text-gray-500 mt-1\">\n                    {messageContent.length}/160 karakter\n                  </div>\n                )}\n              </div>\n\n              {/* Schedule Options */}\n              <div>\n                <label className=\"flex items-center\">\n                  <Checkbox\n                    checked={isScheduled}\n                    onChange={(e) => setIsScheduled(e.target.checked)}\n                  />\n                  <span className=\"ml-2 text-sm text-gray-700\">Mesajı zamanla</span>\n                </label>\n\n                {isScheduled && (\n                  <div className=\"mt-3 grid grid-cols-2 gap-3\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Tarih\n                      </label>\n                      <Input\n                        type=\"date\"\n                        value={scheduleDate}\n                        onChange={(e) => setScheduleDate(e.target.value)}\n                        min={new Date().toISOString().split('T')[0]}\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Saat\n                      </label>\n                      <Input\n                        type=\"time\"\n                        value={scheduleTime}\n                        onChange={(e) => setScheduleTime(e.target.value)}\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Send Button */}\n              <div className=\"flex justify-end\">\n                <Button\n                  onClick={handleSendMessage}\n                  disabled={isLoading || !messageContent.trim()}\n                  className=\"flex items-center space-x-2\"\n                >\n                  {isLoading ? (\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                  ) : (\n                    <Send className=\"w-4 h-4\" />\n                  )}\n                  <span>{isScheduled ? 'Zamanla' : 'Gönder'}</span>\n                </Button>\n              </div>\n            </div>\n          </Card>\n        </div>\n      )}\n\n      {/* Message History Tab */}\n      {activeTab === 'history' && (\n        <div className=\"space-y-4\">\n          {/* Filters */}\n          <Card className=\"p-4\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"flex-1\">\n                <Input\n                  placeholder=\"Mesajlarda ara...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"w-full\"\n                />\n              </div>\n              <Select\n                value={statusFilter}\n                onChange={(e) => setStatusFilter(e.target.value)}\n                options={[\n                  { value: 'all', label: 'Tüm Durumlar' },\n                  { value: 'sent', label: 'Gönderildi' },\n                  { value: 'delivered', label: 'Teslim Edildi' },\n                  { value: 'failed', label: 'Başarısız' },\n                  { value: 'scheduled', label: 'Zamanlandı' }\n                ]}\n              />\n            </div>\n          </Card>\n\n          {/* Messages List */}\n          {filteredMessages.length > 0 ? (\n            <div className=\"space-y-3\">\n              {filteredMessages.map(message => (\n                <Card key={message.id} className=\"p-4\">\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-3 mb-2\">\n                        <div className=\"flex items-center space-x-2\">\n                          {message.type === 'sms' ? (\n                            <MessageSquare className=\"w-4 h-4 text-blue-500\" />\n                          ) : (\n                            <Mail className=\"w-4 h-4 text-green-500\" />\n                          )}\n                          <span className=\"font-medium text-sm\">{message.type.toUpperCase()}</span>\n                        </div>\n                        \n                        <Badge className={getStatusColor(message.status)}>\n                          <div className=\"flex items-center space-x-1\">\n                            {getStatusIcon(message.status)}\n                            <span>{getStatusLabel(message.status)}</span>\n                          </div>\n                        </Badge>\n                      </div>\n                      \n                      {message.subject && (\n                        <div className=\"font-medium text-gray-900 mb-1\">{message.subject}</div>\n                      )}\n                      \n                      <div className=\"text-sm text-gray-700 mb-2 line-clamp-3\">\n                        {message.content}\n                      </div>\n                      \n                      <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n                        <span>Oluşturulma: {new Date(message.createdAt).toLocaleString('tr-TR')}</span>\n                        {message.sentAt && (\n                          <span>Gönderilme: {new Date(message.sentAt).toLocaleString('tr-TR')}</span>\n                        )}\n                        {message.deliveredAt && (\n                          <span>Teslim: {new Date(message.deliveredAt).toLocaleString('tr-TR')}</span>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card className=\"p-8 text-center\">\n              <MessageSquare className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Mesaj bulunamadı</h3>\n              <p className=\"text-gray-600\">\n                {searchTerm || statusFilter !== 'all' \n                  ? 'Arama kriterlerinize uygun mesaj bulunamadı.'\n                  : 'Bu hasta ile henüz mesaj alışverişi yapılmamış.'\n                }\n              </p>\n            </Card>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PatientCommunicationIntegration;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientDevicesTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onPatientUpdate' is defined but never used.","line":24,"column":80,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":95},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadPatientDevices' and 'loadPatientSales'. Either include them or remove the dependency array.","line":45,"column":6,"nodeType":"ArrayExpression","endLine":45,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [loadPatientDevices, loadPatientSales, patient.id]","fix":{"range":[1929,1941],"text":"[loadPatientDevices, loadPatientSales, patient.id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3582,3585],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3582,3585],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":172,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5827,5830],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5827,5830],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'api' is assigned a value but never used.","line":177,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":177,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'updateData' is assigned a value but never used.","line":179,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":179,"endColumn":57},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":204,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6811,6814],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6811,6814],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":489,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":489,"endColumn":105},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":495,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":502,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":508,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":515,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":530,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":537,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":545,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":550,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":558,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":558,"endColumn":88},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":564,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":571,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":577,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":584,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":599,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":606,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":614,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":619,"endColumn":32}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Input, Badge } from '@x-ear/ui-web';\nimport { FileText, Plus, Calendar, DollarSign, Settings, Trash2, Edit, X, XCircle } from 'lucide-react';\nimport { Patient } from '../../types/patient';\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/xEarCRMAPIAutoGenerated';\nimport type { \n  Device, \n  DevicesGetDevicesParams,\n  DevicesCreateDeviceBody,\n  InventoryItem,\n  InventoryGetInventoryItemsParams,\n  InventoryAssignToPatientBody,\n  Sale,\n  SalesCreateSaleBody\n} from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport DeviceEditModal from './modals/DeviceEditModal';\nimport DeviceReplacementHistory from '../DeviceReplacementHistory';\n\ninterface PatientDevicesTabProps {\n  patient: Patient;\n  onPatientUpdate?: (patient: Patient) => void;\n}\n\nexport const PatientDevicesTab: React.FC<PatientDevicesTabProps> = ({ patient, onPatientUpdate }) => {\n  const [showDeviceForm, setShowDeviceForm] = useState(false);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editingDevice, setEditingDevice] = useState<Device | null>(null);\n  const [rightEarMode, setRightEarMode] = useState<'inventory' | 'manual'>('inventory');\n  const [leftEarMode, setLeftEarMode] = useState<'inventory' | 'manual'>('manual');\n  const [rightEarReason, setRightEarReason] = useState<'Trial' | 'Sale'>('Trial');\n  const [leftEarReason, setLeftEarReason] = useState<'Trial' | 'Sale'>('Trial');\n  \n  // State for API data\n  const [devices, setDevices] = useState<Device[]>([]);\n  const [inventoryItems, setInventoryItems] = useState<InventoryItem[]>([]);\n  const [sales, setSales] = useState<Sale[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load data on component mount\n  useEffect(() => {\n    loadPatientDevices();\n    loadInventoryItems();\n    loadPatientSales();\n  }, [patient.id]);\n\n  const loadPatientDevices = async () => {\n    if (!patient.id) return;\n    \n    setLoading(true);\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const params: DevicesGetDevicesParams = {\n        page: 1,\n        per_page: 20 // Reduced from 100 to 20 to minimize data transfer\n      };\n      \n      const response = await api.devicesGetDevices(params);\n      // Filter devices assigned to this patient\n      const patientDevices = response.data?.data?.filter(device => \n        device.patientId === patient.id\n      ) || [];\n      setDevices(patientDevices);\n    } catch (err) {\n      console.error('Error loading patient devices:', err);\n      setError('Cihazlar yüklenirken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadInventoryItems = async () => {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const params: InventoryGetInventoryItemsParams = {\n        page: 1,\n        per_page: 20, // Reduced from 100 to 20 to minimize data transfer\n        status: 'IN_STOCK'\n      };\n      \n      const response = await api.inventoryGetInventoryItems(params);\n      setInventoryItems(response.data?.data || []);\n    } catch (err) {\n      console.error('Error loading inventory:', err);\n    }\n  };\n\n  const loadPatientSales = async () => {\n    if (!patient.id) return;\n    \n    try {\n      // Note: This would need to be filtered by patient ID in a real implementation\n      // For now, we'll use mock data structure\n      setSales([]);\n    } catch (err) {\n      console.error('Error loading patient sales:', err);\n    }\n  };\n\n  const handleAssignDevice = async (deviceData: any) => {\n    try {\n      setLoading(true);\n      \n      if (deviceData.mode === 'inventory') {\n        // Assign from inventory\n        const api = getXEarCRMAPIAutoGenerated();\n        const assignData: InventoryAssignToPatientBody = {\n          patientId: patient.id,\n          quantity: 1,\n          reason: deviceData.reason\n        };\n        \n        await api.inventoryAssignToPatient(deviceData.inventoryId, assignData);\n      } else {\n        // Create new device manually\n        const api = getXEarCRMAPIAutoGenerated();\n        const createData: DevicesCreateDeviceBody = {\n          patientId: patient.id,\n          serialNumber: deviceData.serialNumber,\n          brand: deviceData.brand,\n          model: deviceData.model,\n          deviceType: deviceData.deviceType,\n          ear: deviceData.ear,\n          status: deviceData.reason === 'Trial' ? 'assigned' : 'assigned'\n        };\n        \n        await api.devicesCreateDevice(createData);\n      }\n\n      // If it's a sale, create sale record\n      if (deviceData.reason === 'Sale') {\n        const api = getXEarCRMAPIAutoGenerated();\n        const saleData: SalesCreateSaleBody = {\n          patientId: patient.id,\n          deviceId: deviceData.deviceId,\n          amount: deviceData.salePrice,\n          paymentMethod: deviceData.paymentMethod,\n          notes: `${deviceData.brand} ${deviceData.model} satışı`\n        };\n        \n        await api.salesCreateSale(saleData);\n      }\n\n      await loadPatientDevices();\n      await loadPatientSales();\n      setShowDeviceForm(false);\n      setError(null);\n    } catch (err) {\n      console.error('Error assigning device:', err);\n      setError('Cihaz atanırken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRemoveDevice = async (deviceId: string) => {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      await api.devicesDeleteDevice(deviceId);\n      await loadPatientDevices();\n    } catch (err) {\n      console.error('Error removing device:', err);\n      setError('Cihaz kaldırılırken hata oluştu');\n    }\n  };\n\n  const handleEditDevice = (device: Device) => {\n    setEditingDevice(device);\n    setShowEditModal(true);\n  };\n\n  const handleUpdateDevice = async (deviceData: any) => {\n    if (!editingDevice?.id) return;\n    \n    try {\n      setLoading(true);\n      const api = getXEarCRMAPIAutoGenerated();\n      \n      const updateData: Partial<DevicesCreateDeviceBody> = {\n        serialNumber: deviceData.serialNumber,\n        brand: deviceData.brand,\n        model: deviceData.model,\n        deviceType: deviceData.deviceType,\n        ear: deviceData.ear,\n        status: deviceData.status,\n        notes: deviceData.notes\n      };\n      \n      // Note: This assumes there's an update method in the API\n      // await devicesApi.devicesUpdateDevice(editingDevice.id, updateData);\n      \n      await loadPatientDevices();\n      setShowEditModal(false);\n      setEditingDevice(null);\n      setError(null);\n    } catch (err) {\n      console.error('Error updating device:', err);\n      setError('Cihaz güncellenirken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleReplaceDevice = async (oldDeviceId: string, newDeviceData: any) => {\n    try {\n      setLoading(true);\n      \n      // Remove old device\n      await handleRemoveDevice(oldDeviceId);\n      \n      // Add new device\n      await handleAssignDevice(newDeviceData);\n      \n      setError(null);\n    } catch (err) {\n      console.error('Error replacing device:', err);\n      setError('Cihaz değiştirilirken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Calculate quick stats from loaded data\n  const quickStats = {\n    activeDevices: devices.filter(d => d.status === 'ASSIGNED').length,\n    trials: devices.filter(d => d.trialStartDate).length,\n    totalValue: sales.reduce((sum, s) => sum + (s.totalAmount || 0), 0),\n    ereceiptsCount: 0 // This would come from a separate API\n  };\n\n  const getDeviceStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'assigned':\n        return <Badge className=\"bg-green-100 text-green-800\">Atanmış</Badge>;\n      case 'available':\n        return <Badge className=\"bg-blue-100 text-blue-800\">Müsait</Badge>;\n      case 'maintenance':\n        return <Badge className=\"bg-yellow-100 text-yellow-800\">Bakımda</Badge>;\n      case 'retired':\n        return <Badge className=\"bg-gray-100 text-gray-800\">Emekli</Badge>;\n      default:\n        return <Badge className=\"bg-gray-100 text-gray-800\">Bilinmiyor</Badge>;\n    }\n  };\n\n  const getEarText = (ear?: string) => {\n    switch (ear) {\n      case 'left':\n        return 'Sol';\n      case 'right':\n        return 'Sağ';\n      case 'both':\n        return 'İkisi';\n      default:\n        return 'Belirtilmemiş';\n    }\n  };\n\n  if (loading && devices.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Cihazlar yükleniyor...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Quick Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">Aktif Cihaz</p>\n              <p className=\"text-2xl font-bold text-green-600\">{quickStats.activeDevices}</p>\n            </div>\n            <div className=\"p-2 bg-green-100 rounded-full\">\n              <Settings className=\"w-6 h-6 text-green-600\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">Deneme</p>\n              <p className=\"text-2xl font-bold text-blue-600\">{quickStats.trials}</p>\n            </div>\n            <div className=\"p-2 bg-blue-100 rounded-full\">\n              <Calendar className=\"w-6 h-6 text-blue-600\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">Toplam Değer</p>\n              <p className=\"text-2xl font-bold text-purple-600\">₺{quickStats.totalValue.toLocaleString()}</p>\n            </div>\n            <div className=\"p-2 bg-purple-100 rounded-full\">\n              <DollarSign className=\"w-6 h-6 text-purple-600\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600\">E-Reçete</p>\n              <p className=\"text-2xl font-bold text-orange-600\">{quickStats.ereceiptsCount}</p>\n            </div>\n            <div className=\"p-2 bg-orange-100 rounded-full\">\n              <FileText className=\"w-6 h-6 text-orange-600\" />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Header with Actions */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h3 className=\"text-lg font-medium text-gray-900\">Cihazlar</h3>\n          <p className=\"text-sm text-gray-600\">\n            {devices.length} cihaz bulundu\n          </p>\n        </div>\n        <Button \n          onClick={() => setShowDeviceForm(true)}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Cihaz Ata\n        </Button>\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n          <div className=\"flex\">\n            <XCircle className=\"h-5 w-5 text-red-400\" />\n            <div className=\"ml-3\">\n              <p className=\"text-sm text-red-800\">{error}</p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Devices List */}\n      <div className=\"space-y-4\">\n        {devices.length > 0 ? (\n          devices.map((device) => (\n            <div key={device.id} className=\"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-3 mb-2\">\n                    <Settings className=\"w-5 h-5 text-blue-500\" />\n                    <div>\n                      <p className=\"font-medium text-gray-900\">\n                        {device.brand} {device.model}\n                      </p>\n                      <p className=\"text-sm text-gray-600\">\n                        Seri No: {device.serialNumber}\n                      </p>\n                    </div>\n                    {getDeviceStatusBadge(device.status)}\n                  </div>\n\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600\">\n                    <div>\n                      <strong>Kulak:</strong> {getEarText(device.ear)}\n                    </div>\n                    <div>\n                      <strong>Tip:</strong> {device.deviceType || 'Belirtilmemiş'}\n                    </div>\n                    {device.trialStartDate && (\n                      <div>\n                        <strong>Deneme Başlangıcı:</strong> {new Date(device.trialStartDate).toLocaleDateString('tr-TR')}\n                      </div>\n                    )}\n                    {device.trialEndDate && (\n                      <div>\n                        <strong>Deneme Bitişi:</strong> {new Date(device.trialEndDate).toLocaleDateString('tr-TR')}\n                      </div>\n                    )}\n                  </div>\n\n                  {device.notes && (\n                    <div className=\"mt-2\">\n                      <p className=\"text-sm text-gray-600\">\n                        <strong>Notlar:</strong> {device.notes}\n                      </p>\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"flex items-center space-x-2 ml-4\">\n                  <Button\n                    onClick={() => handleEditDevice(device)}\n                    className=\"p-2 text-gray-600 hover:bg-gray-50\"\n                    title=\"Düzenle\"\n                  >\n                    <Edit className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => device.id && handleRemoveDevice(device.id)}\n                    className=\"p-2 text-red-600 hover:bg-red-50\"\n                    title=\"Kaldır\"\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          ))\n        ) : (\n          <div className=\"text-center py-8 text-gray-500\">\n            <Settings className=\"w-12 h-12 mx-auto mb-4 text-gray-300\" />\n            <p>Henüz atanmış cihaz bulunmamaktadır.</p>\n          </div>\n        )}\n      </div>\n\n      {/* Device Replacement History */}\n      <DeviceReplacementHistory \n        patientId={patient.id || ''} \n        className=\"mt-6\"\n      />\n\n      {/* Device Assignment Form Modal */}\n      {showDeviceForm && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex justify-between items-center mb-6\">\n              <h3 className=\"text-lg font-medium\">Cihaz Atama</h3>\n              <Button\n                onClick={() => setShowDeviceForm(false)}\n                className=\"p-1 text-gray-400 hover:text-gray-600\"\n              >\n                <X className=\"w-5 h-5\" />\n              </Button>\n            </div>\n\n            <form onSubmit={(e) => {\n              e.preventDefault();\n              const formData = new FormData(e.currentTarget);\n              \n              // Process right ear data\n              if (formData.get('rightEarEnabled')) {\n                const rightEarData = {\n                  mode: rightEarMode,\n                  ear: 'right',\n                  reason: rightEarReason,\n                  inventoryId: formData.get('rightInventoryId'),\n                  brand: formData.get('rightBrand'),\n                  model: formData.get('rightModel'),\n                  serialNumber: formData.get('rightSerialNumber'),\n                  deviceType: formData.get('rightDeviceType'),\n                  salePrice: formData.get('rightSalePrice'),\n                  paymentMethod: formData.get('rightPaymentMethod')\n                };\n                handleAssignDevice(rightEarData);\n              }\n\n              // Process left ear data\n              if (formData.get('leftEarEnabled')) {\n                const leftEarData = {\n                  mode: leftEarMode,\n                  ear: 'left',\n                  reason: leftEarReason,\n                  inventoryId: formData.get('leftInventoryId'),\n                  brand: formData.get('leftBrand'),\n                  model: formData.get('leftModel'),\n                  serialNumber: formData.get('leftSerialNumber'),\n                  deviceType: formData.get('leftDeviceType'),\n                  salePrice: formData.get('leftSalePrice'),\n                  paymentMethod: formData.get('leftPaymentMethod')\n                };\n                handleAssignDevice(leftEarData);\n              }\n            }}>\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Right Ear */}\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center space-x-2\">\n                    <input type=\"checkbox\" name=\"rightEarEnabled\" id=\"rightEarEnabled\" defaultChecked />\n                    <label htmlFor=\"rightEarEnabled\" className=\"font-medium text-gray-900\">Sağ Kulak</label>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Mod</label>\n                    <select \n                      value={rightEarMode}\n                      onChange={(e) => setRightEarMode(e.target.value as 'inventory' | 'manual')}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    >\n                      <option value=\"inventory\">Envanterden Seç</option>\n                      <option value=\"manual\">Manuel Giriş</option>\n                    </select>\n                  </div>\n\n                  {rightEarMode === 'inventory' && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Cihaz Seç</label>\n                      <select name=\"rightInventoryId\" className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\">\n                        <option value=\"\">Cihaz seçiniz...</option>\n                        {inventoryItems.map((item) => (\n                          <option key={item.id} value={item.id}>\n                            {item.name} - {item.brand} {item.model} (Stok: {item.availableInventory || 0})\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n\n                  {rightEarMode === 'manual' && (\n                    <div className=\"space-y-3\">\n                      <Input name=\"rightBrand\" placeholder=\"Marka\" required />\n                      <Input name=\"rightModel\" placeholder=\"Model\" required />\n                      <Input name=\"rightSerialNumber\" placeholder=\"Seri No\" required />\n                      <Input name=\"rightDeviceType\" placeholder=\"Tip\" />\n                    </div>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Sebep</label>\n                    <select \n                      value={rightEarReason}\n                      onChange={(e) => setRightEarReason(e.target.value as 'Trial' | 'Sale')}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    >\n                      <option value=\"Trial\">Deneme</option>\n                      <option value=\"Sale\">Satış</option>\n                    </select>\n                  </div>\n\n                  {rightEarReason === 'Sale' && (\n                    <div className=\"space-y-3 p-4 bg-gray-50 rounded-lg\">\n                      <h5 className=\"font-medium text-gray-900\">Fiyatlandırma</h5>\n                      <Input name=\"rightListPrice\" type=\"number\" placeholder=\"Liste Fiyatı\" />\n                      <Input name=\"rightSalePrice\" type=\"number\" placeholder=\"Satış Fiyatı\" required />\n                      <select name=\"rightPaymentMethod\" className=\"w-full px-3 py-2 border border-gray-300 rounded-md\">\n                        <option value=\"\">Ödeme Yöntemi</option>\n                        <option value=\"cash\">Nakit</option>\n                        <option value=\"credit\">Kredi Kartı</option>\n                        <option value=\"installment\">Taksit</option>\n                      </select>\n                    </div>\n                  )}\n                </div>\n\n                {/* Left Ear */}\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center space-x-2\">\n                    <input type=\"checkbox\" name=\"leftEarEnabled\" id=\"leftEarEnabled\" />\n                    <label htmlFor=\"leftEarEnabled\" className=\"font-medium text-gray-900\">Sol Kulak</label>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Mod</label>\n                    <select \n                      value={leftEarMode}\n                      onChange={(e) => setLeftEarMode(e.target.value as 'inventory' | 'manual')}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    >\n                      <option value=\"inventory\">Envanterden Seç</option>\n                      <option value=\"manual\">Manuel Giriş</option>\n                    </select>\n                  </div>\n\n                  {leftEarMode === 'inventory' && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Cihaz Seç</label>\n                      <select name=\"leftInventoryId\" className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\">\n                        <option value=\"\">Cihaz seçiniz...</option>\n                        {inventoryItems.map((item) => (\n                          <option key={item.id} value={item.id}>\n                            {item.name} - {item.brand} {item.model} (Stok: {item.availableInventory || 0})\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n\n                  {leftEarMode === 'manual' && (\n                    <div className=\"space-y-3\">\n                      <Input name=\"leftBrand\" placeholder=\"Marka\" required />\n                      <Input name=\"leftModel\" placeholder=\"Model\" required />\n                      <Input name=\"leftSerialNumber\" placeholder=\"Seri No\" required />\n                      <Input name=\"leftDeviceType\" placeholder=\"Tip\" />\n                    </div>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Sebep</label>\n                    <select \n                      value={leftEarReason}\n                      onChange={(e) => setLeftEarReason(e.target.value as 'Trial' | 'Sale')}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    >\n                      <option value=\"Trial\">Deneme</option>\n                      <option value=\"Sale\">Satış</option>\n                    </select>\n                  </div>\n\n                  {leftEarReason === 'Sale' && (\n                    <div className=\"space-y-3 p-4 bg-gray-50 rounded-lg\">\n                      <h5 className=\"font-medium text-gray-900\">Fiyatlandırma</h5>\n                      <Input name=\"leftListPrice\" type=\"number\" placeholder=\"Liste Fiyatı\" />\n                      <Input name=\"leftSalePrice\" type=\"number\" placeholder=\"Satış Fiyatı\" required />\n                      <select name=\"leftPaymentMethod\" className=\"w-full px-3 py-2 border border-gray-300 rounded-md\">\n                        <option value=\"\">Ödeme Yöntemi</option>\n                        <option value=\"cash\">Nakit</option>\n                        <option value=\"credit\">Kredi Kartı</option>\n                        <option value=\"installment\">Taksit</option>\n                      </select>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <Button\n                  type=\"button\"\n                  onClick={() => setShowDeviceForm(false)}\n                  className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n                >\n                  İptal\n                </Button>\n                <Button\n                  type=\"submit\"\n                  className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md\"\n                  disabled={loading}\n                >\n                  {loading ? 'Atanıyor...' : 'Cihaz Ata'}\n                </Button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {/* Device Edit Modal */}\n      <DeviceEditModal\n        isOpen={showEditModal}\n        onClose={() => {\n          setShowEditModal(false);\n          setEditingDevice(null);\n        }}\n        device={editingDevice}\n        inventoryItems={inventoryItems}\n        onUpdate={handleUpdateDevice}\n        onReplace={handleReplaceDevice}\n        loading={loading}\n      />\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientDocumentsTab.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadDocuments'. Either include it or remove the dependency array.","line":47,"column":6,"nodeType":"ArrayExpression","endLine":47,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [loadDocuments, patientId]","fix":{"range":[1814,1825],"text":"[loadDocuments, patientId]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5354,5357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5354,5357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":338,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":346,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":412,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":421,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":486,"column":9,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":496,"endColumn":18}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Input, Badge } from '@x-ear/ui-web';\nimport { Card, CardContent } from '@x-ear/ui-web';\nimport { useToastHelpers } from '@x-ear/ui-web';\nimport { Upload, Eye, Download, Trash2, FileText, X, AlertCircle, CheckCircle, Clock, Search } from 'lucide-react';\n\n// API imports\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/xEarCRMAPIAutoGenerated';\n\ninterface Document {\n  id: string;\n  name: string;\n  type: 'sgk' | 'medical' | 'invoice' | 'other';\n  uploadDate: string;\n  size: string;\n  status: 'processing' | 'completed' | 'error';\n  url?: string;\n}\n\ninterface PatientDocumentsTabProps {\n  patientId: string;\n}\n\nexport const PatientDocumentsTab: React.FC<PatientDocumentsTabProps> = ({ patientId }) => {\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedDocumentType, setSelectedDocumentType] = useState<string>('all');\n  const [documents, setDocuments] = useState<Document[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isUploading, setIsUploading] = useState(false);\n  const [selectedFiles, setSelectedFiles] = useState<File[]>([]);\n  const [uploadProgress, setUploadProgress] = useState<{[key: string]: number}>({});\n  const [dragActive, setDragActive] = useState(false);\n  const [bulkUploadMode, setBulkUploadMode] = useState(false);\n  const [documentNotes, setDocumentNotes] = useState('');\n  \n  // Toast helpers\n  const { success, error, info } = useToastHelpers();\n\n\n  // API functions\n  const api = getXEarCRMAPIAutoGenerated();\n  const { sgkGetPatientSgkDocuments, sgkUploadSgkDocument, sgkDeleteSgkDocument, sgkProcessOcr, automationTriggerSgkProcessing } = api;\n\n  useEffect(() => {\n    loadDocuments();\n  }, [patientId]);\n\n  const loadDocuments = async () => {\n    try {\n      setIsLoading(true);\n      // Load SGK documents for the patient\n      await sgkGetPatientSgkDocuments(patientId);\n      \n      // Mock data for now - replace with actual API response\n      const mockDocuments: Document[] = [\n        {\n          id: '1',\n          name: 'SGK Raporu - Ocak 2024.pdf',\n          type: 'sgk',\n          uploadDate: '2024-01-15',\n          size: '2.3 MB',\n          status: 'completed'\n        },\n        {\n          id: '2',\n          name: 'Odyoloji Testi Sonuçları.pdf',\n          type: 'medical',\n          uploadDate: '2024-01-10',\n          size: '1.8 MB',\n          status: 'completed'\n        },\n        {\n          id: '3',\n          name: 'Fatura - INV-2024-001.pdf',\n          type: 'invoice',\n          uploadDate: '2024-01-08',\n          size: '0.5 MB',\n          status: 'processing'\n        }\n      ];\n      \n      setDocuments(mockDocuments);\n    } catch (loadError) {\n      console.error('Error loading documents:', loadError);\n      error('Dokümanlar yüklenirken bir hata oluştu.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const filteredDocuments = documents.filter(doc => {\n    const matchesSearch = doc.name.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesType = selectedDocumentType === 'all' || doc.type === selectedDocumentType;\n    return matchesSearch && matchesType;\n  });\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = event.target.files;\n    if (!files || files.length === 0) return;\n    \n    await processFileUploads(Array.from(files));\n  };\n\n  const handleDragEnter = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(true);\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    \n    const files = Array.from(e.dataTransfer.files);\n    if (bulkUploadMode) {\n      setSelectedFiles(prev => [...prev, ...files]);\n    } else {\n      processFileUploads(files);\n    }\n  };\n\n  const processFileUploads = async (files: File[]) => {\n    try {\n      setIsUploading(true);\n      \n      for (const file of files) {\n        const fileId = `${file.name}_${Date.now()}`;\n        setUploadProgress(prev => ({ ...prev, [fileId]: 0 }));\n        \n        // Create FormData for file upload\n        const formData = new FormData();\n        formData.append('file', file);\n        formData.append('patient_id', patientId);\n        formData.append('document_type', selectedDocumentType === 'all' ? 'other' : selectedDocumentType);\n        formData.append('notes', documentNotes);\n        \n        // Simulate upload progress\n        const progressInterval = setInterval(() => {\n          setUploadProgress(prev => {\n            const currentProgress = prev[fileId] || 0;\n            if (currentProgress >= 90) {\n              clearInterval(progressInterval);\n              return prev;\n            }\n            return { ...prev, [fileId]: currentProgress + 10 };\n          });\n        }, 200);\n        \n        // Upload document based on type\n        if (selectedDocumentType === 'sgk' || file.name.toLowerCase().includes('sgk')) {\n          await sgkUploadSgkDocument(formData as any);\n          \n          // Trigger OCR processing for SGK documents\n          await sgkProcessOcr({\n            document_id: `temp_${Date.now()}`,\n            patient_id: patientId\n          });\n          \n          // Trigger automated SGK processing\n          await automationTriggerSgkProcessing({\n            patient_id: patientId,\n            document_id: `temp_${Date.now()}`\n          });\n        }\n        \n        // Complete progress\n        clearInterval(progressInterval);\n        setUploadProgress(prev => ({ ...prev, [fileId]: 100 }));\n        \n        // Remove progress after delay\n        setTimeout(() => {\n          setUploadProgress(prev => {\n            const newProgress = { ...prev };\n            delete newProgress[fileId];\n            return newProgress;\n          });\n        }, 2000);\n      }\n      \n      success(`${files.length} doküman başarıyla yüklendi.`);\n      \n      // Reload documents and reset form\n      await loadDocuments();\n      setIsUploadModalOpen(false);\n      setSelectedFiles([]);\n      setDocumentNotes('');\n    } catch (err) {\n      console.error('Error uploading files:', err);\n      error('Doküman yüklenirken bir hata oluştu.');\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const removeSelectedFile = (index: number) => {\n    setSelectedFiles(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const processBulkUpload = async () => {\n    if (selectedFiles.length === 0) return;\n    await processFileUploads(selectedFiles);\n  };\n\n  const handleViewDocument = (documentId: string) => {\n    const document = documents.find(doc => doc.id === documentId);\n    if (document?.url) {\n      window.open(document.url, '_blank');\n    } else {\n      info('Doküman görüntüleme özelliği yakında eklenecek.');\n    }\n  };\n\n  const handleDownloadDocument = (documentId: string) => {\n    const document = documents.find(doc => doc.id === documentId);\n    if (document) {\n      // Create a temporary download link\n      const link = window.document.createElement('a');\n      link.href = document.url || '#';\n      link.download = document.name;\n      window.document.body.appendChild(link);\n      link.click();\n      window.document.body.removeChild(link);\n    }\n  };\n\n  const handleDeleteDocument = async (documentId: string) => {\n    try {\n      await sgkDeleteSgkDocument(documentId);\n      \n      success('Doküman başarıyla silindi.');\n      \n      // Reload documents\n      await loadDocuments();\n    } catch (err) {\n      console.error('Error deleting document:', err);\n      error('Doküman silinirken bir hata oluştu.');\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n      case 'processing':\n        return <Clock className=\"w-4 h-4 text-yellow-500\" />;\n      case 'error':\n        return <AlertCircle className=\"w-4 h-4 text-red-500\" />;\n      default:\n        return <Clock className=\"w-4 h-4 text-gray-500\" />;\n    }\n  };\n\n  const getStatusBadge = (status: string) => {\n    const variants = {\n      completed: 'bg-green-100 text-green-800',\n      processing: 'bg-yellow-100 text-yellow-800',\n      error: 'bg-red-100 text-red-800'\n    };\n    \n    const labels = {\n      completed: 'Tamamlandı',\n      processing: 'İşleniyor',\n      error: 'Hata'\n    };\n\n    return (\n      <Badge className={variants[status as keyof typeof variants] || 'bg-gray-100 text-gray-800'}>\n        {labels[status as keyof typeof labels] || status}\n      </Badge>\n    );\n  };\n\n  const formatFileSize = (sizeStr: string) => {\n    return sizeStr; // Already formatted in mock data\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Upload Modal */}\n      {isUploadModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-medium\">\n                {bulkUploadMode ? 'Toplu Belge Yükleme' : 'Belge Yükle'}\n              </h3>\n              <div className=\"flex items-center space-x-2\">\n                <Button\n                  onClick={() => setBulkUploadMode(!bulkUploadMode)}\n                  variant=\"outline\"\n                  size=\"sm\"\n                >\n                  {bulkUploadMode ? 'Tekli Mod' : 'Toplu Mod'}\n                </Button>\n                <Button\n                  onClick={() => setIsUploadModalOpen(false)}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            </div>\n\n            <div className=\"space-y-4\">\n              {/* Drag and Drop Area */}\n              <div\n                className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${\n                  dragActive \n                    ? 'border-blue-500 bg-blue-50' \n                    : 'border-gray-300 hover:border-gray-400'\n                }`}\n                onDragEnter={handleDragEnter}\n                onDragLeave={handleDragLeave}\n                onDragOver={handleDragOver}\n                onDrop={handleDrop}\n              >\n                <Upload className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-lg font-medium text-gray-900 mb-2\">\n                  Dosyaları buraya sürükleyin veya seçin\n                </p>\n                <p className=\"text-sm text-gray-500 mb-4\">\n                  PDF, JPG, PNG, DOC, DOCX formatları desteklenir\n                </p>\n                <input\n                  type=\"file\"\n                  accept=\".pdf,.jpg,.jpeg,.png,.doc,.docx\"\n                  onChange={handleFileUpload}\n                  multiple={bulkUploadMode}\n                  className=\"hidden\"\n                  id=\"file-upload\"\n                  disabled={isUploading}\n                />\n                <Button\n                  onClick={() => document.getElementById('file-upload')?.click()}\n                  disabled={isUploading}\n                  className=\"bg-blue-600 hover:bg-blue-700\"\n                >\n                  Dosya Seç\n                </Button>\n              </div>\n\n              {/* Selected Files (Bulk Mode) */}\n              {bulkUploadMode && selectedFiles.length > 0 && (\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium text-gray-900\">\n                    Seçilen Dosyalar ({selectedFiles.length})\n                  </h4>\n                  <div className=\"max-h-40 overflow-y-auto space-y-2\">\n                    {selectedFiles.map((file, index) => (\n                      <div key={index} className=\"flex items-center justify-between p-2 bg-gray-50 rounded\">\n                        <div className=\"flex items-center space-x-2\">\n                          <FileText className=\"w-4 h-4 text-gray-500\" />\n                          <span className=\"text-sm\">{file.name}</span>\n                          <span className=\"text-xs text-gray-500\">\n                            ({(file.size / 1024 / 1024).toFixed(2)} MB)\n                          </span>\n                        </div>\n                        <Button\n                          onClick={() => removeSelectedFile(index)}\n                          variant=\"ghost\"\n                          size=\"sm\"\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Upload Progress */}\n              {Object.keys(uploadProgress).length > 0 && (\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium text-gray-900\">Yükleme Durumu</h4>\n                  {Object.entries(uploadProgress).map(([fileId, progress]) => (\n                    <div key={fileId} className=\"space-y-1\">\n                      <div className=\"flex justify-between text-sm\">\n                        <span>{fileId.split('_')[0]}</span>\n                        <span>{progress}%</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div\n                          className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                          style={{ width: `${progress}%` }}\n                        />\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {/* Document Type and Notes */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Belge Türü\n                  </label>\n                  <select \n                    value={selectedDocumentType}\n                    onChange={(e) => setSelectedDocumentType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  >\n                    <option value=\"other\">Diğer</option>\n                    <option value=\"sgk\">SGK Belgesi</option>\n                    <option value=\"medical\">Tıbbi Rapor</option>\n                    <option value=\"invoice\">Fatura</option>\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Notlar (Opsiyonel)\n                  </label>\n                  <Input\n                    value={documentNotes}\n                    onChange={(e) => setDocumentNotes(e.target.value)}\n                    placeholder=\"Belge hakkında notlar...\"\n                  />\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex justify-end space-x-3\">\n                <Button\n                  onClick={() => {\n                    setIsUploadModalOpen(false);\n                    setSelectedFiles([]);\n                    setDocumentNotes('');\n                  }}\n                  variant=\"outline\"\n                  disabled={isUploading}\n                >\n                  İptal\n                </Button>\n                {bulkUploadMode && selectedFiles.length > 0 && (\n                  <Button \n                    onClick={processBulkUpload}\n                    disabled={isUploading}\n                    className=\"bg-green-600 hover:bg-green-700\"\n                  >\n                    {isUploading ? 'Yükleniyor...' : `${selectedFiles.length} Dosyayı Yükle`}\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Header with Upload Button */}\n      <div className=\"flex justify-between items-center\">\n        <h3 className=\"text-lg font-medium text-gray-900\">Belge Yönetimi</h3>\n        <Button\n          onClick={() => setIsUploadModalOpen(true)}\n          className=\"bg-blue-600 hover:bg-blue-700\"\n        >\n          <Upload className=\"w-4 h-4 mr-2\" />\n          Belge Yükle\n        </Button>\n      </div>\n\n      {/* Search and Filter */}\n      <div className=\"flex space-x-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\n          <Input\n            placeholder=\"Belge ara...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n        <select\n          value={selectedDocumentType}\n          onChange={(e) => setSelectedDocumentType(e.target.value)}\n          className=\"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        >\n          <option value=\"all\">Tümü</option>\n          <option value=\"sgk\">SGK</option>\n          <option value=\"medical\">Tıbbi</option>\n          <option value=\"invoice\">Fatura</option>\n          <option value=\"other\">Diğer</option>\n        </select>\n      </div>\n\n      {/* Documents Grid */}\n      {isLoading ? (\n        <div className=\"text-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-2 text-gray-500\">Dokümanlar yükleniyor...</p>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          {filteredDocuments.map((doc) => (\n            <Card key={doc.id} className=\"hover:shadow-md transition-shadow\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start space-x-3 mb-3\">\n                  <FileText className=\"w-8 h-8 text-blue-600 flex-shrink-0\" />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-medium text-gray-900 truncate\">{doc.name}</p>\n                    <p className=\"text-sm text-gray-500 capitalize\">{doc.type}</p>\n                    <p className=\"text-xs text-gray-400\">\n                      {formatFileSize(doc.size)} • {new Date(doc.uploadDate).toLocaleDateString('tr-TR')}\n                    </p>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    {getStatusIcon(doc.status)}\n                    {getStatusBadge(doc.status)}\n                  </div>\n                </div>\n                <div className=\"flex justify-end space-x-2\">\n                  <Button\n                    onClick={() => handleViewDocument(doc.id)}\n                    variant=\"outline\"\n                    size=\"sm\"\n                  >\n                    <Eye className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleDownloadDocument(doc.id)}\n                    variant=\"outline\"\n                    size=\"sm\"\n                  >\n                    <Download className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    onClick={() => handleDeleteDocument(doc.id)}\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"text-red-600 hover:text-red-800\"\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n          {filteredDocuments.length === 0 && (\n            <div className=\"col-span-full text-center py-8 text-gray-500\">\n              <FileText className=\"w-12 h-12 mx-auto mb-4 text-gray-300\" />\n              <p>\n                {searchTerm || selectedDocumentType !== 'all' \n                  ? 'Arama kriterlerine uygun belge bulunamadı.' \n                  : 'Henüz yüklenmiş belge bulunmamaktadır.'\n                }\n              </p>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientFilters.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1021,1024],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1021,1024],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'acquisitionOptions' is assigned a value but never used.","line":64,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":43},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":178,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":195,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":181,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5904,5907],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5904,5907],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":183,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6045,6048],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6045,6048],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":186,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6217,6220],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6217,6220],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":208,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":225,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":211,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7215,7218],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7215,7218],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":213,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7357,7360],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7357,7360],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":216,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7530,7533],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7530,7533],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":241,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":248,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":252,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":259,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":272,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":287,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":308,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":313,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":321,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":335,"endColumn":15}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback } from 'react';\nimport { Button } from '@x-ear/ui-web';\nimport { PatientFilters as PatientFiltersType } from '../../types/patient/patient-search.types';\nimport { Filter, X, ChevronUp, Users, Building, Tag, Calendar } from 'lucide-react';\n\ninterface PatientFiltersProps {\n  filters: PatientFiltersType;\n  onChange: (filters: PatientFiltersType) => void;\n  onClearFilters: () => void;\n  patientCount?: number;\n  loading?: boolean;\n  className?: string;\n  showCompact?: boolean;\n}\n\ninterface FilterOption {\n  value: string;\n  label: string;\n  count?: number;\n}\n\n/**\n * PatientFilters Component\n * Advanced filtering component for patient search and management\n */\nexport function PatientFilters({\n  filters,\n  onChange,\n  onClearFilters,\n  patientCount = 0,\n  loading = false,\n  className = '',\n  showCompact = false\n}: PatientFiltersProps) {\n  const [isExpanded, setIsExpanded] = useState(!showCompact);\n\n  const handleFilterChange = useCallback((key: keyof PatientFiltersType, value: any) => {\n    onChange({\n      ...filters,\n      [key]: value\n    });\n  }, [filters, onChange]);\n\n  // Check if any filters are active\n  const hasActiveFilters = Object.entries(filters).some(([key, value]) => {\n    if (key === 'query') return false; // Exclude query from active filters count\n    if (Array.isArray(value)) return value.length > 0;\n    return value !== undefined && value !== null && value !== '';\n  });\n\n  const statusOptions: FilterOption[] = [\n    { value: 'active', label: 'Aktif' },\n    { value: 'inactive', label: 'Pasif' },\n    { value: 'pending', label: 'Beklemede' }\n  ];\n\n  const segmentOptions: FilterOption[] = [\n    { value: 'trial', label: 'Deneme' },\n    { value: 'purchased', label: 'Satın Alınmış' },\n    { value: 'lead', label: 'Potansiyel' },\n    { value: 'follow_up', label: 'Takip' }\n  ];\n\n  const acquisitionOptions: FilterOption[] = [\n    { value: 'referral', label: 'Referans' },\n    { value: 'online', label: 'Online' },\n    { value: 'walk-in', label: 'Yürüyerek Gelen' },\n    { value: 'social-media', label: 'Sosyal Medya' },\n    { value: 'advertisement', label: 'Reklam' }\n  ];\n\n  const branchOptions: FilterOption[] = [\n    { value: 'branch-1', label: 'Merkez Şube' },\n    { value: 'branch-2', label: 'Kadıköy Şube' },\n    { value: 'branch-3', label: 'Beşiktaş Şube' }\n  ];\n\n  const handleTagAdd = useCallback((tag: string) => {\n    const currentTags = filters.tags || [];\n    if (!currentTags.includes(tag)) {\n      handleFilterChange('tags', [...currentTags, tag]);\n    }\n  }, [filters.tags, handleFilterChange]);\n\n  const handleTagRemove = useCallback((tag: string) => {\n    const currentTags = filters.tags || [];\n    handleFilterChange('tags', currentTags.filter(t => t !== tag));\n  }, [filters.tags, handleFilterChange]);\n\n  if (showCompact && !isExpanded) {\n    return (\n      <div className={`flex items-center space-x-2 ${className}`}>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={() => setIsExpanded(true)}\n          className=\"flex items-center space-x-2\"\n        >\n          <Filter className=\"h-4 w-4\" />\n          <span>Filtreler</span>\n          {hasActiveFilters && (\n            <span className=\"bg-blue-600 text-white text-xs rounded-full px-2 py-0.5\">\n              {Object.entries(filters).filter(([key, value]) => \n                key !== 'query' && value && (Array.isArray(value) ? value.length > 0 : true)\n              ).length}\n            </span>\n          )}\n        </Button>\n        \n        {hasActiveFilters && (\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={onClearFilters}\n            className=\"text-gray-500 hover:text-gray-700\"\n          >\n            <X className=\"h-4 w-4\" />\n            <span className=\"sr-only\">Filtreleri temizle</span>\n          </Button>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className={`bg-white border border-gray-200 rounded-lg ${className}`}>\n      {/* Header */}\n      <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\n        <div className=\"flex items-center space-x-2\">\n          <Filter className=\"w-5 h-5 text-gray-500\" />\n          <h3 className=\"text-lg font-medium text-gray-900\">Filtreler</h3>\n          {hasActiveFilters && (\n            <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n              Aktif\n            </span>\n          )}\n          <span className=\"text-sm text-gray-500\">\n            ({patientCount} hasta)\n          </span>\n        </div>\n        \n        <div className=\"flex items-center space-x-2\">\n          {hasActiveFilters && (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={onClearFilters}\n              disabled={loading}\n              className=\"flex items-center space-x-1\"\n            >\n              <X className=\"w-4 h-4\" />\n              <span>Temizle</span>\n            </Button>\n          )}\n          \n          {showCompact && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => setIsExpanded(false)}\n            >\n              <ChevronUp className=\"w-4 h-4\" />\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Filter Content */}\n      <div className=\"p-4 space-y-6\">\n        {/* Status Filter */}\n        <div>\n          <div className=\"flex items-center space-x-2 mb-3\">\n            <Users className=\"h-4 w-4 text-gray-500\" />\n            <label className=\"text-sm font-medium text-gray-700\">Durum</label>\n          </div>\n          <div className=\"flex flex-wrap gap-2\">\n            {statusOptions.map((option) => (\n              <button\n                key={option.value}\n                onClick={() => handleFilterChange('status', \n                  filters.status?.includes(option.value as any) \n                    ? filters.status.filter(s => s !== option.value)\n                    : [...(filters.status || []), option.value as any]\n                )}\n                className={`px-3 py-1.5 text-sm rounded-full border transition-colors ${\n                  filters.status?.includes(option.value as any)\n                    ? 'bg-blue-100 border-blue-300 text-blue-800'\n                    : 'bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100'\n                }`}\n              >\n                {option.label}\n                {option.count !== undefined && option.count > 0 && (\n                  <span className=\"ml-1 text-xs opacity-75\">({option.count})</span>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Segment Filter */}\n        <div>\n          <div className=\"flex items-center space-x-2 mb-3\">\n            <Tag className=\"h-4 w-4 text-gray-500\" />\n            <label className=\"text-sm font-medium text-gray-700\">Segment</label>\n          </div>\n          <div className=\"flex flex-wrap gap-2\">\n            {segmentOptions.map((option) => (\n              <button\n                key={option.value}\n                onClick={() => handleFilterChange('segment', \n                  filters.segment?.includes(option.value as any)\n                    ? filters.segment.filter(s => s !== option.value)\n                    : [...(filters.segment || []), option.value as any]\n                )}\n                className={`px-3 py-1.5 text-sm rounded-full border transition-colors ${\n                  filters.segment?.includes(option.value as any)\n                    ? 'bg-green-100 border-green-300 text-green-800'\n                    : 'bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100'\n                }`}\n              >\n                {option.label}\n                {option.count !== undefined && option.count > 0 && (\n                  <span className=\"ml-1 text-xs opacity-75\">({option.count})</span>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n\n\n\n        {/* Date Range Filter */}\n        <div>\n          <div className=\"flex items-center space-x-2 mb-3\">\n            <Calendar className=\"h-4 w-4 text-gray-500\" />\n            <label className=\"text-sm font-medium text-gray-700\">Tarih Aralığı</label>\n          </div>\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n            <div>\n              <label className=\"block text-xs text-gray-600 mb-1\">Başlangıç</label>\n              <input\n                type=\"date\"\n                value={filters.registrationDateRange?.start || ''}\n                onChange={(e) => handleFilterChange('registrationDateRange', \n                  e.target.value ? { ...filters.registrationDateRange, start: e.target.value } : undefined\n                )}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-xs text-gray-600 mb-1\">Bitiş</label>\n              <input\n                type=\"date\"\n                value={filters.registrationDateRange?.end || ''}\n                onChange={(e) => handleFilterChange('registrationDateRange', \n                  e.target.value ? { ...filters.registrationDateRange, end: e.target.value } : undefined\n                )}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Branch Filter */}\n        <div>\n          <div className=\"flex items-center space-x-2 mb-3\">\n            <Building className=\"h-4 w-4 text-gray-500\" />\n            <label className=\"text-sm font-medium text-gray-700\">Şube</label>\n          </div>\n          <div className=\"flex flex-wrap gap-2\">\n            {branchOptions.map((option) => (\n              <button\n                key={option.value}\n                onClick={() => handleFilterChange('branchId', \n                  filters.branchId === option.value ? undefined : option.value\n                )}\n                className={`px-3 py-1.5 text-sm rounded-full border transition-colors ${\n                  filters.branchId === option.value\n                    ? 'bg-orange-100 border-orange-300 text-orange-800'\n                    : 'bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100'\n                }`}\n              >\n                {option.label}\n                {option.count !== undefined && option.count > 0 && (\n                  <span className=\"ml-1 text-xs opacity-75\">({option.count})</span>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Tags Filter */}\n        <div>\n          <div className=\"flex items-center space-x-2 mb-3\">\n            <Tag className=\"h-4 w-4 text-gray-500\" />\n            <label className=\"text-sm font-medium text-gray-700\">Etiketler</label>\n          </div>\n          \n          {/* Selected Tags */}\n          {filters.tags && filters.tags.length > 0 && (\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {filters.tags.map((tag) => (\n                <span\n                  key={tag}\n                  className=\"inline-flex items-center px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full\"\n                >\n                  {tag}\n                  <button\n                    onClick={() => handleTagRemove(tag)}\n                    className=\"ml-1 hover:text-blue-600\"\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </button>\n                </span>\n              ))}\n            </div>\n          )}\n          \n          {/* Tag Input */}\n          <div className=\"flex space-x-2\">\n            <input\n              type=\"text\"\n              placeholder=\"Etiket ekle...\"\n              className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              onKeyPress={(e) => {\n                if (e.key === 'Enter') {\n                  const target = e.target as HTMLInputElement;\n                  const tag = target.value.trim();\n                  if (tag) {\n                    handleTagAdd(tag);\n                    target.value = '';\n                  }\n                }\n              }}\n            />\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={(e) => {\n                const input = (e.target as HTMLElement).parentElement?.querySelector('input');\n                const tag = input?.value.trim();\n                if (tag && input) {\n                  handleTagAdd(tag);\n                  input.value = '';\n                }\n              }}\n            >\n              Ekle\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Patient' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientSgkInfo' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isModal' is assigned a value but never used.","line":14,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":65},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":334,"column":9,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":340,"endColumn":11}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select, Textarea } from '@x-ear/ui-web';\nimport React, { useState, useEffect } from 'react';\nimport { Patient, PatientStatus, PatientSegment, PatientLabel, PatientAcquisitionType, PatientGender, PatientConversionStep } from '../../types/patient/patient-base.types';\nimport { Patient as ExtendedPatient } from '../../types/patient';\nimport { PatientSgkInfo } from '../../generated/orval-types';\n\ninterface PatientFormProps {\n  patient?: ExtendedPatient | null;\n  onSave?: (patient: ExtendedPatient) => void;\n  onCancel?: () => void;\n  isModal?: boolean;\n}\n\nexport function PatientForm({ patient, onSave, onCancel, isModal = false }: PatientFormProps) {\n  const [formData, setFormData] = useState({\n    firstName: '',\n    lastName: '',\n    phone: '',\n    tcNumber: '',\n    birthDate: '',\n    email: '',\n    address: '',\n    gender: '' as PatientGender | '',\n    branch: '',\n    status: 'ACTIVE' as PatientStatus,\n    segment: 'NEW' as PatientSegment,\n    label: 'yeni' as PatientLabel,\n    acquisitionType: 'tabela' as PatientAcquisitionType,\n    conversionStep: 'lead' as PatientConversionStep,\n    tags: [] as string[],\n    deviceTrial: false,\n    notes: '',\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  useEffect(() => {\n    if (patient) {\n      setFormData({\n        firstName: patient.firstName || '',\n        lastName: patient.lastName || '',\n        phone: patient.phone || '',\n        tcNumber: patient.tcNumber || '',\n        birthDate: patient.birthDate || '',\n        email: patient.email || '',\n        address: typeof patient.address === 'string' ? patient.address : patient.addressFull || '',\n        gender: patient.gender || '',\n        branch: patient.branch || '',\n        status: (patient.status as PatientStatus) || 'ACTIVE',\n        segment: (patient.segment as PatientSegment) || 'NEW',\n        label: (patient.label as PatientLabel) || 'yeni',\n        acquisitionType: (patient.acquisitionType as PatientAcquisitionType) || 'tabela',\n        conversionStep: (patient.conversionStep as PatientConversionStep) || 'lead',\n        tags: patient.tags || [],\n        deviceTrial: false,\n        notes: '',\n      });\n    }\n  }, [patient]);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.firstName.trim()) {\n      newErrors.firstName = 'Ad gerekli';\n    }\n\n    if (!formData.lastName.trim()) {\n      newErrors.lastName = 'Soyad gerekli';\n    }\n\n    if (!formData.phone.trim()) {\n      newErrors.phone = 'Telefon gerekli';\n    } else if (!/^[0-9+\\-\\s()]+$/.test(formData.phone)) {\n      newErrors.phone = 'Geçerli telefon numarası girin';\n    }\n\n    // TC Number validation with checksum (Turkish ID validation)\n    if (formData.tcNumber) {\n      if (!/^\\d{11}$/.test(formData.tcNumber)) {\n        newErrors.tcNumber = 'TC Kimlik No 11 haneli olmalı';\n      } else if (formData.tcNumber[0] === '0') {\n        newErrors.tcNumber = 'TC Kimlik No 0 ile başlayamaz';\n      } else {\n        // Turkish ID checksum validation\n        const digits = formData.tcNumber.split('').map(Number);\n        const sum = digits.slice(0, 10).reduce((a, b) => a + b, 0);\n        if ((sum % 10) !== digits[10]) {\n          newErrors.tcNumber = 'Geçersiz TC Kimlik No';\n        }\n      }\n    }\n\n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Geçerli email adresi girin';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsSubmitting(true);\n\n    try {\n      // Narrow form selections into typed fields to avoid unsafe 'as' casts\n  const allowedStatus: ExtendedPatient['status'][] = ['ACTIVE','INACTIVE'];\n  const allowedSegment: ExtendedPatient['segment'][] = ['NEW','TRIAL','PURCHASED','CONTROL','RENEWAL'];\n  const allowedLabel: ExtendedPatient['label'][] = ['yeni','arama-bekliyor','randevu-verildi','deneme-yapildi','kontrol-hastasi','satis-tamamlandi'];\n  const allowedAcq: ExtendedPatient['acquisitionType'][] = ['tabela','sosyal-medya','tanitim','referans','diger'];\n    // small type-guard helper to avoid inline casts\n    const isIn = <T,>(arr: T[], v: unknown): v is T => arr.includes(v as T);\n\n    const statusValue = isIn(allowedStatus, formData.status) ? formData.status : 'ACTIVE';\n    const segmentValue = isIn(allowedSegment, formData.segment) ? formData.segment : 'NEW';\n    const labelValue = isIn(allowedLabel, formData.label) ? formData.label : 'yeni';\n    const acquisitionValue = isIn(allowedAcq, formData.acquisitionType) ? formData.acquisitionType : 'diger';\n\n      const patientData: ExtendedPatient = {\n        id: patient?.id || `patient_${Date.now()}`,\n        ...formData,\n        gender: formData.gender || undefined,\n        status: statusValue,\n        segment: segmentValue,\n        label: labelValue,\n        acquisitionType: acquisitionValue,\n        tags: patient?.tags || [],\n        notes: formData.notes ? [{ \n          id: Date.now().toString(),\n          text: formData.notes, \n          date: new Date().toISOString(),\n          author: 'User',\n          type: 'general' as const,\n          isPrivate: false\n        }] : [],\n        devices: patient?.devices || [],\n        sales: patient?.sales || [],\n        communications: patient?.communications || [],\n        sgkInfo: patient?.sgkInfo || { \n          id: '',\n          patientId: patient?.id || '',\n          sgkNumber: '',\n          insuranceType: 'sgk',\n          isActive: false,\n          validUntil: undefined,\n          coverageDetails: '',\n          lastUpdated: new Date()\n        },\n        createdAt: patient?.createdAt || new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n      };\n\n      if (onSave) {\n        onSave(patientData);\n      }\n    } catch (error) {\n      console.error('Form submission error:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleInputChange = (field: string, value: string | boolean) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Ad *</label>\n          <Input\n            value={formData.firstName}\n            onChange={(e) => handleInputChange('firstName', e.target.value)}\n            placeholder=\"Hasta adı\"\n            error={errors.firstName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Soyad *</label>\n          <Input\n            value={formData.lastName}\n            onChange={(e) => handleInputChange('lastName', e.target.value)}\n            placeholder=\"Hasta soyadı\"\n            error={errors.lastName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Telefon *</label>\n          <Input\n            value={formData.phone}\n            onChange={(e) => handleInputChange('phone', e.target.value)}\n            placeholder=\"0555 123 45 67\"\n            error={errors.phone}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">TC Kimlik No</label>\n          <Input\n            value={formData.tcNumber}\n            onChange={(e) => handleInputChange('tcNumber', e.target.value)}\n            placeholder=\"12345678901\"\n            maxLength={11}\n            error={errors.tcNumber}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Doğum Tarihi</label>\n          <Input\n            type=\"date\"\n            value={formData.birthDate}\n            onChange={(e) => handleInputChange('birthDate', e.target.value)}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Email</label>\n          <Input\n            type=\"email\"\n            value={formData.email}\n            onChange={(e) => handleInputChange('email', e.target.value)}\n            placeholder=\"hasta@email.com\"\n            error={errors.email}\n          />\n        </div>\n\n        <div>\n          <Select\n            label=\"Cinsiyet\"\n            value={formData.gender}\n            onChange={(e) => setFormData({ ...formData, gender: e.target.value as PatientGender })}\n            options={[\n              { value: \"\", label: \"Seçiniz\" },\n              { value: \"M\", label: \"Erkek\" },\n              { value: \"F\", label: \"Kadın\" }\n            ]}\n            fullWidth\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium mb-1\">Şube</label>\n          <Input\n            value={formData.branch}\n            onChange={(e) => handleInputChange('branch', e.target.value)}\n            placeholder=\"Şube adı\"\n          />\n        </div>\n\n        <div>\n          <Select\n            label=\"Durum\"\n            value={formData.status}\n            onChange={(e) => setFormData({ ...formData, status: e.target.value as PatientStatus })}\n            options={[\n              { value: \"ACTIVE\", label: \"Aktif\" },\n              { value: \"INACTIVE\", label: \"Pasif\" }\n            ]}\n            fullWidth\n          />\n        </div>\n\n        <div>\n          <Select\n            label=\"Segment\"\n            value={formData.segment}\n            onChange={(e) => setFormData({ ...formData, segment: e.target.value as PatientSegment })}\n            options={[\n              { value: \"NEW\", label: \"Yeni\" },\n              { value: \"TRIAL\", label: \"Deneme\" },\n              { value: \"PURCHASED\", label: \"Satın Alınmış\" },\n              { value: \"CONTROL\", label: \"Kontrol\" },\n              { value: \"RENEWAL\", label: \"Yenileme\" }\n            ]}\n            fullWidth\n          />\n        </div>\n\n        <div>\n          <Select\n            label=\"Dönüşüm Aşaması\"\n            value={formData.conversionStep}\n            onChange={(e) => setFormData({ ...formData, conversionStep: e.target.value as PatientConversionStep })}\n            options={[\n              { value: \"lead\", label: \"Potansiyel\" },\n              { value: \"contacted\", label: \"İletişim Kuruldu\" },\n              { value: \"appointment-scheduled\", label: \"Randevu Planlandı\" },\n              { value: \"visited\", label: \"Ziyaret Edildi\" },\n              { value: \"trial-started\", label: \"Deneme Başladı\" },\n              { value: \"trial-completed\", label: \"Deneme Tamamlandı\" },\n              { value: \"purchased\", label: \"Satın Alındı\" },\n              { value: \"delivered\", label: \"Teslim Edildi\" }\n            ]}\n            fullWidth\n          />\n        </div>\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium mb-1\">Adres</label>\n        <Textarea\n          value={formData.address}\n          onChange={(e) => handleInputChange('address', e.target.value)}\n          placeholder=\"Hasta adresi\"\n          rows={3}\n        />\n      </div>\n\n      <div>\n        <label className=\"block text-sm font-medium mb-1\">Notlar</label>\n        <Textarea\n          value={formData.notes}\n          onChange={(e) => handleInputChange('notes', e.target.value)}\n          placeholder=\"Hasta hakkında notlar\"\n          rows={3}\n        />\n      </div>\n\n      <div className=\"flex items-center space-x-2\">\n        <input\n          type=\"checkbox\"\n          id=\"deviceTrial\"\n          checked={formData.deviceTrial}\n          onChange={(e) => handleInputChange('deviceTrial', e.target.checked)}\n          className=\"rounded border-gray-300\"\n        />\n        <label htmlFor=\"deviceTrial\" className=\"text-sm\">Cihaz denemesi yapıldı</label>\n      </div>\n\n      <div className=\"flex justify-end space-x-2 pt-4\">\n        {onCancel && (\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={onCancel}\n            disabled={isSubmitting}\n          >\n            İptal\n          </Button>\n        )}\n        <Button\n          type=\"submit\"\n          variant=\"primary\"\n          disabled={isSubmitting}\n        >\n          {isSubmitting ? 'Kaydediliyor...' : (patient ? 'Güncelle' : 'Kaydet')}\n        </Button>\n      </div>\n    </form>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientFormModal.tsx","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\(.","line":106,"column":26,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":106,"endColumn":27,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2911,2912],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2911,2911],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\).","line":106,"column":28,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":106,"endColumn":29,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2913,2914],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2913,2913],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\+.","line":106,"column":30,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":106,"endColumn":31,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2915,2916],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2915,2915],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'updateFormField' is assigned a value but never used.","line":182,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":182,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":182,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4870,4873],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4870,4873],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":210,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":218,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":228,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":234,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":244,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":250,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":263,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":270,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":280,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":286,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":299,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":306,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":316,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":321,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":333,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":339,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":348,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":355,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":362,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":374,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":383,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":394,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":401,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":411,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":420,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":426,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":441,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":448,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":449,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":455,"endColumn":24}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\nimport { Patient } from '../../types/patient';\nimport { PatientStatus } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\n\ninterface PatientFormData {\n  firstName?: string;\n  lastName?: string;\n  phone: string;\n  tcNumber?: string;\n  birthDate?: string;\n  email?: string;\n  address?: string;\n  status?: PatientStatus;\n  segment?: string;\n  label?: string;\n  acquisitionType?: string;\n  tags?: string[];\n}\n\ninterface PatientFormModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSubmit: (data: Partial<Patient>) => Promise<Patient | null>;\n  initialData?: Patient | null;\n  title?: string;\n  className?: string;\n}\n\n/**\n * PatientFormModal Component\n * Modal form for creating and editing patients\n * Follows 500 LOC limit and single responsibility principle\n */\nexport function PatientFormModal({\n  isOpen,\n  onClose,\n  onSubmit,\n  initialData,\n  title,\n  className = ''\n}: PatientFormModalProps): JSX.Element | null {\n  const [formData, setFormData] = useState<PatientFormData>({\n    firstName: '',\n    lastName: '',\n    phone: '',\n    tcNumber: '',\n    birthDate: '',\n    email: '',\n    address: '',\n    status: 'ACTIVE',\n    segment: 'NEW',\n    label: 'yeni',\n    acquisitionType: 'tabela',\n    tags: []\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [tagsInput, setTagsInput] = useState('');\n\n  // Initialize form data\n  useEffect(() => {\n    if (initialData) {\n      setFormData({\n        firstName: initialData.firstName || '',\n        lastName: initialData.lastName || '',\n        phone: initialData.phone || '',\n        tcNumber: initialData.tcNumber || '',\n        birthDate: initialData.birthDate || '',\n        email: initialData.email || '',\n        address: typeof initialData.address === 'string' ? initialData.address : initialData.addressFull || '',\n        status: initialData.status || 'ACTIVE',\n        segment: initialData.segment || '',\n        label: initialData.label || '',\n        acquisitionType: initialData.acquisitionType || '',\n        tags: initialData.tags || []\n      });\n      setTagsInput(initialData.tags?.join(', ') || '');\n    } else {\n      // Reset form for new patient\n      setFormData({\n        firstName: '',\n        lastName: '',\n        phone: '',\n        tcNumber: '',\n        birthDate: '',\n        email: '',\n        address: '',\n        status: 'ACTIVE',\n        segment: 'NEW',\n        label: 'yeni',\n        acquisitionType: 'tabela',\n        tags: []\n      });\n      setTagsInput('');\n    }\n    setErrors({});\n  }, [initialData, isOpen]);\n\n  const validateForm = useCallback((): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    // Required fields\n    if (!formData.phone?.trim()) {\n      newErrors.phone = 'Telefon numarası gereklidir';\n    } else if (!/^[\\d\\s\\-\\(\\)\\+]+$/.test(formData.phone)) {\n      newErrors.phone = 'Geçerli bir telefon numarası giriniz';\n    }\n\n    // TC Number validation\n    if (formData.tcNumber && formData.tcNumber.length !== 11) {\n      newErrors.tcNumber = 'TC Kimlik No 11 haneli olmalıdır';\n    }\n\n    // Email validation\n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Geçerli bir e-posta adresi giriniz';\n    }\n\n    // Birth date validation\n    if (formData.birthDate) {\n      const birthDate = new Date(formData.birthDate);\n      const today = new Date();\n      if (birthDate > today) {\n        newErrors.birthDate = 'Doğum tarihi bugünden sonra olamaz';\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  }, [formData]);\n\n  const handleInputChange = useCallback((field: keyof PatientFormData, value: string) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n    \n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({\n        ...prev,\n        [field]: ''\n      }));\n    }\n  }, [errors]);\n\n  const handleTagsChange = useCallback((value: string) => {\n    setTagsInput(value);\n    const tags = value\n      .split(',')\n      .map(tag => tag.trim())\n      .filter(Boolean);\n    \n    setFormData(prev => ({\n      ...prev,\n      tags\n    }));\n  }, []);\n\n  const handleSubmit = useCallback(async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      const result = await onSubmit(formData);\n      if (result) {\n        onClose();\n      }\n    } catch (error) {\n      console.error('Form submission error:', error);\n      setErrors({ submit: 'Bir hata oluştu. Lütfen tekrar deneyin.' });\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [formData, validateForm, onSubmit, onClose]);\n\n  const updateFormField = (key: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [key]: value\n    }));\n  };\n\n  const handleClose = useCallback(() => {\n    if (!isSubmitting) {\n      onClose();\n    }\n  }, [isSubmitting, onClose]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className={`fixed inset-0 z-50 overflow-y-auto ${className}`}>\n      <div className=\"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0\">\n        {/* Backdrop */}\n        <div \n          className=\"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75\"\n          onClick={handleClose}\n        />\n\n        {/* Modal */}\n        <div className=\"inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h3 className=\"text-lg font-medium text-gray-900\">{title}</h3>\n            <button\n              onClick={handleClose}\n              disabled={isSubmitting}\n              className=\"text-gray-400 hover:text-gray-600 disabled:opacity-50\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {/* Personal Information */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Ad\n                </label>\n                <input\n                  type=\"text\"\n                  value={formData.firstName}\n                  onChange={(e) => handleInputChange('firstName', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"Hasta adı\"\n                />\n                {errors.firstName && (\n                  <p className=\"mt-1 text-sm text-red-600\">{errors.firstName}</p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Soyad\n                </label>\n                <input\n                  type=\"text\"\n                  value={formData.lastName}\n                  onChange={(e) => handleInputChange('lastName', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"Hasta soyadı\"\n                />\n                {errors.lastName && (\n                  <p className=\"mt-1 text-sm text-red-600\">{errors.lastName}</p>\n                )}\n              </div>\n            </div>\n\n            {/* Contact Information */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Telefon <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"tel\"\n                  value={formData.phone}\n                  onChange={(e) => handleInputChange('phone', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"0555 123 45 67\"\n                  required\n                />\n                {errors.phone && (\n                  <p className=\"mt-1 text-sm text-red-600\">{errors.phone}</p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  E-posta\n                </label>\n                <input\n                  type=\"email\"\n                  value={formData.email}\n                  onChange={(e) => handleInputChange('email', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"ornek@email.com\"\n                />\n                {errors.email && (\n                  <p className=\"mt-1 text-sm text-red-600\">{errors.email}</p>\n                )}\n              </div>\n            </div>\n\n            {/* Identity Information */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  TC Kimlik No\n                </label>\n                <input\n                  type=\"text\"\n                  value={formData.tcNumber}\n                  onChange={(e) => handleInputChange('tcNumber', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"12345678901\"\n                  maxLength={11}\n                />\n                {errors.tcNumber && (\n                  <p className=\"mt-1 text-sm text-red-600\">{errors.tcNumber}</p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Doğum Tarihi\n                </label>\n                <input\n                  type=\"date\"\n                  value={formData.birthDate}\n                  onChange={(e) => handleInputChange('birthDate', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n                {errors.birthDate && (\n                  <p className=\"mt-1 text-sm text-red-600\">{errors.birthDate}</p>\n                )}\n              </div>\n            </div>\n\n            {/* Address */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Adres\n              </label>\n              <textarea\n                value={formData.address}\n                onChange={(e) => handleInputChange('address', e.target.value)}\n                rows={3}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"Hasta adresi\"\n              />\n            </div>\n\n            {/* Classification */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Durum\n                </label>\n                <select\n                  value={formData.status}\n                  onChange={(e) => handleInputChange('status', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"ACTIVE\">Aktif</option>\n                  <option value=\"INACTIVE\">Pasif</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Segment\n                </label>\n                <select\n                  value={formData.segment}\n                  onChange={(e) => handleInputChange('segment', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"NEW\">Yeni</option>\n                  <option value=\"TRIAL\">Deneme</option>\n                  <option value=\"PURCHASED\">Satın Almış</option>\n                  <option value=\"CONTROL\">Kontrol</option>\n                  <option value=\"RENEWAL\">Yenileme</option>\n                  <option value=\"EXISTING\">Mevcut</option>\n                  <option value=\"VIP\">VIP</option>\n                </select>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Etiket\n                </label>\n                <select\n                  value={formData.label}\n                  onChange={(e) => handleInputChange('label', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"yeni\">Yeni</option>\n                  <option value=\"arama-bekliyor\">Arama Bekliyor</option>\n                  <option value=\"randevu-verildi\">Randevu Verildi</option>\n                  <option value=\"deneme-yapildi\">Deneme Yapıldı</option>\n                  <option value=\"kontrol-hastasi\">Kontrol Hastası</option>\n                  <option value=\"satis-tamamlandi\">Satış Tamamlandı</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Kazanım Türü\n                </label>\n                <select\n                  value={formData.acquisitionType}\n                  onChange={(e) => handleInputChange('acquisitionType', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"tabela\">Tabela</option>\n                  <option value=\"sosyal-medya\">Sosyal Medya</option>\n                  <option value=\"tanitim\">Tanıtım</option>\n                  <option value=\"referans\">Referans</option>\n                  <option value=\"diger\">Diğer</option>\n                </select>\n              </div>\n            </div>\n\n            {/* Tags */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Etiketler\n              </label>\n              <input\n                type=\"text\"\n                value={tagsInput}\n                onChange={(e) => handleTagsChange(e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"Etiketleri virgülle ayırın (örn: vip, acil, takip)\"\n              />\n              <p className=\"mt-1 text-xs text-gray-500\">\n                Etiketleri virgülle ayırarak giriniz\n              </p>\n            </div>\n\n            {/* Submit Error */}\n            {errors.submit && (\n              <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg\">\n                <p className=\"text-sm text-red-600\">{errors.submit}</p>\n              </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"flex items-center justify-end gap-3 pt-6 border-t border-gray-200\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                disabled={isSubmitting}\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50\"\n              >\n                İptal\n              </button>\n              <button\n                type=\"submit\"\n                disabled={isSubmitting}\n                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isSubmitting ? 'Kaydediliyor...' : (initialData ? 'Güncelle' : 'Kaydet')}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientGeneralTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_onPatientUpdate' is defined but never used.","line":9,"column":97,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":113},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2983,2986],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2983,2986],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Patient } from '../../types/patient';\n\ninterface PatientGeneralTabProps {\n  patient: Patient;\n  onPatientUpdate?: (patient: Patient) => void;\n}\n\nexport const PatientGeneralTab: React.FC<PatientGeneralTabProps> = ({ patient, onPatientUpdate: _onPatientUpdate }) => {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n      {/* Name */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm font-medium text-gray-600\">Ad Soyad</p>\n            <p className=\"text-lg font-semibold\">{patient.firstName || ''} {patient.lastName || ''}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* TC Number */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm font-medium text-gray-600\">TC Kimlik No</p>\n            <p className=\"text-lg font-semibold\">{patient.tcNumber}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Phone */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm font-medium text-gray-600\">Telefon</p>\n            <p className=\"text-lg font-semibold\">{patient.phone}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Email */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm font-medium text-gray-600\">E-posta</p>\n            <p className=\"text-lg font-semibold\">{patient.email || '-'}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Birth Date */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm font-medium text-gray-600\">Doğum Tarihi</p>\n            <p className=\"text-lg font-semibold\">\n              {patient.birthDate ? new Date(patient.birthDate).toLocaleDateString('tr-TR') : '-'}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Address */}\n      <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <p className=\"text-sm font-medium text-gray-600\">Adres</p>\n            <p className=\"text-lg font-semibold\">\n              {(() => {\n                // Handle address as object or string\n                const address = patient.address;\n                if (typeof address === 'string') {\n                  return address || '-';\n                } else if (typeof address === 'object' && address !== null) {\n                  // Handle address object with city, district, fullAddress\n                  const addressObj = address as any;\n                  return addressObj.fullAddress || \n                         `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                         '-';\n                }\n                return '-';\n              })()}\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientHeader.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":153,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5045,5048],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5045,5048],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Button } from '@x-ear/ui-web';\nimport { Patient } from '../../types/patient';\nimport { \n  Phone, \n  Mail, \n  MapPin, \n  Calendar, \n  User, \n  Edit, \n  Trash2, \n  Printer, \n  Download, \n  MessageSquare, \n  MoreHorizontal,\n  FileText,\n  Copy\n} from 'lucide-react';\n\n// Badge component\nconst Badge: React.FC<{\n  variant?: 'success' | 'warning' | 'danger' | 'secondary';\n  size?: 'sm' | 'md';\n  children: React.ReactNode;\n}> = ({ variant = 'secondary', size = 'md', children }) => {\n  const baseClasses = 'inline-flex items-center font-medium rounded-full';\n  const variantClasses = {\n    success: 'bg-green-100 text-green-800',\n    warning: 'bg-yellow-100 text-yellow-800',\n    danger: 'bg-red-100 text-red-800',\n    secondary: 'bg-gray-100 text-gray-800',\n  };\n  const sizeClasses = {\n    sm: 'px-2 py-1 text-xs',\n    md: 'px-3 py-1 text-sm',\n  };\n\n  return (\n    <span className={`${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]}`}>\n      {children}\n    </span>\n  );\n};\n\ninterface PatientHeaderProps {\n  patient: Patient;\n  onEdit?: () => void;\n  onCall?: () => void;\n  onDelete?: () => void;\n  onPrint?: () => void;\n  onExport?: () => void;\n  onSendSMS?: () => void;\n  onCopyInfo?: () => void;\n  onGenerateReport?: () => void;\n}\n\nexport const PatientHeader: React.FC<PatientHeaderProps> = ({\n  patient,\n  onEdit,\n  onCall,\n  onDelete,\n  onPrint,\n  onExport,\n  onSendSMS,\n  onCopyInfo,\n  onGenerateReport,\n}) => {\n  const formatStatus = (status?: string) => {\n    if (!status) return { label: 'Belirtilmemiş', variant: 'secondary' as const };\n    const statusMap: Record<string, { label: string; variant: 'success' | 'warning' | 'danger' | 'secondary' }> = {\n      active: { label: 'Aktif', variant: 'success' },\n      inactive: { label: 'Pasif', variant: 'secondary' },\n      pending: { label: 'Beklemede', variant: 'warning' },\n      archived: { label: 'Arşivlenmiş', variant: 'danger' },\n    };\n    return statusMap[status] || { label: status, variant: 'secondary' as const };\n  };\n\n  const formatPriorityScore = (score?: number) => {\n    if (!score) return 'Düşük';\n    if (score >= 80) return 'Yüksek';\n    if (score >= 50) return 'Orta';\n    return 'Düşük';\n  };\n\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return 'Belirtilmemiş';\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const formatPhone = (phone?: string) => {\n    if (!phone) return 'Belirtilmemiş';\n    return phone.replace(/(\\d{3})(\\d{3})(\\d{2})(\\d{2})/, '($1) $2 $3 $4');\n  };\n\n  const statusInfo = formatStatus(patient.status);\n\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex items-start space-x-4\">\n          {/* Avatar */}\n          <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center\">\n            <User className=\"w-8 h-8 text-blue-600\" />\n          </div>\n\n          {/* Patient Info */}\n          <div className=\"flex-1\">\n            <div className=\"flex items-center space-x-3 mb-2\">\n              <h1 className=\"text-2xl font-bold text-gray-900\">\n                {patient.firstName || ''} {patient.lastName || ''}\n              </h1>\n              <Badge variant={statusInfo.variant}>\n                {statusInfo.label}\n              </Badge>\n              <span className=\"text-sm text-gray-500\">\n                Öncelik: {formatPriorityScore(patient.priorityScore)}\n              </span>\n            </div>\n\n            <div className=\"text-sm text-gray-600 mb-3\">\n              <span className=\"font-medium\">Segment:</span> {patient.segment || 'Belirtilmemiş'}\n            </div>\n\n            {/* Contact Info */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm\">\n              <div className=\"flex items-center space-x-2\">\n                <Phone className=\"w-4 h-4 text-gray-400\" />\n                <span>{formatPhone(patient.phone)}</span>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <User className=\"w-4 h-4 text-gray-400\" />\n                <span>TC: {patient.tcNumber || 'Belirtilmemiş'}</span>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n                <span>Doğum: {formatDate(patient.birthDate)}</span>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <Mail className=\"w-4 h-4 text-gray-400\" />\n                <span>{patient.email || 'Belirtilmemiş'}</span>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <MapPin className=\"w-4 h-4 text-gray-400\" />\n                <span>\n                  {(() => {\n                    const address = patient.address;\n                    if (typeof address === 'object' && address !== null) {\n                      const addressObj = address as any;\n                      return addressObj.fullAddress || \n                             `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                             'Belirtilmemiş';\n                    }\n                    return patient.addressFull || address || 'Belirtilmemiş';\n                  })()}\n                </span>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <Calendar className=\"w-4 h-4 text-gray-400\" />\n                <span>Kazanım: {patient.acquisitionType || 'Belirtilmemiş'}</span>\n              </div>\n            </div>\n\n            {/* Additional Info */}\n            <div className=\"mt-4 flex items-center space-x-4 text-sm text-gray-500\">\n              <span>Kayıt: {formatDate(patient.createdAt)}</span>\n              {patient.tags && patient.tags.length > 0 && (\n                <div className=\"flex items-center space-x-1\">\n                  <span>Etiketler:</span>\n                  {patient.tags.map((tag, index) => (\n                    <Badge key={index} variant=\"secondary\" size=\"sm\">\n                      {tag}\n                    </Badge>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex items-center space-x-2\">\n          {/* Primary Actions */}\n          {onCall && (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={onCall}\n              icon={<Phone className=\"w-4 h-4\" />}\n              iconPosition=\"left\"\n            >\n              Ara\n            </Button>\n          )}\n          \n          {onSendSMS && (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={onSendSMS}\n              icon={<MessageSquare className=\"w-4 h-4\" />}\n              iconPosition=\"left\"\n            >\n              SMS\n            </Button>\n          )}\n          \n          {onEdit && (\n            <Button\n              variant=\"primary\"\n              size=\"sm\"\n              onClick={onEdit}\n              icon={<Edit className=\"w-4 h-4\" />}\n              iconPosition=\"left\"\n            >\n              Düzenle\n            </Button>\n          )}\n\n          {/* Secondary Actions Dropdown */}\n          <div className=\"relative group\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              icon={<MoreHorizontal className=\"w-4 h-4\" />}\n            >\n              Diğer\n            </Button>\n            \n            {/* Dropdown Menu */}\n            <div className=\"absolute right-0 top-full mt-1 w-48 bg-white rounded-md shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10\">\n              <div className=\"py-1\">\n                {onPrint && (\n                  <Button\n                    variant=\"ghost\"\n                    onClick={onPrint}\n                    className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 justify-start\"\n                  >\n                    <Printer className=\"w-4 h-4 mr-3\" />\n                    Yazdır\n                  </Button>\n                )}\n                \n                {onExport && (\n                  <Button\n                    variant=\"ghost\"\n                    onClick={onExport}\n                    className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 justify-start\"\n                  >\n                    <Download className=\"w-4 h-4 mr-3\" />\n                    Dışa Aktar\n                  </Button>\n                )}\n                \n                {onGenerateReport && (\n                  <Button\n                    variant=\"ghost\"\n                    onClick={onGenerateReport}\n                    className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 justify-start\"\n                  >\n                    <FileText className=\"w-4 h-4 mr-3\" />\n                    Rapor Oluştur\n                  </Button>\n                )}\n                \n                {onCopyInfo && (\n                  <Button\n                    variant=\"ghost\"\n                    onClick={onCopyInfo}\n                    className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 justify-start\"\n                  >\n                    <Copy className=\"w-4 h-4 mr-3\" />\n                    Bilgileri Kopyala\n                  </Button>\n                )}\n                \n                {onDelete && (\n                  <>\n                    <div className=\"border-t border-gray-100 my-1\"></div>\n                    <Button\n                      variant=\"ghost\"\n                      onClick={onDelete}\n                      className=\"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 justify-start\"\n                    >\n                      <Trash2 className=\"w-4 h-4 mr-3\" />\n                      Sil\n                    </Button>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientHearingTestsTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientId' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2061,2064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2061,2064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2554,2557],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2554,2557],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":88,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3112,3115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3112,3115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Button, Badge } from '@x-ear/ui-web';\nimport { Activity, AlertCircle, Calendar, User } from 'lucide-react';\n\ninterface PatientHearingTestsTabProps {\n  patientId: string;\n}\n\nexport const PatientHearingTestsTab: React.FC<PatientHearingTestsTabProps> = ({\n  patientId,\n}) => {\n  // Mock data for now - will be replaced with actual hook\n  const hearingTests = [];\n  const isLoading = false;\n  const error = null;\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">İşitme testleri yükleniyor...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6 text-center\">\n        <AlertCircle className=\"w-12 h-12 text-red-400 mx-auto mb-4\" />\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Hata Oluştu</h3>\n        <p className=\"text-gray-500\">İşitme testleri yüklenirken bir hata oluştu.</p>\n      </div>\n    );\n  }\n\n  const totalTests = hearingTests?.length || 0;\n  const recentTests = hearingTests?.slice(0, 5) || [];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Statistics */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex items-center\">\n            <Activity className=\"w-8 h-8 text-blue-600 mr-3\" />\n            <div>\n              <p className=\"text-2xl font-bold text-gray-900\">{totalTests}</p>\n              <p className=\"text-sm text-gray-500\">Toplam Test</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex items-center\">\n            <Calendar className=\"w-8 h-8 text-green-600 mr-3\" />\n            <div>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {hearingTests?.filter((test: any) => test.status === 'completed').length || 0}\n              </p>\n              <p className=\"text-sm text-gray-500\">Tamamlanan</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex items-center\">\n            <User className=\"w-8 h-8 text-purple-600 mr-3\" />\n            <div>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {new Set(hearingTests?.map((test: any) => test.conducted_by)).size || 0}\n              </p>\n              <p className=\"text-sm text-gray-500\">Doktor</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Recent Tests */}\n      <div className=\"bg-white border rounded-lg shadow-sm\">\n        <div className=\"p-6 border-b\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Son İşitme Testleri</h3>\n        </div>\n        <div className=\"p-6\">\n          {recentTests.length > 0 ? (\n            <div className=\"space-y-4\">\n              {recentTests.map((test: any) => (\n                <div key={test.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\n                      <Activity className=\"w-5 h-5 text-blue-600\" />\n                    </div>\n                    <div>\n                      <h4 className=\"font-medium text-gray-900\">\n                        {test.test_type} Testi\n                      </h4>\n                      <p className=\"text-sm text-gray-500\">\n                        {new Date(test.test_date).toLocaleDateString('tr-TR')}\n                      </p>\n                      <p className=\"text-sm text-gray-500\">\n                        Dr. {test.conducted_by}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Badge variant={test.status === 'completed' ? 'default' : 'secondary'}>\n                      {test.status === 'completed' ? 'Tamamlandı' : 'Bekliyor'}\n                    </Badge>\n                    {test.results && (\n                      <Button variant=\"secondary\" size=\"sm\">\n                        Sonuçları Görüntüle\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8\">\n              <Activity className=\"w-12 h-12 text-gray-300 mx-auto mb-4\" />\n              <p className=\"text-gray-500\">Henüz hiç işitme testi bulunmuyor.</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MapPin' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AlertCircle' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckCircle' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Clock' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MoreVertical' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Eye' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Download' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Upload' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'usePatients' is defined but never used.","line":21,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useDeletePatient' is defined but never used.","line":21,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":39},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":58,"column":5,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":70,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onBulkAction' is defined but never used.","line":86,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":15}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useMemo } from 'react';\nimport { Button, Spinner, Badge, Checkbox, Modal } from '@x-ear/ui-web';\nimport { \n  User, \n  Phone, \n  Mail, \n  Calendar, \n  MapPin, \n  CreditCard,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  MoreVertical,\n  Eye,\n  Edit,\n  Trash2,\n  Download,\n  Upload,\n  MessageSquare\n} from 'lucide-react';\nimport { usePatients, useDeletePatient } from '../../hooks/patient/usePatients';\n\nimport type { Patient } from '../../types/patient';\n\n\nimport { PatientCommunicationIntegration } from './PatientCommunicationIntegration';\n\ninterface PatientListProps {\n  patients: Patient[];\n  loading?: boolean;\n  selectedPatients?: string[];\n  onPatientSelect?: (patientId: string) => void;\n  onPatientClick?: (patient: Patient) => void;\n  onEdit?: (patient: Patient) => void;\n  onDelete?: (patient: Patient) => void;\n  onBulkAction?: (action: string, patientIds: string[]) => void;\n  showSelection?: boolean;\n  showActions?: boolean;\n  viewMode?: 'list' | 'grid' | 'compact';\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n  onSort?: (field: string) => void;\n  className?: string;\n}\n\ninterface SortableHeaderProps {\n  field: string;\n  label: string;\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n  onSort?: (field: string) => void;\n}\n\nfunction SortableHeader({ field, label, sortBy, sortOrder, onSort }: SortableHeaderProps) {\n  const isActive = sortBy === field;\n  \n  return (\n    <button\n      onClick={() => onSort?.(field)}\n      className={`flex items-center space-x-1 text-left font-medium text-gray-700 hover:text-gray-900 ${\n        isActive ? 'text-blue-600' : ''\n      }`}\n    >\n      <span>{label}</span>\n      {isActive && (\n        <span className=\"text-xs\">\n          {sortOrder === 'asc' ? '↑' : '↓'}\n        </span>\n      )}\n    </button>\n  );\n}\n\n/**\n * PatientList Component\n * Displays a list of patients with various view modes and actions\n */\nexport function PatientList({\n  patients,\n  loading = false,\n  selectedPatients = [],\n  onPatientSelect,\n  onPatientClick,\n  onEdit,\n  onDelete,\n  onBulkAction,\n  showSelection = false,\n  showActions = true,\n  viewMode = 'list',\n  sortBy,\n  sortOrder,\n  onSort,\n  className = ''\n}: PatientListProps) {\n  const [hoveredPatient, setHoveredPatient] = useState<string | null>(null);\n  const [communicationPatient, setCommunicationPatient] = useState<Patient | null>(null);\n\n  const isAllSelected = useMemo(() => {\n    return patients.length > 0 && patients.every(p => p.id && selectedPatients.includes(p.id));\n  }, [patients, selectedPatients]);\n\n  const isPartiallySelected = useMemo(() => {\n    return selectedPatients.length > 0 && !isAllSelected;\n  }, [selectedPatients, isAllSelected]);\n\n  const handleSelectAll = useCallback(() => {\n    if (isAllSelected) {\n      // Deselect all\n      patients.forEach(p => p.id && onPatientSelect?.(p.id));\n    } else {\n      // Select all\n      patients.forEach(p => {\n        if (p.id && !selectedPatients.includes(p.id)) {\n          onPatientSelect?.(p.id);\n        }\n      });\n    }\n  }, [patients, selectedPatients, isAllSelected, onPatientSelect]);\n\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'ACTIVE':\n        return <Badge variant=\"success\" size=\"sm\">Aktif</Badge>;\n      case 'INACTIVE':\n        return <Badge variant=\"warning\" size=\"sm\">Pasif</Badge>;\n      default:\n        return <Badge variant=\"secondary\" size=\"sm\">Bilinmiyor</Badge>;\n    }\n  };\n\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return '-';\n    try {\n      return new Date(dateString).toLocaleDateString('tr-TR');\n    } catch {\n      return '-';\n    }\n  };\n\n  const formatPhone = (phone?: string) => {\n    if (!phone) return '-';\n    // Format Turkish phone number\n    const cleaned = phone.replace(/\\D/g, '');\n    if (cleaned.length === 11 && cleaned.startsWith('0')) {\n      return `${cleaned.slice(0, 4)} ${cleaned.slice(4, 7)} ${cleaned.slice(7, 9)} ${cleaned.slice(9)}`;\n    }\n    return phone;\n  };\n\n  const getSegmentBadge = (segment?: string) => {\n    if (!segment) return <Badge variant=\"secondary\" size=\"sm\">-</Badge>;\n    \n    switch (segment.toUpperCase()) {\n      case 'PREMIUM':\n        return <Badge variant=\"success\" size=\"sm\">Premium</Badge>;\n      case 'STANDARD':\n        return <Badge variant=\"default\" size=\"sm\">Standard</Badge>;\n      case 'BASIC':\n        return <Badge variant=\"secondary\" size=\"sm\">Basic</Badge>;\n      default:\n        return <Badge variant=\"secondary\" size=\"sm\">{segment}</Badge>;\n    }\n  };\n\n  const getAcquisitionStatusBadge = (acquisitionType?: string) => {\n    if (!acquisitionType) return <Badge variant=\"secondary\" size=\"sm\">-</Badge>;\n    \n    switch (acquisitionType.toLowerCase()) {\n      case 'organic':\n        return <Badge variant=\"success\" size=\"sm\">Organik</Badge>;\n      case 'referral':\n        return <Badge variant=\"default\" size=\"sm\">Referans</Badge>;\n      case 'marketing':\n        return <Badge variant=\"warning\" size=\"sm\">Pazarlama</Badge>;\n      case 'social':\n        return <Badge variant=\"primary\" size=\"sm\">Sosyal</Badge>;\n      default:\n        return <Badge variant=\"secondary\" size=\"sm\">{acquisitionType}</Badge>;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <Spinner size=\"lg\" />\n        <span className=\"ml-2 text-gray-600\">Hastalar yükleniyor...</span>\n      </div>\n    );\n  }\n\n  if (patients.length === 0) {\n    return (\n      <div className=\"text-center py-12\">\n        <User className=\"mx-auto h-12 w-12 text-gray-400\" />\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Hasta bulunamadı</h3>\n        <p className=\"mt-1 text-sm text-gray-500\">\n          Arama kriterlerinizi değiştirmeyi deneyin.\n        </p>\n      </div>\n    );\n  }\n\n  if (viewMode === 'grid') {\n    return (\n      <div className={`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 ${className}`}>\n        {patients.map((patient) => (\n          <div\n            key={patient.id}\n            className=\"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow cursor-pointer\"\n            onClick={() => onPatientClick?.(patient)}\n            onMouseEnter={() => setHoveredPatient(patient.id || null)}\n            onMouseLeave={() => setHoveredPatient(null)}\n          >\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex-1\">\n                <div className=\"flex items-center space-x-2\">\n                  {showSelection && (\n                    <Checkbox\n                      checked={patient.id ? selectedPatients.includes(patient.id) : false}\n                      onChange={() => patient.id && onPatientSelect?.(patient.id)}\n                      onClick={(e) => e.stopPropagation()}\n                    />\n                  )}\n                  <h3 className=\"text-sm font-medium text-gray-900\">\n                    {patient.firstName} {patient.lastName}\n                  </h3>\n                </div>\n                \n                <div className=\"mt-2 space-y-1\">\n                  {patient.tcNumber && (\n                    <div className=\"flex items-center text-xs text-gray-500\">\n                      <CreditCard className=\"h-3 w-3 mr-1\" />\n                      {patient.tcNumber}\n                    </div>\n                  )}\n                  {patient.phone && (\n                    <div className=\"flex items-center text-xs text-gray-500\">\n                      <Phone className=\"h-3 w-3 mr-1\" />\n                      {formatPhone(patient.phone)}\n                    </div>\n                  )}\n                  {patient.email && (\n                    <div className=\"flex items-center text-xs text-gray-500\">\n                      <Mail className=\"h-3 w-3 mr-1\" />\n                      {patient.email}\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"mt-3 flex items-center justify-between\">\n                  {getStatusBadge(patient.status)}\n                  {patient.createdAt && (\n                    <span className=\"text-xs text-gray-400\">\n                      {formatDate(patient.createdAt)}\n                    </span>\n                  )}\n                </div>\n              </div>\n\n              {showActions && hoveredPatient === patient.id && (\n                <div className=\"flex space-x-1\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onEdit?.(patient);\n                    }}\n                  >\n                    <Edit className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onDelete?.(patient);\n                    }}\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  // List view (default)\n  return (\n    <>\n      <div className={`bg-white shadow-sm border border-gray-200 rounded-lg overflow-hidden ${className}`}>\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                {showSelection && (\n                  <th className=\"px-4 py-3 text-left w-12\">\n                    <Checkbox\n                      checked={isAllSelected}\n                      indeterminate={isPartiallySelected}\n                      onChange={handleSelectAll}\n                    />\n                  </th>\n                )}\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px]\">\n                  <SortableHeader\n                    field=\"firstName\"\n                    label=\"Ad Soyad\"\n                    sortBy={sortBy}\n                    sortOrder={sortOrder}\n                    onSort={onSort}\n                  />\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]\">\n                  <SortableHeader\n                    field=\"tcNumber\"\n                    label=\"TC Kimlik\"\n                    sortBy={sortBy}\n                    sortOrder={sortOrder}\n                    onSort={onSort}\n                  />\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[140px]\">\n                  <SortableHeader\n                    field=\"phone\"\n                    label=\"Telefon\"\n                    sortBy={sortBy}\n                    sortOrder={sortOrder}\n                    onSort={onSort}\n                  />\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]\">\n                  Segment\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]\">\n                  Kazanım Durumu\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]\">\n                  <SortableHeader\n                    field=\"status\"\n                    label=\"Durum\"\n                    sortBy={sortBy}\n                    sortOrder={sortOrder}\n                    onSort={onSort}\n                  />\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]\">\n                  <SortableHeader\n                    field=\"createdAt\"\n                    label=\"Kayıt Tarihi\"\n                    sortBy={sortBy}\n                    sortOrder={sortOrder}\n                    onSort={onSort}\n                  />\n                </th>\n                {showActions && (\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[160px]\">\n                    İşlemler\n                  </th>\n                )}\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {patients.map((patient) => (\n                <tr\n                  key={patient.id}\n                  className=\"hover:bg-gray-50 cursor-pointer transition-colors duration-150\"\n                  onClick={() => onPatientClick?.(patient)}\n                  onMouseEnter={() => setHoveredPatient(patient.id || null)}\n                  onMouseLeave={() => setHoveredPatient(null)}\n                >\n                  {showSelection && (\n                    <td className=\"px-4 py-4 whitespace-nowrap\">\n                      <Checkbox\n                        checked={patient.id ? selectedPatients.includes(patient.id) : false}\n                        onChange={() => patient.id && onPatientSelect?.(patient.id)}\n                        onClick={(e) => e.stopPropagation()}\n                      />\n                    </td>\n                  )}\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 h-10 w-10\">\n                        <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center\">\n                          <User className=\"h-5 w-5 text-blue-600\" />\n                        </div>\n                      </div>\n                      <div className=\"ml-4\">\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {patient.firstName} {patient.lastName}\n                        </div>\n                        {patient.email && (\n                          <div className=\"text-sm text-gray-500 truncate max-w-[180px]\">{patient.email}</div>\n                        )}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-mono\">\n                    {patient.tcNumber || '-'}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {formatPhone(patient.phone)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    {getSegmentBadge(patient.segment)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    {getAcquisitionStatusBadge(patient.acquisitionType)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    {getStatusBadge(patient.status)}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    {formatDate(patient.createdAt)}\n                  </td>\n                  {showActions && (\n                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                      <div className=\"flex items-center justify-end space-x-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            onEdit?.(patient);\n                          }}\n                          className=\"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600\"\n                          title=\"Düzenle\"\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            setCommunicationPatient(patient);\n                          }}\n                          className=\"h-8 w-8 p-0 hover:bg-green-50 hover:text-green-600\"\n                          title=\"İletişim\"\n                        >\n                          <MessageSquare className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            onDelete?.(patient);\n                          }}\n                          className=\"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600\"\n                          title=\"Sil\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </td>\n                  )}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Communication Modal */}\n      {communicationPatient && (\n        <Modal\n          isOpen={true}\n          onClose={() => setCommunicationPatient(null)}\n          title={`İletişim - ${communicationPatient.firstName} ${communicationPatient.lastName}`}\n          size=\"xl\"\n        >\n          <PatientCommunicationIntegration\n            patient={communicationPatient}\n            onClose={() => setCommunicationPatient(null)}\n          />\n        </Modal>\n      )}\n    </>\n   );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientMatching.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MatchingConfig' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[858,861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[858,861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setMatchingConfig' is assigned a value but never used.","line":43,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":83,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2956,2959],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2956,2959],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'index' is defined but never used.","line":389,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":389,"endColumn":56},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":527,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":527,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19473,19476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19473,19476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useMemo } from 'react';\nimport { Users, AlertTriangle, CheckCircle, X, Eye, Merge, Phone, Mail, Calendar, User, Settings, Search } from 'lucide-react';\nimport { Button, Modal, useModal, Card, Badge, useToastHelpers, Checkbox, Input, Select } from '@x-ear/ui-web';\nimport { Patient } from '../../types/patient';\nimport { \n  PatientMatcher, \n  PatientMatch, \n  MatchingConfig, \n  DEFAULT_MATCHING_CONFIG,\n  getMatchColor,\n  getRiskColor\n} from '../../utils/patient-matching';\n\ninterface PatientMatchingProps {\n  patients: Patient[];\n  onMergePatients: (primaryId: string, duplicateIds: string[]) => void;\n  onRefresh: () => void;\n}\n\ninterface MergePreview {\n  primary: Patient;\n  duplicates: Patient[];\n  mergedData: Partial<Patient>;\n  conflicts: Array<{\n    field: string;\n    values: Array<{ patientId: string; value: any; patientName: string }>;\n  }>;\n}\n\nexport const PatientMatching: React.FC<PatientMatchingProps> = ({\n  patients,\n  onMergePatients,\n  onRefresh\n}) => {\n  const [matches, setMatches] = useState<PatientMatch[]>([]);\n  const [selectedMatch, setSelectedMatch] = useState<PatientMatch | null>(null);\n  const [mergePreview, setMergePreview] = useState<MergePreview | null>(null);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [filterStatus, setFilterStatus] = useState('all');\n  const [filterConfidence, setFilterConfidence] = useState('all');\n  const [filterRisk, setFilterRisk] = useState('all');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [matchingConfig, setMatchingConfig] = useState(DEFAULT_MATCHING_CONFIG);\n  const [autoMergeEnabled, setAutoMergeEnabled] = useState(false);\n  \n  const detailModal = useModal();\n  const mergeModal = useModal();\n  const settingsModal = useModal();\n  const { success, error } = useToastHelpers();\n\n  // Patient matcher instance\n  const patientMatcher = useMemo(() => new PatientMatcher(matchingConfig), [matchingConfig]);\n\n  // Hasta eşleştirmelerini analiz et\n  const analyzeMatches = useCallback(async () => {\n    setIsAnalyzing(true);\n    \n    try {\n      const foundMatches = patientMatcher.findAllMatches(patients);\n      setMatches(foundMatches);\n      success(`${foundMatches.length} potansiyel eşleşme bulundu`);\n      \n    } catch (err) {\n      error('Eşleşme analizi sırasında hata oluştu');\n    } finally {\n      setIsAnalyzing(false);\n    }\n  }, [patients, patientMatcher, success, error]);\n\n  // Birleştirme önizlemesi oluştur\n  const createMergePreview = useCallback((match: PatientMatch) => {\n    const [primary, ...duplicates] = match.patients;\n    const conflicts: MergePreview['conflicts'] = [];\n    const mergedData: Partial<Patient> = { ...primary };\n    \n    // Çakışmaları tespit et\n    const fields = ['name', 'phone', 'email', 'birthDate', 'address'];\n    \n    fields.forEach(field => {\n      const values = match.patients\n        .map(p => ({ \n          patientId: p.id || '', \n          value: (p as any)[field], \n          patientName: `${p.firstName || ''} ${p.lastName || ''}`.trim() || 'Unknown' \n        }))\n        .filter(v => v.value && v.patientId);\n      \n      if (values.length > 1) {\n        const uniqueValues = [...new Set(values.map(v => v.value))];\n        if (uniqueValues.length > 1) {\n          conflicts.push({ field, values });\n        }\n      }\n    });\n    \n    return {\n      primary,\n      duplicates,\n      mergedData,\n      conflicts\n    };\n  }, []);\n\n  // Eşleşme detayını göster\n  const showMatchDetail = useCallback((match: PatientMatch) => {\n    setSelectedMatch(match);\n    detailModal.openModal();\n  }, [detailModal]);\n\n  // Birleştirme modalını aç\n  const showMergeModal = useCallback((match: PatientMatch) => {\n    const preview = createMergePreview(match);\n    setMergePreview(preview);\n    setSelectedMatch(match);\n    mergeModal.openModal();\n  }, [createMergePreview, mergeModal]);\n\n  // Hastaları birleştir\n  const handleMergePatients = useCallback(async () => {\n    if (!selectedMatch || !mergePreview) return;\n    \n    try {\n      const primaryId = mergePreview.primary.id;\n      const duplicateIds = mergePreview.duplicates.map(p => p.id).filter(Boolean) as string[];\n      \n      if (!primaryId) {\n        throw new Error('Primary patient ID is required');\n      }\n      \n      await onMergePatients(primaryId, duplicateIds);\n      \n      // Eşleşmeyi güncelle\n      setMatches(prev => prev.map(m => \n        m.id === selectedMatch.id \n          ? { ...m, status: 'merged' as const }\n          : m\n      ));\n      \n      success('Hastalar başarıyla birleştirildi');\n      mergeModal.closeModal();\n      onRefresh();\n      \n    } catch (err) {\n      error('Hasta birleştirme sırasında hata oluştu');\n    }\n  }, [selectedMatch, mergePreview, onMergePatients, success, error, mergeModal, onRefresh]);\n\n  // Eşleşmeyi yoksay\n  const ignoreMatch = useCallback((matchId: string) => {\n    setMatches(prev => prev.map(m => \n      m.id === matchId \n        ? { ...m, status: 'ignored' as const }\n        : m\n    ));\n  }, []);\n\n  // Filtrelenmiş eşleşmeler\n  const filteredMatches = useMemo(() => {\n    return matches.filter(match => {\n      // Status filtresi\n      if (filterStatus !== 'all' && match.status !== filterStatus) return false;\n      \n      // Confidence filtresi\n      if (filterConfidence !== 'all' && match.confidence !== filterConfidence) return false;\n      \n      // Risk filtresi\n      if (filterRisk !== 'all' && match.riskLevel !== filterRisk) return false;\n      \n      // Arama filtresi\n      if (searchTerm) {\n        const searchLower = searchTerm.toLowerCase();\n        const matchesSearch = match.patients.some(patient => \n          patient.firstName?.toLowerCase().includes(searchLower) ||\n        patient.lastName?.toLowerCase().includes(searchLower) ||\n          patient.phone?.includes(searchTerm) ||\n          patient.email?.toLowerCase().includes(searchLower)\n        );\n        if (!matchesSearch) return false;\n      }\n      \n      return true;\n    });\n  }, [matches, filterStatus, filterConfidence, filterRisk, searchTerm]);\n\n  // Bekleyen eşleşmeler\n  const pendingMatches = useMemo(() => \n    filteredMatches.filter(m => m.status === 'pending'), \n    [filteredMatches]\n  );\n\n  // Güven seviyesi etiketi\n  const getConfidenceLabel = (confidence: string) => {\n    switch (confidence) {\n      case 'high': return 'Yüksek';\n      case 'medium': return 'Orta';\n      case 'low': return 'Düşük';\n      default: return 'Bilinmeyen';\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Başlık ve Kontroller */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-xl font-semibold text-gray-900\">Hasta Eşleştirme</h2>\n          <p className=\"text-sm text-gray-600 mt-1\">\n            Potansiyel duplikat hastaları tespit edin ve birleştirin\n          </p>\n        </div>\n        \n        <div className=\"flex items-center space-x-3\">\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              checked={autoMergeEnabled}\n              onChange={(e) => setAutoMergeEnabled(e.target.checked)}\n            />\n            <span className=\"text-sm text-gray-700\">Otomatik birleştirme</span>\n          </div>\n          \n          <Button\n            variant=\"outline\"\n            onClick={() => settingsModal.openModal()}\n          >\n            <Settings className=\"w-4 h-4 mr-2\" />\n            Ayarlar\n          </Button>\n          \n          <Button\n            onClick={analyzeMatches}\n            loading={isAnalyzing}\n            disabled={patients.length < 2}\n          >\n            <Users className=\"w-4 h-4 mr-2\" />\n            Analiz Et\n          </Button>\n        </div>\n      </div>\n\n      {/* Filtreler */}\n      {matches.length > 0 && (\n        <Card className=\"p-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Arama\n              </label>\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                <Input\n                  placeholder=\"Hasta ara...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-10\"\n                />\n              </div>\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Durum\n              </label>\n              <Select\n                value={filterStatus}\n                onChange={(e) => setFilterStatus(e.target.value)}\n                options={[\n                  { value: 'all', label: 'Tümü' },\n                  { value: 'pending', label: 'Beklemede' },\n                  { value: 'reviewed', label: 'İncelendi' },\n                  { value: 'merged', label: 'Birleştirildi' },\n                  { value: 'ignored', label: 'Yoksayıldı' }\n                ]}\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Güven Seviyesi\n              </label>\n              <Select\n                value={filterConfidence}\n                onChange={(e) => setFilterConfidence(e.target.value)}\n                options={[\n                  { value: 'all', label: 'Tümü' },\n                  { value: 'high', label: 'Yüksek' },\n                  { value: 'medium', label: 'Orta' },\n                  { value: 'low', label: 'Düşük' }\n                ]}\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Risk Seviyesi\n              </label>\n              <Select\n                value={filterRisk}\n                onChange={(e) => setFilterRisk(e.target.value)}\n                options={[\n                  { value: 'all', label: 'Tümü' },\n                  { value: 'critical', label: 'Kritik' },\n                  { value: 'high', label: 'Yüksek' },\n                  { value: 'medium', label: 'Orta' },\n                  { value: 'low', label: 'Düşük' }\n                ]}\n              />\n            </div>\n          </div>\n        </Card>\n      )}\n\n      {/* İstatistikler */}\n      {matches.length > 0 && (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <Card className=\"p-4\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"p-2 bg-blue-100 rounded-lg\">\n                <Users className=\"w-5 h-5 text-blue-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">Toplam Eşleşme</p>\n                <p className=\"text-xl font-semibold\">{matches.length}</p>\n              </div>\n            </div>\n          </Card>\n          \n          <Card className=\"p-4\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"p-2 bg-red-100 rounded-lg\">\n                <AlertTriangle className=\"w-5 h-5 text-red-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">Yüksek Güven</p>\n                <p className=\"text-xl font-semibold\">\n                  {matches.filter(m => m.confidence === 'high').length}\n                </p>\n              </div>\n            </div>\n          </Card>\n          \n          <Card className=\"p-4\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"p-2 bg-green-100 rounded-lg\">\n                <CheckCircle className=\"w-5 h-5 text-green-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">Birleştirildi</p>\n                <p className=\"text-xl font-semibold\">\n                  {matches.filter(m => m.status === 'merged').length}\n                </p>\n              </div>\n            </div>\n          </Card>\n          \n          <Card className=\"p-4\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"p-2 bg-yellow-100 rounded-lg\">\n                <X className=\"w-5 h-5 text-yellow-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">Beklemede</p>\n                <p className=\"text-xl font-semibold\">{pendingMatches.length}</p>\n              </div>\n            </div>\n          </Card>\n        </div>\n      )}\n\n      {/* Eşleşme Listesi */}\n      {filteredMatches.length > 0 ? (\n        <div className=\"space-y-4\">\n          {filteredMatches.map(match => (\n            <Card key={match.id} className=\"p-4\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <Badge className={getMatchColor(match.confidence)}>\n                      {getConfidenceLabel(match.confidence)} Güven\n                    </Badge>\n                    <Badge className={getRiskColor(match.riskLevel)}>\n                      {match.riskLevel} Risk\n                    </Badge>\n                    <span className=\"text-sm text-gray-600\">\n                      %{Math.round(match.similarity * 100)} benzerlik\n                    </span>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3\">\n                    {match.patients.map((patient, index) => (\n                      <div key={patient.id} className=\"border rounded-lg p-3\">\n                        <div className=\"flex items-center space-x-2 mb-2\">\n                          <User className=\"w-4 h-4 text-gray-500\" />\n                          <span className=\"font-medium\">{patient.firstName} {patient.lastName}</span>\n                        </div>\n                        \n                        <div className=\"space-y-1 text-sm text-gray-600\">\n                          {patient.phone && (\n                            <div className=\"flex items-center space-x-2\">\n                              <Phone className=\"w-3 h-3\" />\n                              <span>{patient.phone}</span>\n                            </div>\n                          )}\n                          \n                          {patient.email && (\n                            <div className=\"flex items-center space-x-2\">\n                              <Mail className=\"w-3 h-3\" />\n                              <span>{patient.email}</span>\n                            </div>\n                          )}\n                          \n                          {patient.birthDate && (\n                            <div className=\"flex items-center space-x-2\">\n                              <Calendar className=\"w-3 h-3\" />\n                              <span>{patient.birthDate}</span>\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                  \n                  <div className=\"text-sm text-gray-600\">\n                    <strong>Eşleşme Nedenleri:</strong> {match.matchReasons.join(', ')}\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center space-x-2 ml-4\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => showMatchDetail(match)}\n                  >\n                    <Eye className=\"w-4 h-4\" />\n                  </Button>\n                  \n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => showMergeModal(match)}\n                    disabled={match.status !== 'pending'}\n                  >\n                    <Merge className=\"w-4 h-4\" />\n                  </Button>\n                  \n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => ignoreMatch(match.id)}\n                    disabled={match.status !== 'pending'}\n                  >\n                    <X className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </Card>\n          ))}\n        </div>\n      ) : matches.length > 0 ? (\n        <Card className=\"p-8 text-center\">\n          <CheckCircle className=\"w-12 h-12 text-green-500 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            Filtre kriterlerine uygun eşleşme bulunamadı\n          </h3>\n          <p className=\"text-gray-600\">\n            Farklı filtre seçeneklerini deneyin veya filtreleri temizleyin.\n          </p>\n        </Card>\n      ) : (\n        <Card className=\"p-8 text-center\">\n          <Users className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            Henüz analiz yapılmadı\n          </h3>\n          <p className=\"text-gray-600 mb-4\">\n            Potansiyel duplikat hastaları bulmak için analiz başlatın.\n          </p>\n          <Button onClick={analyzeMatches} disabled={patients.length < 2}>\n            <Users className=\"w-4 h-4 mr-2\" />\n            Analiz Et\n          </Button>\n        </Card>\n      )}\n\n      {/* Detay Modal */}\n      <Modal\n        isOpen={detailModal.isOpen}\n        onClose={detailModal.closeModal}\n        title=\"Eşleşme Detayları\"\n        size=\"lg\"\n      >\n        {selectedMatch && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center space-x-3\">\n              <Badge className={getMatchColor(selectedMatch.confidence)}>\n                {getConfidenceLabel(selectedMatch.confidence)} Güven\n              </Badge>\n              <Badge className={getRiskColor(selectedMatch.riskLevel)}>\n                {selectedMatch.riskLevel} Risk\n              </Badge>\n              <span className=\"text-sm text-gray-600\">\n                %{Math.round(selectedMatch.similarity * 100)} benzerlik\n              </span>\n            </div>\n            \n            <div>\n              <h4 className=\"font-medium mb-2\">Eşleşme Nedenleri:</h4>\n              <ul className=\"list-disc list-inside space-y-1 text-sm text-gray-600\">\n                {selectedMatch.matchReasons.map((reason, index) => (\n                  <li key={index}>{reason}</li>\n                ))}\n              </ul>\n            </div>\n            \n            <div>\n              <h4 className=\"font-medium mb-2\">Hasta Bilgileri:</h4>\n              <div className=\"space-y-3\">\n                {selectedMatch.patients.map((patient, index) => (\n                  <div key={patient.id} className=\"border rounded-lg p-3\">\n                    <h5 className=\"font-medium mb-2\">Hasta {index + 1}: {patient.firstName} {patient.lastName}</h5>\n                    <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                      <div><strong>Telefon:</strong> {patient.phone || 'Yok'}</div>\n                      <div><strong>E-posta:</strong> {patient.email || 'Yok'}</div>\n                      <div><strong>Doğum Tarihi:</strong> {patient.birthDate || 'Yok'}</div>\n                      <div><strong>Adres:</strong> {(() => {\n                        const address = patient.address;\n                        if (typeof address === 'object' && address !== null) {\n                          const addressObj = address as any;\n                          return addressObj.fullAddress || \n                                 `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                                 'Yok';\n                        }\n                        return patient.addressFull || address || 'Yok';\n                      })()}</div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n      </Modal>\n\n      {/* Birleştirme Modal */}\n      <Modal\n        isOpen={mergeModal.isOpen}\n        onClose={mergeModal.closeModal}\n        title=\"Hastaları Birleştir\"\n        size=\"lg\"\n      >\n        {mergePreview && (\n          <div className=\"space-y-4\">\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n              <div className=\"flex items-center space-x-2\">\n                <AlertTriangle className=\"w-5 h-5 text-yellow-600\" />\n                <span className=\"font-medium text-yellow-800\">Dikkat</span>\n              </div>\n              <p className=\"text-yellow-700 mt-1\">\n                Bu işlem geri alınamaz. Seçilen hastalar birleştirilecek ve duplikat kayıtlar silinecektir.\n              </p>\n            </div>\n            \n            <div>\n              <h4 className=\"font-medium mb-2\">Ana Hasta (Korunacak):</h4>\n              <div className=\"border rounded-lg p-3 bg-green-50\">\n                <div className=\"font-medium\">{`${mergePreview.primary.firstName || ''} ${mergePreview.primary.lastName || ''}`.trim() || 'Unknown'}</div>\n                <div className=\"text-sm text-gray-600\">\n                  {mergePreview.primary.phone} • {mergePreview.primary.email}\n                </div>\n              </div>\n            </div>\n            \n            <div>\n              <h4 className=\"font-medium mb-2\">Silinecek Hastalar:</h4>\n              <div className=\"space-y-2\">\n                {mergePreview.duplicates.map(patient => (\n                  <div key={patient.id} className=\"border rounded-lg p-3 bg-red-50\">\n                    <div className=\"font-medium\">{patient.firstName} {patient.lastName}</div>\n                    <div className=\"text-sm text-gray-600\">\n                      {patient.phone} • {patient.email}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n            \n            {mergePreview.conflicts.length > 0 && (\n              <div>\n                <h4 className=\"font-medium mb-2 text-orange-600\">Çakışan Alanlar:</h4>\n                <div className=\"space-y-2\">\n                  {mergePreview.conflicts.map((conflict, index) => (\n                    <div key={index} className=\"border rounded-lg p-3 bg-orange-50\">\n                      <div className=\"font-medium capitalize\">{conflict.field}</div>\n                      <div className=\"space-y-1 mt-1\">\n                        {conflict.values.map((value, valueIndex) => (\n                          <div key={valueIndex} className=\"text-sm\">\n                            <strong>{value.patientName}:</strong> {value.value}\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n            \n            <div className=\"flex justify-end space-x-3 pt-4\">\n              <Button\n                variant=\"outline\"\n                onClick={mergeModal.closeModal}\n              >\n                İptal\n              </Button>\n              <Button\n                onClick={handleMergePatients}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                Birleştir\n              </Button>\n            </div>\n          </div>\n        )}\n      </Modal>\n    </div>\n  );\n};\n\nexport default PatientMatching;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientNotesTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onPatientUpdate' is defined but never used.","line":17,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":91},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isLoading' is assigned a value but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadNotes'. Either include it or remove the dependency array.","line":34,"column":6,"nodeType":"ArrayExpression","endLine":34,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [loadNotes, patient.id]","fix":{"range":[1470,1482],"text":"[loadNotes, patient.id]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Textarea, useToastHelpers } from '@x-ear/ui-web';\nimport { Plus, Edit, Trash2, Save, X } from 'lucide-react';\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/xEarCRMAPIAutoGenerated';\nimport type { \n  PatientSubresourcesCreatePatientNoteBody,\n  TimelineAddTimelineEventBody,\n  TimelineGetPatientTimeline200DataItem\n} from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport type { Patient, PatientNote } from '../../types/patient';\n\ninterface PatientNotesTabProps {\n  patient: Patient;\n  onPatientUpdate?: (patient: Patient) => void;\n}\n\nexport const PatientNotesTab: React.FC<PatientNotesTabProps> = ({ patient, onPatientUpdate }) => {\n  const [notes, setNotes] = useState<PatientNote[]>(patient.notes || []);\n  const [showAddForm, setShowAddForm] = useState(false);\n  const [editingNote, setEditingNote] = useState<PatientNote | null>(null);\n  const [newNoteContent, setNewNoteContent] = useState('');\n  const [editNoteContent, setEditNoteContent] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const { success, error } = useToastHelpers();\n\n  // Initialize API functions\n  const api = getXEarCRMAPIAutoGenerated();\n  const { timelineGetPatientTimeline, timelineAddTimelineEvent } = api;\n  const { patientSubresourcesCreatePatientNote, patientSubresourcesDeletePatientNote } = api;\n\n  // Load notes from API\n  useEffect(() => {\n    loadNotes();\n  }, [patient.id]);\n\n  const loadNotes = async () => {\n    try {\n      setIsLoading(true);\n      const response = await timelineGetPatientTimeline(patient.id || '');\n      \n      if (response.data?.success && response.data.data) {\n        // Filter timeline events to get only notes\n        const noteEvents = response.data.data\n          .filter((event: TimelineGetPatientTimeline200DataItem) => event.type === 'note')\n          .map((event: TimelineGetPatientTimeline200DataItem) => ({\n            id: event.id || '',\n            text: event.description || '',\n            date: event.timestamp || new Date().toISOString(),\n            author: event.user || 'system',\n            type: 'general' as const\n          }));\n        \n        setNotes(noteEvents);\n      }\n    } catch (err) {\n      error('Notlar yüklenirken hata oluştu');\n      console.error('Error loading notes:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleAddNote = async () => {\n    if (!newNoteContent.trim()) return;\n\n    try {\n      setIsLoading(true);\n\n      // Create note via patient notes API\n      const noteBody: PatientSubresourcesCreatePatientNoteBody = {\n        text: newNoteContent,\n        type: 'general',\n        author: 'current_user' // This should come from auth context\n      };\n\n      await patientSubresourcesCreatePatientNote(patient.id || '', noteBody);\n\n      // Also add to timeline\n      const timelineBody: TimelineAddTimelineEventBody = {\n        type: 'note',\n        title: 'Yeni Not Eklendi',\n        description: newNoteContent,\n        user: 'current_user', // This should come from auth context\n        category: 'general'\n      };\n\n      await timelineAddTimelineEvent(patient.id || '', timelineBody);\n\n      // Reload notes to get the updated list\n      await loadNotes();\n      \n      setNewNoteContent('');\n      setShowAddForm(false);\n      success('Not başarıyla eklendi');\n\n    } catch (err) {\n      error('Not eklenirken hata oluştu');\n      console.error('Error adding note:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleEditNote = (note: PatientNote) => {\n    setEditingNote(note);\n    setEditNoteContent(note.text);\n  };\n\n  const handleSaveEdit = async () => {\n    if (!editNoteContent.trim() || !editingNote) return;\n\n    try {\n      setIsLoading(true);\n\n      // For editing, we need to delete the old note and create a new one\n      // since the API doesn't have an update endpoint\n      await patientSubresourcesDeletePatientNote(patient.id || '', editingNote.id);\n\n      const noteBody: PatientSubresourcesCreatePatientNoteBody = {\n        text: editNoteContent,\n        type: editingNote.type || 'general',\n        author: editingNote.author\n      };\n\n      await patientSubresourcesCreatePatientNote(patient.id || '', noteBody);\n\n      // Add timeline event for the edit\n      const timelineBody: TimelineAddTimelineEventBody = {\n        type: 'note',\n        title: 'Not Güncellendi',\n        description: editNoteContent,\n        user: 'current_user',\n        category: 'general'\n      };\n\n      await timelineAddTimelineEvent(patient.id || '', timelineBody);\n\n      // Reload notes\n      await loadNotes();\n      \n      setEditingNote(null);\n      setEditNoteContent('');\n      success('Not başarıyla güncellendi');\n\n    } catch (err) {\n      error('Not güncellenirken hata oluştu');\n      console.error('Error updating note:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleDeleteNote = async (noteId: string) => {\n    try {\n      setIsLoading(true);\n      \n      await patientSubresourcesDeletePatientNote(patient.id || '', noteId);\n      \n      // Add timeline event for the deletion\n      const timelineBody: TimelineAddTimelineEventBody = {\n        type: 'note',\n        title: 'Not Silindi',\n        description: 'Bir not silindi',\n        user: 'current_user',\n        category: 'general'\n      };\n\n      await timelineAddTimelineEvent(patient.id || '', timelineBody);\n\n      // Reload notes\n      await loadNotes();\n      success('Not başarıyla silindi');\n\n    } catch (err) {\n      error('Not silinirken hata oluştu');\n      console.error('Error deleting note:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCancelEdit = () => {\n    setEditingNote(null);\n    setEditNoteContent('');\n  };\n\n  const handleCancelAdd = () => {\n    setShowAddForm(false);\n    setNewNoteContent('');\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Add Button */}\n      <div className=\"flex justify-between items-center\">\n        <h3 className=\"text-lg font-medium text-gray-900\">Hasta Notları</h3>\n        <Button\n          onClick={() => setShowAddForm(true)}\n          className=\"bg-blue-600 hover:bg-blue-700\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Not Ekle\n        </Button>\n      </div>\n\n      {/* Add Note Form */}\n      {showAddForm && (\n        <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n          <div className=\"flex justify-between items-center mb-3\">\n            <h4 className=\"font-medium text-gray-900\">Yeni Not</h4>\n            <Button\n              onClick={handleCancelAdd}\n              variant=\"ghost\"\n              size=\"sm\"\n            >\n              <X className=\"w-4 h-4\" />\n            </Button>\n          </div>\n          <Textarea\n            placeholder=\"Not içeriğini yazınız...\"\n            value={newNoteContent}\n            onChange={(e) => setNewNoteContent(e.target.value)}\n            rows={4}\n            className=\"mb-3\"\n          />\n          <div className=\"flex justify-end space-x-2\">\n            <Button onClick={handleCancelAdd} variant=\"outline\">\n              İptal\n            </Button>\n            <Button onClick={handleAddNote}>\n              <Save className=\"w-4 h-4 mr-2\" />\n              Kaydet\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {/* Notes List */}\n      <div className=\"space-y-4\">\n        {notes.length > 0 ? (\n          notes.map((note) => (\n            <div key={note.id} className=\"bg-white p-4 rounded-lg shadow-sm border\">\n              {editingNote && editingNote.id === note.id ? (\n                // Edit Mode\n                <div>\n                  <div className=\"flex justify-between items-center mb-3\">\n                    <h4 className=\"font-medium text-gray-900\">Notu Düzenle</h4>\n                    <Button\n                      onClick={handleCancelEdit}\n                      variant=\"ghost\"\n                      size=\"sm\"\n                    >\n                      <X className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                  <Textarea\n                    value={editNoteContent}\n                    onChange={(e) => setEditNoteContent(e.target.value)}\n                    rows={4}\n                    className=\"mb-3\"\n                  />\n                  <div className=\"flex justify-end space-x-2\">\n                    <Button onClick={handleCancelEdit} variant=\"outline\">\n                      İptal\n                    </Button>\n                    <Button onClick={handleSaveEdit}>\n                      <Save className=\"w-4 h-4 mr-2\" />\n                      Kaydet\n                    </Button>\n                  </div>\n                </div>\n              ) : (\n                // View Mode\n                <div>\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <p className=\"text-gray-900 whitespace-pre-wrap\">{note.text}</p>\n                    <div className=\"flex space-x-2 ml-4\">\n                      <Button\n                        onClick={() => handleEditNote(note)}\n                        variant=\"outline\"\n                        size=\"sm\"\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        onClick={() => handleDeleteNote(note.id)}\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"text-red-600 hover:text-red-800\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"text-xs text-gray-500\">\n                    {note.date ? new Date(note.date).toLocaleString('tr-TR') : ''}\n                    <span> • Yazar: {note.author}</span>\n                  </div>\n                </div>\n              )}\n            </div>\n          ))\n        ) : (\n          <div className=\"text-center py-8 text-gray-500\">\n            <p>Henüz not bulunmamaktadır.</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientOfflineStatus.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientOverviewTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onPatientUpdate' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'showTagModal' is assigned a value but never used.","line":17,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2149,2152],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2149,2152],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Patient } from '../../types/patient/patient-base.types';\nimport { User, Phone, Mail, MapPin, Tag, AlertCircle, CheckCircle, Plus, Edit, MessageSquare } from 'lucide-react';\nimport { Button } from '../ui/Button';\nimport { PatientNoteForm } from '../forms/PatientNoteForm';\n\ninterface PatientOverviewTabProps {\n  patient: Patient;\n  onPatientUpdate?: (patient: Patient) => void;\n}\n\nexport const PatientOverviewTab: React.FC<PatientOverviewTabProps> = ({\n  patient,\n  onPatientUpdate,\n}) => {\n  const [showNoteForm, setShowNoteForm] = useState(false);\n  const [showTagModal, setShowTagModal] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  if (!patient) {\n    return (\n      <div className=\"p-6 text-center\">\n        <AlertCircle className=\"w-12 h-12 text-red-400 mx-auto mb-4\" />\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Hasta Bulunamadı</h3>\n        <p className=\"text-gray-500\">Hasta bilgileri yüklenirken bir hata oluştu.</p>\n      </div>\n    );\n  }\n\n  const formatDate = (date: string | Date) => {\n    return new Date(date).toLocaleDateString('tr-TR');\n  };\n\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'active':\n        return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n      case 'inactive':\n        return <AlertCircle className=\"w-4 h-4 text-red-500\" />;\n      default:\n        return <AlertCircle className=\"w-4 h-4 text-gray-500\" />;\n    }\n  };\n\n  const getStatusText = (status?: string) => {\n    switch (status) {\n      case 'active':\n        return 'Aktif';\n      case 'inactive':\n        return 'Pasif';\n      default:\n        return 'Bilinmiyor';\n    }\n  };\n\n  const handleAddNote = () => {\n    setShowNoteForm(true);\n  };\n\n  const handleUpdateTags = () => {\n    setShowTagModal(true);\n  };\n\n  const handleSendSMS = async () => {\n    // TODO: Check SMS package availability from settings\n    // For now, show a placeholder alert\n    alert('SMS gönderme özelliği ayarlar menüsünden SMS paketi kontrolü yapılacak şekilde geliştirilecek.');\n  };\n\n  const handleNoteSave = async (noteData: any) => {\n    setIsSubmitting(true);\n    try {\n      // TODO: Implement note saving logic\n      console.log('Saving note:', noteData);\n      setShowNoteForm(false);\n    } catch (error) {\n      console.error('Note save failed:', error);\n      throw error;\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Quick Action Buttons */}\n      <div className=\"bg-white border rounded-lg shadow-sm\">\n        <div className=\"p-4 border-b\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Hızlı İşlemler</h3>\n        </div>\n        <div className=\"p-4\">\n          <div className=\"flex flex-wrap gap-3\">\n            <Button\n              onClick={handleAddNote}\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              Not Ekle\n            </Button>\n            <Button\n              onClick={handleUpdateTags}\n              className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2\"\n            >\n              <Edit className=\"w-4 h-4 mr-2\" />\n              Etiket Güncelle\n            </Button>\n            <Button\n              onClick={handleSendSMS}\n              className=\"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2\"\n            >\n              <MessageSquare className=\"w-4 h-4 mr-2\" />\n              SMS Gönder\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* Personal Information */}\n      <div className=\"bg-white border rounded-lg shadow-sm\">\n        <div className=\"p-6 border-b\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Kişisel Bilgiler</h3>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            <div className=\"flex items-center space-x-3\">\n              <User className=\"w-5 h-5 text-gray-400\" />\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">Ad Soyad</p>\n                <p className=\"text-sm text-gray-900\">{patient.firstName} {patient.lastName}</p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-3\">\n              <Phone className=\"w-5 h-5 text-gray-400\" />\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">Telefon</p>\n                <p className=\"text-sm text-gray-900\">{patient.phone || 'Belirtilmemiş'}</p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-3\">\n              <Mail className=\"w-5 h-5 text-gray-400\" />\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">E-posta</p>\n                <p className=\"text-sm text-gray-900\">{patient.email || 'Belirtilmemiş'}</p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-5 h-5 flex items-center justify-center\">\n                {getStatusBadge(patient.status)}\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">Durum</p>\n                <p className=\"text-sm text-gray-900\">{getStatusText(patient.status)}</p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-3\">\n              <Tag className=\"w-5 h-5 text-gray-400\" />\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">TC Kimlik No</p>\n                <p className=\"text-sm text-gray-900\">{patient.tcNumber || 'Belirtilmemiş'}</p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-5 h-5 text-gray-400\" />\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">Doğum Tarihi</p>\n                <p className=\"text-sm text-gray-900\">\n                  {patient.birthDate ? formatDate(patient.birthDate) : 'Belirtilmemiş'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Address Information */}\n      <div className=\"bg-white border rounded-lg shadow-sm\">\n        <div className=\"p-6 border-b\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Adres Bilgileri</h3>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"flex items-start space-x-3\">\n            <MapPin className=\"w-5 h-5 text-gray-400 mt-0.5\" />\n            <div className=\"flex-1\">\n              <p className=\"text-sm font-medium text-gray-500 mb-1\">Adres</p>\n              <p className=\"text-sm text-gray-900\">\n                {(() => {\n                  if (!patient.addressFull) {\n                    return 'Adres bilgisi bulunmuyor';\n                  }\n                  \n                  return patient.addressFull;\n                })()}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Additional Details */}\n      <div className=\"bg-white border rounded-lg shadow-sm\">\n        <div className=\"p-6 border-b\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Ek Bilgiler</h3>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"space-y-4\">\n            {patient.notes && patient.notes.length > 0 && (\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-2\">Son Notlar</p>\n                <div className=\"space-y-2\">\n                  {patient.notes.slice(0, 3).map((note) => (\n                    <div key={note.id} className=\"p-3 bg-gray-50 rounded\">\n                      <p className=\"text-sm text-gray-900\">{note.text}</p>\n                      <p className=\"text-xs text-gray-500 mt-1\">\n                        {note.author} - {formatDate(note.date)}\n                      </p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {patient.tags && patient.tags.length > 0 && (\n              <div>\n                <p className=\"text-sm font-medium text-gray-500 mb-2\">Etiketler</p>\n                <div className=\"flex flex-wrap gap-2\">\n                  {patient.tags.map((tag, index) => (\n                    <span key={index} className=\"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full\">\n                      {tag}\n                    </span>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">Kayıt Tarihi</p>\n                <p className=\"text-sm text-gray-900\">\n                  {patient.createdAt ? formatDate(patient.createdAt) : 'Bilinmiyor'}\n                </p>\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-500\">Son Güncelleme</p>\n                <p className=\"text-sm text-gray-900\">\n                  {patient.updatedAt ? formatDate(patient.updatedAt) : 'Bilinmiyor'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Note Form Modal */}\n      {showNoteForm && (\n        <PatientNoteForm\n          patientId={patient.id || ''}\n          isOpen={showNoteForm}\n          onClose={() => setShowNoteForm(false)}\n          onSave={handleNoteSave}\n          isLoading={isSubmitting}\n        />\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientSGKTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Trash2' is defined but never used.","line":4,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":60},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Plus' is defined but never used.","line":4,"column":95,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":99},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'X' is defined but never used.","line":4,"column":101,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":102},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useProcessSgkOcr' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useTriggerSgkProcessing' is defined but never used.","line":7,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":51},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":64,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":69,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onPatientUpdate' is defined but never used.","line":86,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":87},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3960,3963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3960,3963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'uploadResult' is assigned a value but never used.","line":156,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":156,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":170,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6414,6417],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6414,6417],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":204,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7344,7347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7344,7347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":222,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7843,7846],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7843,7846],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":302,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":312,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":319,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":324,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":331,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":337,"endColumn":15}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Input, Badge } from '@x-ear/ui-web';\nimport { useToastHelpers } from '@x-ear/ui-web';\nimport { FileText, Download, Eye, RefreshCw, Upload, Trash2, AlertCircle, CheckCircle, Clock, Plus, X, Loader2, Shield, CreditCard, Calendar } from 'lucide-react';\nimport { Patient } from '../../types/patient/patient-base.types';\nimport { SGKDocument, SGKDocumentType } from '../../types/sgk';\nimport { useProcessSgkOcr, useTriggerSgkProcessing } from '../../hooks/sgk/useSgk';\nimport sgkService from '../../services/sgk/sgk.service';\n\ninterface PatientSGKTabProps {\n  patient: Patient;\n  onPatientUpdate?: (patient: Patient) => void;\n}\n\n// Loading Spinner Component\nconst LoadingSpinner: React.FC<{ size?: 'sm' | 'md' | 'lg' }> = ({ size = 'md' }) => {\n  const sizeClasses = {\n    sm: 'w-4 h-4',\n    md: 'w-6 h-6',\n    lg: 'w-8 h-8'\n  };\n  \n  return (\n    <Loader2 className={`${sizeClasses[size]} animate-spin text-blue-600`} />\n  );\n};\n\n// Status Badge Component\nconst StatusBadge: React.FC<{ status: string; className?: string }> = ({ status, className = '' }) => {\n  const getStatusConfig = (status: string) => {\n    switch (status) {\n      case 'approved':\n        return { color: 'bg-green-100 text-green-800', icon: CheckCircle, text: 'Onaylandı' };\n      case 'pending':\n        return { color: 'bg-yellow-100 text-yellow-800', icon: Clock, text: 'Beklemede' };\n      case 'rejected':\n        return { color: 'bg-red-100 text-red-800', icon: AlertCircle, text: 'Reddedildi' };\n      case 'processing':\n        return { color: 'bg-blue-100 text-blue-800', icon: RefreshCw, text: 'İşleniyor' };\n      default:\n        return { color: 'bg-gray-100 text-gray-800', icon: AlertCircle, text: 'Bilinmiyor' };\n    }\n  };\n\n  const config = getStatusConfig(status);\n  const Icon = config.icon;\n\n  return (\n    <Badge className={`${config.color} ${className} inline-flex items-center gap-1`}>\n      <Icon className=\"w-3 h-3\" />\n      {config.text}\n    </Badge>\n  );\n};\n\n// Error Message Component\nconst ErrorMessage: React.FC<{ message: string; onRetry?: () => void }> = ({ message, onRetry }) => (\n  <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n    <div className=\"flex items-start\">\n      <AlertCircle className=\"w-5 h-5 text-red-600 mt-0.5 mr-3 flex-shrink-0\" />\n      <div className=\"flex-1\">\n        <p className=\"text-sm text-red-800\">{message}</p>\n        {onRetry && (\n          <button\n            onClick={onRetry}\n            className=\"mt-2 text-sm text-red-600 hover:text-red-800 underline\"\n          >\n            Tekrar Dene\n          </button>\n        )}\n      </div>\n    </div>\n  </div>\n);\n\n// Success Message Component\nconst SuccessMessage: React.FC<{ message: string }> = ({ message }) => (\n  <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n    <div className=\"flex items-center\">\n      <CheckCircle className=\"w-5 h-5 text-green-600 mr-3\" />\n      <p className=\"text-sm text-green-800\">{message}</p>\n    </div>\n  </div>\n);\n\nexport const PatientSGKTab: React.FC<PatientSGKTabProps> = ({ patient, onPatientUpdate }) => {\n  const { success: showSuccess, error: showError } = useToastHelpers();\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [documentType, setDocumentType] = useState<SGKDocumentType>('rapor');\n  const [uploadNotes, setUploadNotes] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [documentsLoading, setDocumentsLoading] = useState(false);\n  const [sgkDocuments, setSgkDocuments] = useState<SGKDocument[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const [eReceiptNo, setEReceiptNo] = useState('');\n  const [isQuerying, setIsQuerying] = useState(false);\n  const [isQueryingReport, setIsQueryingReport] = useState(false);\n  const [eReceiptData, setEReceiptData] = useState<any>(null);\n\n  // Safe access to patient data with fallbacks\n  const sgkData = patient?.sgkInfo || {};\n  const patientId = patient?.id || '';\n  const sgkStatus = patient?.status || 'pending';\n  \n  // Enhanced SGK data with fallbacks\n  const reportDate = String(sgkData.approvalDate || '05 Ocak 2024');\n  const reportNo = String(sgkData.approvalNumber || `SGK-2024-${patientId.slice(-6) || '001234'}`);\n  const validityPeriod = sgkData.expiryDate && sgkData.expiryDate !== '' ? \n    Math.ceil((new Date(String(sgkData.expiryDate)).getTime() - new Date().getTime()) / (1000 * 60 * 60 * 24 * 365)) + ' Yıl' : \n    '2 Yıl';\n  const contributionAmount = 1500; // This should come from business logic\n  const sgkCoverage = Math.round((typeof sgkData.coveragePercentage === 'number' ? sgkData.coveragePercentage : 0.85) * contributionAmount);\n\n  // Clear messages after 5 seconds\n  useEffect(() => {\n    if (error || successMessage) {\n      const timer = setTimeout(() => {\n        setError(null);\n        setSuccessMessage(null);\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [error, successMessage]);\n\n  const loadSgkDocuments = async () => {\n    if (!patientId) return;\n    \n    setDocumentsLoading(true);\n    try {\n      // TODO: Fix SGK service response type\n      // const documents = await sgkService.listDocuments(patientId);\n      setSgkDocuments([]); // Mock data for now\n    } catch (error) {\n      console.error('Error loading SGK documents:', error);\n      setError('SGK belgeleri yüklenirken hata oluştu');\n    } finally {\n      setDocumentsLoading(false);\n    }\n  };\n\n  const handleFileUpload = async () => {\n    if (!selectedFile || !patientId) return;\n\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      // 1. Belgeyi yükle\n      const formData = new FormData();\n      formData.append('file', selectedFile);\n      formData.append('patientId', patientId);\n      formData.append('documentType', documentType);\n      if (uploadNotes) formData.append('notes', uploadNotes);\n\n      const uploadResult = await sgkService.uploadDocument(formData, {\n        idempotencyKey: `sgk-upload-${patientId}-${Date.now()}`\n      });\n\n      showSuccess('Başarılı', 'SGK belgesi başarıyla yüklendi');\n      setSuccessMessage('SGK belgesi başarıyla yüklendi');\n\n      // Reset form\n      setSelectedFile(null);\n      setUploadNotes('');\n      \n      // Reload documents\n      await loadSgkDocuments();\n      \n    } catch (error: any) {\n      const errorMessage = error?.message || 'Belge yükleme sırasında hata oluştu';\n      showError('Hata', errorMessage);\n      setError(errorMessage);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleEReceiptQuery = async () => {\n    if (!eReceiptNo.trim()) {\n      setError('E-Reçete numarası gerekli');\n      return;\n    }\n\n    setIsQuerying(true);\n    setError(null);\n    \n    try {\n      // Mock e-receipt query\n      const mockData = {\n        receiptNo: eReceiptNo,\n        patientName: patient.firstName + ' ' + patient.lastName,\n        date: new Date().toLocaleDateString('tr-TR'),\n        totalAmount: 150.75,\n        items: [\n          { name: 'İlaç A', quantity: 1, price: 75.50 },\n          { name: 'İlaç B', quantity: 2, price: 37.625 }\n        ]\n      };\n      \n      setEReceiptData(mockData);\n      setSuccessMessage('E-Reçete bilgileri başarıyla alındı');\n      \n    } catch (error: any) {\n      const errorMessage = error?.message || 'E-Reçete sorgulanırken hata oluştu';\n      showError('Hata', errorMessage);\n      setError(errorMessage);\n    } finally {\n      setIsQuerying(false);\n    }\n  };\n\n  const handleReportQuery = async () => {\n    setIsQueryingReport(true);\n    setError(null);\n    \n    try {\n      // Mock report query\n      showSuccess('Başarılı', 'Hasta hakları sorgulandı');\n      setSuccessMessage('Hasta hakları başarıyla sorgulandı');\n      \n    } catch (error: any) {\n      const errorMessage = error?.message || 'Hasta hakları sorgulanırken hata oluştu';\n      showError('Hata', errorMessage);\n      setError(errorMessage);\n    } finally {\n      setIsQueryingReport(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Error and Success Messages */}\n      {error && <ErrorMessage message={error} onRetry={() => setError(null)} />}\n      {successMessage && <SuccessMessage message={successMessage} />}\n\n      {/* SGK Status Overview */}\n      <div className=\"bg-white rounded-lg border p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n            <Shield className=\"w-5 h-5 mr-2 text-blue-600\" />\n            SGK Durumu\n          </h3>\n          <StatusBadge status={sgkStatus} />\n        </div>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          <div className=\"bg-blue-50 rounded-lg p-4\">\n            <div className=\"flex items-center\">\n              <Calendar className=\"w-5 h-5 text-blue-600 mr-2\" />\n              <div>\n                <p className=\"text-sm text-blue-600 font-medium\">Rapor Tarihi</p>\n                <p className=\"text-lg font-semibold text-blue-900\">{reportDate || 'N/A'}</p>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"bg-green-50 rounded-lg p-4\">\n            <div className=\"flex items-center\">\n              <FileText className=\"w-5 h-5 text-green-600 mr-2\" />\n              <div>\n                <p className=\"text-sm text-green-600 font-medium\">Rapor No</p>\n                <p className=\"text-lg font-semibold text-green-900\">{reportNo || 'N/A'}</p>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"bg-purple-50 rounded-lg p-4\">\n            <div className=\"flex items-center\">\n              <Clock className=\"w-5 h-5 text-purple-600 mr-2\" />\n              <div>\n                <p className=\"text-sm text-purple-600 font-medium\">Geçerlilik</p>\n                <p className=\"text-lg font-semibold text-purple-900\">{validityPeriod}</p>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"bg-orange-50 rounded-lg p-4\">\n            <div className=\"flex items-center\">\n              <CreditCard className=\"w-5 h-5 text-orange-600 mr-2\" />\n              <div>\n                <p className=\"text-sm text-orange-600 font-medium\">SGK Karşılama</p>\n                <p className=\"text-lg font-semibold text-orange-900\">₺{sgkCoverage}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* File Upload Section */}\n      <div className=\"bg-white rounded-lg border p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <Upload className=\"w-5 h-5 mr-2 text-blue-600\" />\n          Belge Yükleme\n        </h3>\n        \n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Belge Türü\n            </label>\n            <select\n              value={documentType}\n              onChange={(e) => setDocumentType(e.target.value as SGKDocumentType)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"rapor\">Rapor</option>\n              <option value=\"recete\">Reçete</option>\n              <option value=\"tahlil\">Tahlil</option>\n              <option value=\"goruntu\">Görüntüleme</option>\n              <option value=\"diger\">Diğer</option>\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Dosya Seç\n            </label>\n            <input\n              type=\"file\"\n              accept=\".pdf,.jpg,.jpeg,.png\"\n              onChange={(e) => setSelectedFile(e.target.files?.[0] || null)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Notlar (Opsiyonel)\n            </label>\n            <textarea\n              value={uploadNotes}\n              onChange={(e) => setUploadNotes(e.target.value)}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Belge hakkında notlar...\"\n            />\n          </div>\n          \n          <Button\n            onClick={handleFileUpload}\n            disabled={!selectedFile || isLoading}\n            className=\"w-full\"\n          >\n            {isLoading ? (\n              <>\n                <LoadingSpinner size=\"sm\" />\n                <span className=\"ml-2\">Yükleniyor...</span>\n              </>\n            ) : (\n              <>\n                <Upload className=\"w-4 h-4 mr-2\" />\n                Belgeyi Yükle\n              </>\n            )}\n          </Button>\n        </div>\n      </div>\n\n      {/* E-Receipt Query Section */}\n      <div className=\"bg-white rounded-lg border p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <FileText className=\"w-5 h-5 mr-2 text-green-600\" />\n          E-Reçete Sorgulama\n        </h3>\n        \n        <div className=\"flex gap-4\">\n          <Input\n            value={eReceiptNo}\n            onChange={(e) => setEReceiptNo(e.target.value)}\n            placeholder=\"E-Reçete numarasını girin\"\n            className=\"flex-1\"\n          />\n          <Button\n            onClick={handleEReceiptQuery}\n            disabled={isQuerying}\n            variant=\"outline\"\n          >\n            {isQuerying ? (\n              <>\n                <LoadingSpinner size=\"sm\" />\n                <span className=\"ml-2\">Sorgulanıyor...</span>\n              </>\n            ) : (\n              'Sorgula'\n            )}\n          </Button>\n        </div>\n        \n        {eReceiptData && (\n          <div className=\"mt-4 p-4 bg-green-50 rounded-lg\">\n            <h4 className=\"font-medium text-green-900 mb-2\">E-Reçete Bilgileri</h4>\n            <div className=\"space-y-2 text-sm\">\n              <p><span className=\"font-medium\">Reçete No:</span> {eReceiptData.receiptNo}</p>\n              <p><span className=\"font-medium\">Hasta:</span> {eReceiptData.patientName}</p>\n              <p><span className=\"font-medium\">Tarih:</span> {eReceiptData.date}</p>\n              <p><span className=\"font-medium\">Toplam Tutar:</span> ₺{eReceiptData.totalAmount}</p>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Patient Rights Query Section */}\n      <div className=\"bg-white rounded-lg border p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n          <Shield className=\"w-5 h-5 mr-2 text-purple-600\" />\n          Hasta Hakları Sorgulama\n        </h3>\n        \n        <Button\n          onClick={handleReportQuery}\n          disabled={isQueryingReport}\n          variant=\"outline\"\n          className=\"w-full\"\n        >\n          {isQueryingReport ? (\n            <>\n              <LoadingSpinner size=\"sm\" />\n              <span className=\"ml-2\">Sorgulanıyor...</span>\n            </>\n          ) : (\n            'Hasta Haklarını Sorgula'\n          )}\n        </Button>\n      </div>\n\n      {/* Documents List */}\n      <div className=\"bg-white rounded-lg border p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n            <FileText className=\"w-5 h-5 mr-2 text-gray-600\" />\n            SGK Belgeleri\n          </h3>\n          <Button\n            onClick={loadSgkDocuments}\n            disabled={documentsLoading}\n            variant=\"outline\"\n            size=\"sm\"\n          >\n            {documentsLoading ? (\n              <LoadingSpinner size=\"sm\" />\n            ) : (\n              <RefreshCw className=\"w-4 h-4\" />\n            )}\n          </Button>\n        </div>\n        \n        {sgkDocuments.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500\">\n            <FileText className=\"w-12 h-12 mx-auto mb-4 text-gray-300\" />\n            <p>Henüz yüklenmiş SGK belgesi bulunmuyor.</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {sgkDocuments.map((doc) => (\n              <div key={doc.id} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                <div className=\"flex items-center\">\n                  <FileText className=\"w-5 h-5 text-gray-600 mr-3\" />\n                  <div>\n                    <p className=\"font-medium text-gray-900\">{doc.filename}</p>\n                    <p className=\"text-sm text-gray-500\">\n                      {doc.documentType} • {new Date(doc.uploadedAt).toLocaleDateString('tr-TR')}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <Button size=\"sm\" variant=\"outline\">\n                    <Eye className=\"w-4 h-4\" />\n                  </Button>\n                  <Button size=\"sm\" variant=\"outline\">\n                    <Download className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientSalesTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2378,2381],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2378,2381],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2516,2519],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2516,2519],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSGKPatientInfo'. Either include it or remove the dependency array.","line":53,"column":6,"nodeType":"ArrayExpression","endLine":53,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [loadSGKPatientInfo, patient.id]","fix":{"range":[2739,2751],"text":"[loadSGKPatientInfo, patient.id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3357,3360],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3357,3360],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'mockSales' array makes the dependencies of useMemo Hook (at line 243) change on every render. To fix this, wrap the initialization of 'mockSales' in its own useMemo() Hook.","line":198,"column":9,"nodeType":"VariableDeclarator","endLine":223,"endColumn":4},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'mockSales' array makes the dependencies of useMemo Hook (at line 340) change on every render. To fix this, wrap the initialization of 'mockSales' in its own useMemo() Hook.","line":198,"column":9,"nodeType":"VariableDeclarator","endLine":223,"endColumn":4},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'calculateSaleWithSGK' is assigned a value but never used.","line":246,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":246,"endColumn":29},{"ruleId":"prefer-const","severity":2,"message":"'filtered' is never reassigned. Use 'const' instead.","line":269,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":269,"endColumn":17,"fix":{"range":[10084,11935],"text":"const filtered = mockSales.filter((sale: Sale) => {\n      // Date filter\n      if (dateFilter !== 'all') {\n        const saleDate = new Date(sale.saleDate || '');\n        const now = new Date();\n        \n        switch (dateFilter) {\n          case 'today':\n            const today = new Date();\n            today.setHours(0, 0, 0, 0);\n            const tomorrow = new Date(today);\n            tomorrow.setDate(tomorrow.getDate() + 1);\n            if (saleDate < today || saleDate >= tomorrow) return false;\n            break;\n          case 'week':\n            const weekAgo = new Date();\n            weekAgo.setDate(weekAgo.getDate() - 7);\n            if (saleDate < weekAgo) return false;\n            break;\n          case 'month':\n            if (saleDate.getMonth() !== now.getMonth() || saleDate.getFullYear() !== now.getFullYear()) return false;\n            break;\n          case 'year':\n            if (saleDate.getFullYear() !== now.getFullYear()) return false;\n            break;\n        }\n      }\n\n      // Search term filter\n      if (searchTerm) {\n        const searchLower = searchTerm.toLowerCase();\n        const matchesNotes = sale.notes?.toLowerCase().includes(searchLower);\n        const matchesAmount = sale.totalAmount?.toString().includes(searchTerm);\n        if (!matchesNotes && !matchesAmount) return false;\n      }\n\n      // Status filter\n      if (statusFilter !== 'all' && sale.status !== statusFilter) return false;\n\n      // Payment method filter\n      if (paymentMethodFilter !== 'all' && sale.paymentMethod !== paymentMethodFilter) return false;\n\n      // Amount range filter\n      if (amountRangeMin && sale.totalAmount && sale.totalAmount < parseFloat(amountRangeMin)) return false;\n      if (amountRangeMax && sale.totalAmount && sale.totalAmount > parseFloat(amountRangeMax)) return false;\n\n      return true;\n    });"}},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":277,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":277,"endColumn":38},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":279,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":279,"endColumn":46},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":284,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":284,"endColumn":40},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":324,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":324,"endColumn":62},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":325,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":325,"endColumn":62},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleNewSale' is assigned a value but never used.","line":347,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":347,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":347,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":347,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12854,12857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12854,12857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleEditSale' is assigned a value but never used.","line":368,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":368,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleDeleteSale' is assigned a value but never used.","line":373,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":373,"endColumn":25},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":626,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":636,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":638,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":648,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":650,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":660,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":694,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":702,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":758,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":769,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":831,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":842,"endColumn":25},{"ruleId":"no-extra-semi","severity":2,"message":"Unnecessary semicolon.","line":1014,"column":2,"nodeType":"EmptyStatement","messageId":"unexpected","endLine":1014,"endColumn":3,"fix":{"range":[39798,39808],"text":"}\n\nexport"}}],"suppressedMessages":[],"errorCount":21,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useMemo, useEffect } from 'react';\nimport { Button, Badge, Card, CardContent, CardHeader, CardTitle, Input } from '@x-ear/ui-web';\nimport { Plus, DollarSign, Edit, FileText, Search, Filter, Download, Printer, ChevronUp, ChevronDown, Shield, CheckCircle, AlertCircle, Clock } from 'lucide-react';\nimport { Patient } from '../../types/patient/patient-base.types';\nimport { Sale as APISale } from '../../api/generated/api';\nimport { Sale } from '../../types/patient/patient-communication.types';\nimport SaleModal from './modals/SaleModal';\nimport CollectionModal from './modals/CollectionModal';\nimport PromissoryNoteModal from './modals/PromissoryNoteModal';\nimport EditSaleModal from './modals/EditSaleModal';\nimport ReturnExchangeModal from './modals/ReturnExchangeModal';\nimport ProformaModal from './modals/ProformaModal';\nimport { sgkService } from '../../services/sgk.service';\nimport { useToastHelpers } from '@x-ear/ui-web';\n\ninterface PatientSalesTabProps {\n  patient: Patient;\n}\n\nexport default function PatientSalesTab({ patient }: PatientSalesTabProps) {\n  const [dateFilter, setDateFilter] = useState('all');\n  const [showNewSaleModal, setShowNewSaleModal] = useState(false);\n  const [showCollectionModal, setShowCollectionModal] = useState(false);\n  const [showPromissoryNoteModal, setShowPromissoryNoteModal] = useState(false);\n  const [showEditSaleModal, setShowEditSaleModal] = useState(false);\n  const [showReturnExchangeModal, setShowReturnExchangeModal] = useState(false);\n  const [showProformaModal, setShowProformaModal] = useState(false);\n  const [selectedSale, setSelectedSale] = useState<Sale | undefined>(undefined);\n  \n  // Advanced filtering states\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [paymentMethodFilter, setPaymentMethodFilter] = useState('all');\n  const [amountRangeMin, setAmountRangeMin] = useState('');\n  const [amountRangeMax, setAmountRangeMax] = useState('');\n  const [sortBy, setSortBy] = useState<'date' | 'amount' | 'status'>('date');\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\n  const [selectedSales, setSelectedSales] = useState<string[]>([]);\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n\n  // SGK Integration States\n  const [sgkPatientInfo, setSgkPatientInfo] = useState<any>(null);\n  const [sgkLoading, setSgkLoading] = useState(false);\n  const [sgkCoverageCalculation, setSgkCoverageCalculation] = useState<any>(null);\n\n  const { success: showSuccessToast, error: showErrorToast } = useToastHelpers();\n\n  // Load SGK patient info on component mount\n  useEffect(() => {\n    if (patient.id) {\n      loadSGKPatientInfo();\n    }\n  }, [patient.id]);\n\n  const loadSGKPatientInfo = async () => {\n    if (!patient.id) return;\n    \n    setSgkLoading(true);\n    try {\n      const sgkInfo = await sgkService.getPatientSGKInfo(patient.id);\n      setSgkPatientInfo(sgkInfo);\n      \n      // Calculate SGK coverage for potential sales\n      if (sgkInfo?.hasInsurance) {\n        calculateSGKCoverage(sgkInfo);\n      }\n    } catch (error) {\n      console.error('Error loading SGK patient info:', error);\n      showErrorToast('SGK bilgileri yüklenirken hata oluştu');\n    } finally {\n      setSgkLoading(false);\n    }\n  };\n\n  const calculateSGKCoverage = (sgkInfo: any) => {\n    // Calculate SGK coverage based on patient's entitlements\n    const deviceCoverage = sgkInfo.deviceEntitlement?.hasEntitlement \n      ? {\n          maxCoverage: 15000, // Example max SGK coverage for hearing aids\n          coveragePercentage: sgkInfo.coveragePercentage || 80,\n          remainingEntitlement: sgkInfo.deviceEntitlement.remainingQuantity || 0\n        }\n      : null;\n\n    const batteryCoverage = sgkInfo.batteryEntitlement?.hasEntitlement\n      ? {\n          maxCoverage: 500, // Example max SGK coverage for batteries\n          coveragePercentage: 100,\n          remainingEntitlement: sgkInfo.batteryEntitlement.remainingQuantity || 0\n        }\n      : null;\n\n    setSgkCoverageCalculation({\n      deviceCoverage,\n      batteryCoverage,\n      totalCoveragePercentage: sgkInfo.coveragePercentage || 0\n    });\n  };\n\n  const handleQueryPatientRights = async () => {\n    if (!patient.id) return;\n    \n    setSgkLoading(true);\n    try {\n      const rightsData = await sgkService.queryPatientRights(patient.id);\n      setSgkPatientInfo(rightsData);\n      showSuccessToast('Hasta hakları başarıyla sorgulandı');\n      \n      // Recalculate coverage with updated info\n      if (rightsData?.hasInsurance) {\n        calculateSGKCoverage(rightsData);\n      }\n    } catch (error) {\n      console.error('Error querying patient rights:', error);\n      showErrorToast('Hasta hakları sorgulanırken hata oluştu');\n    } finally {\n      setSgkLoading(false);\n    }\n  };\n\n  // Export and Print functions\n  const handleExportSales = (salesData: Sale[]) => {\n    const csvContent = [\n      ['Tarih', 'Tutar', 'Ödeme Yöntemi', 'Durum', 'Notlar'].join(','),\n      ...salesData.map(sale => [\n        sale.saleDate ? new Date(sale.saleDate).toLocaleDateString('tr-TR') : '-',\n        `${sale.totalAmount} TL`,\n        getPaymentMethodText(sale.paymentMethod),\n        sale.status,\n        sale.notes || '-'\n      ].join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', `satislar_${new Date().toISOString().split('T')[0]}.csv`);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const handlePrintSales = (salesData: Sale[]) => {\n    const printContent = `\n      <html>\n        <head>\n          <title>Satış Listesi</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f2f2f2; }\n            .header { text-align: center; margin-bottom: 20px; }\n          </style>\n        </head>\n        <body>\n          <div class=\"header\">\n            <h2>Satış Listesi - ${patient.firstName} ${patient.lastName}</h2>\n            <p>Yazdırma Tarihi: ${new Date().toLocaleDateString('tr-TR')}</p>\n          </div>\n          <table>\n            <thead>\n              <tr>\n                <th>Tarih</th>\n                <th>Tutar</th>\n                <th>Ödeme Yöntemi</th>\n                <th>Durum</th>\n                <th>Notlar</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${salesData.map(sale => `\n                <tr>\n                  <td>${sale.saleDate ? new Date(sale.saleDate).toLocaleDateString('tr-TR') : '-'}</td>\n                  <td>${sale.totalAmount} TL</td>\n                  <td>${getPaymentMethodText(sale.paymentMethod)}</td>\n                  <td>${sale.status}</td>\n                  <td>${sale.notes || '-'}</td>\n                </tr>\n              `).join('')}\n            </tbody>\n          </table>\n        </body>\n      </html>\n    `;\n\n    const printWindow = window.open('', '_blank');\n    if (printWindow) {\n      printWindow.document.write(printContent);\n      printWindow.document.close();\n      printWindow.print();\n    }\n  };\n\n  // Mock sales data - in real app, this would come from API\n  const mockSales: Sale[] = [\n    {\n      id: '1',\n      patientId: patient.id || '',\n      saleDate: '2024-01-15',\n      totalAmount: 15000,\n      listPriceTotal: 18000,\n      discountAmount: 3000,\n      sgkCoverage: 8000,\n      paymentMethod: 'card',\n      status: 'paid',\n      notes: 'Sol kulak işitme cihazı satışı'\n    },\n    {\n      id: '2', \n      patientId: patient.id || '',\n      saleDate: '2024-02-20',\n      totalAmount: 12000,\n      listPriceTotal: 15000,\n      discountAmount: 3000,\n      sgkCoverage: 6000,\n      paymentMethod: 'cash',\n      status: 'confirmed',\n      notes: 'Sağ kulak işitme cihazı satışı'\n    }\n  ];\n\n\n  // Sales summary calculations\n  const salesSummary = useMemo(() => {\n    const totalSales = mockSales.reduce((sum: number, sale: Sale) => sum + (sale.totalAmount || 0), 0);\n    const totalSGKCoverage = mockSales.reduce((sum: number, sale: Sale) => sum + (sale.sgkCoverage || 0), 0);\n    const totalPaid = mockSales.reduce((sum: number, sale: Sale) => {\n      const payments = sale.payments?.reduce((paymentSum, payment) => paymentSum + payment.amount, 0) || 0;\n      return sum + payments;\n    }, 0);\n    const totalPending = totalSales - totalPaid;\n\n    return { \n      totalSales, \n      totalPaid, \n      totalPending, \n      totalSGKCoverage,\n      patientPayment: totalSales - totalSGKCoverage\n    };\n  }, [mockSales]);\n\n  // Calculate SGK coverage for a specific sale amount\n  const calculateSaleWithSGK = (saleAmount: number, productType: 'device' | 'battery' | 'other' = 'device') => {\n    if (!sgkCoverageCalculation) return { sgkCoverage: 0, patientPayment: saleAmount };\n\n    let sgkCoverage = 0;\n    \n    if (productType === 'device' && sgkCoverageCalculation.deviceCoverage) {\n      const maxCoverage = sgkCoverageCalculation.deviceCoverage.maxCoverage;\n      const coveragePercentage = sgkCoverageCalculation.deviceCoverage.coveragePercentage / 100;\n      sgkCoverage = Math.min(saleAmount * coveragePercentage, maxCoverage);\n    } else if (productType === 'battery' && sgkCoverageCalculation.batteryCoverage) {\n      const maxCoverage = sgkCoverageCalculation.batteryCoverage.maxCoverage;\n      const coveragePercentage = sgkCoverageCalculation.batteryCoverage.coveragePercentage / 100;\n      sgkCoverage = Math.min(saleAmount * coveragePercentage, maxCoverage);\n    }\n\n    return {\n      sgkCoverage: Math.round(sgkCoverage),\n      patientPayment: Math.round(saleAmount - sgkCoverage)\n    };\n  };\n\n  // Filter and sort sales based on all criteria\n  const filteredSales = useMemo(() => {\n    let filtered = mockSales.filter((sale: Sale) => {\n      // Date filter\n      if (dateFilter !== 'all') {\n        const saleDate = new Date(sale.saleDate || '');\n        const now = new Date();\n        \n        switch (dateFilter) {\n          case 'today':\n            const today = new Date();\n            today.setHours(0, 0, 0, 0);\n            const tomorrow = new Date(today);\n            tomorrow.setDate(tomorrow.getDate() + 1);\n            if (saleDate < today || saleDate >= tomorrow) return false;\n            break;\n          case 'week':\n            const weekAgo = new Date();\n            weekAgo.setDate(weekAgo.getDate() - 7);\n            if (saleDate < weekAgo) return false;\n            break;\n          case 'month':\n            if (saleDate.getMonth() !== now.getMonth() || saleDate.getFullYear() !== now.getFullYear()) return false;\n            break;\n          case 'year':\n            if (saleDate.getFullYear() !== now.getFullYear()) return false;\n            break;\n        }\n      }\n\n      // Search term filter\n      if (searchTerm) {\n        const searchLower = searchTerm.toLowerCase();\n        const matchesNotes = sale.notes?.toLowerCase().includes(searchLower);\n        const matchesAmount = sale.totalAmount?.toString().includes(searchTerm);\n        if (!matchesNotes && !matchesAmount) return false;\n      }\n\n      // Status filter\n      if (statusFilter !== 'all' && sale.status !== statusFilter) return false;\n\n      // Payment method filter\n      if (paymentMethodFilter !== 'all' && sale.paymentMethod !== paymentMethodFilter) return false;\n\n      // Amount range filter\n      if (amountRangeMin && sale.totalAmount && sale.totalAmount < parseFloat(amountRangeMin)) return false;\n      if (amountRangeMax && sale.totalAmount && sale.totalAmount > parseFloat(amountRangeMax)) return false;\n\n      return true;\n    });\n\n    // Sort filtered results\n    filtered.sort((a, b) => {\n      let comparison = 0;\n      \n      switch (sortBy) {\n        case 'date':\n          const dateA = new Date(a.saleDate || '').getTime();\n          const dateB = new Date(b.saleDate || '').getTime();\n          comparison = dateA - dateB;\n          break;\n        case 'amount':\n          comparison = (a.totalAmount || 0) - (b.totalAmount || 0);\n          break;\n        case 'status':\n          comparison = (a.status || '').localeCompare(b.status || '');\n          break;\n      }\n      \n      return sortOrder === 'asc' ? comparison : -comparison;\n    });\n\n    return filtered;\n  }, [mockSales, dateFilter, searchTerm, statusFilter, paymentMethodFilter, amountRangeMin, amountRangeMax, sortBy, sortOrder]);\n\n  // Placeholder functions for actions\n  const handleCreateSale = () => {\n    setShowNewSaleModal(true);\n  };\n\n  const handleNewSale = (saleData: any) => {\n    console.log('Creating new sale:', saleData);\n    // TODO: Implement API call to create sale\n    setShowNewSaleModal(false);\n  };\n\n  const handleCollectionClick = (sale: Sale) => {\n    setSelectedSale(sale);\n    setShowCollectionModal(true);\n  };\n\n  const handlePromissoryNoteClick = (sale: Sale) => {\n    setSelectedSale(sale);\n    setShowPromissoryNoteModal(true);\n  };\n\n  const handleEditSaleClick = (sale: Sale) => {\n    setSelectedSale(sale);\n    setShowEditSaleModal(true);\n  };\n\n  const handleEditSale = (saleId: string) => {\n    console.log('Editing sale:', saleId);\n    // TODO: Implement edit sale functionality\n  };\n\n  const handleDeleteSale = (saleId: string) => {\n    console.log('Deleting sale:', saleId);\n    // TODO: Implement delete sale functionality\n  };\n\n  // Utility functions\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'completed':\n        return <Badge variant=\"default\" className=\"bg-green-100 text-green-800\">Tamamlandı</Badge>;\n      case 'pending':\n        return <Badge variant=\"secondary\" className=\"bg-yellow-100 text-yellow-800\">Beklemede</Badge>;\n      case 'cancelled':\n        return <Badge variant=\"danger\">İptal Edildi</Badge>;\n      default:\n        return <Badge variant=\"secondary\">Bilinmiyor</Badge>;\n    }\n  };\n\n  const getPaymentMethodText = (method?: string) => {\n    switch (method) {\n      case 'cash':\n        return 'Nakit';\n      case 'credit_card':\n        return 'Kredi Kartı';\n      case 'bank_transfer':\n        return 'Banka Havalesi';\n      case 'installment':\n        return 'Taksit';\n      default:\n        return method || 'Belirtilmemiş';\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* SGK Patient Info Card */}\n      {sgkPatientInfo && (\n        <Card className=\"border-blue-200 bg-blue-50\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"flex items-center text-blue-800\">\n                <Shield className=\"w-5 h-5 mr-2\" />\n                SGK Bilgileri\n              </CardTitle>\n              <Button \n                onClick={handleQueryPatientRights}\n                disabled={sgkLoading}\n                size=\"sm\"\n                variant=\"outline\"\n                className=\"border-blue-300 text-blue-700 hover:bg-blue-100\"\n              >\n                {sgkLoading ? <Clock className=\"w-4 h-4 mr-2 animate-spin\" /> : <Search className=\"w-4 h-4 mr-2\" />}\n                Hakları Sorgula\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div>\n                <p className=\"text-sm font-medium text-blue-700\">Sigorta Durumu</p>\n                <div className=\"flex items-center mt-1\">\n                  {sgkPatientInfo.hasInsurance ? (\n                    <>\n                      <CheckCircle className=\"w-4 h-4 text-green-600 mr-1\" />\n                      <span className=\"text-green-700 font-medium\">Aktif</span>\n                    </>\n                  ) : (\n                    <>\n                      <AlertCircle className=\"w-4 h-4 text-red-600 mr-1\" />\n                      <span className=\"text-red-700 font-medium\">Pasif</span>\n                    </>\n                  )}\n                </div>\n              </div>\n              \n              {sgkPatientInfo.deviceEntitlement && (\n                <div>\n                  <p className=\"text-sm font-medium text-blue-700\">Cihaz Hakkı</p>\n                  <p className=\"text-sm text-gray-600\">\n                    Kalan: {sgkPatientInfo.deviceEntitlement.remainingQuantity} / {sgkPatientInfo.deviceEntitlement.maxQuantity}\n                  </p>\n                  <p className=\"text-xs text-gray-500\">\n                    Geçerlilik: {new Date(sgkPatientInfo.deviceEntitlement.validUntil).toLocaleDateString('tr-TR')}\n                  </p>\n                </div>\n              )}\n              \n              {sgkPatientInfo.batteryEntitlement && (\n                <div>\n                  <p className=\"text-sm font-medium text-blue-700\">Pil Hakkı</p>\n                  <p className=\"text-sm text-gray-600\">\n                    Kalan: {sgkPatientInfo.batteryEntitlement.remainingQuantity} / {sgkPatientInfo.batteryEntitlement.maxQuantity}\n                  </p>\n                  <p className=\"text-xs text-gray-500\">\n                    Geçerlilik: {new Date(sgkPatientInfo.batteryEntitlement.validUntil).toLocaleDateString('tr-TR')}\n                  </p>\n                </div>\n              )}\n            </div>\n            \n            {sgkCoverageCalculation && (\n              <div className=\"mt-4 p-3 bg-white rounded-lg border border-blue-200\">\n                <h4 className=\"text-sm font-medium text-blue-800 mb-2\">SGK Kapsam Hesaplaması</h4>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n                  {sgkCoverageCalculation.deviceCoverage && (\n                    <div>\n                      <p className=\"font-medium text-gray-700\">Cihaz Kapsamı</p>\n                      <p className=\"text-gray-600\">\n                        Maksimum: ₺{sgkCoverageCalculation.deviceCoverage.maxCoverage.toLocaleString()}\n                      </p>\n                      <p className=\"text-gray-600\">\n                        Kapsam Oranı: %{sgkCoverageCalculation.deviceCoverage.coveragePercentage}\n                      </p>\n                    </div>\n                  )}\n                  {sgkCoverageCalculation.batteryCoverage && (\n                    <div>\n                      <p className=\"font-medium text-gray-700\">Pil Kapsamı</p>\n                      <p className=\"text-gray-600\">\n                        Maksimum: ₺{sgkCoverageCalculation.batteryCoverage.maxCoverage.toLocaleString()}\n                      </p>\n                      <p className=\"text-gray-600\">\n                        Kapsam Oranı: %{sgkCoverageCalculation.batteryCoverage.coveragePercentage}\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Sales Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Toplam Satış</p>\n                <p className=\"text-2xl font-bold text-green-600\">₺{salesSummary.totalSales.toLocaleString()}</p>\n              </div>\n              <div className=\"p-2 bg-green-100 rounded-full\">\n                <DollarSign className=\"w-6 h-6 text-green-600\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">SGK Kapsamı</p>\n                <p className=\"text-2xl font-bold text-blue-600\">₺{salesSummary.totalSGKCoverage.toLocaleString()}</p>\n              </div>\n              <div className=\"p-2 bg-blue-100 rounded-full\">\n                <Shield className=\"w-6 h-6 text-blue-600\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Hasta Ödemesi</p>\n                <p className=\"text-2xl font-bold text-orange-600\">₺{salesSummary.patientPayment.toLocaleString()}</p>\n              </div>\n              <div className=\"p-2 bg-orange-100 rounded-full\">\n                <DollarSign className=\"w-6 h-6 text-orange-600\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Kalan Tutar</p>\n                <p className=\"text-2xl font-bold text-red-600\">₺{salesSummary.totalPending.toLocaleString()}</p>\n              </div>\n              <div className=\"p-2 bg-red-100 rounded-full\">\n                <DollarSign className=\"w-6 h-6 text-red-600\" />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Action Buttons */}\n      <div className=\"flex justify-between items-center\">\n        <h3 className=\"text-lg font-medium text-gray-900\">Satış İşlemleri</h3>\n        <div className=\"flex space-x-2\">\n          <Button onClick={handleCreateSale} className=\"bg-blue-600 hover:bg-blue-700\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            Yeni Satış\n          </Button>\n          <Button onClick={() => setShowProformaModal(true)} variant=\"outline\">\n            Proforma\n          </Button>\n          <Button onClick={() => setShowCollectionModal(true)} variant=\"outline\">\n            Tahsilat\n          </Button>\n          <Button onClick={() => setShowPromissoryNoteModal(true)} variant=\"outline\">\n            Senet\n          </Button>\n          <Button onClick={() => setShowReturnExchangeModal(true)} variant=\"outline\">\n            İade/Değişim\n          </Button>\n        </div>\n      </div>\n\n      {/* Sales History */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex justify-between items-center\">\n            <CardTitle>Satış Geçmişi</CardTitle>\n            <div className=\"flex items-center space-x-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\n              >\n                <Filter className=\"w-4 h-4 mr-2\" />\n                Gelişmiş Filtre\n              </Button>\n              <Button variant=\"outline\" size=\"sm\">\n                <Download className=\"w-4 h-4 mr-2\" />\n                Dışa Aktar\n              </Button>\n              <Button variant=\"outline\" size=\"sm\">\n                <Printer className=\"w-4 h-4 mr-2\" />\n                Yazdır\n              </Button>\n            </div>\n          </div>\n          \n          {/* Basic Filters */}\n          <div className=\"flex flex-wrap gap-4 mt-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Search className=\"w-4 h-4 text-gray-400\" />\n              <Input\n                placeholder=\"Satış ara...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-48\"\n              />\n            </div>\n            \n            <select \n              value={dateFilter} \n              onChange={(e) => setDateFilter(e.target.value)} \n              className=\"px-3 py-2 border border-gray-300 rounded-md\"\n            >\n              <option value=\"all\">Tüm Zamanlar</option>\n              <option value=\"today\">Bugün</option>\n              <option value=\"week\">Bu Hafta</option>\n              <option value=\"month\">Bu Ay</option>\n              <option value=\"year\">Bu Yıl</option>\n            </select>\n\n            <select \n              value={statusFilter} \n              onChange={(e) => setStatusFilter(e.target.value)} \n              className=\"px-3 py-2 border border-gray-300 rounded-md\"\n            >\n              <option value=\"all\">Tüm Durumlar</option>\n              <option value=\"draft\">Taslak</option>\n              <option value=\"confirmed\">Onaylandı</option>\n              <option value=\"paid\">Ödendi</option>\n              <option value=\"cancelled\">İptal</option>\n            </select>\n\n            <select \n              value={paymentMethodFilter} \n              onChange={(e) => setPaymentMethodFilter(e.target.value)} \n              className=\"px-3 py-2 border border-gray-300 rounded-md\"\n            >\n              <option value=\"all\">Tüm Ödeme Yöntemleri</option>\n              <option value=\"cash\">Nakit</option>\n              <option value=\"card\">Kart</option>\n              <option value=\"bank_transfer\">Havale</option>\n              <option value=\"installment\">Taksit</option>\n            </select>\n          </div>\n\n          {/* Advanced Filters */}\n          {showAdvancedFilters && (\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Min Tutar\n                  </label>\n                  <Input\n                    type=\"number\"\n                    placeholder=\"0\"\n                    value={amountRangeMin}\n                    onChange={(e) => setAmountRangeMin(e.target.value)}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Max Tutar\n                  </label>\n                  <Input\n                    type=\"number\"\n                    placeholder=\"999999\"\n                    value={amountRangeMax}\n                    onChange={(e) => setAmountRangeMax(e.target.value)}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Sıralama\n                  </label>\n                  <div className=\"flex space-x-2\">\n                    <select \n                      value={sortBy} \n                      onChange={(e) => setSortBy(e.target.value as 'date' | 'amount' | 'status')} \n                      className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md\"\n                    >\n                      <option value=\"date\">Tarih</option>\n                      <option value=\"amount\">Tutar</option>\n                      <option value=\"status\">Durum</option>\n                    </select>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}\n                    >\n                      {sortOrder === 'asc' ? <ChevronUp className=\"w-4 h-4\" /> : <ChevronDown className=\"w-4 h-4\" />}\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </CardHeader>\n        <CardContent>\n          {/* Bulk Actions */}\n          {selectedSales.length > 0 && (\n            <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium text-blue-800\">\n                  {selectedSales.length} satış seçildi\n                </span>\n                <div className=\"flex space-x-2\">\n                   <Button \n                     size=\"sm\" \n                     variant=\"outline\"\n                     onClick={() => handleExportSales(filteredSales.filter(sale => selectedSales.includes(sale.id)))}\n                   >\n                     <Download className=\"w-4 h-4 mr-1\" />\n                     Dışa Aktar\n                   </Button>\n                   <Button \n                     size=\"sm\" \n                     variant=\"outline\"\n                     onClick={() => handlePrintSales(filteredSales.filter(sale => selectedSales.includes(sale.id)))}\n                   >\n                     <Printer className=\"w-4 h-4 mr-1\" />\n                     Yazdır\n                   </Button>\n                  <Button \n                    size=\"sm\" \n                    variant=\"outline\"\n                    onClick={() => setSelectedSales([])}\n                  >\n                    Seçimi Temizle\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedSales.length === filteredSales.length && filteredSales.length > 0}\n                      onChange={(e) => {\n                        if (e.target.checked) {\n                          setSelectedSales(filteredSales.map(sale => sale.id));\n                        } else {\n                          setSelectedSales([]);\n                        }\n                      }}\n                      className=\"rounded border-gray-300\"\n                    />\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                      onClick={() => {\n                        if (sortBy === 'date') {\n                          setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n                        } else {\n                          setSortBy('date');\n                          setSortOrder('desc');\n                        }\n                      }}>\n                    <div className=\"flex items-center\">\n                      Tarih\n                      {sortBy === 'date' && (\n                        sortOrder === 'asc' ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />\n                      )}\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                      onClick={() => {\n                        if (sortBy === 'amount') {\n                          setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n                        } else {\n                          setSortBy('amount');\n                          setSortOrder('desc');\n                        }\n                      }}>\n                    <div className=\"flex items-center\">\n                      Tutar\n                      {sortBy === 'amount' && (\n                        sortOrder === 'asc' ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />\n                      )}\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Ödeme Yöntemi\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                      onClick={() => {\n                        if (sortBy === 'status') {\n                          setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n                        } else {\n                          setSortBy('status');\n                          setSortOrder('asc');\n                        }\n                      }}>\n                    <div className=\"flex items-center\">\n                      Durum\n                      {sortBy === 'status' && (\n                        sortOrder === 'asc' ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />\n                      )}\n                    </div>\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    İşlemler\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {filteredSales.map((sale) => (\n                  <tr key={sale.id} className={selectedSales.includes(sale.id) ? 'bg-blue-50' : ''}>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedSales.includes(sale.id)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setSelectedSales([...selectedSales, sale.id]);\n                          } else {\n                            setSelectedSales(selectedSales.filter(id => id !== sale.id));\n                          }\n                        }}\n                        className=\"rounded border-gray-300\"\n                      />\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                      {sale.saleDate ? new Date(sale.saleDate).toLocaleDateString('tr-TR') : '-'}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                      <div>\n                        <p className=\"font-medium\">₺{sale.totalAmount?.toLocaleString()}</p>\n                        {sale.discountAmount && sale.discountAmount > 0 && (\n                          <p className=\"text-xs text-green-600\">İndirim: -₺{sale.discountAmount?.toLocaleString()}</p>\n                        )}\n                        {sale.sgkCoverage && sale.sgkCoverage > 0 && (\n                          <p className=\"text-xs text-blue-600\">SGK: ₺{sale.sgkCoverage?.toLocaleString()}</p>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                      {getPaymentMethodText(sale.paymentMethod)}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      {getStatusBadge(sale.status)}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                      <div className=\"flex space-x-2\">\n                        <Button\n                          size=\"sm\"\n                          onClick={() => handleEditSaleClick(sale)}\n                          className=\"text-blue-600 hover:text-blue-800\"\n                        >\n                          <Edit className=\"w-4 h-4\" />\n                        </Button>\n                        <Button\n                          size=\"sm\"\n                          onClick={() => handleCollectionClick(sale)}\n                          className=\"text-green-600 hover:text-green-800\"\n                        >\n                          <DollarSign className=\"w-4 h-4\" />\n                        </Button>\n                        <Button\n                          size=\"sm\"\n                          onClick={() => handlePromissoryNoteClick(sale)}\n                          className=\"text-purple-600 hover:text-purple-800\"\n                        >\n                          <FileText className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </td>\n                  </tr>\n                ))}\n                {filteredSales.length === 0 && (\n                  <tr>\n                    <td colSpan={5} className=\"px-6 py-8 text-center text-gray-500\">\n                      {dateFilter !== 'all' ? 'Bu tarihte satış bulunamadı.' : 'Henüz satış kaydı bulunmamaktadır.'}\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Proforma Invoices */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Proforma Faturalar</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8 text-gray-500\">\n            <FileText className=\"w-12 h-12 mx-auto mb-4 text-gray-300\" />\n            <p>Henüz proforma fatura bulunmamaktadır.</p>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Returns/Exchanges */}\n      <Card>\n        <CardHeader>\n          <CardTitle>İadeler/Değişimler</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8 text-gray-500\">\n            <FileText className=\"w-12 h-12 mx-auto mb-4 text-gray-300\" />\n            <p>Henüz iade/değişim kaydı bulunmamaktadır.</p>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Modals */}\n      <SaleModal\n        isOpen={showNewSaleModal}\n        onClose={() => setShowNewSaleModal(false)}\n        patient={patient}\n        onSaleCreate={(saleData) => {\n          console.log('New sale created:', saleData);\n          setShowNewSaleModal(false);\n        }}\n      />\n      \n      {/* New Modals */}\n      {selectedSale && (\n        <ReturnExchangeModal\n          isOpen={showReturnExchangeModal}\n          onClose={() => setShowReturnExchangeModal(false)}\n          patient={patient}\n          sale={{\n            id: selectedSale.id || '',\n            productName: 'İşitme Cihazı',\n            brand: 'Phonak',\n            model: 'Audéo Paradise',\n            serialNumber: '12345',\n            salePrice: selectedSale.totalAmount || 0,\n            saleDate: selectedSale.saleDate || '',\n            paymentMethod: selectedSale.paymentMethod || '',\n            status: selectedSale.status || ''\n          }}\n          onReturnExchangeCreate={(data) => {\n            console.log('Return/Exchange data:', data);\n            setShowReturnExchangeModal(false);\n          }}\n        />\n      )}\n      \n      <ProformaModal\n        isOpen={showProformaModal}\n        onClose={() => setShowProformaModal(false)}\n        patient={patient}\n        onProformaCreate={(data) => {\n          console.log('Proforma data:', data);\n          setShowProformaModal(false);\n        }}\n      />\n      \n      {/* Existing Modals - Enabled */}\n      {selectedSale && (\n        <>\n          <CollectionModal\n            isOpen={showCollectionModal}\n            onClose={() => setShowCollectionModal(false)}\n            patient={patient}\n            sale={selectedSale}\n            onPaymentCreate={(paymentData) => {\n              console.log('Payment created:', paymentData);\n              setShowCollectionModal(false);\n            }}\n          />\n          \n          <PromissoryNoteModal\n            isOpen={showPromissoryNoteModal}\n            onClose={() => setShowPromissoryNoteModal(false)}\n            patient={patient}\n            sale={selectedSale}\n            onSave={(noteData) => {\n              console.log('Promissory note saved:', noteData);\n              setShowPromissoryNoteModal(false);\n            }}\n          />\n          \n          <EditSaleModal\n            isOpen={showEditSaleModal}\n            onClose={() => setShowEditSaleModal(false)}\n            patient={patient}\n            sale={selectedSale as APISale}\n            onSaleUpdate={(saleData) => {\n              console.log('Sale updated:', saleData);\n              setShowEditSaleModal(false);\n            }}\n          />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport { PatientSalesTab };","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientSearch.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2384,2387],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2384,2387],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'localValue'. Either include it or remove the dependency array.","line":109,"column":6,"nodeType":"ArrayExpression","endLine":109,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [localValue, value]","fix":{"range":[3138,3145],"text":"[localValue, value]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":148,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4481,4484],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4481,4484],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":259,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":266,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":271,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":285,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":310,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":319,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":327,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":337,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":345,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":356,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":364,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":369,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":377,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":382,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":390,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":399,"endColumn":24}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { Input, Button, Spinner } from '@x-ear/ui-web';\nimport { Search, X, Clock, User, Phone, Filter } from 'lucide-react';\nimport { PatientSearchItem } from '../../types/patient/patient-search.types';\n\nexport interface PatientSearchFilters {\n  query?: string;\n  status?: string | string[];\n  segment?: string | string[];\n  acquisitionType?: string | string[];\n  dateFrom?: string;\n  dateTo?: string;\n  tags?: string[];\n  branchId?: string;\n  labels?: string[];\n  hasDevice?: boolean;\n}\n\ninterface PatientSearchProps {\n  value: string;\n  onChange: (value: string) => void;\n  onSearch?: (query: string) => void;\n  onFiltersChange?: (filters: PatientSearchFilters) => void;\n  onClear?: () => void;\n  results?: PatientSearchItem[];\n  isSearching?: boolean;\n  placeholder?: string;\n  className?: string;\n  debounceMs?: number;\n  disabled?: boolean;\n  showRecentSearches?: boolean;\n  showFilters?: boolean;\n  initialFilters?: PatientSearchFilters;\n}\n\ninterface RecentSearch {\n  id: string;\n  query: string;\n  timestamp: Date;\n  resultCount: number;\n}\n\n/**\n * PatientSearch Component\n * Advanced search functionality with dropdown results, recent searches, and debounced input\n */\nexport function PatientSearch({\n  value,\n  onChange,\n  onSearch,\n  onFiltersChange,\n  onClear,\n  results = [],\n  isSearching = false,\n  placeholder = 'Hasta ara... (ad, soyad, telefon, TC)',\n  className = '',\n  debounceMs = 300,\n  disabled = false,\n  showRecentSearches = true,\n  showFilters = false,\n  initialFilters = {}\n}: PatientSearchProps) {\n  const [localValue, setLocalValue] = useState(value);\n  const [isFocused, setIsFocused] = useState(false);\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n  const [filters, setFilters] = useState<PatientSearchFilters>(initialFilters);\n  const [recentSearches, setRecentSearches] = useState<RecentSearch[]>([]);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Load recent searches from localStorage\n  useEffect(() => {\n    if (showRecentSearches) {\n      const saved = localStorage.getItem('patient-recent-searches');\n      if (saved) {\n        try {\n          const parsed = JSON.parse(saved);\n          setRecentSearches(parsed.map((item: any) => ({\n            ...item,\n            timestamp: new Date(item.timestamp)\n          })));\n        } catch (error) {\n          console.error('Failed to load recent searches:', error);\n        }\n      }\n    }\n  }, [showRecentSearches]);\n\n  // Debounced search effect\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (localValue !== value) {\n        onChange(localValue);\n        if (onSearch && localValue.trim().length >= 2) {\n          onSearch(localValue.trim());\n        }\n      }\n    }, debounceMs);\n\n    return () => clearTimeout(timer);\n  }, [localValue, onChange, value, debounceMs, onSearch]);\n\n  // Sync with external value changes\n  useEffect(() => {\n    if (value !== localValue) {\n      setLocalValue(value);\n    }\n  }, [value]);\n\n  // Save recent search\n  const saveRecentSearch = useCallback((query: string, resultCount: number) => {\n    if (!showRecentSearches || !query.trim() || query.length < 2) return;\n\n    const newSearch: RecentSearch = {\n      id: Date.now().toString(),\n      query: query.trim(),\n      timestamp: new Date(),\n      resultCount\n    };\n\n    const updated = [\n      newSearch,\n      ...recentSearches.filter(s => s.query !== query.trim())\n    ].slice(0, 10);\n\n    setRecentSearches(updated);\n    localStorage.setItem('patient-recent-searches', JSON.stringify(updated));\n  }, [recentSearches, showRecentSearches]);\n\n  const handleInputChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const newValue = e.target.value;\n    setLocalValue(newValue);\n    \n    // Update filters with new query\n    const updatedFilters = { ...filters, query: newValue };\n    setFilters(updatedFilters);\n    onFiltersChange?.(updatedFilters);\n    \n    // Show dropdown when typing or when focused with recent searches\n    if (newValue.length > 0 || (showRecentSearches && recentSearches.length > 0)) {\n      setShowDropdown(true);\n    } else {\n      setShowDropdown(false);\n    }\n  }, [showRecentSearches, recentSearches.length, filters, onFiltersChange]);\n\n  const handleFilterChange = useCallback((key: keyof PatientSearchFilters, value: any) => {\n    const updatedFilters = { ...filters, [key]: value };\n    setFilters(updatedFilters);\n    onFiltersChange?.(updatedFilters);\n  }, [filters, onFiltersChange]);\n\n  const clearAllFilters = useCallback(() => {\n    const clearedFilters: PatientSearchFilters = { query: localValue };\n    setFilters(clearedFilters);\n    onFiltersChange?.(clearedFilters);\n  }, [localValue, onFiltersChange]);\n\n  const activeFiltersCount = React.useMemo(() => {\n    return Object.entries(filters).filter(([key, value]) => \n      key !== 'query' && value && (Array.isArray(value) ? value.length > 0 : true)\n    ).length;\n  }, [filters]);\n\n  const handleClear = useCallback(() => {\n    setLocalValue('');\n    onChange('');\n    onClear?.();\n    setShowDropdown(false);\n    inputRef.current?.focus();\n  }, [onChange, onClear]);\n\n  const handleFocus = useCallback(() => {\n    setIsFocused(true);\n    if (localValue.length > 0 || (showRecentSearches && recentSearches.length > 0)) {\n      setShowDropdown(true);\n    }\n  }, [localValue, showRecentSearches, recentSearches.length]);\n\n  const handleBlur = useCallback(() => {\n    setIsFocused(false);\n    // Delay hiding dropdown to allow clicks\n    setTimeout(() => setShowDropdown(false), 200);\n  }, []);\n\n  const handleKeyPress = useCallback((e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      if (onSearch && localValue.trim()) {\n        onSearch(localValue.trim());\n        saveRecentSearch(localValue.trim(), results.length);\n        setShowDropdown(false);\n      }\n    } else if (e.key === 'Escape') {\n      setShowDropdown(false);\n      inputRef.current?.blur();\n    }\n  }, [onSearch, localValue, saveRecentSearch, results.length]);\n\n  const handleRecentSearchClick = useCallback((query: string) => {\n    setLocalValue(query);\n    onChange(query);\n    if (onSearch) {\n      onSearch(query);\n    }\n    setShowDropdown(false);\n  }, [onChange, onSearch]);\n\n  const clearRecentSearches = useCallback(() => {\n    setRecentSearches([]);\n    localStorage.removeItem('patient-recent-searches');\n  }, []);\n\n  // Click outside handler\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        dropdownRef.current &&\n        !dropdownRef.current.contains(event.target as Node) &&\n        inputRef.current &&\n        !inputRef.current.contains(event.target as Node)\n      ) {\n        setShowDropdown(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  return (\n    <div className={`relative ${className}`}>\n      {/* Search Input */}\n      <div className=\"relative\">\n        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n          {isSearching ? (\n            <Spinner className=\"h-5 w-5 text-gray-400\" />\n          ) : (\n            <Search className=\"h-5 w-5 text-gray-400\" />\n          )}\n        </div>\n        \n        <Input\n          ref={inputRef}\n          type=\"text\"\n          value={localValue}\n          onChange={handleInputChange}\n          onKeyDown={handleKeyPress}\n          onFocus={handleFocus}\n          onBlur={handleBlur}\n          placeholder={placeholder}\n          disabled={disabled}\n          className={`pl-10 ${localValue ? 'pr-20' : 'pr-4'} ${showFilters ? 'pr-28' : ''} ${isFocused ? 'ring-2 ring-blue-500' : ''}`}\n        />\n        \n        {/* Clear button */}\n        {localValue && (\n          <button\n            type=\"button\"\n            onClick={handleClear}\n            className=\"absolute inset-y-0 right-0 pr-3 flex items-center\"\n            disabled={disabled}\n          >\n            <X className=\"h-5 w-5 text-gray-400 hover:text-gray-600\" />\n          </button>\n        )}\n\n        {/* Filter toggle button */}\n        {showFilters && (\n          <button\n            type=\"button\"\n            onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\n            className={`absolute inset-y-0 ${localValue ? 'right-8' : 'right-0'} pr-3 flex items-center`}\n            disabled={disabled}\n          >\n            <div className=\"relative\">\n              <Filter className={`h-5 w-5 ${showAdvancedFilters ? 'text-blue-600' : 'text-gray-400'} hover:text-gray-600`} />\n              {activeFiltersCount > 0 && (\n                <span className=\"absolute -top-2 -right-2 bg-blue-600 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center\">\n                  {activeFiltersCount}\n                </span>\n              )}\n            </div>\n          </button>\n        )}\n      </div>\n\n      {/* Advanced Filters Panel */}\n      {showFilters && showAdvancedFilters && (\n        <div className=\"absolute z-40 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-4\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-sm font-medium text-gray-900\">Gelişmiş Filtreler</h3>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={clearAllFilters}\n              className=\"text-xs\"\n            >\n              Temizle\n            </Button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {/* Status Filter */}\n            <div>\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                Durum\n              </label>\n              <select\n                value={filters.status || ''}\n                onChange={(e) => handleFilterChange('status', e.target.value || undefined)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Tümü</option>\n                <option value=\"active\">Aktif</option>\n                <option value=\"inactive\">Pasif</option>\n                <option value=\"pending\">Beklemede</option>\n              </select>\n            </div>\n\n            {/* Segment Filter */}\n            <div>\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                Segment\n              </label>\n              <select\n                value={filters.segment || ''}\n                onChange={(e) => handleFilterChange('segment', e.target.value || undefined)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Tümü</option>\n                <option value=\"trial\">Deneme</option>\n                <option value=\"purchased\">Satın Alınmış</option>\n                <option value=\"lead\">Potansiyel</option>\n                <option value=\"follow_up\">Takip</option>\n              </select>\n            </div>\n\n            {/* Acquisition Type Filter */}\n            <div>\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                Kazanım Türü\n              </label>\n              <select\n                value={filters.acquisitionType || ''}\n                onChange={(e) => handleFilterChange('acquisitionType', e.target.value || undefined)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Tümü</option>\n                <option value=\"referral\">Referans</option>\n                <option value=\"online\">Online</option>\n                <option value=\"walk-in\">Yürüyerek Gelen</option>\n                <option value=\"social-media\">Sosyal Medya</option>\n                <option value=\"advertisement\">Reklam</option>\n              </select>\n            </div>\n\n            {/* Date From */}\n            <div>\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                Başlangıç Tarihi\n              </label>\n              <input\n                type=\"date\"\n                value={filters.dateFrom || ''}\n                onChange={(e) => handleFilterChange('dateFrom', e.target.value || undefined)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n\n            {/* Date To */}\n            <div>\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                Bitiş Tarihi\n              </label>\n              <input\n                type=\"date\"\n                value={filters.dateTo || ''}\n                onChange={(e) => handleFilterChange('dateTo', e.target.value || undefined)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n\n            {/* Branch Filter */}\n            <div>\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                Şube\n              </label>\n              <select\n                value={filters.branchId || ''}\n                onChange={(e) => handleFilterChange('branchId', e.target.value || undefined)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Tüm Şubeler</option>\n                <option value=\"branch-1\">Merkez Şube</option>\n                <option value=\"branch-2\">Kadıköy Şube</option>\n                <option value=\"branch-3\">Beşiktaş Şube</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Search Dropdown */}\n      {showDropdown && !showAdvancedFilters && (\n        <div\n          ref={dropdownRef}\n          className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-96 overflow-y-auto\"\n        >\n          {/* Search Results */}\n          {localValue.length > 0 && (\n            <div>\n              {isSearching ? (\n                <div className=\"p-4 text-center\">\n                  <Spinner className=\"h-6 w-6 mx-auto mb-2\" />\n                  <p className=\"text-sm text-gray-500\">Aranıyor...</p>\n                </div>\n              ) : results.length > 0 ? (\n                <div>\n                  <div className=\"px-3 py-2 text-xs font-medium text-gray-500 bg-gray-50 border-b\">\n                    Arama Sonuçları ({results.length})\n                  </div>\n                  {results.slice(0, 8).map((patient) => (\n                    <div\n                      key={patient.id}\n                      className=\"px-3 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0\"\n                      onClick={() => console.log('Select patient:', patient.id)}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center space-x-2\">\n                            <User className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"font-medium text-gray-900\">\n                              {patient.firstName} {patient.lastName}\n                            </span>\n                            <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${\n                              patient.status === 'ACTIVE' \n                                ? 'bg-green-100 text-green-800'\n                                : patient.status === 'INACTIVE'\n                                ? 'bg-yellow-100 text-yellow-800'\n                                : 'bg-gray-100 text-gray-800'\n                            }`}>\n                              {patient.status === 'ACTIVE' ? 'Aktif' : \n                               patient.status === 'INACTIVE' ? 'Pasif' : 'Arşiv'}\n                            </span>\n                          </div>\n                          \n                          <div className=\"mt-1 flex items-center space-x-4 text-sm text-gray-500\">\n                            {patient.phone && (\n                              <div className=\"flex items-center space-x-1\">\n                                <Phone className=\"h-3 w-3\" />\n                                <span>{patient.phone}</span>\n                              </div>\n                            )}\n                            \n                            <span>\n                              Kayıt: {new Date(patient.registrationDate).toLocaleDateString('tr-TR')}\n                            </span>\n                            \n                            {patient.deviceCount > 0 && (\n                              <span className=\"text-blue-600\">\n                                {patient.deviceCount} cihaz\n                              </span>\n                            )}\n                          </div>\n                        </div>\n                        \n                        <div className=\"text-right\">\n                          {patient.priority > 0 && (\n                            <div className=\"text-xs text-orange-600 font-medium\">\n                              Öncelik: {patient.priority}\n                            </div>\n                          )}\n                          \n                          {patient.outstandingBalance > 0 && (\n                            <div className=\"text-xs text-red-600\">\n                              Borç: ₺{patient.outstandingBalance.toLocaleString('tr-TR')}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                  \n                  {results.length > 8 && (\n                    <div className=\"px-3 py-2 text-center text-sm text-gray-500 bg-gray-50\">\n                      +{results.length - 8} hasta daha\n                    </div>\n                  )}\n                </div>\n              ) : localValue.length >= 2 ? (\n                <div className=\"p-4 text-center text-gray-500\">\n                  <User className=\"h-8 w-8 mx-auto mb-2 text-gray-300\" />\n                  <p className=\"text-sm\">Hasta bulunamadı</p>\n                  <p className=\"text-xs mt-1\">Farklı arama terimleri deneyin</p>\n                </div>\n              ) : null}\n            </div>\n          )}\n\n          {/* Recent Searches */}\n          {showRecentSearches && localValue.length === 0 && recentSearches.length > 0 && (\n            <div>\n              <div className=\"flex items-center justify-between px-3 py-2 text-xs font-medium text-gray-500 bg-gray-50 border-b\">\n                <span>Son Aramalar</span>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={clearRecentSearches}\n                  className=\"text-xs p-1 h-auto\"\n                >\n                  Temizle\n                </Button>\n              </div>\n              \n              {recentSearches.slice(0, 5).map((search) => (\n                <div\n                  key={search.id}\n                  className=\"px-3 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0\"\n                  onClick={() => handleRecentSearchClick(search.query)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Clock className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-sm text-gray-900\">{search.query}</span>\n                    </div>\n                    \n                    <div className=\"text-xs text-gray-500\">\n                      {search.resultCount} sonuç\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Empty State */}\n          {localValue.length === 0 && recentSearches.length === 0 && (\n            <div className=\"p-4 text-center text-gray-500\">\n              <Search className=\"h-8 w-8 mx-auto mb-2 text-gray-300\" />\n              <p className=\"text-sm\">Hasta aramaya başlayın</p>\n              <p className=\"text-xs mt-1\">Ad, soyad, telefon veya TC ile arayabilirsiniz</p>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientTabContent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LoadingSkeleton' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDate' is assigned a value but never used.","line":40,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":19}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { Patient } from '../../types/patient/patient-base.types';\nimport { PatientTab } from './PatientTabs';\nimport { ErrorBoundary } from '../ErrorBoundary';\nimport { LoadingSkeleton } from '../common/LoadingSkeleton';\nimport { PatientOverviewTab } from './PatientOverviewTab';\nimport { PatientDevicesTab } from '../PatientDevicesTab';\nimport { PatientSalesTab } from '../PatientSalesTab';\nimport { PatientTimelineTab } from '../PatientTimelineTab';\nimport { PatientDocumentsTab } from '../PatientDocumentsTab';\nimport { PatientAppointmentsTab } from '../PatientAppointmentsTab';\nimport { PatientHearingTestsTab } from '../PatientHearingTestsTab';\nimport { PatientNotesTab } from '../PatientNotesTab';\nimport { PatientSGKTab } from './PatientSGKTab';\nimport { Clock } from 'lucide-react';\n\ninterface PatientTabContentProps {\n  patient: Patient;\n  activeTab: PatientTab;\n  onPatientUpdate?: (p: Patient) => void;\n}\n\nexport const PatientTabContent: React.FC<PatientTabContentProps> = ({\n  patient,\n  activeTab,\n  onPatientUpdate,\n}) => {\n  const renderComingSoon = (tabName: string) => (\n    <div className=\"p-6 text-center\">\n      <div className=\"max-w-sm mx-auto\">\n        <Clock className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">{tabName} Yakında Gelecek</h3>\n        <p className=\"text-gray-500\">\n          Bu özellik şu anda geliştirme aşamasında. Yakında kullanıma sunulacak.\n        </p>\n      </div>\n    </div>\n  );\n\n  const formatDate = (date: string | Date) => {\n    return new Date(date).toLocaleDateString('tr-TR');\n  };\n\n  switch (activeTab) {\n    case 'overview':\n      return (\n        <ErrorBoundary>\n          <PatientOverviewTab patient={patient} />\n        </ErrorBoundary>\n      );\n    case 'devices':\n      return (\n        <ErrorBoundary>\n          <PatientDevicesTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'sales':\n      return (\n        <ErrorBoundary>\n          <PatientSalesTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'timeline':\n      return (\n        <ErrorBoundary>\n          <PatientTimelineTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'documents':\n      return (\n        <ErrorBoundary>\n          <PatientDocumentsTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'appointments':\n      return (\n        <ErrorBoundary>\n          <PatientAppointmentsTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'hearing-tests':\n      return (\n        <ErrorBoundary>\n          <PatientHearingTestsTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'sgk':\n      return (\n        <ErrorBoundary>\n          <PatientSGKTab patient={patient} onPatientUpdate={onPatientUpdate} />\n        </ErrorBoundary>\n      );\n    case 'notes':\n      return (\n        <ErrorBoundary>\n          <PatientNotesTab patientId={patient?.id || ''} />\n        </ErrorBoundary>\n      );\n    case 'settings':\n      return renderComingSoon('Ayarlar');\n    default:\n      return (\n        <ErrorBoundary>\n          <PatientOverviewTab patient={patient} />\n        </ErrorBoundary>\n      );\n  }\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientTabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/PatientTimelineTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'User' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'FileText' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Phone' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CreditCard' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Stethoscope' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Settings' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Eye' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Download' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[856,859],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[856,859],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_onPatientUpdate' is defined but never used.","line":42,"column":99,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":115},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":142,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4652,4655],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4652,4655],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nconst { useState, useMemo } = React;\nimport { Button, Input, Badge } from '@x-ear/ui-web';\nimport { Card, CardContent, CardHeader, CardTitle } from '@x-ear/ui-web';\nimport { useToastHelpers } from '@x-ear/ui-web';\nimport { \n  Search, \n  Filter, \n  Calendar, \n  Clock, \n  User, \n  FileText, \n  Phone, \n  CreditCard, \n  Stethoscope,\n  Settings,\n  RefreshCw,\n  ChevronDown,\n  ChevronUp,\n  Eye,\n  Download\n} from 'lucide-react';\nimport { Patient } from '@/types/patient';\n\ninterface TimelineEvent {\n  id: string;\n  type: 'registration' | 'note' | 'appointment' | 'device' | 'payment' | 'document' | 'sms' | 'sgk' | 'sale' | 'label' | 'ereceipt' | 'profile' | 'call';\n  title: string;\n  description: string;\n  date: string;\n  icon: string;\n  priority?: 'low' | 'medium' | 'high';\n  category?: string;\n  metadata?: Record<string, any>;\n}\n\ninterface PatientTimelineTabProps {\n  patient: Patient;\n  onPatientUpdate?: (patient: Patient) => void;\n}\n\nexport const PatientTimelineTab: React.FC<PatientTimelineTabProps> = ({ patient, onPatientUpdate: _onPatientUpdate }) => {\n  const { success: showSuccessToast, error: showErrorToast } = useToastHelpers();\n  \n  // State management\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedEventTypes, setSelectedEventTypes] = useState<string[]>([]);\n  const [dateRange, setDateRange] = useState<{ start: string; end: string } | null>(null);\n  const [isFilterOpen, setIsFilterOpen] = useState(false);\n  const [expandedEvents, setExpandedEvents] = useState<Set<string>>(new Set());\n  const [isRefreshing, setIsRefreshing] = useState(false);\n\n  // Collect events from patient data\n  const allEvents = useMemo(() => {\n    const events: TimelineEvent[] = [];\n\n    // Registration event\n    if (patient.createdAt) {\n      events.push({\n        id: 'registration',\n        type: 'registration',\n        title: 'Hasta Kaydı Oluşturuldu',\n        description: 'Hasta sistemde kayıt edildi',\n        date: patient.createdAt,\n        icon: '👤',\n        priority: 'high',\n        category: 'System'\n      });\n    }\n\n    // Notes events\n    if (patient.notes) {\n      patient.notes.forEach((note, index) => {\n        events.push({\n          id: `note-${index}`,\n          type: 'note',\n          title: 'Not Eklendi',\n          description: note.text?.substring(0, 100) + (note.text?.length > 100 ? '...' : ''),\n          date: note.date,\n          icon: '📝',\n          priority: note.type === 'clinical' ? 'high' : 'medium',\n          category: 'Clinical',\n          metadata: { author: note.author, type: note.type, isPrivate: note.isPrivate }\n        });\n      });\n    }\n\n    // Appointment events\n    if (patient.appointments) {\n      patient.appointments.forEach((appointment, index) => {\n        events.push({\n          id: `appointment-${index}`,\n          type: 'appointment',\n          title: 'Randevu',\n          description: `${appointment.status === 'scheduled' ? 'Planlandı' : appointment.status === 'completed' ? 'Tamamlandı' : 'İptal Edildi'}${appointment.note ? ` - ${appointment.note}` : ''}`,\n          date: appointment.date,\n          icon: '📅',\n          priority: appointment.status === 'scheduled' ? 'high' : 'medium',\n          category: 'Appointments'\n        });\n      });\n    }\n\n    // Device events\n    if (patient.devices) {\n      patient.devices.forEach((device, index) => {\n        events.push({\n          id: `device-${index}`,\n          type: 'device',\n          title: device.status === 'trial' ? 'Cihaz Denemesi' : 'Cihaz Ataması',\n          description: `${device.brand} ${device.model} - ${device.side === 'right' ? 'Sağ' : device.side === 'left' ? 'Sol' : 'İki'} Kulak`,\n          date: device.purchaseDate || patient.createdAt || '',\n          icon: '🔊',\n          priority: 'high',\n          category: 'Devices',\n          metadata: { serialNumber: device.serialNumber, type: device.type, price: device.price }\n        });\n      });\n    }\n\n    // Payment events\n    if (patient.sales) {\n      patient.sales.forEach((sale, index) => {\n        events.push({\n          id: `payment-${index}`,\n          type: 'payment',\n          title: 'Ödeme',\n          description: `₺${sale.totalAmount} - ${sale.paymentMethod || 'Belirtilmemiş'}`,\n          date: sale.saleDate || sale.createdAt || patient.createdAt || '',\n          icon: '💰',\n          priority: 'high',\n          category: 'Financial'\n        });\n      });\n    }\n\n    // Communication events (SMS, calls, etc.)\n    if (patient.communications) {\n      patient.communications.forEach((comm, index) => {\n        events.push({\n          id: `comm-${index}`,\n          type: comm.type as any,\n          title: `${comm.type.toUpperCase()} ${comm.direction === 'outbound' ? 'Gönderildi' : 'Alındı'}`,\n          description: comm.content?.substring(0, 50) + (comm.content?.length > 50 ? '...' : ''),\n          date: comm.timestamp || comm.date || '',\n          icon: comm.type === 'sms' ? '📱' : comm.type === 'call' ? '📞' : '📧',\n          priority: 'medium',\n          category: 'Communication'\n        });\n      });\n    }\n\n    // SGK events\n    if (patient.sgkWorkflow?.statusHistory) {\n      patient.sgkWorkflow.statusHistory.forEach((status, index) => {\n        events.push({\n          id: `sgk-${index}`,\n          type: 'sgk',\n          title: 'SGK Durum Güncellendi',\n          description: `Durum: ${status.status}${status.notes ? ` - ${status.notes}` : ''}`,\n          date: status.timestamp,\n          icon: '🏥',\n          priority: 'high',\n          category: 'SGK'\n        });\n      });\n    }\n\n    // E-receipt events\n    if (patient.ereceiptHistory) {\n      patient.ereceiptHistory.forEach((receipt, index) => {\n        events.push({\n          id: `ereceipt-${index}`,\n          type: 'ereceipt',\n          title: 'E-Reçete Kaydedildi',\n          description: `Reçete #${receipt.receiptNumber} - ₺${receipt.totalAmount}`,\n          date: receipt.date,\n          icon: '💊',\n          priority: 'medium',\n          category: 'Medical'\n        });\n      });\n    }\n\n    // Reports events\n    if (patient.reports) {\n      patient.reports.forEach((report, index) => {\n        events.push({\n          id: `report-${index}`,\n          type: 'document',\n          title: 'Rapor Eklendi',\n          description: `${report.title} - ${report.type}`,\n          date: report.createdAt,\n          icon: '📄',\n          priority: report.type === 'medical' ? 'high' : 'medium',\n          category: 'Medical'\n        });\n      });\n    }\n\n    return events;\n  }, [patient]);\n\n  // Filter events based on search and filters\n  const filteredEvents = useMemo(() => {\n    let filtered = allEvents;\n\n    // Search filter\n    if (searchTerm) {\n      filtered = filtered.filter(event => \n        event.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        event.description.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    // Event type filter\n    if (selectedEventTypes.length > 0) {\n      filtered = filtered.filter(event => selectedEventTypes.includes(event.type));\n    }\n\n    // Date range filter\n    if (dateRange) {\n      filtered = filtered.filter(event => {\n        const eventDate = new Date(event.date);\n        const startDate = new Date(dateRange.start);\n        const endDate = new Date(dateRange.end);\n        return eventDate >= startDate && eventDate <= endDate;\n      });\n    }\n\n    // Sort by date (newest first)\n    return filtered.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n  }, [allEvents, searchTerm, selectedEventTypes, dateRange]);\n\n  // Group events by date\n  const groupedEvents = useMemo(() => {\n    return filteredEvents.reduce((groups, event) => {\n      const date = new Date(event.date).toLocaleDateString('tr-TR');\n      if (!groups[date]) {\n        groups[date] = [];\n      }\n      groups[date].push(event);\n      return groups;\n    }, {} as Record<string, TimelineEvent[]>);\n  }, [filteredEvents]);\n\n  // Event type options for filter\n  const eventTypeOptions = [\n    { value: 'registration', label: 'Kayıt', icon: '👤' },\n    { value: 'note', label: 'Notlar', icon: '📝' },\n    { value: 'appointment', label: 'Randevular', icon: '📅' },\n    { value: 'device', label: 'Cihazlar', icon: '🔊' },\n    { value: 'payment', label: 'Ödemeler', icon: '💰' },\n    { value: 'sms', label: 'SMS', icon: '📱' },\n    { value: 'call', label: 'Aramalar', icon: '📞' },\n    { value: 'sgk', label: 'SGK', icon: '🏥' },\n    { value: 'ereceipt', label: 'E-Reçete', icon: '💊' },\n    { value: 'document', label: 'Belgeler', icon: '📄' }\n  ];\n\n  const handleRefresh = async () => {\n    setIsRefreshing(true);\n    try {\n      // Simulate refresh - in real app, this would refetch patient data\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      showSuccessToast('Timeline yenilendi');\n    } catch (error) {\n      showErrorToast('Timeline yenilenirken hata oluştu');\n    } finally {\n      setIsRefreshing(false);\n    }\n  };\n\n  const toggleEventExpansion = (eventId: string) => {\n    const newExpanded = new Set(expandedEvents);\n    if (newExpanded.has(eventId)) {\n      newExpanded.delete(eventId);\n    } else {\n      newExpanded.add(eventId);\n    }\n    setExpandedEvents(newExpanded);\n  };\n\n  const getPriorityColor = (priority?: string) => {\n    switch (priority) {\n      case 'high': return 'bg-red-100 text-red-800';\n      case 'medium': return 'bg-yellow-100 text-yellow-800';\n      case 'low': return 'bg-green-100 text-green-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-medium text-gray-900\">Hasta Geçmişi</h3>\n        <div className=\"flex items-center space-x-2\">\n          <Badge variant=\"secondary\" className=\"text-sm\">\n            {filteredEvents.length} olay\n          </Badge>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleRefresh}\n            disabled={isRefreshing}\n          >\n            <RefreshCw className={`h-4 w-4 ${isRefreshing ? 'animate-spin' : ''}`} />\n          </Button>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <Card>\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"text-base\">Filtreler</CardTitle>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => setIsFilterOpen(!isFilterOpen)}\n            >\n              <Filter className=\"h-4 w-4 mr-2\" />\n              {isFilterOpen ? <ChevronUp className=\"h-4 w-4\" /> : <ChevronDown className=\"h-4 w-4\" />}\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent className=\"pt-0\">\n          {/* Search */}\n          <div className=\"relative mb-4\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n            <Input\n              placeholder=\"Olaylarda ara...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n\n          {/* Expandable filters */}\n          {isFilterOpen && (\n            <div className=\"space-y-4\">\n              {/* Event type filter */}\n              <div>\n                <label className=\"text-sm font-medium text-gray-700 mb-2 block\">\n                  Olay Türleri\n                </label>\n                <div className=\"flex flex-wrap gap-2\">\n                  {eventTypeOptions.map((option) => (\n                    <Button\n                      key={option.value}\n                      variant={selectedEventTypes.includes(option.value) ? \"default\" : \"outline\"}\n                      size=\"sm\"\n                      onClick={() => {\n                        setSelectedEventTypes(prev => \n                          prev.includes(option.value)\n                            ? prev.filter(t => t !== option.value)\n                            : [...prev, option.value]\n                        );\n                      }}\n                    >\n                      <span className=\"mr-1\">{option.icon}</span>\n                      {option.label}\n                    </Button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Date range filter */}\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm font-medium text-gray-700 mb-1 block\">\n                    Başlangıç Tarihi\n                  </label>\n                  <Input\n                    type=\"date\"\n                    value={dateRange?.start || ''}\n                    onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value, end: prev?.end || '' }))}\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium text-gray-700 mb-1 block\">\n                    Bitiş Tarihi\n                  </label>\n                  <Input\n                    type=\"date\"\n                    value={dateRange?.end || ''}\n                    onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value, start: prev?.start || '' }))}\n                  />\n                </div>\n              </div>\n\n              {/* Clear filters */}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => {\n                  setSearchTerm('');\n                  setSelectedEventTypes([]);\n                  setDateRange(null);\n                }}\n              >\n                Filtreleri Temizle\n              </Button>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Timeline */}\n      {Object.keys(groupedEvents).length > 0 ? (\n        <div className=\"space-y-8\">\n          {Object.entries(groupedEvents).map(([date, dayEvents]) => (\n            <div key={date} className=\"relative\">\n              {/* Date Header */}\n              <div className=\"flex items-center mb-4\">\n                <div className=\"flex-shrink-0 w-3 h-3 bg-blue-600 rounded-full\"></div>\n                <div className=\"ml-4\">\n                  <h4 className=\"text-sm font-medium text-gray-900\">{date}</h4>\n                  <p className=\"text-xs text-gray-500\">{dayEvents.length} olay</p>\n                </div>\n              </div>\n\n              {/* Events for this date */}\n              <div className=\"ml-7 space-y-4\">\n                {dayEvents.map((event) => (\n                  <Card key={event.id} className=\"border-l-4 border-l-blue-500\">\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex items-start space-x-3 flex-1\">\n                          <div className=\"flex-shrink-0\">\n                            <div className=\"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm\">\n                              {event.icon}\n                            </div>\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <h5 className=\"text-sm font-medium text-gray-900\">{event.title}</h5>\n                              {event.priority && (\n                                <Badge className={`text-xs ${getPriorityColor(event.priority)}`}>\n                                  {event.priority}\n                                </Badge>\n                              )}\n                              {event.category && (\n                                <Badge variant=\"secondary\" className=\"text-xs\">\n                                  {event.category}\n                                </Badge>\n                              )}\n                            </div>\n                            <p className=\"text-sm text-gray-600 mb-2\">{event.description}</p>\n                            <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n                              <span className=\"flex items-center\">\n                                <Clock className=\"h-3 w-3 mr-1\" />\n                                {new Date(event.date).toLocaleTimeString('tr-TR', {\n                                  hour: '2-digit',\n                                  minute: '2-digit'\n                                })}\n                              </span>\n                            </div>\n                            \n                            {/* Expanded metadata */}\n                            {expandedEvents.has(event.id) && event.metadata && (\n                              <div className=\"mt-3 p-3 bg-gray-50 rounded-md\">\n                                <h6 className=\"text-xs font-medium text-gray-700 mb-2\">Detaylar</h6>\n                                <div className=\"space-y-1\">\n                                  {Object.entries(event.metadata).map(([key, value]) => (\n                                    <div key={key} className=\"flex justify-between text-xs\">\n                                      <span className=\"text-gray-500 capitalize\">{key}:</span>\n                                      <span className=\"text-gray-700\">{String(value)}</span>\n                                    </div>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                        \n                        {/* Actions */}\n                        <div className=\"flex items-center space-x-1 ml-2\">\n                          {event.metadata && (\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={() => toggleEventExpansion(event.id)}\n                            >\n                              {expandedEvents.has(event.id) ? (\n                                <ChevronUp className=\"h-4 w-4\" />\n                              ) : (\n                                <ChevronDown className=\"h-4 w-4\" />\n                              )}\n                            </Button>\n                          )}\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <Card>\n          <CardContent className=\"text-center py-8\">\n            <div className=\"text-gray-500\">\n              <Calendar className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n              <p className=\"text-lg font-medium mb-2\">Olay bulunamadı</p>\n              <p className=\"text-sm\">\n                {searchTerm || selectedEventTypes.length > 0 || dateRange\n                  ? 'Filtrelerinizi değiştirmeyi deneyin'\n                  : 'Henüz hasta geçmişi bulunmamaktadır'}\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/SimpleVirtualizedPatientList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Eye' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":6},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":361,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":370,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":372,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":383,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":385,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":397,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":399,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":407,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":409,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":419,"endColumn":22}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Simple Virtualized Patient List Component\n * High-performance patient list with custom virtual scrolling implementation\n */\n\nimport React, { useState, useCallback, useMemo, useRef, useEffect } from 'react';\nimport { Button, Badge, Checkbox, Spinner, Input } from '@x-ear/ui-web';\nimport { \n  User, \n  Phone, \n  Mail, \n  MessageSquare,\n  Eye,\n  Edit,\n  Trash2,\n  Search,\n  Filter,\n  ChevronDown,\n  ChevronUp\n} from 'lucide-react';\nimport { Patient } from '../../types/patient';\nimport { PatientCommunicationIntegration } from './PatientCommunicationIntegration';\n\ninterface VirtualizedPatientListProps {\n  patients: Patient[];\n  loading?: boolean;\n  selectedPatients?: string[];\n  onPatientSelect?: (patientId: string) => void;\n  onPatientClick?: (patient: Patient) => void;\n  onEdit?: (patient: Patient) => void;\n  onDelete?: (patient: Patient) => void;\n  onLoadMore?: () => void;\n  hasMore?: boolean;\n  searchTerm?: string;\n  onSearchChange?: (term: string) => void;\n  filters?: PatientFilters;\n  onFiltersChange?: (filters: PatientFilters) => void;\n  className?: string;\n}\n\ninterface PatientFilters {\n  status?: string;\n  segment?: string;\n  label?: string;\n  hasDevices?: boolean;\n  sgkStatus?: string;\n}\n\nconst ITEM_HEIGHT = 80;\nconst BUFFER_SIZE = 5;\n\nexport const SimpleVirtualizedPatientList: React.FC<VirtualizedPatientListProps> = ({\n  patients,\n  loading = false,\n  selectedPatients = [],\n  onPatientSelect,\n  onPatientClick,\n  onEdit,\n  onDelete,\n  onLoadMore,\n  hasMore = false,\n  searchTerm = '',\n  onSearchChange,\n  filters,\n  onFiltersChange,\n  className = ''\n}) => {\n  const [communicationPatient, setCommunicationPatient] = useState<Patient | null>(null);\n  const [showFilters, setShowFilters] = useState(false);\n  const [scrollTop, setScrollTop] = useState(0);\n  const [containerHeight, setContainerHeight] = useState(600);\n  \n  const containerRef = useRef<HTMLDivElement>(null);\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\n\n  // Update container height on resize\n  useEffect(() => {\n    const updateHeight = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        const availableHeight = window.innerHeight - rect.top - 100;\n        setContainerHeight(Math.max(400, Math.min(800, availableHeight)));\n      }\n    };\n\n    updateHeight();\n    window.addEventListener('resize', updateHeight);\n    return () => window.removeEventListener('resize', updateHeight);\n  }, []);\n\n  // Calculate visible items\n  const visibleRange = useMemo(() => {\n    const startIndex = Math.max(0, Math.floor(scrollTop / ITEM_HEIGHT) - BUFFER_SIZE);\n    const endIndex = Math.min(\n      patients.length - 1,\n      Math.ceil((scrollTop + containerHeight) / ITEM_HEIGHT) + BUFFER_SIZE\n    );\n    return { startIndex, endIndex };\n  }, [scrollTop, containerHeight, patients.length]);\n\n  // Handle scroll\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    const newScrollTop = e.currentTarget.scrollTop;\n    setScrollTop(newScrollTop);\n\n    // Check if we need to load more\n    const scrollHeight = e.currentTarget.scrollHeight;\n    const clientHeight = e.currentTarget.clientHeight;\n    \n    if (hasMore && !loading && newScrollTop + clientHeight >= scrollHeight - 200) {\n      onLoadMore?.();\n    }\n  }, [hasMore, loading, onLoadMore]);\n\n  // Format phone number\n  const formatPhone = (phone?: string) => {\n    if (!phone) return '-';\n    const cleaned = phone.replace(/\\D/g, '');\n    if (cleaned.length === 11 && cleaned.startsWith('0')) {\n      return `${cleaned.slice(0, 4)} ${cleaned.slice(4, 7)} ${cleaned.slice(7, 9)} ${cleaned.slice(9)}`;\n    }\n    return phone;\n  };\n\n  // Get status badge\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'active':\n        return <Badge variant=\"success\" size=\"sm\">Aktif</Badge>;\n      case 'inactive':\n        return <Badge variant=\"warning\" size=\"sm\">Pasif</Badge>;\n      default:\n        return <Badge variant=\"secondary\" size=\"sm\">Bilinmiyor</Badge>;\n    }\n  };\n\n  // Get label badge\n  const getLabelBadge = (label?: string) => {\n    const labelMap: Record<string, { text: string; variant: 'default' | 'success' | 'warning' | 'danger' }> = {\n      'yeni': { text: 'Yeni', variant: 'default' },\n      'arama-bekliyor': { text: 'Arama Bekliyor', variant: 'warning' },\n      'randevu-verildi': { text: 'Randevu Verildi', variant: 'default' },\n      'deneme-yapildi': { text: 'Deneme Yapıldı', variant: 'default' },\n      'kontrol-hastasi': { text: 'Kontrol Hastası', variant: 'default' },\n      'satis-tamamlandi': { text: 'Satış Tamamlandı', variant: 'success' }\n    };\n\n    if (!label || !labelMap[label]) return null;\n    const { text, variant } = labelMap[label];\n    return <Badge variant={variant} size=\"sm\">{text}</Badge>;\n  };\n\n  // Select all functionality\n  const isAllSelected = useMemo(() => {\n    return patients.length > 0 && patients.every(p => selectedPatients.includes(p.id || ''));\n  }, [patients, selectedPatients]);\n\n  const isPartiallySelected = useMemo(() => {\n    return selectedPatients.length > 0 && !isAllSelected;\n  }, [selectedPatients, isAllSelected]);\n\n  const handleSelectAll = useCallback(() => {\n    if (isAllSelected) {\n      patients.forEach(p => onPatientSelect?.(p.id || ''));\n    } else {\n      patients.forEach(p => {\n        if (!selectedPatients.includes(p.id || '')) {\n          onPatientSelect?.(p.id || '');\n        }\n      });\n    }\n  }, [patients, selectedPatients, isAllSelected, onPatientSelect]);\n\n  // Filter handlers\n  const handleFilterChange = useCallback((key: keyof PatientFilters, value: string) => {\n    const newFilters = { ...filters, [key]: value === 'all' ? undefined : value };\n    onFiltersChange?.(newFilters);\n  }, [filters, onFiltersChange]);\n\n  // Render patient row\n  const renderPatientRow = (patient: Patient, index: number) => {\n    const isSelected = selectedPatients.includes(patient.id || '');\n    const top = index * ITEM_HEIGHT;\n\n    return (\n      <div \n        key={patient.id || `patient-${index}`}\n        style={{ \n          position: 'absolute',\n          top: `${top}px`,\n          left: 0,\n          right: 0,\n          height: `${ITEM_HEIGHT}px`\n        }}\n        className={`flex items-center px-4 py-3 border-b border-gray-200 hover:bg-gray-50 transition-colors ${\n          isSelected ? 'bg-blue-50 border-blue-200' : ''\n        }`}\n      >\n        {/* Selection Checkbox */}\n        <div className=\"flex-shrink-0 mr-3\">\n          <Checkbox\n            checked={isSelected}\n            onChange={() => onPatientSelect?.(patient.id || '')}\n          />\n        </div>\n\n        {/* Patient Avatar */}\n        <div className=\"flex-shrink-0 mr-4\">\n          <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\n            <User className=\"w-5 h-5 text-blue-600\" />\n          </div>\n        </div>\n\n        {/* Patient Info */}\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center space-x-3 mb-1\">\n            <h3 \n              className=\"text-sm font-medium text-gray-900 truncate cursor-pointer hover:text-blue-600\"\n              onClick={() => onPatientClick?.(patient)}\n            >\n              {`${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta'}\n            </h3>\n            {getStatusBadge(patient.status)}\n            {getLabelBadge(patient.label)}\n          </div>\n          \n          <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n            {patient.tcNumber && (\n              <span>TC: {patient.tcNumber}</span>\n            )}\n            {patient.phone && (\n              <div className=\"flex items-center\">\n                <Phone className=\"w-3 h-3 mr-1\" />\n                {formatPhone(patient.phone)}\n              </div>\n            )}\n            {patient.email && (\n              <div className=\"flex items-center\">\n                <Mail className=\"w-3 h-3 mr-1\" />\n                <span className=\"truncate max-w-32\">{patient.email}</span>\n              </div>\n            )}\n            {patient.devices && patient.devices.length > 0 && (\n              <span className=\"text-green-600\">\n                {patient.devices.length} cihaz\n              </span>\n            )}\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex-shrink-0 flex items-center space-x-1\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onEdit?.(patient);\n            }}\n            title=\"Düzenle\"\n          >\n            <Edit className=\"w-4 h-4\" />\n          </Button>\n          \n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              setCommunicationPatient(patient);\n            }}\n            title=\"İletişim\"\n          >\n            <MessageSquare className=\"w-4 h-4\" />\n          </Button>\n          \n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onEdit?.(patient);\n            }}\n            title=\"Düzenle\"\n          >\n            <Edit className=\"w-4 h-4\" />\n          </Button>\n          \n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              onDelete?.(patient);\n            }}\n            title=\"Sil\"\n          >\n            <Trash2 className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n    );\n  };\n\n  if (loading && patients.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <Spinner size=\"lg\" />\n        <span className=\"ml-2 text-gray-600\">Hastalar yükleniyor...</span>\n      </div>\n    );\n  }\n\n  const totalHeight = patients.length * ITEM_HEIGHT;\n  const visiblePatients = patients.slice(visibleRange.startIndex, visibleRange.endIndex + 1);\n\n  return (\n    <div className={`bg-white shadow overflow-hidden sm:rounded-md ${className}`} ref={containerRef}>\n      {/* Header with Search and Filters */}\n      <div className=\"px-4 py-3 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <div className=\"flex items-center space-x-3\">\n            <Checkbox\n              checked={isAllSelected}\n              indeterminate={isPartiallySelected}\n              onChange={handleSelectAll}\n            />\n            <span className=\"text-sm text-gray-700\">\n              {selectedPatients.length > 0 \n                ? `${selectedPatients.length} hasta seçildi`\n                : `${patients.length} hasta`\n              }\n            </span>\n          </div>\n          \n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowFilters(!showFilters)}\n          >\n            <Filter className=\"w-4 h-4 mr-1\" />\n            Filtreler\n            {showFilters ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />}\n          </Button>\n        </div>\n\n        {/* Search */}\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n          <Input\n            placeholder=\"Hasta ara (isim, TC, telefon)...\"\n            value={searchTerm}\n            onChange={(e) => onSearchChange?.(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n\n        {/* Filters */}\n        {showFilters && (\n          <div className=\"mt-3 grid grid-cols-2 md:grid-cols-5 gap-3\">\n            <select\n              value={filters?.status || 'all'}\n              onChange={(e) => handleFilterChange('status', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Durumlar</option>\n              <option value=\"active\">Aktif</option>\n              <option value=\"inactive\">Pasif</option>\n              <option value=\"archived\">Arşivlenmiş</option>\n            </select>\n\n            <select\n              value={filters?.segment || 'all'}\n              onChange={(e) => handleFilterChange('segment', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Segmentler</option>\n              <option value=\"new\">Yeni</option>\n              <option value=\"trial\">Deneme</option>\n              <option value=\"purchased\">Satın Almış</option>\n              <option value=\"control\">Kontrol</option>\n              <option value=\"renewal\">Yenileme</option>\n            </select>\n\n            <select\n              value={filters?.label || 'all'}\n              onChange={(e) => handleFilterChange('label', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Etiketler</option>\n              <option value=\"yeni\">Yeni</option>\n              <option value=\"arama-bekliyor\">Arama Bekliyor</option>\n              <option value=\"randevu-verildi\">Randevu Verildi</option>\n              <option value=\"deneme-yapildi\">Deneme Yapıldı</option>\n              <option value=\"kontrol-hastasi\">Kontrol Hastası</option>\n              <option value=\"satis-tamamlandi\">Satış Tamamlandı</option>\n            </select>\n\n            <select\n              value={filters?.hasDevices ? 'true' : filters?.hasDevices === false ? 'false' : 'all'}\n              onChange={(e) => handleFilterChange('hasDevices', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Hastalar</option>\n              <option value=\"true\">Cihazı Var</option>\n              <option value=\"false\">Cihazı Yok</option>\n            </select>\n\n            <select\n              value={filters?.sgkStatus || 'all'}\n              onChange={(e) => handleFilterChange('sgkStatus', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm SGK Durumları</option>\n              <option value=\"pending\">Beklemede</option>\n              <option value=\"approved\">Onaylandı</option>\n              <option value=\"rejected\">Reddedildi</option>\n              <option value=\"paid\">Ödendi</option>\n            </select>\n          </div>\n        )}\n      </div>\n\n      {/* Virtual Scrolling Container */}\n      {patients.length > 0 ? (\n        <div \n          ref={scrollContainerRef}\n          style={{ height: containerHeight, overflow: 'auto' }}\n          onScroll={handleScroll}\n        >\n          <div style={{ height: totalHeight, position: 'relative' }}>\n            {visiblePatients.map((patient, index) => \n              renderPatientRow(patient, visibleRange.startIndex + index)\n            )}\n          </div>\n        </div>\n      ) : (\n        <div className=\"flex flex-col items-center justify-center py-12\">\n          <User className=\"w-12 h-12 text-gray-400 mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Hasta bulunamadı</h3>\n          <p className=\"text-gray-600 text-center\">\n            {searchTerm || Object.values(filters || {}).some(v => v)\n              ? 'Arama kriterlerinize uygun hasta bulunamadı.'\n              : 'Henüz hasta kaydı bulunmuyor.'\n            }\n          </p>\n        </div>\n      )}\n\n      {/* Loading indicator at bottom */}\n      {loading && patients.length > 0 && (\n        <div className=\"flex items-center justify-center py-4 border-t border-gray-200\">\n          <Spinner size=\"sm\" />\n          <span className=\"ml-2 text-sm text-gray-600\">Daha fazla hasta yükleniyor...</span>\n        </div>\n      )}\n\n      {/* Communication Modal */}\n      {communicationPatient && (\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\n          <div className=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n            <div className=\"fixed inset-0 transition-opacity\" aria-hidden=\"true\">\n              <div className=\"absolute inset-0 bg-gray-500 opacity-75\" onClick={() => setCommunicationPatient(null)}></div>\n            </div>\n\n            <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full\">\n              <div className=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">\n                    İletişim - {`${communicationPatient.firstName || ''} ${communicationPatient.lastName || ''}`.trim() || 'İsimsiz Hasta'}\n                  </h3>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setCommunicationPatient(null)}\n                  >\n                    ✕\n                  </Button>\n                </div>\n                \n                <PatientCommunicationIntegration\n                  patient={communicationPatient}\n                  onClose={() => setCommunicationPatient(null)}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SimpleVirtualizedPatientList;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/VirtualizedPatientList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onLoadMore' is defined but never used.","line":233,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":233,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'hasMore' is assigned a value but never used.","line":234,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'listData' is assigned a value but never used.","line":245,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":245,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":337,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":346,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":348,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":359,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":361,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":373,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":375,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":383,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":385,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":395,"endColumn":22}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Virtualized Patient List Component\n * High-performance patient list with virtual scrolling and lazy loading\n */\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Button, Badge, Checkbox, Spinner, Input } from '@x-ear/ui-web';\nimport { \n  User, \n  Phone, \n  Mail, \n  MessageSquare,\n  Eye,\n  Edit,\n  Trash2,\n  Search,\n  Filter,\n  ChevronDown,\n  ChevronUp\n} from 'lucide-react';\nimport { Patient } from '../../types/patient';\nimport { PatientCommunicationIntegration } from './PatientCommunicationIntegration';\n\ninterface VirtualizedPatientListProps {\n  patients: Patient[];\n  loading?: boolean;\n  selectedPatients?: string[];\n  onPatientSelect?: (patientId: string) => void;\n  onPatientClick?: (patient: Patient) => void;\n  onEdit?: (patient: Patient) => void;\n  onDelete?: (patient: Patient) => void;\n  onLoadMore?: () => void;\n  hasMore?: boolean;\n  searchTerm?: string;\n  onSearchChange?: (term: string) => void;\n  filters?: PatientFilters;\n  onFiltersChange?: (filters: PatientFilters) => void;\n  className?: string;\n}\n\ninterface PatientFilters {\n  status?: string;\n  segment?: string;\n  label?: string;\n  hasDevices?: boolean;\n  sgkStatus?: string;\n}\n\ninterface PatientRowProps {\n  index: number;\n  style: React.CSSProperties;\n  data: {\n    patients: Patient[];\n    selectedPatients: string[];\n    onPatientSelect?: (patientId: string) => void;\n    onPatientClick?: (patient: Patient) => void;\n    onEdit?: (patient: Patient) => void;\n    onDelete?: (patient: Patient) => void;\n    onCommunicationClick?: (patient: Patient) => void;\n  };\n}\n\n\n// Patient row component for virtualization\nconst PatientRow = ({ index, style, data }: PatientRowProps) => {\n  const patient = data.patients[index];\n  const isSelected = data.selectedPatients.includes(patient.id || '');\n\n  if (!patient) {\n    return (\n      <div style={style} className=\"flex items-center justify-center p-4\">\n        <Spinner size=\"sm\" />\n      </div>\n    );\n  }\n\n  const formatPhone = (phone?: string) => {\n    if (!phone) return '-';\n    const cleaned = phone.replace(/\\D/g, '');\n    if (cleaned.length === 11 && cleaned.startsWith('0')) {\n      return `${cleaned.slice(0, 4)} ${cleaned.slice(4, 7)} ${cleaned.slice(7, 9)} ${cleaned.slice(9)}`;\n    }\n    return phone;\n  };\n\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'active':\n        return <Badge variant=\"success\" size=\"sm\">Aktif</Badge>;\n      case 'inactive':\n        return <Badge variant=\"warning\" size=\"sm\">Pasif</Badge>;\n      default:\n        return <Badge variant=\"secondary\" size=\"sm\">Bilinmiyor</Badge>;\n    }\n  };\n\n  const getLabelBadge = (label?: string) => {\n    const labelMap: Record<string, { text: string; variant: 'default' | 'success' | 'warning' | 'danger' }> = {\n      'yeni': { text: 'Yeni', variant: 'default' },\n      'arama-bekliyor': { text: 'Arama Bekliyor', variant: 'warning' },\n      'randevu-verildi': { text: 'Randevu Verildi', variant: 'default' },\n      'deneme-yapildi': { text: 'Deneme Yapıldı', variant: 'default' },\n      'kontrol-hastasi': { text: 'Kontrol Hastası', variant: 'default' },\n      'satis-tamamlandi': { text: 'Satış Tamamlandı', variant: 'success' }\n    };\n\n    if (!label || !labelMap[label]) return null;\n    const { text, variant } = labelMap[label];\n    return <Badge variant={variant} size=\"sm\">{text}</Badge>;\n  };\n\n  return (\n    <div \n      style={style} \n      className={`flex items-center px-4 py-3 border-b border-gray-200 hover:bg-gray-50 transition-colors ${\n        isSelected ? 'bg-blue-50 border-blue-200' : ''\n      }`}\n    >\n      {/* Selection Checkbox */}\n      <div className=\"flex-shrink-0 mr-3\">\n        <Checkbox\n          checked={isSelected}\n          onChange={() => data.onPatientSelect?.(patient.id || '')}\n        />\n      </div>\n\n      {/* Patient Avatar */}\n      <div className=\"flex-shrink-0 mr-4\">\n        <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\n          <User className=\"w-5 h-5 text-blue-600\" />\n        </div>\n      </div>\n\n      {/* Patient Info */}\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"flex items-center space-x-3 mb-1\">\n          <h3 \n            className=\"text-sm font-medium text-gray-900 truncate cursor-pointer hover:text-blue-600\"\n            onClick={() => data.onPatientClick?.(patient)}\n          >\n            {`${patient.firstName || ''} ${patient.lastName || ''}`.trim() || 'İsimsiz Hasta'}\n          </h3>\n          {getStatusBadge(patient.status)}\n          {getLabelBadge(patient.label)}\n        </div>\n        \n        <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n          {patient.tcNumber && (\n            <span>TC: {patient.tcNumber}</span>\n          )}\n          {patient.phone && (\n            <div className=\"flex items-center\">\n              <Phone className=\"w-3 h-3 mr-1\" />\n              {formatPhone(patient.phone)}\n            </div>\n          )}\n          {patient.email && (\n            <div className=\"flex items-center\">\n              <Mail className=\"w-3 h-3 mr-1\" />\n              <span className=\"truncate max-w-32\">{patient.email}</span>\n            </div>\n          )}\n          {patient.devices && patient.devices.length > 0 && (\n            <span className=\"text-green-600\">\n              {patient.devices.length} cihaz\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex-shrink-0 flex items-center space-x-1\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={(e) => {\n            e.stopPropagation();\n            data.onPatientClick?.(patient);\n          }}\n          title=\"Görüntüle\"\n        >\n          <Eye className=\"w-4 h-4\" />\n        </Button>\n        \n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={(e) => {\n            e.stopPropagation();\n            data.onCommunicationClick?.(patient);\n          }}\n          title=\"İletişim\"\n        >\n          <MessageSquare className=\"w-4 h-4\" />\n        </Button>\n        \n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={(e) => {\n            e.stopPropagation();\n            data.onEdit?.(patient);\n          }}\n          title=\"Düzenle\"\n        >\n          <Edit className=\"w-4 h-4\" />\n        </Button>\n        \n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={(e) => {\n            e.stopPropagation();\n            data.onDelete?.(patient);\n          }}\n          title=\"Sil\"\n        >\n          <Trash2 className=\"w-4 h-4\" />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport const VirtualizedPatientList: React.FC<VirtualizedPatientListProps> = ({\n  patients,\n  loading = false,\n  selectedPatients = [],\n  onPatientSelect,\n  onPatientClick,\n  onEdit,\n  onDelete,\n  onLoadMore,\n  hasMore = false,\n  searchTerm = '',\n  onSearchChange,\n  filters,\n  onFiltersChange,\n  className = ''\n}) => {\n  const [communicationPatient, setCommunicationPatient] = useState<Patient | null>(null);\n  const [showFilters, setShowFilters] = useState(false);\n\n  // Memoized data for list\n  const listData = useMemo(() => ({\n    patients,\n    selectedPatients,\n    onPatientSelect,\n    onPatientClick,\n    onEdit,\n    onDelete,\n    onCommunicationClick: setCommunicationPatient\n  }), [patients, selectedPatients, onPatientSelect, onPatientClick, onEdit, onDelete]);\n\n  // Select all functionality\n  const isAllSelected = useMemo(() => {\n    return patients.length > 0 && patients.every(p => selectedPatients.includes(p.id || ''));\n  }, [patients, selectedPatients]);\n\n  const isPartiallySelected = useMemo(() => {\n    return selectedPatients.length > 0 && !isAllSelected;\n  }, [selectedPatients, isAllSelected]);\n\n  const handleSelectAll = useCallback(() => {\n    if (isAllSelected) {\n      // Deselect all\n      patients.forEach(p => onPatientSelect?.(p.id || ''));\n    } else {\n      // Select all visible\n      patients.forEach(p => {\n        if (!selectedPatients.includes(p.id || '')) {\n          onPatientSelect?.(p.id || '');\n        }\n      });\n    }\n  }, [patients, selectedPatients, isAllSelected, onPatientSelect]);\n\n  // Filter handlers\n  const handleFilterChange = useCallback((key: keyof PatientFilters, value: string) => {\n    const newFilters = { ...filters, [key]: value === 'all' ? undefined : value };\n    onFiltersChange?.(newFilters);\n  }, [filters, onFiltersChange]);\n\n  if (loading && patients.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <Spinner size=\"lg\" />\n        <span className=\"ml-2 text-gray-600\">Hastalar yükleniyor...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`bg-white shadow overflow-hidden sm:rounded-md ${className}`}>\n      {/* Header with Search and Filters */}\n      <div className=\"px-4 py-3 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <div className=\"flex items-center space-x-3\">\n            <Checkbox\n              checked={isAllSelected}\n              indeterminate={isPartiallySelected}\n              onChange={handleSelectAll}\n            />\n            <span className=\"text-sm text-gray-700\">\n              {selectedPatients.length > 0 \n                ? `${selectedPatients.length} hasta seçildi`\n                : `${patients.length} hasta`\n              }\n            </span>\n          </div>\n          \n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowFilters(!showFilters)}\n          >\n            <Filter className=\"w-4 h-4 mr-1\" />\n            Filtreler\n            {showFilters ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />}\n          </Button>\n        </div>\n\n        {/* Search */}\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n          <Input\n            placeholder=\"Hasta ara (isim, TC, telefon)...\"\n            value={searchTerm}\n            onChange={(e) => onSearchChange?.(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n\n        {/* Filters */}\n        {showFilters && (\n          <div className=\"mt-3 grid grid-cols-2 md:grid-cols-5 gap-3\">\n            <select\n              value={filters?.status || 'all'}\n              onChange={(e) => handleFilterChange('status', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Durumlar</option>\n              <option value=\"active\">Aktif</option>\n              <option value=\"inactive\">Pasif</option>\n              <option value=\"archived\">Arşivlenmiş</option>\n            </select>\n\n            <select\n              value={filters?.segment || 'all'}\n              onChange={(e) => handleFilterChange('segment', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Segmentler</option>\n              <option value=\"new\">Yeni</option>\n              <option value=\"trial\">Deneme</option>\n              <option value=\"purchased\">Satın Almış</option>\n              <option value=\"control\">Kontrol</option>\n              <option value=\"renewal\">Yenileme</option>\n            </select>\n\n            <select\n              value={filters?.label || 'all'}\n              onChange={(e) => handleFilterChange('label', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Etiketler</option>\n              <option value=\"yeni\">Yeni</option>\n              <option value=\"arama-bekliyor\">Arama Bekliyor</option>\n              <option value=\"randevu-verildi\">Randevu Verildi</option>\n              <option value=\"deneme-yapildi\">Deneme Yapıldı</option>\n              <option value=\"kontrol-hastasi\">Kontrol Hastası</option>\n              <option value=\"satis-tamamlandi\">Satış Tamamlandı</option>\n            </select>\n\n            <select\n              value={filters?.hasDevices ? 'true' : filters?.hasDevices === false ? 'false' : 'all'}\n              onChange={(e) => handleFilterChange('hasDevices', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm Hastalar</option>\n              <option value=\"true\">Cihazı Var</option>\n              <option value=\"false\">Cihazı Yok</option>\n            </select>\n\n            <select\n              value={filters?.sgkStatus || 'all'}\n              onChange={(e) => handleFilterChange('sgkStatus', e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-md text-sm\"\n            >\n              <option value=\"all\">Tüm SGK Durumları</option>\n              <option value=\"pending\">Beklemede</option>\n              <option value=\"approved\">Onaylandı</option>\n              <option value=\"rejected\">Reddedildi</option>\n              <option value=\"paid\">Ödendi</option>\n            </select>\n          </div>\n        )}\n      </div>\n\n      {/* Virtualized List */}\n      {patients.length > 0 ? (\n        <div className=\"max-h-96 overflow-y-auto\">\n          {patients.map((patient, index) => (\n            <PatientRow\n              key={patient.id}\n              index={index}\n              style={{}}\n              data={{\n                patients,\n                selectedPatients,\n                onPatientSelect,\n                onPatientClick,\n                onEdit,\n                onDelete,\n                onCommunicationClick: setCommunicationPatient\n              }}\n            />\n          ))}\n        </div>\n      ) : (\n        <div className=\"flex flex-col items-center justify-center py-12\">\n          <User className=\"w-12 h-12 text-gray-400 mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Hasta bulunamadı</h3>\n          <p className=\"text-gray-600 text-center\">\n            {searchTerm || Object.values(filters || {}).some(v => v)\n              ? 'Arama kriterlerinize uygun hasta bulunamadı.'\n              : 'Henüz hasta kaydı bulunmuyor.'\n            }\n          </p>\n        </div>\n      )}\n\n      {/* Loading indicator at bottom */}\n      {loading && patients.length > 0 && (\n        <div className=\"flex items-center justify-center py-4 border-t border-gray-200\">\n          <Spinner size=\"sm\" />\n          <span className=\"ml-2 text-sm text-gray-600\">Daha fazla hasta yükleniyor...</span>\n        </div>\n      )}\n\n      {/* Communication Modal */}\n      {communicationPatient && (\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\n          <div className=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n            <div className=\"fixed inset-0 transition-opacity\" aria-hidden=\"true\">\n              <div className=\"absolute inset-0 bg-gray-500 opacity-75\" onClick={() => setCommunicationPatient(null)}></div>\n            </div>\n\n            <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full\">\n              <div className=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">\n                    İletişim - {`${communicationPatient.firstName || ''} ${communicationPatient.lastName || ''}`.trim() || 'İsimsiz Hasta'}\n                  </h3>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setCommunicationPatient(null)}\n                  >\n                    ✕\n                  </Button>\n                </div>\n                \n                <PatientCommunicationIntegration\n                  patient={communicationPatient}\n                  onClose={() => setCommunicationPatient(null)}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default VirtualizedPatientList;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/csv/PatientCSVUpload.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":138,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":144,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":149,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":155,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":187,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":192,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":203,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":208,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":209,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":214,"endColumn":22}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef } from 'react'\nimport { Upload, FileText, CheckCircle, AlertCircle } from 'lucide-react'\n\ninterface PatientCSVUploadProps {\n  onUpload?: (file: File) => Promise<void>\n  className?: string\n}\n\ninterface UploadStatus {\n  status: 'idle' | 'uploading' | 'success' | 'error'\n  message?: string\n  progress?: number\n}\n\nexport const PatientCSVUpload: React.FC<PatientCSVUploadProps> = ({\n  onUpload,\n  className = \"\"\n}) => {\n  const [uploadStatus, setUploadStatus] = useState<UploadStatus>({ status: 'idle' })\n  const [dragActive, setDragActive] = useState(false)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true)\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false)\n    }\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    setDragActive(false)\n    \n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFile(e.dataTransfer.files[0])\n    }\n  }\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    e.preventDefault()\n    if (e.target.files && e.target.files[0]) {\n      handleFile(e.target.files[0])\n    }\n  }\n\n  const handleFile = async (file: File) => {\n    // Validate file type\n    if (!file.name.toLowerCase().endsWith('.csv')) {\n      setUploadStatus({\n        status: 'error',\n        message: 'Lütfen sadece CSV dosyası yükleyin'\n      })\n      return\n    }\n\n    // Validate file size (max 10MB)\n    if (file.size > 10 * 1024 * 1024) {\n      setUploadStatus({\n        status: 'error',\n        message: 'Dosya boyutu 10MB\\'dan küçük olmalıdır'\n      })\n      return\n    }\n\n    try {\n      setUploadStatus({ status: 'uploading', progress: 0 })\n      \n      // Simulate progress\n      const progressInterval = setInterval(() => {\n        setUploadStatus(prev => ({\n          ...prev,\n          progress: Math.min((prev.progress || 0) + 10, 90)\n        }))\n      }, 200)\n\n      if (onUpload) {\n        await onUpload(file)\n      }\n\n      clearInterval(progressInterval)\n      setUploadStatus({\n        status: 'success',\n        message: `${file.name} başarıyla yüklendi`\n      })\n\n      // Reset after 3 seconds\n      setTimeout(() => {\n        setUploadStatus({ status: 'idle' })\n        if (fileInputRef.current) {\n          fileInputRef.current.value = ''\n        }\n      }, 3000)\n\n    } catch (error) {\n      setUploadStatus({\n        status: 'error',\n        message: 'Dosya yüklenirken hata oluştu'\n      })\n    }\n  }\n\n  const onButtonClick = () => {\n    fileInputRef.current?.click()\n  }\n\n  const resetUpload = () => {\n    setUploadStatus({ status: 'idle' })\n    if (fileInputRef.current) {\n      fileInputRef.current.value = ''\n    }\n  }\n\n  return (\n    <div className={`bg-white border border-gray-200 rounded-lg p-6 ${className}`}>\n      <div className=\"mb-4\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n          CSV Dosyası Yükle\n        </h3>\n        <p className=\"text-sm text-gray-600\">\n          Hasta verilerini toplu olarak içe aktarmak için CSV dosyası yükleyin\n        </p>\n      </div>\n\n      {uploadStatus.status === 'idle' && (\n        <div\n          className={`relative border-2 border-dashed rounded-lg p-6 text-center hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors ${\n            dragActive ? 'border-indigo-400 bg-indigo-50' : 'border-gray-300'\n          }`}\n          onDragEnter={handleDrag}\n          onDragLeave={handleDrag}\n          onDragOver={handleDrag}\n          onDrop={handleDrop}\n        >\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\".csv\"\n            onChange={handleChange}\n            className=\"absolute inset-0 w-full h-full opacity-0 cursor-pointer\"\n          />\n          \n          <Upload className=\"mx-auto h-12 w-12 text-gray-400\" />\n          <div className=\"mt-4\">\n            <p className=\"text-sm text-gray-600\">\n              <button\n                type=\"button\"\n                onClick={onButtonClick}\n                className=\"font-medium text-indigo-600 hover:text-indigo-500\"\n              >\n                Dosya seçin\n              </button>\n              {' '}veya sürükleyip bırakın\n            </p>\n            <p className=\"text-xs text-gray-500 mt-1\">\n              CSV dosyası, maksimum 10MB\n            </p>\n          </div>\n        </div>\n      )}\n\n      {uploadStatus.status === 'uploading' && (\n        <div className=\"text-center py-6\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto mb-4\"></div>\n          <p className=\"text-sm text-gray-600 mb-2\">Dosya yükleniyor...</p>\n          <div className=\"w-full bg-gray-200 rounded-full h-2\">\n            <div\n              className=\"bg-indigo-600 h-2 rounded-full transition-all duration-300\"\n              style={{ width: `${uploadStatus.progress || 0}%` }}\n            ></div>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-1\">\n            %{uploadStatus.progress || 0} tamamlandı\n          </p>\n        </div>\n      )}\n\n      {uploadStatus.status === 'success' && (\n        <div className=\"text-center py-6\">\n          <CheckCircle className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n          <p className=\"text-sm text-green-600 font-medium\">\n            {uploadStatus.message}\n          </p>\n          <button\n            onClick={resetUpload}\n            className=\"mt-3 text-sm text-gray-500 hover:text-gray-700\"\n          >\n            Yeni dosya yükle\n          </button>\n        </div>\n      )}\n\n      {uploadStatus.status === 'error' && (\n        <div className=\"text-center py-6\">\n          <AlertCircle className=\"mx-auto h-12 w-12 text-red-500 mb-4\" />\n          <p className=\"text-sm text-red-600 font-medium mb-3\">\n            {uploadStatus.message}\n          </p>\n          <div className=\"flex justify-center space-x-3\">\n            <button\n              onClick={resetUpload}\n              className=\"text-sm text-gray-500 hover:text-gray-700\"\n            >\n              İptal\n            </button>\n            <button\n              onClick={onButtonClick}\n              className=\"text-sm text-indigo-600 hover:text-indigo-500 font-medium\"\n            >\n              Tekrar dene\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* CSV Format Info */}\n      <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\n        <div className=\"flex items-start space-x-2\">\n          <FileText className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n          <div>\n            <h4 className=\"text-sm font-medium text-gray-900 mb-1\">\n              CSV Format Bilgisi\n            </h4>\n            <p className=\"text-xs text-gray-600 mb-2\">\n              CSV dosyanız aşağıdaki sütunları içermelidir:\n            </p>\n            <div className=\"text-xs text-gray-500 space-y-1\">\n              <div>• <code className=\"bg-gray-200 px-1 rounded\">firstName</code> - Ad (zorunlu)</div>\n              <div>• <code className=\"bg-gray-200 px-1 rounded\">lastName</code> - Soyad (zorunlu)</div>\n              <div>• <code className=\"bg-gray-200 px-1 rounded\">tcNumber</code> - TC Kimlik No</div>\n              <div>• <code className=\"bg-gray-200 px-1 rounded\">phone</code> - Telefon</div>\n              <div>• <code className=\"bg-gray-200 px-1 rounded\">email</code> - E-posta</div>\n              <div>• <code className=\"bg-gray-200 px-1 rounded\">birthDate</code> - Doğum Tarihi (YYYY-MM-DD)</div>\n              <div>• <code className=\"bg-gray-200 px-1 rounded\">gender</code> - Cinsiyet (M/F)</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/list/PatientCSVUpload.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":106,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":111,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":134,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":139,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":140,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":146,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":160,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":166,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":195,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":201,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":202,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":208,"endColumn":22}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState } from 'react';\nimport { Upload, FileText, X, CheckCircle, AlertCircle } from 'lucide-react';\n\ninterface PatientCSVUploadProps {\n  onUpload: (file: File) => Promise<void>;\n  onClose?: () => void;\n  className?: string;\n}\n\ninterface UploadStatus {\n  status: 'idle' | 'uploading' | 'success' | 'error';\n  message?: string;\n  progress?: number;\n}\n\nexport const PatientCSVUpload: React.FC<PatientCSVUploadProps> = ({\n  onUpload,\n  onClose,\n  className = \"\"\n}) => {\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [dragActive, setDragActive] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [uploadStatus, setUploadStatus] = useState<UploadStatus>({ status: 'idle' });\n\n  const handleDrag = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\n      setDragActive(true);\n    } else if (e.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragActive(false);\n    \n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFileSelect(e.dataTransfer.files[0]);\n    }\n  };\n\n  const handleFileSelect = (file: File) => {\n    if (file.type !== 'text/csv' && !file.name.endsWith('.csv')) {\n      setUploadStatus({\n        status: 'error',\n        message: 'Lütfen sadece CSV dosyası seçin.'\n      });\n      return;\n    }\n\n    setSelectedFile(file);\n    setUploadStatus({ status: 'idle' });\n  };\n\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFileSelect(e.target.files[0]);\n    }\n  };\n\n  const handleUpload = async () => {\n    if (!selectedFile) return;\n\n    setUploadStatus({ status: 'uploading', progress: 0 });\n\n    try {\n      await onUpload(selectedFile);\n      setUploadStatus({\n        status: 'success',\n        message: 'Dosya başarıyla yüklendi!'\n      });\n      \n      // Reset after success\n      setTimeout(() => {\n        setSelectedFile(null);\n        setUploadStatus({ status: 'idle' });\n        if (fileInputRef.current) {\n          fileInputRef.current.value = '';\n        }\n      }, 2000);\n    } catch (error) {\n      setUploadStatus({\n        status: 'error',\n        message: error instanceof Error ? error.message : 'Dosya yüklenirken hata oluştu.'\n      });\n    }\n  };\n\n  const handleRemoveFile = () => {\n    setSelectedFile(null);\n    setUploadStatus({ status: 'idle' });\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  return (\n    <div className={`bg-white rounded-lg border border-gray-200 p-6 ${className}`}>\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900\">CSV Dosyası Yükle</h3>\n        {onClose && (\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n          >\n            <X className=\"h-5 w-5\" />\n          </button>\n        )}\n      </div>\n\n      {!selectedFile ? (\n        <div\n          className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${\n            dragActive\n              ? 'border-blue-400 bg-blue-50'\n              : 'border-gray-300 hover:border-gray-400'\n          }`}\n          onDragEnter={handleDrag}\n          onDragLeave={handleDrag}\n          onDragOver={handleDrag}\n          onDrop={handleDrop}\n        >\n          <Upload className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n          <p className=\"text-lg font-medium text-gray-900 mb-2\">\n            CSV dosyasını buraya sürükleyin\n          </p>\n          <p className=\"text-sm text-gray-500 mb-4\">\n            veya dosya seçmek için tıklayın\n          </p>\n          <button\n            onClick={() => fileInputRef.current?.click()}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors\"\n          >\n            Dosya Seç\n          </button>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\".csv\"\n            onChange={handleFileInputChange}\n            className=\"hidden\"\n          />\n        </div>\n      ) : (\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\n            <div className=\"flex items-center gap-3\">\n              <FileText className=\"h-8 w-8 text-blue-600\" />\n              <div>\n                <p className=\"font-medium text-gray-900\">{selectedFile.name}</p>\n                <p className=\"text-sm text-gray-500\">\n                  {(selectedFile.size / 1024).toFixed(1)} KB\n                </p>\n              </div>\n            </div>\n            <button\n              onClick={handleRemoveFile}\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n              disabled={uploadStatus.status === 'uploading'}\n            >\n              <X className=\"h-5 w-5\" />\n            </button>\n          </div>\n\n          {uploadStatus.status !== 'idle' && (\n            <div className=\"p-4 rounded-lg\">\n              {uploadStatus.status === 'uploading' && (\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                  <span className=\"text-sm text-gray-600\">Yükleniyor...</span>\n                </div>\n              )}\n              \n              {uploadStatus.status === 'success' && (\n                <div className=\"flex items-center gap-3 text-green-600\">\n                  <CheckCircle className=\"h-5 w-5\" />\n                  <span className=\"text-sm\">{uploadStatus.message}</span>\n                </div>\n              )}\n              \n              {uploadStatus.status === 'error' && (\n                <div className=\"flex items-center gap-3 text-red-600\">\n                  <AlertCircle className=\"h-5 w-5\" />\n                  <span className=\"text-sm\">{uploadStatus.message}</span>\n                </div>\n              )}\n            </div>\n          )}\n\n          <div className=\"flex gap-3\">\n            <button\n              onClick={handleUpload}\n              disabled={uploadStatus.status === 'uploading'}\n              className=\"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              {uploadStatus.status === 'uploading' ? 'Yükleniyor...' : 'Yükle'}\n            </button>\n            <button\n              onClick={handleRemoveFile}\n              disabled={uploadStatus.status === 'uploading'}\n              className=\"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              İptal\n            </button>\n          </div>\n        </div>\n      )}\n\n      <div className=\"mt-4 p-3 bg-blue-50 rounded-lg\">\n        <p className=\"text-xs text-blue-800\">\n          <strong>Not:</strong> CSV dosyası şu sütunları içermelidir: Ad, Soyad, E-posta, Telefon, Doğum Tarihi\n        </p>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/list/PatientList.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":63,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":65,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":66,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":68,"endColumn":26}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport type { Patient } from '@/types/patient';\n\ninterface PatientListProps {\n  patients: Patient[];\n}\n\nexport function PatientList({ patients }: PatientListProps) {\n  if (patients.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"text-gray-500\">Hasta bulunamadı</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"overflow-auto\">\n      <table className=\"min-w-full divide-y divide-gray-200\">\n        <thead className=\"bg-gray-50\">\n          <tr>\n            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Ad Soyad\n            </th>\n            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              TC Kimlik\n            </th>\n            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Telefon\n            </th>\n            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Durum\n            </th>\n            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              İşlemler\n            </th>\n          </tr>\n        </thead>\n        <tbody className=\"bg-white divide-y divide-gray-200\">\n          {patients.map((patient) => (\n            <tr key={patient.id} className=\"hover:bg-gray-50\">\n              <td className=\"px-6 py-4 whitespace-nowrap\">\n                <div className=\"text-sm font-medium text-gray-900\">\n                  {patient.firstName} {patient.lastName}\n                </div>\n              </td>\n              <td className=\"px-6 py-4 whitespace-nowrap\">\n                <div className=\"text-sm text-gray-900\">{patient.tcNumber}</div>\n              </td>\n              <td className=\"px-6 py-4 whitespace-nowrap\">\n                <div className=\"text-sm text-gray-900\">{patient.phone}</div>\n              </td>\n              <td className=\"px-6 py-4 whitespace-nowrap\">\n                <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                  patient.status === 'ACTIVE' \n                    ? 'bg-green-100 text-green-800' \n                    : 'bg-red-100 text-red-800'\n                }`}>\n                  {patient.status === 'ACTIVE' ? 'Aktif' : 'Pasif'}\n                </span>\n              </td>\n              <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                <button className=\"text-indigo-600 hover:text-indigo-900 mr-3\">\n                  Düzenle\n                </button>\n                <button className=\"text-red-600 hover:text-red-900\">\n                  Sil\n                </button>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/list/PatientSavedViews.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[187,190],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[187,190],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[419,422],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[419,422],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[505,508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[505,508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[595,598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[595,598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":71,"column":9,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":77,"endColumn":18},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":84,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":91,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":93,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":99,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":100,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":105,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":122,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":128,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":130,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":136,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":137,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":142,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":148,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":166,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":170,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":176,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":178,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":184,"endColumn":30}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Bookmark, Plus, Edit2, Trash2, Eye } from 'lucide-react';\n\ninterface SavedView {\n  id: string;\n  name: string;\n  filters: Record<string, any>;\n  isDefault?: boolean;\n  createdAt: Date;\n}\n\ninterface PatientSavedViewsProps {\n  savedViews: SavedView[];\n  currentView?: string;\n  onSelectView: (viewId: string) => void;\n  onSaveView: (name: string, filters: Record<string, any>) => void;\n  onUpdateView: (viewId: string, name: string, filters: Record<string, any>) => void;\n  onDeleteView: (viewId: string) => void;\n  currentFilters: Record<string, any>;\n  className?: string;\n}\n\nexport const PatientSavedViews: React.FC<PatientSavedViewsProps> = ({\n  savedViews,\n  currentView,\n  onSelectView,\n  onSaveView,\n  onUpdateView,\n  onDeleteView,\n  currentFilters,\n  className = \"\"\n}) => {\n  const [isCreating, setIsCreating] = useState(false);\n  const [editingView, setEditingView] = useState<string | null>(null);\n  const [viewName, setViewName] = useState('');\n\n  const handleSaveNew = () => {\n    if (viewName.trim()) {\n      onSaveView(viewName.trim(), currentFilters);\n      setViewName('');\n      setIsCreating(false);\n    }\n  };\n\n  const handleUpdateView = (viewId: string) => {\n    if (viewName.trim()) {\n      onUpdateView(viewId, viewName.trim(), currentFilters);\n      setViewName('');\n      setEditingView(null);\n    }\n  };\n\n  const startEditing = (view: SavedView) => {\n    setEditingView(view.id);\n    setViewName(view.name);\n  };\n\n  const cancelEditing = () => {\n    setEditingView(null);\n    setIsCreating(false);\n    setViewName('');\n  };\n\n  return (\n    <div className={`bg-white rounded-lg border border-gray-200 p-4 ${className}`}>\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-sm font-medium text-gray-900 flex items-center gap-2\">\n          <Bookmark className=\"h-4 w-4\" />\n          Kayıtlı Görünümler\n        </h3>\n        <button\n          onClick={() => setIsCreating(true)}\n          className=\"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center gap-1\"\n        >\n          <Plus className=\"h-4 w-4\" />\n          Yeni Görünüm\n        </button>\n      </div>\n\n      <div className=\"space-y-2\">\n        {/* Create New View */}\n        {isCreating && (\n          <div className=\"p-3 border border-blue-200 rounded-lg bg-blue-50\">\n            <input\n              type=\"text\"\n              value={viewName}\n              onChange={(e) => setViewName(e.target.value)}\n              placeholder=\"Görünüm adı...\"\n              className=\"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 mb-2\"\n              autoFocus\n            />\n            <div className=\"flex gap-2\">\n              <button\n                onClick={handleSaveNew}\n                disabled={!viewName.trim()}\n                className=\"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Kaydet\n              </button>\n              <button\n                onClick={cancelEditing}\n                className=\"px-3 py-1 text-xs border border-gray-300 text-gray-700 rounded hover:bg-gray-50\"\n              >\n                İptal\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Saved Views List */}\n        {savedViews.map((view) => (\n          <div\n            key={view.id}\n            className={`p-3 rounded-lg border transition-colors ${\n              currentView === view.id\n                ? 'border-blue-200 bg-blue-50'\n                : 'border-gray-200 hover:border-gray-300'\n            }`}\n          >\n            {editingView === view.id ? (\n              <div>\n                <input\n                  type=\"text\"\n                  value={viewName}\n                  onChange={(e) => setViewName(e.target.value)}\n                  className=\"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 mb-2\"\n                  autoFocus\n                />\n                <div className=\"flex gap-2\">\n                  <button\n                    onClick={() => handleUpdateView(view.id)}\n                    disabled={!viewName.trim()}\n                    className=\"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    Güncelle\n                  </button>\n                  <button\n                    onClick={cancelEditing}\n                    className=\"px-3 py-1 text-xs border border-gray-300 text-gray-700 rounded hover:bg-gray-50\"\n                  >\n                    İptal\n                  </button>\n                </div>\n              </div>\n            ) : (\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex-1\">\n                  <button\n                    onClick={() => onSelectView(view.id)}\n                    className=\"text-left w-full\"\n                  >\n                    <div className=\"flex items-center gap-2\">\n                      <Eye className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-sm font-medium text-gray-900\">\n                        {view.name}\n                      </span>\n                      {view.isDefault && (\n                        <span className=\"px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded-full\">\n                          Varsayılan\n                        </span>\n                      )}\n                    </div>\n                    <p className=\"text-xs text-gray-500 mt-1 ml-6\">\n                      {new Date(view.createdAt).toLocaleDateString('tr-TR')}\n                    </p>\n                  </button>\n                </div>\n                \n                <div className=\"flex items-center gap-1\">\n                  <button\n                    onClick={() => startEditing(view)}\n                    className=\"p-1 text-gray-400 hover:text-gray-600 rounded\"\n                    title=\"Düzenle\"\n                  >\n                    <Edit2 className=\"h-3 w-3\" />\n                  </button>\n                  {!view.isDefault && (\n                    <button\n                      onClick={() => onDeleteView(view.id)}\n                      className=\"p-1 text-gray-400 hover:text-red-600 rounded\"\n                      title=\"Sil\"\n                    >\n                      <Trash2 className=\"h-3 w-3\" />\n                    </button>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        ))}\n\n        {savedViews.length === 0 && !isCreating && (\n          <div className=\"text-center py-6 text-gray-500\">\n            <Bookmark className=\"h-8 w-8 mx-auto mb-2 text-gray-300\" />\n            <p className=\"text-sm\">Henüz kayıtlı görünüm yok</p>\n            <p className=\"text-xs\">Filtreleri ayarlayıp yeni görünüm oluşturun</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/list/PatientStats.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/AppointmentModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Card' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardContent' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardHeader' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardTitle' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Badge' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":8},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[681,684],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[681,684],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":153,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4096,4099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4096,4099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":266,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":274,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":330,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":343,"endColumn":28}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Button, \n  Input, \n  Textarea,\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Alert,\n  Spinner\n} from '@x-ear/ui-web';\nimport { X, Calendar, Clock, User, FileText, AlertCircle, CheckCircle } from 'lucide-react';\nimport { Patient } from '../../../types/patient';\n\ninterface Appointment {\n  id: string;\n  date: string;\n  note?: string;\n  status: 'scheduled' | 'completed' | 'cancelled';\n  createdAt?: string;\n  updatedAt?: string;\n}\n\ninterface AppointmentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  appointment?: Appointment | null;\n  onAppointmentSave: (appointmentData: any) => void;\n  loading?: boolean;\n}\n\nexport const AppointmentModal: React.FC<AppointmentModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  appointment,\n  onAppointmentSave,\n  loading = false\n}) => {\n  const [formData, setFormData] = useState({\n    date: '',\n    note: '',\n    status: 'scheduled' as 'scheduled' | 'completed' | 'cancelled'\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  const isEditing = !!appointment;\n\n  useEffect(() => {\n    if (isOpen) {\n      if (appointment) {\n        // Editing existing appointment\n        const appointmentDate = new Date(appointment.date);\n        const localDateTime = new Date(appointmentDate.getTime() - appointmentDate.getTimezoneOffset() * 60000)\n          .toISOString()\n          .slice(0, 16);\n        \n        setFormData({\n          date: localDateTime,\n          note: appointment.note || '',\n          status: appointment.status\n        });\n      } else {\n        // Creating new appointment - set default to next hour\n        const now = new Date();\n        const nextHour = new Date(now.getFullYear(), now.getMonth(), now.getDate(), now.getHours() + 1, 0);\n        const localDateTime = new Date(nextHour.getTime() - nextHour.getTimezoneOffset() * 60000)\n          .toISOString()\n          .slice(0, 16);\n        \n        setFormData({\n          date: localDateTime,\n          note: '',\n          status: 'scheduled'\n        });\n      }\n      setErrors({});\n    }\n  }, [isOpen, appointment]);\n\n  if (!isOpen) return null;\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.date) {\n      newErrors.date = 'Randevu tarihi ve saati gereklidir';\n    } else {\n      const appointmentDate = new Date(formData.date);\n      const now = new Date();\n      \n      if (appointmentDate < now && formData.status === 'scheduled') {\n        newErrors.date = 'Geçmiş tarih için randevu durumu \"Planlandı\" olamaz';\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    setError(null);\n    setSuccess(null);\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      const appointmentData = {\n        id: appointment?.id || `appt_${Date.now()}`,\n        date: new Date(formData.date).toISOString(),\n        note: formData.note.trim() || undefined,\n        status: formData.status,\n        ...(isEditing \n          ? { updatedAt: new Date().toISOString() }\n          : { createdAt: new Date().toISOString() }\n        )\n      };\n\n      onAppointmentSave(appointmentData);\n      \n      setSuccess(isEditing ? 'Randevu başarıyla güncellendi' : 'Randevu başarıyla oluşturuldu');\n      \n      // Reset form after successful submission\n      setTimeout(() => {\n        setError(null);\n        setSuccess(null);\n        onClose();\n      }, 2000);\n      \n    } catch (err) {\n      setError('Randevu kaydedilirken bir hata oluştu. Lütfen tekrar deneyiniz.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleInputChange = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    \n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  const formatDateTime = (dateString: string) => {\n    return new Date(dateString).toLocaleString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'scheduled': return 'text-blue-700 bg-blue-50';\n      case 'completed': return 'text-green-700 bg-green-50';\n      case 'cancelled': return 'text-red-700 bg-red-50';\n      default: return 'text-gray-700 bg-gray-50';\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    switch (status) {\n      case 'scheduled': return 'Planlandı';\n      case 'completed': return 'Tamamlandı';\n      case 'cancelled': return 'İptal Edildi';\n      default: return status;\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <Calendar className=\"w-5 h-5 mr-2\" />\n            {isEditing ? 'Randevuyu Düzenle' : 'Yeni Randevu'}\n          </h3>\n          <Button\n            onClick={onClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"space-y-6\">\n            {/* Patient Info */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <h4 className=\"font-medium text-gray-900 mb-2 flex items-center\">\n                <User className=\"w-4 h-4 mr-2\" />\n                Hasta Bilgileri\n              </h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"font-medium\">Ad Soyad:</span> {patient.firstName} {patient.lastName}\n                </div>\n                <div>\n                  <span className=\"font-medium\">TC No:</span> {patient.tcNumber}\n                </div>\n                <div>\n                  <span className=\"font-medium\">Telefon:</span> {patient.phone}\n                </div>\n                <div>\n                  <span className=\"font-medium\">E-posta:</span> {patient.email || 'Belirtilmemiş'}\n                </div>\n              </div>\n            </div>\n\n            {/* Appointment Details */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <Clock className=\"w-4 h-4 mr-2\" />\n                Randevu Detayları\n              </h4>\n\n              {/* Date and Time */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Tarih ve Saat *\n                </label>\n                <Input\n                  type=\"datetime-local\"\n                  value={formData.date}\n                  onChange={(e) => handleInputChange('date', e.target.value)}\n                  className={errors.date ? 'border-red-500' : ''}\n                />\n                {errors.date && (\n                  <div className=\"flex items-center mt-1 text-sm text-red-600\">\n                    <AlertCircle className=\"w-4 h-4 mr-1\" />\n                    {errors.date}\n                  </div>\n                )}\n                {formData.date && (\n                  <div className=\"mt-1 text-sm text-gray-600\">\n                    Seçilen tarih: {formatDateTime(formData.date)}\n                  </div>\n                )}\n              </div>\n\n              {/* Status */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Durum\n                </label>\n                <select\n                  value={formData.status}\n                  onChange={(e) => handleInputChange('status', e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"scheduled\">Planlandı</option>\n                  <option value=\"completed\">Tamamlandı</option>\n                  <option value=\"cancelled\">İptal Edildi</option>\n                </select>\n                <div className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mt-2 ${getStatusColor(formData.status)}`}>\n                  {getStatusLabel(formData.status)}\n                </div>\n              </div>\n\n              {/* Notes */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\">\n                  <FileText className=\"w-4 h-4 mr-1\" />\n                  Notlar (Opsiyonel)\n                </label>\n                <Textarea\n                  value={formData.note}\n                  onChange={(e) => handleInputChange('note', e.target.value)}\n                  placeholder=\"Randevu ile ilgili notlar, özel talimatlar veya hatırlatmalar...\"\n                  rows={4}\n                  className=\"resize-none\"\n                />\n                <div className=\"text-xs text-gray-500 mt-1\">\n                  {formData.note.length}/500 karakter\n                </div>\n              </div>\n            </div>\n\n            {/* Existing Appointment Info */}\n            {isEditing && appointment && (\n              <div className=\"bg-blue-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Mevcut Randevu Bilgileri</h4>\n                <div className=\"text-sm space-y-1\">\n                  <div>\n                    <span className=\"font-medium\">Oluşturulma:</span> {\n                      appointment.createdAt ? formatDateTime(appointment.createdAt) : 'Bilinmiyor'\n                    }\n                  </div>\n                  {appointment.updatedAt && (\n                    <div>\n                      <span className=\"font-medium\">Son Güncelleme:</span> {formatDateTime(appointment.updatedAt)}\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {/* Quick Actions for Common Appointment Types */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <h4 className=\"font-medium text-gray-900 mb-2\">Hızlı Notlar</h4>\n              <div className=\"grid grid-cols-2 gap-2\">\n                {[\n                  'Kontrol muayenesi',\n                  'Cihaz ayarı',\n                  'Kulak kalıbı alımı',\n                  'Odyometri testi',\n                  'Cihaz temizliği',\n                  'Garanti kontrolü'\n                ].map((quickNote) => (\n                  <button\n                    key={quickNote}\n                    type=\"button\"\n                    onClick={() => {\n                      const currentNote = formData.note.trim();\n                      const newNote = currentNote \n                        ? `${currentNote}\\n• ${quickNote}`\n                        : `• ${quickNote}`;\n                      handleInputChange('note', newNote);\n                    }}\n                    className=\"text-left p-2 text-sm border border-gray-200 rounded hover:bg-gray-100 transition-colors\"\n                  >\n                    + {quickNote}\n                  </button>\n                ))}\n              </div>\n            </div>\n            \n            {/* Status Messages */}\n            {error && (\n              <Alert variant=\"error\" className=\"border-red-200 bg-red-50\">\n                <AlertCircle className=\"h-4 w-4 text-red-600\" />\n                {error}\n              </Alert>\n            )}\n            \n            {success && (\n              <Alert variant=\"success\" className=\"border-green-200 bg-green-50\">\n                <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                {success}\n              </Alert>\n            )}\n          </div>\n\n          <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n            <Button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n            >\n              İptal\n            </Button>\n            <Button\n              type=\"submit\"\n              className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center\"\n              disabled={loading || isLoading}\n            >\n              {(loading || isLoading) && <Spinner className=\"w-4 h-4 mr-2\" />}\n              {(loading || isLoading) ? 'Kaydediliyor...' : (isEditing ? 'Güncelle' : 'Randevu Oluştur')}\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default AppointmentModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/CollectionModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardHeader' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardTitle' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'APISale' is defined but never used.","line":16,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[945,948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[945,948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1003,1006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1003,1006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1055,1058],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1055,1058],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used.","line":51,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":10},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'sale.totalAmount'. Either include it or remove the dependency array.","line":139,"column":6,"nodeType":"ArrayExpression","endLine":139,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, sale.id, sale.totalAmount]","fix":{"range":[4677,4695],"text":"[isOpen, sale.id, sale.totalAmount]"}}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":446,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":456,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":457,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":472,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":523,"column":27,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":529,"endColumn":29},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":563,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":569,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":570,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":576,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":603,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":615,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":606,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":606,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21884,21887],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21884,21887],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":628,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":636,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":683,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":689,"endColumn":21},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":870,"column":39,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":876,"endColumn":48},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":877,"column":39,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":883,"endColumn":48},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":890,"column":37,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":899,"endColumn":46},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":892,"column":101,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":892,"endColumn":104,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35891,35894],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35891,35894],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Button, \n  Input, \n  Textarea,\n  Alert,\n  Spinner,\n  Badge,\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle\n} from '@x-ear/ui-web';\nimport { X, DollarSign, Calendar, Receipt, CreditCard, Banknote, AlertCircle, CheckCircle, FileText, Clock, Plus } from 'lucide-react';\nimport { Patient } from '../../../types/patient';\nimport { Sale as APISale } from '../../../api/generated/api';\nimport { Sale, Installment } from '../../../types/patient/patient-communication.types';\n\ninterface PromissoryNote {\n  id: string;\n  noteNumber: string;\n  amount: number;\n  paidAmount: number;\n  remainingAmount: number;\n  dueDate: string;\n  status: 'active' | 'paid' | 'partial' | 'overdue';\n  referenceNumber?: string;\n  notes?: string;\n  saleId: string;\n}\n\ninterface CollectionModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  sale: Sale;\n  onPaymentCreate: (paymentData: any) => void;\n  onPromissoryPaymentCreate?: (paymentData: any) => void;\n  onCreatePromissoryNote?: (noteData: any) => void;\n  loading?: boolean;\n}\n\nexport const CollectionModal: React.FC<CollectionModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  sale,\n  onPaymentCreate,\n  onPromissoryPaymentCreate,\n  onCreatePromissoryNote,\n  loading = false\n}) => {\n  const [activeTab, setActiveTab] = useState<'payments' | 'promissory'>('payments');\n  const [paymentMethod, setPaymentMethod] = useState<'cash' | 'credit' | 'bank_transfer' | 'check'>('cash');\n  const [paymentAmount, setPaymentAmount] = useState<number>(0);\n  const [selectedInstallments, setSelectedInstallments] = useState<string[]>([]);\n  const [generateReceipt, setGenerateReceipt] = useState(true);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  \n  // Promissory note states\n  const [promissoryNotes, setPromissoryNotes] = useState<PromissoryNote[]>([]);\n  const [collectingNoteId, setCollectingNoteId] = useState<string | null>(null);\n  const [promissoryPaymentAmount, setPromissoryPaymentAmount] = useState<number>(0);\n  const [promissoryPaymentMethod, setPromissoryPaymentMethod] = useState<'cash' | 'credit' | 'bank_transfer' | 'check'>('cash');\n  const [showCreatePromissoryForm, setShowCreatePromissoryForm] = useState(false);\n  const [newPromissoryNote, setNewPromissoryNote] = useState({\n    noteNumber: '',\n    amount: 0,\n    dueDate: '',\n    notes: ''\n  });\n\n  // Calculate remaining balance and installment details\n  const totalPaid = sale.payments?.reduce((sum, payment) => sum + payment.amount, 0) || 0;\n  const remainingBalance = sale.totalAmount - totalPaid;\n  \n  // Mock installments for demonstration - in real app, this would come from sale data\n  const installments: Installment[] = [\n    {\n      id: '1',\n      amount: sale.totalAmount / 3,\n      dueDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),\n      status: 'pending',\n      notes: '1. Taksit'\n    },\n    {\n      id: '2', \n      amount: sale.totalAmount / 3,\n      dueDate: new Date(Date.now() + 60 * 24 * 60 * 60 * 1000).toISOString(),\n      status: 'pending',\n      notes: '2. Taksit'\n    },\n    {\n      id: '3',\n      amount: sale.totalAmount / 3,\n      dueDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString(),\n      status: 'pending',\n      notes: '3. Taksit'\n    }\n  ];\n\n  const pendingInstallments = installments.filter(inst => inst.status === 'pending');\n  const overdueInstallments = installments.filter(inst => \n    inst.status === 'pending' && new Date(inst.dueDate) < new Date()\n  );\n\n  // Mock promissory notes - in real app, this would come from API\n  useEffect(() => {\n    if (isOpen && sale?.id) {\n      // Simulate fetching promissory notes\n      const mockNotes: PromissoryNote[] = [\n        {\n          id: '1',\n          noteNumber: `SN-${sale.id}-001`,\n          amount: sale.totalAmount * 0.5,\n          paidAmount: 0,\n          remainingAmount: sale.totalAmount * 0.5,\n          dueDate: new Date(Date.now() + 60 * 24 * 60 * 60 * 1000).toISOString(),\n          status: 'active',\n          saleId: sale.id,\n          notes: 'İlk senet'\n        },\n        {\n          id: '2',\n          noteNumber: `SN-${sale.id}-002`,\n          amount: sale.totalAmount * 0.3,\n          paidAmount: sale.totalAmount * 0.1,\n          remainingAmount: sale.totalAmount * 0.2,\n          dueDate: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString(),\n          status: 'overdue',\n          saleId: sale.id,\n          notes: 'İkinci senet - vadesi geçmiş'\n        }\n      ];\n      setPromissoryNotes(mockNotes);\n    }\n  }, [isOpen, sale?.id]);\n\n  useEffect(() => {\n    if (pendingInstallments.length > 0) {\n      setPaymentAmount(pendingInstallments[0].amount);\n    } else {\n      setPaymentAmount(remainingBalance);\n    }\n  }, [pendingInstallments, remainingBalance]);\n\n  if (!isOpen) return null;\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget as HTMLFormElement);\n    \n    setError(null);\n    setSuccess(null);\n    \n    // Validation\n    if (!paymentAmount || paymentAmount <= 0) {\n      setError('Geçerli bir ödeme tutarı giriniz');\n      return;\n    }\n    \n    if (paymentAmount > remainingBalance) {\n      setError('Ödeme tutarı kalan bakiyeden fazla olamaz');\n      return;\n    }\n    \n    // Validate payment method specific fields\n    if (paymentMethod === 'credit') {\n      if (!formData.get('cardLast4') || !formData.get('cardType')) {\n        setError('Kredi kartı bilgilerini eksiksiz doldurunuz');\n        return;\n      }\n    } else if (paymentMethod === 'bank_transfer') {\n      if (!formData.get('bankName') || !formData.get('referenceNumber')) {\n        setError('Banka havalesi bilgilerini eksiksiz doldurunuz');\n        return;\n      }\n    } else if (paymentMethod === 'check') {\n      if (!formData.get('checkNumber') || !formData.get('checkBank') || !formData.get('checkDate')) {\n        setError('Çek bilgilerini eksiksiz doldurunuz');\n        return;\n      }\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      const paymentData = {\n        saleId: sale.id,\n        patientId: patient.id,\n        amount: paymentAmount,\n        method: paymentMethod,\n        date: new Date().toISOString(),\n        status: 'completed',\n        note: formData.get('notes'),\n        installmentIds: selectedInstallments,\n        generateReceipt,\n        // Payment method specific fields\n        ...(paymentMethod === 'credit' && {\n          cardLast4: formData.get('cardLast4'),\n          cardType: formData.get('cardType'),\n          transactionId: formData.get('transactionId')\n        }),\n        ...(paymentMethod === 'bank_transfer' && {\n          bankName: formData.get('bankName'),\n          accountNumber: formData.get('accountNumber'),\n          referenceNumber: formData.get('referenceNumber')\n        }),\n        ...(paymentMethod === 'check' && {\n          checkNumber: formData.get('checkNumber'),\n          checkDate: formData.get('checkDate'),\n          bankName: formData.get('checkBank')\n        })\n      };\n\n      onPaymentCreate(paymentData);\n      \n      setSuccess('Ödeme başarıyla kaydedildi');\n      \n      // Reset form after successful submission\n      setTimeout(() => {\n        setPaymentAmount(0);\n        setSelectedInstallments([]);\n        setError(null);\n        setSuccess(null);\n        onClose();\n      }, 2000);\n      \n    } catch (err) {\n      setError('Ödeme kaydedilirken bir hata oluştu. Lütfen tekrar deneyiniz.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handlePromissoryPayment = async (noteId: string) => {\n    if (!promissoryPaymentAmount || promissoryPaymentAmount <= 0) {\n      setError('Geçerli bir tahsilat tutarı giriniz');\n      return;\n    }\n\n    const note = promissoryNotes.find(n => n.id === noteId);\n    if (!note) return;\n\n    if (promissoryPaymentAmount > note.remainingAmount) {\n      setError('Tahsilat tutarı kalan tutardan fazla olamaz');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n\n      const paymentData = {\n        promissoryNoteId: noteId,\n        saleId: sale.id,\n        patientId: patient.id,\n        amount: promissoryPaymentAmount,\n        method: promissoryPaymentMethod,\n        date: new Date().toISOString(),\n        status: promissoryPaymentAmount >= note.remainingAmount ? 'paid' : 'partial',\n        type: 'promissory_note_payment'\n      };\n\n      if (onPromissoryPaymentCreate) {\n        onPromissoryPaymentCreate(paymentData);\n      }\n\n      // Update local state\n      setPromissoryNotes(prev => prev.map(n => \n        n.id === noteId \n          ? { \n              ...n, \n              paidAmount: n.paidAmount + promissoryPaymentAmount,\n              remainingAmount: n.remainingAmount - promissoryPaymentAmount,\n              status: promissoryPaymentAmount >= n.remainingAmount ? 'paid' : 'partial'\n            }\n          : n\n      ));\n\n      setSuccess(`Senet tahsilatı başarıyla kaydedildi (${formatCurrency(promissoryPaymentAmount)})`);\n      setCollectingNoteId(null);\n      setPromissoryPaymentAmount(0);\n\n    } catch (err) {\n      setError('Senet tahsilatı kaydedilirken bir hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCreatePromissoryNote = async () => {\n    if (!newPromissoryNote.noteNumber || !newPromissoryNote.amount || !newPromissoryNote.dueDate) {\n      setError('Senet bilgilerini eksiksiz doldurunuz');\n      return;\n    }\n\n    if (newPromissoryNote.amount > remainingBalance) {\n      setError('Senet tutarı kalan bakiyeden fazla olamaz');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n\n      const noteData = {\n        ...newPromissoryNote,\n        saleId: sale.id,\n        patientId: patient.id,\n        status: 'active' as const,\n        paidAmount: 0,\n        remainingAmount: newPromissoryNote.amount,\n        createdAt: new Date().toISOString()\n      };\n\n      if (onCreatePromissoryNote) {\n        onCreatePromissoryNote(noteData);\n      }\n\n      // Add to local state\n      const newNote: PromissoryNote = {\n        id: Date.now().toString(),\n        noteNumber: noteData.noteNumber,\n        amount: noteData.amount,\n        paidAmount: noteData.paidAmount,\n        remainingAmount: noteData.remainingAmount,\n        dueDate: noteData.dueDate,\n        status: noteData.status,\n        notes: noteData.notes,\n        saleId: noteData.saleId\n      };\n      setPromissoryNotes(prev => [...prev, newNote]);\n\n      setSuccess('Senet başarıyla oluşturuldu');\n      setShowCreatePromissoryForm(false);\n      setNewPromissoryNote({\n        noteNumber: '',\n        amount: 0,\n        dueDate: '',\n        notes: ''\n      });\n\n    } catch (err) {\n      setError('Senet oluşturulurken bir hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleInstallmentSelection = (installmentId: string, checked: boolean) => {\n    if (checked) {\n      setSelectedInstallments([...selectedInstallments, installmentId]);\n    } else {\n      setSelectedInstallments(selectedInstallments.filter(id => id !== installmentId));\n    }\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const getPromissoryNoteStatusBadge = (status: string) => {\n    switch (status) {\n      case 'active':\n        return <Badge className=\"bg-blue-100 text-blue-800\">Aktif</Badge>;\n      case 'paid':\n        return <Badge className=\"bg-green-100 text-green-800\">Ödendi</Badge>;\n      case 'partial':\n        return <Badge className=\"bg-yellow-100 text-yellow-800\">Kısmi</Badge>;\n      case 'overdue':\n        return <Badge className=\"bg-red-100 text-red-800\">Vadesi Geçmiş</Badge>;\n      default:\n        return <Badge className=\"bg-gray-100 text-gray-800\">{status}</Badge>;\n    }\n  };\n\n  const overduePromissoryNotes = promissoryNotes.filter(note => \n    note.status === 'overdue' || (note.status === 'active' && new Date(note.dueDate) < new Date())\n  );\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-5xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <Receipt className=\"w-5 h-5 mr-2\" />\n            Tahsilat İşlemleri\n          </h3>\n          <Button\n            onClick={onClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {error && (\n          <Alert className=\"mb-4 border-red-200 bg-red-50\">\n            <AlertCircle className=\"h-4 w-4 text-red-600\" />\n            <div className=\"text-red-800\">\n              {error}\n            </div>\n          </Alert>\n        )}\n\n        {success && (\n          <Alert className=\"mb-4 border-green-200 bg-green-50\">\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n            <div className=\"text-green-800\">\n              {success}\n            </div>\n          </Alert>\n        )}\n\n        {/* Overdue Alerts */}\n        {overduePromissoryNotes.length > 0 && (\n          <Alert className=\"mb-4 border-red-200 bg-red-50\">\n            <AlertCircle className=\"h-4 w-4 text-red-600\" />\n            <div className=\"text-red-800\">\n              <strong>Dikkat!</strong> {overduePromissoryNotes.length} adet vadesi geçmiş senet bulunmaktadır.\n            </div>\n          </Alert>\n        )}\n\n        {/* Tab Navigation */}\n        <div className=\"flex space-x-1 mb-6 bg-gray-100 p-1 rounded-lg\">\n          <button\n            onClick={() => setActiveTab('payments')}\n            className={`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${\n              activeTab === 'payments'\n                ? 'bg-white text-blue-700 shadow-sm'\n                : 'text-gray-600 hover:text-gray-900'\n            }`}\n          >\n            <DollarSign className=\"w-4 h-4 inline mr-2\" />\n            Ödeme Tahsilatı\n          </button>\n          <button\n            onClick={() => setActiveTab('promissory')}\n            className={`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${\n              activeTab === 'promissory'\n                ? 'bg-white text-blue-700 shadow-sm'\n                : 'text-gray-600 hover:text-gray-900'\n            }`}\n          >\n            <FileText className=\"w-4 h-4 inline mr-2\" />\n            Senet Yönetimi\n            {overduePromissoryNotes.length > 0 && (\n              <span className=\"ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full\">\n                {overduePromissoryNotes.length}\n              </span>\n            )}\n          </button>\n        </div>\n\n        {/* Customer & Sale Info */}\n        <div className=\"grid grid-cols-2 gap-6 mb-6\">\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\n            <h4 className=\"font-medium text-gray-900 mb-2\">Müşteri Bilgileri</h4>\n            <div className=\"space-y-1 text-sm\">\n              <div><span className=\"font-medium\">Ad Soyad:</span> {patient.firstName} {patient.lastName}</div>\n              <div><span className=\"font-medium\">TC No:</span> {patient.tcNumber}</div>\n              <div><span className=\"font-medium\">Telefon:</span> {patient.phone}</div>\n            </div>\n          </div>\n\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <h4 className=\"font-medium text-gray-900 mb-2\">Satış Bilgileri</h4>\n            <div className=\"space-y-1 text-sm\">\n              <div><span className=\"font-medium\">Satış ID:</span> {sale.id}</div>\n              <div><span className=\"font-medium\">Toplam Tutar:</span> {formatCurrency(sale.totalAmount)}</div>\n              <div><span className=\"font-medium\">Ödenen:</span> {formatCurrency(totalPaid)}</div>\n              <div className=\"font-medium text-blue-700\">\n                <span>Kalan Bakiye:</span> {formatCurrency(remainingBalance)}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Tab Content */}\n        {activeTab === 'payments' ? (\n          <form onSubmit={handleSubmit}>\n            <div className=\"space-y-6\">\n              {/* Installment Information */}\n              {pendingInstallments.length > 0 && (\n                <div className=\"bg-yellow-50 p-4 rounded-lg\">\n                  <h4 className=\"font-medium text-gray-900 mb-3 flex items-center\">\n                    <Calendar className=\"w-4 h-4 mr-2\" />\n                    Taksit Bilgileri\n                  </h4>\n                  \n                  {overdueInstallments.length > 0 && (\n                    <div className=\"mb-3 p-3 bg-red-100 border border-red-200 rounded\">\n                      <p className=\"text-red-800 font-medium text-sm\">\n                        ⚠️ {overdueInstallments.length} adet gecikmiş taksit bulunmaktadır!\n                      </p>\n                    </div>\n                  )}\n\n                  <div className=\"space-y-2\">\n                    {pendingInstallments.map((installment) => (\n                      <div key={installment.id} className=\"flex items-center justify-between p-2 bg-white rounded border\">\n                        <div className=\"flex items-center\">\n                          <input\n                            type=\"checkbox\"\n                            id={`installment-${installment.id}`}\n                            checked={selectedInstallments.includes(installment.id)}\n                            onChange={(e) => handleInstallmentSelection(installment.id, e.target.checked)}\n                            className=\"mr-3\"\n                          />\n                          <label htmlFor={`installment-${installment.id}`} className=\"text-sm\">\n                            <span className=\"font-medium\">{installment.notes}</span>\n                            <span className=\"text-gray-600 ml-2\">- Vade: {formatDate(installment.dueDate)}</span>\n                            {new Date(installment.dueDate) < new Date() && (\n                              <span className=\"text-red-600 ml-2 font-medium\">(Gecikmiş)</span>\n                            )}\n                          </label>\n                        </div>\n                        <span className=\"font-medium text-blue-700\">\n                          {formatCurrency(installment.amount)}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Payment Amount */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Tahsilat Tutarı *\n                </label>\n                <Input\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={paymentAmount}\n                  onChange={(e) => setPaymentAmount(parseFloat(e.target.value) || 0)}\n                  className=\"text-right font-medium text-lg\"\n                  required\n                />\n                <div className=\"mt-1 flex justify-between text-sm text-gray-600\">\n                  <span>Maksimum: {formatCurrency(remainingBalance)}</span>\n                  <div className=\"flex gap-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setPaymentAmount(remainingBalance)}\n                      className=\"text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200\"\n                    >\n                      Tam Ödeme\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => setPaymentAmount(remainingBalance / 2)}\n                      className=\"text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200\"\n                    >\n                      Yarısı\n                    </button>\n                  </div>\n                  {selectedInstallments.length > 0 && (\n                    <span>Seçili taksitler toplamı: {formatCurrency(\n                      selectedInstallments.reduce((sum, id) => {\n                        const inst = installments.find(i => i.id === id);\n                        return sum + (inst?.amount || 0);\n                      }, 0)\n                    )}</span>\n                  )}\n                </div>\n              </div>\n\n              {/* Payment Method */}\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium text-gray-900 flex items-center\">\n                  <CreditCard className=\"w-4 h-4 mr-2\" />\n                  Ödeme Yöntemi\n                </h4>\n                \n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\n                  {[\n                    { value: 'cash', label: 'Nakit', icon: <Banknote className=\"w-4 h-4\" /> },\n                    { value: 'credit', label: 'Kredi Kartı', icon: <CreditCard className=\"w-4 h-4\" /> },\n                    { value: 'bank_transfer', label: 'Havale/EFT', icon: <DollarSign className=\"w-4 h-4\" /> },\n                    { value: 'check', label: 'Çek', icon: <Receipt className=\"w-4 h-4\" /> }\n                  ].map((method) => (\n                    <button\n                      key={method.value}\n                      type=\"button\"\n                      onClick={() => setPaymentMethod(method.value as any)}\n                      className={`p-3 border rounded-lg text-center transition-colors flex flex-col items-center ${\n                        paymentMethod === method.value\n                          ? 'border-blue-500 bg-blue-50 text-blue-700'\n                          : 'border-gray-300 hover:border-gray-400'\n                      }`}\n                    >\n                      {method.icon}\n                      <span className=\"text-sm font-medium mt-1\">{method.label}</span>\n                    </button>\n                  ))}\n                </div>\n\n                {/* Payment Method Specific Fields */}\n                {paymentMethod === 'credit' && (\n                  <div className=\"grid grid-cols-3 gap-4 p-4 bg-blue-50 rounded-lg\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kart Son 4 Hanesi</label>\n                      <Input name=\"cardLast4\" placeholder=\"****\" maxLength={4} />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kart Türü</label>\n                      <select\n                        name=\"cardType\"\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      >\n                        <option value=\"\">Seçiniz</option>\n                        <option value=\"visa\">Visa</option>\n                        <option value=\"mastercard\">Mastercard</option>\n                        <option value=\"amex\">American Express</option>\n                      </select>\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">İşlem No</label>\n                      <Input name=\"transactionId\" placeholder=\"İşlem numarası\" />\n                    </div>\n                  </div>\n                )}\n\n                {paymentMethod === 'bank_transfer' && (\n                  <div className=\"grid grid-cols-3 gap-4 p-4 bg-green-50 rounded-lg\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Banka Adı</label>\n                      <Input name=\"bankName\" placeholder=\"Banka adı\" />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Hesap No</label>\n                      <Input name=\"accountNumber\" placeholder=\"Hesap numarası\" />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Referans No</label>\n                      <Input name=\"referenceNumber\" placeholder=\"Referans numarası\" />\n                    </div>\n                  </div>\n                )}\n\n                {paymentMethod === 'check' && (\n                  <div className=\"grid grid-cols-3 gap-4 p-4 bg-purple-50 rounded-lg\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Çek No</label>\n                      <Input name=\"checkNumber\" placeholder=\"Çek numarası\" />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Çek Tarihi</label>\n                      <Input name=\"checkDate\" type=\"date\" />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Banka</label>\n                      <Input name=\"checkBank\" placeholder=\"Banka adı\" />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Receipt Options */}\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <div className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"generateReceipt\"\n                    checked={generateReceipt}\n                    onChange={(e) => setGenerateReceipt(e.target.checked)}\n                    className=\"mr-3\"\n                  />\n                  <label htmlFor=\"generateReceipt\" className=\"text-sm font-medium text-gray-700\">\n                    Tahsilat makbuzu oluştur ve yazdır\n                  </label>\n                </div>\n              </div>\n\n              {/* Notes */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notlar</label>\n                <Textarea \n                  name=\"notes\" \n                  placeholder=\"Tahsilat ile ilgili notlar...\" \n                  rows={3}\n                />\n              </div>\n            </div>\n\n            <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={onClose}\n                disabled={isLoading}\n              >\n                İptal\n              </Button>\n              <Button \n                type=\"submit\"\n                disabled={isLoading || !paymentAmount || paymentAmount <= 0}\n                className=\"min-w-[120px]\"\n              >\n                {isLoading ? (\n                  <>\n                    <Spinner className=\"w-4 h-4 mr-2\" />\n                    Kaydediliyor...\n                  </>\n                ) : (\n                  'Ödemeyi Kaydet'\n                )}\n              </Button>\n            </div>\n          </form>\n        ) : (\n          /* Promissory Notes Tab */\n          <div className=\"space-y-6\">\n            {/* Create New Promissory Note */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h4 className=\"font-medium text-gray-900\">Yeni Senet Oluştur</h4>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setShowCreatePromissoryForm(!showCreatePromissoryForm)}\n                  className=\"text-sm\"\n                >\n                  <Plus className=\"w-4 h-4 mr-1\" />\n                  {showCreatePromissoryForm ? 'İptal' : 'Yeni Senet'}\n                </Button>\n              </div>\n\n              {showCreatePromissoryForm && (\n                <div className=\"space-y-4 border-t pt-4\">\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Senet No</label>\n                      <Input\n                        value={newPromissoryNote.noteNumber}\n                        onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, noteNumber: e.target.value }))}\n                        placeholder={`SN-${sale.id}-${String(promissoryNotes.length + 1).padStart(3, '0')}`}\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Tutar</label>\n                      <Input\n                        type=\"number\"\n                        step=\"0.01\"\n                        value={newPromissoryNote.amount}\n                        onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, amount: parseFloat(e.target.value) || 0 }))}\n                        max={remainingBalance}\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Vade Tarihi</label>\n                      <Input\n                        type=\"date\"\n                        value={newPromissoryNote.dueDate}\n                        onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, dueDate: e.target.value }))}\n                      />\n                    </div>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notlar</label>\n                    <Textarea\n                      value={newPromissoryNote.notes}\n                      onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, notes: e.target.value }))}\n                      placeholder=\"Senet ile ilgili notlar...\"\n                      rows={2}\n                    />\n                  </div>\n                  <div className=\"flex justify-end\">\n                    <Button\n                      type=\"button\"\n                      onClick={handleCreatePromissoryNote}\n                      disabled={isLoading || !newPromissoryNote.noteNumber || !newPromissoryNote.amount || !newPromissoryNote.dueDate}\n                      className=\"text-sm\"\n                    >\n                      {isLoading ? (\n                        <>\n                          <Spinner className=\"w-4 h-4 mr-2\" />\n                          Oluşturuluyor...\n                        </>\n                      ) : (\n                        'Senet Oluştur'\n                      )}\n                    </Button>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Existing Promissory Notes */}\n            <div>\n              <h4 className=\"font-medium text-gray-900 mb-4\">Mevcut Senetler</h4>\n              {promissoryNotes.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500\">\n                  <FileText className=\"w-12 h-12 mx-auto mb-4 text-gray-300\" />\n                  <p>Bu satış için henüz senet oluşturulmamış</p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {promissoryNotes.map((note) => (\n                    <Card key={note.id} className={`${note.status === 'overdue' ? 'border-red-200 bg-red-50' : ''}`}>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex justify-between items-start mb-3\">\n                          <div>\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <h5 className=\"font-medium text-gray-900\">{note.noteNumber}</h5>\n                              {getPromissoryNoteStatusBadge(note.status)}\n                              {note.status === 'overdue' && (\n                                <Clock className=\"w-4 h-4 text-red-500\" />\n                              )}\n                            </div>\n                            <p className=\"text-sm text-gray-600\">Vade: {formatDate(note.dueDate)}</p>\n                            {note.notes && (\n                              <p className=\"text-sm text-gray-600 mt-1\">{note.notes}</p>\n                            )}\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"text-lg font-medium text-gray-900\">\n                              {formatCurrency(note.amount)}\n                            </div>\n                            {note.paidAmount > 0 && (\n                              <div className=\"text-sm text-green-600\">\n                                Ödenen: {formatCurrency(note.paidAmount)}\n                              </div>\n                            )}\n                            <div className=\"text-sm text-red-600 font-medium\">\n                              Kalan: {formatCurrency(note.remainingAmount)}\n                            </div>\n                          </div>\n                        </div>\n\n                        {note.status !== 'paid' && (\n                          <div className=\"border-t pt-3\">\n                            {collectingNoteId === note.id ? (\n                              <div className=\"space-y-3\">\n                                <div className=\"grid grid-cols-2 gap-3\">\n                                  <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                                      Tahsilat Tutarı\n                                    </label>\n                                    <Input\n                                      type=\"number\"\n                                      step=\"0.01\"\n                                      value={promissoryPaymentAmount}\n                                      onChange={(e) => setPromissoryPaymentAmount(parseFloat(e.target.value) || 0)}\n                                      max={note.remainingAmount}\n                                      className=\"text-right\"\n                                    />\n                                    <div className=\"flex gap-1 mt-1\">\n                                      <button\n                                        type=\"button\"\n                                        onClick={() => setPromissoryPaymentAmount(note.remainingAmount)}\n                                        className=\"text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200\"\n                                      >\n                                        Tam\n                                      </button>\n                                      <button\n                                        type=\"button\"\n                                        onClick={() => setPromissoryPaymentAmount(note.remainingAmount / 2)}\n                                        className=\"text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200\"\n                                      >\n                                        Yarısı\n                                      </button>\n                                    </div>\n                                  </div>\n                                  <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                                      Ödeme Yöntemi\n                                    </label>\n                                    <select\n                                      value={promissoryPaymentMethod}\n                                      onChange={(e) => setPromissoryPaymentMethod(e.target.value as any)}\n                                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                                    >\n                                      <option value=\"cash\">Nakit</option>\n                                      <option value=\"credit\">Kart</option>\n                                      <option value=\"bank_transfer\">Havale/EFT</option>\n                                      <option value=\"check\">Çek</option>\n                                    </select>\n                                  </div>\n                                </div>\n                                <div className=\"flex space-x-2\">\n                                  <Button\n                                    onClick={() => handlePromissoryPayment(note.id)}\n                                    disabled={isLoading || promissoryPaymentAmount <= 0}\n                                    className=\"text-sm\"\n                                  >\n                                    {isLoading ? (\n                                      <>\n                                        <Spinner className=\"w-4 h-4 mr-2\" />\n                                        Kaydediliyor...\n                                      </>\n                                    ) : (\n                                      'Tahsil Et'\n                                    )}\n                                  </Button>\n                                  <Button\n                                    variant=\"outline\"\n                                    onClick={() => {\n                                      setCollectingNoteId(null);\n                                      setPromissoryPaymentAmount(0);\n                                    }}\n                                    className=\"text-sm\"\n                                  >\n                                    İptal\n                                  </Button>\n                                </div>\n                              </div>\n                            ) : (\n                              <Button\n                                variant=\"outline\"\n                                onClick={() => {\n                                  setCollectingNoteId(note.id);\n                                  setPromissoryPaymentAmount(note.remainingAmount);\n                                }}\n                                className=\"text-sm\"\n                              >\n                                <DollarSign className=\"w-4 h-4 mr-1\" />\n                                Tahsil Et\n                              </Button>\n                            )}\n                          </div>\n                        )}\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CollectionModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/DeviceEditModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[504,507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[504,507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":142,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":153,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":154,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":165,"endColumn":20},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":213,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":223,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":229,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":236,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":241,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":247,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":274,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":285,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":286,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":297,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":304,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":316,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":358,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":368,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":374,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":381,"endColumn":21},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":388,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":394,"endColumn":17}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Input } from '@x-ear/ui-web';\nimport { X, Settings, RefreshCw } from 'lucide-react';\nimport type { Device, InventoryItem } from '../../../api/generated/xEarCRMAPIAutoGenerated.schemas';\n\ninterface DeviceEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  device: Device | null;\n  inventoryItems: InventoryItem[];\n  onUpdate: (deviceId: string, updates: Partial<Device>) => void;\n  onReplace: (deviceId: string, newDeviceData: any) => void;\n  loading?: boolean;\n}\n\nconst DeviceEditModal: React.FC<DeviceEditModalProps> = ({\n  isOpen,\n  onClose,\n  device,\n  inventoryItems,\n  onUpdate,\n  onReplace,\n  loading = false\n}) => {\n  const [formData, setFormData] = useState<{\n    mode: 'edit' | 'replace';\n    replaceMode: 'inventory' | 'manual';\n    inventoryId: string;\n    brand: string;\n    model: string;\n    serialNumber: string;\n    deviceType: string;\n    price: number;\n    notes: string;\n  }>({\n    mode: 'edit',\n    replaceMode: 'inventory',\n    inventoryId: '',\n    brand: device?.brand || '',\n    model: device?.model || '',\n    serialNumber: device?.serialNumber || '',\n    deviceType: device?.deviceType || '',\n    price: device?.price || 0,\n    notes: device?.notes || '',\n  });\n\n  useEffect(() => {\n    if (device) {\n      setFormData(prev => ({\n        ...prev,\n        brand: device.brand || '',\n        model: device.model || '',\n        serialNumber: device.serialNumber || '',\n        deviceType: device.deviceType || '',\n        price: device.price || 0,\n        notes: device.notes || '',\n      }));\n    }\n  }, [device]);\n\n  if (!isOpen || !device) return null;\n\n  const handleUpdate = async () => {\n    if (!device?.id) return;\n    \n    try {\n      const updatedDevice: Partial<Device> = {\n        id: device.id,\n        brand: formData.brand,\n        model: formData.model,\n        serialNumber: formData.serialNumber,\n        deviceType: formData.deviceType,\n        price: formData.price,\n        notes: formData.notes,\n      };\n\n      await onUpdate(device.id!, updatedDevice);\n      onClose();\n    } catch (error) {\n      console.error('Error updating device:', error);\n    }\n  };\n\n  const handleReplace = async () => {\n    if (!device?.id) return;\n    \n    try {\n      if (formData.replaceMode === 'inventory' && formData.inventoryId) {\n        const selectedItem = inventoryItems.find(item => item.id === formData.inventoryId);\n        if (selectedItem) {\n          const replacementDevice: Partial<Device> = {\n            id: device.id,\n            inventoryId: selectedItem.id,\n            brand: selectedItem.brand,\n            model: selectedItem.model || '',\n            deviceType: selectedItem.category || '',\n            price: selectedItem.price,\n            serialNumber: selectedItem.availableSerials?.[0] || '', // Will be assigned from inventory\n          };\n          await onReplace(device.id!, replacementDevice);\n        }\n      } else {\n        // Manual replacement\n        const replacementDevice: Partial<Device> = {\n          id: device.id,\n          brand: formData.brand,\n          model: formData.model,\n          serialNumber: formData.serialNumber,\n          deviceType: formData.deviceType,\n          price: formData.price,\n          notes: formData.notes,\n        };\n        await onReplace(device.id!, replacementDevice);\n      }\n      onClose();\n    } catch (error) {\n      console.error('Error replacing device:', error);\n    }\n  };\n\n  const availableInventoryItems = inventoryItems.filter(item => \n    (item.availableInventory || 0) > 0 && item.category === device.deviceType\n  );\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900\">\n            Cihaz {formData.mode === 'edit' ? 'Düzenle' : 'Değiştir'}\n          </h3>\n          <Button\n            onClick={onClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Mode Selection */}\n        <div className=\"flex space-x-4 mb-6\">\n          <button\n            type=\"button\"\n            onClick={() => setFormData(prev => ({ ...prev, mode: 'edit' }))}\n            className={`flex items-center px-4 py-2 rounded-lg transition-colors ${\n              formData.mode === 'edit'\n                ? 'bg-blue-100 text-blue-700 border border-blue-300'\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n            }`}\n          >\n            <Settings className=\"w-4 h-4 mr-2\" />\n            Düzenle\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setFormData(prev => ({ ...prev, mode: 'replace' }))}\n            className={`flex items-center px-4 py-2 rounded-lg transition-colors ${\n              formData.mode === 'replace'\n                ? 'bg-blue-100 text-blue-700 border border-blue-300'\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n            }`}\n          >\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Değiştir\n          </button>\n        </div>\n\n        {/* Current Device Info */}\n        <div className=\"bg-gray-50 p-4 rounded-lg mb-6\">\n          <h4 className=\"font-medium text-gray-900 mb-2\">Mevcut Cihaz</h4>\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n            <div><span className=\"font-medium\">Marka:</span> {device.brand}</div>\n            <div><span className=\"font-medium\">Model:</span> {device.model}</div>\n            <div><span className=\"font-medium\">Seri No:</span> {device.serialNumber}</div>\n            <div><span className=\"font-medium\">Kulak:</span> {device.ear === 'RIGHT' ? 'Sağ' : device.ear === 'LEFT' ? 'Sol' : 'Bilateral'}</div>\n            <div><span className=\"font-medium\">Durum:</span> {device.status}</div>\n            <div><span className=\"font-medium\">Oluşturma Tarihi:</span> {device.createdAt ? new Date(device.createdAt).toLocaleDateString('tr-TR') : 'Belirtilmemiş'}</div>\n          </div>\n        </div>\n\n        {formData.mode === 'edit' ? (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Marka</label>\n                <Input \n                  value={formData.brand}\n                  onChange={(e) => setFormData(prev => ({ ...prev, brand: e.target.value }))}\n                  required \n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Model</label>\n                <Input \n                  value={formData.model}\n                  onChange={(e) => setFormData(prev => ({ ...prev, model: e.target.value }))}\n                  required \n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Seri No</label>\n                <Input \n                  value={formData.serialNumber}\n                  onChange={(e) => setFormData(prev => ({ ...prev, serialNumber: e.target.value }))}\n                  required \n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Cihaz Türü</label>\n                <select\n                  value={formData.deviceType}\n                  onChange={(e) => setFormData(prev => ({ ...prev, deviceType: e.target.value }))}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  required\n                >\n                  <option value=\"hearing_aid\">İşitme Cihazı</option>\n                  <option value=\"cochlear_implant\">Koklear İmplant</option>\n                  <option value=\"bone_anchored\">Kemik Ankrajlı</option>\n                  <option value=\"middle_ear\">Orta Kulak İmplantı</option>\n                </select>\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fiyat (₺)</label>\n              <input\n                type=\"number\"\n                value={formData.price}\n                onChange={(e) => setFormData(prev => ({ ...prev, price: Number(e.target.value) }))}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                min=\"0\"\n                step=\"0.01\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notlar</label>\n              <textarea\n                value={formData.notes}\n                onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n                rows={3}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Cihaz ile ilgili notlar...\"\n              />\n            </div>\n\n            <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n              >\n                İptal\n              </Button>\n              <Button\n                type=\"button\"\n                onClick={handleUpdate}\n                className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md\"\n                disabled={loading}\n              >\n                {loading ? 'Güncelleniyor...' : 'Güncelle'}\n              </Button>\n            </div>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {/* Replace Mode Selection */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Değiştirme Yöntemi</label>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setFormData(prev => ({ ...prev, replaceMode: 'inventory' }))}\n                  className={`p-3 border rounded-lg text-center transition-colors ${\n                    formData.replaceMode === 'inventory'\n                      ? 'border-blue-500 bg-blue-50 text-blue-700'\n                      : 'border-gray-300 hover:border-gray-400'\n                  }`}\n                >\n                  <div className=\"font-medium\">Stoktan Seç</div>\n                  <div className=\"text-sm text-gray-600\">Mevcut stoktan cihaz seç</div>\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setFormData(prev => ({ ...prev, replaceMode: 'manual' }))}\n                  className={`p-3 border rounded-lg text-center transition-colors ${\n                    formData.replaceMode === 'manual'\n                      ? 'border-blue-500 bg-blue-50 text-blue-700'\n                      : 'border-gray-300 hover:border-gray-400'\n                  }`}\n                >\n                  <div className=\"font-medium\">Manuel Giriş</div>\n                  <div className=\"text-sm text-gray-600\">Cihaz bilgilerini manuel gir</div>\n                </button>\n              </div>\n            </div>\n\n            {formData.replaceMode === 'inventory' ? (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Stok Cihazı Seç</label>\n                <select\n                  value={formData.inventoryId}\n                  onChange={(e) => setFormData(prev => ({ ...prev, inventoryId: e.target.value }))}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  required\n                >\n                  <option value=\"\">Cihaz seçiniz...</option>\n                  {availableInventoryItems.map((item) => (\n                    <option key={item.id} value={item.id}>\n                      {item.brand} {item.model} - {item.name}\n                    </option>\n                  ))}\n                </select>\n                {availableInventoryItems.length === 0 && (\n                  <p className=\"text-sm text-amber-600 mt-1\">\n                    Bu cihaz türü için uygun stok bulunamadı.\n                  </p>\n                )}\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Marka</label>\n                    <Input \n                      value={formData.brand}\n                      onChange={(e) => setFormData(prev => ({ ...prev, brand: e.target.value }))}\n                      placeholder=\"Marka\" \n                      required \n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Model</label>\n                    <Input \n                      value={formData.model}\n                      onChange={(e) => setFormData(prev => ({ ...prev, model: e.target.value }))}\n                      placeholder=\"Model\" \n                      required \n                    />\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Seri No</label>\n                    <Input \n                      value={formData.serialNumber}\n                      onChange={(e) => setFormData(prev => ({ ...prev, serialNumber: e.target.value }))}\n                      placeholder=\"Seri numarası\" \n                      required \n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Cihaz Türü</label>\n                    <select\n                      value={formData.deviceType}\n                      onChange={(e) => setFormData(prev => ({ ...prev, deviceType: e.target.value }))}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      required\n                    >\n                      <option value=\"hearing_aid\">İşitme Cihazı</option>\n                      <option value=\"cochlear_implant\">Koklear İmplant</option>\n                      <option value=\"bone_anchored\">Kemik Ankrajlı</option>\n                      <option value=\"middle_ear\">Orta Kulak İmplantı</option>\n                    </select>\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fiyat (₺)</label>\n                  <input\n                    type=\"number\"\n                    value={formData.price}\n                    onChange={(e) => setFormData(prev => ({ ...prev, price: Number(e.target.value) }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    min=\"0\"\n                    step=\"0.01\"\n                  />\n                </div>\n              </div>\n            )}\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Değiştirme Notları</label>\n              <textarea\n                value={formData.notes}\n                onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n                rows={3}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"Değiştirme sebebi ve notlar...\"\n              />\n            </div>\n\n            <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n              >\n                İptal\n              </Button>\n              <Button\n                type=\"button\"\n                onClick={handleReplace}\n                className=\"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md\"\n                disabled={loading || (formData.replaceMode === 'inventory' && !formData.inventoryId)}\n              >\n                {loading ? 'Değiştiriliyor...' : 'Cihazı Değiştir'}\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport { DeviceEditModal };\nexport default DeviceEditModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/EditSaleModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Label' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Card' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardContent' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardHeader' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardTitle' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Badge' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":15,"column":106,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":114},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadAvailableDevices' and 'loadProductDetails'. Either include them or remove the dependency array.","line":201,"column":6,"nodeType":"ArrayExpression","endLine":201,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [sale, isOpen, productDetails, loadProductDetails, loadAvailableDevices]","fix":{"range":[6476,6506],"text":"[sale, isOpen, productDetails, loadProductDetails, loadAvailableDevices]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAvailableDevices'. Either include it or remove the dependency array.","line":211,"column":6,"nodeType":"ArrayExpression","endLine":211,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [deviceSearchTerm, loadAvailableDevices, showDeviceSelector]","fix":{"range":[6756,6794],"text":"[deviceSearchTerm, loadAvailableDevices, showDeviceSelector]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":215,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":215,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6878,6881],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6878,6881],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDate' is assigned a value but never used.","line":355,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":355,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":420,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":432,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":489,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":504,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":493,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":493,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17283,17286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17283,17286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":597,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":605,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":633,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":643,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":698,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":706,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":734,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":748,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":947,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":961,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":968,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":979,"endColumn":28}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Button, \n  Input, \n  Label, \n  Textarea,\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Alert,\n  Spinner\n} from '@x-ear/ui-web';\nimport { X, Edit, DollarSign, CreditCard, AlertCircle, CheckCircle, Package, Search, Settings, FileText, Calendar, Wrench } from 'lucide-react';\nimport { Patient } from '../../../types/patient';\nimport { Sale, SalesUpdateSaleBody, InventoryItem } from '../../../api/generated/api';\nimport { \n  getXEarCRMAPIAutoGenerated\n} from '../../../api/generated/api';\nimport PaymentTrackingModal from '../../payments/PaymentTrackingModal';\n\ninterface EditSaleModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  sale: Sale;\n  onSaleUpdate: (sale: Sale) => void;\n  loading?: boolean;\n}\n\n// SGK Scheme types\ninterface SGKScheme {\n  id: string;\n  name: string;\n  code: string;\n  coveragePercentage: number;\n  maxAmount?: number;\n  description?: string;\n}\n\n// Service types\ninterface ServiceInfo {\n  type: 'warranty' | 'maintenance' | 'repair' | 'calibration' | 'fitting';\n  description: string;\n  duration?: number; // in months\n  cost?: number;\n  notes?: string;\n}\n\nexport const EditSaleModal: React.FC<EditSaleModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  sale,\n  onSaleUpdate,\n  loading = false\n}) => {\n  const [saleType, setSaleType] = useState<'device' | 'service' | 'accessory'>('device');\n  const [paymentMethod, setPaymentMethod] = useState<string>('cash');\n  const [installmentCount, setInstallmentCount] = useState(1);\n  const [saleStatus, setSaleStatus] = useState<string>('draft');\n  const [hasChanges, setHasChanges] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  const [productDetails, setProductDetails] = useState<InventoryItem | null>(null);\n  \n  // Device assignment states\n  const [availableDevices, setAvailableDevices] = useState<InventoryItem[]>([]);\n  const [selectedDevice, setSelectedDevice] = useState<InventoryItem | null>(null);\n  const [showDeviceSelector, setShowDeviceSelector] = useState(false);\n  const [deviceSearchTerm, setDeviceSearchTerm] = useState('');\n  \n  // SGK states\n  const [sgkSchemes, setSgkSchemes] = useState<SGKScheme[]>([]);\n  const [selectedSgkScheme, setSelectedSgkScheme] = useState<SGKScheme | null>(null);\n  const [sgkApprovalNumber, setSgkApprovalNumber] = useState('');\n  const [sgkApprovalDate, setSgkApprovalDate] = useState('');\n  \n  // Service states\n  const [serviceInfo, setServiceInfo] = useState<ServiceInfo>({\n    type: 'warranty',\n    description: '',\n    duration: 24,\n    cost: 0,\n    notes: ''\n  });\n\n  // Payment tracking modal state\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\n\n  const [formData, setFormData] = useState({\n    productName: '',\n    brand: '',\n    model: '',\n    serialNumber: '',\n    listPrice: 0,\n    salePrice: 0,\n    discountAmount: 0,\n    sgkCoverage: 0,\n    notes: '',\n    saleDate: '',\n    // New fields\n    deviceId: '',\n    ear: 'both' as 'left' | 'right' | 'both',\n    warrantyPeriod: 24,\n    fittingDate: '',\n    deliveryDate: ''\n  });\n\n  // Calculate totals\n  const totalPaid = 0; // TODO: Load payment records separately\n  const remainingBalance = formData.salePrice - totalPaid;\n  const discountPercentage = formData.listPrice > 0 ? ((formData.discountAmount / formData.listPrice) * 100) : 0;\n\n  // Load available devices for assignment\n  const loadAvailableDevices = async () => {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.inventoryGetInventoryItems({\n        page: 1,\n        per_page: 50,\n        status: 'IN_STOCK',\n        search: deviceSearchTerm\n      });\n      setAvailableDevices(response.data?.data || []);\n    } catch (err) {\n      console.error('Error loading devices:', err);\n    }\n  };\n\n  // Load SGK schemes\n  const loadSgkSchemes = async () => {\n    // Mock SGK schemes - in real app, this would come from API\n    const mockSchemes: SGKScheme[] = [\n      { id: '1', name: 'SGK Genel', code: 'SGK001', coveragePercentage: 80, maxAmount: 5000 },\n      { id: '2', name: 'SGK Emekli', code: 'SGK002', coveragePercentage: 90, maxAmount: 7500 },\n      { id: '3', name: 'Bağ-Kur', code: 'BK001', coveragePercentage: 75, maxAmount: 4500 },\n      { id: '4', name: 'Yeşil Kart', code: 'YK001', coveragePercentage: 100, maxAmount: 3000 }\n    ];\n    setSgkSchemes(mockSchemes);\n  };\n\n  // Load product details if productId exists\n  const loadProductDetails = async () => {\n    if (!sale.productId) return;\n    \n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.inventoryGetInventoryItem(sale.productId);\n      setProductDetails(response.data?.data || null);\n    } catch (err) {\n      console.error('Error loading product details:', err);\n    }\n  };\n\n  useEffect(() => {\n    if (sale && isOpen) {\n      loadProductDetails();\n      loadAvailableDevices();\n      loadSgkSchemes();\n      \n      // Initialize form with sale data\n      setFormData({\n        productName: productDetails?.name || sale.productId || '',\n        brand: productDetails?.brand || '',\n        model: productDetails?.model || '',\n        serialNumber: productDetails?.availableSerials?.[0] || '',\n        listPrice: sale.listPriceTotal || 0,\n        salePrice: sale.totalAmount,\n        discountAmount: sale.discountAmount || 0,\n        sgkCoverage: sale.sgkCoverage || 0,\n        notes: sale.notes || '',\n        saleDate: sale.saleDate ? sale.saleDate.split('T')[0] : '',\n        deviceId: sale.productId || '',\n        ear: 'both',\n        warrantyPeriod: 24,\n        fittingDate: '',\n        deliveryDate: ''\n      });\n\n      setSaleStatus(sale.status || 'draft');\n      setPaymentMethod(sale.paymentMethod || 'cash');\n      \n      // Determine sale type based on product category\n      if (productDetails?.category) {\n        if (productDetails.category.toLowerCase().includes('cihaz') || \n            productDetails.category.toLowerCase().includes('device')) {\n          setSaleType('device');\n        } else if (productDetails.category.toLowerCase().includes('aksesuar') || \n                   productDetails.category.toLowerCase().includes('accessory')) {\n          setSaleType('accessory');\n        } else {\n          setSaleType('service');\n        }\n      }\n      \n      setHasChanges(false);\n    }\n  }, [sale, isOpen, productDetails]);\n\n  // Load devices when search term changes\n  useEffect(() => {\n    if (showDeviceSelector) {\n      const debounceTimer = setTimeout(() => {\n        loadAvailableDevices();\n      }, 300);\n      return () => clearTimeout(debounceTimer);\n    }\n  }, [deviceSearchTerm, showDeviceSelector]);\n\n  if (!isOpen) return null;\n\n  const handleInputChange = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    setHasChanges(true);\n  };\n\n  const handleDeviceSelect = (device: InventoryItem) => {\n    setSelectedDevice(device);\n    setFormData(prev => ({\n      ...prev,\n      deviceId: device.id || '',\n      productName: device.name,\n      brand: device.brand,\n      model: device.model || '',\n      listPrice: device.price,\n      salePrice: device.price\n    }));\n    setShowDeviceSelector(false);\n    setHasChanges(true);\n  };\n\n  const handleSgkSchemeSelect = (scheme: SGKScheme) => {\n    setSelectedSgkScheme(scheme);\n    const coverage = Math.min(formData.listPrice * (scheme.coveragePercentage / 100), scheme.maxAmount || Infinity);\n    setFormData(prev => ({\n      ...prev,\n      sgkCoverage: coverage\n    }));\n    setHasChanges(true);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!sale) return;\n    \n    setError(null);\n    setSuccess(null);\n    \n    // Validation\n    if (!formData.productName.trim()) {\n      setError('Ürün adı gereklidir');\n      return;\n    }\n    \n    if (!formData.listPrice || formData.listPrice <= 0) {\n      setError('Geçerli bir liste fiyatı giriniz');\n      return;\n    }\n    \n    if (formData.discountAmount < 0 || formData.discountAmount > formData.listPrice) {\n      setError('İndirim tutarı 0 ile liste fiyatı arasında olmalıdır');\n      return;\n    }\n    \n    if (!formData.salePrice || formData.salePrice <= 0) {\n      setError('Geçerli bir satış fiyatı giriniz');\n      return;\n    }\n    \n    if (paymentMethod === 'installment' && installmentCount < 2) {\n      setError('Taksit sayısı en az 2 olmalıdır');\n      return;\n    }\n\n    if (saleType === 'device' && !formData.deviceId) {\n      setError('Lütfen bir cihaz seçiniz');\n      return;\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      // Prepare update data according to API schema\n      const updateData: SalesUpdateSaleBody = {\n        productId: formData.deviceId || sale.productId,\n        saleDate: formData.saleDate,\n        totalAmount: formData.salePrice,\n        listPriceTotal: formData.listPrice,\n        discountAmount: formData.discountAmount,\n        sgkCoverage: formData.sgkCoverage,\n        patientPayment: formData.salePrice - formData.sgkCoverage,\n        paymentMethod: paymentMethod,\n        status: saleStatus,\n        notes: formData.notes.trim()\n      };\n\n      // Update sale using generated API client\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.salesUpdateSale(sale.id || '', updateData);\n      const updatedSale = response.data;\n\n      setSuccess('Satış başarıyla güncellendi');\n      \n      // Close modal after successful update\n      setTimeout(() => {\n        setError(null);\n        setSuccess(null);\n        onSaleUpdate(updatedSale);\n        onClose();\n      }, 2000);\n      \n    } catch (err) {\n      console.error('Sale update failed:', err);\n      setError('Satış güncellenirken bir hata oluştu. Lütfen tekrar deneyiniz.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handlePriceCalculation = (field: 'listPrice' | 'discountAmount' | 'salePrice', value: number) => {\n    const newFormData = { ...formData, [field]: value };\n    \n    if (field === 'listPrice' || field === 'discountAmount') {\n      // Auto-calculate sale price when list price or discount changes\n      newFormData.salePrice = newFormData.listPrice - newFormData.discountAmount;\n    } else if (field === 'salePrice') {\n      // Auto-calculate discount when sale price changes\n      newFormData.discountAmount = newFormData.listPrice - newFormData.salePrice;\n    }\n    \n    // Ensure values don't go negative\n    newFormData.discountAmount = Math.max(0, newFormData.discountAmount);\n    newFormData.salePrice = Math.max(0, newFormData.salePrice);\n    \n    // Recalculate SGK coverage if scheme is selected\n    if (selectedSgkScheme) {\n      const coverage = Math.min(newFormData.listPrice * (selectedSgkScheme.coveragePercentage / 100), selectedSgkScheme.maxAmount || Infinity);\n      newFormData.sgkCoverage = coverage;\n    }\n    \n    setFormData(newFormData);\n    setHasChanges(true);\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const canEditFinancials = saleStatus !== 'paid' && totalPaid === 0;\n  const hasPayments = false; // TODO: Load payment records separately\n\n  const filteredDevices = availableDevices.filter(device =>\n    device.name.toLowerCase().includes(deviceSearchTerm.toLowerCase()) ||\n    device.brand.toLowerCase().includes(deviceSearchTerm.toLowerCase()) ||\n    (device.model && device.model.toLowerCase().includes(deviceSearchTerm.toLowerCase()))\n  );\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <Edit className=\"w-5 h-5 mr-2\" />\n            Satış Düzenle\n          </h3>\n          <Button\n            onClick={onClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Error and Success Messages */}\n        {error && (\n          <Alert className=\"mb-4 bg-red-50 border-red-200 text-red-800\">\n            <AlertCircle className=\"w-4 h-4\" />\n            <span>{error}</span>\n          </Alert>\n        )}\n\n        {success && (\n          <Alert className=\"mb-4 bg-green-50 border-green-200 text-green-800\">\n            <CheckCircle className=\"w-4 h-4\" />\n            <span>{success}</span>\n          </Alert>\n        )}\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"space-y-6\">\n            {/* Customer & Sale Info */}\n            <div className=\"grid grid-cols-2 gap-6\">\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Müşteri Bilgileri</h4>\n                <div className=\"space-y-1 text-sm\">\n                  <div><span className=\"font-medium\">Ad Soyad:</span> {patient.firstName} {patient.lastName}</div>\n                  <div><span className=\"font-medium\">TC No:</span> {patient.tcNumber}</div>\n                  <div><span className=\"font-medium\">Telefon:</span> {patient.phone}</div>\n                </div>\n              </div>\n\n              <div className=\"bg-blue-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Satış Durumu</h4>\n                <div className=\"space-y-2\">\n                  <div className=\"text-sm\">\n                    <span className=\"font-medium\">Satış ID:</span> {sale.id}\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Durum</label>\n                    <select\n                      value={saleStatus}\n                      onChange={(e) => {\n                        setSaleStatus(e.target.value);\n                        setHasChanges(true);\n                      }}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    >\n                      <option value=\"draft\">Taslak</option>\n                      <option value=\"confirmed\">Onaylandı</option>\n                      <option value=\"paid\">Ödenmiş</option>\n                      <option value=\"cancelled\">İptal Edilmiş</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Payment Summary */}\n            {hasPayments && (\n              <div className=\"bg-green-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Ödeme Özeti</h4>\n                <div className=\"grid grid-cols-3 gap-4 text-sm\">\n                  <div>\n                    <span className=\"font-medium\">Toplam Tutar:</span> {formatCurrency(sale.totalAmount)}\n                  </div>\n                  <div>\n                    <span className=\"font-medium\">Ödenen:</span> {formatCurrency(totalPaid)}\n                  </div>\n                  <div className={remainingBalance > 0 ? 'text-red-700 font-medium' : 'text-green-700 font-medium'}>\n                    <span className=\"font-medium\">Kalan:</span> {formatCurrency(remainingBalance)}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Financial Edit Warning */}\n            {!canEditFinancials && (\n              <div className=\"bg-yellow-50 border border-yellow-200 p-4 rounded-lg\">\n                <div className=\"flex items-center text-yellow-800\">\n                  <AlertCircle className=\"w-5 h-5 mr-2\" />\n                  <span className=\"text-sm\">\n                    Bu satışa ait ödemeler bulunduğu için fiyat bilgileri düzenlenemez. \n                    Fiyat değişikliği için önce ödemeleri iptal etmeniz gerekir.\n                  </span>\n                </div>\n              </div>\n            )}\n\n            {/* Sale Date */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Satış Tarihi</label>\n              <Input\n                type=\"date\"\n                value={formData.saleDate}\n                onChange={(e) => handleInputChange('saleDate', e.target.value)}\n                className=\"w-48\"\n              />\n            </div>\n\n            {/* Sale Type */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Satış Türü</label>\n              <div className=\"grid grid-cols-3 gap-4\">\n                {[\n                  { value: 'device', label: 'Cihaz', icon: '🦻' },\n                  { value: 'service', label: 'Hizmet', icon: '🔧' },\n                  { value: 'accessory', label: 'Aksesuar', icon: '🔋' }\n                ].map((type) => (\n                  <button\n                    key={type.value}\n                    type=\"button\"\n                    onClick={() => {\n                      setSaleType(type.value as any);\n                      setHasChanges(true);\n                    }}\n                    className={`p-3 border rounded-lg text-center transition-colors ${\n                      saleType === type.value\n                        ? 'border-blue-500 bg-blue-50 text-blue-700'\n                        : 'border-gray-300 hover:border-gray-400'\n                    }`}\n                  >\n                    <div className=\"text-2xl mb-1\">{type.icon}</div>\n                    <div className=\"text-sm font-medium\">{type.label}</div>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Device Assignment - Only for device sales */}\n            {saleType === 'device' && (\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium text-gray-900 flex items-center\">\n                  <Package className=\"w-4 h-4 mr-2\" />\n                  Cihaz Seçimi\n                </h4>\n                \n                <div className=\"border rounded-lg p-4\">\n                  {selectedDevice ? (\n                    <div className=\"flex items-center justify-between bg-green-50 p-3 rounded-lg\">\n                      <div>\n                        <div className=\"font-medium\">{selectedDevice.name}</div>\n                        <div className=\"text-sm text-gray-600\">\n                          {selectedDevice.brand} - {selectedDevice.model} | {formatCurrency(selectedDevice.price)}\n                        </div>\n                        {selectedDevice.availableSerials && selectedDevice.availableSerials.length > 0 && (\n                          <div className=\"text-xs text-gray-500\">\n                            Seri No: {selectedDevice.availableSerials[0]}\n                          </div>\n                        )}\n                      </div>\n                      <Button\n                        type=\"button\"\n                        onClick={() => setShowDeviceSelector(true)}\n                        className=\"text-blue-600 hover:text-blue-800\"\n                      >\n                        Değiştir\n                      </Button>\n                    </div>\n                  ) : (\n                    <Button\n                      type=\"button\"\n                      onClick={() => setShowDeviceSelector(true)}\n                      className=\"w-full py-3 border-2 border-dashed border-gray-300 hover:border-gray-400 text-gray-600\"\n                    >\n                      <Search className=\"w-4 h-4 mr-2\" />\n                      Cihaz Seç\n                    </Button>\n                  )}\n                </div>\n\n                {/* Device Selector Modal */}\n                {showDeviceSelector && (\n                  <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60\">\n                    <div className=\"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto\">\n                      <div className=\"flex justify-between items-center mb-4\">\n                        <h4 className=\"text-lg font-medium\">Cihaz Seç</h4>\n                        <Button onClick={() => setShowDeviceSelector(false)}>\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                      \n                      <div className=\"mb-4\">\n                        <Input\n                          placeholder=\"Cihaz ara...\"\n                          value={deviceSearchTerm}\n                          onChange={(e) => setDeviceSearchTerm(e.target.value)}\n                          className=\"w-full\"\n                        />\n                      </div>\n                      \n                      <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                        {filteredDevices.map((device) => (\n                          <div\n                            key={device.id}\n                            onClick={() => handleDeviceSelect(device)}\n                            className=\"p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\"\n                          >\n                            <div className=\"font-medium\">{device.name}</div>\n                            <div className=\"text-sm text-gray-600\">\n                              {device.brand} - {device.model} | {formatCurrency(device.price)}\n                            </div>\n                            <div className=\"text-xs text-gray-500\">\n                              Stok: {device.availableInventory} | Kategori: {device.category}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* Device Details */}\n                {selectedDevice && (\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kulak</label>\n                      <select\n                        value={formData.ear}\n                        onChange={(e) => handleInputChange('ear', e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      >\n                        <option value=\"left\">Sol</option>\n                        <option value=\"right\">Sağ</option>\n                        <option value=\"both\">Her İki Kulak</option>\n                      </select>\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Garanti Süresi (Ay)</label>\n                      <Input\n                        type=\"number\"\n                        value={formData.warrantyPeriod}\n                        onChange={(e) => handleInputChange('warrantyPeriod', parseInt(e.target.value) || 24)}\n                        min=\"0\"\n                        max=\"60\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Service Information - Only for service sales */}\n            {saleType === 'service' && (\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium text-gray-900 flex items-center\">\n                  <Wrench className=\"w-4 h-4 mr-2\" />\n                  Hizmet Bilgileri\n                </h4>\n                \n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Hizmet Türü</label>\n                    <select\n                      value={serviceInfo.type}\n                      onChange={(e) => setServiceInfo(prev => ({ ...prev, type: e.target.value as ServiceInfo['type'] }))}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    >\n                      <option value=\"warranty\">Garanti Hizmeti</option>\n                      <option value=\"maintenance\">Bakım</option>\n                      <option value=\"repair\">Onarım</option>\n                      <option value=\"calibration\">Kalibrasyon</option>\n                      <option value=\"fitting\">Uyum</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Süre (Ay)</label>\n                    <Input\n                      type=\"number\"\n                      value={serviceInfo.duration || ''}\n                      onChange={(e) => setServiceInfo(prev => ({ ...prev, duration: parseInt(e.target.value) || 0 }))}\n                      placeholder=\"Hizmet süresi\"\n                    />\n                  </div>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Hizmet Açıklaması</label>\n                  <Textarea\n                    value={serviceInfo.description}\n                    onChange={(e) => setServiceInfo(prev => ({ ...prev, description: e.target.value }))}\n                    placeholder=\"Hizmet detayları...\"\n                    rows={3}\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Hizmet Notları</label>\n                  <Textarea\n                    value={serviceInfo.notes || ''}\n                    onChange={(e) => setServiceInfo(prev => ({ ...prev, notes: e.target.value }))}\n                    placeholder=\"Ek notlar...\"\n                    rows={2}\n                  />\n                </div>\n              </div>\n            )}\n\n            {/* Warranty Information - For device sales */}\n            {saleType === 'device' && (\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium text-gray-900 flex items-center\">\n                  <Settings className=\"w-4 h-4 mr-2\" />\n                  Garanti ve Hizmet\n                </h4>\n                \n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Garanti Süresi (Ay)</label>\n                    <Input\n                      type=\"number\"\n                      value={formData.warrantyPeriod}\n                      onChange={(e) => handleInputChange('warrantyPeriod', parseInt(e.target.value) || 24)}\n                      placeholder=\"24\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kulak</label>\n                    <select\n                      value={formData.ear}\n                      onChange={(e) => handleInputChange('ear', e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    >\n                      <option value=\"left\">Sol Kulak</option>\n                      <option value=\"right\">Sağ Kulak</option>\n                      <option value=\"both\">Her İki Kulak</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Garanti Bitiş</label>\n                    <Input\n                      type=\"text\"\n                      value={formData.saleDate ? \n                        new Date(new Date(formData.saleDate).getTime() + (formData.warrantyPeriod * 30 * 24 * 60 * 60 * 1000))\n                          .toLocaleDateString('tr-TR') : 'Satış tarihi giriniz'\n                      }\n                      disabled\n                      className=\"bg-gray-50\"\n                    />\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* SGK Information */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <FileText className=\"w-4 h-4 mr-2\" />\n                SGK Bilgileri\n              </h4>\n              \n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">SGK Şeması</label>\n                  <select\n                    value={selectedSgkScheme?.id || ''}\n                    onChange={(e) => {\n                      const scheme = sgkSchemes.find(s => s.id === e.target.value);\n                      if (scheme) handleSgkSchemeSelect(scheme);\n                    }}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  >\n                    <option value=\"\">SGK Şeması Seçiniz</option>\n                    {sgkSchemes.map((scheme) => (\n                      <option key={scheme.id} value={scheme.id}>\n                        {scheme.name} ({scheme.coveragePercentage}% - Max: {formatCurrency(scheme.maxAmount || 0)})\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">SGK Onay Numarası</label>\n                  <Input\n                    value={sgkApprovalNumber}\n                    onChange={(e) => setSgkApprovalNumber(e.target.value)}\n                    placeholder=\"SGK onay numarası\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">SGK Onay Tarihi</label>\n                  <Input\n                    type=\"date\"\n                    value={sgkApprovalDate}\n                    onChange={(e) => setSgkApprovalDate(e.target.value)}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">SGK Karşılığı</label>\n                  <Input\n                    type=\"number\"\n                    step=\"0.01\"\n                    value={formData.sgkCoverage}\n                    onChange={(e) => handleInputChange('sgkCoverage', parseFloat(e.target.value) || 0)}\n                    className=\"text-right\"\n                    disabled={!canEditFinancials}\n                  />\n                </div>\n              </div>\n              \n              {selectedSgkScheme && (\n                <div className=\"bg-blue-50 p-3 rounded-lg text-sm\">\n                  <div className=\"font-medium text-blue-900\">{selectedSgkScheme.name}</div>\n                  <div className=\"text-blue-700\">\n                    Kapsam: %{selectedSgkScheme.coveragePercentage} | \n                    Maksimum: {formatCurrency(selectedSgkScheme.maxAmount || 0)}\n                  </div>\n                  {selectedSgkScheme.description && (\n                    <div className=\"text-blue-600 mt-1\">{selectedSgkScheme.description}</div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* Product Details */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <CreditCard className=\"w-4 h-4 mr-2\" />\n                Ürün Bilgileri\n              </h4>\n              \n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Ürün Adı</label>\n                  <Input \n                    value={formData.productName}\n                    onChange={(e) => handleInputChange('productName', e.target.value)}\n                    placeholder=\"Ürün adını giriniz\" \n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Marka</label>\n                  <Input \n                    value={formData.brand}\n                    onChange={(e) => handleInputChange('brand', e.target.value)}\n                    placeholder=\"Marka\" \n                  />\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Model</label>\n                  <Input \n                    value={formData.model}\n                    onChange={(e) => handleInputChange('model', e.target.value)}\n                    placeholder=\"Model\" \n                  />\n                </div>\n                {saleType === 'device' && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Seri No</label>\n                    <Input \n                      value={formData.serialNumber}\n                      onChange={(e) => handleInputChange('serialNumber', e.target.value)}\n                      placeholder=\"Seri numarası\" \n                    />\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Additional Dates - Only for device sales */}\n            {saleType === 'device' && (\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium text-gray-900\">Önemli Tarihler</h4>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Uyum Tarihi</label>\n                    <Input\n                      type=\"date\"\n                      value={formData.fittingDate}\n                      onChange={(e) => handleInputChange('fittingDate', e.target.value)}\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Teslim Tarihi</label>\n                    <Input\n                      type=\"date\"\n                      value={formData.deliveryDate}\n                      onChange={(e) => handleInputChange('deliveryDate', e.target.value)}\n                    />\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Pricing */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <DollarSign className=\"w-4 h-4 mr-2\" />\n                Fiyatlandırma\n              </h4>\n              \n              <div className=\"grid grid-cols-4 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Liste Fiyatı</label>\n                  <Input \n                    type=\"number\" \n                    step=\"0.01\" \n                    value={formData.listPrice}\n                    onChange={(e) => handlePriceCalculation('listPrice', parseFloat(e.target.value) || 0)}\n                    className=\"text-right\"\n                    disabled={!canEditFinancials}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    İndirim ({discountPercentage.toFixed(1)}%)\n                  </label>\n                  <Input \n                    type=\"number\" \n                    step=\"0.01\" \n                    value={formData.discountAmount}\n                    onChange={(e) => handlePriceCalculation('discountAmount', parseFloat(e.target.value) || 0)}\n                    className=\"text-right\"\n                    disabled={!canEditFinancials}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">SGK Karşılığı</label>\n                  <Input \n                    type=\"number\" \n                    step=\"0.01\" \n                    value={formData.sgkCoverage}\n                    onChange={(e) => handleInputChange('sgkCoverage', parseFloat(e.target.value) || 0)}\n                    className=\"text-right\"\n                    disabled={!canEditFinancials}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Satış Fiyatı *</label>\n                  <Input \n                    type=\"number\" \n                    step=\"0.01\" \n                    value={formData.salePrice}\n                    onChange={(e) => handlePriceCalculation('salePrice', parseFloat(e.target.value) || 0)}\n                    className=\"text-right font-medium\"\n                    disabled={!canEditFinancials}\n                  />\n                </div>\n              </div>\n\n              {!canEditFinancials && (\n                <div className=\"text-sm text-gray-600 bg-gray-50 p-2 rounded\">\n                  <strong>Mevcut Fiyat:</strong> {formatCurrency(sale.totalAmount)}\n                </div>\n              )}\n            </div>\n\n            {/* Payment Method */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <CreditCard className=\"w-4 h-4 mr-2\" />\n                Ödeme Yöntemi\n              </h4>\n              \n              <div className=\"grid grid-cols-2 md:grid-cols-5 gap-2\">\n                {[\n                  { value: 'cash', label: 'Nakit' },\n                  { value: 'card', label: 'Kredi Kartı' },\n                  { value: 'installment', label: 'Taksit' },\n                  { value: 'bank_transfer', label: 'Havale' },\n                  { value: 'sgk', label: 'SGK' }\n                ].map((method) => (\n                  <button\n                    key={method.value}\n                    type=\"button\"\n                    onClick={() => {\n                      setPaymentMethod(method.value);\n                      setHasChanges(true);\n                    }}\n                    className={`p-2 text-sm border rounded-md transition-colors ${\n                      paymentMethod === method.value\n                        ? 'border-blue-500 bg-blue-50 text-blue-700'\n                        : 'border-gray-300 hover:border-gray-400'\n                    }`}\n                  >\n                    {method.label}\n                  </button>\n                ))}\n              </div>\n\n              {paymentMethod === 'installment' && (\n                <div className=\"mt-4\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Taksit Sayısı</label>\n                  <select\n                    value={installmentCount}\n                    onChange={(e) => {\n                      setInstallmentCount(parseInt(e.target.value));\n                      setHasChanges(true);\n                    }}\n                    className=\"w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  >\n                    {[2, 3, 4, 6, 9, 12, 18, 24].map(count => (\n                      <option key={count} value={count}>{count} Taksit</option>\n                    ))}\n                  </select>\n                  <div className=\"text-sm text-gray-600 mt-1\">\n                    Aylık Ödeme: {formatCurrency(formData.salePrice / installmentCount)}\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Notes */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Notlar</label>\n              <Textarea\n                value={formData.notes}\n                onChange={(e) => handleInputChange('notes', e.target.value)}\n                placeholder=\"Satış ile ilgili notlar...\"\n                rows={3}\n              />\n            </div>\n          </div>\n\n          <div className=\"flex justify-between items-center space-x-3 mt-6 pt-6 border-t\">\n            <div className=\"flex space-x-2\">\n              <Button\n                type=\"button\"\n                onClick={() => setShowPaymentModal(true)}\n                className=\"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md flex items-center\"\n              >\n                <CreditCard className=\"w-4 h-4 mr-2\" />\n                Ödeme Takibi\n              </Button>\n            </div>\n            \n            <div className=\"flex space-x-3\">\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n              >\n                İptal\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center\"\n                disabled={loading || isLoading || !hasChanges || !!error}\n              >\n                {(loading || isLoading) && <Spinner className=\"w-4 h-4 mr-2\" />}\n                {(loading || isLoading) ? 'Kaydediliyor...' : 'Değişiklikleri Kaydet'}\n              </Button>\n            </div>\n          </div>\n        </form>\n      </div>\n      \n      {/* Payment Tracking Modal */}\n      <PaymentTrackingModal\n        isOpen={showPaymentModal}\n        onClose={() => setShowPaymentModal(false)}\n        sale={sale}\n        onPaymentUpdate={() => {\n          // Refresh sale data or trigger parent update\n          onSaleUpdate(sale);\n        }}\n      />\n    </div>\n  );\n};\n\nexport default EditSaleModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/ProformaModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PricingPreviewComponent' is defined but never used.","line":23,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'APIPatient' is defined but never used.","line":25,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Sale' is defined but never used.","line":25,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":42},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'mockProducts'. Either include it or remove the dependency array.","line":128,"column":6,"nodeType":"ArrayExpression","endLine":128,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [mockProducts, searchTerm]","fix":{"range":[3308,3320],"text":"[mockProducts, searchTerm]"}}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport { \n  Button, \n  Textarea, \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Alert,\n  Input\n} from '@x-ear/ui-web';\nimport { \n  X, \n  AlertCircle, \n  CheckCircle,\n  FileText,\n  Calculator,\n  Calendar,\n  User\n} from 'lucide-react';\nimport { Patient } from '../../../types/patient';\nimport ProductSearchComponent from './components/ProductSearchComponent';\nimport PricingPreviewComponent from './components/PricingPreviewComponent';\nimport { getXEarCRMAPIAutoGenerated } from '../../../api/generated/api';\nimport type { Patient as APIPatient, Sale, SalesCreateSaleBody } from '../../../api/generated/api';\n\ninterface Product {\n  id: string;\n  name: string;\n  brand: string;\n  model: string;\n  category: string;\n  listPrice: number;\n  salePrice: number;\n  vatRate: number;\n  stock: number;\n  serialNumber?: string;\n  barcode?: string;\n  sgkSupported: boolean;\n  sgkCode?: string;\n}\n\ninterface ProformaItem {\n  product: Product;\n  quantity: number;\n  unitPrice: number;\n  discountPercent: number;\n  discountAmount: number;\n  totalPrice: number;\n}\n\ninterface ProformaData {\n  patientId: string;\n  proformaNumber: string;\n  validUntil: string;\n  items: ProformaItem[];\n  subtotal: number;\n  totalDiscount: number;\n  vatAmount: number;\n  grandTotal: number;\n  notes: string;\n  terms: string;\n}\n\ninterface ProformaModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  onProformaCreate: (data: ProformaData) => void;\n}\n\nexport const ProformaModal: React.FC<ProformaModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  onProformaCreate\n}) => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);\n  const [items, setItems] = useState<ProformaItem[]>([]);\n  const [quantity, setQuantity] = useState('1');\n  const [customPrice, setCustomPrice] = useState('');\n  const [discountPercent, setDiscountPercent] = useState('');\n  const [validUntil, setValidUntil] = useState('');\n  const [notes, setNotes] = useState('');\n  const [terms, setTerms] = useState('Bu teklif 30 gün geçerlidir. Fiyatlar KDV dahildir.');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  // Mock product data\n  const mockProducts: Product[] = [\n    {\n      id: '1',\n      name: 'İşitme Cihazı Premium',\n      brand: 'Phonak',\n      model: 'Audéo Paradise P90',\n      category: 'İşitme Cihazı',\n      listPrice: 25000,\n      salePrice: 22000,\n      vatRate: 18,\n      stock: 5,\n      sgkSupported: true,\n      sgkCode: 'SGK001'\n    },\n    {\n      id: '2',\n      name: 'İşitme Cihazı Standart',\n      brand: 'Oticon',\n      model: 'More 1',\n      category: 'İşitme Cihazı',\n      listPrice: 18000,\n      salePrice: 16000,\n      vatRate: 18,\n      stock: 8,\n      sgkSupported: true,\n      sgkCode: 'SGK002'\n    }\n  ];\n\n  const searchResults = useMemo(() => {\n    if (!searchTerm.trim()) return [];\n    return mockProducts.filter(product =>\n      product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      product.brand.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      product.model.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n  }, [searchTerm]);\n\n  useEffect(() => {\n    if (isOpen) {\n      // Set default valid until date (30 days from now)\n      const defaultValidUntil = new Date();\n      defaultValidUntil.setDate(defaultValidUntil.getDate() + 30);\n      setValidUntil(defaultValidUntil.toISOString().split('T')[0]);\n      \n      // Reset form\n      setSearchTerm('');\n      setSelectedProduct(null);\n      setItems([]);\n      setQuantity('1');\n      setCustomPrice('');\n      setDiscountPercent('');\n      setNotes('');\n      setError(null);\n      setSuccess(false);\n    }\n  }, [isOpen]);\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const generateProformaNumber = () => {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, '0');\n    const day = String(now.getDate()).padStart(2, '0');\n    const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n    return `PF${year}${month}${day}${random}`;\n  };\n\n  const addItem = () => {\n    if (!selectedProduct) {\n      setError('Lütfen bir ürün seçiniz');\n      return;\n    }\n\n    const qty = parseInt(quantity) || 1;\n    const unitPrice = parseFloat(customPrice) || selectedProduct.salePrice;\n    const discount = parseFloat(discountPercent) || 0;\n    const discountAmount = (unitPrice * qty * discount) / 100;\n    const totalPrice = (unitPrice * qty) - discountAmount;\n\n    const newItem: ProformaItem = {\n      product: selectedProduct,\n      quantity: qty,\n      unitPrice,\n      discountPercent: discount,\n      discountAmount,\n      totalPrice\n    };\n\n    setItems(prev => [...prev, newItem]);\n    \n    // Reset form\n    setSelectedProduct(null);\n    setSearchTerm('');\n    setQuantity('1');\n    setCustomPrice('');\n    setDiscountPercent('');\n    setError(null);\n  };\n\n  const removeItem = (index: number) => {\n    setItems(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const totals = useMemo(() => {\n    const subtotal = items.reduce((sum, item) => sum + (item.unitPrice * item.quantity), 0);\n    const totalDiscount = items.reduce((sum, item) => sum + item.discountAmount, 0);\n    const netAmount = subtotal - totalDiscount;\n    const vatAmount = netAmount * 0.18; // 18% VAT\n    const grandTotal = netAmount + vatAmount;\n\n    return {\n      subtotal,\n      totalDiscount,\n      vatAmount,\n      grandTotal\n    };\n  }, [items]);\n\n  const validateForm = () => {\n    const errors: string[] = [];\n    \n    if (items.length === 0) {\n      errors.push('En az bir ürün eklemelisiniz');\n    }\n    \n    if (!validUntil) {\n      errors.push('Geçerlilik tarihi seçiniz');\n    }\n    \n    return errors;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      \n      // Create proforma as a special sale with \"PROFORMA\" status\n      const proformaData: SalesCreateSaleBody = {\n        patientId: patient.id,\n        productId: items[0]?.product?.id || '', // Use first item's product ID\n        quantity: items[0]?.quantity || 1,\n        unitPrice: items[0]?.unitPrice || 0,\n        totalAmount: totals.grandTotal,\n        saleDate: new Date().toISOString(),\n        paymentMethod: 'CASH', // Default for proforma\n        status: 'PROFORMA', // Special status to indicate this is a proforma\n        notes: `Proforma: ${generateProformaNumber()}\\nGeçerlilik: ${validUntil}\\nŞartlar: ${terms}\\nNotlar: ${notes}`,\n        installmentCount: 1\n      };\n\n      const response = await api.salesCreateSale(proformaData);\n      \n      if (response.data) {\n        setSuccess(true);\n        setTimeout(() => {\n          onProformaCreate({\n            patientId: patient.id || '',\n            proformaNumber: generateProformaNumber(),\n            validUntil: validUntil || '',\n            items,\n            subtotal: totals.subtotal,\n            totalDiscount: totals.totalDiscount,\n            vatAmount: totals.vatAmount,\n            grandTotal: totals.grandTotal,\n            notes,\n            terms\n          });\n          onClose();\n        }, 2000);\n      }\n    } catch (err) {\n      console.error('Proforma creation error:', err);\n      setError(err instanceof Error ? err.message : 'Proforma oluşturulamadı');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto\">\n        <form onSubmit={handleSubmit}>\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b bg-gradient-to-r from-blue-50 to-indigo-50\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"p-2 bg-blue-100 rounded-lg\">\n                <FileText className=\"w-6 h-6 text-blue-600\" />\n              </div>\n              <div>\n                <h2 className=\"text-xl font-bold text-gray-900\">Proforma Fatura Oluştur</h2>\n                <p className=\"text-sm text-gray-600\">\n                  {patient.firstName} {patient.lastName} - {patient.tcNumber}\n                </p>\n              </div>\n            </div>\n            <Button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            >\n              <X className=\"w-5 h-5 text-gray-500\" />\n            </Button>\n          </div>\n\n          <div className=\"p-6 space-y-6\">\n            {/* Success Message */}\n            {success && (\n              <Alert variant=\"success\" className=\"mb-4\">\n                <CheckCircle className=\"h-4 w-4\" />\n                <span>Proforma fatura başarıyla oluşturuldu!</span>\n              </Alert>\n            )}\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              {/* Left Column - Product Selection */}\n              <div className=\"space-y-6\">\n                {/* Customer Info */}\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg flex items-center\">\n                      <User className=\"w-5 h-5 mr-2 text-gray-600\" />\n                      Müşteri Bilgileri\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2 text-sm\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"font-medium text-gray-600\">Ad Soyad:</span>\n                        <span className=\"text-gray-900\">{patient.firstName} {patient.lastName}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"font-medium text-gray-600\">TC No:</span>\n                        <span className=\"text-gray-900\">{patient.tcNumber}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"font-medium text-gray-600\">Telefon:</span>\n                        <span className=\"text-gray-900\">{patient.phone}</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Product Search */}\n                <ProductSearchComponent\n                  searchTerm={searchTerm}\n                  onSearchChange={setSearchTerm}\n                  searchResults={searchResults}\n                  selectedProduct={selectedProduct}\n                  onProductSelect={setSelectedProduct}\n                  isSearching={false}\n                  showResults={searchTerm.length > 0}\n                />\n\n                {/* Add Item Form */}\n                {selectedProduct && (\n                  <Card>\n                    <CardHeader className=\"pb-3\">\n                      <CardTitle className=\"text-lg\">Ürün Detayları</CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Miktar\n                          </label>\n                          <Input\n                            type=\"number\"\n                            min=\"1\"\n                            value={quantity}\n                            onChange={(e) => setQuantity(e.target.value)}\n                            className=\"w-full\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Birim Fiyat\n                          </label>\n                          <Input\n                            type=\"number\"\n                            step=\"0.01\"\n                            placeholder={selectedProduct.salePrice.toString()}\n                            value={customPrice}\n                            onChange={(e) => setCustomPrice(e.target.value)}\n                            className=\"w-full\"\n                          />\n                        </div>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          İndirim (%)\n                        </label>\n                        <Input\n                          type=\"number\"\n                          min=\"0\"\n                          max=\"100\"\n                          step=\"0.01\"\n                          placeholder=\"İndirim oranı\"\n                          value={discountPercent}\n                          onChange={(e) => setDiscountPercent(e.target.value)}\n                          className=\"w-full\"\n                        />\n                      </div>\n                      <Button\n                        type=\"button\"\n                        onClick={addItem}\n                        className=\"w-full bg-green-600 hover:bg-green-700 text-white\"\n                      >\n                        Ürünü Ekle\n                      </Button>\n                    </CardContent>\n                  </Card>\n                )}\n\n                {/* Proforma Details */}\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg flex items-center\">\n                      <Calendar className=\"w-5 h-5 mr-2 text-gray-600\" />\n                      Proforma Detayları\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                        Geçerlilik Tarihi\n                      </label>\n                      <Input\n                        type=\"date\"\n                        value={validUntil}\n                        onChange={(e) => setValidUntil(e.target.value)}\n                        className=\"w-full\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                        Şartlar ve Koşullar\n                      </label>\n                      <Textarea\n                        rows={3}\n                        value={terms}\n                        onChange={(e) => setTerms(e.target.value)}\n                        className=\"resize-none\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                        Notlar\n                      </label>\n                      <Textarea\n                        rows={3}\n                        placeholder=\"Proforma ile ilgili notlarınızı buraya yazabilirsiniz...\"\n                        value={notes}\n                        onChange={(e) => setNotes(e.target.value)}\n                        className=\"resize-none\"\n                      />\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Right Column - Items List & Summary */}\n              <div className=\"space-y-6\">\n                {/* Items List */}\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg flex items-center\">\n                      <Calculator className=\"w-5 h-5 mr-2 text-gray-600\" />\n                      Ürün Listesi ({items.length} ürün)\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    {items.length === 0 ? (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        Henüz ürün eklenmemiş\n                      </div>\n                    ) : (\n                      <div className=\"space-y-3\">\n                        {items.map((item, index) => (\n                          <div key={index} className=\"p-3 border rounded-lg\">\n                            <div className=\"flex justify-between items-start\">\n                              <div className=\"flex-1\">\n                                <div className=\"font-medium text-gray-900\">\n                                  {item.product.name}\n                                </div>\n                                <div className=\"text-sm text-gray-600\">\n                                  {item.product.brand} {item.product.model}\n                                </div>\n                                <div className=\"text-sm text-gray-600 mt-1\">\n                                  {item.quantity} x {formatCurrency(item.unitPrice)}\n                                  {item.discountPercent > 0 && (\n                                    <span className=\"text-red-600 ml-2\">\n                                      (-%{item.discountPercent})\n                                    </span>\n                                  )}\n                                </div>\n                              </div>\n                              <div className=\"text-right\">\n                                <div className=\"font-bold text-gray-900\">\n                                  {formatCurrency(item.totalPrice)}\n                                </div>\n                                <Button\n                                  type=\"button\"\n                                  onClick={() => removeItem(index)}\n                                  className=\"text-red-600 hover:text-red-800 text-sm mt-1\"\n                                >\n                                  Kaldır\n                                </Button>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                {/* Summary */}\n                {items.length > 0 && (\n                  <Card>\n                    <CardHeader className=\"pb-3\">\n                      <CardTitle className=\"text-lg\">Özet</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Ara Toplam:</span>\n                          <span className=\"text-gray-900\">{formatCurrency(totals.subtotal)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Toplam İndirim:</span>\n                          <span className=\"text-red-600\">-{formatCurrency(totals.totalDiscount)}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">KDV (%18):</span>\n                          <span className=\"text-gray-900\">{formatCurrency(totals.vatAmount)}</span>\n                        </div>\n                        <div className=\"flex justify-between font-bold text-lg border-t pt-2\">\n                          <span className=\"text-gray-900\">Genel Toplam:</span>\n                          <span className=\"text-blue-600\">{formatCurrency(totals.grandTotal)}</span>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                )}\n              </div>\n            </div>\n\n            {/* Error Message */}\n            {error && (\n              <Alert variant=\"error\">\n                <AlertCircle className=\"h-4 w-4\" />\n                <span>{error}</span>\n              </Alert>\n            )}\n\n            {/* Form Actions */}\n            <div className=\"flex justify-end space-x-4 pt-6 border-t bg-gray-50 -mx-6 -mb-6 px-6 py-4\">\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-6 py-2 border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 rounded-lg transition-colors\"\n              >\n                İptal\n              </Button>\n              <Button\n                type=\"submit\"\n                disabled={isLoading || items.length === 0}\n                className=\"px-6 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 flex items-center space-x-2\"\n              >\n                {isLoading && <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />}\n                <span>Proforma Oluştur</span>\n              </Button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default ProformaModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/PromissoryNoteModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'APISale' is defined but never used.","line":5,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1050,1053],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1050,1053],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onSave' is defined but never used.","line":44,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":9},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":178,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5423,5426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5423,5426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":262,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":262,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8946,8949],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8946,8949],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":378,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":388,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":397,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":404,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":443,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":450,"endColumn":19}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Input, Textarea, Alert, AlertDescription, Spinner } from '@x-ear/ui-web';\nimport { X, FileText, User, Building, AlertTriangle, AlertCircle, CheckCircle } from 'lucide-react';\nimport { Patient } from '../../../types/patient';\nimport { Sale as APISale } from '../../../api/generated/api';\nimport { Sale } from '../../../types/patient/patient-communication.types';\n\ninterface PromissoryNote {\n  id?: string;\n  saleId: string;\n  patientId: string;\n  noteNumber: string;\n  amount: number;\n  issueDate: string;\n  dueDate: string;\n  interestRate?: number;\n  guarantorName?: string;\n  guarantorTcNumber?: string;\n  guarantorPhone?: string;\n  guarantorAddress?: string;\n  notes?: string;\n  status: 'active' | 'paid' | 'overdue' | 'cancelled';\n  createdAt?: string;\n  updatedAt?: string;\n}\n\ninterface PromissoryNoteModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  sale?: Sale;\n  promissoryNote?: PromissoryNote; // For editing existing notes\n  onSave: (noteData: any) => void;\n  loading?: boolean;\n  mode?: 'create' | 'edit' | 'view';\n}\n\nexport const PromissoryNoteModal: React.FC<PromissoryNoteModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  sale,\n  promissoryNote,\n  onSave,\n  loading = false,\n  mode = 'create'\n}) => {\n  const [formData, setFormData] = useState<Partial<PromissoryNote>>({\n    saleId: sale?.id || '',\n    patientId: patient.id,\n    noteNumber: '',\n    amount: sale?.totalAmount || 0,\n    issueDate: new Date().toISOString().split('T')[0],\n    dueDate: '',\n    interestRate: 0,\n    guarantorName: '',\n    guarantorTcNumber: '',\n    guarantorPhone: '',\n    guarantorAddress: '',\n    notes: '',\n    status: 'active'\n  });\n\n  const [hasGuarantor, setHasGuarantor] = useState(false);\n  const [calculateInterest, setCalculateInterest] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (promissoryNote && mode !== 'create') {\n      setFormData(promissoryNote);\n      setHasGuarantor(!!promissoryNote.guarantorName);\n      setCalculateInterest(!!promissoryNote.interestRate && promissoryNote.interestRate > 0);\n    } else if (mode === 'create') {\n      // Generate note number\n      const noteNumber = `SN-${Date.now().toString().slice(-6)}`;\n      setFormData(prev => ({ ...prev, noteNumber }));\n    }\n  }, [promissoryNote, mode]);\n\n  if (!isOpen) return null;\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    setError(null);\n    setSuccess(null);\n    \n    // Validation\n    if (!formData.noteNumber?.trim()) {\n      setError('Senet numarası gereklidir');\n      return;\n    }\n    \n    if (!formData.issueDate) {\n      setError('Düzenleme tarihi gereklidir');\n      return;\n    }\n    \n    if (!formData.dueDate) {\n      setError('Vade tarihi gereklidir');\n      return;\n    }\n    \n    if (!formData.amount || formData.amount <= 0) {\n      setError('Geçerli bir tutar giriniz');\n      return;\n    }\n    \n    if (new Date(formData.dueDate) <= new Date(formData.issueDate)) {\n      setError('Vade tarihi düzenleme tarihinden sonra olmalıdır');\n      return;\n    }\n    \n    if (calculateInterest && (!formData.interestRate || formData.interestRate < 0)) {\n      setError('Geçerli bir faiz oranı giriniz');\n      return;\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      const noteData = {\n        ...formData,\n        noteNumber: formData.noteNumber?.trim(),\n        interestRate: calculateInterest ? formData.interestRate : 0,\n        guarantorName: hasGuarantor ? formData.guarantorName : '',\n        guarantorTcNumber: hasGuarantor ? formData.guarantorTcNumber : '',\n        guarantorPhone: hasGuarantor ? formData.guarantorPhone : '',\n        guarantorAddress: hasGuarantor ? formData.guarantorAddress : '',\n        notes: formData.notes?.trim(),\n        ...(mode === 'create' && { createdAt: new Date().toISOString() }),\n        ...(mode === 'edit' && { updatedAt: new Date().toISOString() })\n      };\n      \n      console.log('Promissory note saved:', noteData);\n      \n      setSuccess(mode === 'edit' ? 'Senet başarıyla güncellendi' : 'Senet başarıyla oluşturuldu');\n      \n      // Reset form after successful submission\n      setTimeout(() => {\n        if (mode === 'create') {\n          // Only reset if creating new note\n          setFormData({\n            saleId: sale?.id || '',\n            patientId: patient.id,\n            noteNumber: '',\n            amount: sale?.totalAmount || 0,\n            issueDate: new Date().toISOString().split('T')[0],\n            dueDate: '',\n            interestRate: 0,\n            guarantorName: '',\n            guarantorTcNumber: '',\n            guarantorPhone: '',\n            guarantorAddress: '',\n            notes: '',\n            status: 'active'\n          });\n          setHasGuarantor(false);\n          setCalculateInterest(false);\n        }\n        setError(null);\n        setSuccess(null);\n        onClose();\n      }, 2000);\n      \n    } catch (err) {\n      setError('Senet kaydedilirken bir hata oluştu. Lütfen tekrar deneyiniz.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleInputChange = (field: keyof PromissoryNote, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const calculateDaysUntilDue = () => {\n    if (!formData.dueDate) return 0;\n    const today = new Date();\n    const dueDate = new Date(formData.dueDate);\n    const diffTime = dueDate.getTime() - today.getTime();\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  };\n\n  const calculateTotalWithInterest = () => {\n    if (!calculateInterest || !formData.interestRate || !formData.amount) return formData.amount || 0;\n    \n    const daysUntilDue = calculateDaysUntilDue();\n    if (daysUntilDue <= 0) return formData.amount;\n    \n    const dailyRate = (formData.interestRate / 100) / 365;\n    const interestAmount = formData.amount * dailyRate * daysUntilDue;\n    return formData.amount + interestAmount;\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const isOverdue = formData.dueDate && new Date(formData.dueDate) < new Date();\n  const daysUntilDue = calculateDaysUntilDue();\n  const totalWithInterest = calculateTotalWithInterest();\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <FileText className=\"w-5 h-5 mr-2\" />\n            {mode === 'create' ? 'Yeni Senet Oluştur' : mode === 'edit' ? 'Senet Düzenle' : 'Senet Detayları'}\n          </h3>\n          <Button\n            onClick={onClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {error && (\n          <Alert className=\"mb-4 bg-red-50 border-red-200\">\n            <AlertCircle className=\"h-4 w-4 text-red-600\" />\n            <AlertDescription className=\"text-red-800\">{error}</AlertDescription>\n          </Alert>\n        )}\n\n        {success && (\n          <Alert className=\"mb-4 bg-green-50 border-green-200\">\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n            <AlertDescription className=\"text-green-800\">{success}</AlertDescription>\n          </Alert>\n        )}\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"space-y-6\">\n            {/* Customer & Sale Info */}\n            <div className=\"grid grid-cols-2 gap-6\">\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2 flex items-center\">\n                  <User className=\"w-4 h-4 mr-2\" />\n                  Müşteri Bilgileri\n                </h4>\n                <div className=\"space-y-1 text-sm\">\n                  <div><span className=\"font-medium\">Ad Soyad:</span> {patient.firstName} {patient.lastName}</div>\n                  <div><span className=\"font-medium\">TC No:</span> {patient.tcNumber}</div>\n                  <div><span className=\"font-medium\">Telefon:</span> {patient.phone}</div>\n                  <div><span className=\"font-medium\">Adres:</span> {(() => {\n                    const address = patient.address;\n                    if (typeof address === 'object' && address !== null) {\n                      const addressObj = address as any;\n                      return addressObj.fullAddress || \n                             `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                             'Adres bilgisi yok';\n                    }\n                    return patient.addressFull || address || 'Adres bilgisi yok';\n                  })()}</div>\n                </div>\n              </div>\n\n              {sale && (\n                <div className=\"bg-blue-50 p-4 rounded-lg\">\n                  <h4 className=\"font-medium text-gray-900 mb-2 flex items-center\">\n                    <Building className=\"w-4 h-4 mr-2\" />\n                    Satış Bilgileri\n                  </h4>\n                  <div className=\"space-y-1 text-sm\">\n                    <div><span className=\"font-medium\">Satış ID:</span> {sale.id}</div>\n                    <div><span className=\"font-medium\">Satış Tarihi:</span> {sale.saleDate ? formatDate(sale.saleDate) : '-'}</div>\n                    <div><span className=\"font-medium\">Toplam Tutar:</span> {formatCurrency(sale.totalAmount)}</div>\n                    <div><span className=\"font-medium\">Ödeme Yöntemi:</span> {sale.paymentMethod || '-'}</div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Status Warning */}\n            {mode !== 'create' && formData.status === 'overdue' && (\n              <div className=\"bg-red-50 border border-red-200 p-4 rounded-lg\">\n                <div className=\"flex items-center text-red-800\">\n                  <AlertTriangle className=\"w-5 h-5 mr-2\" />\n                  <span className=\"font-medium\">Bu senet vadesi geçmiştir!</span>\n                </div>\n              </div>\n            )}\n\n            {/* Note Details */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <FileText className=\"w-4 h-4 mr-2\" />\n                Senet Bilgileri\n              </h4>\n              \n              <div className=\"grid grid-cols-3 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Senet No *</label>\n                  <Input\n                    name=\"noteNumber\"\n                    value={formData.noteNumber}\n                    onChange={(e) => handleInputChange('noteNumber', e.target.value)}\n                    placeholder=\"SN-XXXXXX\"\n                    required\n                    disabled={mode === 'view'}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Düzenleme Tarihi *</label>\n                  <Input\n                    name=\"issueDate\"\n                    type=\"date\"\n                    value={formData.issueDate}\n                    onChange={(e) => handleInputChange('issueDate', e.target.value)}\n                    required\n                    disabled={mode === 'view'}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Vade Tarihi *</label>\n                  <Input\n                    name=\"dueDate\"\n                    type=\"date\"\n                    value={formData.dueDate}\n                    onChange={(e) => handleInputChange('dueDate', e.target.value)}\n                    required\n                    disabled={mode === 'view'}\n                  />\n                  {daysUntilDue > 0 && (\n                    <p className=\"text-xs text-gray-600 mt-1\">{daysUntilDue} gün kaldı</p>\n                  )}\n                  {isOverdue && (\n                    <p className=\"text-xs text-red-600 mt-1 font-medium\">{Math.abs(daysUntilDue)} gün gecikmiş</p>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Senet Tutarı *</label>\n                  <Input\n                    name=\"amount\"\n                    type=\"number\"\n                    step=\"0.01\"\n                    value={formData.amount}\n                    onChange={(e) => handleInputChange('amount', parseFloat(e.target.value) || 0)}\n                    className=\"text-right font-medium\"\n                    required\n                    disabled={mode === 'view'}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Durum</label>\n                  {mode === 'view' ? (\n                    <div className=\"px-3 py-2 bg-gray-100 rounded-md\">\n                      <span className={`inline-flex px-2 py-1 text-xs font-medium rounded-full ${\n                        formData.status === 'active' ? 'bg-green-100 text-green-800' :\n                        formData.status === 'paid' ? 'bg-blue-100 text-blue-800' :\n                        formData.status === 'overdue' ? 'bg-red-100 text-red-800' :\n                        'bg-gray-100 text-gray-800'\n                      }`}>\n                        {formData.status === 'active' ? 'Aktif' :\n                         formData.status === 'paid' ? 'Ödenmiş' :\n                         formData.status === 'overdue' ? 'Vadesi Geçmiş' :\n                         'İptal Edilmiş'}\n                      </span>\n                    </div>\n                  ) : (\n                    <select\n                      value={formData.status}\n                      onChange={(e) => handleInputChange('status', e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      disabled={mode === 'create'}\n                    >\n                      <option value=\"active\">Aktif</option>\n                      <option value=\"paid\">Ödenmiş</option>\n                      <option value=\"overdue\">Vadesi Geçmiş</option>\n                      <option value=\"cancelled\">İptal Edilmiş</option>\n                    </select>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            {/* Interest Calculation */}\n            <div className=\"bg-yellow-50 p-4 rounded-lg\">\n              <div className=\"flex items-center mb-3\">\n                <input\n                  type=\"checkbox\"\n                  id=\"calculateInterest\"\n                  checked={calculateInterest}\n                  onChange={(e) => setCalculateInterest(e.target.checked)}\n                  className=\"mr-3\"\n                  disabled={mode === 'view'}\n                />\n                <label htmlFor=\"calculateInterest\" className=\"text-sm font-medium text-gray-700\">\n                  Faiz hesaplama uygula\n                </label>\n              </div>\n\n              {calculateInterest && (\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Yıllık Faiz Oranı (%)</label>\n                    <Input\n                      name=\"interestRate\"\n                      type=\"number\"\n                      step=\"0.01\"\n                      value={formData.interestRate}\n                      onChange={(e) => handleInputChange('interestRate', parseFloat(e.target.value) || 0)}\n                      placeholder=\"0.00\"\n                      disabled={mode === 'view'}\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Faiz Tutarı</label>\n                    <div className=\"px-3 py-2 bg-gray-100 rounded-md text-right font-medium\">\n                      {formatCurrency(totalWithInterest - (formData.amount || 0))}\n                    </div>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Toplam Tutar</label>\n                    <div className=\"px-3 py-2 bg-blue-100 rounded-md text-right font-bold text-blue-800\">\n                      {formatCurrency(totalWithInterest)}\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Guarantor Information */}\n            <div className=\"bg-purple-50 p-4 rounded-lg\">\n              <div className=\"flex items-center mb-3\">\n                <input\n                  type=\"checkbox\"\n                  id=\"hasGuarantor\"\n                  checked={hasGuarantor}\n                  onChange={(e) => setHasGuarantor(e.target.checked)}\n                  className=\"mr-3\"\n                  disabled={mode === 'view'}\n                />\n                <label htmlFor=\"hasGuarantor\" className=\"text-sm font-medium text-gray-700\">\n                  Kefil bilgileri ekle\n                </label>\n              </div>\n\n              {hasGuarantor && (\n                <div className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kefil Adı Soyadı</label>\n                      <Input\n                        name=\"guarantorName\"\n                        value={formData.guarantorName}\n                        onChange={(e) => handleInputChange('guarantorName', e.target.value)}\n                        placeholder=\"Kefil adı soyadı\"\n                        disabled={mode === 'view'}\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kefil TC No</label>\n                      <Input\n                        name=\"guarantorTcNumber\"\n                        value={formData.guarantorTcNumber}\n                        onChange={(e) => handleInputChange('guarantorTcNumber', e.target.value)}\n                        placeholder=\"TC Kimlik No\"\n                        maxLength={11}\n                        disabled={mode === 'view'}\n                      />\n                    </div>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kefil Telefon</label>\n                      <Input\n                        name=\"guarantorPhone\"\n                        value={formData.guarantorPhone}\n                        onChange={(e) => handleInputChange('guarantorPhone', e.target.value)}\n                        placeholder=\"Telefon numarası\"\n                        disabled={mode === 'view'}\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Kefil Adresi</label>\n                      <Input\n                        name=\"guarantorAddress\"\n                        value={formData.guarantorAddress}\n                        onChange={(e) => handleInputChange('guarantorAddress', e.target.value)}\n                        placeholder=\"Adres bilgisi\"\n                        disabled={mode === 'view'}\n                      />\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* Notes */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notlar</label>\n              <Textarea \n                name=\"notes\" \n                value={formData.notes}\n                onChange={(e) => handleInputChange('notes', e.target.value)}\n                placeholder=\"Senet ile ilgili notlar...\" \n                rows={3}\n                disabled={mode === 'view'}\n              />\n            </div>\n\n            {/* Summary */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <h4 className=\"font-medium text-gray-900 mb-2\">Özet</h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"font-medium\">Ana Para:</span> {formatCurrency(formData.amount || 0)}\n                </div>\n                {calculateInterest && (\n                  <div>\n                    <span className=\"font-medium\">Faiz Tutarı:</span> {formatCurrency(totalWithInterest - (formData.amount || 0))}\n                  </div>\n                )}\n                <div className=\"col-span-2 pt-2 border-t\">\n                  <span className=\"font-bold text-lg\">Toplam Ödenecek Tutar: {formatCurrency(totalWithInterest)}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {mode !== 'view' && (\n            <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n              >\n                İptal\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center\"\n                disabled={loading || isLoading}\n              >\n                {(loading || isLoading) && <Spinner className=\"w-4 h-4 mr-2\" />}\n                {(loading || isLoading) ? 'Kaydediliyor...' : mode === 'create' ? 'Senet Oluştur' : 'Değişiklikleri Kaydet'}\n              </Button>\n            </div>\n          )}\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default PromissoryNoteModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/ReportModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Select' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SelectContent' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SelectItem' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SelectTrigger' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SelectValue' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Card' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardContent' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardHeader' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardTitle' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Badge' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Report' is defined but never used.","line":21,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[703,706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[703,706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onReportCreate' is defined but never used.","line":42,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used.","line":43,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateForm' is assigned a value but never used.","line":100,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":100,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":179,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4266,4269],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4266,4269],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":277,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":309,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":345,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":351,"endColumn":26}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Button, \n  Input,\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Alert,\n  Spinner\n} from '@x-ear/ui-web';\nimport { X, FileText, Plus, AlertCircle, CheckCircle, Calendar, User } from 'lucide-react';\nimport { Patient } from '../../../types/patient';\n\ninterface Report {\n  id: string;\n  type: 'audiogram' | 'battery' | 'device' | 'sgk' | 'medical';\n  title: string;\n  createdAt: string;\n  createdBy: string;\n  updatedAt?: string;\n}\n\ninterface ReportModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  onReportCreate: (reportData: any) => void;\n  loading?: boolean;\n}\n\nexport const ReportModal: React.FC<ReportModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  onReportCreate,\n  loading = false\n}) => {\n  const [formData, setFormData] = useState({\n    type: 'audiogram' as 'audiogram' | 'battery' | 'device' | 'sgk' | 'medical',\n    title: ''\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (isOpen) {\n      setFormData({\n        type: 'audiogram',\n        title: ''\n      });\n      setErrors({});\n    }\n  }, [isOpen]);\n\n  if (!isOpen) return null;\n\n  const reportTypes = [\n    { \n      value: 'audiogram', \n      label: 'Odyogram', \n      icon: '📊',\n      description: 'İşitme testi sonuçları ve odyometri raporları'\n    },\n    { \n      value: 'battery', \n      label: 'Pil Raporu', \n      icon: '🔋',\n      description: 'Cihaz pil durumu ve değişim kayıtları'\n    },\n    { \n      value: 'device', \n      label: 'Cihaz Raporu', \n      icon: '🦻',\n      description: 'Cihaz ayarları, kalibrasyonu ve performans raporları'\n    },\n    { \n      value: 'sgk', \n      label: 'SGK Raporu', \n      icon: '🏥',\n      description: 'SGK başvuru ve onay belgeleri'\n    },\n    { \n      value: 'medical', \n      label: 'Tıbbi Rapor', \n      icon: '⚕️',\n      description: 'Doktor raporları ve tıbbi değerlendirmeler'\n    }\n  ];\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.title.trim()) {\n      newErrors.title = 'Rapor başlığı gereklidir';\n    } else if (formData.title.length < 3) {\n      newErrors.title = 'Rapor başlığı en az 3 karakter olmalıdır';\n    } else if (formData.title.length > 100) {\n      newErrors.title = 'Rapor başlığı 100 karakterden uzun olamaz';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    setError(null);\n    setSuccess(null);\n    \n    // Validation\n    if (!formData.type) {\n      setError('Lütfen rapor türünü seçiniz');\n      return;\n    }\n    \n    if (!formData.title.trim()) {\n      setError('Lütfen rapor başlığını giriniz');\n      return;\n    }\n    \n    if (formData.title.trim().length < 3) {\n      setError('Rapor başlığı en az 3 karakter olmalıdır');\n      return;\n    }\n    \n    if (formData.title.trim().length > 100) {\n      setError('Rapor başlığı 100 karakterden uzun olamaz');\n      return;\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      const newReport = {\n        id: Date.now().toString(),\n        patientId: patient?.id,\n        type: formData.type,\n        title: formData.title.trim(),\n        createdAt: new Date().toISOString(),\n        status: 'draft'\n      };\n      \n      console.log('Report created:', newReport);\n      \n      setSuccess('Rapor başarıyla oluşturuldu');\n      \n      // Close modal after successful creation\n      setTimeout(() => {\n        setError(null);\n        setSuccess(null);\n        setFormData({\n          type: 'audiogram',\n          title: ''\n        });\n        onClose();\n      }, 2000);\n      \n    } catch (err) {\n      setError('Rapor oluşturulurken bir hata oluştu. Lütfen tekrar deneyiniz.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleInputChange = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    \n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  const getTypeInfo = (type: string) => {\n    return reportTypes.find(t => t.value === type) || reportTypes[0];\n  };\n\n  const generateSuggestedTitle = (type: string) => {\n    const today = new Date().toLocaleDateString('tr-TR');\n    const typeInfo = getTypeInfo(type);\n    \n    switch (type) {\n      case 'audiogram':\n        return `Odyogram Raporu - ${today}`;\n      case 'battery':\n        return `Pil Değişim Raporu - ${today}`;\n      case 'device':\n        return `Cihaz Kontrol Raporu - ${today}`;\n      case 'sgk':\n        return `SGK Başvuru Raporu - ${today}`;\n      case 'medical':\n        return `Tıbbi Değerlendirme - ${today}`;\n      default:\n        return `${typeInfo.label} - ${today}`;\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <Plus className=\"w-5 h-5 mr-2\" />\n            Yeni Rapor Oluştur\n          </h3>\n          <Button\n            onClick={onClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Success Alert */}\n        {success && (\n          <Alert className=\"mb-4 border-green-200 bg-green-50\">\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n            <div className=\"text-green-800\">{success}</div>\n          </Alert>\n        )}\n\n        {/* Error Alert */}\n        {error && (\n          <Alert className=\"mb-4 border-red-200 bg-red-50\">\n            <AlertCircle className=\"h-4 w-4 text-red-600\" />\n            <div className=\"text-red-800\">{error}</div>\n          </Alert>\n        )}\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"space-y-6\">\n            {/* Patient Info */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <h4 className=\"font-medium text-gray-900 mb-2 flex items-center\">\n                <User className=\"w-4 h-4 mr-2\" />\n                Hasta Bilgileri\n              </h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"font-medium\">Ad Soyad:</span> {patient.firstName || ''} {patient.lastName || ''}\n                </div>\n                <div>\n                  <span className=\"font-medium\">TC No:</span> {patient.tcNumber || 'Belirtilmemiş'}\n                </div>\n                <div>\n                  <span className=\"font-medium\">Telefon:</span> {patient.phone || 'Belirtilmemiş'}\n                </div>\n                <div>\n                  <span className=\"font-medium\">E-posta:</span> {patient.email || 'Belirtilmemiş'}\n                </div>\n              </div>\n            </div>\n\n            {/* Report Type Selection */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <FileText className=\"w-4 h-4 mr-2\" />\n                Rapor Türü\n              </h4>\n              \n              <div className=\"grid grid-cols-1 gap-3\">\n                {reportTypes.map((type) => (\n                  <button\n                    key={type.value}\n                    type=\"button\"\n                    onClick={() => handleInputChange('type', type.value)}\n                    className={`p-4 border rounded-lg text-left transition-colors ${\n                      formData.type === type.value\n                        ? 'border-blue-500 bg-blue-50'\n                        : 'border-gray-300 hover:border-gray-400'\n                    }`}\n                  >\n                    <div className=\"flex items-start space-x-3\">\n                      <div className=\"text-2xl\">{type.icon}</div>\n                      <div className=\"flex-1\">\n                        <div className={`font-medium ${\n                          formData.type === type.value ? 'text-blue-700' : 'text-gray-900'\n                        }`}>\n                          {type.label}\n                        </div>\n                        <div className={`text-sm mt-1 ${\n                          formData.type === type.value ? 'text-blue-600' : 'text-gray-600'\n                        }`}>\n                          {type.description}\n                        </div>\n                      </div>\n                      {formData.type === type.value && (\n                        <div className=\"text-blue-500\">\n                          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                          </svg>\n                        </div>\n                      )}\n                    </div>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Report Title */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                Rapor Detayları\n              </h4>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Rapor Başlığı *\n                </label>\n                <Input\n                  value={formData.title}\n                  onChange={(e) => handleInputChange('title', e.target.value)}\n                  placeholder=\"Rapor başlığını giriniz...\"\n                  className={errors.title ? 'border-red-500' : ''}\n                />\n                {errors.title && (\n                  <div className=\"flex items-center mt-1 text-sm text-red-600\">\n                    <AlertCircle className=\"w-4 h-4 mr-1\" />\n                    {errors.title}\n                  </div>\n                )}\n                <div className=\"text-xs text-gray-500 mt-1\">\n                  {formData.title.length}/100 karakter\n                </div>\n              </div>\n\n              {/* Suggested Title */}\n              <div className=\"bg-blue-50 p-3 rounded-lg\">\n                <div className=\"text-sm font-medium text-blue-900 mb-2\">Önerilen Başlık:</div>\n                <button\n                  type=\"button\"\n                  onClick={() => handleInputChange('title', generateSuggestedTitle(formData.type))}\n                  className=\"text-sm text-blue-700 hover:text-blue-800 underline\"\n                >\n                  {generateSuggestedTitle(formData.type)}\n                </button>\n              </div>\n            </div>\n\n            {/* Report Type Info */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <h5 className=\"font-medium text-gray-900 mb-2\">\n                {getTypeInfo(formData.type).label} Hakkında\n              </h5>\n              <p className=\"text-sm text-gray-600 mb-3\">\n                {getTypeInfo(formData.type).description}\n              </p>\n              \n              {/* Type-specific information */}\n              {formData.type === 'audiogram' && (\n                <div className=\"text-sm text-gray-600\">\n                  <strong>İçerebilir:</strong> Saf ses odyometrisi, konuşma odyometrisi, timpanometri sonuçları\n                </div>\n              )}\n              {formData.type === 'battery' && (\n                <div className=\"text-sm text-gray-600\">\n                  <strong>İçerebilir:</strong> Pil ömrü, değişim tarihleri, pil türü bilgileri\n                </div>\n              )}\n              {formData.type === 'device' && (\n                <div className=\"text-sm text-gray-600\">\n                  <strong>İçerebilir:</strong> Cihaz ayarları, frekans yanıtı, kazanç değerleri\n                </div>\n              )}\n              {formData.type === 'sgk' && (\n                <div className=\"text-sm text-gray-600\">\n                  <strong>İçerebilir:</strong> Başvuru formu, onay belgesi, ödeme bilgileri\n                </div>\n              )}\n              {formData.type === 'medical' && (\n                <div className=\"text-sm text-gray-600\">\n                  <strong>İçerebilir:</strong> Doktor değerlendirmesi, tanı, tedavi önerileri\n                </div>\n              )}\n            </div>\n\n            {/* Creation Info */}\n            <div className=\"bg-green-50 p-4 rounded-lg\">\n              <h5 className=\"font-medium text-gray-900 mb-2\">Oluşturulacak Rapor</h5>\n              <div className=\"text-sm text-gray-600 space-y-1\">\n                <div>\n                  <span className=\"font-medium\">Tür:</span> {getTypeInfo(formData.type).label}\n                </div>\n                <div>\n                  <span className=\"font-medium\">Oluşturulma Tarihi:</span> {new Date().toLocaleString('tr-TR')}\n                </div>\n                <div>\n                  <span className=\"font-medium\">Hasta:</span> {patient.firstName || ''} {patient.lastName || ''}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n            <Button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n              disabled={isLoading}\n            >\n              İptal\n            </Button>\n            <Button\n              type=\"submit\"\n              className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center\"\n              disabled={isLoading || !formData.type || !formData.title.trim()}\n            >\n              {isLoading ? (\n                <>\n                  <Spinner className=\"w-4 h-4 mr-2\" />\n                  Oluşturuluyor...\n                </>\n              ) : (\n                <>\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Rapor Oluştur\n                </>\n              )}\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default ReportModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/ReturnExchangeModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'APISale' is defined but never used.","line":24,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":53},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":251,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":251,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6657,6660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6657,6660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":344,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":351,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":358,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":365,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":381,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":393,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":471,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":477,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":489,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":497,"endColumn":34}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Button, \n  Textarea, \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Alert,\n  Input\n} from '@x-ear/ui-web';\nimport { \n  X, \n  AlertCircle, \n  CheckCircle,\n  RefreshCw,\n  ArrowLeftRight,\n  Package,\n  FileText,\n  Send,\n  Eye\n} from 'lucide-react';\nimport { Patient } from '../../../types/patient';\nimport { getXEarCRMAPIAutoGenerated, Sale as APISale, SalesUpdateSaleBody } from '../../../api/generated/api';\n\ninterface ReturnInvoice {\n  id: string;\n  invoiceNumber: string;\n  amount: number;\n  status: 'draft' | 'sent' | 'gib_sent' | 'completed';\n  gibSent?: boolean;\n  gibSentDate?: string;\n  gibErrorMessage?: string;\n  createdAt: string;\n}\n\ninterface Sale {\n  id: string;\n  productName: string;\n  brand: string;\n  model: string;\n  serialNumber?: string;\n  salePrice: number;\n  saleDate: string;\n  paymentMethod: string;\n  status: string;\n  productId?: string;\n  totalAmount?: number;\n  notes?: string;\n}\n\ninterface ReturnExchangeData {\n  saleId: string;\n  type: 'return' | 'exchange';\n  reason: string;\n  notes: string;\n  refundAmount?: number;\n  newProductId?: string;\n  newProductName?: string;\n  priceDifference?: number;\n  createReturnInvoice?: boolean;\n  invoiceType?: 'individual' | 'corporate' | 'e_archive';\n}\n\ninterface ReturnExchangeModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  sale: Sale;\n  onReturnExchangeCreate: (data: ReturnExchangeData) => void;\n}\n\nexport const ReturnExchangeModal: React.FC<ReturnExchangeModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  sale,\n  onReturnExchangeCreate\n}) => {\n  const [type, setType] = useState<'return' | 'exchange'>('return');\n  const [reason, setReason] = useState('');\n  const [notes, setNotes] = useState('');\n  const [refundAmount, setRefundAmount] = useState('');\n  const [newProductName, setNewProductName] = useState('');\n  const [priceDifference, setPriceDifference] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState(false);\n  \n  // GIB Integration states\n  const [createReturnInvoice, setCreateReturnInvoice] = useState(false);\n  const [invoiceType, setInvoiceType] = useState<'individual' | 'corporate' | 'e_archive'>('individual');\n  const [returnInvoice, setReturnInvoice] = useState<ReturnInvoice | null>(null);\n  const [gibLoading, setGibLoading] = useState(false);\n  const [gibError, setGibError] = useState('');\n\n  const returnReasons = [\n    'Ürün arızalı',\n    'Yanlış ürün gönderildi',\n    'Müşteri memnun kalmadı',\n    'Ürün hasarlı geldi',\n    'Boyut/uyum sorunu',\n    'Müşteri fikir değiştirdi',\n    'Garanti kapsamında değişim',\n    'Diğer'\n  ];\n\n  useEffect(() => {\n    if (isOpen) {\n      // Reset form when modal opens\n      setType('return');\n      setReason('');\n      setNotes('');\n      setRefundAmount('');\n      setNewProductName('');\n      setPriceDifference('');\n      setError('');\n      setSuccess(false);\n    }\n  }, [isOpen]);\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const validateForm = () => {\n    if (!reason) {\n      setError('Lütfen iade/değişim nedenini seçiniz.');\n      return false;\n    }\n\n    if (type === 'return') {\n      if (!refundAmount || parseFloat(refundAmount) <= 0) {\n        setError('Lütfen geçerli bir iade tutarı giriniz.');\n        return false;\n      }\n      if (parseFloat(refundAmount) > (sale.totalAmount || 0)) {\n        setError('İade tutarı satış tutarından fazla olamaz.');\n        return false;\n      }\n    }\n\n    if (type === 'exchange') {\n      if (!newProductName.trim()) {\n        setError('Lütfen yeni ürün adını giriniz.');\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  const createReturnInvoiceForReturn = async (data: ReturnExchangeData) => {\n    setGibLoading(true);\n    setGibError('');\n    \n    try {\n      // Mock return invoice creation - replace with actual API call\n      const mockInvoice: ReturnInvoice = {\n        id: `RI-${Date.now()}`,\n        invoiceNumber: `İADE-${Date.now()}`,\n        amount: data.refundAmount || 0,\n        status: 'draft',\n        createdAt: new Date().toISOString()\n      };\n      \n      setReturnInvoice(mockInvoice);\n      \n      // Simulate GIB sending process\n      setTimeout(async () => {\n        try {\n          // Mock GIB integration\n          setReturnInvoice(prev => prev ? {\n            ...prev,\n            status: 'gib_sent',\n            gibSent: true,\n            gibSentDate: new Date().toISOString()\n          } : null);\n        } catch (error) {\n          setGibError('GIB gönderimi sırasında hata oluştu');\n          setReturnInvoice(prev => prev ? {\n            ...prev,\n            gibErrorMessage: 'GIB gönderimi başarısız'\n          } : null);\n        }\n      }, 2000);\n      \n    } catch (error) {\n      setGibError('İade faturası oluşturulurken hata oluştu');\n    } finally {\n      setGibLoading(false);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsLoading(true);\n    setError('');\n\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      \n      // Create return/exchange data\n      const returnExchangeData: ReturnExchangeData = {\n        saleId: sale.id || '',\n        type,\n        reason,\n        notes,\n        ...(type === 'return' && { refundAmount: parseFloat(refundAmount) }),\n        ...(type === 'exchange' && { \n          newProductName,\n          priceDifference: priceDifference ? parseFloat(priceDifference) : 0\n        }),\n        createReturnInvoice,\n        invoiceType: createReturnInvoice ? invoiceType : undefined\n      };\n\n      // Update sale status based on return/exchange type\n      const updateData: SalesUpdateSaleBody = {\n        status: type === 'return' ? 'RETURNED' : 'EXCHANGED',\n        notes: `${type === 'return' ? 'İade' : 'Değişim'} - Neden: ${reason}${notes ? ` - Notlar: ${notes}` : ''}`\n      };\n\n      await api.salesUpdateSale(sale.id || '', updateData);\n      \n      // Create return invoice if requested\n      if (createReturnInvoice && type === 'return') {\n        await createReturnInvoiceForReturn(returnExchangeData);\n      }\n      \n      setSuccess(true);\n      onReturnExchangeCreate(returnExchangeData);\n      \n      // Close modal after 2 seconds\n      setTimeout(() => {\n        onClose();\n      }, 2000);\n\n    } catch (err: any) {\n      console.error('Return/Exchange error:', err);\n      setError(err.response?.data?.error || 'İade/değişim işlemi sırasında bir hata oluştu.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <form onSubmit={handleSubmit}>\n          <div className=\"p-6 space-y-6\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between border-b pb-4\">\n              <div>\n                <h2 className=\"text-2xl font-bold text-gray-900\">İade/Değişim İşlemi</h2>\n                <p className=\"text-gray-600 mt-1\">\n                  {patient.firstName} {patient.lastName} - Satış #{sale.id}\n                </p>\n              </div>\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n              >\n                <X className=\"w-6 h-6 text-gray-600\" />\n              </Button>\n            </div>\n\n            {/* Success Message */}\n            {success && (\n              <Alert variant=\"success\">\n                <CheckCircle className=\"h-4 w-4\" />\n                <span>\n                  {type === 'return' ? 'İade işlemi' : 'Değişim işlemi'} başarıyla tamamlandı!\n                </span>\n              </Alert>\n            )}\n\n            {/* Sale Information */}\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-lg flex items-center\">\n                  <Package className=\"w-5 h-5 mr-2 text-gray-600\" />\n                  Satış Bilgileri\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium text-gray-600\">Ürün ID:</span>\n                    <span className=\"text-gray-900\">{sale.productId}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium text-gray-600\">Satış Fiyatı:</span>\n                    <span className=\"text-gray-900 font-bold\">{formatCurrency(sale.totalAmount || 0)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium text-gray-600\">Satış Tarihi:</span>\n                    <span className=\"text-gray-900\">{formatDate(sale.saleDate || '')}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium text-gray-600\">Ödeme Yöntemi:</span>\n                    <span className=\"text-gray-900\">{sale.paymentMethod}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"font-medium text-gray-600\">Durum:</span>\n                    <span className=\"text-gray-900\">{sale.status}</span>\n                  </div>\n                  {sale.notes && (\n                    <div className=\"col-span-2\">\n                      <span className=\"font-medium text-gray-600\">Notlar:</span>\n                      <p className=\"text-gray-900 mt-1\">{sale.notes}</p>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Return/Exchange Type Selection */}\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-lg flex items-center\">\n                  <ArrowLeftRight className=\"w-5 h-5 mr-2 text-gray-600\" />\n                  İşlem Türü\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <label className=\"flex items-center space-x-3 p-4 border rounded-lg cursor-pointer hover:bg-gray-50\">\n                    <input\n                      type=\"radio\"\n                      name=\"type\"\n                      value=\"return\"\n                      checked={type === 'return'}\n                      onChange={(e) => setType(e.target.value as 'return' | 'exchange')}\n                      className=\"text-red-600 focus:ring-red-500\"\n                    />\n                    <div>\n                      <div className=\"font-medium text-gray-900\">İade</div>\n                      <div className=\"text-sm text-gray-600\">Ürünü iade et ve para iadesi yap</div>\n                    </div>\n                  </label>\n                  <label className=\"flex items-center space-x-3 p-4 border rounded-lg cursor-pointer hover:bg-gray-50\">\n                    <input\n                      type=\"radio\"\n                      name=\"type\"\n                      value=\"exchange\"\n                      checked={type === 'exchange'}\n                      onChange={(e) => setType(e.target.value as 'return' | 'exchange')}\n                      className=\"text-blue-600 focus:ring-blue-500\"\n                    />\n                    <div>\n                      <div className=\"font-medium text-gray-900\">Değişim</div>\n                      <div className=\"text-sm text-gray-600\">Ürünü başka bir ürünle değiştir</div>\n                    </div>\n                  </label>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Reason Selection */}\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-lg\">İade/Değişim Nedeni</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <select\n                  value={reason}\n                  onChange={(e) => setReason(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                  required\n                >\n                  <option value=\"\">Neden seçiniz</option>\n                  {returnReasons.map((reasonOption) => (\n                    <option key={reasonOption} value={reasonOption}>\n                      {reasonOption}\n                    </option>\n                  ))}\n                </select>\n              </CardContent>\n            </Card>\n\n            {/* Return Amount (for returns) */}\n            {type === 'return' && (\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-lg\">İade Tutarı</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <Input\n                    type=\"number\"\n                    step=\"0.01\"\n                    min=\"0\"\n                    max={sale.totalAmount || 0}\n                    placeholder=\"İade tutarı\"\n                    value={refundAmount}\n                    onChange={(e) => setRefundAmount(e.target.value)}\n                    className=\"w-full\"\n                  />\n                  <p className=\"text-sm text-gray-600 mt-2\">\n                    Maksimum iade tutarı: {formatCurrency(sale.totalAmount || 0)}\n                  </p>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Exchange Details (for exchanges) */}\n            {type === 'exchange' && (\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-lg\">Değişim Detayları</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Yeni Ürün Adı\n                    </label>\n                    <Input\n                      type=\"text\"\n                      placeholder=\"Değişim yapılacak ürün adı\"\n                      value={newProductName}\n                      onChange={(e) => setNewProductName(e.target.value)}\n                      className=\"w-full\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      Fiyat Farkı\n                    </label>\n                    <Input\n                      type=\"number\"\n                      step=\"0.01\"\n                      placeholder=\"Fiyat farkı (+ ek ödeme, - iade)\"\n                      value={priceDifference}\n                      onChange={(e) => setPriceDifference(e.target.value)}\n                      className=\"w-full\"\n                    />\n                    <p className=\"text-sm text-gray-600 mt-2\">\n                      Pozitif değer ek ödeme, negatif değer iade anlamına gelir\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Return Invoice Section (for returns only) */}\n            {type === 'return' && (\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-lg flex items-center\">\n                    <FileText className=\"w-5 h-5 mr-2 text-gray-600\" />\n                    İade Faturası\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex items-center space-x-3\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"createReturnInvoice\"\n                      checked={createReturnInvoice}\n                      onChange={(e) => setCreateReturnInvoice(e.target.checked)}\n                      className=\"text-blue-600 focus:ring-blue-500\"\n                    />\n                    <label htmlFor=\"createReturnInvoice\" className=\"text-sm font-medium text-gray-700\">\n                      İade faturası oluştur ve GİB'e gönder\n                    </label>\n                  </div>\n\n                  {createReturnInvoice && (\n                    <div className=\"space-y-3 pl-6 border-l-2 border-blue-200\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Fatura Türü\n                        </label>\n                        <select\n                          value={invoiceType}\n                          onChange={(e) => setInvoiceType(e.target.value as 'individual' | 'corporate' | 'e_archive')}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                        >\n                          <option value=\"individual\">Bireysel Fatura</option>\n                          <option value=\"corporate\">Kurumsal Fatura</option>\n                          <option value=\"e_archive\">E-Arşiv Fatura</option>\n                        </select>\n                      </div>\n\n                      {returnInvoice && (\n                        <div className=\"bg-blue-50 p-3 rounded-lg border border-blue-200\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <span className=\"text-sm font-medium text-blue-900\">\n                              İade Faturası: {returnInvoice.invoiceNumber}\n                            </span>\n                            <span className={`text-xs px-2 py-1 rounded-full ${\n                              returnInvoice.status === 'gib_sent' \n                                ? 'bg-green-100 text-green-800' \n                                : 'bg-yellow-100 text-yellow-800'\n                            }`}>\n                              {returnInvoice.status === 'gib_sent' ? 'GİB\\'e Gönderildi' : 'Hazırlanıyor'}\n                            </span>\n                          </div>\n                          \n                          {returnInvoice.gibSent && returnInvoice.gibSentDate && (\n                            <p className=\"text-xs text-green-700 flex items-center\">\n                              <CheckCircle className=\"w-3 h-3 mr-1\" />\n                              GİB'e gönderildi: {new Date(returnInvoice.gibSentDate).toLocaleString('tr-TR')}\n                            </p>\n                          )}\n                          \n                          {gibError && (\n                            <p className=\"text-xs text-red-600 flex items-center mt-1\">\n                              <AlertCircle className=\"w-3 h-3 mr-1\" />\n                              {gibError}\n                            </p>\n                          )}\n                          \n                          <div className=\"flex space-x-2 mt-2\">\n                            <Button\n                              type=\"button\"\n                              size=\"sm\"\n                              variant=\"outline\"\n                              className=\"text-xs\"\n                              onClick={() => {/* Preview invoice */}}\n                            >\n                              <Eye className=\"w-3 h-3 mr-1\" />\n                              Önizle\n                            </Button>\n                            \n                            {!returnInvoice.gibSent && (\n                              <Button\n                                type=\"button\"\n                                size=\"sm\"\n                                className=\"text-xs bg-green-600 hover:bg-green-700\"\n                                disabled={gibLoading}\n                                onClick={() => {/* Send to GIB */}}\n                              >\n                                {gibLoading ? (\n                                  <RefreshCw className=\"w-3 h-3 mr-1 animate-spin\" />\n                                ) : (\n                                  <Send className=\"w-3 h-3 mr-1\" />\n                                )}\n                                GİB'e Gönder\n                              </Button>\n                            )}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Notes */}\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-lg\">Notlar</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <Textarea\n                  rows={4}\n                  placeholder=\"İade/değişim ile ilgili notlarınızı buraya yazabilirsiniz...\"\n                  value={notes}\n                  onChange={(e) => setNotes(e.target.value)}\n                  className=\"resize-none\"\n                />\n              </CardContent>\n            </Card>\n\n            {/* Error Message */}\n            {error && (\n              <Alert variant=\"error\">\n                <AlertCircle className=\"h-4 w-4\" />\n                <span>{error}</span>\n              </Alert>\n            )}\n\n            {/* Form Actions */}\n            <div className=\"flex justify-end space-x-4 pt-6 border-t bg-gray-50 -mx-6 -mb-6 px-6 py-4\">\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-6 py-2 border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 rounded-lg transition-colors\"\n              >\n                İptal\n              </Button>\n              <Button\n                type=\"submit\"\n                disabled={isLoading}\n                className=\"px-6 py-2 bg-orange-600 text-white hover:bg-orange-700 rounded-lg transition-colors disabled:opacity-50 flex items-center space-x-2\"\n              >\n                {isLoading && <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />}\n                <span>{type === 'return' ? 'İade İşlemini Tamamla' : 'Değişim İşlemini Tamamla'}</span>\n              </Button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default ReturnExchangeModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/SaleModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3030,3033],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3030,3033],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":226,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":226,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7403,7406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7403,7406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":386,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":391,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":405,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":411,"endColumn":25},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":423,"column":27,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":432,"endColumn":36},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":439,"column":27,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":447,"endColumn":36}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { \n  Button, \n  Textarea, \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Alert,\n  Spinner\n} from '@x-ear/ui-web';\nimport { \n  X, \n  AlertCircle, \n  CheckCircle,\n  ShoppingCart,\n  FileText,\n  Calendar,\n  Settings\n} from 'lucide-react';\nimport { Patient } from '../../../types/patient';\nimport { Sale as APISale, SalesCreateSaleBody, InventoryItem } from '../../../api/generated/api';\nimport { \n  getXEarCRMAPIAutoGenerated\n} from '../../../api/generated/api';\nimport ProductSearchComponent from './components/ProductSearchComponent';\nimport PricingPreviewComponent from './components/PricingPreviewComponent';\nimport PaymentOptionsComponent from './components/PaymentOptionsComponent';\n\ninterface PricingDetails {\n  basePrice: number;\n  discountAmount: number;\n  discountPercent: number;\n  vatAmount: number;\n  sgkDiscount: number;\n  totalAmount: number;\n  installmentAmount?: number;\n}\n\ninterface SaleModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  onSaleCreate: (sale: APISale) => void;\n}\n\nexport const SaleModal: React.FC<SaleModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  onSaleCreate\n}) => {\n  // Product search state\n  const [searchTerm, setSearchTerm] = useState('');\n  const [searchResults, setSearchResults] = useState<InventoryItem[]>([]);\n  const [selectedProduct, setSelectedProduct] = useState<InventoryItem | null>(null);\n  const [isSearching, setIsSearching] = useState(false);\n  const [showResults, setShowResults] = useState(false);\n  \n  // Pricing state\n  const [customPrice, setCustomPrice] = useState('');\n  const [discountPercent, setDiscountPercent] = useState('');\n  const [sgkEnabled, setSgkEnabled] = useState(false);\n  const [sgkDiscount, setSgkDiscount] = useState('');\n  const [sgkCode, setSgkCode] = useState('');\n  \n  // Payment state\n  const [paymentMethod, setPaymentMethod] = useState('cash');\n  const [installmentCount, setInstallmentCount] = useState('');\n  const [downPayment, setDownPayment] = useState('');\n  const [interestRate, setInterestRate] = useState('');\n  \n  // Sale details state\n  const [saleDate, setSaleDate] = useState(new Date().toISOString().split('T')[0]);\n  const [deviceAssignment, setDeviceAssignment] = useState({\n    enabled: false,\n    assignmentReason: 'sale',\n    earSide: 'both' as 'left' | 'right' | 'both'\n  });\n  \n  // Form state\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Debounced product search using real API\n  const debouncedSearch = useCallback(\n    async (term: string) => {\n      if (term.length < 2) {\n        setSearchResults([]);\n        setShowResults(false);\n        return;\n      }\n\n      setIsSearching(true);\n      try {\n        // Search in inventory items\n        const api = getXEarCRMAPIAutoGenerated();\n        const inventoryResponse = await api.inventoryGetInventoryItems();\n        const inventoryItems = (inventoryResponse as any)?.data || [];\n        \n        // Filter results based on search term\n        const filtered = inventoryItems.filter(item =>\n          item.name?.toLowerCase().includes(term.toLowerCase()) ||\n          item.brand?.toLowerCase().includes(term.toLowerCase()) ||\n          item.model?.toLowerCase().includes(term.toLowerCase()) ||\n          item.barcode?.includes(term)\n        );\n        \n        setSearchResults(filtered);\n        setShowResults(true);\n      } catch (error) {\n        console.error('Product search failed:', error);\n        setSearchResults([]);\n      } finally {\n        setIsSearching(false);\n      }\n    },\n    []\n  );\n\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      debouncedSearch(searchTerm);\n    }, 300);\n\n    return () => clearTimeout(timeoutId);\n  }, [searchTerm, debouncedSearch]);\n\n  // Calculate pricing with API integration\n  const pricingDetails = useMemo((): PricingDetails => {\n    const basePrice = parseFloat(customPrice) || selectedProduct?.price || 0;\n    const discountAmount = (basePrice * (parseFloat(discountPercent) || 0)) / 100;\n    const sgkDiscountAmount = sgkEnabled ? (basePrice * (parseFloat(sgkDiscount) || 0)) / 100 : 0;\n    const priceAfterDiscounts = basePrice - discountAmount - sgkDiscountAmount;\n    const vatAmount = (priceAfterDiscounts * 18) / 100; // Standard VAT rate\n    const totalAmount = priceAfterDiscounts + vatAmount;\n    \n    const installmentAmount = paymentMethod === 'installment' && installmentCount\n      ? (totalAmount - (parseFloat(downPayment) || 0)) / parseInt(installmentCount)\n      : 0;\n\n    return {\n      basePrice,\n      discountAmount,\n      discountPercent: parseFloat(discountPercent) || 0,\n      vatAmount,\n      sgkDiscount: sgkDiscountAmount,\n      totalAmount,\n      installmentAmount\n    };\n  }, [customPrice, selectedProduct, discountPercent, sgkEnabled, sgkDiscount, paymentMethod, installmentCount, downPayment]);\n\n  // Enhanced validation\n  const validateForm = () => {\n    const errors: string[] = [];\n    \n    if (!selectedProduct && !customPrice) {\n      errors.push('Ürün seçimi veya özel fiyat girişi zorunludur');\n    }\n    \n    if (customPrice && parseFloat(customPrice) <= 0) {\n      errors.push('Geçerli bir fiyat giriniz');\n    }\n    \n    if (discountPercent && (parseFloat(discountPercent) < 0 || parseFloat(discountPercent) > 100)) {\n      errors.push('İndirim oranı 0 ile 100 arasında olmalıdır');\n    }\n    \n    if (sgkEnabled && !sgkCode.trim()) {\n      errors.push('SGK kodu gereklidir');\n    }\n    \n    if (paymentMethod === 'installment') {\n      if (!installmentCount || parseInt(installmentCount) < 2) {\n        errors.push('Taksit sayısı en az 2 olmalıdır');\n      }\n      if (downPayment && parseFloat(downPayment) < 0) {\n        errors.push('Peşinat tutarı negatif olamaz');\n      }\n      if (downPayment && parseFloat(downPayment) >= pricingDetails.totalAmount) {\n        errors.push('Peşinat tutarı toplam tutardan küçük olmalıdır');\n      }\n    }\n    \n    if (!saleDate) {\n      errors.push('Satış tarihi seçiniz');\n    }\n    \n    return errors;\n  };\n\n  // Handle form submission with real API\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    const validationErrors = validateForm();\n    if (validationErrors.length > 0) {\n      setErrors({ submit: validationErrors.join(', ') });\n      return;\n    }\n\n    setIsSubmitting(true);\n    setErrors({});\n\n    try {\n      const notesValue = (document.querySelector('textarea[name=\"notes\"]') as HTMLTextAreaElement)?.value || '';\n      \n      // Prepare sale data according to API schema\n      const saleData: SalesCreateSaleBody = {\n        patientId: patient.id || '',\n        productId: selectedProduct?.id,\n        saleDate: saleDate,\n        totalAmount: pricingDetails.totalAmount,\n        listPriceTotal: selectedProduct?.price || parseFloat(customPrice) || 0,\n        discountAmount: pricingDetails.discountAmount,\n        sgkCoverage: pricingDetails.sgkDiscount,\n        patientPayment: pricingDetails.totalAmount - pricingDetails.sgkDiscount,\n        paymentMethod: paymentMethod,\n        status: 'draft',\n        notes: notesValue\n      };\n\n      // Create sale using generated API client\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.salesCreateSale(saleData);\n      const createdSale = (response as any)?.data;\n      \n      // Call parent callback with created sale\n      onSaleCreate(createdSale);\n      \n      // Reset form\n      resetForm();\n      onClose();\n    } catch (error) {\n      console.error('Sale creation failed:', error);\n      setErrors({ submit: 'Satış kaydedilirken bir hata oluştu.' });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const resetForm = () => {\n    setSearchTerm('');\n    setSelectedProduct(null);\n    setCustomPrice('');\n    setDiscountPercent('');\n    setSgkEnabled(false);\n    setSgkDiscount('');\n    setSgkCode('');\n    setPaymentMethod('cash');\n    setInstallmentCount('');\n    setDownPayment('');\n    setSaleDate(new Date().toISOString().split('T')[0]);\n    setDeviceAssignment({ enabled: false, assignmentReason: 'sale', earSide: 'both' });\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg w-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center p-6 border-b bg-gradient-to-r from-blue-50 to-indigo-50\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-blue-100 rounded-lg\">\n              <ShoppingCart className=\"w-6 h-6 text-blue-600\" />\n            </div>\n            <div>\n              <h3 className=\"text-xl font-semibold text-gray-900\">Yeni Satış</h3>\n              <p className=\"text-sm text-gray-600\">\n                {patient.firstName} {patient.lastName} için satış oluştur\n              </p>\n            </div>\n          </div>\n          <Button\n            onClick={onClose}\n            className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto\">\n          <form onSubmit={handleSubmit} className=\"p-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              \n              {/* Left Column - Product Selection & Details */}\n              <div className=\"lg:col-span-2 space-y-6\">\n                \n                {/* Customer Info Card */}\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg flex items-center\">\n                      <FileText className=\"w-5 h-5 mr-2 text-blue-600\" />\n                      Müşteri Bilgileri\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"font-medium text-gray-600\">Ad Soyad:</span>\n                        <span className=\"text-gray-900\">{patient.firstName} {patient.lastName}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"font-medium text-gray-600\">TC No:</span>\n                        <span className=\"text-gray-900\">{patient.tcNumber}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"font-medium text-gray-600\">Telefon:</span>\n                        <span className=\"text-gray-900\">{patient.phone}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"font-medium text-gray-600\">E-posta:</span>\n                        <span className=\"text-gray-900\">{patient.email}</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Product Search Component */}\n                <ProductSearchComponent\n                  searchTerm={searchTerm}\n                  onSearchChange={setSearchTerm}\n                  searchResults={searchResults.map(item => ({\n                    id: item.id || '',\n                    name: item.name,\n                    brand: item.brand,\n                    model: item.model || '',\n                    category: item.category,\n                    listPrice: item.price,\n                    salePrice: item.price,\n                    vatRate: 18,\n                    stock: 1,\n                    sgkSupported: false\n                  }))}\n                  selectedProduct={selectedProduct ? {\n                    id: selectedProduct.id || '',\n                    name: selectedProduct.name,\n                    brand: selectedProduct.brand,\n                    model: selectedProduct.model || '',\n                    category: selectedProduct.category,\n                    listPrice: selectedProduct.price,\n                    salePrice: selectedProduct.price,\n                    vatRate: 18,\n                    stock: 1,\n                    sgkSupported: false\n                  } : null}\n                  onProductSelect={(product) => {\n                    setSelectedProduct({\n                      ...product,\n                      price: product.salePrice\n                    });\n                  }}\n                  isSearching={isSearching}\n                  showResults={showResults}\n                />\n\n                {/* Notes Card */}\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg flex items-center\">\n                      <FileText className=\"w-5 h-5 mr-2 text-gray-600\" />\n                      Notlar\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <Textarea\n                      name=\"notes\"\n                      rows={4}\n                      placeholder=\"Satış ile ilgili notlarınızı buraya yazabilirsiniz...\"\n                      className=\"resize-none\"\n                    />\n                  </CardContent>\n                </Card>\n\n                {/* Sale Date Card */}\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg flex items-center\">\n                      <Calendar className=\"w-5 h-5 mr-2 text-gray-600\" />\n                      Satış Tarihi\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <input\n                      type=\"date\"\n                      value={saleDate}\n                      onChange={(e) => setSaleDate(e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </CardContent>\n                </Card>\n\n                {/* Device Assignment Card */}\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg flex items-center\">\n                      <Settings className=\"w-5 h-5 mr-2 text-gray-600\" />\n                      Cihaz Atama\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"flex items-center space-x-2\">\n                      <input\n                        type=\"checkbox\"\n                        id=\"deviceAssignment\"\n                        checked={deviceAssignment.enabled}\n                        onChange={(e) => setDeviceAssignment(prev => ({ ...prev, enabled: e.target.checked }))}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <label htmlFor=\"deviceAssignment\" className=\"text-sm font-medium text-gray-700\">\n                        Cihaz ataması yap\n                      </label>\n                    </div>\n                    \n                    {deviceAssignment.enabled && (\n                      <div className=\"space-y-3 pl-6\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                            Atama Nedeni\n                          </label>\n                          <select\n                            value={deviceAssignment.assignmentReason}\n                            onChange={(e) => setDeviceAssignment(prev => ({ ...prev, assignmentReason: e.target.value }))}\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          >\n                            <option value=\"sale\">Satış</option>\n                            <option value=\"trial\">Deneme</option>\n                            <option value=\"repair\">Tamir</option>\n                            <option value=\"replacement\">Değişim</option>\n                          </select>\n                        </div>\n                        \n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                            Kulak Tarafı\n                          </label>\n                          <select\n                            value={deviceAssignment.earSide}\n                            onChange={(e) => setDeviceAssignment(prev => ({ ...prev, earSide: e.target.value as 'left' | 'right' | 'both' }))}\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          >\n                            <option value=\"both\">Her İki Kulak</option>\n                            <option value=\"left\">Sol Kulak</option>\n                            <option value=\"right\">Sağ Kulak</option>\n                          </select>\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Right Column - Pricing & Payment */}\n              <div className=\"space-y-6\">\n                \n                {/* Pricing Preview Component */}\n                <PricingPreviewComponent\n                  pricingDetails={pricingDetails}\n                  customPrice={customPrice}\n                  onCustomPriceChange={setCustomPrice}\n                  discountPercent={discountPercent}\n                  onDiscountPercentChange={setDiscountPercent}\n                  sgkEnabled={sgkEnabled}\n                  onSgkToggle={setSgkEnabled}\n                  sgkDiscount={sgkDiscount}\n                  onSgkDiscountChange={setSgkDiscount}\n                  sgkCode={sgkCode}\n                  onSgkCodeChange={setSgkCode}\n                />\n\n                {/* Payment Options Component */}\n                <PaymentOptionsComponent\n                  paymentMethod={paymentMethod}\n                  onPaymentMethodChange={setPaymentMethod}\n                  installmentCount={installmentCount}\n                  onInstallmentCountChange={setInstallmentCount}\n                  downPayment={downPayment}\n                  onDownPaymentChange={setDownPayment}\n                  interestRate={interestRate}\n                  onInterestRateChange={setInterestRate}\n                  installmentAmount={pricingDetails.installmentAmount || 0}\n                  totalAmount={pricingDetails.totalAmount}\n                />\n              </div>\n            </div>\n\n            {/* Form Validation Errors */}\n            {errors.submit && (\n              <Alert variant=\"error\" className=\"mt-4\">\n                <AlertCircle className=\"h-4 w-4\" />\n                <span>{errors.submit}</span>\n              </Alert>\n            )}\n\n            {/* Form Actions */}\n            <div className=\"flex justify-end space-x-4 pt-6 border-t bg-gray-50 -mx-6 -mb-6 px-6 py-4\">\n              <Button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-6 py-2 border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 rounded-lg transition-colors\"\n              >\n                İptal\n              </Button>\n              <Button\n                type=\"submit\"\n                disabled={isSubmitting || (!selectedProduct && !customPrice)}\n                className=\"px-8 py-2 bg-blue-600 text-white hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg transition-colors flex items-center space-x-2\"\n              >\n                {isSubmitting ? (\n                  <>\n                    <Spinner className=\"w-4 h-4\" />\n                    <span>Kaydediliyor...</span>\n                  </>\n                ) : (\n                  <>\n                    <CheckCircle className=\"w-4 h-4\" />\n                    <span>Satışı Kaydet</span>\n                  </>\n                )}\n              </Button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SaleModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/SaleNoteModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Card' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardContent' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardHeader' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CardTitle' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Badge' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onNoteSave' is defined but never used.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateNote' is assigned a value but never used.","line":61,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":21},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":265,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":278,"endColumn":30}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Button, \n  Textarea,\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Alert,\n  Spinner\n} from '@x-ear/ui-web';\nimport { X, FileText, Edit, Save, AlertCircle, CheckCircle } from 'lucide-react';\nimport { Patient, Sale } from '../../../types/patient';\n\ninterface SaleNoteModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  patient: Patient;\n  sale: Sale;\n  onNoteSave: (saleId: string, note: string) => void;\n  loading?: boolean;\n}\n\nexport const SaleNoteModal: React.FC<SaleNoteModalProps> = ({\n  isOpen,\n  onClose,\n  patient,\n  sale,\n  onNoteSave,\n  loading = false\n}) => {\n  const [noteText, setNoteText] = useState('');\n  const [hasChanges, setHasChanges] = useState(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (isOpen && sale) {\n      setNoteText(sale.notes || '');\n      setHasChanges(false);\n      setErrors({});\n    }\n  }, [isOpen, sale]);\n\n  // Early return after all hooks to prevent hooks order change\n  if (!isOpen || !sale) return null;\n\n  const handleNoteChange = (value: string) => {\n    setNoteText(value);\n    setHasChanges(value !== (sale.notes || ''));\n    \n    // Clear errors when user starts typing\n    if (errors.note) {\n      setErrors(prev => ({ ...prev, note: '' }));\n    }\n  };\n\n  const validateNote = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (noteText.length > 1000) {\n      newErrors.note = 'Not 1000 karakterden uzun olamaz';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!sale) return;\n    \n    setError(null);\n    setSuccess(null);\n    \n    // Validation\n    if (noteText.trim().length > 1000) {\n      setError('Not 1000 karakterden uzun olamaz');\n      return;\n    }\n    \n    if (noteText.trim() === (sale.notes || '').trim()) {\n      setError('Herhangi bir değişiklik yapılmadı');\n      return;\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      const updatedSale = {\n        ...sale,\n        notes: noteText.trim(),\n        updatedAt: new Date().toISOString()\n      };\n      \n      console.log('Sale note updated:', updatedSale);\n      \n      setSuccess('Satış notu başarıyla güncellendi');\n      \n      // Close modal after successful update\n      setTimeout(() => {\n        setError(null);\n        setSuccess(null);\n        onClose();\n      }, 2000);\n      \n    } catch (err) {\n      setError('Not güncellenirken bir hata oluştu. Lütfen tekrar deneyiniz.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'draft': return 'text-gray-700 bg-gray-100';\n      case 'confirmed': return 'text-blue-700 bg-blue-100';\n      case 'paid': return 'text-green-700 bg-green-100';\n      case 'cancelled': return 'text-red-700 bg-red-100';\n      default: return 'text-gray-700 bg-gray-100';\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    switch (status) {\n      case 'draft': return 'Taslak';\n      case 'confirmed': return 'Onaylandı';\n      case 'paid': return 'Ödenmiş';\n      case 'cancelled': return 'İptal Edilmiş';\n      default: return status;\n    }\n  };\n\n  // Quick note templates\n  const quickNotes = [\n    'Müşteri memnun kaldı',\n    'Garanti süresi açıklandı',\n    'Kullanım talimatları verildi',\n    'Kontrol randevusu planlandı',\n    'Ek aksesuar önerildi',\n    'Özel indirim uygulandı',\n    'Taksit planı açıklandı',\n    'SGK işlemleri tamamlandı'\n  ];\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <Edit className=\"w-5 h-5 mr-2\" />\n            Satış Notu Düzenle\n          </h3>\n          <Button\n            onClick={onClose}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Success Alert */}\n        {success && (\n          <Alert className=\"mb-4 border-green-200 bg-green-50\">\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n            <div className=\"text-green-800\">{success}</div>\n          </Alert>\n        )}\n\n        {/* Error Alert */}\n        {error && (\n          <Alert className=\"mb-4 border-red-200 bg-red-50\">\n            <AlertCircle className=\"h-4 w-4 text-red-600\" />\n            <div className=\"text-red-800\">{error}</div>\n          </Alert>\n        )}\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"space-y-6\">\n            {/* Sale Info */}\n            <div className=\"grid grid-cols-2 gap-6\">\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Müşteri Bilgileri</h4>\n                <div className=\"space-y-1 text-sm\">\n                  <div><span className=\"font-medium\">Ad Soyad:</span> {patient?.firstName || 'Belirtilmemiş'} {patient?.lastName || 'Belirtilmemiş'}</div>\n                  <div><span className=\"font-medium\">TC No:</span> {patient?.tcNumber || 'Belirtilmemiş'}</div>\n                  <div><span className=\"font-medium\">Telefon:</span> {patient?.phone || 'Belirtilmemiş'}</div>\n                </div>\n              </div>\n\n              <div className=\"bg-blue-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Satış Bilgileri</h4>\n                <div className=\"space-y-1 text-sm\">\n                  <div><span className=\"font-medium\">Satış ID:</span> {sale.id}</div>\n                  <div><span className=\"font-medium\">Tutar:</span> {formatCurrency(sale.totalAmount)}</div>\n                  <div><span className=\"font-medium\">Tarih:</span> {sale.saleDate ? formatDate(sale.saleDate) : 'Belirtilmemiş'}</div>\n                  <div className=\"flex items-center\">\n                    <span className=\"font-medium mr-2\">Durum:</span>\n                    <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(sale.status || '')}`}>\n                      {getStatusLabel(sale.status || '')}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Note Editor */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium text-gray-900 flex items-center\">\n                <FileText className=\"w-4 h-4 mr-2\" />\n                Satış Notu\n              </h4>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Not İçeriği\n                </label>\n                <Textarea\n                  value={noteText}\n                  onChange={(e) => handleNoteChange(e.target.value)}\n                  placeholder=\"Satış ile ilgili notlar, özel durumlar, müşteri talepleri...\"\n                  rows={6}\n                  className={`resize-none ${errors.note ? 'border-red-500' : ''}`}\n                />\n                \n                <div className=\"flex justify-between items-center mt-1\">\n                  <div className=\"text-xs text-gray-500\">\n                    {noteText.length}/1000 karakter\n                  </div>\n                  {errors.note && (\n                    <div className=\"flex items-center text-sm text-red-600\">\n                      <AlertCircle className=\"w-4 h-4 mr-1\" />\n                      {errors.note}\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Quick Notes */}\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h5 className=\"font-medium text-gray-900 mb-3\">Hızlı Notlar</h5>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  {quickNotes.map((quickNote) => (\n                    <button\n                      key={quickNote}\n                      type=\"button\"\n                      onClick={() => {\n                        const currentNote = noteText.trim();\n                        const newNote = currentNote \n                          ? `${currentNote}\\n• ${quickNote}`\n                          : `• ${quickNote}`;\n                        handleNoteChange(newNote);\n                      }}\n                      className=\"text-left p-2 text-sm border border-gray-200 rounded hover:bg-gray-100 transition-colors\"\n                    >\n                      + {quickNote}\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Note History */}\n              {sale.notes && sale.notes !== noteText && (\n                <div className=\"bg-yellow-50 p-4 rounded-lg\">\n                  <h5 className=\"font-medium text-gray-900 mb-2\">Mevcut Not</h5>\n                  <div className=\"text-sm text-gray-700 bg-white p-3 rounded border\">\n                    {sale.notes}\n                  </div>\n                </div>\n              )}\n\n              {/* Change Indicator */}\n              {hasChanges && (\n                <div className=\"bg-orange-50 border border-orange-200 p-4 rounded-lg\">\n                  <div className=\"flex items-center text-orange-800\">\n                    <Save className=\"w-4 h-4 mr-2\" />\n                    <span className=\"font-medium\">Kaydedilmemiş değişiklikler var</span>\n                  </div>\n                  <p className=\"text-sm text-orange-700 mt-1\">\n                    Değişikliklerinizi kaydetmek için \"Notu Kaydet\" butonuna tıklayın.\n                  </p>\n                </div>\n              )}\n            </div>\n\n            {/* Metadata */}\n            {(sale.createdAt || sale.updatedAt) && (\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h5 className=\"font-medium text-gray-900 mb-2\">Kayıt Bilgileri</h5>\n                <div className=\"text-sm text-gray-600 space-y-1\">\n                  {sale.createdAt && (\n                    <div>\n                      <span className=\"font-medium\">Oluşturulma:</span> {new Date(sale.createdAt).toLocaleString('tr-TR')}\n                    </div>\n                  )}\n                  {sale.updatedAt && (\n                    <div>\n                      <span className=\"font-medium\">Son Güncelleme:</span> {new Date(sale.updatedAt).toLocaleString('tr-TR')}\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n\n          <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n            <Button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md\"\n              disabled={isLoading}\n            >\n              İptal\n            </Button>\n            <Button\n              type=\"submit\"\n              className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center\"\n              disabled={isLoading || noteText.trim().length === 0 || noteText.trim() === (sale?.notes || '').trim()}\n            >\n              {isLoading ? (\n                <>\n                  <Spinner className=\"w-4 h-4 mr-2\" />\n                  Kaydediliyor...\n                </>\n              ) : (\n                <>\n                  <Save className=\"w-4 h-4 mr-2\" />\n                  Notu Kaydet\n                </>\n              )}\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default SaleNoteModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/components/PaymentOptionsComponent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Button' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":9},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":72,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":79,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Input,\n  Button\n} from '@x-ear/ui-web';\nimport { CreditCard, DollarSign } from 'lucide-react';\n\ninterface PaymentOptionsComponentProps {\n  paymentMethod: string;\n  onPaymentMethodChange: (method: string) => void;\n  installmentCount: string;\n  onInstallmentCountChange: (count: string) => void;\n  downPayment: string;\n  onDownPaymentChange: (amount: string) => void;\n  interestRate: string;\n  onInterestRateChange: (rate: string) => void;\n  installmentAmount: number;\n  totalAmount: number;\n}\n\nexport const PaymentOptionsComponent: React.FC<PaymentOptionsComponentProps> = ({\n  paymentMethod,\n  onPaymentMethodChange,\n  installmentCount,\n  onInstallmentCountChange,\n  downPayment,\n  onDownPaymentChange,\n  interestRate,\n  onInterestRateChange,\n  installmentAmount,\n  totalAmount\n}) => {\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const paymentMethods = [\n    { value: 'cash', label: 'Nakit', icon: DollarSign },\n    { value: 'credit', label: 'Kredi Kartı', icon: CreditCard },\n    { value: 'installment', label: 'Taksitli', icon: CreditCard },\n    { value: 'check', label: 'Çek', icon: DollarSign },\n    { value: 'transfer', label: 'Havale/EFT', icon: DollarSign }\n  ];\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-lg flex items-center\">\n          <CreditCard className=\"w-5 h-5 mr-2 text-indigo-600\" />\n          Ödeme Seçenekleri\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3 pt-4 border-t\">\n          <div className=\"grid grid-cols-2 gap-3\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Ödeme Yöntemi\n              </label>\n              <div className=\"space-y-2\">\n                {paymentMethods.map((method) => {\n                  const IconComponent = method.icon;\n                  return (\n                    <label key={method.value} className=\"flex items-center space-x-2 cursor-pointer\">\n                      <input\n                        type=\"radio\"\n                        name=\"paymentMethod\"\n                        value={method.value}\n                        checked={paymentMethod === method.value}\n                        onChange={(e) => onPaymentMethodChange(e.target.value)}\n                        className=\"text-blue-600 focus:ring-blue-500\"\n                      />\n                      <div className=\"flex items-center space-x-2\">\n                        <IconComponent className=\"w-4 h-4 text-gray-500\" />\n                        <span className=\"text-sm text-gray-700\">{method.label}</span>\n                      </div>\n                    </label>\n                  );\n                })}\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Satış Tarihi\n              </label>\n              <Input\n                type=\"date\"\n                name=\"saleDate\"\n                defaultValue={new Date().toISOString().split('T')[0]}\n                className=\"w-full\"\n              />\n            </div>\n          </div>\n\n          {/* Installment Options */}\n          {paymentMethod === 'installment' && (\n            <div className=\"grid grid-cols-3 gap-3\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Taksit Sayısı\n                </label>\n                <Input\n                  type=\"number\"\n                  min=\"2\"\n                  max=\"36\"\n                  placeholder=\"Taksit sayısı\"\n                  value={installmentCount}\n                  onChange={(e) => onInstallmentCountChange(e.target.value)}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Faiz Oranı (%)\n                </label>\n                <Input\n                  type=\"number\"\n                  step=\"0.01\"\n                  min=\"0\"\n                  max=\"100\"\n                  placeholder=\"Faiz oranı\"\n                  value={interestRate}\n                  onChange={(e) => onInterestRateChange(e.target.value)}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Peşinat\n                </label>\n                <Input\n                  type=\"number\"\n                  step=\"0.01\"\n                  placeholder=\"Peşinat tutarı\"\n                  value={downPayment}\n                  onChange={(e) => onDownPaymentChange(e.target.value)}\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Installment Preview */}\n          {paymentMethod === 'installment' && installmentCount && (\n            <div className=\"space-y-3 p-4 bg-purple-50 border border-purple-200 rounded-lg\">\n              <div className=\"grid grid-cols-2 gap-3\">\n                <div>\n                  <span className=\"text-sm font-medium text-purple-700\">Taksit Sayısı:</span>\n                  <div className=\"text-lg font-bold text-purple-800\">{installmentCount}</div>\n                </div>\n                <div>\n                  <span className=\"text-sm font-medium text-purple-700\">Aylık Taksit:</span>\n                  <div className=\"text-lg font-bold text-purple-800\">\n                    {formatCurrency(installmentAmount)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"p-3 bg-white border border-purple-200 rounded-md\">\n                <div className=\"text-sm text-purple-700 space-y-1\">\n                  <div className=\"flex justify-between\">\n                    <span>Toplam Tutar:</span>\n                    <span className=\"font-medium\">{formatCurrency(totalAmount)}</span>\n                  </div>\n                  <div className=\"flex justify-between border-t pt-1\">\n                    <span>Peşinat:</span>\n                    <span className=\"font-medium\">\n                      {formatCurrency(parseFloat(downPayment) || 0)}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Kalan Tutar:</span>\n                    <span className=\"font-medium\">\n                      {formatCurrency(totalAmount - (parseFloat(downPayment) || 0))}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between font-bold text-purple-800 border-t pt-1\">\n                    <span>{installmentCount} x Aylık:</span>\n                    <span>{formatCurrency(installmentAmount)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default PaymentOptionsComponent;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/components/PricingPreviewComponent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Badge' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Percent' is defined but never used.","line":10,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TrendingUp' is defined but never used.","line":10,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":41},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":94,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":99,"endColumn":17}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Input,\n  Badge\n} from '@x-ear/ui-web';\nimport { Calculator, Percent, TrendingUp } from 'lucide-react';\n\ninterface PricingDetails {\n  basePrice: number;\n  discountAmount: number;\n  discountPercent: number;\n  vatAmount: number;\n  sgkDiscount: number;\n  totalAmount: number;\n  installmentAmount?: number;\n}\n\ninterface PricingPreviewComponentProps {\n  pricingDetails: PricingDetails;\n  customPrice: string;\n  onCustomPriceChange: (value: string) => void;\n  discountPercent: string;\n  onDiscountPercentChange: (value: string) => void;\n  sgkEnabled: boolean;\n  onSgkToggle: (enabled: boolean) => void;\n  sgkDiscount: string;\n  onSgkDiscountChange: (value: string) => void;\n  sgkCode: string;\n  onSgkCodeChange: (value: string) => void;\n}\n\nexport const PricingPreviewComponent: React.FC<PricingPreviewComponentProps> = ({\n  pricingDetails,\n  customPrice,\n  onCustomPriceChange,\n  discountPercent,\n  onDiscountPercentChange,\n  sgkEnabled,\n  onSgkToggle,\n  sgkDiscount,\n  onSgkDiscountChange,\n  sgkCode,\n  onSgkCodeChange\n}) => {\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-lg flex items-center\">\n          <Calculator className=\"w-5 h-5 mr-2 text-purple-600\" />\n          Fiyat Önizleme\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4 p-4 bg-gray-50 border border-gray-200 rounded-lg\">\n          {/* Custom Price Input */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Özel Fiyat (Opsiyonel)\n            </label>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <Input\n                type=\"number\"\n                step=\"0.01\"\n                placeholder=\"0.00\"\n                value={customPrice}\n                onChange={(e) => onCustomPriceChange(e.target.value)}\n                className=\"text-right\"\n              />\n              <Input\n                type=\"number\"\n                step=\"0.01\"\n                placeholder=\"İndirim %\"\n                value={discountPercent}\n                onChange={(e) => onDiscountPercentChange(e.target.value)}\n                className=\"text-right\"\n              />\n            </div>\n          </div>\n\n          {/* SGK Options */}\n          <div>\n            <label className=\"flex items-center space-x-2 mb-3\">\n              <input\n                type=\"checkbox\"\n                checked={sgkEnabled}\n                onChange={(e) => onSgkToggle(e.target.checked)}\n                className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n              />\n              <span className=\"text-sm font-medium text-gray-700\">SGK İndirimi Uygula</span>\n            </label>\n            \n            {sgkEnabled && (\n              <div className=\"grid grid-cols-3 gap-4\">\n                <Input\n                  type=\"number\"\n                  step=\"0.01\"\n                  placeholder=\"SGK İndirim %\"\n                  value={sgkDiscount}\n                  onChange={(e) => onSgkDiscountChange(e.target.value)}\n                  className=\"text-right\"\n                />\n                <Input\n                  type=\"text\"\n                  placeholder=\"SGK Kodu\"\n                  value={sgkCode}\n                  onChange={(e) => onSgkCodeChange(e.target.value)}\n                  className=\"col-span-2\"\n                />\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Pricing Breakdown */}\n        <div className=\"space-y-6\">\n          <div className=\"space-y-3\">\n            <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\n              <span className=\"text-sm font-medium text-gray-600\">Temel Fiyat:</span>\n              <span className=\"font-semibold text-gray-900\">\n                {formatCurrency(pricingDetails.basePrice)}\n              </span>\n            </div>\n\n            {pricingDetails.discountAmount > 0 && (\n              <div className=\"flex justify-between items-center p-3 bg-red-50 rounded-lg\">\n                <span className=\"text-sm font-medium text-red-600\">\n                  İndirim ({pricingDetails.discountPercent.toFixed(1)}%):\n                </span>\n                <span className=\"font-semibold text-red-700\">\n                  -{formatCurrency(pricingDetails.discountAmount)}\n                </span>\n              </div>\n            )}\n\n            {pricingDetails.sgkDiscount > 0 && (\n              <div className=\"flex justify-between items-center p-3 bg-green-50 rounded-lg\">\n                <span className=\"text-sm font-medium text-green-600\">SGK İndirimi:</span>\n                <span className=\"font-semibold text-green-700\">\n                  -{formatCurrency(pricingDetails.sgkDiscount)}\n                </span>\n              </div>\n            )}\n\n            <div className=\"flex justify-between items-center p-3 bg-blue-50 rounded-lg\">\n              <span className=\"text-sm font-medium text-blue-600\">KDV:</span>\n              <span className=\"font-semibold text-blue-700\">\n                {formatCurrency(pricingDetails.vatAmount)}\n              </span>\n            </div>\n\n            <div className=\"border-t pt-3\">\n              <div className=\"flex justify-between items-center p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200\">\n                <span className=\"text-lg font-bold text-green-800\">TOPLAM TUTAR:</span>\n                <span className=\"text-xl font-bold text-green-800\">\n                  {formatCurrency(pricingDetails.totalAmount)}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default PricingPreviewComponent;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/modals/components/ProductSearchComponent.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Package' is defined but never used.","line":10,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'FuzzySearchResult' is defined but never used.","line":11,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":43}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { \n  Input, \n  Card, \n  CardContent, \n  CardHeader, \n  CardTitle,\n  Badge\n} from '@x-ear/ui-web';\nimport { Search, Package, Star } from 'lucide-react';\nimport { searchProducts, FuzzySearchResult, SearchableItem } from '../../../../utils/fuzzy-search';\n\ninterface Product extends SearchableItem {\n  name: string;\n  brand: string;\n  model: string;\n  category: string;\n  listPrice: number;\n  salePrice: number;\n  vatRate: number;\n  stock: number;\n  serialNumber?: string;\n  barcode?: string;\n  sgkSupported: boolean;\n  sgkCode?: string;\n  description?: string;\n}\n\ninterface ProductSearchComponentProps {\n  searchTerm: string;\n  onSearchChange: (value: string) => void;\n  searchResults: Product[];\n  selectedProduct: Product | null;\n  onProductSelect: (product: Product) => void;\n  isSearching: boolean;\n  showResults: boolean;\n  enableFuzzySearch?: boolean;\n  maxResults?: number;\n}\n\nexport const ProductSearchComponent: React.FC<ProductSearchComponentProps> = ({\n  searchTerm,\n  onSearchChange,\n  searchResults,\n  selectedProduct,\n  onProductSelect,\n  isSearching,\n  showResults,\n  enableFuzzySearch = true,\n  maxResults = 10\n}) => {\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  // Enhanced search results with fuzzy matching\n  const enhancedResults = React.useMemo(() => {\n    if (!enableFuzzySearch || !searchTerm.trim()) {\n      return searchResults.map(product => ({\n        item: product,\n        score: 1,\n        matches: [],\n        relevance: 'high' as const\n      }));\n    }\n\n    return searchProducts(searchTerm, searchResults, {\n      maxResults,\n      threshold: 0.2\n    });\n  }, [searchResults, searchTerm, enableFuzzySearch, maxResults]);\n\n  const getRelevanceColor = (relevance: 'high' | 'medium' | 'low') => {\n    switch (relevance) {\n      case 'high': return 'text-green-600';\n      case 'medium': return 'text-yellow-600';\n      case 'low': return 'text-gray-600';\n      default: return 'text-gray-600';\n    }\n  };\n\n  const getRelevanceIcon = (relevance: 'high' | 'medium' | 'low') => {\n    const stars = relevance === 'high' ? 3 : relevance === 'medium' ? 2 : 1;\n    return Array.from({ length: stars }, (_, i) => (\n      <Star key={i} className=\"w-3 h-3 fill-current\" />\n    ));\n  };\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-lg flex items-center\">\n          <Search className=\"w-5 h-5 mr-2 text-green-600\" />\n          Ürün Seçimi\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Product Search */}\n        <div className=\"relative\">\n          <div className=\"relative\">\n            <Input\n              type=\"text\"\n              placeholder=\"Ürün adı, marka, model veya barkod ile arayın...\"\n              value={searchTerm}\n              onChange={(e) => onSearchChange(e.target.value)}\n              className=\"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n            <div className=\"absolute left-3 top-1/2 transform -translate-y-1/2\">\n              <Search className=\"w-4 h-4 text-gray-400\" />\n            </div>\n            <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2\">\n              {isSearching && (\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n              )}\n            </div>\n          </div>\n\n          {/* Search Results Dropdown */}\n          {showResults && enhancedResults.length > 0 && (\n            <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto\">\n              {enhancedResults.map((result) => {\n                const product = result.item;\n                return (\n                  <div\n                    key={product.id}\n                    onClick={() => onProductSelect(product)}\n                    className=\"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0\"\n                  >\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-2\">\n                          <div className=\"font-medium text-gray-900\">{product.name}</div>\n                          {enableFuzzySearch && (\n                            <div className={`flex items-center space-x-1 ${getRelevanceColor(result.relevance)}`}>\n                              {getRelevanceIcon(result.relevance)}\n                              <span className=\"text-xs\">({Math.round(result.score * 100)}%)</span>\n                            </div>\n                          )}\n                        </div>\n                        <div className=\"text-sm text-gray-600\">\n                          {product.brand} - {product.model}\n                        </div>\n                        <div className=\"flex items-center space-x-4 mt-1\">\n                          <Badge variant={product.stock > 0 ? 'success' : 'danger'} size=\"sm\">\n                            Stok: {product.stock}\n                          </Badge>\n                          {product.sgkSupported && (\n                            <Badge variant=\"primary\" size=\"sm\">\n                              SGK\n                            </Badge>\n                          )}\n                          <span className=\"text-xs text-gray-500\">{product.category}</span>\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className=\"font-semibold text-green-600\">\n                          {formatCurrency(product.salePrice)}\n                        </div>\n                        {product.listPrice > product.salePrice && (\n                          <div className=\"text-xs text-gray-500 line-through\">\n                            {formatCurrency(product.listPrice)}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </div>\n\n        {/* Selected Product Display */}\n        {selectedProduct && (\n          <div className=\"p-4 bg-green-50 border border-green-200 rounded-lg\">\n            <div className=\"flex justify-between items-start\">\n              <div className=\"flex-1\">\n                <div className=\"font-medium text-green-800\">{selectedProduct.name}</div>\n                <div className=\"text-sm text-green-700\">\n                  {selectedProduct.brand} - {selectedProduct.model}\n                </div>\n                <div className=\"flex items-center space-x-4 mt-2\">\n                  <Badge variant={selectedProduct.stock > 0 ? 'success' : 'danger'} size=\"sm\">\n                    Stok: {selectedProduct.stock}\n                  </Badge>\n                  {selectedProduct.sgkSupported && (\n                    <Badge variant=\"primary\" size=\"sm\">\n                      SGK Destekli\n                    </Badge>\n                  )}\n                  {selectedProduct.serialNumber && (\n                    <span className=\"text-xs text-green-600\">\n                      SN: {selectedProduct.serialNumber}\n                    </span>\n                  )}\n                  {selectedProduct.barcode && (\n                    <span className=\"text-xs text-green-600\">\n                      Barkod: {selectedProduct.barcode}\n                    </span>\n                  )}\n                </div>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"font-bold text-green-700 text-lg\">\n                  {formatCurrency(selectedProduct.salePrice)}\n                </div>\n                {selectedProduct.listPrice > selectedProduct.salePrice && (\n                  <div className=\"text-sm text-green-600 line-through\">\n                    {formatCurrency(selectedProduct.listPrice)}\n                  </div>\n                )}\n                <div className=\"text-xs text-green-600 mt-1\">\n                  KDV: %{selectedProduct.vatRate}\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default ProductSearchComponent;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/stats/PatientStats.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[717,720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[717,720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react'\nimport { Users, UserCheck, UserX, TrendingUp, TrendingDown, Minus, Calendar, Clock, AlertCircle, Activity } from 'lucide-react'\n\ninterface PatientStatsProps {\n  totalPatients?: number\n  activePatients?: number\n  inactivePatients?: number\n  newPatientsThisMonth?: number\n  todayAppointments?: number\n  pendingTasks?: number\n  deviceTrialsActive?: number\n  sgkReportsPending?: number\n  loading?: boolean\n  className?: string\n  showTrends?: boolean\n  showExtendedStats?: boolean\n  autoRefresh?: boolean\n  refreshInterval?: number\n  onRefresh?: () => Promise<void>\n}\n\ninterface StatItem {\n  id: string\n  name: string\n  value: number\n  icon: React.ComponentType<any>\n  color: string\n  bgColor: string\n  trend?: {\n    value: number\n    direction: 'up' | 'down' | 'neutral'\n    period: string\n  }\n  target?: number\n  priority?: 'high' | 'medium' | 'low'\n}\n\nexport const PatientStats: React.FC<PatientStatsProps> = ({\n  totalPatients = 0,\n  activePatients = 0,\n  inactivePatients = 0,\n  newPatientsThisMonth = 0,\n  todayAppointments = 0,\n  pendingTasks = 0,\n  deviceTrialsActive = 0,\n  sgkReportsPending = 0,\n  loading = false,\n  className = \"\",\n  showTrends = true,\n  showExtendedStats = false,\n  autoRefresh = false,\n  refreshInterval = 300000, // 5 minutes instead of 30 seconds\n  onRefresh\n}) => {\n  const [lastUpdated, setLastUpdated] = useState<Date>(new Date())\n  const [isRefreshing, setIsRefreshing] = useState(false)\n\n  // Auto-refresh functionality\n  useEffect(() => {\n    if (!autoRefresh || !onRefresh) return\n\n    const interval = setInterval(async () => {\n      setIsRefreshing(true)\n      try {\n        await onRefresh()\n        setLastUpdated(new Date())\n      } catch (error) {\n        console.error('Failed to refresh patient stats:', error)\n      } finally {\n        setIsRefreshing(false)\n      }\n    }, refreshInterval)\n\n    return () => clearInterval(interval)\n  }, [autoRefresh, onRefresh, refreshInterval])\n\n  // Calculate trends (mock data - in real app this would come from props)\n  const calculateTrend = (current: number, previous: number): StatItem['trend'] => {\n    if (previous === 0) return { value: 0, direction: 'neutral', period: 'geçen aya göre' }\n    \n    const change = ((current - previous) / previous) * 100\n    return {\n      value: Math.abs(change),\n      direction: change > 0 ? 'up' : change < 0 ? 'down' : 'neutral',\n      period: 'geçen aya göre'\n    }\n  }\n\n  const stats: StatItem[] = useMemo(() => {\n    const baseStats: StatItem[] = [\n      {\n        id: 'total',\n        name: 'Toplam Hasta',\n        value: totalPatients,\n        icon: Users,\n        color: 'text-blue-600',\n        bgColor: 'bg-blue-100',\n        trend: showTrends ? calculateTrend(totalPatients, totalPatients * 0.95) : undefined\n      },\n      {\n        id: 'active',\n        name: 'Aktif Hastalar',\n        value: activePatients,\n        icon: UserCheck,\n        color: 'text-green-600',\n        bgColor: 'bg-green-100',\n        trend: showTrends ? calculateTrend(activePatients, activePatients * 0.92) : undefined\n      },\n      {\n        id: 'inactive',\n        name: 'Pasif Hastalar',\n        value: inactivePatients,\n        icon: UserX,\n        color: 'text-red-600',\n        bgColor: 'bg-red-100',\n        trend: showTrends ? calculateTrend(inactivePatients, inactivePatients * 1.1) : undefined,\n        priority: inactivePatients > totalPatients * 0.3 ? 'high' : 'low'\n      },\n      {\n        id: 'new',\n        name: 'Bu Ay Yeni',\n        value: newPatientsThisMonth,\n        icon: TrendingUp,\n        color: 'text-purple-600',\n        bgColor: 'bg-purple-100',\n        trend: showTrends ? calculateTrend(newPatientsThisMonth, Math.floor(newPatientsThisMonth * 0.8)) : undefined,\n        target: 50 // Example target\n      }\n    ]\n\n    if (showExtendedStats) {\n      baseStats.push(\n        {\n          id: 'appointments',\n          name: 'Bugün Randevu',\n          value: todayAppointments,\n          icon: Calendar,\n          color: 'text-orange-600',\n          bgColor: 'bg-orange-100',\n          priority: todayAppointments > 20 ? 'high' : 'medium'\n        },\n        {\n          id: 'pending',\n          name: 'Bekleyen Görevler',\n          value: pendingTasks,\n          icon: Clock,\n          color: 'text-yellow-600',\n          bgColor: 'bg-yellow-100',\n          priority: pendingTasks > 10 ? 'high' : 'low'\n        },\n        {\n          id: 'trials',\n          name: 'Aktif Denemeler',\n          value: deviceTrialsActive,\n          icon: Activity,\n          color: 'text-indigo-600',\n          bgColor: 'bg-indigo-100'\n        },\n        {\n          id: 'sgk',\n          name: 'SGK Bekleyen',\n          value: sgkReportsPending,\n          icon: AlertCircle,\n          color: 'text-pink-600',\n          bgColor: 'bg-pink-100',\n          priority: sgkReportsPending > 5 ? 'high' : 'low'\n        }\n      )\n    }\n\n    return baseStats\n  }, [\n    totalPatients,\n    activePatients,\n    inactivePatients,\n    newPatientsThisMonth,\n    todayAppointments,\n    pendingTasks,\n    deviceTrialsActive,\n    sgkReportsPending,\n    showTrends,\n    showExtendedStats\n  ])\n\n  const getTrendIcon = (direction: 'up' | 'down' | 'neutral') => {\n    switch (direction) {\n      case 'up':\n        return <TrendingUp className=\"w-3 h-3\" />\n      case 'down':\n        return <TrendingDown className=\"w-3 h-3\" />\n      default:\n        return <Minus className=\"w-3 h-3\" />\n    }\n  }\n\n  const getTrendColor = (direction: 'up' | 'down' | 'neutral', isPositive: boolean = true) => {\n    if (direction === 'neutral') return 'text-gray-500'\n    \n    const isGoodTrend = (direction === 'up' && isPositive) || (direction === 'down' && !isPositive)\n    return isGoodTrend ? 'text-green-600' : 'text-red-600'\n  }\n\n  const getPriorityIndicator = (priority?: 'high' | 'medium' | 'low') => {\n    if (!priority || priority === 'low') return null\n    \n    return (\n      <div className={`absolute -top-1 -right-1 w-3 h-3 rounded-full ${\n        priority === 'high' ? 'bg-red-500' : 'bg-yellow-500'\n      }`} />\n    )\n  }\n\n  if (loading) {\n    return (\n      <div className={`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 ${className}`}>\n        {[...Array(showExtendedStats ? 8 : 4)].map((_, index) => (\n          <div key={index} className=\"bg-white overflow-hidden shadow rounded-lg animate-pulse\">\n            <div className=\"p-5\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"w-8 h-8 bg-gray-200 rounded\"></div>\n                </div>\n                <div className=\"ml-5 w-0 flex-1\">\n                  <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\n                  <div className=\"h-6 bg-gray-200 rounded w-1/2\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    )\n  }\n\n  return (\n    <div className={className}>\n      {/* Header with refresh info */}\n      {autoRefresh && (\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"text-sm text-gray-500\">\n            Son güncelleme: {lastUpdated.toLocaleTimeString('tr-TR')}\n          </div>\n          {isRefreshing && (\n            <div className=\"flex items-center text-sm text-blue-600\">\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n              Güncelleniyor...\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Stats Grid */}\n      <div className={`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-${showExtendedStats ? '4' : '4'} gap-4`}>\n        {stats.map((stat) => {\n          const Icon = stat.icon\n          const isNegativeTrend = stat.id === 'inactive' // Inactive patients going up is bad\n          \n          return (\n            <div \n              key={stat.id} \n              className=\"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-all duration-200 relative\"\n            >\n              {getPriorityIndicator(stat.priority)}\n              \n              <div className=\"p-5\">\n                <div className=\"flex items-center\">\n                  <div className=\"flex-shrink-0\">\n                    <div className={`w-8 h-8 ${stat.bgColor} rounded-full flex items-center justify-center`}>\n                      <Icon className={`w-5 h-5 ${stat.color}`} />\n                    </div>\n                  </div>\n                  <div className=\"ml-5 w-0 flex-1\">\n                    <dl>\n                      <dt className=\"text-sm font-medium text-gray-500 truncate\">\n                        {stat.name}\n                      </dt>\n                      <dd className=\"flex items-baseline\">\n                        <div className=\"text-lg font-semibold text-gray-900\">\n                          {stat.value.toLocaleString('tr-TR')}\n                        </div>\n                        {stat.target && (\n                          <div className=\"ml-2 text-xs text-gray-500\">\n                            / {stat.target}\n                          </div>\n                        )}\n                      </dd>\n                    </dl>\n                    \n                    {/* Trend Indicator */}\n                    {stat.trend && (\n                      <div className={`flex items-center mt-1 text-xs ${getTrendColor(stat.trend.direction, !isNegativeTrend)}`}>\n                        {getTrendIcon(stat.trend.direction)}\n                        <span className=\"ml-1\">\n                          {stat.trend.value.toFixed(1)}% {stat.trend.period}\n                        </span>\n                      </div>\n                    )}\n                    \n                    {/* Progress Bar for targets */}\n                    {stat.target && (\n                      <div className=\"mt-2\">\n                        <div className=\"w-full bg-gray-200 rounded-full h-1\">\n                          <div \n                            className={`h-1 rounded-full ${stat.color.replace('text-', 'bg-')}`}\n                            style={{ width: `${Math.min((stat.value / stat.target) * 100, 100)}%` }}\n                          />\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    </div>\n  )\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/patients/views/PatientSavedViews.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[239,242],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[239,242],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":100,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":106,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":129,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":143,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":146,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":151,"endColumn":32},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":165,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":171,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":173,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":179,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":182,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":188,"endColumn":30},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":204,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":211,"endColumn":15},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":213,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":221,"endColumn":24},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":222,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":228,"endColumn":24}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react'\nimport { Bookmark, Plus, Edit2, Trash2, Eye } from 'lucide-react'\nimport { usePatientFilters } from '@/hooks/patients/usePatientFilters'\n\ninterface SavedView {\n  id: string\n  name: string\n  filters: any\n  isDefault?: boolean\n  createdAt: string\n}\n\ninterface PatientSavedViewsProps {\n  className?: string\n}\n\nexport const PatientSavedViews: React.FC<PatientSavedViewsProps> = ({\n  className = \"\"\n}) => {\n  const { filters, setFilters } = usePatientFilters()\n  const [savedViews, setSavedViews] = useState<SavedView[]>([\n    {\n      id: '1',\n      name: 'Aktif Hastalar',\n      filters: { status: 'active' },\n      isDefault: true,\n      createdAt: '2024-01-15'\n    },\n    {\n      id: '2',\n      name: 'Bu Ay Kayıt Olanlar',\n      filters: { \n        dateRange: { \n          from: new Date().toISOString().slice(0, 7) + '-01',\n          to: new Date().toISOString().slice(0, 10)\n        }\n      },\n      createdAt: '2024-01-10'\n    },\n    {\n      id: '3',\n      name: 'İstanbul Hastaları',\n      filters: { city: 'İstanbul' },\n      createdAt: '2024-01-05'\n    }\n  ])\n  \n  const [showSaveDialog, setShowSaveDialog] = useState(false)\n  const [newViewName, setNewViewName] = useState('')\n  const [editingView, setEditingView] = useState<SavedView | null>(null)\n\n  const applyView = (view: SavedView) => {\n    setFilters(view.filters)\n  }\n\n  const saveCurrentView = () => {\n    if (!newViewName.trim()) return\n\n    const newView: SavedView = {\n      id: Date.now().toString(),\n      name: newViewName.trim(),\n      filters: { ...filters },\n      createdAt: new Date().toISOString().slice(0, 10)\n    }\n\n    setSavedViews(prev => [...prev, newView])\n    setNewViewName('')\n    setShowSaveDialog(false)\n  }\n\n  const updateView = (viewId: string, newName: string) => {\n    setSavedViews(prev => prev.map(view => \n      view.id === viewId \n        ? { ...view, name: newName, filters: { ...filters } }\n        : view\n    ))\n    setEditingView(null)\n  }\n\n  const deleteView = (viewId: string) => {\n    if (window.confirm('Bu görünümü silmek istediğinizden emin misiniz?')) {\n      setSavedViews(prev => prev.filter(view => view.id !== viewId))\n    }\n  }\n\n  const hasActiveFilters = Object.keys(filters).some(key => \n    key !== 'search' && filters[key as keyof typeof filters]\n  )\n\n  return (\n    <div className={`bg-white border border-gray-200 rounded-lg ${className}`}>\n      <div className=\"px-4 py-3 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Bookmark className=\"h-5 w-5 text-gray-400\" />\n            <h3 className=\"text-sm font-medium text-gray-900\">Kayıtlı Görünümler</h3>\n          </div>\n          \n          {hasActiveFilters && (\n            <button\n              onClick={() => setShowSaveDialog(true)}\n              className=\"inline-flex items-center px-2 py-1 text-xs font-medium text-indigo-600 bg-indigo-50 rounded hover:bg-indigo-100\"\n            >\n              <Plus className=\"h-3 w-3 mr-1\" />\n              Kaydet\n            </button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"p-2\">\n        {savedViews.length === 0 ? (\n          <div className=\"text-center py-6\">\n            <Bookmark className=\"mx-auto h-8 w-8 text-gray-300 mb-2\" />\n            <p className=\"text-sm text-gray-500\">Henüz kayıtlı görünüm yok</p>\n            <p className=\"text-xs text-gray-400 mt-1\">\n              Filtre uygulayıp kaydet butonuna tıklayın\n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-1\">\n            {savedViews.map((view) => (\n              <div\n                key={view.id}\n                className=\"group flex items-center justify-between p-2 rounded hover:bg-gray-50\"\n              >\n                <div className=\"flex-1 min-w-0\">\n                  {editingView?.id === view.id ? (\n                    <input\n                      type=\"text\"\n                      value={editingView.name}\n                      onChange={(e) => setEditingView({ ...editingView, name: e.target.value })}\n                      onBlur={() => updateView(view.id, editingView.name)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                          updateView(view.id, editingView.name)\n                        } else if (e.key === 'Escape') {\n                          setEditingView(null)\n                        }\n                      }}\n                      className=\"w-full text-sm font-medium text-gray-900 bg-transparent border-none outline-none focus:ring-1 focus:ring-indigo-500 rounded px-1\"\n                      autoFocus\n                    />\n                  ) : (\n                    <div className=\"flex items-center space-x-2\">\n                      <button\n                        onClick={() => applyView(view)}\n                        className=\"text-sm font-medium text-gray-900 hover:text-indigo-600 truncate\"\n                      >\n                        {view.name}\n                      </button>\n                      {view.isDefault && (\n                        <span className=\"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                          Varsayılan\n                        </span>\n                      )}\n                    </div>\n                  )}\n                  <p className=\"text-xs text-gray-500 mt-0.5\">\n                    {Object.keys(view.filters).length} filtre • {view.createdAt}\n                  </p>\n                </div>\n\n                <div className=\"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                  <button\n                    onClick={() => applyView(view)}\n                    className=\"p-1 text-gray-400 hover:text-indigo-600 rounded\"\n                    title=\"Görünümü uygula\"\n                  >\n                    <Eye className=\"h-3 w-3\" />\n                  </button>\n                  \n                  <button\n                    onClick={() => setEditingView(view)}\n                    className=\"p-1 text-gray-400 hover:text-gray-600 rounded\"\n                    title=\"Düzenle\"\n                  >\n                    <Edit2 className=\"h-3 w-3\" />\n                  </button>\n                  \n                  {!view.isDefault && (\n                    <button\n                      onClick={() => deleteView(view.id)}\n                      className=\"p-1 text-gray-400 hover:text-red-600 rounded\"\n                      title=\"Sil\"\n                    >\n                      <Trash2 className=\"h-3 w-3\" />\n                    </button>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Save Dialog */}\n      {showSaveDialog && (\n        <div className=\"border-t border-gray-200 p-3\">\n          <div className=\"space-y-2\">\n            <label className=\"block text-xs font-medium text-gray-700\">\n              Görünüm Adı\n            </label>\n            <input\n              type=\"text\"\n              value={newViewName}\n              onChange={(e) => setNewViewName(e.target.value)}\n              placeholder=\"Örn: Aktif İstanbul Hastaları\"\n              className=\"block w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500\"\n              autoFocus\n            />\n            <div className=\"flex justify-end space-x-2 pt-1\">\n              <button\n                onClick={() => {\n                  setShowSaveDialog(false)\n                  setNewViewName('')\n                }}\n                className=\"px-2 py-1 text-xs text-gray-600 hover:text-gray-800\"\n              >\n                İptal\n              </button>\n              <button\n                onClick={saveCurrentView}\n                disabled={!newViewName.trim()}\n                className=\"px-2 py-1 text-xs font-medium text-white bg-indigo-600 rounded hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Kaydet\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/payments/PaymentTrackingModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Textarea' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getXEarCRMAPIAutoGenerated' is defined but never used.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setPromissoryNotes' is assigned a value but never used.","line":89,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'amount' is defined but never used.","line":273,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":273,"endColumn":76},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadPaymentData'. Either include it or remove the dependency array.","line":302,"column":6,"nodeType":"ArrayExpression","endLine":302,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, loadPaymentData, sale.id]","fix":{"range":[8016,8033],"text":"[isOpen, loadPaymentData, sale.id]"}}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":419,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":430,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":421,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":421,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12414,12417],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12414,12417],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":462,"column":23,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":471,"endColumn":32}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  Button, \n  Input, \n  Label, \n  Textarea,\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  Badge,\n  Alert,\n  Spinner\n} from '@x-ear/ui-web';\nimport { \n  X, \n  CreditCard, \n  Calendar, \n  DollarSign, \n  CheckCircle, \n  AlertCircle, \n  Clock,\n  FileText,\n  Plus,\n  Trash2\n} from 'lucide-react';\nimport { Sale } from '../../api/generated/api';\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/api';\n\ninterface PaymentRecord {\n  id: string;\n  amount: number;\n  paymentDate: string;\n  paymentMethod: string;\n  status: 'pending' | 'paid' | 'overdue' | 'cancelled';\n  notes?: string;\n  referenceNumber?: string;\n}\n\ninterface Installment {\n  id: string;\n  installmentNumber: number;\n  amount: number;\n  dueDate: string;\n  status: 'pending' | 'paid' | 'overdue';\n  paidDate?: string;\n  notes?: string;\n}\n\ninterface PromissoryNote {\n  id: string;\n  amount: number;\n  dueDate: string;\n  status: 'active' | 'paid' | 'overdue' | 'cancelled';\n  noteNumber: string;\n  description?: string;\n}\n\ninterface PaymentSummary {\n  totalAmount: number;\n  totalPaid: number;\n  remainingBalance: number;\n  overdueAmount: number;\n  nextDueDate?: string;\n  nextDueAmount?: number;\n}\n\ninterface PaymentTrackingModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  sale: Sale;\n  onPaymentUpdate: () => void;\n}\n\nexport const PaymentTrackingModal: React.FC<PaymentTrackingModalProps> = ({\n  isOpen,\n  onClose,\n  sale,\n  onPaymentUpdate\n}) => {\n  const [activeTab, setActiveTab] = useState<'payments' | 'installments' | 'promissory'>('payments');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  \n  // Data states\n  const [paymentRecords, setPaymentRecords] = useState<PaymentRecord[]>([]);\n  const [installments, setInstallments] = useState<Installment[]>([]);\n  const [promissoryNotes, setPromissoryNotes] = useState<PromissoryNote[]>([]);\n  const [paymentSummary, setPaymentSummary] = useState<PaymentSummary>({\n    totalAmount: 0,\n    totalPaid: 0,\n    remainingBalance: 0,\n    overdueAmount: 0\n  });\n  \n  // Form states\n  const [newPayment, setNewPayment] = useState({\n    amount: 0,\n    paymentMethod: 'cash',\n    paymentDate: new Date().toISOString().split('T')[0],\n    notes: '',\n    referenceNumber: ''\n  });\n  \n  const [newPromissoryNote, setNewPromissoryNote] = useState({\n    amount: 0,\n    dueDate: '',\n    description: '',\n    noteNumber: ''\n  });\n\n  // Load payment data (using mock data for now until API endpoints are documented)\n  const loadPaymentData = async () => {\n    if (!sale.id) return;\n    \n    setIsLoading(true);\n    try {\n      // TODO: Replace with actual API calls once payment endpoints are documented in OpenAPI\n      // Mock payment records\n      const mockPayments: PaymentRecord[] = [\n        {\n          id: '1',\n          amount: 1000,\n          paymentDate: '2024-01-15',\n          paymentMethod: 'cash',\n          status: 'paid',\n          notes: 'Peşin ödeme',\n          referenceNumber: 'CASH001'\n        },\n        {\n          id: '2',\n          amount: 500,\n          paymentDate: '2024-02-15',\n          paymentMethod: 'card',\n          status: 'paid',\n          notes: 'Kredi kartı ile ödeme',\n          referenceNumber: 'CARD002'\n        }\n      ];\n      \n      // Mock installments\n      const mockInstallments: Installment[] = [\n        {\n          id: '1',\n          installmentNumber: 1,\n          amount: 1000,\n          dueDate: '2024-01-15',\n          status: 'paid',\n          paidDate: '2024-01-15',\n          notes: 'İlk taksit'\n        },\n        {\n          id: '2',\n          installmentNumber: 2,\n          amount: 1000,\n          dueDate: '2024-02-15',\n          status: 'paid',\n          paidDate: '2024-02-15',\n          notes: 'İkinci taksit'\n        },\n        {\n          id: '3',\n          installmentNumber: 3,\n          amount: 1000,\n          dueDate: '2024-03-15',\n          status: 'pending',\n          notes: 'Üçüncü taksit'\n        },\n        {\n          id: '4',\n          installmentNumber: 4,\n          amount: 1000,\n          dueDate: '2024-04-15',\n          status: 'pending',\n          notes: 'Dördüncü taksit'\n        }\n      ];\n      \n      setPaymentRecords(mockPayments);\n      setInstallments(mockInstallments);\n      \n      // Calculate summary\n      const summary = calculatePaymentSummary(mockPayments, mockInstallments);\n      setPaymentSummary(summary);\n      \n    } catch (err) {\n      console.error('Error loading payment data:', err);\n      setError('Ödeme bilgileri yüklenirken hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const calculatePaymentSummary = (payments: PaymentRecord[], installmentList: Installment[]): PaymentSummary => {\n    const totalPaid = payments\n      .filter(p => p.status === 'paid')\n      .reduce((sum, p) => sum + p.amount, 0);\n    \n    const overdueAmount = installmentList\n      .filter(i => i.status === 'overdue')\n      .reduce((sum, i) => sum + i.amount, 0);\n    \n    const nextDue = installmentList\n      .filter(i => i.status === 'pending')\n      .sort((a, b) => new Date(a.dueDate).getTime() - new Date(b.dueDate).getTime())[0];\n    \n    return {\n      totalAmount: sale.totalAmount,\n      totalPaid,\n      remainingBalance: sale.totalAmount - totalPaid,\n      overdueAmount,\n      nextDueDate: nextDue?.dueDate,\n      nextDueAmount: nextDue?.amount\n    };\n  };\n\n  // Record new payment (mock implementation until API is available)\n  const handleRecordPayment = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!sale.id) return;\n    \n    setError(null);\n    setSuccess(null);\n    \n    if (newPayment.amount <= 0) {\n      setError('Ödeme tutarı 0\\'dan büyük olmalıdır');\n      return;\n    }\n    \n    if (newPayment.amount > paymentSummary.remainingBalance) {\n      setError('Ödeme tutarı kalan bakiyeden fazla olamaz');\n      return;\n    }\n    \n    setIsLoading(true);\n    try {\n      // TODO: Replace with actual API call once payment endpoints are documented\n      // Mock payment creation\n      const newPaymentRecord: PaymentRecord = {\n        id: Date.now().toString(),\n        amount: newPayment.amount,\n        paymentDate: newPayment.paymentDate,\n        paymentMethod: newPayment.paymentMethod,\n        status: 'paid',\n        notes: newPayment.notes,\n        referenceNumber: newPayment.referenceNumber\n      };\n      \n      setPaymentRecords(prev => [...prev, newPaymentRecord]);\n      setSuccess('Ödeme başarıyla kaydedildi');\n      setNewPayment({\n        amount: 0,\n        paymentMethod: 'cash',\n        paymentDate: new Date().toISOString().split('T')[0],\n        notes: '',\n        referenceNumber: ''\n      });\n      \n      // Reload data\n      await loadPaymentData();\n      onPaymentUpdate();\n      \n    } catch (err) {\n      console.error('Error recording payment:', err);\n      setError('Ödeme kaydedilirken hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Pay installment (mock implementation until API is available)\n  const handlePayInstallment = async (installmentId: string, amount: number) => {\n    if (!sale.id) return;\n    \n    setIsLoading(true);\n    try {\n      // TODO: Replace with actual API call once payment endpoints are documented\n      // Mock installment payment\n      setInstallments(prev => prev.map(installment => \n        installment.id === installmentId \n          ? { ...installment, status: 'paid' as const, paidDate: new Date().toISOString().split('T')[0] }\n          : installment\n      ));\n      \n      setSuccess('Taksit ödemesi başarıyla kaydedildi');\n      await loadPaymentData();\n      onPaymentUpdate();\n      \n    } catch (err) {\n      console.error('Error paying installment:', err);\n      setError('Taksit ödemesi kaydedilirken hata oluştu');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (isOpen && sale.id) {\n      loadPaymentData();\n    }\n  }, [isOpen, sale.id]);\n\n  if (!isOpen) return null;\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig = {\n      paid: { color: 'bg-green-100 text-green-800', label: 'Ödendi' },\n      pending: { color: 'bg-yellow-100 text-yellow-800', label: 'Bekliyor' },\n      overdue: { color: 'bg-red-100 text-red-800', label: 'Gecikmiş' },\n      cancelled: { color: 'bg-gray-100 text-gray-800', label: 'İptal' },\n      active: { color: 'bg-blue-100 text-blue-800', label: 'Aktif' }\n    };\n    \n    const config = statusConfig[status as keyof typeof statusConfig] || statusConfig.pending;\n    return (\n      <Badge className={`${config.color} text-xs px-2 py-1`}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <CreditCard className=\"w-5 h-5 mr-2\" />\n            Ödeme Takibi - Satış #{sale.id}\n          </h3>\n          <Button onClick={onClose} className=\"p-1 text-gray-400 hover:text-gray-600\">\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Error and Success Messages */}\n        {error && (\n          <Alert className=\"mb-4 bg-red-50 border-red-200 text-red-800\">\n            <AlertCircle className=\"w-4 h-4\" />\n            <span>{error}</span>\n          </Alert>\n        )}\n\n        {success && (\n          <Alert className=\"mb-4 bg-green-50 border-green-200 text-green-800\">\n            <CheckCircle className=\"w-4 h-4\" />\n            <span>{success}</span>\n          </Alert>\n        )}\n\n        {/* Payment Summary */}\n        <div className=\"grid grid-cols-4 gap-4 mb-6\">\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"text-sm text-gray-600\">Toplam Tutar</div>\n              <div className=\"text-2xl font-bold text-gray-900\">\n                {formatCurrency(paymentSummary.totalAmount)}\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"text-sm text-gray-600\">Ödenen</div>\n              <div className=\"text-2xl font-bold text-green-600\">\n                {formatCurrency(paymentSummary.totalPaid)}\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"text-sm text-gray-600\">Kalan</div>\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {formatCurrency(paymentSummary.remainingBalance)}\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"text-sm text-gray-600\">Gecikmiş</div>\n              <div className=\"text-2xl font-bold text-red-600\">\n                {formatCurrency(paymentSummary.overdueAmount)}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Next Due Alert */}\n        {paymentSummary.nextDueDate && (\n          <Alert className=\"mb-4 bg-yellow-50 border-yellow-200 text-yellow-800\">\n            <Clock className=\"w-4 h-4\" />\n            <span>\n              Sonraki ödeme: {formatDate(paymentSummary.nextDueDate)} - {formatCurrency(paymentSummary.nextDueAmount || 0)}\n            </span>\n          </Alert>\n        )}\n\n        {/* Tabs */}\n        <div className=\"border-b border-gray-200 mb-6\">\n          <nav className=\"-mb-px flex space-x-8\">\n            {[\n              { key: 'payments', label: 'Ödemeler', icon: DollarSign },\n              { key: 'installments', label: 'Taksitler', icon: Calendar },\n              { key: 'promissory', label: 'Senetler', icon: FileText }\n            ].map(({ key, label, icon: Icon }) => (\n              <button\n                key={key}\n                onClick={() => setActiveTab(key as any)}\n                className={`py-2 px-1 border-b-2 font-medium text-sm flex items-center ${\n                  activeTab === key\n                    ? 'border-blue-500 text-blue-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                <Icon className=\"w-4 h-4 mr-2\" />\n                {label}\n              </button>\n            ))}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        {activeTab === 'payments' && (\n          <div className=\"space-y-6\">\n            {/* New Payment Form */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Yeni Ödeme Kaydet\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleRecordPayment} className=\"space-y-4\">\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div>\n                      <Label>Tutar</Label>\n                      <Input\n                        type=\"number\"\n                        step=\"0.01\"\n                        value={newPayment.amount}\n                        onChange={(e) => setNewPayment(prev => ({ ...prev, amount: parseFloat(e.target.value) || 0 }))}\n                        placeholder=\"0.00\"\n                        required\n                      />\n                    </div>\n                    <div>\n                      <Label>Ödeme Yöntemi</Label>\n                      <select\n                        value={newPayment.paymentMethod}\n                        onChange={(e) => setNewPayment(prev => ({ ...prev, paymentMethod: e.target.value }))}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      >\n                        <option value=\"cash\">Nakit</option>\n                        <option value=\"card\">Kredi Kartı</option>\n                        <option value=\"bank_transfer\">Havale</option>\n                        <option value=\"check\">Çek</option>\n                      </select>\n                    </div>\n                    <div>\n                      <Label>Ödeme Tarihi</Label>\n                      <Input\n                        type=\"date\"\n                        value={newPayment.paymentDate}\n                        onChange={(e) => setNewPayment(prev => ({ ...prev, paymentDate: e.target.value }))}\n                        required\n                      />\n                    </div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label>Referans No</Label>\n                      <Input\n                        value={newPayment.referenceNumber}\n                        onChange={(e) => setNewPayment(prev => ({ ...prev, referenceNumber: e.target.value }))}\n                        placeholder=\"İşlem numarası, çek no, vb.\"\n                      />\n                    </div>\n                    <div>\n                      <Label>Notlar</Label>\n                      <Input\n                        value={newPayment.notes}\n                        onChange={(e) => setNewPayment(prev => ({ ...prev, notes: e.target.value }))}\n                        placeholder=\"Ödeme notları\"\n                      />\n                    </div>\n                  </div>\n                  \n                  <Button type=\"submit\" disabled={isLoading} className=\"w-full\">\n                    {isLoading && <Spinner className=\"w-4 h-4 mr-2\" />}\n                    Ödeme Kaydet\n                  </Button>\n                </form>\n              </CardContent>\n            </Card>\n\n            {/* Payment Records */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Ödeme Geçmişi</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {paymentRecords.length === 0 ? (\n                  <div className=\"text-center py-8 text-gray-500\">\n                    Henüz ödeme kaydı bulunmuyor\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {paymentRecords.map((payment) => (\n                      <div key={payment.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                        <div className=\"flex items-center space-x-4\">\n                          <div className=\"text-lg font-medium\">\n                            {formatCurrency(payment.amount)}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">\n                            {formatDate(payment.paymentDate)}\n                          </div>\n                          <div className=\"text-sm text-gray-600 capitalize\">\n                            {payment.paymentMethod}\n                          </div>\n                          {payment.referenceNumber && (\n                            <div className=\"text-xs text-gray-500\">\n                              Ref: {payment.referenceNumber}\n                            </div>\n                          )}\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          {getStatusBadge(payment.status)}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {activeTab === 'installments' && (\n          <div className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Taksit Planı</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {installments.length === 0 ? (\n                  <div className=\"text-center py-8 text-gray-500\">\n                    Taksit planı bulunmuyor\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {installments.map((installment) => (\n                      <div key={installment.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                        <div className=\"flex items-center space-x-4\">\n                          <div className=\"text-sm font-medium\">\n                            Taksit {installment.installmentNumber}\n                          </div>\n                          <div className=\"text-lg font-medium\">\n                            {formatCurrency(installment.amount)}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">\n                            Vade: {formatDate(installment.dueDate)}\n                          </div>\n                          {installment.paidDate && (\n                            <div className=\"text-sm text-green-600\">\n                              Ödendi: {formatDate(installment.paidDate)}\n                            </div>\n                          )}\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          {getStatusBadge(installment.status)}\n                          {installment.status === 'pending' && (\n                            <Button\n                              size=\"sm\"\n                              onClick={() => handlePayInstallment(installment.id, installment.amount)}\n                              disabled={isLoading}\n                            >\n                              Öde\n                            </Button>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {activeTab === 'promissory' && (\n          <div className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Yeni Senet Ekle\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label>Senet Tutarı</Label>\n                    <Input\n                      type=\"number\"\n                      step=\"0.01\"\n                      value={newPromissoryNote.amount}\n                      onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, amount: parseFloat(e.target.value) || 0 }))}\n                      placeholder=\"0.00\"\n                    />\n                  </div>\n                  <div>\n                    <Label>Vade Tarihi</Label>\n                    <Input\n                      type=\"date\"\n                      value={newPromissoryNote.dueDate}\n                      onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, dueDate: e.target.value }))}\n                    />\n                  </div>\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-4 mt-4\">\n                  <div>\n                    <Label>Senet Numarası</Label>\n                    <Input\n                      value={newPromissoryNote.noteNumber}\n                      onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, noteNumber: e.target.value }))}\n                      placeholder=\"Senet numarası\"\n                    />\n                  </div>\n                  <div>\n                    <Label>Açıklama</Label>\n                    <Input\n                      value={newPromissoryNote.description}\n                      onChange={(e) => setNewPromissoryNote(prev => ({ ...prev, description: e.target.value }))}\n                      placeholder=\"Senet açıklaması\"\n                    />\n                  </div>\n                </div>\n                \n                <Button className=\"w-full mt-4\" disabled={isLoading}>\n                  {isLoading && <Spinner className=\"w-4 h-4 mr-2\" />}\n                  Senet Ekle\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Senet Listesi</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {promissoryNotes.length === 0 ? (\n                  <div className=\"text-center py-8 text-gray-500\">\n                    Senet bulunmuyor\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {promissoryNotes.map((note) => (\n                      <div key={note.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                        <div className=\"flex items-center space-x-4\">\n                          <div className=\"text-sm font-medium\">\n                            {note.noteNumber}\n                          </div>\n                          <div className=\"text-lg font-medium\">\n                            {formatCurrency(note.amount)}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">\n                            Vade: {formatDate(note.dueDate)}\n                          </div>\n                          {note.description && (\n                            <div className=\"text-sm text-gray-500\">\n                              {note.description}\n                            </div>\n                          )}\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          {getStatusBadge(note.status)}\n                          <Button size=\"sm\" variant=\"outline\">\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Footer */}\n        <div className=\"flex justify-end space-x-3 mt-6 pt-6 border-t\">\n          <Button onClick={onClose} variant=\"outline\">\n            Kapat\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PaymentTrackingModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/purchases/PurchaseList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'compact' is assigned a value but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":10}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input } from '@x-ear/ui-web';\nimport { useState, useEffect } from 'react';\nimport { Purchase, PurchaseFilters, PurchaseStatus } from '../../types/purchase';\nimport { purchaseService } from '../../services/purchase.service';\n\ninterface PurchaseListProps {\n  onPurchaseSelect?: (purchase: Purchase) => void;\n  filters?: PurchaseFilters;\n  showActions?: boolean;\n  compact?: boolean;\n}\n\nexport function PurchaseList({ \n  onPurchaseSelect, \n  filters = {}, \n  showActions = false, \n  compact = false \n}: PurchaseListProps) {\n  const [purchases, setPurchases] = useState<Purchase[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedPurchase, setSelectedPurchase] = useState<Purchase | null>(null);\n\n  // Load purchases using the service\n  useEffect(() => {\n    const loadPurchases = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        // Use the purchase service to load purchases\n        const result = await purchaseService.searchPurchases(filters);\n        setPurchases(result.purchases);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Alış faturaları yüklenirken hata oluştu');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadPurchases();\n  }, [filters]);\n\n  const handlePurchaseClick = (purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    onPurchaseSelect?.(purchase);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const getStatusColor = (status: PurchaseStatus) => {\n    switch (status) {\n      case 'draft': return 'bg-gray-100 text-gray-800';\n      case 'sent': return 'bg-blue-100 text-blue-800';\n      case 'approved': return 'bg-green-100 text-green-800';\n      case 'rejected': return 'bg-red-100 text-red-800';\n      case 'paid': return 'bg-purple-100 text-purple-800';\n      case 'cancelled': return 'bg-gray-100 text-gray-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusText = (status: PurchaseStatus) => {\n    switch (status) {\n      case 'draft': return 'Taslak';\n      case 'sent': return 'Gönderildi';\n      case 'approved': return 'Onaylandı';\n      case 'rejected': return 'Reddedildi';\n      case 'paid': return 'Ödendi';\n      case 'cancelled': return 'İptal';\n      default: return status;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-2 text-gray-600\">Alış faturaları yükleniyor...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n        <div className=\"flex\">\n          <div className=\"flex-shrink-0\">\n            <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n          <div className=\"ml-3\">\n            <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n            <div className=\"mt-2 text-sm text-red-700\">\n              <p>{error}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Search */}\n      <div className=\"flex items-center space-x-4\">\n        <div className=\"flex-1\">\n          <Input\n            type=\"text\"\n            placeholder=\"Alış faturası ara...\"\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          />\n        </div>\n      </div>\n      {/* Purchase List */}\n      <div className=\"bg-white shadow overflow-hidden sm:rounded-md\">\n        <ul className=\"divide-y divide-gray-200\">\n          {purchases.length === 0 ? (\n            <li className=\"px-6 py-8 text-center text-gray-500\">\n              <div className=\"text-center\">\n                <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                </svg>\n                <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Alış faturası bulunamadı</h3>\n                <p className=\"mt-1 text-sm text-gray-500\">\n                  Henüz XML formatında alış faturası import edilmemiş.\n                </p>\n              </div>\n            </li>\n          ) : (\n            purchases.map((purchase) => (\n              <li\n                key={purchase.id}\n                className={`px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors ${\n                  selectedPurchase?.id === purchase.id ? 'bg-blue-50' : ''\n                }`}\n                onClick={() => handlePurchaseClick(purchase)}\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center space-x-2\">\n                          <p className=\"text-sm font-medium text-gray-900 truncate\">\n                            {purchase.purchaseNumber}\n                          </p>\n                          <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusColor(purchase.status)}`}>\n                            {getStatusText(purchase.status)}\n                          </span>\n                          {purchase.xmlFileName && (\n                            <span className=\"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800\">\n                              XML\n                            </span>\n                          )}\n                        </div>\n                        <div className=\"mt-1 flex items-center space-x-4 text-sm text-gray-500\">\n                          <span>{purchase.supplierName}</span>\n                          {purchase.supplierTaxNumber && (\n                            <span>VN: {purchase.supplierTaxNumber}</span>\n                          )}\n                          <span>{formatDate(purchase.issueDate)}</span>\n                          {purchase.dueDate && (\n                            <span>Vade: {formatDate(purchase.dueDate)}</span>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"text-right\">\n                      <p className=\"text-sm font-medium text-gray-900\">\n                        {formatCurrency(purchase.grandTotal)}\n                      </p>\n                      <p className=\"text-xs text-gray-500\">\n                        {purchase.items.length} kalem\n                      </p>\n                    </div>\n                    \n                    {showActions && (\n                      <div className=\"flex items-center space-x-2\">\n                        {/* Status Actions */}\n                        {purchase.status === 'draft' && (\n                          <Button\n                            className=\"text-blue-600 hover:text-blue-900 text-sm font-medium\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              // Handle approve action\n                            }}\n                            variant='default'>\n                            Onayla\n                          </Button>\n                        )}\n                        \n                        {purchase.status === 'approved' && (\n                          <Button\n                            className=\"text-green-600 hover:text-green-900 text-sm font-medium\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              // Handle pay action\n                            }}\n                            variant='default'>\n                            Öde\n                          </Button>\n                        )}\n                        \n                        <Button\n                          className=\"text-gray-400 hover:text-gray-600\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            // Handle more actions\n                          }}\n                          variant='default'>\n                          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path d=\"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z\" />\n                          </svg>\n                        </Button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </li>\n            ))\n          )}\n        </ul>\n      </div>\n      {/* Pagination */}\n      {purchases.length > 0 && (\n        <div className=\"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6\">\n          <div className=\"flex-1 flex justify-between sm:hidden\">\n            <Button\n              className=\"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\n              variant='default'>\n              Önceki\n            </Button>\n            <Button\n              className=\"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\n              variant='default'>\n              Sonraki\n            </Button>\n          </div>\n          <div className=\"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-700\">\n                Toplam <span className=\"font-medium\">{purchases.length}</span> alış faturası\n              </p>\n            </div>\n            <div>\n              <nav className=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\" aria-label=\"Pagination\">\n                <Button\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  variant='default'>\n                  Önceki\n                </Button>\n                <Button\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  variant='default'>\n                  Sonraki\n                </Button>\n              </nav>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/BulkUploadModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Input' is defined but never used.","line":2,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[390,393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[390,393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'response' is assigned a value but never used.","line":109,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":21},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":159,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":167,"endColumn":13}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useRef } from 'react';\nimport { Modal, Button, Input } from '@x-ear/ui-web';\nimport { useUploadSgkDocuments } from '../../hooks/sgk/useSgkDocuments';\nimport { Upload, X, FileImage, AlertCircle } from 'lucide-react';\n\ninterface BulkUploadModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onUploadStart: () => void;\n  onUploadComplete: (results: any[]) => void;\n}\n\nconst BulkUploadModal: React.FC<BulkUploadModalProps> = ({\n  isOpen,\n  onClose,\n  onUploadStart,\n  onUploadComplete,\n}) => {\n  const [files, setFiles] = useState<File[]>([]);\n  const [isUploading, setIsUploading] = useState(false);\n  const [isDragOver, setIsDragOver] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const uploadMutation = useUploadSgkDocuments();\n\n  const validateFile = (file: File): boolean => {\n    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/tiff', 'image/bmp'];\n    const maxSize = 10 * 1024 * 1024; // 10MB\n\n    if (!allowedTypes.includes(file.type)) {\n      setError(`Desteklenmeyen dosya türü: ${file.name}`);\n      return false;\n    }\n\n    if (file.size > maxSize) {\n      setError(`Dosya çok büyük: ${file.name} (Max: 10MB)`);\n      return false;\n    }\n\n    return true;\n  };\n\n  const handleFileSelect = useCallback((selectedFiles: File[]) => {\n    setError(null);\n    const validFiles: File[] = [];\n    \n    for (const file of selectedFiles) {\n      if (validateFile(file)) {\n        validFiles.push(file);\n      } else {\n        return; // Stop processing if any file is invalid\n      }\n    }\n\n    // Remove duplicates based on name and size\n    const uniqueFiles = validFiles.filter(newFile => \n      !files.some(existingFile => \n        existingFile.name === newFile.name && existingFile.size === newFile.size\n      )\n    );\n\n    setFiles(prev => [...prev, ...uniqueFiles]);\n  }, [files]);\n\n  const handleInputChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFiles = Array.from(e.target.files || []);\n    handleFileSelect(selectedFiles);\n  }, [handleFileSelect]);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(true);\n  }, []);\n\n  const handleDragLeave = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(false);\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(false);\n\n    const droppedFiles = Array.from(e.dataTransfer.files);\n    handleFileSelect(droppedFiles);\n  }, [handleFileSelect]);\n\n  const removeFile = useCallback((index: number) => {\n    setFiles(prev => prev.filter((_, i) => i !== index));\n    setError(null);\n  }, []);\n\n  const handleUpload = async () => {\n    if (files.length === 0) return;\n\n    setIsUploading(true);\n    setError(null);\n    onUploadStart();\n\n    try {\n      const formData = new FormData();\n      files.forEach(file => {\n        formData.append('files', file);\n      });\n\n      const response = await uploadMutation.mutateAsync(formData);\n      onUploadComplete([]);\n    } catch (error) {\n      console.error('Upload failed:', error);\n      setError('Yükleme sırasında bir hata oluştu. Lütfen tekrar deneyin.');\n      onUploadComplete([]);\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (!isUploading) {\n      setFiles([]);\n      setError(null);\n      setIsDragOver(false);\n      onClose();\n    }\n  };\n\n  const openFileDialog = () => {\n    fileInputRef.current?.click();\n  };\n\n  return (\n    <Modal isOpen={isOpen} onClose={handleClose} title=\"SGK Dokümanlarını Yükle\" size=\"lg\">\n      <div className=\"space-y-6\">\n        {/* Drag and Drop Area */}\n        <div\n          className={`\n            border-2 border-dashed rounded-lg p-8 text-center transition-colors\n            ${isDragOver \n              ? 'border-blue-400 bg-blue-50' \n              : 'border-gray-300 hover:border-gray-400'\n            }\n            ${isUploading ? 'opacity-50 pointer-events-none' : 'cursor-pointer'}\n          `}\n          onDragOver={handleDragOver}\n          onDragLeave={handleDragLeave}\n          onDrop={handleDrop}\n          onClick={openFileDialog}\n        >\n          <Upload className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n          <p className=\"text-lg font-medium text-gray-900 mb-2\">\n            Dosyaları buraya sürükleyin veya seçmek için tıklayın\n          </p>\n          <p className=\"text-sm text-gray-500\">\n            JPEG, PNG, TIFF, BMP formatlarında, maksimum 10MB boyutunda dosyalar\n          </p>\n          \n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            multiple\n            accept=\"image/*\"\n            onChange={handleInputChange}\n            disabled={isUploading}\n            className=\"hidden\"\n          />\n        </div>\n\n        {/* Error Message */}\n        {error && (\n          <div className=\"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-md\">\n            <AlertCircle className=\"h-5 w-5 text-red-500 flex-shrink-0\" />\n            <p className=\"text-sm text-red-700\">{error}</p>\n          </div>\n        )}\n\n        {/* Selected Files */}\n        {files.length > 0 && (\n          <div>\n            <h4 className=\"text-sm font-medium mb-3\">\n              Seçilen Dosyalar ({files.length})\n            </h4>\n            <div className=\"max-h-48 overflow-y-auto space-y-2\">\n              {files.map((file, index) => (\n                <div\n                  key={`${file.name}-${index}`}\n                  className=\"flex items-center justify-between p-3 bg-gray-50 rounded-md\"\n                >\n                  <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                    <FileImage className=\"h-5 w-5 text-gray-400 flex-shrink-0\" />\n                    <div className=\"min-w-0 flex-1\">\n                      <p className=\"text-sm font-medium text-gray-900 truncate\">\n                        {file.name}\n                      </p>\n                      <p className=\"text-xs text-gray-500\">\n                        {(file.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                    </div>\n                  </div>\n                  {!isUploading && (\n                    <Button\n                      type=\"button\"\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => removeFile(index)}\n                      className=\"text-gray-400 hover:text-red-500 p-1\"\n                    >\n                      <X className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"flex items-center justify-end gap-3 pt-4 border-t\">\n          <Button\n            type=\"button\"\n            variant=\"ghost\"\n            onClick={handleClose}\n            disabled={isUploading}\n          >\n            İptal\n          </Button>\n          <Button\n            onClick={handleUpload}\n            disabled={files.length === 0 || isUploading}\n            className=\"min-w-[120px]\"\n          >\n            {isUploading ? (\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                Yükleniyor...\n              </div>\n            ) : (\n              `Yükle (${files.length} dosya)`\n            )}\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default BulkUploadModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/CameraCapture.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Square' is defined but never used.","line":3,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":45},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":59,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1794,1797],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1794,1797],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2502,2505],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2502,2505],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2657,2660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2657,2660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useCallback, useEffect } from 'react';\nimport { Modal, Button } from '@x-ear/ui-web';\nimport { Camera, X, RotateCcw, Check, Square, Zap, ZapOff } from 'lucide-react';\n\ninterface CameraCaptureProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCapture: (images: File[]) => void;\n  maxImages?: number;\n}\n\ninterface CapturedImage {\n  id: string;\n  dataUrl: string;\n  timestamp: number;\n  processed?: boolean;\n}\n\nconst CameraCapture: React.FC<CameraCaptureProps> = ({\n  isOpen,\n  onClose,\n  onCapture,\n  maxImages = 10,\n}) => {\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const streamRef = useRef<MediaStream | null>(null);\n  \n  const [isStreaming, setIsStreaming] = useState(false);\n  const [capturedImages, setCapturedImages] = useState<CapturedImage[]>([]);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [flashEnabled, setFlashEnabled] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Start camera stream\n  const startCamera = useCallback(async () => {\n    try {\n      setError(null);\n      const constraints: MediaStreamConstraints = {\n        video: {\n          facingMode: 'environment', // Use back camera\n          width: { ideal: 1920 },\n          height: { ideal: 1080 },\n        },\n        audio: false,\n      };\n\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      streamRef.current = stream;\n      \n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        videoRef.current.play();\n        setIsStreaming(true);\n      }\n\n      // Try to enable flash if available\n      const videoTrack = stream.getVideoTracks()[0];\n      const capabilities = videoTrack.getCapabilities() as any;\n      if (capabilities.torch) {\n        setFlashEnabled(false);\n      }\n    } catch (err) {\n      console.error('Camera access failed:', err);\n      setError('Kameraya erişim sağlanamadı. Lütfen kamera izinlerini kontrol edin.');\n    }\n  }, []);\n\n  // Stop camera stream\n  const stopCamera = useCallback(() => {\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n    }\n    setIsStreaming(false);\n  }, []);\n\n  // Toggle flash\n  const toggleFlash = useCallback(async () => {\n    if (streamRef.current) {\n      const videoTrack = streamRef.current.getVideoTracks()[0];\n      const capabilities = videoTrack.getCapabilities() as any;\n      \n      if (capabilities.torch) {\n        try {\n          await videoTrack.applyConstraints({\n            advanced: [{ torch: !flashEnabled } as any]\n          });\n          setFlashEnabled(!flashEnabled);\n        } catch (err) {\n          console.error('Flash toggle failed:', err);\n        }\n      }\n    }\n  }, [flashEnabled]);\n\n  // Capture image with edge detection\n  const captureImage = useCallback(async () => {\n    if (!videoRef.current || !canvasRef.current) return;\n\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    \n    if (!ctx) return;\n\n    // Set canvas size to video dimensions\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n\n    // Draw current video frame\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n    // Get image data\n    const dataUrl = canvas.toDataURL('image/jpeg', 0.9);\n    \n    const newImage: CapturedImage = {\n      id: `img_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      dataUrl,\n      timestamp: Date.now(),\n      processed: false,\n    };\n\n    setCapturedImages(prev => [...prev, newImage]);\n\n    // Auto-process for edge detection (placeholder for now)\n    setTimeout(() => {\n      setCapturedImages(prev => \n        prev.map(img => \n          img.id === newImage.id \n            ? { ...img, processed: true }\n            : img\n        )\n      );\n    }, 1000);\n\n  }, []);\n\n  // Remove captured image\n  const removeImage = useCallback((imageId: string) => {\n    setCapturedImages(prev => prev.filter(img => img.id !== imageId));\n  }, []);\n\n  // Process and return captured images\n  const processImages = useCallback(async () => {\n    if (capturedImages.length === 0) return;\n    \n    setIsProcessing(true);\n    try {\n      // Simulate processing time\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      // Convert data URLs to File objects\n      const processedFiles = await Promise.all(\n        capturedImages.map(async (img, index) => {\n          const response = await fetch(img.dataUrl);\n          const blob = await response.blob();\n          return new File([blob], `captured-image-${index + 1}.jpg`, { type: 'image/jpeg' });\n        })\n      );\n      \n      onCapture(processedFiles);\n      \n      // Reset state\n      setCapturedImages([]);\n      stopCamera();\n      onClose();\n    } catch (err) {\n      console.error('Image processing failed:', err);\n      setError('Görsel işleme sırasında hata oluştu.');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [capturedImages, onCapture, stopCamera, onClose]);\n\n  // Handle modal open/close\n  useEffect(() => {\n    if (isOpen) {\n      startCamera();\n    } else {\n      stopCamera();\n      setCapturedImages([]);\n      setError(null);\n    }\n\n    return () => {\n      stopCamera();\n    };\n  }, [isOpen, startCamera, stopCamera]);\n\n  const handleClose = () => {\n    if (!isProcessing) {\n      stopCamera();\n      onClose();\n    }\n  };\n\n  return (\n    <Modal \n      isOpen={isOpen} \n      onClose={handleClose} \n      title=\"Belge Fotoğrafı Çek\"\n      size=\"lg\"\n    >\n      <div className=\"space-y-4\">\n        {error && (\n          <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg\">\n            <p className=\"text-red-700 text-sm\">{error}</p>\n          </div>\n        )}\n\n        {/* Camera View */}\n        <div className=\"relative bg-black rounded-lg overflow-hidden\" style={{ aspectRatio: '16/9' }}>\n          <video\n            ref={videoRef}\n            className=\"w-full h-full object-cover\"\n            playsInline\n            muted\n          />\n          \n          {/* Camera overlay */}\n          <div className=\"absolute inset-0 pointer-events-none\">\n            {/* Document frame guide */}\n            <div className=\"absolute inset-4 border-2 border-white border-dashed opacity-50 rounded-lg\" />\n            \n            {/* Corner guides */}\n            <div className=\"absolute top-4 left-4 w-6 h-6 border-l-4 border-t-4 border-white\" />\n            <div className=\"absolute top-4 right-4 w-6 h-6 border-r-4 border-t-4 border-white\" />\n            <div className=\"absolute bottom-4 left-4 w-6 h-6 border-l-4 border-b-4 border-white\" />\n            <div className=\"absolute bottom-4 right-4 w-6 h-6 border-r-4 border-b-4 border-white\" />\n          </div>\n\n          {/* Camera controls */}\n          <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center gap-4\">\n            {/* Flash toggle */}\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={toggleFlash}\n              className=\"bg-black/50 text-white hover:bg-black/70\"\n            >\n              {flashEnabled ? <Zap className=\"w-5 h-5\" /> : <ZapOff className=\"w-5 h-5\" />}\n            </Button>\n\n            {/* Capture button */}\n            <Button\n              onClick={captureImage}\n              disabled={!isStreaming || capturedImages.length >= maxImages}\n              className=\"bg-white text-black hover:bg-gray-100 rounded-full w-16 h-16\"\n            >\n              <Camera className=\"w-6 h-6\" />\n            </Button>\n\n            {/* Image counter */}\n            <div className=\"bg-black/50 text-white px-3 py-1 rounded-full text-sm\">\n              {capturedImages.length}/{maxImages}\n            </div>\n          </div>\n        </div>\n\n        {/* Captured images preview */}\n        {capturedImages.length > 0 && (\n          <div>\n            <h4 className=\"text-sm font-medium mb-2\">\n              Çekilen Fotoğraflar ({capturedImages.length})\n            </h4>\n            <div className=\"flex gap-2 overflow-x-auto pb-2\">\n              {capturedImages.map((image) => (\n                <div key={image.id} className=\"relative flex-shrink-0\">\n                  <img\n                    src={image.dataUrl}\n                    alt=\"Captured\"\n                    className=\"w-20 h-20 object-cover rounded-lg border\"\n                  />\n                  \n                  {/* Processing indicator */}\n                  {!image.processed && (\n                    <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg\">\n                      <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                    </div>\n                  )}\n\n                  {/* Remove button */}\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => removeImage(image.id)}\n                    className=\"absolute -top-2 -right-2 w-6 h-6 p-0 bg-red-500 text-white hover:bg-red-600 rounded-full\"\n                  >\n                    <X className=\"w-3 h-3\" />\n                  </Button>\n\n                  {/* Processed indicator */}\n                  {image.processed && (\n                    <div className=\"absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center\">\n                      <Check className=\"w-3 h-3\" />\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Instructions */}\n        <div className=\"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg\">\n          <p className=\"font-medium mb-1\">Kullanım Talimatları:</p>\n          <ul className=\"list-disc list-inside space-y-1 text-xs\">\n            <li>Belgeyi beyaz çerçeve içine yerleştirin</li>\n            <li>Belgenin tüm kenarlarının görünür olduğundan emin olun</li>\n            <li>Işık yetersizse flaşı açın</li>\n            <li>Her fotoğraf otomatik olarak kırpılacak ve işlenecek</li>\n          </ul>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex items-center justify-between pt-4 border-t\">\n          <Button\n            variant=\"ghost\"\n            onClick={handleClose}\n            disabled={isProcessing}\n          >\n            İptal\n          </Button>\n          \n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setCapturedImages([])}\n              disabled={capturedImages.length === 0 || isProcessing}\n            >\n              <RotateCcw className=\"w-4 h-4 mr-2\" />\n              Temizle\n            </Button>\n            \n            <Button\n              onClick={processImages}\n              disabled={capturedImages.length === 0 || isProcessing}\n            >\n              {isProcessing ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                  İşleniyor...\n                </>\n              ) : (\n                <>\n                  <Check className=\"w-4 h-4 mr-2\" />\n                  Tamamla ({capturedImages.length} fotoğraf)\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* Hidden canvas for image capture */}\n      <canvas ref={canvasRef} className=\"hidden\" />\n    </Modal>\n  );\n};\n\nexport default CameraCapture;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/DocumentGallery.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ZoomIn' is defined but never used.","line":2,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":78},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ZoomOut' is defined but never used.","line":2,"column":80,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":87},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'X' is defined but never used.","line":2,"column":89,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":90},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronLeft' is defined but never used.","line":2,"column":92,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":103},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronRight' is defined but never used.","line":2,"column":105,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":117},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MoreVertical' is defined but never used.","line":2,"column":162,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":174},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SortAsc' is defined but never used.","line":2,"column":176,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":183},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SortDesc' is defined but never used.","line":2,"column":185,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":193},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckSquare' is defined but never used.","line":2,"column":195,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":206},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Square' is defined but never used.","line":2,"column":208,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":214},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'RefreshCw' is defined but never used.","line":2,"column":216,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":225},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Calendar' is defined but never used.","line":2,"column":227,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":235},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'HardDrive' is defined but never used.","line":2,"column":237,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":246},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'User' is defined but never used.","line":2,"column":248,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":252},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onDocumentSelect' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onDocumentDelete' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":19},{"ruleId":"prefer-const","severity":2,"message":"'filtered' is never reassigned. Use 'const' instead.","line":47,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":47,"endColumn":17,"fix":{"range":[2201,3504],"text":"const filtered = documents.filter(doc => {\n      // Search filter\n      const matchesSearch = doc.filename.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           (doc.ocrText && doc.ocrText.toLowerCase().includes(searchTerm.toLowerCase()));\n      \n      // Type filter\n      const matchesType = selectedType === 'all' || doc.documentType === selectedType;\n      \n      // Status filter\n      const matchesStatus = selectedStatus === 'all' || doc.processingStatus === selectedStatus;\n      \n      // Date range filter\n      let matchesDateRange = true;\n      if (dateRange.start || dateRange.end) {\n        const docDate = new Date(doc.uploadedAt);\n        if (dateRange.start) {\n          matchesDateRange = matchesDateRange && docDate >= new Date(dateRange.start);\n        }\n        if (dateRange.end) {\n          matchesDateRange = matchesDateRange && docDate <= new Date(dateRange.end);\n        }\n      }\n      \n      // File size filter (in MB)\n      let matchesFileSize = true;\n      if (doc.fileSize) {\n        const fileSizeMB = doc.fileSize / (1024 * 1024);\n        matchesFileSize = fileSizeMB >= fileSizeRange.min && fileSizeMB <= fileSizeRange.max;\n      }\n      \n      return matchesSearch && matchesType && matchesStatus && matchesDateRange && matchesFileSize;\n    });"}},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":288,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":294,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":298,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":310,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":313,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":323,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":326,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":335,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":340,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":347,"endColumn":22},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":360,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":366,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":367,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":373,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":383,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":390,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":391,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":398,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":409,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":420,"endColumn":26},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":430,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":435,"endColumn":13},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":472,"column":17,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":477,"endColumn":19},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":549,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":554,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":589,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":594,"endColumn":27}],"suppressedMessages":[],"errorCount":32,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport { Search, Grid, List, Download, Trash2, Eye, Filter, RotateCcw, ZoomIn, ZoomOut, X, ChevronLeft, ChevronRight, Clock, CheckCircle, AlertCircle, FileText, MoreVertical, SortAsc, SortDesc, CheckSquare, Square, RefreshCw, Calendar, HardDrive, User } from 'lucide-react';\nimport { Button } from '@x-ear/ui-web';\nimport DocumentViewer from './DocumentViewer';\nimport DocumentPreview from './DocumentPreview';\nimport { SGKDocument, SGKDocumentType } from '../../types/sgk';\n\ninterface DocumentGalleryProps {\n  documents: SGKDocument[];\n  onDocumentSelect?: (document: SGKDocument) => void;\n  onDocumentDelete?: (documentId: string) => void;\n  onBulkDelete?: (documentIds: string[]) => void;\n  onBulkDownload?: (documentIds: string[]) => void;\n  onRefresh?: () => void;\n  loading?: boolean;\n}\n\ntype ViewMode = 'grid' | 'list';\ntype SortBy = 'name' | 'date' | 'size' | 'type';\n\nexport const DocumentGallery: React.FC<DocumentGalleryProps> = ({\n  documents,\n  onDocumentSelect,\n  onDocumentDelete,\n  onBulkDelete,\n  onBulkDownload,\n  onRefresh,\n  loading = false\n}) => {\n  const [viewMode, setViewMode] = useState<ViewMode>('grid');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedType, setSelectedType] = useState<SGKDocumentType | 'all'>('all');\n  const [selectedStatus, setSelectedStatus] = useState<'all' | 'pending' | 'processing' | 'completed' | 'failed'>('all');\n  const [sortBy, setSortBy] = useState<SortBy>('date');\n  \n  // Advanced filters\n  const [dateRange, setDateRange] = useState<{ start: string; end: string }>({ start: '', end: '' });\n  const [fileSizeRange, setFileSizeRange] = useState<{ min: number; max: number }>({ min: 0, max: 100 });\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n  const [selectedDocuments, setSelectedDocuments] = useState<Set<string>>(new Set());\n  const [viewerDocument, setViewerDocument] = useState<SGKDocument | null>(null);\n  const [previewDocument, setPreviewDocument] = useState<SGKDocument | null>(null);\n  const [showFilters, setShowFilters] = useState(false);\n\n  // Filter and sort documents\n  const filteredDocuments = useMemo(() => {\n    let filtered = documents.filter(doc => {\n      // Search filter\n      const matchesSearch = doc.filename.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           (doc.ocrText && doc.ocrText.toLowerCase().includes(searchTerm.toLowerCase()));\n      \n      // Type filter\n      const matchesType = selectedType === 'all' || doc.documentType === selectedType;\n      \n      // Status filter\n      const matchesStatus = selectedStatus === 'all' || doc.processingStatus === selectedStatus;\n      \n      // Date range filter\n      let matchesDateRange = true;\n      if (dateRange.start || dateRange.end) {\n        const docDate = new Date(doc.uploadedAt);\n        if (dateRange.start) {\n          matchesDateRange = matchesDateRange && docDate >= new Date(dateRange.start);\n        }\n        if (dateRange.end) {\n          matchesDateRange = matchesDateRange && docDate <= new Date(dateRange.end);\n        }\n      }\n      \n      // File size filter (in MB)\n      let matchesFileSize = true;\n      if (doc.fileSize) {\n        const fileSizeMB = doc.fileSize / (1024 * 1024);\n        matchesFileSize = fileSizeMB >= fileSizeRange.min && fileSizeMB <= fileSizeRange.max;\n      }\n      \n      return matchesSearch && matchesType && matchesStatus && matchesDateRange && matchesFileSize;\n    });\n\n    // Sort documents\n    filtered.sort((a, b) => {\n      switch (sortBy) {\n        case 'name':\n          return a.filename.localeCompare(b.filename);\n        case 'size':\n          return (a.fileSize || 0) - (b.fileSize || 0);\n        case 'date':\n          return new Date(b.uploadedAt).getTime() - new Date(a.uploadedAt).getTime(); // Most recent first\n        case 'type':\n          return a.documentType.localeCompare(b.documentType);\n        default:\n          return 0;\n      }\n    });\n\n    return filtered;\n  }, [documents, searchTerm, selectedType, selectedStatus, sortBy, dateRange, fileSizeRange]);\n\n  // Handle document selection\n  const handleSelectDocument = (documentId: string) => {\n    const newSelected = new Set(selectedDocuments);\n    if (newSelected.has(documentId)) {\n      newSelected.delete(documentId);\n    } else {\n      newSelected.add(documentId);\n    }\n    setSelectedDocuments(newSelected);\n  };\n\n  const handleSelectAll = () => {\n    if (selectedDocuments.size === filteredDocuments.length) {\n      setSelectedDocuments(new Set());\n    } else {\n      setSelectedDocuments(new Set(filteredDocuments.map(doc => doc.id)));\n    }\n  };\n\n  // Bulk operations\n  const handleBulkDelete = () => {\n    if (selectedDocuments.size > 0 && onBulkDelete) {\n      onBulkDelete(Array.from(selectedDocuments));\n      setSelectedDocuments(new Set());\n    }\n  };\n\n  const handleBulkDownload = () => {\n    if (selectedDocuments.size > 0 && onBulkDownload) {\n      onBulkDownload(Array.from(selectedDocuments));\n    }\n  };\n\n  // Document actions\n  const handleViewDocument = (document: SGKDocument) => {\n    setViewerDocument(document);\n  };\n\n  const handlePreviewDocument = (document: SGKDocument) => {\n    setPreviewDocument(document);\n  };\n\n  const handleDownloadDocument = (document: SGKDocument) => {\n    if (document.fileUrl) {\n      const link = window.document.createElement('a');\n      link.href = document.fileUrl;\n      link.download = document.filename;\n      link.click();\n    }\n  };\n\n  // Get status display info\n  const getStatusInfo = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return { color: 'text-green-600 bg-green-100', icon: CheckCircle, label: 'Tamamlandı' };\n      case 'processing':\n        return { color: 'text-blue-600 bg-blue-100', icon: Clock, label: 'İşleniyor' };\n      case 'pending':\n        return { color: 'text-yellow-600 bg-yellow-100', icon: Clock, label: 'Bekliyor' };\n      case 'failed':\n        return { color: 'text-red-600 bg-red-100', icon: AlertCircle, label: 'Hata' };\n      default:\n        return { color: 'text-gray-600 bg-gray-100', icon: FileText, label: status };\n    }\n  };\n\n  // Get document type display name\n  const getDocumentTypeLabel = (type: SGKDocumentType) => {\n    const labels: Record<SGKDocumentType, string> = {\n      'recete': 'Reçete',\n      'rapor': 'Rapor',\n      'belge': 'Belge',\n      'fatura': 'Fatura',\n      'teslim': 'Teslim',\n      'iade': 'İade'\n    };\n    return labels[type] || type;\n  };\n\n  // Format file size\n  const formatFileSize = (bytes?: number) => {\n    if (!bytes) return 'N/A';\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(1024));\n    return `${(bytes / Math.pow(1024, i)).toFixed(1)} ${sizes[i]}`;\n  };\n\n  // Format date\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Header with controls */}\n      <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <h2 className=\"text-lg font-semibold\">Belgeler ({filteredDocuments.length})</h2>\n          {selectedDocuments.size > 0 && (\n            <span className=\"text-sm text-gray-500\">\n              ({selectedDocuments.size} seçili)\n            </span>\n          )}\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          {/* Bulk actions */}\n          {selectedDocuments.size > 0 && (\n            <>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleBulkDownload}\n                className=\"flex items-center gap-1\"\n              >\n                <Download className=\"w-4 h-4\" />\n                İndir ({selectedDocuments.size})\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleBulkDelete}\n                className=\"flex items-center gap-1 text-red-600 hover:text-red-700\"\n              >\n                <Trash2 className=\"w-4 h-4\" />\n                Sil ({selectedDocuments.size})\n              </Button>\n            </>\n          )}\n\n          {/* View mode toggle */}\n          <div className=\"flex border rounded-lg\">\n            <Button\n              variant={viewMode === 'grid' ? 'default' : 'ghost'}\n              size=\"sm\"\n              onClick={() => setViewMode('grid')}\n              className=\"rounded-r-none\"\n            >\n              <Grid className=\"w-4 h-4\" />\n            </Button>\n            <Button\n              variant={viewMode === 'list' ? 'default' : 'ghost'}\n              size=\"sm\"\n              onClick={() => setViewMode('list')}\n              className=\"rounded-l-none\"\n            >\n              <List className=\"w-4 h-4\" />\n            </Button>\n          </div>\n\n          {/* Filter toggle */}\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowFilters(!showFilters)}\n            className=\"flex items-center gap-1\"\n          >\n            <Filter className=\"w-4 h-4\" />\n            Filtrele\n          </Button>\n\n          {/* Refresh */}\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={onRefresh}\n            disabled={loading}\n            className=\"flex items-center gap-1\"\n          >\n            <RotateCcw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />\n            Yenile\n          </Button>\n        </div>\n      </div>\n\n      {/* Filters */}\n      {showFilters && (\n        <div className=\"bg-gray-50 p-4 rounded-lg space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            {/* Search */}\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n              <input\n                type=\"text\"\n                placeholder=\"Belge ara...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              />\n            </div>\n\n            {/* Document type filter */}\n            <select\n              value={selectedType}\n              onChange={(e) => setSelectedType(e.target.value as SGKDocumentType | 'all')}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"all\">Tüm Türler</option>\n              <option value=\"recete\">Reçete</option>\n              <option value=\"rapor\">Rapor</option>\n              <option value=\"belge\">Belge</option>\n              <option value=\"fatura\">Fatura</option>\n              <option value=\"teslim\">Teslim</option>\n              <option value=\"iade\">İade</option>\n            </select>\n\n            {/* Status filter */}\n            <select\n              value={selectedStatus}\n              onChange={(e) => setSelectedStatus(e.target.value as 'all' | 'pending' | 'processing' | 'completed' | 'failed')}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"all\">Tüm Durumlar</option>\n              <option value=\"pending\">Bekliyor</option>\n              <option value=\"processing\">İşleniyor</option>\n              <option value=\"completed\">Tamamlandı</option>\n              <option value=\"failed\">Hata</option>\n            </select>\n\n            {/* Sort by */}\n            <select\n              value={sortBy}\n              onChange={(e) => setSortBy(e.target.value as SortBy)}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"date\">Tarihe Göre</option>\n              <option value=\"name\">İsme Göre</option>\n              <option value=\"size\">Boyuta Göre</option>\n              <option value=\"type\">Türe Göre</option>\n            </select>\n          </div>\n          \n          {/* Advanced Filters Toggle */}\n          <div className=\"flex justify-between items-center\">\n            <button\n              onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\n              className=\"px-3 py-2 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors flex items-center gap-2\"\n            >\n              <Filter className=\"h-4 w-4\" />\n              Gelişmiş Filtreler\n              {showAdvancedFilters ? ' (Gizle)' : ' (Göster)'}\n            </button>\n          </div>\n          \n          {/* Advanced Filters */}\n          {showAdvancedFilters && (\n            <div className=\"border-t pt-4 space-y-4\">\n              <h3 className=\"text-sm font-medium text-gray-700\">Gelişmiş Filtreler</h3>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                {/* Date Range Filter */}\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-gray-700\">Tarih Aralığı</label>\n                  <div className=\"flex gap-2\">\n                    <input\n                      type=\"date\"\n                      value={dateRange.start}\n                      onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n                      className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      placeholder=\"Başlangıç\"\n                    />\n                    <input\n                      type=\"date\"\n                      value={dateRange.end}\n                      onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n                      className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      placeholder=\"Bitiş\"\n                    />\n                  </div>\n                </div>\n                \n                {/* File Size Filter */}\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium text-gray-700\">\n                    Dosya Boyutu (MB): {fileSizeRange.min} - {fileSizeRange.max}\n                  </label>\n                  <div className=\"flex gap-2 items-center\">\n                    <input\n                      type=\"range\"\n                      min=\"0\"\n                      max=\"100\"\n                      value={fileSizeRange.min}\n                      onChange={(e) => setFileSizeRange(prev => ({ ...prev, min: parseInt(e.target.value) }))}\n                      className=\"flex-1\"\n                    />\n                    <input\n                      type=\"range\"\n                      min=\"0\"\n                      max=\"100\"\n                      value={fileSizeRange.max}\n                      onChange={(e) => setFileSizeRange(prev => ({ ...prev, max: parseInt(e.target.value) }))}\n                      className=\"flex-1\"\n                    />\n                  </div>\n                  <div className=\"flex justify-between text-xs text-gray-500\">\n                    <span>0 MB</span>\n                    <span>100 MB</span>\n                  </div>\n                </div>\n              </div>\n              \n              {/* Clear Filters */}\n              <div className=\"flex justify-end\">\n                <button\n                  onClick={() => {\n                    setDateRange({ start: '', end: '' });\n                    setFileSizeRange({ min: 0, max: 100 });\n                    setSearchTerm('');\n                    setSelectedType('all');\n                    setSelectedStatus('all');\n                  }}\n                  className=\"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors\"\n                >\n                  Filtreleri Temizle\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Select all checkbox */}\n      {filteredDocuments.length > 0 && (\n        <div className=\"flex items-center gap-2\">\n          <input\n            type=\"checkbox\"\n            checked={selectedDocuments.size === filteredDocuments.length}\n            onChange={handleSelectAll}\n            className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n          />\n          <label className=\"text-sm text-gray-600\">\n            Tümünü seç ({filteredDocuments.length} belge)\n          </label>\n        </div>\n      )}\n\n      {/* Document grid/list */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-2 text-gray-600\">Belgeler yükleniyor...</span>\n        </div>\n      ) : filteredDocuments.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <FileText className=\"mx-auto h-12 w-12 text-gray-400\" />\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Belge bulunamadı</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">\n            {searchTerm || selectedType !== 'all' || selectedStatus !== 'all'\n              ? 'Arama kriterlerinize uygun belge bulunamadı.'\n              : 'Henüz belge yüklenmemiş.'}\n          </p>\n        </div>\n      ) : viewMode === 'grid' ? (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n          {filteredDocuments.map((document) => {\n            const statusInfo = getStatusInfo(document.processingStatus);\n            const StatusIcon = statusInfo.icon;\n\n            return (\n              <div\n                key={document.id}\n                className={`relative bg-white border rounded-lg p-4 hover:shadow-md transition-shadow ${\n                  selectedDocuments.has(document.id) ? 'ring-2 ring-blue-500' : ''\n                }`}\n              >\n                {/* Selection checkbox */}\n                <input\n                  type=\"checkbox\"\n                  checked={selectedDocuments.has(document.id)}\n                  onChange={() => handleSelectDocument(document.id)}\n                  className=\"absolute top-2 left-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n\n                {/* Document thumbnail/icon */}\n                <div className=\"flex items-center justify-center h-32 bg-gray-100 rounded-lg mb-3 mt-6\">\n                  {document.fileUrl ? (\n                    <img\n                      src={document.fileUrl}\n                      alt={document.filename}\n                      className=\"max-h-full max-w-full object-contain rounded\"\n                      onError={(e) => {\n                        e.currentTarget.style.display = 'none';\n                        e.currentTarget.nextElementSibling?.classList.remove('hidden');\n                      }}\n                    />\n                  ) : null}\n                  <FileText className=\"w-12 h-12 text-gray-400\" />\n                </div>\n\n                {/* Document info */}\n                <div className=\"space-y-2\">\n                  <h3 className=\"font-medium text-sm truncate\" title={document.filename}>\n                    {document.filename}\n                  </h3>\n\n                  <div className=\"flex items-center justify-between text-xs text-gray-500\">\n                    <span>{getDocumentTypeLabel(document.documentType)}</span>\n                    <span>{formatFileSize(document.fileSize)}</span>\n                  </div>\n\n                  <div className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${statusInfo.color}`}>\n                    <StatusIcon className=\"w-3 h-3\" />\n                    {statusInfo.label}\n                  </div>\n\n                  <div className=\"text-xs text-gray-500\">\n                    {formatDate(document.uploadedAt)}\n                  </div>\n                </div>\n\n                {/* Actions */}\n                <div className=\"flex items-center gap-1 mt-3\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => handleViewDocument(document)}\n                    className=\"flex-1 text-xs\"\n                  >\n                    <Eye className=\"w-3 h-3 mr-1\" />\n                    Görüntüle\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => handleDownloadDocument(document)}\n                    className=\"flex-1 text-xs\"\n                  >\n                    <Download className=\"w-3 h-3 mr-1\" />\n                    İndir\n                  </Button>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      ) : (\n        /* List view */\n        <div className=\"bg-white border rounded-lg overflow-hidden\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedDocuments.size === filteredDocuments.length}\n                      onChange={handleSelectAll}\n                      className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                    />\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Belge\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Tür\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Durum\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Boyut\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Tarih\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    İşlemler\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {filteredDocuments.map((document) => {\n                  const statusInfo = getStatusInfo(document.processingStatus);\n                  const StatusIcon = statusInfo.icon;\n\n                  return (\n                    <tr\n                      key={document.id}\n                      className={`hover:bg-gray-50 ${\n                        selectedDocuments.has(document.id) ? 'bg-blue-50' : ''\n                      }`}\n                    >\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedDocuments.has(document.id)}\n                          onChange={() => handleSelectDocument(document.id)}\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                        />\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"flex items-center\">\n                          <FileText className=\"w-5 h-5 text-gray-400 mr-3\" />\n                          <div>\n                            <div className=\"text-sm font-medium text-gray-900 truncate max-w-xs\">\n                              {document.filename}\n                            </div>\n                          </div>\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {getDocumentTypeLabel(document.documentType)}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${statusInfo.color}`}>\n                          <StatusIcon className=\"w-3 h-3\" />\n                          {statusInfo.label}\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {formatFileSize(document.fileSize)}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {formatDate(document.uploadedAt)}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                        <div className=\"flex items-center gap-2\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => handleViewDocument(document)}\n                            className=\"text-blue-600 hover:text-blue-700\"\n                          >\n                            <Eye className=\"w-4 h-4\" />\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => handleDownloadDocument(document)}\n                            className=\"text-green-600 hover:text-green-700\"\n                          >\n                            <Download className=\"w-4 h-4\" />\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => handlePreviewDocument(document)}\n                            className=\"text-purple-600 hover:text-purple-700\"\n                          >\n                            <Search className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Document Viewer Modal */}\n      {viewerDocument && (\n        <DocumentViewer\n          isOpen={!!viewerDocument}\n          document={viewerDocument}\n          onClose={() => setViewerDocument(null)}\n          onDownload={() => handleDownloadDocument(viewerDocument)}\n        />\n      )}\n\n      {/* Document Preview Modal */}\n       {previewDocument && (\n         <DocumentPreview\n           result={{\n             fileName: previewDocument.filename,\n             status: 'processed',\n             result: {\n               document_type: previewDocument.documentType,\n               ocr_text: previewDocument.ocrText || '',\n               pdf_generated: false,\n               pdf_filename: undefined,\n               confidence_score: undefined,\n               file_size: previewDocument.fileSize,\n               created_at: previewDocument.uploadedAt,\n               image_url: previewDocument.fileUrl,\n               matched_patient: undefined\n             }\n           }}\n           isOpen={!!previewDocument}\n           onClose={() => setPreviewDocument(null)}\n           onChangeDocumentType={() => {\n             // Handle document type change\n             console.log('Document type changed for:', previewDocument.id);\n           }}\n           onSave={() => {\n             // Handle save\n             console.log('Document saved:', previewDocument.id);\n             setPreviewDocument(null);\n           }}\n         />\n       )}\n    </div>\n  );\n};\n\nexport default DocumentGallery;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/DocumentList.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[538,541],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[538,541],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1094,1097],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1094,1097],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState } from 'react';\nimport { Button } from '@x-ear/ui-web';\nimport DocumentUploadModal from '@/components/sgk/DocumentUploadModal';\nimport { useSgkDocuments, useDeleteSgkDocument } from '@/hooks/sgk/useSgkDocuments';\n\ntype Props = { patientId: string };\n\nexport default function DocumentList({ patientId }: Props) {\n  const [open, setOpen] = useState(false);\n  const { data, isLoading, isError } = useSgkDocuments(patientId);\n  const deleteMutation = useDeleteSgkDocument(patientId);\n\n  const docs = (data as any)?.data || [];\n\n  return (\n    <div>\n      <div className=\"flex items-center justify-between mb-2\">\n        <h3 className=\"text-lg font-medium\">SGK Documents</h3>\n        <div>\n          <Button onClick={() => setOpen(true)}>Upload</Button>\n        </div>\n      </div>\n\n      {isLoading && <div>Loading documents…</div>}\n      {isError && <div>Failed to load documents</div>}\n\n      {!isLoading && docs.length === 0 && <div>No documents found.</div>}\n\n      {!isLoading && docs.length > 0 && (\n        <ul className=\"space-y-2\">\n          {docs.map((d: any) => (\n            <li key={d.id} className=\"flex items-center justify-between p-2 border rounded\">\n              <div>\n                <div className=\"font-medium\">{d.name || d.filename || 'Document'}</div>\n                <div className=\"text-sm text-gray-500\">{d.createdAt || d.created_at || ''}</div>\n                {d.status === 'queued' && (\n                  <div className=\"mt-1 inline-block px-2 py-0.5 text-xs font-medium bg-yellow-100 text-yellow-800 rounded\">Queued</div>\n                )}\n              </div>\n              <div className=\"flex gap-2\">\n                <a href={d.url || d.downloadUrl} target=\"_blank\" rel=\"noreferrer\">\n                  <Button variant=\"ghost\">Open</Button>\n                </a>\n                <Button\n                  variant=\"danger\"\n                  onClick={() => deleteMutation.mutate({ id: d.id, idempotencyKey: `${Date.now()}-${Math.random()}` })}\n                >\n                  Delete\n                </Button>\n              </div>\n            </li>\n          ))}\n        </ul>\n      )}\n\n      <DocumentUploadModal\n        isOpen={open}\n        patientId={patientId}\n        onClose={() => setOpen(false)}\n        onUploaded={() => setOpen(false)}\n      />\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/DocumentPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Eye' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":6},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[421,424],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[421,424],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[525,528],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[525,528],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'highlightedText' is assigned a value but never used.","line":58,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":25},{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useEffect\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":68,"column":3,"nodeType":"Identifier","endLine":68,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2593,2596],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2593,2596],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":269,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":275,"endColumn":21}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect } from 'react';\nimport { Modal, Button } from '@x-ear/ui-web';\nimport { \n  FileText, \n  Download, \n  Eye, \n  ZoomIn, \n  ZoomOut, \n  RotateCw, \n  Maximize2, \n  Search,\n  User,\n  Calendar,\n  FileType,\n  Hash,\n  AlertCircle,\n  CheckCircle\n} from 'lucide-react';\n\ninterface ProcessingResult {\n  fileName: string;\n  status: 'processed' | 'error';\n  result?: {\n    matched_patient?: any;\n    pdf_generated?: boolean;\n    pdf_filename?: string;\n    document_type?: string;\n    entities?: any[];\n    confidence_score?: number;\n    processing_time?: number;\n    file_size?: number;\n    dimensions?: { width: number; height: number };\n    created_at?: string;\n    ocr_text?: string;\n    image_url?: string;\n  };\n  error?: string;\n}\n\ninterface DocumentPreviewProps {\n  result: ProcessingResult;\n  isOpen: boolean;\n  onClose: () => void;\n  onChangeDocumentType: () => void;\n  onSave?: () => void;\n}\n\nconst DocumentPreview: React.FC<DocumentPreviewProps> = ({\n  result,\n  isOpen,\n  onClose,\n  onChangeDocumentType,\n  onSave,\n}) => {\n  const [imageZoom, setImageZoom] = useState(1);\n  const [imageRotation, setImageRotation] = useState(0);\n  const [showFullOCR, setShowFullOCR] = useState(false);\n  const [highlightedText, setHighlightedText] = useState('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const imageRef = useRef<HTMLImageElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  if (!result.result) return null;\n\n  const { result: data } = result;\n\n  // Reset states when modal opens/closes\n  useEffect(() => {\n    if (isOpen) {\n      setImageZoom(1);\n      setImageRotation(0);\n      setShowFullOCR(false);\n      setHighlightedText('');\n      setSearchTerm('');\n    }\n  }, [isOpen]);\n\n  // Handle zoom controls\n  const handleZoomIn = () => setImageZoom(prev => Math.min(prev + 0.25, 3));\n  const handleZoomOut = () => setImageZoom(prev => Math.max(prev - 0.25, 0.5));\n  const handleRotate = () => setImageRotation(prev => (prev + 90) % 360);\n  const handleResetView = () => {\n    setImageZoom(1);\n    setImageRotation(0);\n  };\n\n  // Handle OCR text highlighting\n  const highlightOCRText = (text: string, searchTerm: string) => {\n    if (!searchTerm) return text;\n    \n    const regex = new RegExp(`(${searchTerm})`, 'gi');\n    return text.replace(regex, '<mark class=\"bg-yellow-200 px-1 rounded\">$1</mark>');\n  };\n\n  // Get full OCR text\n  const getFullOCRText = () => {\n    if (data.ocr_text) return data.ocr_text;\n    \n    if (data.entities && data.entities.length > 0) {\n      return data.entities\n        .map((entity: any) => entity.text || '')\n        .filter(text => text.trim())\n        .join(' ');\n    }\n    \n    return '';\n  };\n\n  // Format file size\n  const formatFileSize = (bytes?: number) => {\n    if (!bytes) return 'Bilinmiyor';\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(1024));\n    return `${(bytes / Math.pow(1024, i)).toFixed(1)} ${sizes[i]}`;\n  };\n\n  // Format confidence score\n  const getConfidenceColor = (score?: number) => {\n    if (!score) return 'text-gray-500';\n    if (score >= 0.8) return 'text-green-600';\n    if (score >= 0.6) return 'text-yellow-600';\n    return 'text-red-600';\n  };\n\n  const fullOCRText = getFullOCRText();\n\n  return (\n    <Modal \n      isOpen={isOpen} \n      onClose={onClose} \n      title={`Doküman Önizleme - ${result.fileName}`}\n      size=\"xl\"\n    >\n      <div className=\"space-y-6 max-h-[80vh] overflow-y-auto\">\n        {/* Enhanced Document Info Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          {/* Document Type */}\n          <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <FileType className=\"w-4 h-4 text-blue-600\" />\n              <label className=\"text-sm font-medium text-blue-900\">Doküman Türü</label>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-sm font-semibold text-blue-800\">\n                {data.document_type || 'Belirlenemedi'}\n              </span>\n              <Button size=\"sm\" variant=\"ghost\" onClick={onChangeDocumentType}>\n                Değiştir\n              </Button>\n            </div>\n          </div>\n\n          {/* Patient Info */}\n          <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <User className=\"w-4 h-4 text-green-600\" />\n              <label className=\"text-sm font-medium text-green-900\">Hasta Bilgisi</label>\n            </div>\n            <div className=\"text-sm font-semibold text-green-800\">\n              {data.matched_patient?.patient?.fullName || 'Hasta seçilmedi'}\n            </div>\n            {data.matched_patient?.patient?.tcNo && (\n              <div className=\"text-xs text-green-600 mt-1\">\n                TC: {data.matched_patient.patient.tcNo}\n              </div>\n            )}\n          </div>\n\n          {/* Processing Info */}\n          <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Hash className=\"w-4 h-4 text-purple-600\" />\n              <label className=\"text-sm font-medium text-purple-900\">İşlem Bilgisi</label>\n            </div>\n            {data.confidence_score && (\n              <div className=\"text-sm mb-1\">\n                <span className=\"text-purple-700\">Güven: </span>\n                <span className={`font-semibold ${getConfidenceColor(data.confidence_score)}`}>\n                  {(data.confidence_score * 100).toFixed(1)}%\n                </span>\n              </div>\n            )}\n            {data.processing_time && (\n              <div className=\"text-xs text-purple-600\">\n                İşlem süresi: {data.processing_time}ms\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Enhanced Image Preview with Controls */}\n        {data.image_url && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">Belge Önizleme</h3>\n              <div className=\"flex items-center gap-2\">\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={handleZoomOut}\n                  disabled={imageZoom <= 0.5}\n                >\n                  <ZoomOut className=\"w-4 h-4\" />\n                </Button>\n                <span className=\"text-sm text-gray-600 min-w-[60px] text-center\">\n                  {Math.round(imageZoom * 100)}%\n                </span>\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={handleZoomIn}\n                  disabled={imageZoom >= 3}\n                >\n                  <ZoomIn className=\"w-4 h-4\" />\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={handleRotate}\n                >\n                  <RotateCw className=\"w-4 h-4\" />\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={handleResetView}\n                >\n                  <Maximize2 className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            </div>\n            \n            <div \n              ref={containerRef}\n              className=\"border rounded-lg overflow-auto bg-gray-50 max-h-96 flex items-center justify-center\"\n            >\n              <img\n                ref={imageRef}\n                src={data.image_url}\n                alt={result.fileName}\n                className=\"transition-transform duration-200 cursor-grab active:cursor-grabbing\"\n                style={{\n                  transform: `scale(${imageZoom}) rotate(${imageRotation}deg)`,\n                  maxWidth: imageZoom <= 1 ? '100%' : 'none',\n                  maxHeight: imageZoom <= 1 ? '100%' : 'none',\n                }}\n                draggable={false}\n              />\n            </div>\n            \n            {/* Image metadata */}\n            {data.dimensions && (\n              <div className=\"text-xs text-gray-500 text-center\">\n                Boyutlar: {data.dimensions.width} × {data.dimensions.height} px\n                {data.file_size && ` • Dosya boyutu: ${formatFileSize(data.file_size)}`}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Enhanced OCR Text Section */}\n        {fullOCRText && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">OCR Metin Analizi</h3>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"relative\">\n                  <Search className=\"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\n                  <input\n                    type=\"text\"\n                    placeholder=\"Metinde ara...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  />\n                </div>\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={() => setShowFullOCR(!showFullOCR)}\n                >\n                  {showFullOCR ? 'Kısalt' : 'Tümünü Göster'}\n                </Button>\n              </div>\n            </div>\n            \n            <div className=\"bg-gray-50 border rounded-lg\">\n              <div className=\"p-4\">\n                <div \n                  className={`text-sm text-gray-800 whitespace-pre-wrap leading-relaxed ${\n                    showFullOCR ? 'max-h-64 overflow-y-auto' : 'max-h-32 overflow-hidden'\n                  }`}\n                  dangerouslySetInnerHTML={{\n                    __html: highlightOCRText(\n                      showFullOCR ? fullOCRText : fullOCRText.substring(0, 500) + (fullOCRText.length > 500 ? '...' : ''),\n                      searchTerm\n                    )\n                  }}\n                />\n              </div>\n              \n              {/* OCR Statistics */}\n              <div className=\"px-4 py-2 bg-gray-100 border-t text-xs text-gray-600 flex items-center justify-between\">\n                <span>Toplam karakter: {fullOCRText.length}</span>\n                <span>Kelime sayısı: {fullOCRText.split(/\\s+/).filter(word => word.length > 0).length}</span>\n                {searchTerm && (\n                  <span>\n                    Arama sonucu: {(fullOCRText.match(new RegExp(searchTerm, 'gi')) || []).length} eşleşme\n                  </span>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Enhanced PDF Status */}\n        <div className=\"space-y-3\">\n          <h3 className=\"text-lg font-semibold text-gray-900\">PDF Durumu</h3>\n          \n          {data.pdf_generated ? (\n            <div className=\"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-lg\">\n              <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0\" />\n              <div className=\"flex-1\">\n                <div className=\"text-sm font-medium text-green-800\">\n                  PDF başarıyla oluşturuldu\n                </div>\n                <div className=\"text-xs text-green-600 mt-1\">\n                  Dosya: {data.pdf_filename}\n                </div>\n              </div>\n              <Button size=\"sm\" variant=\"outline\" className=\"flex items-center gap-2\">\n                <Download className=\"w-4 h-4\" />\n                İndir\n              </Button>\n            </div>\n          ) : (\n            <div className=\"flex items-center gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\n              <AlertCircle className=\"w-5 h-5 text-yellow-600 flex-shrink-0\" />\n              <div className=\"flex-1\">\n                <div className=\"text-sm font-medium text-yellow-800\">\n                  PDF oluşturulamadı\n                </div>\n                <div className=\"text-xs text-yellow-600 mt-1\">\n                  Belge işleme sırasında bir sorun oluştu\n                </div>\n              </div>\n              <Button size=\"sm\" variant=\"outline\" className=\"text-yellow-700 border-yellow-300\">\n                Tekrar Dene\n              </Button>\n            </div>\n          )}\n        </div>\n\n        {/* Document Metadata */}\n        <div className=\"bg-gray-50 rounded-lg p-4 space-y-2\">\n          <h4 className=\"text-sm font-medium text-gray-900 mb-3\">Belge Detayları</h4>\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n            <div className=\"flex items-center gap-2\">\n              <Calendar className=\"w-4 h-4 text-gray-500\" />\n              <span className=\"text-gray-600\">Oluşturulma:</span>\n              <span className=\"font-medium\">\n                {data.created_at ? new Date(data.created_at).toLocaleDateString('tr-TR') : 'Bilinmiyor'}\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <FileText className=\"w-4 h-4 text-gray-500\" />\n              <span className=\"text-gray-600\">Dosya adı:</span>\n              <span className=\"font-medium truncate\">{result.fileName}</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Enhanced Actions */}\n        <div className=\"flex items-center justify-between pt-4 border-t\">\n          <div className=\"flex items-center gap-2\">\n            <Button variant=\"ghost\" onClick={onClose}>\n              İptal\n            </Button>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            {data.pdf_generated && (\n              <Button variant=\"outline\" className=\"flex items-center gap-2\">\n                <Download className=\"w-4 h-4\" />\n                PDF İndir\n              </Button>\n            )}\n            <Button onClick={onSave || onClose} className=\"flex items-center gap-2\">\n              <CheckCircle className=\"w-4 h-4\" />\n              Kaydet ve Devam\n            </Button>\n          </div>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default DocumentPreview;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/DocumentProcessor.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'RotateCcw' is defined but never used.","line":3,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":160,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":160,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'imageData' is defined but never used.","line":167,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":167,"endColumn":68},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":263,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8332,8335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8332,8335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback } from 'react';\nimport { Modal, Button } from '@x-ear/ui-web';\nimport { FileText, Eye, Download, RotateCcw, Scissors, Zap } from 'lucide-react';\nimport PatientSearch from './PatientSearch';\nimport DocumentTypeSelector from './DocumentTypeSelector';\nimport { type Patient } from '../../types/patient';\n\ninterface ProcessedDocument {\n  id: string;\n  originalImage: string;\n  processedImage: string;\n  croppedImage?: string;\n  ocrResult?: {\n    text: string;\n    confidence: number;\n    patientInfo?: {\n      firstName?: string;\n      lastName?: string;\n      tcNumber?: string;\n      confidence: number;\n    };\n    documentType?: {\n      type: string;\n      confidence: number;\n    };\n  };\n  edgeDetection?: {\n    corners: Array<{ x: number; y: number }>;\n    confidence: number;\n    applied: boolean;\n  };\n  selectedPatient?: Patient;\n  selectedDocumentType?: string;\n  finalFileName?: string;\n  pdfData?: string;\n}\n\ninterface DocumentProcessorProps {\n  isOpen: boolean;\n  onClose: () => void;\n  images: File[];\n  onProcessingComplete: (documents: ProcessedDocument[]) => void;\n}\n\nconst DocumentProcessor: React.FC<DocumentProcessorProps> = ({\n  isOpen,\n  onClose,\n  images,\n  onProcessingComplete,\n}) => {\n  const [documents, setDocuments] = useState<ProcessedDocument[]>([]);\n  const [currentStep, setCurrentStep] = useState<'processing' | 'review' | 'complete' | 'generating'>('processing');\n  const [processingProgress, setProcessingProgress] = useState(0);\n  const [selectedDocumentId, setSelectedDocumentId] = useState<string | null>(null);\n  const [showPatientSearch, setShowPatientSearch] = useState(false);\n  const [showDocumentTypeSelector, setShowDocumentTypeSelector] = useState(false);\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  // Enhanced image compression with optimal dimensions and quality enhancement\n  const compressImage = useCallback(async (file: File, quality: number = 0.8): Promise<string> => {\n    return new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        const img = new Image();\n\n        img.onload = () => {\n          // Calculate optimal dimensions (max 1920x1080 for better OCR)\n          const maxWidth = 1920;\n          const maxHeight = 1080;\n          let { width, height } = img;\n          \n          if (width > maxWidth || height > maxHeight) {\n            const ratio = Math.min(maxWidth / width, maxHeight / height);\n            width *= ratio;\n            height *= ratio;\n          }\n          \n          canvas.width = width;\n          canvas.height = height;\n\n          if (ctx) {\n            // Enable high-quality image smoothing\n            ctx.imageSmoothingEnabled = true;\n            ctx.imageSmoothingQuality = 'high';\n            \n            // Apply contrast and brightness enhancement for better OCR\n            ctx.filter = 'contrast(1.1) brightness(1.05)';\n            \n            // Draw the enhanced image\n            ctx.drawImage(img, 0, 0, width, height);\n            \n            // Reset filter for future operations\n            ctx.filter = 'none';\n            \n            resolve(canvas.toDataURL('image/jpeg', quality));\n          } else {\n            resolve(e.target?.result as string);\n          }\n        };\n\n        img.src = e.target?.result as string;\n      };\n      reader.readAsDataURL(file);\n    });\n  }, []);\n\n  // Detect document edges and crop\n  const detectAndCropDocument = useCallback(async (imageData: string): Promise<{\n    croppedImage: string;\n    corners: Array<{ x: number; y: number }>;\n    confidence: number;\n  }> => {\n    // Simulate edge detection processing\n    await new Promise(resolve => setTimeout(resolve, 1500));\n\n    // Mock edge detection result\n    const mockCorners = [\n      { x: 50, y: 50 },\n      { x: 350, y: 45 },\n      { x: 355, y: 450 },\n      { x: 45, y: 455 }\n    ];\n\n    // For now, return the original image as \"cropped\"\n    // In real implementation, this would use OpenCV.js or similar\n    return {\n      croppedImage: imageData,\n      corners: mockCorners,\n      confidence: 0.85 + Math.random() * 0.1, // 85-95% confidence\n    };\n  }, []);\n\n  // Enhanced document type detection with weighted keyword scoring\n  const detectDocumentType = useCallback((text: string): string => {\n    const keywords = {\n      sgk_reçete: ['reçete', 'ilaç', 'eczane', 'sgk', 'sosyal güvenlik', 'prescription', 'medicine'],\n      sgk_rapor: ['rapor', 'doktor', 'hekim', 'muayene', 'tanı', 'report', 'diagnosis'],\n      odyometri: ['odyometri', 'işitme', 'audiometry', 'hearing', 'kulak', 'ear'],\n      garanti_belgesi: ['garanti', 'warranty', 'cihaz', 'device', 'serial'],\n      diger: []\n    };\n\n    const scores: Record<string, number> = {};\n    const lowerText = text.toLowerCase();\n\n    // Calculate weighted scores for each document type\n    Object.entries(keywords).forEach(([type, words]) => {\n      scores[type] = 0;\n      words.forEach(keyword => {\n        const matches = (lowerText.match(new RegExp(keyword, 'g')) || []).length;\n        // Weight keywords by importance and frequency\n        scores[type] += matches * (keyword.length > 5 ? 2 : 1);\n      });\n    });\n\n    // Find the highest scoring document type\n    const maxScore = Math.max(...Object.values(scores));\n    const detectedType = Object.entries(scores).find(([_, score]) => score === maxScore)?.[0];\n    \n    // Return detected type if confidence is high enough, otherwise 'diger'\n    return maxScore >= 3 ? detectedType! : 'diger';\n  }, []);\n\n  // Enhanced text extraction with better OCR simulation\n  const extractTextFromImage = useCallback(async (imageData: string): Promise<{\n    text: string;\n    confidence: number;\n    patientInfo?: {\n      firstName?: string;\n      lastName?: string;\n      tcNumber?: string;\n      confidence: number;\n    };\n    documentType?: {\n      type: string;\n      confidence: number;\n    };\n  }> => {\n    // Simulate OCR processing with realistic delay\n    await new Promise(resolve => setTimeout(resolve, 1500 + Math.random() * 1000));\n\n    // Enhanced mock OCR results with more realistic patterns\n    const mockTexts = [\n      {\n        text: `T.C. SAĞLIK BAKANLIĞI\nSGK REÇETE\nHasta Adı: AHMET YILMAZ\nTC Kimlik No: 12345678901\nTarih: ${new Date().toLocaleDateString('tr-TR')}\nİlaç Listesi:\n- Aspirin 100mg\n- Vitamin D3`,\n        patientInfo: {\n          firstName: \"AHMET\",\n          lastName: \"YILMAZ\", \n          tcNumber: \"12345678901\",\n          confidence: 0.92\n        },\n        documentType: {\n          type: \"sgk_reçete\",\n          confidence: 0.95\n        }\n      },\n      {\n        text: `ODYOMETRI TEST SONUCU\nHasta: FATMA KAYA\nTC: 98765432109\nTest Tarihi: ${new Date().toLocaleDateString('tr-TR')}\nSağ Kulak: Normal\nSol Kulak: Hafif kayıp`,\n        patientInfo: {\n          firstName: \"FATMA\",\n          lastName: \"KAYA\",\n          tcNumber: \"98765432109\", \n          confidence: 0.88\n        },\n        documentType: {\n          type: \"odyometri\",\n          confidence: 0.91\n        }\n      },\n      {\n        text: `DOKTOR RAPORU\nDr. Mehmet Özkan\nHasta: ALİ DEMİR\nTC: 11223344556\nTanı: Kronik otitis media\nÖnerilen tedavi: Antibiyotik`,\n        patientInfo: {\n          firstName: \"ALİ\",\n          lastName: \"DEMİR\",\n          tcNumber: \"11223344556\",\n          confidence: 0.85\n        },\n        documentType: {\n          type: \"sgk_rapor\", \n          confidence: 0.89\n        }\n      }\n    ];\n\n    // Select random result and apply confidence variation\n    const randomResult = mockTexts[Math.floor(Math.random() * mockTexts.length)];\n    const baseConfidence = 0.8 + Math.random() * 0.15; // 80-95% base confidence\n\n    return {\n      text: randomResult.text,\n      confidence: baseConfidence,\n      patientInfo: randomResult.patientInfo ? {\n        ...randomResult.patientInfo,\n        confidence: randomResult.patientInfo.confidence * baseConfidence\n      } : undefined,\n      documentType: randomResult.documentType ? {\n        ...randomResult.documentType,\n        confidence: randomResult.documentType.confidence * baseConfidence\n      } : undefined,\n    };\n  }, []);\n\n  // Generate filename based on patient and document type\n  const generateFileName = useCallback((patientInfo: any, documentType: string): string => {\n    const firstName = patientInfo?.firstName || 'Bilinmeyen';\n    const lastName = patientInfo?.lastName || 'Hasta';\n    \n    const docType = documentType.replace(/\\s+/g, '_');\n    const timestamp = new Date().toISOString().slice(0, 10); // YYYY-MM-DD\n    \n    return `${firstName}_${lastName}_${docType}_${timestamp}.pdf`;\n  }, []);\n\n  // Process all images\n  const processImages = useCallback(async () => {\n    if (images.length === 0) return;\n\n    setIsProcessing(true);\n    setCurrentStep('processing');\n    setProcessingProgress(0);\n\n    const processedDocs: ProcessedDocument[] = [];\n\n    for (let i = 0; i < images.length; i++) {\n      const image = images[i];\n      \n      // Update progress\n      const baseProgress = (i / images.length) * 100;\n      setProcessingProgress(baseProgress);\n\n      try {\n        // Step 1: Compress image\n        setProcessingProgress(baseProgress + 10);\n        const compressedImage = await compressImage(image);\n\n        // Step 2: Detect and crop document\n        setProcessingProgress(baseProgress + 30);\n        const edgeDetection = await detectAndCropDocument(compressedImage);\n\n        // Step 3: Extract text with OCR\n        setProcessingProgress(baseProgress + 60);\n        const ocrResult = await extractTextFromImage(edgeDetection.croppedImage);\n\n        // Step 4: Detect document type\n        const detectedType = detectDocumentType(ocrResult.text);\n        \n        // Step 5: Generate filename\n        const fileName = generateFileName(ocrResult.patientInfo, detectedType);\n\n        const processedDoc: ProcessedDocument = {\n          id: `doc_${Date.now()}_${i}`,\n          originalImage: URL.createObjectURL(image),\n          processedImage: compressedImage,\n          croppedImage: edgeDetection.croppedImage,\n          ocrResult: {\n            ...ocrResult,\n            documentType: {\n              type: detectedType,\n              confidence: ocrResult.documentType?.confidence || 0.8\n            }\n          },\n          edgeDetection: {\n            corners: edgeDetection.corners,\n            confidence: edgeDetection.confidence,\n            applied: true\n          },\n          finalFileName: fileName\n        };\n\n        processedDocs.push(processedDoc);\n        setProcessingProgress(baseProgress + 90);\n\n      } catch (error) {\n        console.error('Error processing image:', error);\n        // Add failed document\n        processedDocs.push({\n          id: `doc_${Date.now()}_${i}`,\n          originalImage: URL.createObjectURL(image),\n          processedImage: URL.createObjectURL(image),\n          finalFileName: `error_${image.name}`\n        });\n      }\n    }\n\n    setDocuments(processedDocs);\n    setProcessingProgress(100);\n    setIsProcessing(false);\n    setCurrentStep('review');\n  }, [images, compressImage, detectAndCropDocument, extractTextFromImage, detectDocumentType, generateFileName]);\n\n  // Handle patient selection\n  const handlePatientSelect = useCallback((patient: Patient) => {\n    if (selectedDocumentId) {\n      setDocuments(prev => prev.map(doc => \n        doc.id === selectedDocumentId \n          ? { ...doc, selectedPatient: patient }\n          : doc\n      ));\n    }\n    setShowPatientSearch(false);\n    setSelectedDocumentId(null);\n  }, [selectedDocumentId]);\n\n  // Handle document type selection\n  const handleDocumentTypeSelect = useCallback((docType: string) => {\n    if (selectedDocumentId) {\n      setDocuments(prev => prev.map(doc => \n        doc.id === selectedDocumentId \n          ? { \n              ...doc, \n              selectedDocumentType: docType,\n              finalFileName: generateFileName(doc.ocrResult?.patientInfo, docType)\n            }\n          : doc\n      ));\n    }\n    setShowDocumentTypeSelector(false);\n    setSelectedDocumentId(null);\n  }, [selectedDocumentId, generateFileName]);\n\n  // Generate PDF for document\n  const generatePDF = useCallback(async (doc: ProcessedDocument): Promise<string> => {\n    // Dynamic import to reduce bundle size\n    const jsPDFModule = await import('jspdf');\n    const jsPDF = jsPDFModule.default;\n    \n    const pdf = new jsPDF();\n    \n    // Add title\n    pdf.setFontSize(16);\n    pdf.text('Belge İşleme Raporu', 20, 20);\n    \n    // Add patient info\n    if (doc.selectedPatient) {\n      pdf.setFontSize(12);\n      pdf.text(`Hasta: ${doc.selectedPatient.firstName} ${doc.selectedPatient.lastName}`, 20, 40);\n      pdf.text(`TC: ${doc.selectedPatient.tcNumber}`, 20, 50);\n    }\n    \n    // Add document type\n    if (doc.selectedDocumentType) {\n      pdf.text(`Belge Türü: ${doc.selectedDocumentType}`, 20, 60);\n    }\n    \n    // Add processed image\n    if (doc.processedImage) {\n      try {\n        pdf.addImage(doc.processedImage, 'JPEG', 20, 80, 160, 120);\n      } catch (error) {\n        console.error('Error adding image to PDF:', error);\n      }\n    }\n    \n    // Add OCR text\n    if (doc.ocrResult?.text) {\n      pdf.setFontSize(10);\n      pdf.text('OCR Metni:', 20, 220);\n      const splitText = pdf.splitTextToSize(doc.ocrResult.text, 160);\n      pdf.text(splitText, 20, 230);\n    }\n    \n    return pdf.output('bloburl');\n  }, []);\n\n  // Handle completion\n  const handleComplete = useCallback(async () => {\n    setIsProcessing(true);\n    setCurrentStep('generating');\n\n    try {\n      // Generate PDFs for all documents\n      const documentsWithPDF = await Promise.all(\n        documents.map(async (doc) => {\n          const pdfData = await generatePDF(doc);\n          return { ...doc, pdfData };\n        })\n      );\n\n      // Update documents with PDF data\n      setDocuments(documentsWithPDF);\n      \n      // Call completion callback\n      onProcessingComplete(documentsWithPDF);\n      \n      setCurrentStep('complete');\n    } catch (error) {\n      console.error('Error generating PDFs:', error);\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [documents, generatePDF, onProcessingComplete]);\n\n  // Auto-start processing when modal opens\n  React.useEffect(() => {\n    if (isOpen && images.length > 0 && documents.length === 0) {\n      processImages();\n    }\n  }, [isOpen, images, documents.length, processImages]);\n\n  // Auto-select first document for review\n  React.useEffect(() => {\n    if (currentStep === 'review' && documents.length > 0 && !selectedDocumentId) {\n      setSelectedDocumentId(documents[0].id);\n    }\n  }, [currentStep, documents, selectedDocumentId]);\n\n  const renderProcessingStep = () => (\n    <div className=\"space-y-6\">\n      <div className=\"text-center\">\n        <div className=\"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\n        <h3 className=\"text-lg font-medium mb-2\">Belgeler İşleniyor</h3>\n        <p className=\"text-gray-600\">Lütfen bekleyin, belgeleriniz analiz ediliyor...</p>\n      </div>\n\n      <div className=\"space-y-2\">\n        <div className=\"flex justify-between text-sm\">\n          <span>İlerleme</span>\n          <span>{Math.round(processingProgress)}%</span>\n        </div>\n        <div className=\"w-full bg-gray-200 rounded-full h-2\">\n          <div \n            className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\" \n            style={{ width: `${processingProgress}%` }}\n          />\n        </div>\n      </div>\n\n      <div className=\"text-sm text-gray-600 space-y-1\">\n        <div className=\"flex items-center gap-2\">\n          <Zap className=\"w-4 h-4\" />\n          <span>Görüntüler sıkıştırılıyor</span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Scissors className=\"w-4 h-4\" />\n          <span>Belge kenarları tespit ediliyor</span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <FileText className=\"w-4 h-4\" />\n          <span>Metin çıkarılıyor (OCR)</span>\n        </div>\n      </div>\n    </div>\n  );\n\n  const renderReviewStep = () => {\n    const selectedDoc = documents.find(d => d.id === selectedDocumentId);\n    \n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg font-medium\">Belgeleri İnceleyin</h3>\n          <div className=\"flex gap-2\">\n            {documents.map((doc, index) => (\n              <Button\n                key={doc.id}\n                variant={doc.id === selectedDocumentId ? \"default\" : \"outline\"}\n                size=\"sm\"\n                onClick={() => setSelectedDocumentId(doc.id)}\n              >\n                {index + 1}\n              </Button>\n            ))}\n          </div>\n        </div>\n\n        {selectedDoc && (\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            {/* Image Preview */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium\">Belge Önizleme</h4>\n              <div className=\"border rounded-lg overflow-hidden\">\n                <img \n                  src={selectedDoc.croppedImage || selectedDoc.processedImage} \n                  alt=\"Processed document\"\n                  className=\"w-full h-auto\"\n                />\n              </div>\n              \n              {selectedDoc.edgeDetection && (\n                <div className=\"text-sm text-gray-600\">\n                  <div className=\"flex items-center gap-2\">\n                    <Scissors className=\"w-4 h-4\" />\n                    <span>Kenar Tespiti: %{Math.round(selectedDoc.edgeDetection.confidence * 100)}</span>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* OCR Results and Controls */}\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium\">OCR Sonuçları</h4>\n              \n              {selectedDoc.ocrResult && (\n                <div className=\"space-y-4\">\n                  <div className=\"p-3 bg-gray-50 rounded-lg\">\n                    <div className=\"text-sm font-medium mb-2\">Tespit Edilen Metin:</div>\n                    <div className=\"text-sm whitespace-pre-wrap\">\n                      {selectedDoc.ocrResult.text}\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-2\">\n                      Güven: %{Math.round(selectedDoc.ocrResult.confidence * 100)}\n                    </div>\n                  </div>\n\n                  {selectedDoc.ocrResult.patientInfo && (\n                    <div className=\"p-3 bg-blue-50 rounded-lg\">\n                      <div className=\"text-sm font-medium mb-2\">Hasta Bilgileri:</div>\n                      <div className=\"text-sm space-y-1\">\n                        <div>Ad: {selectedDoc.ocrResult.patientInfo.firstName}</div>\n                        <div>Soyad: {selectedDoc.ocrResult.patientInfo.lastName}</div>\n                        <div>TC: {selectedDoc.ocrResult.patientInfo.tcNumber}</div>\n                        <div className=\"text-xs text-gray-500\">\n                          Güven: %{Math.round(selectedDoc.ocrResult.patientInfo.confidence * 100)}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {selectedDoc.ocrResult.documentType && (\n                    <div className=\"p-3 bg-green-50 rounded-lg\">\n                      <div className=\"text-sm font-medium mb-2\">Belge Türü:</div>\n                      <div className=\"text-sm\">\n                        {selectedDoc.ocrResult.documentType.type}\n                        <div className=\"text-xs text-gray-500\">\n                          Güven: %{Math.round(selectedDoc.ocrResult.documentType.confidence * 100)}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Action Buttons */}\n              <div className=\"space-y-2\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  onClick={() => {\n                    setSelectedDocumentId(selectedDoc.id);\n                    setShowPatientSearch(true);\n                  }}\n                >\n                  <Eye className=\"w-4 h-4 mr-2\" />\n                  {selectedDoc.selectedPatient \n                    ? `${selectedDoc.selectedPatient.firstName} ${selectedDoc.selectedPatient.lastName}`\n                    : 'Hasta Seç'\n                  }\n                </Button>\n\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  onClick={() => {\n                    setSelectedDocumentId(selectedDoc.id);\n                    setShowDocumentTypeSelector(true);\n                  }}\n                >\n                  <FileText className=\"w-4 h-4 mr-2\" />\n                  {selectedDoc.selectedDocumentType || selectedDoc.ocrResult?.documentType?.type || 'Belge Türü Seç'}\n                </Button>\n              </div>\n\n              {/* File Name Preview */}\n              {selectedDoc.finalFileName && (\n                <div className=\"p-3 bg-gray-50 rounded-lg\">\n                  <div className=\"text-sm font-medium mb-1\">Dosya Adı:</div>\n                  <div className=\"text-sm text-gray-600\">{selectedDoc.finalFileName}</div>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <>\n      <Modal \n        isOpen={isOpen} \n        onClose={onClose} \n        title=\"Belge İşleme\"\n        size=\"xl\"\n      >\n        <div className=\"space-y-6\">\n          {currentStep === 'processing' && renderProcessingStep()}\n          {currentStep === 'review' && renderReviewStep()}\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-between pt-4 border-t\">\n            <Button\n              variant=\"ghost\"\n              onClick={onClose}\n              disabled={isProcessing}\n            >\n              İptal\n            </Button>\n\n            {currentStep === 'review' && (\n              <Button\n                onClick={handleComplete}\n                disabled={isProcessing}\n              >\n                {isProcessing ? (\n                  <>\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                    PDF Oluşturuluyor...\n                  </>\n                ) : (\n                  <>\n                    <Download className=\"w-4 h-4 mr-2\" />\n                    Tamamla ({documents.length} belge)\n                  </>\n                )}\n              </Button>\n            )}\n          </div>\n        </div>\n      </Modal>\n\n      {/* Patient Search Modal */}\n      <PatientSearch\n        isOpen={showPatientSearch}\n        onClose={() => {\n          setShowPatientSearch(false);\n          setSelectedDocumentId(null);\n        }}\n        onSelect={handlePatientSelect}\n        ocrResult={selectedDocumentId ? documents.find(d => d.id === selectedDocumentId)?.ocrResult : undefined}\n      />\n\n      {/* Document Type Selector Modal */}\n      <DocumentTypeSelector\n        isOpen={showDocumentTypeSelector}\n        onClose={() => {\n          setShowDocumentTypeSelector(false);\n          setSelectedDocumentId(null);\n        }}\n        onSelect={handleDocumentTypeSelect}\n        currentType={selectedDocumentId ? documents.find(d => d.id === selectedDocumentId)?.ocrResult?.documentType?.type : undefined}\n      />\n    </>\n  );\n};\n\nexport default DocumentProcessor;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/DocumentTypeSelector.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":41,"column":11,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":52,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Modal, Button } from '@x-ear/ui-web';\n\ninterface DocumentTypeSelectorProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelect: (docType: string) => void;\n  currentType?: string;\n}\n\nconst DOCUMENT_TYPES = [\n  { value: 'sgk_reçete', label: 'SGK Reçete' },\n  { value: 'sgk_rapor', label: 'SGK Rapor' },\n  { value: 'odyometri_sonucu', label: 'Odyometri Sonucu' },\n  { value: 'garanti_belgesi', label: 'Garanti Belgesi' },\n  { value: 'kimlik', label: 'Kimlik' },\n  { value: 'diger', label: 'Diğer' },\n];\n\nconst DocumentTypeSelector: React.FC<DocumentTypeSelectorProps> = ({\n  isOpen,\n  onClose,\n  onSelect,\n  currentType,\n}) => {\n  const [selectedType, setSelectedType] = useState(currentType || '');\n\n  const handleSelect = () => {\n    if (selectedType) {\n      onSelect(selectedType);\n    }\n  };\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title=\"Doküman Türü Seç\">\n      <div className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium mb-2\">\n            Doküman Türü\n          </label>\n          <select\n            value={selectedType}\n            onChange={(e) => setSelectedType(e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          >\n            <option value=\"\">Tür seçin</option>\n            {DOCUMENT_TYPES.map((type) => (\n              <option key={type.value} value={type.value}>\n                {type.label}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div className=\"text-sm text-gray-600\">\n          <p>Otomatik olarak belirlenen tür: <strong>{currentType || 'Belirlenemedi'}</strong></p>\n          <p className=\"mt-1\">Gerekirse manuel olarak değiştirebilirsiniz.</p>\n        </div>\n\n        <div className=\"flex items-center justify-end gap-2 pt-4 border-t\">\n          <Button variant=\"ghost\" onClick={onClose}>\n            İptal\n          </Button>\n          <Button\n            onClick={handleSelect}\n            disabled={!selectedType}\n          >\n            Seç\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default DocumentTypeSelector;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/DocumentUploadModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[742,745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[742,745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[960,963],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[960,963],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1051,1054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1051,1054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { Modal, Button, Input } from '@x-ear/ui-web';\nimport { useForm } from 'react-hook-form';\nimport { z } from 'zod';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { useUploadSgkDocument } from '@/hooks/sgk/useSgkDocuments';\n\nconst schema = z.object({ file: z.any() });\n\ntype Props = { patientId: string; isOpen: boolean; onClose: () => void; onUploaded?: () => void };\n\nexport default function DocumentUploadModal({ patientId, isOpen, onClose, onUploaded }: Props) {\n  const [submitting, setSubmitting] = useState(false);\n  const upload = useUploadSgkDocument(patientId);\n\n  const { register, handleSubmit } = useForm({ resolver: zodResolver(schema) });\n\n  const onSubmit = async (data: any) => {\n    setSubmitting(true);\n    try {\n      const form = new FormData();\n      const file = (data.file && data.file[0]) || data.file;\n      form.append('file', file);\n      // add idempotency key\n      (form as any).idempotencyKey = `upload-${Date.now()}-${Math.random()}`;\n      upload.mutate(form as any, {\n        onSuccess: () => {\n          onUploaded?.();\n        },\n        onSettled: () => {\n          setSubmitting(false);\n          onClose();\n        },\n      });\n    } catch (e) {\n      setSubmitting(false);\n      onClose();\n    }\n  };\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title=\"Upload SGK Document\">\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium\">File</label>\n          <Input type=\"file\" {...register('file')} />\n        </div>\n\n        <div className=\"flex items-center justify-end gap-2\">\n          <Button type=\"button\" variant=\"ghost\" onClick={onClose} disabled={submitting}>\n            Cancel\n          </Button>\n          <Button type=\"submit\" disabled={submitting}>\n            {submitting ? 'Uploading…' : 'Upload'}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/DocumentViewer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'zoom'. Either include it or remove the dependency array.","line":119,"column":6,"nodeType":"ArrayExpression","endLine":119,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [isDragging, zoom, showMagnifier, dragStart.x, dragStart.y]","fix":{"range":[3326,3364],"text":"[isDragging, zoom, showMagnifier, dragStart.x, dragStart.y]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Modal, Button } from '@x-ear/ui-web';\nimport { \n  ZoomIn, \n  ZoomOut, \n  Maximize2, \n  Minimize2, \n  Download, \n  RotateCw, \n  Move,\n  X,\n  FileText,\n  Eye\n} from 'lucide-react';\nimport { SGKDocument } from '../../types/sgk';\n\ninterface DocumentViewerProps {\n  document: SGKDocument | null;\n  isOpen: boolean;\n  onClose: () => void;\n  onDownload?: (document: SGKDocument) => void;\n}\n\nconst DocumentViewer: React.FC<DocumentViewerProps> = ({\n  document,\n  isOpen,\n  onClose,\n  onDownload\n}) => {\n  const [zoom, setZoom] = useState(1);\n  const [rotation, setRotation] = useState(0);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [showMagnifier, setShowMagnifier] = useState(false);\n  const [magnifierPosition, setMagnifierPosition] = useState({ x: 0, y: 0 });\n  \n  const imageRef = useRef<HTMLImageElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const magnifierRef = useRef<HTMLDivElement>(null);\n\n  // Reset view when document changes\n  useEffect(() => {\n    if (document) {\n      setZoom(1);\n      setRotation(0);\n      setPosition({ x: 0, y: 0 });\n      setIsFullscreen(false);\n    }\n  }, [document]);\n\n  // Zoom controls\n  const handleZoomIn = useCallback(() => {\n    setZoom(prev => Math.min(prev * 1.2, 5));\n  }, []);\n\n  const handleZoomOut = useCallback(() => {\n    setZoom(prev => Math.max(prev / 1.2, 0.1));\n  }, []);\n\n  const handleZoomReset = useCallback(() => {\n    setZoom(1);\n    setPosition({ x: 0, y: 0 });\n  }, []);\n\n  // Rotation control\n  const handleRotate = useCallback(() => {\n    setRotation(prev => (prev + 90) % 360);\n  }, []);\n\n  // Fullscreen toggle\n  const handleFullscreenToggle = useCallback(() => {\n    setIsFullscreen(prev => !prev);\n  }, []);\n\n  // Mouse wheel zoom\n  const handleWheel = useCallback((e: React.WheelEvent) => {\n    e.preventDefault();\n    const delta = e.deltaY > 0 ? 0.9 : 1.1;\n    setZoom(prev => Math.max(0.1, Math.min(5, prev * delta)));\n  }, []);\n\n  // Drag functionality\n  const handleMouseDown = useCallback((e: React.MouseEvent) => {\n    if (zoom > 1) {\n      setIsDragging(true);\n      setDragStart({\n        x: e.clientX - position.x,\n        y: e.clientY - position.y\n      });\n    }\n  }, [zoom, position]);\n\n  const handleMouseMove = useCallback((e: React.MouseEvent) => {\n    if (isDragging && zoom > 1) {\n      setPosition({\n        x: e.clientX - dragStart.x,\n        y: e.clientY - dragStart.y\n      });\n    }\n\n    // Magnifier functionality\n    if (showMagnifier && imageRef.current && magnifierRef.current) {\n      const rect = imageRef.current.getBoundingClientRect();\n      const x = e.clientX - rect.left;\n      const y = e.clientY - rect.top;\n      \n      setMagnifierPosition({ x: e.clientX, y: e.clientY });\n      \n      // Update magnifier background position\n      const magnifierSize = 150;\n      const magnificationFactor = 2;\n      const bgX = -x * magnificationFactor + magnifierSize / 2;\n      const bgY = -y * magnificationFactor + magnifierSize / 2;\n      \n      magnifierRef.current.style.backgroundPosition = `${bgX}px ${bgY}px`;\n    }\n  }, [isDragging, dragStart, showMagnifier]);\n\n  const handleMouseUp = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  // Magnifier controls\n  const handleMouseEnter = useCallback(() => {\n    if (document?.fileUrl && zoom === 1) {\n      setShowMagnifier(true);\n    }\n  }, [document, zoom]);\n\n  const handleMouseLeave = useCallback(() => {\n    setShowMagnifier(false);\n  }, []);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (!isOpen) return;\n\n      switch (e.key) {\n        case '+':\n        case '=':\n          e.preventDefault();\n          handleZoomIn();\n          break;\n        case '-':\n          e.preventDefault();\n          handleZoomOut();\n          break;\n        case '0':\n          e.preventDefault();\n          handleZoomReset();\n          break;\n        case 'r':\n          e.preventDefault();\n          handleRotate();\n          break;\n        case 'f':\n          e.preventDefault();\n          handleFullscreenToggle();\n          break;\n        case 'Escape':\n          if (isFullscreen) {\n            setIsFullscreen(false);\n          } else {\n            onClose();\n          }\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, isFullscreen, handleZoomIn, handleZoomOut, handleZoomReset, handleRotate, handleFullscreenToggle, onClose]);\n\n  const handleDownloadClick = useCallback(() => {\n    if (document && onDownload) {\n      onDownload(document);\n    }\n  }, [document, onDownload]);\n\n  if (!document) return null;\n\n  const isImage = document.fileUrl && (\n    document.fileUrl.includes('image') || \n    document.filename.match(/\\.(jpg|jpeg|png|gif|bmp|webp)$/i)\n  );\n\n  const isPDF = document.fileUrl && (\n    document.fileUrl.includes('pdf') || \n    document.filename.match(/\\.pdf$/i)\n  );\n\n  return (\n    <Modal \n      isOpen={isOpen} \n      onClose={onClose}\n      title=\"\"\n      className={`${isFullscreen ? 'fixed inset-0 z-50 bg-black' : 'max-w-6xl'}`}\n    >\n      <div className={`flex flex-col h-full ${isFullscreen ? 'h-screen' : 'max-h-[90vh]'}`}>\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 border-b bg-gray-50 flex-shrink-0\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"flex-shrink-0 h-8 w-8\">\n              <div className=\"h-8 w-8 bg-blue-100 rounded-lg flex items-center justify-center\">\n                {isPDF ? (\n                  <FileText className=\"h-4 w-4 text-blue-600\" />\n                ) : (\n                  <Eye className=\"h-4 w-4 text-blue-600\" />\n                )}\n              </div>\n            </div>\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900 truncate max-w-md\">\n                {document.filename}\n              </h3>\n              <p className=\"text-sm text-gray-500\">\n                {document.documentType} • {document.fileSize ? `${Math.round(document.fileSize / 1024)} KB` : 'Boyut bilinmiyor'}\n              </p>\n            </div>\n          </div>\n\n          {/* Controls */}\n          <div className=\"flex items-center space-x-2\">\n            {isImage && (\n              <>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={handleZoomOut}\n                  disabled={zoom <= 0.1}\n                  title=\"Uzaklaştır (-)\"\n                >\n                  <ZoomOut className=\"w-4 h-4\" />\n                </Button>\n                \n                <span className=\"text-sm text-gray-600 min-w-[60px] text-center\">\n                  {Math.round(zoom * 100)}%\n                </span>\n                \n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={handleZoomIn}\n                  disabled={zoom >= 5}\n                  title=\"Yakınlaştır (+)\"\n                >\n                  <ZoomIn className=\"w-4 h-4\" />\n                </Button>\n\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={handleZoomReset}\n                  title=\"Sıfırla (0)\"\n                >\n                  <Move className=\"w-4 h-4\" />\n                </Button>\n\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={handleRotate}\n                  title=\"Döndür (R)\"\n                >\n                  <RotateCw className=\"w-4 h-4\" />\n                </Button>\n              </>\n            )}\n\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={handleFullscreenToggle}\n              title=\"Tam Ekran (F)\"\n            >\n              {isFullscreen ? <Minimize2 className=\"w-4 h-4\" /> : <Maximize2 className=\"w-4 h-4\" />}\n            </Button>\n\n            {onDownload && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleDownloadClick}\n                title=\"İndir\"\n              >\n                <Download className=\"w-4 h-4\" />\n              </Button>\n            )}\n\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onClose}\n              title=\"Kapat (Esc)\"\n            >\n              <X className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div \n          ref={containerRef}\n          className=\"flex-1 overflow-hidden bg-gray-100 relative\"\n          onWheel={handleWheel}\n          onMouseDown={handleMouseDown}\n          onMouseMove={handleMouseMove}\n          onMouseUp={handleMouseUp}\n          onMouseLeave={handleMouseUp}\n        >\n          {isImage && document.fileUrl ? (\n            <div \n              className=\"w-full h-full flex items-center justify-center relative\"\n              onMouseEnter={handleMouseEnter}\n              onMouseLeave={handleMouseLeave}\n              onMouseMove={handleMouseMove}\n            >\n              <img\n                ref={imageRef}\n                src={document.fileUrl}\n                alt={document.filename}\n                className={`max-w-none transition-transform duration-200 ${isDragging ? 'cursor-grabbing' : zoom > 1 ? 'cursor-grab' : 'cursor-zoom-in'}`}\n                style={{\n                  transform: `scale(${zoom}) rotate(${rotation}deg) translate(${position.x / zoom}px, ${position.y / zoom}px)`,\n                  transformOrigin: 'center center'\n                }}\n                draggable={false}\n                onClick={zoom === 1 ? handleZoomIn : undefined}\n              />\n\n              {/* Magnifier */}\n              {showMagnifier && document.fileUrl && (\n                <div\n                  ref={magnifierRef}\n                  className=\"fixed pointer-events-none z-50 border-2 border-blue-500 rounded-full shadow-lg\"\n                  style={{\n                    left: magnifierPosition.x - 75,\n                    top: magnifierPosition.y - 75,\n                    width: 150,\n                    height: 150,\n                    backgroundImage: `url(${document.fileUrl})`,\n                    backgroundSize: `${(imageRef.current?.naturalWidth || 0) * 2}px ${(imageRef.current?.naturalHeight || 0) * 2}px`,\n                    backgroundRepeat: 'no-repeat'\n                  }}\n                />\n              )}\n            </div>\n          ) : isPDF && document.fileUrl ? (\n            <iframe\n              src={document.fileUrl}\n              className=\"w-full h-full border-none\"\n              title={document.filename}\n            />\n          ) : (\n            <div className=\"w-full h-full flex items-center justify-center\">\n              <div className=\"text-center\">\n                <FileText className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-gray-600\">Önizleme mevcut değil</p>\n                <p className=\"text-sm text-gray-500 mt-2\">\n                  Bu dosya türü için önizleme desteklenmiyor\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Footer with shortcuts */}\n        <div className=\"px-4 py-2 bg-gray-50 border-t text-xs text-gray-500 flex-shrink-0\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              {isImage && (\n                <span>\n                  Kısayollar: + Yakınlaştır, - Uzaklaştır, 0 Sıfırla, R Döndür, F Tam Ekran\n                </span>\n              )}\n            </div>\n            <div>\n              {document.extractedInfo?.confidence && (\n                <span>OCR Güven: {Math.round(document.extractedInfo.confidence * 100)}%</span>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default DocumentViewer;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/PatientSearch.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[393,396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[393,396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Modal, Button, Input } from '@x-ear/ui-web';\nimport { Search, User, Check } from 'lucide-react';\nimport { usePatients } from '../../hooks/usePatients';\nimport { type Patient } from '../../types/patient';\n\ninterface PatientSearchProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelect: (patient: Patient) => void;\n  ocrResult?: any;\n}\n\nconst PatientSearch: React.FC<PatientSearchProps> = ({\n  isOpen,\n  onClose,\n  onSelect,\n  ocrResult,\n}) => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedPatient, setSelectedPatient] = useState<Patient | null>(null);\n  const { patients, isLoading } = usePatients();\n\n  // Auto-suggest based on OCR result\n  useEffect(() => {\n    if (ocrResult?.matched_patient?.patient) {\n      setSelectedPatient(ocrResult.matched_patient.patient);\n    }\n  }, [ocrResult]);\n\n  const filteredPatients =\n    patients?.filter((patient: Patient): patient is Patient & { id: string } => {\n      if (!patient.id) {\n        return false;\n      }\n      const fullName = `${patient.firstName} ${patient.lastName}`.toLowerCase();\n      const tc = patient.tcNumber || '';\n      const phone = patient.phone || '';\n      const search = searchTerm.toLowerCase();\n\n      return (\n        fullName.includes(search) ||\n        tc.includes(search) ||\n        phone.includes(search)\n      );\n    }) || [];\n\n  const handleSelect = () => {\n    if (selectedPatient) {\n      onSelect(selectedPatient);\n    }\n  };\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title=\"Hasta Seç\">\n      <div className=\"space-y-4\">\n        {/* OCR Suggestion */}\n        {ocrResult?.matched_patient && (\n          <div className=\"p-3 bg-blue-50 rounded-lg\">\n            <div className=\"text-sm font-medium text-blue-800 mb-1\">\n              OCR Önerisi\n            </div>\n            <div className=\"text-sm text-blue-700\">\n              {ocrResult.matched_patient.patient?.fullName}\n              {ocrResult.matched_patient.match_details?.confidence && (\n                <span className=\"ml-2 text-xs\">\n                  ({Math.round(ocrResult.matched_patient.match_details.confidence * 100)}% güven)\n                </span>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Search Input */}\n        <div>\n          <label className=\"block text-sm font-medium mb-2\">\n            Hasta Ara\n          </label>\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n            <Input\n              placeholder=\"İsim, TC veya telefon ile ara...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n        </div>\n\n        {/* Patient List */}\n        <div className=\"max-h-64 overflow-y-auto border rounded-lg\">\n          {isLoading ? (\n            <div className=\"p-4 text-center text-gray-500\">Yükleniyor...</div>\n          ) : filteredPatients.length === 0 ? (\n            <div className=\"p-4 text-center text-gray-500\">\n              {searchTerm ? 'Hasta bulunamadı' : 'Arama yapmak için yazın'}\n            </div>\n          ) : (\n            <div className=\"divide-y\">\n              {filteredPatients.slice(0, 10).map((patient: Patient) => (\n                <div\n                  key={patient.id}\n                  className={`p-3 cursor-pointer hover:bg-gray-50 flex items-center justify-between ${\n                    selectedPatient?.id === patient.id ? 'bg-blue-50' : ''\n                  }`}\n                  onClick={() => setSelectedPatient(patient)}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <User className=\"w-4 h-4 text-gray-400\" />\n                    <div>\n                      <div className=\"font-medium\">\n                        {patient.firstName} {patient.lastName}\n                      </div>\n                      <div className=\"text-sm text-gray-500\">\n                        {patient.tcNumber && `TC: ${patient.tcNumber}`}\n                        {patient.phone && ` • Tel: ${patient.phone}`}\n                      </div>\n                    </div>\n                  </div>\n                  {selectedPatient?.id === patient.id && (\n                    <Check className=\"w-4 h-4 text-blue-600\" />\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex items-center justify-end gap-2 pt-4 border-t\">\n          <Button variant=\"ghost\" onClick={onClose}>\n            İptal\n          </Button>\n          <Button\n            onClick={handleSelect}\n            disabled={!selectedPatient}\n          >\n            Seç\n          </Button>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport default PatientSearch;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/ProcessingResults.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[471,474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[471,474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[575,578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[575,578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isProcessing' is defined but never used.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1282,1285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1282,1285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button, Card, CardContent, CardHeader, CardTitle } from '@x-ear/ui-web';\nimport { CheckCircle, XCircle, FileText, User, Search } from 'lucide-react';\nimport DocumentPreview from './DocumentPreview';\nimport PatientSearch from './PatientSearch';\nimport DocumentTypeSelector from './DocumentTypeSelector';\n\ninterface ProcessingResult {\n  fileName: string;\n  status: 'processed' | 'error';\n  result?: {\n    matched_patient?: any;\n    pdf_generated?: boolean;\n    pdf_filename?: string;\n    document_type?: string;\n    entities?: any[];\n  };\n  error?: string;\n}\n\ninterface ProcessingResultsProps {\n  results: ProcessingResult[];\n  isProcessing: boolean;\n  onRetry: () => void;\n}\n\nconst ProcessingResults: React.FC<ProcessingResultsProps> = ({\n  results,\n  isProcessing,\n  onRetry,\n}) => {\n  const [selectedResult, setSelectedResult] = useState<ProcessingResult | null>(null);\n  const [showPatientSearch, setShowPatientSearch] = useState(false);\n  const [showDocumentTypeSelector, setShowDocumentTypeSelector] = useState(false);\n\n  const successfulResults = results.filter(r => r.status === 'processed');\n  const errorResults = results.filter(r => r.status === 'error');\n\n  const handlePatientSelect = (result: ProcessingResult, patient: any) => {\n    // TODO: Update result with selected patient\n    console.log('Patient selected:', patient, 'for result:', result);\n    setShowPatientSearch(false);\n  };\n\n  const handleDocumentTypeSelect = (result: ProcessingResult, docType: string) => {\n    // TODO: Update result with selected document type\n    console.log('Document type selected:', docType, 'for result:', result);\n    setShowDocumentTypeSelector(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-xl font-semibold\">İşleme Sonuçları</h2>\n        <Button onClick={onRetry} variant=\"outline\">\n          Tekrar Yükle\n        </Button>\n      </div>\n\n      {/* Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <FileText className=\"w-4 h-4\" />\n              Toplam Dosya\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{results.length}</div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2 text-green-600\">\n              <CheckCircle className=\"w-4 h-4\" />\n              Başarılı\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-600\">{successfulResults.length}</div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2 text-red-600\">\n              <XCircle className=\"w-4 h-4\" />\n              Hata\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-red-600\">{errorResults.length}</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Results Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {results.map((result, index) => (\n          <Card key={index} className=\"cursor-pointer hover:shadow-md transition-shadow\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-medium truncate\">\n                {result.fileName}\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {result.status === 'processed' ? (\n                <>\n                  <div className=\"flex items-center gap-2 text-green-600\">\n                    <CheckCircle className=\"w-4 h-4\" />\n                    <span className=\"text-sm\">İşlendi</span>\n                  </div>\n\n                  {result.result?.matched_patient ? (\n                    <div className=\"flex items-center gap-2 text-blue-600\">\n                      <User className=\"w-4 h-4\" />\n                      <span className=\"text-sm\">\n                        {result.result.matched_patient.patient?.fullName || 'Hasta bulundu'}\n                      </span>\n                    </div>\n                  ) : (\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => {\n                        setSelectedResult(result);\n                        setShowPatientSearch(true);\n                      }}\n                      className=\"w-full\"\n                    >\n                      <Search className=\"w-4 h-4 mr-1\" />\n                      Hasta Seç\n                    </Button>\n                  )}\n\n                  <div className=\"text-xs text-gray-500\">\n                    Tür: {result.result?.document_type || 'Belirlenemedi'}\n                  </div>\n\n                  {result.result?.pdf_generated && (\n                    <div className=\"text-xs text-green-600\">\n                      PDF oluşturuldu: {result.result.pdf_filename}\n                    </div>\n                  )}\n\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={() => setSelectedResult(result)}\n                    className=\"w-full\"\n                  >\n                    Önizle\n                  </Button>\n                </>\n              ) : (\n                <>\n                  <div className=\"flex items-center gap-2 text-red-600\">\n                    <XCircle className=\"w-4 h-4\" />\n                    <span className=\"text-sm\">Hata</span>\n                  </div>\n                  <div className=\"text-xs text-red-500\">\n                    {result.error}\n                  </div>\n                </>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Modals */}\n      {selectedResult && (\n        <DocumentPreview\n          result={selectedResult}\n          isOpen={!!selectedResult}\n          onClose={() => setSelectedResult(null)}\n          onChangeDocumentType={() => {\n            setShowDocumentTypeSelector(true);\n          }}\n        />\n      )}\n\n      {showPatientSearch && selectedResult && (\n        <PatientSearch\n          isOpen={showPatientSearch}\n          onClose={() => setShowPatientSearch(false)}\n          onSelect={(patient) => handlePatientSelect(selectedResult, patient)}\n          ocrResult={selectedResult.result}\n        />\n      )}\n\n      {showDocumentTypeSelector && selectedResult && (\n        <DocumentTypeSelector\n          isOpen={showDocumentTypeSelector}\n          onClose={() => setShowDocumentTypeSelector(false)}\n          onSelect={(docType) => handleDocumentTypeSelect(selectedResult, docType)}\n          currentType={selectedResult.result?.document_type}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ProcessingResults;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/SGKList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[377,380],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[377,380],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport DocumentList from '@/components/sgk/DocumentList';\nimport { Input, Button } from '@x-ear/ui-web';\n\nexport default function SGKList() {\n  const [patientId, setPatientId] = useState('');\n\n  return (\n    <div>\n      <div className=\"mb-4 flex gap-2 items-center\">\n        <Input placeholder=\"Hasta ID girin\" value={patientId} onChange={(e: any) => setPatientId(e.target.value)} />\n        <Button onClick={() => { /* noop for now */ }}>Ara</Button>\n      </div>\n\n      {patientId ? (\n        <DocumentList patientId={patientId} />\n      ) : (\n        <div className=\"p-4 bg-gray-50 rounded\">Hasta ID girin veya bir hasta seçin.</div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/sgk/__tests__/DocumentList.spec.tsx","messages":[{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":3,"column":3,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":3,"endColumn":56},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":4,"column":3,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":4,"endColumn":50},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":5,"column":3,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":5,"endColumn":36},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[162,165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[162,165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[170,173],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[170,173],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[461,464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[461,464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[540,543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[540,543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[609,612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[609,612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientId' is defined but never used.","line":21,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientId' is defined but never used.","line":22,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientId' is defined but never used.","line":23,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":43}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Test globals\ndeclare global {\n  var describe: (name: string, fn: () => void) => void;\n  var it: (name: string, fn: () => void) => void;\n  var expect: (actual: any) => any;\n}\n\nimport React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport { vi } from 'vitest';\n\n// Mock ui primitives to avoid loading the real Modal (which depends on browser internals/hooks)\nvi.mock('@x-ear/ui-web', () => ({\n  __esModule: true,\n  Button: (props: any) => React.createElement('button', props, props.children),\n  Input: (props: any) => React.createElement('input', props),\n  Modal: ({ children }: any) => React.createElement('div', null, children),\n}));\n\nvi.mock('@/hooks/sgk/useSgkDocuments', () => ({\n  useSgkDocuments: (patientId: string) => ({ data: { data: [{ id: 'temp-1', filename: 'f.txt', status: 'queued' }] }, isLoading: false, isError: false }),\n  useUploadSgkDocument: (patientId: string) => ({ mutate: vi.fn(), isLoading: false }),\n  useDeleteSgkDocument: (patientId: string) => ({ mutate: vi.fn() }),\n}));\n\nimport DocumentList from '../DocumentList';\n\ndescribe('DocumentList', () => {\n  it('shows queued badge for queued documents', () => {\n    render(<DocumentList patientId=\"patient-1\" />);\n    expect(screen.getByText(/Queued/i)).toBeInTheDocument();\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/templates/InvoiceTemplateManager.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadTemplates'. Either include it or remove the dependency array.","line":69,"column":6,"nodeType":"ArrayExpression","endLine":69,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadTemplates]","fix":{"range":[1926,1928],"text":"[loadTemplates]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":191,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5366,5369],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5366,5369],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":353,"column":89,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":353,"endColumn":92,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10912,10915],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10912,10915],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":370,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":370,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11649,11652],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11649,11652],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":568,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":568,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18689,18692],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18689,18692],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":670,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":670,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22674,22677],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22674,22677],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":671,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":671,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22710,22713],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22710,22713],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":671,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":671,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22737,22740],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22737,22740],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select, Textarea } from '@x-ear/ui-web';\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { InvoiceTemplate, CreateInvoiceTemplateData, UpdateInvoiceTemplateData } from '../../types/invoice';\nimport { InvoiceTemplateService } from '../../services/InvoiceTemplateService';\nimport { DynamicInvoiceForm } from '../forms/DynamicInvoiceForm';\n\ninterface InvoiceTemplateManagerProps {\n  onTemplateSelect?: (template: InvoiceTemplate) => void;\n  onTemplateCreate?: (template: InvoiceTemplate) => void;\n  onTemplateUpdate?: (template: InvoiceTemplate) => void;\n  onTemplateDelete?: (templateId: string) => void;\n  className?: string;\n}\n\ninterface TemplateManagerState {\n  templates: InvoiceTemplate[];\n  isLoading: boolean;\n  error: string | null;\n  searchQuery: string;\n  selectedCategory: string;\n  sortBy: 'name' | 'createdAt' | 'usageCount';\n  sortOrder: 'asc' | 'desc';\n}\n\ninterface TemplateFormState {\n  isOpen: boolean;\n  mode: 'create' | 'edit' | 'view';\n  template: InvoiceTemplate | null;\n  isSubmitting: boolean;\n}\n\nexport const InvoiceTemplateManager: React.FC<InvoiceTemplateManagerProps> = ({\n  onTemplateSelect,\n  onTemplateCreate,\n  onTemplateUpdate,\n  onTemplateDelete,\n  className = ''\n}) => {\n  const [state, setState] = useState<TemplateManagerState>({\n    templates: [],\n    isLoading: true,\n    error: null,\n    searchQuery: '',\n    selectedCategory: 'all',\n    sortBy: 'name',\n    sortOrder: 'asc'\n  });\n\n  const [formState, setFormState] = useState<TemplateFormState>({\n    isOpen: false,\n    mode: 'create',\n    template: null,\n    isSubmitting: false\n  });\n\n  const [confirmDialog, setConfirmDialog] = useState<{\n    isOpen: boolean;\n    templateId: string | null;\n    templateName: string;\n  }>({\n    isOpen: false,\n    templateId: null,\n    templateName: ''\n  });\n\n  // Load templates on component mount\n  useEffect(() => {\n    loadTemplates();\n  }, []);\n\n  const loadTemplates = useCallback(async () => {\n    setState(prev => ({ ...prev, isLoading: true, error: null }));\n    \n    try {\n      const templates = await InvoiceTemplateService.getTemplates();\n      setState(prev => ({\n        ...prev,\n        templates,\n        isLoading: false\n      }));\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : 'Şablonlar yüklenirken hata oluştu',\n        isLoading: false\n      }));\n    }\n  }, []);\n\n  // Filter and sort templates\n  const filteredAndSortedTemplates = useMemo(() => {\n    let filtered = state.templates;\n\n    // Apply search filter\n    if (state.searchQuery) {\n      const query = state.searchQuery.toLowerCase();\n      filtered = filtered.filter(template =>\n        template.name.toLowerCase().includes(query) ||\n        template.description?.toLowerCase().includes(query) ||\n        template.category.toLowerCase().includes(query)\n      );\n    }\n\n    // Apply category filter\n    if (state.selectedCategory !== 'all') {\n      filtered = filtered.filter(template => template.category === state.selectedCategory);\n    }\n\n    // Apply sorting\n    filtered.sort((a, b) => {\n      let comparison = 0;\n      \n      switch (state.sortBy) {\n        case 'name':\n          comparison = a.name.localeCompare(b.name, 'tr');\n          break;\n        case 'createdAt':\n          comparison = new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime();\n          break;\n        case 'usageCount':\n          comparison = (a.usageCount || 0) - (b.usageCount || 0);\n          break;\n      }\n\n      return state.sortOrder === 'desc' ? -comparison : comparison;\n    });\n\n    return filtered;\n  }, [state.templates, state.searchQuery, state.selectedCategory, state.sortBy, state.sortOrder]);\n\n  // Get unique categories\n  const categories = useMemo(() => {\n    const uniqueCategories = [...new Set(state.templates.map(t => t.category))];\n    return uniqueCategories.sort();\n  }, [state.templates]);\n\n  const handleCreateTemplate = useCallback(() => {\n    setFormState({\n      isOpen: true,\n      mode: 'create',\n      template: null,\n      isSubmitting: false\n    });\n  }, []);\n\n  const handleEditTemplate = useCallback((template: InvoiceTemplate) => {\n    setFormState({\n      isOpen: true,\n      mode: 'edit',\n      template,\n      isSubmitting: false\n    });\n  }, []);\n\n  const handleViewTemplate = useCallback((template: InvoiceTemplate) => {\n    setFormState({\n      isOpen: true,\n      mode: 'view',\n      template,\n      isSubmitting: false\n    });\n  }, []);\n\n  const handleDeleteTemplate = useCallback((template: InvoiceTemplate) => {\n    setConfirmDialog({\n      isOpen: true,\n      templateId: template.id,\n      templateName: template.name\n    });\n  }, []);\n\n  const handleDuplicateTemplate = useCallback(async (template: InvoiceTemplate) => {\n    try {\n      const duplicatedTemplate = await InvoiceTemplateService.duplicateTemplate(template.id);\n      setState(prev => ({\n        ...prev,\n        templates: [...prev.templates, duplicatedTemplate]\n      }));\n      \n      if (onTemplateCreate) {\n        onTemplateCreate(duplicatedTemplate);\n      }\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : 'Şablon kopyalanırken hata oluştu'\n      }));\n    }\n  }, [onTemplateCreate]);\n\n  const handleFormSubmit = useCallback(async (formData: any) => {\n    setFormState(prev => ({ ...prev, isSubmitting: true }));\n\n    try {\n      let result: InvoiceTemplate;\n\n      if (formState.mode === 'create') {\n        const createData: CreateInvoiceTemplateData = {\n          name: formData.name,\n          description: formData.description,\n          category: formData.category,\n          templateData: formData,\n          isActive: true\n        };\n        \n        result = await InvoiceTemplateService.createTemplate(createData);\n        setState(prev => ({\n          ...prev,\n          templates: [...prev.templates, result]\n        }));\n        \n        if (onTemplateCreate) {\n          onTemplateCreate(result);\n        }\n      } else if (formState.mode === 'edit' && formState.template) {\n        const updateData: UpdateInvoiceTemplateData = {\n          name: formData.name,\n          description: formData.description,\n          category: formData.category,\n          templateData: formData\n        };\n        \n        result = await InvoiceTemplateService.updateTemplate(formState.template.id, updateData);\n        setState(prev => ({\n          ...prev,\n          templates: prev.templates.map(t => t.id === result.id ? result : t)\n        }));\n        \n        if (onTemplateUpdate) {\n          onTemplateUpdate(result);\n        }\n      }\n\n      setFormState({\n        isOpen: false,\n        mode: 'create',\n        template: null,\n        isSubmitting: false\n      });\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : 'Şablon kaydedilirken hata oluştu'\n      }));\n      setFormState(prev => ({ ...prev, isSubmitting: false }));\n    }\n  }, [formState.mode, formState.template, onTemplateCreate, onTemplateUpdate]);\n\n  const confirmDelete = useCallback(async () => {\n    if (!confirmDialog.templateId) return;\n\n    try {\n      await InvoiceTemplateService.deleteTemplate(confirmDialog.templateId);\n      setState(prev => ({\n        ...prev,\n        templates: prev.templates.filter(t => t.id !== confirmDialog.templateId)\n      }));\n      \n      if (onTemplateDelete) {\n        onTemplateDelete(confirmDialog.templateId);\n      }\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : 'Şablon silinirken hata oluştu'\n      }));\n    }\n\n    setConfirmDialog({ isOpen: false, templateId: null, templateName: '' });\n  }, [confirmDialog.templateId, onTemplateDelete]);\n\n  const cancelDelete = useCallback(() => {\n    setConfirmDialog({ isOpen: false, templateId: null, templateName: '' });\n  }, []);\n\n  const closeForm = useCallback(() => {\n    setFormState({\n      isOpen: false,\n      mode: 'create',\n      template: null,\n      isSubmitting: false\n    });\n  }, []);\n\n  if (state.isLoading) {\n    return (\n      <div className={`template-manager-loading ${className}`}>\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-600\">Şablonlar yükleniyor...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`invoice-template-manager ${className}`}>\n      {/* Header */}\n      <div className=\"template-manager-header mb-6\">\n        <div className=\"flex justify-between items-center mb-4\">\n          <h2 className=\"text-2xl font-bold text-gray-900\">Fatura Şablonları</h2>\n          <Button\n            onClick={handleCreateTemplate}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium\"\n            variant='default'>\n            + Yeni Şablon\n          </Button>\n        </div>\n\n        {/* Filters and Search */}\n        <div className=\"filters-section bg-gray-50 rounded-lg p-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            {/* Search */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Arama\n              </label>\n              <Input\n                type=\"text\"\n                value={state.searchQuery}\n                onChange={(e) => setState(prev => ({ ...prev, searchQuery: e.target.value }))}\n                placeholder=\"Şablon adı, açıklama...\"\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n\n            {/* Category Filter */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Kategori\n              </label>\n              <Select\n                value={state.selectedCategory}\n                onChange={(e) => setState(prev => ({ ...prev, selectedCategory: e.target.value }))}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                options={[\n                  { value: \"all\", label: \"Tüm Kategoriler\" },\n                  ...categories.map(category => ({\n                    value: category,\n                    label: getCategoryLabel(category)\n                  }))\n                ]}\n              />\n            </div>\n\n            {/* Sort By */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Sıralama\n              </label>\n              <Select\n                value={state.sortBy}\n                onChange={(e) => setState(prev => ({ ...prev, sortBy: e.target.value as any }))}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                options={[\n                  { value: \"name\", label: \"İsim\" },\n                  { value: \"createdAt\", label: \"Oluşturma Tarihi\" },\n                  { value: \"usageCount\", label: \"Kullanım Sayısı\" }\n                ]}\n              />\n            </div>\n\n            {/* Sort Order */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Sıra\n              </label>\n              <Select\n                value={state.sortOrder}\n                onChange={(e) => setState(prev => ({ ...prev, sortOrder: e.target.value as any }))}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                options={[\n                  { value: \"asc\", label: \"Artan\" },\n                  { value: \"desc\", label: \"Azalan\" }\n                ]}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      {/* Error Display */}\n      {state.error && (\n        <div className=\"error-message bg-red-50 border border-red-200 rounded-lg p-4 mb-6\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <span className=\"text-red-400\">⚠️</span>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n              <p className=\"mt-1 text-sm text-red-700\">{state.error}</p>\n            </div>\n            <div className=\"ml-auto pl-3\">\n              <Button\n                onClick={() => setState(prev => ({ ...prev, error: null }))}\n                className=\"text-red-400 hover:text-red-600\"\n                variant='default'>\n                ✕\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n      {/* Templates Grid */}\n      <div className=\"templates-grid\">\n        {filteredAndSortedTemplates.length === 0 ? (\n          <div className=\"empty-state text-center py-12\">\n            <div className=\"text-gray-400 text-6xl mb-4\">📄</div>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n              {state.searchQuery || state.selectedCategory !== 'all' \n                ? 'Arama kriterlerine uygun şablon bulunamadı'\n                : 'Henüz şablon oluşturulmamış'\n              }\n            </h3>\n            <p className=\"text-gray-600 mb-4\">\n              {state.searchQuery || state.selectedCategory !== 'all'\n                ? 'Farklı arama kriterleri deneyin'\n                : 'İlk şablonunuzu oluşturmak için \"Yeni Şablon\" butonuna tıklayın'\n              }\n            </p>\n            {(!state.searchQuery && state.selectedCategory === 'all') && (\n              <Button\n                onClick={handleCreateTemplate}\n                className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium\"\n                variant='default'>\n                Yeni Şablon Oluştur\n              </Button>\n            )}\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredAndSortedTemplates.map((template) => (\n              <TemplateCard\n                key={template.id}\n                template={template}\n                onSelect={() => onTemplateSelect?.(template)}\n                onEdit={() => handleEditTemplate(template)}\n                onView={() => handleViewTemplate(template)}\n                onDelete={() => handleDeleteTemplate(template)}\n                onDuplicate={() => handleDuplicateTemplate(template)}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n      {/* Template Form Modal */}\n      {formState.isOpen && (\n        <TemplateFormModal\n          mode={formState.mode}\n          template={formState.template}\n          isSubmitting={formState.isSubmitting}\n          onSubmit={handleFormSubmit}\n          onClose={closeForm}\n        />\n      )}\n      {/* Delete Confirmation Dialog */}\n      {confirmDialog.isOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\n            <h3 className=\"font-medium text-lg mb-4\">Şablonu Sil</h3>\n            <p className=\"text-gray-700 mb-6\">\n              \"<strong>{confirmDialog.templateName}</strong>\" şablonunu silmek istediğinizden emin misiniz? \n              Bu işlem geri alınamaz.\n            </p>\n            <div className=\"flex justify-end gap-3\">\n              <Button\n                onClick={cancelDelete}\n                className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50\"\n                variant='default'>\n                İptal\n              </Button>\n              <Button\n                onClick={confirmDelete}\n                className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\n                variant='default'>\n                Sil\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Template Card Component\ninterface TemplateCardProps {\n  template: InvoiceTemplate;\n  onSelect?: () => void;\n  onEdit?: () => void;\n  onView?: () => void;\n  onDelete?: () => void;\n  onDuplicate?: () => void;\n}\n\nconst TemplateCard: React.FC<TemplateCardProps> = ({\n  template,\n  onSelect,\n  onEdit,\n  onView,\n  onDelete,\n  onDuplicate\n}) => {\n  return (\n    <div className=\"template-card bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow\">\n      <div className=\"flex justify-between items-start mb-4\">\n        <div className=\"flex-1\">\n          <h3 className=\"font-medium text-lg text-gray-900 mb-1\">{template.name}</h3>\n          <p className=\"text-sm text-gray-600 mb-2\">{template.description}</p>\n          <span className=\"inline-block px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded\">\n            {getCategoryLabel(template.category)}\n          </span>\n        </div>\n        \n        <div className=\"flex items-center space-x-1\">\n          <Button\n            onClick={onView}\n            className=\"p-1 text-gray-400 hover:text-gray-600\"\n            title=\"Görüntüle\"\n            variant='default'>\n            👁️\n          </Button>\n          <Button\n            onClick={onEdit}\n            className=\"p-1 text-gray-400 hover:text-blue-600\"\n            title=\"Düzenle\"\n            variant='default'>\n            ✏️\n          </Button>\n          <Button\n            onClick={onDuplicate}\n            className=\"p-1 text-gray-400 hover:text-green-600\"\n            title=\"Kopyala\"\n            variant='default'>\n            📋\n          </Button>\n          <Button\n            onClick={onDelete}\n            className=\"p-1 text-gray-400 hover:text-red-600\"\n            title=\"Sil\"\n            variant='default'>\n            🗑️\n          </Button>\n        </div>\n      </div>\n      <div className=\"template-stats text-sm text-gray-500 mb-4\">\n        <div className=\"flex justify-between\">\n          <span>Kullanım: {template.usageCount || 0}</span>\n          <span>{new Date(template.createdAt).toLocaleDateString('tr-TR')}</span>\n        </div>\n      </div>\n      <div className=\"template-actions\">\n        <Button\n          onClick={onSelect}\n          className=\"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium\"\n          variant='default'>\n          Şablonu Kullan\n        </Button>\n      </div>\n    </div>\n  );\n};\n\n// Template Form Modal Component\ninterface TemplateFormModalProps {\n  mode: 'create' | 'edit' | 'view';\n  template: InvoiceTemplate | null;\n  isSubmitting: boolean;\n  onSubmit: (data: any) => void;\n  onClose: () => void;\n}\n\nconst TemplateFormModal: React.FC<TemplateFormModalProps> = ({\n  mode,\n  template,\n  isSubmitting,\n  onSubmit,\n  onClose\n}) => {\n  const [formData, setFormData] = useState({\n    name: template?.name || '',\n    description: template?.description || '',\n    category: template?.category || 'general',\n    ...(template?.templateData || {})\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit(formData);\n  };\n\n  const isReadOnly = mode === 'view';\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto mx-4\">\n        <div className=\"sticky top-0 bg-white border-b px-6 py-4\">\n          <div className=\"flex justify-between items-center\">\n            <h2 className=\"text-xl font-bold\">\n              {mode === 'create' && 'Yeni Şablon Oluştur'}\n              {mode === 'edit' && 'Şablonu Düzenle'}\n              {mode === 'view' && 'Şablon Detayları'}\n            </h2>\n            <Button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600\"\n              variant='default'>\n              ✕\n            </Button>\n          </div>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"p-6\">\n          {/* Template Metadata */}\n          <div className=\"template-metadata mb-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Şablon Adı *\n                </label>\n                <Input\n                  type=\"text\"\n                  value={formData.name}\n                  onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}\n                  disabled={isReadOnly}\n                  required\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Kategori\n                </label>\n                <Select\n                  value={formData.category}\n                  onChange={(e) => setFormData(prev => ({ ...prev, category: e.target.value }))}\n                  disabled={isReadOnly}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100\"\n                  options={[\n                    { value: \"general\", label: \"Genel\" },\n                    { value: \"medical\", label: \"Tıbbi\" },\n                    { value: \"dental\", label: \"Diş\" },\n                    { value: \"consultation\", label: \"Konsültasyon\" },\n                    { value: \"treatment\", label: \"Tedavi\" },\n                    { value: \"surgery\", label: \"Cerrahi\" }\n                  ]}\n                />\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Açıklama\n              </label>\n              <Textarea\n                value={formData.description}\n                onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}\n                disabled={isReadOnly}\n                rows={3}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100\"\n                placeholder=\"Şablon açıklaması...\"\n              />\n            </div>\n          </div>\n\n          {/* Dynamic Invoice Form */}\n          <div className=\"template-form-content\">\n            <h3 className=\"text-lg font-medium mb-4\">Fatura Şablonu</h3>\n            <DynamicInvoiceForm\n              initialData={template?.templateData as any}\n              onSubmit={(data: any) => setFormData((prev: any) => ({ ...prev, ...data }))}\n              disabled={isReadOnly}\n            />\n          </div>\n\n          {/* Form Actions */}\n          {!isReadOnly && (\n            <div className=\"form-actions sticky bottom-0 bg-white border-t pt-4 mt-6\">\n              <div className=\"flex justify-end gap-3\">\n                <Button\n                  type=\"button\"\n                  onClick={onClose}\n                  disabled={isSubmitting}\n                  className=\"px-6 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50\"\n                  variant='default'>\n                  İptal\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={isSubmitting}\n                  className=\"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\n                  variant='default'>\n                  {isSubmitting ? 'Kaydediliyor...' : (mode === 'create' ? 'Oluştur' : 'Güncelle')}\n                </Button>\n              </div>\n            </div>\n          )}\n        </form>\n      </div>\n    </div>\n  );\n};\n\n// Helper function to get category label in Turkish\nfunction getCategoryLabel(category: string): string {\n  const categoryLabels: Record<string, string> = {\n    'general': 'Genel',\n    'medical': 'Tıbbi',\n    'dental': 'Diş',\n    'consultation': 'Konsültasyon',\n    'treatment': 'Tedavi',\n    'surgery': 'Cerrahi'\n  };\n  return categoryLabels[category] || category;\n}\n\nexport default InvoiceTemplateManager;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/ui/Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/ui/ConfirmDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/ui/Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/uts/UTSBulkUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[494,497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[494,497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[981,984],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[981,984],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1154,1157],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1154,1157],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1197,1200],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1197,1200],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":55,"column":9,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":55,"endColumn":120},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2257,2260],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2257,2260],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2918,2921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2918,2921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3437,3440],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3437,3440],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { Button } from '@x-ear/ui-web';\nimport { useStartBulkUtsRegistration } from '@/hooks/uts/useUts';\nimport { outbox } from '@/utils/outbox';\nimport parseAndMapCsv from '@/utils/uts-csv';\n\nexport const UTSBulkUpload: React.FC<{ onStarted?: (jobId: string) => void }> = ({ onStarted }) => {\n  const [fileContent, setFileContent] = React.useState<string>('');\n  const startBulk = useStartBulkUtsRegistration();\n\n  const [preview, setPreview] = React.useState<any | null>(null);\n\n  const handleFile = (file: File | null) => {\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = () => {\n      const text = String(reader.result || '');\n      setFileContent(text);\n      const parsed = parseAndMapCsv(text);\n      setPreview(parsed);\n    };\n    reader.readAsText(file);\n  };\n\n  const handleSubmit = async () => {\n    // Parse CSV\n    const parsed = parseAndMapCsv(fileContent);\n    const mappedRows = parsed.mapped.map((m:any) => m.mapped);\n\n    try {\n      const res = await startBulk.mutateAsync({ rows: mappedRows });\n      // If backend returns jobId, notify parent\n      if (res && (res as any).jobId && onStarted) onStarted((res as any).jobId);\n    } catch (err) {\n      // On failure (likely offline), enqueue to outbox\n      try {\n        await outbox.addOperation({\n          method: 'POST',\n          endpoint: '/api/uts/registrations/bulk',\n          data: { rows: mappedRows },\n          headers: { 'Idempotency-Key': `uts_bulk_${Date.now()}` },\n          maxRetries: 5,\n        });\n        // Notify user via event or toast (omitted here)\n      } catch (e) {\n        console.error('Failed to enqueue UTS bulk operation', e);\n        throw e;\n      }\n    }\n  };\n\n  return (\n    <div>\n      <div>\n        <input type=\"file\" accept=\"text/csv\" onChange={(e) => handleFile(e.target.files ? e.target.files[0] : null)} />\n      </div>\n      {preview && (\n        <div style={{ marginTop: 8 }}>\n          <h4>Önizleme ({Array.isArray(preview.rows) ? preview.rows.length : preview.mapped?.length ?? 0})</h4>\n          {preview.errors && preview.errors.length > 0 && (\n            <div style={{ color: 'red' }}>\n              Hatalar:\n              <ul>\n                {preview.errors.map((err:any, idx:number) => (\n                  <li key={idx}>Satır {err.row + 1}: {err.errors.join(', ')}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n          <div style={{ maxHeight: 200, overflow: 'auto', border: '1px solid #eee', padding: 8 }}>\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\n              <thead>\n                <tr>\n                  <th>Serial</th>\n                  <th>Manufacturer</th>\n                  <th>Model</th>\n                  <th>Patient TC</th>\n                </tr>\n              </thead>\n              <tbody>\n                {preview.mapped && preview.mapped.map((m:any, i:number) => (\n                  <tr key={i} style={{ borderTop: '1px solid #f3f3f3' }}>\n                    <td>{m.mapped.serial}</td>\n                    <td>{m.mapped.manufacturer}</td>\n                    <td>{m.mapped.model}</td>\n                    <td>{m.mapped.patientTc}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n      <div style={{ marginTop: 8 }}>\n        <Button onClick={handleSubmit} disabled={(startBulk as any).isLoading || !fileContent}>\n          CSV ile Toplu Kayıt\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default UTSBulkUpload;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/components/uts/UTSRegisterModal.tsx","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Textarea component from @x-ear/ui-web instead of raw <textarea> elements. Add data-allow-raw=\"true\" if raw textarea is intentional.","line":39,"column":13,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":39,"endColumn":81}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { useForm } from 'react-hook-form';\nimport { z } from 'zod';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { Button } from '@x-ear/ui-web';\nimport { useStartBulkUtsRegistration } from '@/hooks/uts/useUts';\n\nconst Schema = z.object({\n  csv: z.string().min(1, 'CSV boş olamaz')\n});\n\ntype FormValues = z.infer<typeof Schema>;\n\nexport const UTSRegisterModal: React.FC<{\n  open: boolean;\n  onClose: () => void;\n}> = ({ open, onClose }) => {\n  const { register, handleSubmit, formState: { errors } } = useForm<FormValues>({ resolver: zodResolver(Schema) });\n  const startBulk = useStartBulkUtsRegistration();\n\n  const onSubmit = async (data: FormValues) => {\n    try {\n      await startBulk.mutateAsync({ csv: data.csv });\n      onClose();\n    } catch (e) {\n      // on error, outbox fallback handled in UTSBulkUpload or service layer\n      console.error('UTS bulk start failed', e);\n    }\n  };\n\n  if (!open) return null;\n\n  return (\n    <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.4)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 2000 }}>\n      <div style={{ background: 'white', padding: 16, width: '640px', borderRadius: 8 }}>\n        <h3>ÜTS Toplu Kayıt Başlat</h3>\n        <form onSubmit={handleSubmit(onSubmit)}>\n          <div>\n            <textarea {...register('csv')} rows={8} style={{ width: '100%' }} />\n            {errors.csv && <div style={{ color: 'red' }}>{errors.csv.message}</div>}\n          </div>\n          <div style={{ marginTop: 12, display: 'flex', gap: 8, justifyContent: 'flex-end' }}>\n            <Button type=\"button\" variant=\"ghost\" onClick={onClose}>İptal</Button>\n            <Button type=\"submit\">Başlat</Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default UTSRegisterModal;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/config/dev-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/constants/generated-storage-keys.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/constants/patient/constants.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3176,3179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3176,3179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Patient-related constants and configuration\n// Following the storage keys registry pattern from user rules\n\nexport const PATIENT_CONSTANTS = {\n  // API endpoints\n  API_BASE: '/api/patients',\n  \n  // Pagination\n  PAGINATION: {\n    DEFAULT_PAGE_SIZE: 25, // Reduced from 50 to 25 to reduce resource usage\n    MAX_PAGE_SIZE: 50, // Reduced from 100 to 50\n  },\n  \n  // Cache settings - Optimized for better performance\n  CACHE: {\n    STALE_TIME: 10 * 60 * 1000, // Increased to 10 minutes to match App.tsx\n    GC_TIME: 60 * 60 * 1000, // Increased to 60 minutes for longer retention\n  },\n  \n  // Validation\n  TC_NUMBER_LENGTH: 11,\n  MIN_NAME_LENGTH: 1,\n  \n  // Status options\n  STATUS_OPTIONS: [\n    { value: 'active', label: 'Active' },\n    { value: 'inactive', label: 'Inactive' },\n  ] as const,\n  \n  // Gender options\n  GENDER_OPTIONS: [\n    { value: 'M', label: 'Male' },\n    { value: 'F', label: 'Female' },\n  ] as const,\n  \n  // Sort options\n  SORT_OPTIONS: [\n    { value: 'firstName', label: 'First Name' },\n    { value: 'lastName', label: 'Last Name' },\n    { value: 'createdAt', label: 'Created Date' },\n    { value: 'priorityScore', label: 'Priority Score' },\n  ] as const,\n  \n  // Form field names\n  FORM_FIELDS: {\n    TC_NUMBER: 'tcNumber',\n    FIRST_NAME: 'firstName',\n    LAST_NAME: 'lastName',\n    PHONE: 'phone',\n    EMAIL: 'email',\n    BIRTH_DATE: 'birthDate',\n    GENDER: 'gender',\n    ADDRESS_CITY: 'addressCity',\n    ADDRESS_DISTRICT: 'addressDistrict',\n    ADDRESS_FULL: 'addressFull',\n    STATUS: 'status',\n    SEGMENT: 'segment',\n    ACQUISITION_TYPE: 'acquisitionType',\n    CONVERSION_STEP: 'conversionStep',\n    REFERRED_BY: 'referredBy',\n    PRIORITY_SCORE: 'priorityScore',\n    TAGS: 'tags',\n  } as const,\n  \n  // Error messages\n  ERROR_MESSAGES: {\n    TC_NUMBER_REQUIRED: 'TC Number is required',\n    TC_NUMBER_INVALID: 'TC Number must be 11 digits',\n    TC_NUMBER_FORMAT: 'Invalid TC Number format',\n    FIRST_NAME_REQUIRED: 'First name is required',\n    LAST_NAME_REQUIRED: 'Last name is required',\n    PHONE_REQUIRED: 'Phone number is required',\n    PHONE_INVALID: 'Invalid phone number format',\n    EMAIL_INVALID: 'Invalid email format',\n    BIRTH_DATE_INVALID: 'Invalid birth date',\n  } as const,\n  \n  // Success messages\n  SUCCESS_MESSAGES: {\n    PATIENT_CREATED: 'Patient created successfully',\n    PATIENT_UPDATED: 'Patient updated successfully',\n    PATIENT_DELETED: 'Patient deleted successfully',\n    NOTE_ADDED: 'Note added successfully',\n    NOTE_DELETED: 'Note deleted successfully',\n  } as const,\n} as const;\n\n// Storage keys - following the registry pattern from user rules\n// These should be generated via CLI: npm run gen:key CONST_NAME feature [vN]\nexport const PATIENT_STORAGE_KEYS = {\n  PATIENT_LIST_FILTERS: 'patient_list_filters_v1',\n  PATIENT_FORM_DRAFT: 'patient_form_draft_v1',\n  PATIENT_SEARCH_HISTORY: 'patient_search_history_v1',\n  PATIENT_SORT_PREFERENCE: 'patient_sort_preference_v1',\n  PATIENT_VIEW_MODE: 'patient_view_mode_v1',\n} as const;\n\n// Query keys for React Query\nexport const PATIENT_QUERY_KEYS = {\n  all: ['patients'] as const,\n  lists: () => [...PATIENT_QUERY_KEYS.all, 'list'] as const,\n  list: (filters: any) => [...PATIENT_QUERY_KEYS.lists(), filters] as const,\n  details: () => [...PATIENT_QUERY_KEYS.all, 'detail'] as const,\n  detail: (id: string) => [...PATIENT_QUERY_KEYS.details(), id] as const,\n  notes: (patientId: string) => [...PATIENT_QUERY_KEYS.all, 'notes', patientId] as const,\n  ereceipts: (patientId: string) => [...PATIENT_QUERY_KEYS.all, 'ereceipts', patientId] as const,\n  hearingTests: (patientId: string) => [...PATIENT_QUERY_KEYS.all, 'hearingTests', patientId] as const,\n  sales: (patientId: string) => [...PATIENT_QUERY_KEYS.all, 'sales', patientId] as const,\n  timeline: (patientId: string) => [...PATIENT_QUERY_KEYS.all, 'timeline', patientId] as const,\n} as const;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/constants/patient/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/constants/patient/patient-device.constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/constants/patient/patient-status.constants.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nexport type PatientStatus = 'active' | 'inactive' | 'pending' | 'archived';\n\n/**\n * Patient Status Constants\n * @fileoverview Status definitions and related constants\n * @version 1.0.0\n */\n\nimport type { \n  PatientStatus, \n  PatientSegment, \n  PatientLabel \n} from '../../types/patient';\n\nexport const PATIENT_STATUS: Record<PatientStatus, string> = {\n  active: 'Aktif',\n  inactive: 'Pasif',\n  archived: 'Arşivlendi'\n} as const;\n\nexport const PATIENT_SEGMENT: Record<PatientSegment, string> = {\n  new: 'Yeni',\n  trial: 'Deneme',\n  purchased: 'Satın Alındı',\n  control: 'Kontrol',\n  renewal: 'Yenileme'\n} as const;\n\nexport const PATIENT_LABEL: Record<PatientLabel, string> = {\n  'yeni': 'Yeni',\n  'arama-bekliyor': 'Arama Bekliyor',\n  'randevu-verildi': 'Randevu Verildi',\n  'deneme-yapildi': 'Deneme Yapıldı',\n  'kontrol-hastasi': 'Kontrol Hastası',\n  'satis-tamamlandi': 'Satış Tamamlandı'\n} as const;\n\nexport const STATUS_COLORS: Record<PatientStatus, string> = {\n  active: '#10B981',\n  inactive: '#6B7280',\n  archived: '#9CA3AF'\n} as const;\n\nexport const SEGMENT_COLORS: Record<PatientSegment, string> = {\n  new: '#8B5CF6',\n  trial: '#F59E0B',\n  purchased: '#10B981',\n  control: '#06B6D4',\n  renewal: '#EC4899'\n} as const;\n\nexport const LABEL_COLORS: Record<PatientLabel, string> = {\n  'yeni': '#8B5CF6',\n  'arama-bekliyor': '#F59E0B',\n  'randevu-verildi': '#06B6D4',\n  'deneme-yapildi': '#10B981',\n  'kontrol-hastasi': '#6366F1',\n  'satis-tamamlandi': '#059669'\n} as const;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/constants/storage-keys.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'STORAGE_KEYS_METADATA' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GeneratedStorageKey' is defined but never used.","line":15,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageKeyDefinition' is defined but never used.","line":16,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":28}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Storage Keys Registry\n * \n * MUST: All localStorage/sessionStorage keys come from this single registry file\n * MUST: New keys are added exclusively via the CLI generator (npm run gen:key CONST_NAME feature [vN])\n * MUST: CI linter rejects literal string keys in localStorage calls\n * SHOULD: Legacy keys must be mapped in storage-migrator.ts with idempotent migration\n * SHOULD: Version changes in storage key format increment @vN suffix and include a migration rule\n */\n\n// Import generated storage keys from OpenAPI\nimport {\n  ALL_GENERATED_STORAGE_KEYS,\n  STORAGE_KEYS_METADATA,\n  type GeneratedStorageKey,\n  type StorageKeyDefinition\n} from './generated-storage-keys'\n\n// Re-export generated keys for convenience\nexport * from './generated-storage-keys'\n\n// Authentication & Session\nexport const AUTH_TOKEN = 'x-ear.auth.token@v1'\nexport const REFRESH_TOKEN = 'x-ear.auth.refresh@v1'\nexport const USER_PREFERENCES = 'x-ear.user.preferences@v1'\n\n// Offline & Sync\nexport const OUTBOX_QUEUE = 'x-ear.sync.outbox@v1'\nexport const LAST_SYNC_TIMESTAMP = 'x-ear.sync.lastSync@v1'\nexport const OFFLINE_MODE = 'x-ear.app.offlineMode@v1'\n\n// UI State\nexport const SIDEBAR_COLLAPSED = 'x-ear.ui.sidebarCollapsed@v1'\nexport const THEME_MODE = 'x-ear.ui.themeMode@v1'\nexport const LANGUAGE_PREFERENCE = 'x-ear.ui.language@v1'\n\n// Form Drafts\nexport const PATIENT_FORM_DRAFT = 'x-ear.forms.patient.draft@v1'\nexport const APPOINTMENT_FORM_DRAFT = 'x-ear.forms.appointment.draft@v1'\nexport const INVOICE_FORM_DRAFT = 'x-ear.forms.invoice.draft@v1'\n\n// Patient-specific Storage Keys (Legacy - now generated from OpenAPI)\n// NOTE: These are kept for backward compatibility but should be replaced with generated keys\nexport const PATIENT_SEARCH_FILTERS_LEGACY = 'x-ear.patients.searchFilters@v1'\nexport const PATIENT_PAGINATION_STATE_LEGACY = 'x-ear.patients.paginationState@v1'\nexport const PATIENT_SORT_PREFERENCES_LEGACY = 'x-ear.patients.sortPreferences@v1'\nexport const PATIENT_VIEW_MODE_LEGACY = 'x-ear.patients.viewMode@v1'\nexport const PATIENT_SELECTED_COLUMNS_LEGACY = 'x-ear.patients.selectedColumns@v1'\nexport const PATIENT_BULK_ACTIONS_STATE_LEGACY = 'x-ear.patients.bulkActionsState@v1'\nexport const PATIENT_DETAILS_TAB_LEGACY = 'x-ear.patients.detailsTab@v1'\nexport const PATIENT_FORM_VALIDATION_STATE_LEGACY = 'x-ear.patients.formValidationState@v1'\n\n// Cache & Performance\nexport const API_CACHE_PREFIX = 'x-ear.cache.api@v1'\nexport const QUERY_CACHE_TIMESTAMP = 'x-ear.cache.queryTimestamp@v1'\n\n// Demo Mode\nexport const DEMO_MODE_ENABLED = 'x-ear.demo.enabled@v1'\nexport const DEMO_DATA_VERSION = 'x-ear.demo.dataVersion@v1'\n\n// Feature Flags\nexport const FEATURE_FLAGS = 'x-ear.features.flags@v1'\n\n// Idempotency\nexport const IDEMPOTENCY_CACHE = 'x-ear.api.idempotencyCache@v1'\n\n// Legacy Migration Keys (mapped from legacy storage keys)\nexport const PATIENTS_DATA = 'x-ear.patients.data@v1' // Legacy: xear_patients_data\nexport const PATIENTS_LEGACY = 'x-ear.patients.legacy@v1' // Legacy: xear_patients\nexport const CRM_PATIENTS = 'x-ear.patients.crm@v1' // Legacy: xear_crm_patients\nexport const SMS_MESSAGES = 'x-ear.sms.messages@v1' // Legacy: sms_messages\nexport const SGK_DATA = 'x-ear.sgk.data@v1' // Legacy: sgkData\nexport const SGK_DOCUMENTS = 'x-ear.sgk.documents@v1' // Legacy: sgk_documents, xear_sgk_documents\nexport const PATIENT_DOCUMENTS = 'x-ear.patients.documents@v1' // Legacy: patient_documents, xear_patients_documents\nexport const UNMATCHED_DOCUMENTS = 'x-ear.sgk.unmatchedDocs@v1' // Legacy: unmatched_documents\nexport const INVENTORY_FILTER_PRESET = 'x-ear.inventory.filterPreset@v1' // Legacy: inventoryFilterPreset\nexport const CASH_RECORDS = 'x-ear.cashflow.records@v1' // Legacy: cashRecords, dashboardCashRecords\nexport const APPOINTMENTS = 'x-ear.appointments.data@v1' // Legacy: appointments\nexport const APPOINTMENT_FILTER_PRESETS = 'x-ear.appointments.filterPresets@v1' // Legacy: appointmentFilterPresets\nexport const SGK_REPORTS = 'x-ear.sgk.reports@v1' // Legacy: sgk_reports\nexport const INCOME_RECORD_TYPES = 'x-ear.cashflow.incomeTypes@v1' // Legacy: incomeRecordTypes\nexport const EXPENSE_RECORD_TYPES = 'x-ear.cashflow.expenseTypes@v1' // Legacy: expenseRecordTypes\nexport const DEVICE_MAINTENANCE = 'x-ear.devices.maintenance@v1' // Legacy: xear_deviceMaintenance\nexport const NOTIFICATIONS = 'x-ear.notifications.data@v1' // Legacy: notifications\nexport const AUTOMATION_RULES = 'x-ear.automation.rules@v1' // Legacy: automationRules\nexport const SMS_LOGS = 'x-ear.sms.logs@v1' // Legacy: smsLogs\nexport const AUTOMATION_LOGS = 'x-ear.automation.logs@v1' // Legacy: automationLogs\nexport const INVENTORY_DATA = 'x-ear.inventory.data@v1' // Legacy: inventoryData, xear_crm_inventory\nexport const INVOICES_DATA = 'x-ear.invoices.data@v1' // Legacy: invoices, xear_invoices\nexport const PURCHASES_DATA = 'x-ear.purchases.data@v1' // Purchase invoices data\nexport const SAVED_VIEWS = 'x-ear.patients.savedViews@v1' // Legacy: xear_saved_views\nexport const OCR_DYNAMIC_NAMES = 'x-ear.ocr.dynamicNames@v1' // Legacy: ocrDynamicNames\nexport const CURRENT_USER = 'x-ear.auth.currentUser@v1' // Legacy: currentUser, currentUserId\nexport const SYSTEM_SETTINGS = 'x-ear.system.settings@v1' // Legacy: systemSettings\nexport const BACKGROUND_PROCESSING_STATUS = 'x-ear.sgk.backgroundStatus@v1' // Legacy: background_processing_status\nexport const SGK_SUBMENU_EXPANDED = 'x-ear.ui.sgkSubmenuExpanded@v1' // Legacy: sgkSubmenuExpanded\nexport const FATURA_SUBMENU_EXPANDED = 'x-ear.ui.faturaSubmenuExpanded@v1' // Legacy: faturaSubmenuExpanded\nexport const REPORTS_SUBMENU_EXPANDED = 'x-ear.ui.reportsSubmenuExpanded@v1' // Legacy: reportsSubmenuExpanded\nexport const ACCESS_TOKEN = 'x-ear.auth.accessToken@v1' // Legacy: xear_access_token\nexport const JWT_TOKEN = 'x-ear.auth.jwt@v1' // Legacy: jwt, token\n\n// All storage keys for validation\nexport const ALL_STORAGE_KEYS = [\n  AUTH_TOKEN,\n  REFRESH_TOKEN,\n  USER_PREFERENCES,\n  OUTBOX_QUEUE,\n  LAST_SYNC_TIMESTAMP,\n  OFFLINE_MODE,\n  SIDEBAR_COLLAPSED,\n  THEME_MODE,\n  LANGUAGE_PREFERENCE,\n  PATIENT_FORM_DRAFT,\n  APPOINTMENT_FORM_DRAFT,\n  INVOICE_FORM_DRAFT,\n  // Use generated keys from OpenAPI instead of legacy ones\n  ...ALL_GENERATED_STORAGE_KEYS,\n  API_CACHE_PREFIX,\n  QUERY_CACHE_TIMESTAMP,\n  DEMO_MODE_ENABLED,\n  DEMO_DATA_VERSION,\n  FEATURE_FLAGS,\n  IDEMPOTENCY_CACHE,\n  // Legacy migration keys\n  PATIENTS_DATA,\n  PATIENTS_LEGACY,\n  CRM_PATIENTS,\n  SMS_MESSAGES,\n  SGK_DATA,\n  SGK_DOCUMENTS,\n  PATIENT_DOCUMENTS,\n  UNMATCHED_DOCUMENTS,\n  INVENTORY_FILTER_PRESET,\n  CASH_RECORDS,\n  APPOINTMENTS,\n  APPOINTMENT_FILTER_PRESETS,\n  SGK_REPORTS,\n  INCOME_RECORD_TYPES,\n  EXPENSE_RECORD_TYPES,\n  DEVICE_MAINTENANCE,\n  NOTIFICATIONS,\n  AUTOMATION_RULES,\n  SMS_LOGS,\n  AUTOMATION_LOGS,\n  INVENTORY_DATA,\n  INVOICES_DATA,\n  PURCHASES_DATA,\n  SAVED_VIEWS,\n  OCR_DYNAMIC_NAMES,\n  CURRENT_USER,\n  SYSTEM_SETTINGS,\n  BACKGROUND_PROCESSING_STATUS,\n  SGK_SUBMENU_EXPANDED,\n  FATURA_SUBMENU_EXPANDED,\n  REPORTS_SUBMENU_EXPANDED,\n  ACCESS_TOKEN,\n  JWT_TOKEN,\n] as const\n\nexport type StorageKey = typeof ALL_STORAGE_KEYS[number]\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/data/invoice-schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/appointments/useAppointments.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/common/useIdempotency.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[130,133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[130,133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[186,189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[186,189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export function useIdempotency() {\n  function generateKey(prefix = 'idemp') {\n    if (typeof crypto !== 'undefined' && (crypto as any).randomUUID) {\n      return `${prefix}_${(crypto as any).randomUUID()}`;\n    }\n    return `${prefix}_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;\n  }\n\n  return { generateKey };\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatient.old.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'syncService' is assigned a value but never used.","line":17,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'patient'. Either include it or remove the dependency array.","line":225,"column":6,"nodeType":"ArrayExpression","endLine":225,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [patient]","fix":{"range":[6269,6286],"text":"[patient]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'patient'. Either include it or remove the dependency array.","line":242,"column":6,"nodeType":"ArrayExpression","endLine":242,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [patient]","fix":{"range":[6655,6673],"text":"[patient]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'patient'. Either include it or remove the dependency array.","line":260,"column":6,"nodeType":"ArrayExpression","endLine":260,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [patient]","fix":{"range":[7141,7157],"text":"[patient]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { Patient } from '../../types/patient';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\nimport { PatientStorageService } from '../../services/patient/patient-storage.service';\n// import { patientSyncService } from '../../services/patient/patient-sync.service';\n\n/**\n * usePatient Hook\n * Manages individual patient state, loading, and offline-first operations\n * Follows 500 LOC limit and single responsibility principle\n */\nexport function usePatient(patientId?: string) {\n  // Services\n  const apiService = useMemo(() => new PatientApiService(), []);\n  const storageService = useMemo(() => new PatientStorageService(), []);\n  const syncService = useMemo(() => new PatientSyncService(), []);\n\n  // State\n  const [patient, setPatient] = useState<Patient | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n  const [lastUpdated, setLastUpdated] = useState<string | null>(null);\n\n  // Online status listener\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  /**\n   * Load patient by ID\n   */\n  const loadPatient = useCallback(async (id: string, forceRefresh = false) => {\n    if (!id) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Try to load from local storage first\n      let patientData = await storageService.getPatientById(id);\n\n      // If online and force refresh, or patient not found locally, try API\n      if ((isOnline && forceRefresh) || !patientData) {\n        try {\n          const apiPatient = await apiService.fetchPatient(id);\n          if (apiPatient) {\n            // Update local storage\n            await storageService.updatePatient(apiPatient);\n            patientData = apiPatient;\n          }\n        } catch (apiError) {\n          // If API fails but we have local data, use it\n          if (!patientData) {\n            throw apiError;\n          }\n          console.warn('API failed, using cached data:', apiError);\n        }\n      }\n\n      if (patientData) {\n        setPatient(patientData);\n        setLastUpdated(patientData.updatedAt);\n      } else {\n        throw new Error(`Patient with ID ${id} not found`);\n      }\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to load patient';\n      setError(errorMessage);\n      console.error('Error loading patient:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService, storageService, isOnline]);\n\n  /**\n   * Refresh patient from server\n   */\n  const refresh = useCallback(async () => {\n    if (patient?.id) {\n      await loadPatient(patient.id, true);\n    }\n  }, [patient?.id, loadPatient]);\n\n  /**\n   * Update patient data locally\n   */\n  const updatePatient = useCallback((updatedPatient: Patient) => {\n    setPatient(updatedPatient);\n    setLastUpdated(updatedPatient.updatedAt);\n  }, []);\n\n  /**\n   * Clear patient data\n   */\n  const clearPatient = useCallback(() => {\n    setPatient(null);\n    setError(null);\n    setLastUpdated(null);\n  }, []);\n\n  /**\n   * Check if patient exists\n   */\n  const exists = useCallback(async (id: string): Promise<boolean> => {\n    try {\n      return await storageService.patientExists(id);\n    } catch (err) {\n      console.error('Error checking patient existence:', err);\n      return false;\n    }\n  }, [storageService]);\n\n  /**\n   * Get patient's device information\n   */\n  const getDevices = useCallback(() => {\n    return patient?.devices || [];\n  }, [patient?.devices]);\n\n  /**\n   * Get patient's notes\n   */\n  const getNotes = useCallback(() => {\n    return patient?.notes || [];\n  }, [patient?.notes]);\n\n  /**\n   * Get patient's installments\n   */\n  const getInstallments = useCallback(() => {\n    return patient?.installments || [];\n  }, [patient?.installments]);\n\n  /**\n   * Get patient's SGK information\n   */\n  const getSgkInfo = useCallback(() => {\n    return patient?.sgkInfo || { hasInsurance: false };\n  }, [patient?.sgkInfo]);\n\n  /**\n   * Get patient's appointments\n   */\n  const getAppointments = useCallback(() => {\n    return patient?.appointments || [];\n  }, [patient?.appointments]);\n\n  /**\n   * Get patient's communications\n   */\n  const getCommunications = useCallback(() => {\n    return patient?.communications || [];\n  }, [patient?.communications]);\n\n  /**\n   * Get patient's reports\n   */\n  const getReports = useCallback(() => {\n    return patient?.reports || [];\n  }, [patient?.reports]);\n\n  /**\n   * Check if patient has overdue payments\n   */\n  const hasOverduePayments = useCallback(() => {\n    return (patient?.overdueAmount || 0) > 0;\n  }, [patient?.overdueAmount]);\n\n  /**\n   * Check if patient is high priority\n   */\n  const isHighPriority = useCallback(() => {\n    return (patient?.priorityScore || 0) >= 8;\n  }, [patient?.priorityScore]);\n\n  /**\n   * Check if patient has devices\n   */\n  const hasDevices = useCallback(() => {\n    return (patient?.devices?.length || 0) > 0;\n  }, [patient?.devices]);\n\n  /**\n   * Check if patient has SGK insurance\n   */\n  const hasSgkInsurance = useCallback(() => {\n    return patient?.sgkInfo?.hasInsurance || false;\n  }, [patient?.sgkInfo]);\n\n  /**\n   * Get patient's full name\n   */\n  const getFullName = useCallback(() => {\n    if (patient?.name) return patient.name;\n    if (patient?.firstName || patient?.lastName) {\n      return `${patient.firstName || ''} ${patient.lastName || ''}`.trim();\n    }\n    return 'Unknown Patient';\n  }, [patient?.name, patient?.firstName, patient?.lastName]);\n\n  /**\n   * Get patient's display status\n   */\n  const getDisplayStatus = useCallback(() => {\n    if (!patient) return 'Unknown';\n    \n    const statusMap = {\n      active: 'Aktif',\n      inactive: 'Pasif',\n      archived: 'Arşivlenmiş'\n    };\n    \n    return statusMap[patient.status] || patient.status;\n  }, [patient?.status]);\n\n  /**\n   * Get patient's display segment\n   */\n  const getDisplaySegment = useCallback(() => {\n    if (!patient) return 'Unknown';\n    \n    const segmentMap = {\n      new: 'Yeni',\n      trial: 'Deneme',\n      purchased: 'Satın Alınmış',\n      control: 'Kontrol',\n      renewal: 'Yenileme'\n    };\n    \n    return segmentMap[patient.segment] || patient.segment;\n  }, [patient?.segment]);\n\n  /**\n   * Get patient's display label\n   */\n  const getDisplayLabel = useCallback(() => {\n    if (!patient) return 'Unknown';\n    \n    const labelMap = {\n      'yeni': 'Yeni',\n      'arama-bekliyor': 'Arama Bekliyor',\n      'randevu-verildi': 'Randevu Verildi',\n      'deneme-yapildi': 'Deneme Yapıldı',\n      'kontrol-hastasi': 'Kontrol Hastası',\n      'satis-tamamlandi': 'Satış Tamamlandı'\n    };\n    \n    return labelMap[patient.label] || patient.label;\n  }, [patient?.label]);\n\n  // Load patient when ID changes\n  useEffect(() => {\n    if (patientId) {\n      loadPatient(patientId);\n    } else {\n      clearPatient();\n    }\n  }, [patientId, loadPatient, clearPatient]);\n\n  // Memoized computed values\n  const isLoaded = useMemo(() => {\n    return patient !== null && !loading;\n  }, [patient, loading]);\n\n  const isEmpty = useMemo(() => {\n    return patient === null && !loading && !error;\n  }, [patient, loading, error]);\n\n  return {\n    // Data\n    patient,\n    lastUpdated,\n    \n    // State\n    loading,\n    error,\n    isOnline,\n    isLoaded,\n    isEmpty,\n    \n    // Actions\n    loadPatient,\n    refresh,\n    updatePatient,\n    clearPatient,\n    exists,\n    \n    // Getters\n    getDevices,\n    getNotes,\n    getInstallments,\n    getSgkInfo,\n    getAppointments,\n    getCommunications,\n    getReports,\n    getFullName,\n    getDisplayStatus,\n    getDisplaySegment,\n    getDisplayLabel,\n    \n    // Computed properties\n    hasOverduePayments,\n    isHighPriority,\n    hasDevices,\n    hasSgkInsurance\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatient.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport type { Patient as OrvalPatient } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\nimport { PatientStorageService } from '../../services/patient/patient-storage.service';\n\n/**\n * Simplified usePatient hook for individual patient management\n * Provides basic operations for a single patient\n */\nexport function usePatient(patientId?: string) {\n  const [patient, setPatient] = useState<OrvalPatient | null>(null);\n  const [loading, setLoading] = useState(false);\n  // Use Error | string | null so callers that expect Error.message don't break\n  const [error, setError] = useState<Error | string | null>(null);\n\n  // Memoize services to prevent recreation on every render\n  const apiService = useMemo(() => new PatientApiService(), []);\n  const storageService = useMemo(() => new PatientStorageService(), []);\n\n  // Load patient by ID\n  const loadPatient = useCallback(async (id: string) => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      // Try API first\n      const result = await apiService.fetchPatient(id);\n      if (result) {\n        // API service returns Orval Patient directly\n        setPatient(result);\n      } else {\n        // Fallback to local storage\n        const localPatient = await storageService.getPatientById(id);\n        setPatient(localPatient);\n      }\n    } catch (err) {\n  setError(err instanceof Error ? err : new Error(String(err)));\n      \n      // Try local storage as fallback\n      try {\n        const localPatient = await storageService.getPatientById(id);\n        setPatient(localPatient);\n      } catch (localErr) {\n        console.error('Failed to load from local storage:', localErr);\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService, storageService]);\n\n  // Update patient\n  const updatePatient = useCallback(async (updates: Partial<OrvalPatient>) => {\n    if (!patient) return null;\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      const result = await apiService.updatePatient(patient.id, updates);\n      if (result) {\n        setPatient(result);\n        return result;\n      }\n      return null;\n    } catch (err) {\n  setError(err instanceof Error ? err : new Error(String(err)));\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, [patient, apiService]);\n\n  // Delete patient\n  const deletePatient = useCallback(async () => {\n    if (!patient) return false;\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      const success = await apiService.deletePatient(patient.id);\n      if (success) {\n        setPatient(null);\n        return true;\n      }\n      return false;\n    } catch (err) {\n  setError(err instanceof Error ? err : new Error(String(err)));\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }, [patient, apiService]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  // Load patient on mount or when ID changes\n  useEffect(() => {\n    if (patientId) {\n      loadPatient(patientId);\n    } else {\n      setPatient(null);\n    }\n  }, [patientId, loadPatient]);\n\n  return {\n    // Data\n    patient,\n    // Backwards-compatible alias\n    data: patient,\n    \n    // State\n    loading,\n    isLoading: loading,\n    error,\n    \n    // Actions\n    loadPatient,\n    updatePatient,\n    deletePatient,\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientAppointments.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'apiService' object construction makes the dependencies of useCallback Hook (at line 44) change on every render. Move it inside the useCallback callback. Alternatively, wrap the initialization of 'apiService' in its own useMemo() Hook.","line":28,"column":9,"nodeType":"VariableDeclarator","endLine":28,"endColumn":45}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback } from 'react';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\n\nexport interface PatientAppointment {\n  id: string;\n  patientId: string;\n  clinicianId?: string;\n  branchId?: string;\n  date: string;\n  time: string;\n  duration: number;\n  appointmentType: string;\n  status: 'scheduled' | 'confirmed' | 'completed' | 'cancelled' | 'no_show';\n  notes?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\n/**\n * Hook for fetching and managing patient appointments\n */\nexport function usePatientAppointments(patientId?: string) {\n  const [appointments, setAppointments] = useState<PatientAppointment[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | string | null>(null);\n\n  const apiService = new PatientApiService();\n\n  // Fetch appointments for a patient\n  const fetchAppointments = useCallback(async (id: string) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiService.getAppointments(id);\n      setAppointments(result?.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error(String(err)));\n      setAppointments([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService]);\n\n  // Load appointments on mount or when patientId changes\n  useEffect(() => {\n    if (patientId) {\n      fetchAppointments(patientId);\n    } else {\n      setAppointments([]);\n    }\n  }, [patientId, fetchAppointments]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    // Data\n    appointments,\n    data: appointments,\n\n    // State\n    loading,\n    isLoading: loading,\n    error,\n\n    // Actions\n    fetchAppointments,\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientDevices.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setLoading' is assigned a value but never used.","line":11,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":29}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback } from 'react';\nimport { PatientDevice } from '../../types/patient';\n\n/**\n * Hook for managing patient devices\n * Since devices are included in the patient object, this hook extracts and manages them\n */\nexport function usePatientDevices(patientId?: string, devices?: PatientDevice[]) {\n  const [patientDevices, setPatientDevices] = useState<PatientDevice[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | string | null>(null);\n\n  // Update devices when patient devices change\n  useEffect(() => {\n    if (devices) {\n      setPatientDevices(devices);\n    } else {\n      setPatientDevices([]);\n    }\n  }, [devices]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    // Data\n    devices: patientDevices,\n    data: patientDevices,\n\n    // State\n    loading,\n    isLoading: loading,\n    error,\n\n    // Actions\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientDocuments.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[468,471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[468,471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\n\nexport interface PatientDocument {\n  id: string;\n  patientId: string;\n  documentType: 'medical_record' | 'prescription' | 'test_result' | 'invoice' | 'consent' | 'other';\n  title: string;\n  description?: string;\n  fileName: string;\n  originalName?: string;\n  content?: string;\n  metadata?: Record<string, any>;\n  mimeType?: string;\n  fileSize?: number;\n  uploadedBy?: string;\n  uploadDate: string;\n  createdBy?: string;\n  createdAt?: string;\n  tags?: string[];\n  status?: string;\n}\n\n/**\n * Hook for fetching and managing patient documents\n */\nexport function usePatientDocuments(patientId?: string) {\n  const [documents, setDocuments] = useState<PatientDocument[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | string | null>(null);\n\n  // Memoize the API service to prevent recreation on every render\n  const apiService = useMemo(() => new PatientApiService(), []);\n\n  // Fetch documents for a patient\n  const fetchDocuments = useCallback(async (id: string) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiService.getDocuments(id);\n      setDocuments(result?.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error(String(err)));\n      setDocuments([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService]);\n\n  // Load documents on mount or when patientId changes\n  useEffect(() => {\n    if (patientId) {\n      fetchDocuments(patientId);\n    } else {\n      setDocuments([]);\n    }\n  }, [patientId, fetchDocuments]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    // Data\n    documents,\n    data: documents,\n\n    // State\n    loading,\n    isLoading: loading,\n    error,\n\n    // Actions\n    fetchDocuments,\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientHearingTests.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[318,321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[318,321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'apiService' object construction makes the dependencies of useCallback Hook (at line 41) change on every render. Move it inside the useCallback callback. Alternatively, wrap the initialization of 'apiService' in its own useMemo() Hook.","line":25,"column":9,"nodeType":"VariableDeclarator","endLine":25,"endColumn":45}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback } from 'react';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\n\nexport interface PatientHearingTest {\n  id: string;\n  patientId: string;\n  testDate: string;\n  testType: string;\n  conductedBy?: string;\n  results?: Record<string, any>;\n  notes?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\n/**\n * Hook for fetching and managing patient hearing tests\n */\nexport function usePatientHearingTests(patientId?: string) {\n  const [hearingTests, setHearingTests] = useState<PatientHearingTest[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | string | null>(null);\n\n  const apiService = new PatientApiService();\n\n  // Fetch hearing tests for a patient\n  const fetchHearingTests = useCallback(async (id: string) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiService.getHearingTests(id);\n      setHearingTests(result?.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error(String(err)));\n      setHearingTests([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService]);\n\n  // Load hearing tests on mount or when patientId changes\n  useEffect(() => {\n    if (patientId) {\n      fetchHearingTests(patientId);\n    } else {\n      setHearingTests([]);\n    }\n  }, [patientId, fetchHearingTests]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    // Data\n    hearingTests,\n    data: hearingTests,\n\n    // State\n    loading,\n    isLoading: loading,\n    error,\n\n    // Actions\n    fetchHearingTests,\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientMutations.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'storageService' is assigned a value but never used.","line":36,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useCallback, useMemo } from 'react';\nimport { Patient } from '../../types/patient';\nimport { PatientSyncService } from '../../services/patient/patient-sync.service';\nimport { PatientStorageService } from '../../services/patient/patient-storage.service';\n\n// Define request types locally\ninterface PatientCreateRequest {\n  firstName?: string;\n  lastName?: string;\n  phone: string;\n  tcNumber?: string;\n  birthDate?: string;\n  email?: string;\n  address?: string;\n  status?: 'active' | 'inactive' | 'archived';\n  segment?: 'new' | 'trial' | 'purchased' | 'control' | 'renewal';\n  label?: 'yeni' | 'arama-bekliyor' | 'randevu-verildi' | 'deneme-yapildi' | 'kontrol-hastasi' | 'satis-tamamlandi';\n  acquisitionType?: 'tabela' | 'sosyal-medya' | 'tanitim' | 'referans' | 'diger';\n  tags?: string[];\n  customData?: Record<string, unknown>;\n}\n\ninterface PatientUpdateRequest extends Partial<PatientCreateRequest> {\n  // Additional update-specific fields can be added here\n}\n\n/**\n * usePatientMutations Hook\n * Manages patient CRUD operations with offline-first approach and optimistic updates\n * Follows 500 LOC limit and single responsibility principle\n */\nexport function usePatientMutations() {\n  // Services\n  const syncService = useMemo(() => new PatientSyncService(), []);\n  const storageService = useMemo(() => new PatientStorageService(), []);\n\n  // State\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n\n  // Generate idempotency key\n  const generateIdempotencyKey = useCallback(() => {\n    return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }, []);\n\n  /**\n   * Create a new patient\n   */\n  const createPatient = useCallback(async (\n    patientData: PatientCreateRequest,\n    options?: { onSuccess?: (patient: Patient) => void; onError?: (error: Error) => void }\n  ): Promise<Patient | null> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const idempotencyKey = generateIdempotencyKey();\n      const createdPatient = await syncService.createPatient(patientData, idempotencyKey);\n      \n      options?.onSuccess?.(createdPatient);\n      return createdPatient;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to create patient');\n      setError(error.message);\n      options?.onError?.(error);\n      console.error('Error creating patient:', err);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, [syncService, generateIdempotencyKey]);\n\n  /**\n   * Update an existing patient\n   */\n  const updatePatient = useCallback(async (\n    patientId: string,\n    updates: PatientUpdateRequest,\n    options?: { onSuccess?: (patient: Patient) => void; onError?: (error: Error) => void }\n  ): Promise<Patient | null> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const idempotencyKey = generateIdempotencyKey();\n      const updatedPatient = await syncService.updatePatient(patientId, updates, idempotencyKey);\n      \n      options?.onSuccess?.(updatedPatient);\n      return updatedPatient;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to update patient');\n      setError(error.message);\n      options?.onError?.(error);\n      console.error('Error updating patient:', err);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, [syncService, generateIdempotencyKey]);\n\n  /**\n   * Delete a patient\n   */\n  const deletePatient = useCallback(async (\n    patientId: string,\n    options?: { onSuccess?: () => void; onError?: (error: Error) => void }\n  ): Promise<boolean> => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const idempotencyKey = generateIdempotencyKey();\n      await syncService.deletePatient(patientId, idempotencyKey);\n      \n      options?.onSuccess?.();\n      return true;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to delete patient');\n      setError(error.message);\n      options?.onError?.(error);\n      console.error('Error deleting patient:', err);\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }, [syncService, generateIdempotencyKey]);\n\n  /**\n   * Bulk create patients\n   */\n  const createPatients = useCallback(async (\n    patientsData: PatientCreateRequest[],\n    options?: { \n      onSuccess?: (patients: Patient[]) => void; \n      onError?: (error: Error) => void;\n      onProgress?: (completed: number, total: number) => void;\n    }\n  ): Promise<Patient[]> => {\n    setLoading(true);\n    setError(null);\n\n    const createdPatients: Patient[] = [];\n    const total = patientsData.length;\n\n    try {\n      for (let i = 0; i < patientsData.length; i++) {\n        const patientData = patientsData[i];\n        const idempotencyKey = generateIdempotencyKey();\n        \n        try {\n          const createdPatient = await syncService.createPatient(patientData, idempotencyKey);\n          createdPatients.push(createdPatient);\n          options?.onProgress?.(i + 1, total);\n        } catch (err) {\n          console.error(`Failed to create patient ${i + 1}:`, err);\n          // Continue with other patients\n        }\n      }\n\n      options?.onSuccess?.(createdPatients);\n      return createdPatients;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to create patients');\n      setError(error.message);\n      options?.onError?.(error);\n      console.error('Error creating patients:', err);\n      return createdPatients;\n    } finally {\n      setLoading(false);\n    }\n  }, [syncService, generateIdempotencyKey]);\n\n  /**\n   * Bulk update patients\n   */\n  const updatePatients = useCallback(async (\n    updates: Array<{ id: string; data: PatientUpdateRequest }>,\n    options?: { \n      onSuccess?: (patients: Patient[]) => void; \n      onError?: (error: Error) => void;\n      onProgress?: (completed: number, total: number) => void;\n    }\n  ): Promise<Patient[]> => {\n    setLoading(true);\n    setError(null);\n\n    const updatedPatients: Patient[] = [];\n    const total = updates.length;\n\n    try {\n      for (let i = 0; i < updates.length; i++) {\n        const { id, data } = updates[i];\n        const idempotencyKey = generateIdempotencyKey();\n        \n        try {\n          const updatedPatient = await syncService.updatePatient(id, data, idempotencyKey);\n          updatedPatients.push(updatedPatient);\n          options?.onProgress?.(i + 1, total);\n        } catch (err) {\n          console.error(`Failed to update patient ${id}:`, err);\n          // Continue with other patients\n        }\n      }\n\n      options?.onSuccess?.(updatedPatients);\n      return updatedPatients;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to update patients');\n      setError(error.message);\n      options?.onError?.(error);\n      console.error('Error updating patients:', err);\n      return updatedPatients;\n    } finally {\n      setLoading(false);\n    }\n  }, [syncService, generateIdempotencyKey]);\n\n  /**\n   * Bulk delete patients\n   */\n  const deletePatients = useCallback(async (\n    patientIds: string[],\n    options?: { \n      onSuccess?: (deletedCount: number) => void; \n      onError?: (error: Error) => void;\n      onProgress?: (completed: number, total: number) => void;\n    }\n  ): Promise<number> => {\n    setLoading(true);\n    setError(null);\n\n    let deletedCount = 0;\n    const total = patientIds.length;\n\n    try {\n      for (let i = 0; i < patientIds.length; i++) {\n        const patientId = patientIds[i];\n        const idempotencyKey = generateIdempotencyKey();\n        \n        try {\n          await syncService.deletePatient(patientId, idempotencyKey);\n          deletedCount++;\n          options?.onProgress?.(i + 1, total);\n        } catch (err) {\n          console.error(`Failed to delete patient ${patientId}:`, err);\n          // Continue with other patients\n        }\n      }\n\n      options?.onSuccess?.(deletedCount);\n      return deletedCount;\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to delete patients');\n      setError(error.message);\n      options?.onError?.(error);\n      console.error('Error deleting patients:', err);\n      return deletedCount;\n    } finally {\n      setLoading(false);\n    }\n  }, [syncService, generateIdempotencyKey]);\n\n  /**\n   * Clear error state\n   */\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  /**\n   * Get sync status\n   */\n  const getSyncStatus = useCallback(async () => {\n    return await syncService.getSyncStatus();\n  }, [syncService]);\n\n  /**\n   * Force sync with server\n   */\n  const forceSync = useCallback(async () => {\n    setLoading(true);\n    try {\n      await syncService.forceSync();\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error('Failed to sync');\n      setError(error.message);\n      console.error('Error syncing:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [syncService]);\n\n  // Online status listener\n  useState(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  });\n\n  return {\n    // State\n    loading,\n    error,\n    isOnline,\n    \n    // Single operations\n    createPatient,\n    updatePatient,\n    deletePatient,\n    \n    // Bulk operations\n    createPatients,\n    updatePatients,\n    deletePatients,\n    \n    // Utilities\n    clearError,\n    getSyncStatus,\n    forceSync,\n    generateIdempotencyKey\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientNotes.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'apiService' object construction makes the dependencies of useCallback Hook (at line 44) change on every render. Move it inside the useCallback callback. Alternatively, wrap the initialization of 'apiService' in its own useMemo() Hook.","line":28,"column":9,"nodeType":"VariableDeclarator","endLine":28,"endColumn":45}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback } from 'react';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\n\nexport interface PatientNote {\n  id: string;\n  patientId: string;\n  authorId: string;\n  appointmentId?: string;\n  noteType: 'clinical' | 'administrative' | 'follow_up' | 'general';\n  category: 'general' | 'complaint' | 'treatment' | 'progress' | 'other';\n  title: string;\n  content: string;\n  isPrivate: boolean;\n  tags?: string[];\n  createdAt: string;\n  updatedAt: string;\n}\n\n/**\n * Hook for fetching and managing patient notes\n */\nexport function usePatientNotes(patientId?: string) {\n  const [notes, setNotes] = useState<PatientNote[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | string | null>(null);\n\n  const apiService = new PatientApiService();\n\n  // Fetch notes for a patient\n  const fetchNotes = useCallback(async (id: string) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiService.getNotes(id);\n      setNotes(result?.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error(String(err)));\n      setNotes([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService]);\n\n  // Load notes on mount or when patientId changes\n  useEffect(() => {\n    if (patientId) {\n      fetchNotes(patientId);\n    } else {\n      setNotes([]);\n    }\n  }, [patientId, fetchNotes]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    // Data\n    notes,\n    data: notes,\n\n    // State\n    loading,\n    isLoading: loading,\n    error,\n\n    // Actions\n    fetchNotes,\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientSales.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'apiService' object construction makes the dependencies of useCallback Hook (at line 97) change on every render. Move it inside the useCallback callback. Alternatively, wrap the initialization of 'apiService' in its own useMemo() Hook.","line":81,"column":9,"nodeType":"VariableDeclarator","endLine":81,"endColumn":45}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback } from 'react';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\n\nexport interface PatientSale {\n  id: string;\n  patientId: string;\n  productId?: string;\n  saleDate: string;\n  listPriceTotal?: number;\n  totalAmount: number;\n  discountAmount: number;\n  finalAmount: number;\n  paidAmount: number;\n  remainingAmount?: number;\n  paymentStatus: 'completed' | 'pending' | 'cancelled';\n  paymentMethod?: string;\n  soldBy?: string;\n  sgkCoverage?: number;\n  patientPayment?: number;\n  sgkScheme?: string;\n  sgkGroup?: string;\n  discountRate?: number;\n  rightEarAssignmentId?: string;\n  leftEarAssignmentId?: string;\n  status: 'completed' | 'pending' | 'cancelled';\n  notes?: string;\n  createdAt: string;\n  updatedAt: string;\n  devices?: Array<{\n    id: string;\n    name: string;\n    brand: string;\n    model: string;\n    serialNumber?: string;\n    barcode?: string;\n    ear?: string;\n    listPrice?: number;\n    salePrice?: number;\n    sgkCoverageAmount?: number;\n    patientResponsibleAmount?: number;\n  }>;\n  paymentPlan?: {\n    id: string;\n    planName: string;\n    totalAmount: number;\n    installmentCount: number;\n    installmentAmount: number;\n    interestRate?: number;\n    processingFee?: number;\n    status: string;\n    startDate: string;\n  };\n  paymentRecords?: Array<{\n    id: string;\n    amount: number;\n    paymentDate: string;\n    dueDate?: string;\n    paymentMethod: string;\n    paymentType: string;\n    status: string;\n    referenceNumber?: string;\n    notes?: string;\n  }>;\n  invoice?: {\n    id: string;\n    invoiceNumber: string;\n    invoiceDate: string;\n    status: string;\n  };\n}\n\n/**\n * Hook for fetching and managing patient sales\n */\nexport function usePatientSales(patientId?: string) {\n  const [sales, setSales] = useState<PatientSale[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | string | null>(null);\n\n  const apiService = new PatientApiService();\n\n  // Fetch sales for a patient\n  const fetchSales = useCallback(async (id: string) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiService.getSales(id);\n      setSales(result?.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error(String(err)));\n      setSales([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService]);\n\n  // Load sales on mount or when patientId changes\n  useEffect(() => {\n    if (patientId) {\n      fetchSales(patientId);\n    } else {\n      setSales([]);\n    }\n  }, [patientId, fetchSales]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    // Data\n    sales,\n    data: sales,\n\n    // State\n    loading,\n    isLoading: loading,\n    error,\n\n    // Actions\n    fetchSales,\n    refresh: fetchSales,\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatientTimeline.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[569,572],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[569,572],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[603,606],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[603,606],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'apiService' object construction makes the dependencies of useCallback Hook (at line 52) change on every render. Move it inside the useCallback callback. Alternatively, wrap the initialization of 'apiService' in its own useMemo() Hook.","line":36,"column":9,"nodeType":"VariableDeclarator","endLine":36,"endColumn":45}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback } from 'react';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\n\nexport interface TimelineEvent {\n  id: string;\n  patientId: string;\n  eventType: 'appointment' | 'sale' | 'device_assignment' | 'note' | 'test' | 'payment' | 'hearing_test' | 'document' | 'activity';\n  title: string;\n  description?: string;\n  eventDate: string;\n  createdBy?: string;\n  user?: string;\n  source?: 'activity_log' | 'custom_data';\n  entityType?: string;\n  entityId?: string;\n  details?: Record<string, any>;\n  metadata?: Record<string, any>;\n  icon?: string;\n  color?: string;\n  category?: string;\n  date?: string;\n  time?: string;\n  timestamp?: string;\n  createdAt: string;\n}\n\n/**\n * Hook for fetching and managing patient timeline\n */\nexport function usePatientTimeline(patientId?: string) {\n  const [timeline, setTimeline] = useState<TimelineEvent[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | string | null>(null);\n\n  const apiService = new PatientApiService();\n\n  // Fetch timeline for a patient\n  const fetchTimeline = useCallback(async (id: string) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiService.getTimeline(id);\n      setTimeline(result?.data || []);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error(String(err)));\n      setTimeline([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiService]);\n\n  // Load timeline on mount or when patientId changes\n  useEffect(() => {\n    if (patientId) {\n      fetchTimeline(patientId);\n    } else {\n      setTimeline([]);\n    }\n  }, [patientId, fetchTimeline]);\n\n  // Clear error\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    // Data\n    timeline,\n    data: timeline,\n\n    // State\n    loading,\n    isLoading: loading,\n    error,\n\n    // Actions\n    fetchTimeline,\n    clearError\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatients.old.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'apiService' is assigned a value but never used.","line":15,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'calculateStats'. Either include it or remove the dependency array. Outer scope values like 'syncService' aren't valid dependencies because mutating them doesn't re-render the component.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":54,"suggestions":[{"desc":"Update the dependencies array to be: [calculateStats, filters, isOnline, storageService]","fix":{"range":[2688,2736],"text":"[calculateStats, filters, isOnline, storageService]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'syncService'. Either exclude it or remove the dependency array. Outer scope values like 'syncService' aren't valid dependencies because mutating them doesn't re-render the component.","line":225,"column":6,"nodeType":"ArrayExpression","endLine":225,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[7039,7052],"text":"[]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { Patient, PatientFilters, PatientSearchResult, PatientStats } from '../../types/patient';\nimport { PatientApiService } from '../../services/patient/patient-api.service';\nimport { PatientStorageService } from '../../services/patient/patient-storage.service';\n// import { patientSyncService } from '../../services/patient/patient-sync.service';\n\n/**\n * usePatients Hook\n * Manages patient list state, filtering, pagination, and offline-first operations\n * Follows 500 LOC limit and single responsibility principle\n */\nexport function usePatients(initialFilters?: PatientFilters) {\n  // Services\n  const apiService = useMemo(() => new PatientApiService(), []);\n  const storageService = useMemo(() => new PatientStorageService(), []);\n  // const syncService = useMemo(() => new PatientSyncService(), []);\n\n  // State\n  const [patients, setPatients] = useState<Patient[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [filters, setFilters] = useState<PatientFilters>(initialFilters || {});\n  const [searchResult, setSearchResult] = useState<PatientSearchResult>({\n    patients: [],\n    total: 0,\n    page: 1,\n    pageSize: 50,\n    hasMore: false\n  });\n  const [stats, setStats] = useState<PatientStats | null>(null);\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n\n  // Online status listener\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  /**\n   * Load patients from storage/API\n   */\n  const loadPatients = useCallback(async (forceRefresh = false) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      if (isOnline && forceRefresh) {\n        // Force sync from server\n        await syncService.forceSync();\n      }\n\n      // Load from local storage with filters\n      const result = await storageService.searchPatients(filters);\n      setSearchResult(result);\n      setPatients(result.patients);\n\n      // Load stats\n      const patientStats = await calculateStats(result.patients);\n      setStats(patientStats);\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to load patients';\n      setError(errorMessage);\n      console.error('Error loading patients:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [filters, isOnline, storageService, syncService]);\n\n  /**\n   * Search patients with new filters\n   */\n  const searchPatients = useCallback(async (newFilters: PatientFilters) => {\n    setFilters(newFilters);\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await storageService.searchPatients(newFilters);\n      setSearchResult(result);\n      setPatients(result.patients);\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to search patients';\n      setError(errorMessage);\n      console.error('Error searching patients:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [storageService]);\n\n  /**\n   * Load more patients (pagination)\n   */\n  const loadMore = useCallback(async () => {\n    if (!searchResult.hasMore || loading) return;\n\n    setLoading(true);\n    try {\n      const nextPage = searchResult.page + 1;\n      const newFilters = { ...filters, page: nextPage };\n      \n      const result = await storageService.searchPatients(newFilters);\n      \n      // Append new patients to existing list\n      setPatients(prev => [...prev, ...result.patients]);\n      setSearchResult(prev => ({\n        ...result,\n        patients: [...prev.patients, ...result.patients]\n      }));\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to load more patients';\n      setError(errorMessage);\n      console.error('Error loading more patients:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [searchResult, loading, filters, storageService]);\n\n  /**\n   * Refresh patients from server\n   */\n  const refresh = useCallback(async () => {\n    await loadPatients(true);\n  }, [loadPatients]);\n\n  /**\n   * Clear filters and reload\n   */\n  const clearFilters = useCallback(async () => {\n    const clearedFilters: PatientFilters = { page: 1, limit: 50 };\n    await searchPatients(clearedFilters);\n  }, [searchPatients]);\n\n  /**\n   * Update patient in local state\n   */\n  const updatePatientInState = useCallback((updatedPatient: Patient) => {\n    setPatients(prev => \n      prev.map(p => p.id === updatedPatient.id ? updatedPatient : p)\n    );\n    \n    setSearchResult(prev => ({\n      ...prev,\n      patients: prev.patients.map(p => p.id === updatedPatient.id ? updatedPatient : p)\n    }));\n  }, []);\n\n  /**\n   * Remove patient from local state\n   */\n  const removePatientFromState = useCallback((patientId: string) => {\n    setPatients(prev => prev.filter(p => p.id !== patientId));\n    \n    setSearchResult(prev => ({\n      ...prev,\n      patients: prev.patients.filter(p => p.id !== patientId),\n      total: prev.total - 1\n    }));\n  }, []);\n\n  /**\n   * Add patient to local state\n   */\n  const addPatientToState = useCallback((newPatient: Patient) => {\n    setPatients(prev => [newPatient, ...prev]);\n    \n    setSearchResult(prev => ({\n      ...prev,\n      patients: [newPatient, ...prev.patients],\n      total: prev.total + 1\n    }));\n  }, []);\n\n  /**\n   * Calculate patient statistics\n   */\n  const calculateStats = useCallback(async (patientList: Patient[]): Promise<PatientStats> => {\n    const total = patientList.length;\n    \n    const byStatus = patientList.reduce((acc, patient) => {\n      acc[patient.status] = (acc[patient.status] || 0) + 1;\n      return acc;\n    }, {} as Record<Patient['status'], number>);\n\n    const bySegment = patientList.reduce((acc, patient) => {\n      acc[patient.segment] = (acc[patient.segment] || 0) + 1;\n      return acc;\n    }, {} as Record<Patient['segment'], number>);\n\n    const byLabel = patientList.reduce((acc, patient) => {\n      acc[patient.label] = (acc[patient.label] || 0) + 1;\n      return acc;\n    }, {} as Record<Patient['label'], number>);\n\n    const highPriority = patientList.filter(p => (p.priorityScore || 0) >= 8).length;\n    const withDevices = patientList.filter(p => p.devices.length > 0).length;\n    const sgkPending = patientList.filter(p => p.sgkStatus === 'pending').length;\n    const overduePayments = patientList.filter(p => (p.overdueAmount || 0) > 0).length;\n\n    return {\n      total,\n      byStatus,\n      bySegment,\n      byLabel,\n      highPriority,\n      withDevices,\n      sgkPending,\n      overduePayments\n    };\n  }, []);\n\n  /**\n   * Get sync status\n   */\n  const getSyncStatus = useCallback(async () => {\n    return await syncService.getSyncStatus();\n  }, [syncService]);\n\n  // Load patients on mount and when filters change\n  useEffect(() => {\n    loadPatients();\n  }, [loadPatients]);\n\n  // Memoized computed values\n  const hasFilters = useMemo(() => {\n    return !!(filters.search || filters.status || filters.segment || \n             filters.label || filters.acquisitionType || \n             (filters.tags && filters.tags.length > 0));\n  }, [filters]);\n\n  const isEmpty = useMemo(() => {\n    return patients.length === 0 && !loading;\n  }, [patients.length, loading]);\n\n  return {\n    // Data\n    patients,\n    searchResult,\n    stats,\n    filters,\n    \n    // State\n    loading,\n    error,\n    isOnline,\n    hasFilters,\n    isEmpty,\n    \n    // Actions\n    loadPatients,\n    searchPatients,\n    loadMore,\n    refresh,\n    clearFilters,\n    updatePatientInState,\n    removePatientFromState,\n    addPatientToState,\n    getSyncStatus,\n    \n    // Utilities\n    setFilters\n  };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/usePatients.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createPatientRequest' is defined but never used.","line":3,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":59},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Patient' is defined but never used.","line":5,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientsCreatePatientBody' is defined but never used.","line":6,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientsGetPatients200' is defined but never used.","line":6,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":64},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'OrvalPatient' is defined but never used.","line":7,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":38},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1281,1284],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1281,1284],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2688,2691],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2688,2691],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3195,3198],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3195,3198],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":183,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6056,6059],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6056,6059],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":193,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6354,6357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6354,6357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientId' is defined but never used.","line":203,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":203,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'updates' is defined but never used.","line":203,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":203,"endColumn":44},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":203,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6613,6616],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6613,6616],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":219,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7223,7226],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7223,7226],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { patientApiService } from '../../services/patient/patient-api.service';\nimport { convertOrvalToLegacyPatient, createPatientRequest } from '../../types/patient/patient-adapter';\nimport { PATIENT_CONSTANTS, PATIENT_QUERY_KEYS } from '../../constants/patient/constants';\nimport type { Patient } from '../../types/patient/patient-base.types';\nimport type { PatientsCreatePatientBody, PatientsGetPatients200 } from \"../../api/generated/xEarCRMAPIAutoGenerated.schemas\";\nimport type { Patient as OrvalPatient, PatientStatus } from \"../../api/generated/xEarCRMAPIAutoGenerated.schemas\";\n\n// Simple filters interface for the hook\ninterface SimplePatientFilters {\n  page?: number;\n  per_page?: number;\n  search?: string;\n  status?: string;\n}\n\n// Offline-first hook for patients list\nexport function usePatients(filters: Partial<SimplePatientFilters> = {}) {\n  const defaultFilters: SimplePatientFilters = {\n    page: 1,\n    per_page: PATIENT_CONSTANTS.PAGINATION.DEFAULT_PAGE_SIZE,\n    ...filters\n  };\n\n  return useQuery({\n    queryKey: PATIENT_QUERY_KEYS.list(defaultFilters),\n    queryFn: async () => {\n      const response = await patientApiService.fetchAllPatients();\n      const data = response as any; // fetchAllPatients returns Patient[] directly\n      \n      // Convert Orval patients to legacy format\n      const patients = (data.data || []).map(convertOrvalToLegacyPatient);\n      \n      return {\n        patients,\n        total: data.pagination?.total || 0,\n        page: data.pagination?.page || 1,\n        pageSize: data.pagination?.perPage || PATIENT_CONSTANTS.PAGINATION.DEFAULT_PAGE_SIZE,\n        hasMore: (data.pagination?.page || 1) < (data.pagination?.totalPages || 1)\n      };\n    },\n    staleTime: PATIENT_CONSTANTS.CACHE.STALE_TIME,\n    gcTime: PATIENT_CONSTANTS.CACHE.GC_TIME,\n  });\n}\n\n// Hook for creating a new patient\nexport function useCreatePatient() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (patientData: {\n      firstName: string;\n      lastName: string;\n      phone: string;\n      tcNumber?: string;\n      email?: string;\n      birthDate?: string;\n      address?: string;\n      status?: PatientStatus;\n    }) => {\n      // Create request using the CreatePatientRequest format expected by the API\n      const request = {\n        name: `${patientData.firstName} ${patientData.lastName}`,\n        email: patientData.email,\n        phone: patientData.phone,\n        birth_date: patientData.birthDate,\n      };\n\n      const response = await patientApiService.createPatient(request);\n      return convertOrvalToLegacyPatient(response as any);\n    },\n    onSuccess: (newPatient) => {\n      // Invalidate and refetch patients list\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.lists() });\n      \n      // Optimistically update cache if we have the new patient data\n      if (newPatient?.id) {\n        queryClient.setQueryData(\n          PATIENT_QUERY_KEYS.detail(newPatient.id),\n          newPatient\n        );\n      }\n      \n      console.log(PATIENT_CONSTANTS.SUCCESS_MESSAGES.PATIENT_CREATED);\n    },\n    onError: (error: any) => {\n      console.error('Failed to create patient:', error);\n      console.error(error?.response?.data?.message || 'Failed to create patient');\n    },\n  });\n}\n\n// Delete patient mutation\nexport const useDeletePatient = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (patientId: string) => {\n      await patientApiService.deletePatient(patientId);\n      return patientId;\n    },\n    onSuccess: (deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: PATIENT_QUERY_KEYS.detail(deletedId) });\n      \n      // Invalidate lists\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.lists() });\n      \n      console.log(PATIENT_CONSTANTS.SUCCESS_MESSAGES.PATIENT_DELETED);\n    },\n    onError: (error) => {\n      console.error('Failed to delete patient:', error);\n    },\n  });\n};\n\nexport const usePatientNotes = (patientId: string) => {\n  return useQuery({\n    queryKey: PATIENT_QUERY_KEYS.notes(patientId),\n    queryFn: () => patientApiService.createNote(patientId, {}), // Using available API method\n    enabled: !!patientId,\n  });\n};\n\nexport const useCreatePatientNote = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ patientId, note }: { patientId: string; note: string }) => {\n      return patientApiService.createNote(patientId, { content: note });\n    },\n    onSuccess: (_, { patientId }) => {\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.notes(patientId) });\n    },\n  });\n};\n\nexport const useDeletePatientNote = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ patientId, noteId }: { patientId: string; noteId: string }) => {\n      return patientApiService.deleteNote(patientId, noteId);\n    },\n    onSuccess: (_, { patientId }) => {\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.notes(patientId) });\n    },\n  });\n};\n\nexport const usePatientTimeline = (patientId: string) => {\n  return useQuery({\n    queryKey: PATIENT_QUERY_KEYS.timeline(patientId),\n    queryFn: () => patientApiService.getTimeline(patientId),\n    enabled: !!patientId,\n  });\n};\n\nexport const usePatientSales = (patientId: string) => {\n  return useQuery({\n    queryKey: PATIENT_QUERY_KEYS.sales(patientId),\n    queryFn: () => patientApiService.getSales(patientId),\n    enabled: !!patientId,\n  });\n};\n\nexport const useBulkUploadPatients = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (file: File) => {\n      const formData = new FormData();\n      formData.append('file', file);\n      return patientApiService.bulkUpload(formData);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.lists() });\n    },\n  });\n};\n\nexport const useSearchPatients = (searchParams: any) => {\n  return useQuery({\n    queryKey: [...PATIENT_QUERY_KEYS.all, 'search', searchParams],\n    queryFn: () => patientApiService.search(searchParams),\n    enabled: !!searchParams?.query,\n  });\n};\n\nexport const useExportPatients = () => {\n  return useMutation({\n    mutationFn: async (filters: any) => {\n      return patientApiService.exportCsv(filters);\n    },\n  });\n};\n\nexport const useUpdatePatient = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ patientId, updates }: { patientId: string; updates: any }) => {\n      // TODO: Implement patient update API when available\n      throw new Error('Patient update API not yet implemented. Please update patient data manually through the backend.');\n    },\n    onSuccess: (updatedPatient, { patientId }) => {\n      // Update cache if update succeeds\n      queryClient.setQueryData(\n        PATIENT_QUERY_KEYS.detail(patientId),\n        updatedPatient\n      );\n\n      // Invalidate lists\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.lists() });\n\n      console.log(PATIENT_CONSTANTS.SUCCESS_MESSAGES.PATIENT_UPDATED);\n    },\n    onError: (error: any) => {\n      console.error('Failed to update patient:', error);\n      console.error(error?.response?.data?.message || 'Failed to update patient');\n    },\n  });\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patient/useSalesFilters.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[83,86],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[83,86],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from 'react';\n\nexport const useSalesFilters = (sales: any[]) => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [paymentMethodFilter, setPaymentMethodFilter] = useState<string>('all');\n  const [dateFrom, setDateFrom] = useState('');\n  const [dateTo, setDateTo] = useState('');\n  const [showFilters, setShowFilters] = useState(false);\n\n  const filteredSales = useMemo(() => {\n    return sales.filter(sale => {\n      // Search term filter\n      if (searchTerm) {\n        const term = searchTerm.toLowerCase();\n        const matchesSearch = \n          sale.productId?.toLowerCase().includes(term) ||\n          sale.paymentMethod?.toLowerCase().includes(term) ||\n          sale.seller?.toLowerCase().includes(term) ||\n          sale.notes?.toLowerCase().includes(term);\n        \n        if (!matchesSearch) return false;\n      }\n\n      // Status filter\n      if (statusFilter !== 'all' && sale.status !== statusFilter) {\n        return false;\n      }\n\n      // Payment method filter\n      if (paymentMethodFilter !== 'all' && sale.paymentMethod !== paymentMethodFilter) {\n        return false;\n      }\n\n      // Date range filter\n      if (dateFrom || dateTo) {\n        const saleDate = new Date(sale.createdAt || sale.date);\n        \n        if (dateFrom) {\n          const fromDate = new Date(dateFrom);\n          if (saleDate < fromDate) return false;\n        }\n        \n        if (dateTo) {\n          const toDate = new Date(dateTo);\n          toDate.setHours(23, 59, 59, 999); // End of day\n          if (saleDate > toDate) return false;\n        }\n      }\n\n      return true;\n    });\n  }, [sales, searchTerm, statusFilter, paymentMethodFilter, dateFrom, dateTo]);\n\n  const clearFilters = () => {\n    setSearchTerm('');\n    setStatusFilter('all');\n    setPaymentMethodFilter('all');\n    setDateFrom('');\n    setDateTo('');\n  };\n\n  return {\n    searchTerm,\n    setSearchTerm,\n    statusFilter,\n    setStatusFilter,\n    paymentMethodFilter,\n    setPaymentMethodFilter,\n    dateFrom,\n    setDateFrom,\n    dateTo,\n    setDateTo,\n    showFilters,\n    setShowFilters,\n    filteredSales,\n    clearFilters\n  };\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patients/usePatient.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Patient' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":17}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useQuery } from '@tanstack/react-query'\nimport { patientApiService } from '@/services/patient/patient-api.service'\nimport { Patient } from '@/types/patient'\n\nexport const usePatient = (patientId?: string) => {\n  const query = useQuery({\n    queryKey: ['patient', patientId],\n    queryFn: async () => {\n      if (!patientId) {\n        throw new Error('Patient ID is required')\n      }\n      \n      // Use our cached patient API service instead of direct API calls\n      const patient = await patientApiService.fetchPatient(patientId)\n      \n      if (!patient) {\n        throw new Error('Patient not found')\n      }\n      \n      return patient\n    },\n    enabled: !!patientId,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes\n  })\n\n  return {\n    patient: query.data,\n    loading: query.isLoading,\n    error: query.error,\n    isOnline: navigator.onLine,\n    refresh: query.refetch,\n    isSuccess: query.isSuccess,\n    isError: query.isError\n  }\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patients/usePatientBulkActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patients/usePatientFilters.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/patients/usePatients.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientStats' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'OrvalPatient' is defined but never used.","line":14,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2353,2356],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2353,2356],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useGlobalError } from '../../components/GlobalErrorHandler';\nimport { patientApiService } from '../../services/patient/patient-api.service';\nimport { PATIENT_QUERY_KEYS, PATIENT_CONSTANTS } from '../../constants/patient';\nimport { \n  Patient as LegacyPatient\n} from '../../types/patient/patient-base.types';\nimport {\n  PatientFilters as LegacyPatientFilters,\n  PatientSearchResult,\n  PatientStats\n} from '../../types/patient/patient-search.types';\nimport { \n  Patient as OrvalPatient,\n  PatientStatus\n} from \"../../api/generated/xEarCRMAPIAutoGenerated.schemas\";\nimport { \n  convertOrvalToLegacyPatient,\n  createPatientRequest\n} from '../../types/patient/patient-adapter';\n\n// Default filters for patient list\nconst defaultFilters: LegacyPatientFilters = {\n  status: undefined,\n  segment: undefined,\n};\n\n/**\n * Hook for fetching patients list with filters\n */\nexport const usePatients = (filters: Partial<LegacyPatientFilters> = {}) => {\n  const finalFilters = { ...defaultFilters, ...filters };\n  \n  return useQuery({\n    queryKey: PATIENT_QUERY_KEYS.list(finalFilters),\n    queryFn: async () => {\n      const response = await patientApiService.getPatients({\n        page: 1,\n        per_page: PATIENT_CONSTANTS.PAGINATION.DEFAULT_PAGE_SIZE,\n        search: '',\n        status: finalFilters.status?.[0] as PatientStatus,\n      });\n      \n      // Convert Orval patients to legacy format\n      const legacyPatients = response.data?.data?.map(convertOrvalToLegacyPatient) || [];\n      \n      return {\n        patients: legacyPatients,\n        totalCount: response.data?.meta?.total || 0,\n        filteredCount: response.data?.meta?.total || 0,\n      } as PatientSearchResult;\n    },\n    staleTime: PATIENT_CONSTANTS.CACHE.STALE_TIME,\n    gcTime: PATIENT_CONSTANTS.CACHE.GC_TIME,\n  });\n};\n\n/**\n * Hook for creating a new patient\n */\nexport const useCreatePatient = () => {\n  const queryClient = useQueryClient();\n  const { showSuccess, showError } = useGlobalError();\n  \n  return useMutation({\n    mutationFn: async (patientData: Partial<LegacyPatient>) => {\n      const orvalRequest = createPatientRequest(patientData as LegacyPatient);\n      const response = await patientApiService.createPatient(orvalRequest);\n      return convertOrvalToLegacyPatient(response as any);\n    },\n    onSuccess: (newPatient) => {\n      // Invalidate and refetch patients list\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.lists() });\n      \n      // Optimistically update cache if we have the patient ID\n      if (newPatient?.id) {\n        queryClient.setQueryData(\n          PATIENT_QUERY_KEYS.detail(newPatient.id),\n          newPatient\n        );\n      }\n      \n      showSuccess(PATIENT_CONSTANTS.SUCCESS_MESSAGES.PATIENT_CREATED);\n    },\n    onError: (error) => {\n      console.error('Failed to create patient:', error);\n      showError(error, { title: 'Hasta Oluşturma Hatası' });\n    },\n  });\n};\n\n/**\n * Hook for deleting a patient\n */\nexport const useDeletePatient = () => {\n  const queryClient = useQueryClient();\n  const { showSuccess, showError } = useGlobalError();\n  \n  return useMutation({\n    mutationFn: async (patientId: string) => {\n      await patientApiService.deletePatient(patientId);\n      return patientId;\n    },\n    onSuccess: (deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: PATIENT_QUERY_KEYS.detail(deletedId) });\n      \n      // Invalidate lists\n      queryClient.invalidateQueries({ queryKey: PATIENT_QUERY_KEYS.lists() });\n      \n      showSuccess(PATIENT_CONSTANTS.SUCCESS_MESSAGES.PATIENT_DELETED);\n    },\n    onError: (error) => {\n      console.error('Failed to delete patient:', error);\n      showError(error, { title: 'Hasta Silme Hatası' });\n    },\n  });\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/sgk/useSgk.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[659,662],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[659,662],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1003,1006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1003,1006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMutation, useQueryClient } from '@tanstack/react-query';\nimport sgkService from '@/services/sgk/sgk.service';\n\n// Note: The OpenAPI/Orval-generated client in this repo exposes SGK document endpoints and OCR/processing\n// helpers (sgkGetPatientSgkDocuments, sgkUploadSgkDocument, sgkDeleteSgkDocument, sgkProcessOcr, automationTriggerSgkProcessing).\n// There are no generic CRUD endpoints for \"SGK records\" in the generated client. We expose processing hooks\n// and provide clear placeholders for CRUD once backend endpoints exist.\n\nexport function useProcessSgkOcr() {\n  const qc = useQueryClient();\n  return useMutation({\n    mutationFn: (body?: any) => sgkService.processOcr(body),\n    onSuccess: () => {\n      // Invalidate potentially affected queries (patient documents may change after OCR)\n      qc.invalidateQueries({ queryKey: ['patients'] });\n    },\n  });\n}\n\nexport function useTriggerSgkProcessing() {\n  const qc = useQueryClient();\n  return useMutation({\n    mutationFn: (body?: any) => sgkService.triggerProcessing(body),\n    onSuccess: () => qc.invalidateQueries({ queryKey: ['patients'] }),\n  });\n}\n\n// Placeholder CRUD hooks for SGK records. Backend currently doesn't expose these endpoints in the generated client.\n// Keep these small and explicit so we can implement them when backend is available.\nexport function useSgkList() {\n  throw new Error('useSgkList: not implemented — backend SGK list endpoint not present in API client');\n}\n\nexport function useSgk() {\n  throw new Error('useSgk: not implemented — backend SGK get endpoint not present in API client');\n}\n\nexport function useCreateSgk() {\n  throw new Error('useCreateSgk: not implemented — backend SGK create endpoint not present in API client');\n}\n\nexport function useUpdateSgk() {\n  throw new Error('useUpdateSgk: not implemented — backend SGK update endpoint not present in API client');\n}\n\nexport function useDeleteSgk() {\n  throw new Error('useDeleteSgk: not implemented — backend SGK delete endpoint not present in API client');\n}\n\nexport default useProcessSgkOcr;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/sgk/useSgkDocuments.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/sgk/useSgkDocuments.spec.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1310,1313],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1310,1313],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1627,1630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1627,1630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1814,1817],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1814,1817],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2110,2113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2110,2113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2169,2172],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2169,2172],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2227,2230],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2227,2230],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2400,2403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2400,2403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2696,2699],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2696,2699],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2799,2802],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2799,2802],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3066,3069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3066,3069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3156,3159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3156,3159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3220,3223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3220,3223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":94,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3591,3594],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3591,3594],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3671,3674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3671,3674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":103,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3957,3960],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3957,3960],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { renderHook, act, waitFor } from '@testing-library/react';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { vi, describe, it, expect, beforeEach, afterEach } from 'vitest';\n\nconst createClient = () => new QueryClient({ defaultOptions: { queries: { retry: false } } });\n\nvi.mock('../../services/sgk/sgk.service', () => ({\n  __esModule: true,\n  default: {\n    listDocuments: vi.fn(),\n    uploadDocument: vi.fn(),\n    deleteDocument: vi.fn(),\n  },\n}));\nimport sgkService from '../../services/sgk/sgk.service';\nvi.mock('../../utils/outbox', () => ({\n  __esModule: true,\n  outbox: {\n    addOperation: vi.fn(),\n  },\n}));\nvi.mock('../../utils/indexeddb', () => ({\n  __esModule: true,\n  indexedDBManager: {\n    saveFileBlob: vi.fn(),\n    getFileBlob: vi.fn(),\n  },\n}));\nimport { outbox } from '../../utils/outbox';\nimport { indexedDBManager } from '../../utils/indexeddb';\nimport { useSgkDocuments, useUploadSgkDocument, useDeleteSgkDocument } from './useSgkDocuments';\n\ndescribe('useSgkDocuments hooks', () => {\n  let qc: QueryClient;\n  beforeEach(() => {\n    qc = createClient();\n  });\n  afterEach(() => {\n    qc.clear();\n    vi.resetAllMocks();\n  });\n\n  it('fetches documents with useSgkDocuments', async () => {\n    (sgkService.listDocuments as any).mockResolvedValue({ data: [{ id: 'doc1' }] });\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => <QueryClientProvider client={qc}>{children}</QueryClientProvider>;\n    const { result } = renderHook(() => useSgkDocuments('patient-1'), { wrapper });\n\n    await waitFor(() => (result.current as any).isSuccess);\n    expect(sgkService.listDocuments).toHaveBeenCalledWith('patient-1');\n  });\n\n  it('uploads a document and invalidates', async () => {\n    (sgkService.uploadDocument as any).mockResolvedValue({});\n    const wrapper = ({ children }: { children: React.ReactNode }) => <QueryClientProvider client={qc}>{children}</QueryClientProvider>;\n\n    const { result } = renderHook(() => useUploadSgkDocument('patient-1'), { wrapper });\n\n    act(() => {\n      (result.current as any).mutate({ append: 'data', idempotencyKey: 'key-1' } as any);\n    });\n\n    await waitFor(() => (result.current as any).isSuccess);\n    expect(sgkService.uploadDocument).toHaveBeenCalled();\n  });\n\n  it('deletes a document and invalidates', async () => {\n    (sgkService.deleteDocument as any).mockResolvedValue({});\n    const wrapper = ({ children }: { children: React.ReactNode }) => <QueryClientProvider client={qc}>{children}</QueryClientProvider>;\n\n    const { result } = renderHook(() => useDeleteSgkDocument('patient-1'), { wrapper });\n\n    act(() => {\n      (result.current as any).mutate({ id: 'doc1', idempotencyKey: 'k1' });\n    });\n\n    await waitFor(() => (result.current as any).isSuccess);\n    expect(sgkService.deleteDocument).toHaveBeenCalledWith('doc1', { idempotencyKey: 'k1' });\n  });\n\n  it('falls back to IndexedDB + outbox when upload fails (offline)', async () => {\n    // Simulate network failure\n    (sgkService.uploadDocument as any).mockRejectedValue(new Error('Network error'));\n    (indexedDBManager.saveFileBlob as any).mockResolvedValue('blob-123');\n    (outbox.addOperation as any).mockResolvedValue({ id: 'op-1' });\n\n    const wrapper = ({ children }: { children: React.ReactNode }) => <QueryClientProvider client={qc}>{children}</QueryClientProvider>;\n    const { result } = renderHook(() => useUploadSgkDocument('patient-1'), { wrapper });\n\n    const file = new Blob(['hello'], { type: 'text/plain' });\n\n    act(() => {\n      (result.current as any).mutate({ file }, { });\n    });\n\n    await waitFor(() => (result.current as any).isSuccess);\n\n    // ensure blob was saved and outbox operation queued\n    expect(indexedDBManager.saveFileBlob).toHaveBeenCalled();\n    expect(outbox.addOperation).toHaveBeenCalled();\n    // returned data should be the queued temporary response\n    const data = (result.current as any).data;\n    expect(data).toBeDefined();\n    expect(data.data?.status).toBe('queued');\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/sgk/useSgkDocuments.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[753,756],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[753,756],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[836,839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[836,839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[957,960],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[957,960],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1156,1159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1156,1159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":98,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":101,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1217,1220],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1217,1220],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":124,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":127,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1243,1246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1243,1246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1388,1391],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1388,1391],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":125,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":128,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1414,1417],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1414,1417],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1636,1639],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1636,1639],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1662,1665],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1662,1665],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1941,1944],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1941,1944],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport sgkService from '@/services/sgk/sgk.service';\nimport { outbox } from '@/utils/outbox';\nimport { indexedDBManager } from '@/utils/indexeddb';\n\nconst generateIdempotencyKey = () => `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n\nconst QUERY_KEY = (patientId: string) => ['patients', patientId, 'sgk-documents'] as const;\n\nexport function useSgkDocuments(patientId: string) {\n  return useQuery({ queryKey: QUERY_KEY(patientId), queryFn: () => sgkService.listDocuments(patientId) });\n}\n\nexport function useUploadSgkDocument(patientId: string) {\n  const qc = useQueryClient();\n  return useMutation({\n    mutationFn: async (formData: FormData | Record<string, any> & { idempotencyKey?: string }) => {\n      const idempotencyKey = (formData as any).idempotencyKey || generateIdempotencyKey();\n\n      try {\n        return await sgkService.uploadDocument(formData as any, { idempotencyKey });\n      } catch (err) {\n        // On network/offline failure, serialize file blob to IndexedDB and enqueue outbox operation\n        try {\n          const file = (formData as any).get ? (formData as FormData).get('file') : (formData as any).file || (formData as any)[0];\n          if (file instanceof Blob) {\n            const blobId = await indexedDBManager.saveFileBlob(file as Blob, { filename: (file as any).name, mime: (file as any).type });\n            await outbox.addOperation({\n              method: 'POST',\n              endpoint: `/api/sgk/documents?patientId=${encodeURIComponent(patientId)}`,\n              data: { blobId, filename: (file as any).name, mime: (file as any).type },\n              headers: { 'Idempotency-Key': idempotencyKey },\n              maxRetries: 5,\n            });\n            // Return a temporary response to the UI so it can show optimistic state\n            return { data: { id: `temp-${Date.now()}`, filename: (file as any).name, status: 'queued' } };\n          }\n        } catch (e) {\n          console.warn('Failed to enqueue upload to outbox:', e);\n        }\n\n        throw err;\n      }\n    },\n    onSuccess: () => qc.invalidateQueries({ queryKey: QUERY_KEY(patientId) }),\n  });\n}\n\nexport function useUploadSgkDocuments() {\n  return useMutation({\n    mutationFn: async (formData: FormData) => {\n      const idempotencyKey = generateIdempotencyKey();\n      return await sgkService.uploadDocument(formData, { idempotencyKey });\n    },\n  });\n}\n\nexport default useSgkDocuments;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useAppointments.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'appointments'. Either exclude it or remove the dependency array.","line":307,"column":6,"nodeType":"ArrayExpression","endLine":307,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [currentFilters]","fix":{"range":[10261,10291],"text":"[currentFilters]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useMemo } from 'react';\nimport { \n  Appointment, \n  AppointmentFilters, \n  AppointmentStats, \n  CreateAppointmentData,\n  UpdateAppointmentData,\n  AppointmentSearchResult,\n  AvailabilityRequest,\n  AvailabilityResponse,\n  RescheduleRequest,\n  BulkAppointmentOperation,\n  BulkOperationResult,\n  AppointmentValidation\n} from '../types/appointment';\nimport { appointmentService } from '../services/appointment.service';\n\nexport interface UseAppointmentsOptions {\n  filters?: AppointmentFilters;\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n}\n\nexport interface UseAppointmentsReturn {\n  // Data\n  appointments: Appointment[];\n  appointment: Appointment | null;\n  stats: AppointmentStats;\n  \n  // Loading states\n  loading: boolean;\n  creating: boolean;\n  updating: boolean;\n  deleting: boolean;\n  \n  // Error states\n  error: string | null;\n  \n  // Actions\n  createAppointment: (data: CreateAppointmentData) => Promise<Appointment>;\n  updateAppointment: (id: string, data: Partial<UpdateAppointmentData>) => Promise<Appointment>;\n  deleteAppointment: (id: string) => Promise<void>;\n  getAppointment: (id: string) => void;\n  refreshAppointments: () => void;\n  clearError: () => void;\n  \n  // Filtering and search\n  setFilters: (filters: AppointmentFilters) => void;\n  searchAppointments: (query: string, limit?: number) => AppointmentSearchResult;\n  \n  // Specialized queries\n  getAppointmentsByPatient: (patientId: string) => Appointment[];\n  getAppointmentsByDate: (date: string) => Appointment[];\n  getTodaysAppointments: () => Appointment[];\n  getUpcomingAppointments: (days?: number) => Appointment[];\n  \n  // Availability and scheduling\n  checkAvailability: (request: AvailabilityRequest) => Promise<AvailabilityResponse>;\n  rescheduleAppointment: (request: RescheduleRequest) => Promise<Appointment>;\n  \n  // Status operations\n  cancelAppointment: (id: string, reason?: string) => Promise<Appointment>;\n  completeAppointment: (id: string, notes?: string) => Promise<Appointment>;\n  markNoShow: (id: string) => Promise<Appointment>;\n  \n  // Bulk operations\n  bulkOperation: (operation: BulkAppointmentOperation) => Promise<BulkOperationResult>;\n  \n  // Validation\n  validateAppointment: (appointment: Appointment) => AppointmentValidation;\n}\n\nexport function useAppointments(options: UseAppointmentsOptions = {}): UseAppointmentsReturn {\n  const { filters, autoRefresh = false, refreshInterval = 120000 } = options; // 2 minutes instead of 30 seconds\n  \n  // State\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\n  const [appointment, setAppointment] = useState<Appointment | null>(null);\n  const [currentFilters, setCurrentFilters] = useState<AppointmentFilters>(filters || {});\n  const [loading, setLoading] = useState(false);\n  const [creating, setCreating] = useState(false);\n  const [updating, setUpdating] = useState(false);\n  const [deleting, setDeleting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load appointments\n  const loadAppointments = useCallback(() => {\n    try {\n      setLoading(true);\n      setError(null);\n      const filteredAppointments = appointmentService.getAppointments(currentFilters);\n      setAppointments(filteredAppointments);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load appointments');\n    } finally {\n      setLoading(false);\n    }\n  }, [currentFilters]);\n\n  // Subscribe to appointment changes\n  useEffect(() => {\n    const unsubscribe = appointmentService.subscribe(() => {\n      loadAppointments();\n    });\n\n    // Initial load\n    loadAppointments();\n\n    return unsubscribe;\n  }, [loadAppointments]);\n\n  // Auto refresh\n  useEffect(() => {\n    if (!autoRefresh) return;\n\n    const interval = setInterval(() => {\n      loadAppointments();\n    }, refreshInterval);\n\n    return () => clearInterval(interval);\n  }, [autoRefresh, refreshInterval, loadAppointments]);\n\n  // Actions\n  const createAppointment = useCallback(async (data: CreateAppointmentData): Promise<Appointment> => {\n    try {\n      setCreating(true);\n      setError(null);\n      const newAppointment = await appointmentService.createAppointment(data);\n      return newAppointment;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to create appointment';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setCreating(false);\n    }\n  }, []);\n\n  const updateAppointment = useCallback(async (id: string, data: Partial<UpdateAppointmentData>): Promise<Appointment> => {\n    try {\n      setUpdating(true);\n      setError(null);\n      const updatedAppointment = await appointmentService.updateAppointment(id, data);\n      return updatedAppointment;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to update appointment';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setUpdating(false);\n    }\n  }, []);\n\n  const deleteAppointment = useCallback(async (id: string): Promise<void> => {\n    try {\n      setDeleting(true);\n      setError(null);\n      await appointmentService.deleteAppointment(id);\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to delete appointment';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setDeleting(false);\n    }\n  }, []);\n\n  const getAppointment = useCallback((id: string) => {\n    try {\n      const foundAppointment = appointmentService.getAppointment(id);\n      setAppointment(foundAppointment || null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to get appointment');\n    }\n  }, []);\n\n  const refreshAppointments = useCallback(() => {\n    loadAppointments();\n  }, [loadAppointments]);\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const setFilters = useCallback((newFilters: AppointmentFilters) => {\n    setCurrentFilters(newFilters);\n  }, []);\n\n  const searchAppointments = useCallback((query: string, limit?: number): AppointmentSearchResult => {\n    return appointmentService.searchAppointments(query, limit);\n  }, []);\n\n  // Specialized queries\n  const getAppointmentsByPatient = useCallback((patientId: string): Appointment[] => {\n    return appointmentService.getAppointmentsByPatient(patientId);\n  }, []);\n\n  const getAppointmentsByDate = useCallback((date: string): Appointment[] => {\n    return appointmentService.getAppointmentsByDate(date);\n  }, []);\n\n  const getTodaysAppointments = useCallback((): Appointment[] => {\n    return appointmentService.getTodaysAppointments();\n  }, []);\n\n  const getUpcomingAppointments = useCallback((days?: number): Appointment[] => {\n    return appointmentService.getUpcomingAppointments(days);\n  }, []);\n\n  // Availability and scheduling\n  const checkAvailability = useCallback(async (request: AvailabilityRequest): Promise<AvailabilityResponse> => {\n    try {\n      setError(null);\n      return await appointmentService.checkAvailability(request);\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to check availability';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    }\n  }, []);\n\n  const rescheduleAppointment = useCallback(async (request: RescheduleRequest): Promise<Appointment> => {\n    try {\n      setUpdating(true);\n      setError(null);\n      const rescheduledAppointment = await appointmentService.rescheduleAppointment(request);\n      return rescheduledAppointment;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to reschedule appointment';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setUpdating(false);\n    }\n  }, []);\n\n  // Status operations\n  const cancelAppointment = useCallback(async (id: string, reason?: string): Promise<Appointment> => {\n    try {\n      setUpdating(true);\n      setError(null);\n      const cancelledAppointment = await appointmentService.cancelAppointment(id, reason);\n      return cancelledAppointment;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to cancel appointment';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setUpdating(false);\n    }\n  }, []);\n\n  const completeAppointment = useCallback(async (id: string, notes?: string): Promise<Appointment> => {\n    try {\n      setUpdating(true);\n      setError(null);\n      const completedAppointment = await appointmentService.completeAppointment(id, notes);\n      return completedAppointment;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to complete appointment';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setUpdating(false);\n    }\n  }, []);\n\n  const markNoShow = useCallback(async (id: string): Promise<Appointment> => {\n    try {\n      setUpdating(true);\n      setError(null);\n      const noShowAppointment = await appointmentService.markNoShow(id);\n      return noShowAppointment;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to mark no-show';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setUpdating(false);\n    }\n  }, []);\n\n  // Bulk operations\n  const bulkOperation = useCallback(async (operation: BulkAppointmentOperation): Promise<BulkOperationResult> => {\n    try {\n      setUpdating(true);\n      setError(null);\n      const result = await appointmentService.bulkOperation(operation);\n      return result;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to perform bulk operation';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    } finally {\n      setUpdating(false);\n    }\n  }, []);\n\n  // Validation\n  const validateAppointment = useCallback((appointment: Appointment): AppointmentValidation => {\n    return appointmentService['validateAppointment'](appointment);\n  }, []);\n\n  // Computed stats\n  const stats = useMemo((): AppointmentStats => {\n    return appointmentService.getAppointmentStats(currentFilters);\n  }, [appointments, currentFilters]);\n\n  return {\n    // Data\n    appointments,\n    appointment,\n    stats,\n    \n    // Loading states\n    loading,\n    creating,\n    updating,\n    deleting,\n    \n    // Error states\n    error,\n    \n    // Actions\n    createAppointment,\n    updateAppointment,\n    deleteAppointment,\n    getAppointment,\n    refreshAppointments,\n    clearError,\n    \n    // Filtering and search\n    setFilters,\n    searchAppointments,\n    \n    // Specialized queries\n    getAppointmentsByPatient,\n    getAppointmentsByDate,\n    getTodaysAppointments,\n    getUpcomingAppointments,\n    \n    // Availability and scheduling\n    checkAvailability,\n    rescheduleAppointment,\n    \n    // Status operations\n    cancelAppointment,\n    completeAppointment,\n    markNoShow,\n    \n    // Bulk operations\n    bulkOperation,\n    \n    // Validation\n    validateAppointment\n  };\n}\n\n// Specialized hooks for common use cases\nexport function useAppointmentsByPatient(patientId: string) {\n  return useAppointments({ \n    filters: { patientId },\n    autoRefresh: false // Disable auto-refresh for patient-specific appointments\n  });\n}\n\nexport function useTodaysAppointments() {\n  const today = new Date().toISOString().split('T')[0];\n  return useAppointments({ \n    filters: { startDate: today, endDate: today },\n    autoRefresh: true,\n    refreshInterval: 300000 // Refresh every 5 minutes instead of 1 minute\n  });\n}\n\nexport function useUpcomingAppointments(days: number = 7) {\n  const today = new Date().toISOString().split('T')[0];\n  const endDate = new Date();\n  endDate.setDate(endDate.getDate() + days);\n  \n  return useAppointments({ \n    filters: { \n      startDate: today, \n      endDate: endDate.toISOString().split('T')[0],\n      status: 'scheduled'\n    },\n    autoRefresh: false // Disable auto-refresh for upcoming appointments\n  });\n}\n\nexport function useAppointmentStats(filters?: AppointmentFilters) {\n  const { stats } = useAppointments({ filters });\n  return stats;\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useCommunicationOfflineSync.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":242,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":242,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6786,6789],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6786,6789],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":290,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":290,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8208,8211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8208,8211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":352,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":352,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10426,10429],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10426,10429],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":381,"column":87,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":381,"endColumn":90,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11343,11346],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11343,11346],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { useState, useEffect, useCallback } from 'react';\nimport { getXEarCRMAPIAutoGenerated } from '../api/generated/xEarCRMAPIAutoGenerated';\n\n// Simplified types without idb dependency for now\ninterface CommunicationMessage {\n  id: string;\n  type: 'sms' | 'email';\n  recipient: string;\n  recipientName?: string;\n  patientId?: string;\n  subject?: string;\n  content: string;\n  templateId?: string;\n  scheduledAt?: string;\n  sentAt?: string;\n  deliveredAt?: string;\n  status: 'draft' | 'scheduled' | 'sent' | 'delivered' | 'failed';\n  errorMessage?: string;\n  campaignId?: string;\n  messageType: 'manual' | 'appointment_reminder' | 'campaign' | 'automated';\n  createdAt: string;\n  updatedAt?: string;\n  syncStatus: 'synced' | 'pending' | 'failed';\n  lastSyncAttempt?: string;\n}\n\ninterface CommunicationTemplate {\n  id: string;\n  name: string;\n  description?: string;\n  templateType: 'sms' | 'email';\n  category?: string;\n  subject?: string;\n  bodyText: string;\n  bodyHtml?: string;\n  variables: string[];\n  isActive: boolean;\n  isSystem: boolean;\n  usageCount: number;\n  createdAt: string;\n  updatedAt: string;\n  syncStatus: 'synced' | 'pending' | 'failed';\n  lastSyncAttempt?: string;\n}\n\ninterface SyncStatus {\n  isOnline: boolean;\n  isSyncing: boolean;\n  pendingCount: {\n    messages: number;\n    templates: number;\n    outbox: number;\n  };\n  lastSyncTime?: Date;\n  error?: string;\n}\n\n// Simple localStorage-based implementation for now\nclass SimpleCommunicationSync {\n  private readonly STORAGE_KEYS = {\n    messages: 'communication_messages',\n    templates: 'communication_templates',\n    outbox: 'communication_outbox',\n    syncMetadata: 'communication_sync_metadata'\n  };\n\n  private syncInProgress = false;\n  private listeners: Set<() => void> = new Set();\n\n  // Event handling\n  addListener(callback: () => void): void {\n    this.listeners.add(callback);\n  }\n\n  removeListener(callback: () => void): void {\n    this.listeners.delete(callback);\n  }\n\n  private notifyListeners(): void {\n    this.listeners.forEach(callback => callback());\n  }\n\n  // Messages\n  async saveMessage(message: Omit<CommunicationMessage, 'syncStatus'>): Promise<void> {\n    const messages = this.getMessages();\n    const messageWithSync: CommunicationMessage = {\n      ...message,\n      syncStatus: 'pending',\n      updatedAt: new Date().toISOString()\n    };\n\n    messages.push(messageWithSync);\n    localStorage.setItem(this.STORAGE_KEYS.messages, JSON.stringify(messages));\n\n    // Add to outbox\n    this.addToOutbox('create', 'message', message.id, messageWithSync);\n    this.notifyListeners();\n\n    // Attempt sync if online\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async updateMessage(id: string, updates: Partial<CommunicationMessage>): Promise<void> {\n    const messages = this.getMessages();\n    const index = messages.findIndex(m => m.id === id);\n    \n    if (index === -1) throw new Error('Message not found');\n\n    messages[index] = {\n      ...messages[index],\n      ...updates,\n      syncStatus: 'pending',\n      updatedAt: new Date().toISOString()\n    };\n\n    localStorage.setItem(this.STORAGE_KEYS.messages, JSON.stringify(messages));\n    this.addToOutbox('update', 'message', id, updates);\n    this.notifyListeners();\n\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  getMessages(filters?: {\n    type?: 'sms' | 'email';\n    status?: string;\n    patientId?: string;\n    limit?: number;\n    offset?: number;\n  }): CommunicationMessage[] {\n    const stored = localStorage.getItem(this.STORAGE_KEYS.messages);\n    let messages: CommunicationMessage[] = stored ? JSON.parse(stored) : [];\n\n    // Apply filters\n    if (filters?.type) {\n      messages = messages.filter(m => m.type === filters.type);\n    }\n    if (filters?.status) {\n      messages = messages.filter(m => m.status === filters.status);\n    }\n    if (filters?.patientId) {\n      messages = messages.filter(m => m.patientId === filters.patientId);\n    }\n\n    // Sort by created date (newest first)\n    messages.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n\n    // Apply pagination\n    if (filters?.offset || filters?.limit) {\n      const start = filters.offset || 0;\n      const end = filters.limit ? start + filters.limit : undefined;\n      messages = messages.slice(start, end);\n    }\n\n    return messages;\n  }\n\n  // Templates\n  async saveTemplate(template: Omit<CommunicationTemplate, 'syncStatus'>): Promise<void> {\n    const templates = this.getTemplates();\n    const templateWithSync: CommunicationTemplate = {\n      ...template,\n      syncStatus: 'pending'\n    };\n\n    templates.push(templateWithSync);\n    localStorage.setItem(this.STORAGE_KEYS.templates, JSON.stringify(templates));\n\n    this.addToOutbox('create', 'template', template.id, templateWithSync);\n    this.notifyListeners();\n\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async updateTemplate(id: string, updates: Partial<CommunicationTemplate>): Promise<void> {\n    const templates = this.getTemplates();\n    const index = templates.findIndex(t => t.id === id);\n    \n    if (index === -1) throw new Error('Template not found');\n\n    templates[index] = {\n      ...templates[index],\n      ...updates,\n      syncStatus: 'pending',\n      updatedAt: new Date().toISOString()\n    };\n\n    localStorage.setItem(this.STORAGE_KEYS.templates, JSON.stringify(templates));\n    this.addToOutbox('update', 'template', id, updates);\n    this.notifyListeners();\n\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async deleteTemplate(id: string): Promise<void> {\n    const templates = this.getTemplates();\n    const filtered = templates.filter(t => t.id !== id);\n    \n    localStorage.setItem(this.STORAGE_KEYS.templates, JSON.stringify(filtered));\n    this.addToOutbox('delete', 'template', id, null);\n    this.notifyListeners();\n\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  getTemplates(filters?: {\n    type?: 'sms' | 'email';\n    category?: string;\n    active?: boolean;\n  }): CommunicationTemplate[] {\n    const stored = localStorage.getItem(this.STORAGE_KEYS.templates);\n    let templates: CommunicationTemplate[] = stored ? JSON.parse(stored) : [];\n\n    // Apply filters\n    if (filters?.type) {\n      templates = templates.filter(t => t.templateType === filters.type);\n    }\n    if (filters?.category) {\n      templates = templates.filter(t => t.category === filters.category);\n    }\n    if (filters?.active !== undefined) {\n      templates = templates.filter(t => t.isActive === filters.active);\n    }\n\n    // Sort by name\n    templates.sort((a, b) => a.name.localeCompare(b.name));\n\n    return templates;\n  }\n\n  // Outbox management\n  private addToOutbox(action: string, entityType: string, entityId: string, data: any): void {\n    const stored = localStorage.getItem(this.STORAGE_KEYS.outbox);\n    const outbox = stored ? JSON.parse(stored) : [];\n\n    outbox.push({\n      id: `${entityType}_${action}_${entityId}_${Date.now()}`,\n      action,\n      entityType,\n      entityId,\n      data,\n      createdAt: new Date().toISOString(),\n      retryCount: 0\n    });\n\n    localStorage.setItem(this.STORAGE_KEYS.outbox, JSON.stringify(outbox));\n  }\n\n  async syncOutbox(): Promise<void> {\n    if (this.syncInProgress || !navigator.onLine) return;\n\n    this.syncInProgress = true;\n    this.notifyListeners();\n\n    try {\n      const stored = localStorage.getItem(this.STORAGE_KEYS.outbox);\n      const outbox = stored ? JSON.parse(stored) : [];\n      const remaining = [];\n\n      for (const item of outbox) {\n        try {\n          await this.syncOutboxItem(item);\n          // Successfully synced, don't add to remaining\n        } catch (error) {\n          console.error('Failed to sync outbox item:', item.id, error);\n          item.retryCount++;\n          item.lastRetryAt = new Date().toISOString();\n          item.error = error instanceof Error ? error.message : 'Unknown error';\n          remaining.push(item);\n        }\n      }\n\n      localStorage.setItem(this.STORAGE_KEYS.outbox, JSON.stringify(remaining));\n    } finally {\n      this.syncInProgress = false;\n      this.notifyListeners();\n    }\n  }\n\n  private async syncOutboxItem(item: any): Promise<void> {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      \n      if (item.entityType === 'template') {\n        if (item.action === 'create') {\n          await api.communicationsCreateTemplate(item.data);\n        } else if (item.action === 'update') {\n          await api.communicationsUpdateTemplate(item.entityId, item.data);\n        } else if (item.action === 'delete') {\n          await api.communicationsDeleteTemplate(item.entityId);\n        }\n      }\n      // Note: Messages endpoint doesn't have create/update/delete operations in the current API\n      // This would need to be implemented when those endpoints are added\n      \n    } catch (error) {\n      throw new Error(`Failed to sync ${item.action} ${item.entityType}: ${error}`);\n    }\n\n    // Update local sync status\n    if (item.action !== 'delete') {\n      if (item.entityType === 'message') {\n        const messages = this.getMessages();\n        const index = messages.findIndex(m => m.id === item.entityId);\n        if (index !== -1) {\n          messages[index].syncStatus = 'synced';\n          localStorage.setItem(this.STORAGE_KEYS.messages, JSON.stringify(messages));\n        }\n      } else if (item.entityType === 'template') {\n        const templates = this.getTemplates();\n        const index = templates.findIndex(t => t.id === item.entityId);\n        if (index !== -1) {\n          templates[index].syncStatus = 'synced';\n          localStorage.setItem(this.STORAGE_KEYS.templates, JSON.stringify(templates));\n        }\n      }\n    }\n  }\n\n  // Sync from server\n  async syncFromServer(): Promise<void> {\n    if (!navigator.onLine) return;\n\n    try {\n      await Promise.all([\n        this.syncMessagesFromServer(),\n        this.syncTemplatesFromServer()\n      ]);\n      this.notifyListeners();\n    } catch (error) {\n      console.error('Failed to sync from server:', error);\n    }\n  }\n\n  private async syncMessagesFromServer(): Promise<void> {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.communicationsListMessages({ per_page: 1000 });\n      \n      if (!response.data.success) return;\n\n      const serverMessages: CommunicationMessage[] = response.data.data?.map((msg: any) => ({\n        ...msg,\n        syncStatus: 'synced' as const\n      })) || [];\n\n      // Merge with local messages\n      const localMessages = this.getMessages();\n      const merged = [...serverMessages];\n\n      // Add local messages that aren't on server\n      localMessages.forEach(local => {\n        if (!serverMessages.find(server => server.id === local.id)) {\n          merged.push(local);\n        }\n      });\n\n      localStorage.setItem(this.STORAGE_KEYS.messages, JSON.stringify(merged));\n    } catch (error) {\n      console.error('Failed to sync messages from server:', error);\n    }\n  }\n\n  private async syncTemplatesFromServer(): Promise<void> {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.communicationsListTemplates();\n      \n      if (!response.data.success) return;\n\n      const serverTemplates: CommunicationTemplate[] = response.data.data?.map((tmpl: any) => ({\n        ...tmpl,\n        syncStatus: 'synced' as const\n      })) || [];\n\n      // Merge with local templates\n      const localTemplates = this.getTemplates();\n      const merged = [...serverTemplates];\n\n      // Add local templates that aren't on server\n      localTemplates.forEach(local => {\n        if (!serverTemplates.find(server => server.id === local.id)) {\n          merged.push(local);\n        }\n      });\n\n      localStorage.setItem(this.STORAGE_KEYS.templates, JSON.stringify(merged));\n    } catch (error) {\n      console.error('Failed to sync templates from server:', error);\n    }\n  }\n\n  // Status methods\n  getPendingSyncCount(): { messages: number; templates: number; outbox: number } {\n    const messages = this.getMessages().filter(m => m.syncStatus === 'pending');\n    const templates = this.getTemplates().filter(t => t.syncStatus === 'pending');\n    const stored = localStorage.getItem(this.STORAGE_KEYS.outbox);\n    const outbox = stored ? JSON.parse(stored) : [];\n\n    return {\n      messages: messages.length,\n      templates: templates.length,\n      outbox: outbox.length\n    };\n  }\n\n  isOnline(): boolean {\n    return navigator.onLine;\n  }\n\n  isSyncInProgress(): boolean {\n    return this.syncInProgress;\n  }\n}\n\n// Singleton instance\nconst communicationSync = new SimpleCommunicationSync();\n\n// React hook\nexport const useCommunicationOfflineSync = () => {\n  const [syncStatus, setSyncStatus] = useState<SyncStatus>({\n    isOnline: navigator.onLine,\n    isSyncing: false,\n    pendingCount: { messages: 0, templates: 0, outbox: 0 }\n  });\n\n  const updateSyncStatus = useCallback(() => {\n    setSyncStatus({\n      isOnline: communicationSync.isOnline(),\n      isSyncing: communicationSync.isSyncInProgress(),\n      pendingCount: communicationSync.getPendingSyncCount()\n    });\n  }, []);\n\n  useEffect(() => {\n    // Initial status\n    updateSyncStatus();\n\n    // Listen for online/offline events\n    const handleOnline = () => {\n      updateSyncStatus();\n      communicationSync.syncOutbox();\n      communicationSync.syncFromServer();\n    };\n\n    const handleOffline = () => {\n      updateSyncStatus();\n    };\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    // Listen for sync changes\n    communicationSync.addListener(updateSyncStatus);\n\n    // Periodic sync - reduced from 30s to 5 minutes to prevent excessive requests\n    const interval = setInterval(() => {\n      if (navigator.onLine) {\n        communicationSync.syncOutbox();\n        communicationSync.syncFromServer();\n      }\n    }, 300000); // Changed from 30000 (30s) to 300000 (5 minutes)\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n      communicationSync.removeListener(updateSyncStatus);\n      clearInterval(interval);\n    };\n  }, [updateSyncStatus]);\n\n  // API methods\n  const saveMessage = useCallback(async (message: Omit<CommunicationMessage, 'syncStatus'>) => {\n    await communicationSync.saveMessage(message);\n    updateSyncStatus();\n  }, [updateSyncStatus]);\n\n  const updateMessage = useCallback(async (id: string, updates: Partial<CommunicationMessage>) => {\n    await communicationSync.updateMessage(id, updates);\n    updateSyncStatus();\n  }, [updateSyncStatus]);\n\n  const getMessages = useCallback((filters?: {\n    type?: 'sms' | 'email';\n    status?: string;\n    patientId?: string;\n    limit?: number;\n    offset?: number;\n  }) => {\n    return communicationSync.getMessages(filters);\n  }, []);\n\n  const saveTemplate = useCallback(async (template: Omit<CommunicationTemplate, 'syncStatus'>) => {\n    await communicationSync.saveTemplate(template);\n    updateSyncStatus();\n  }, [updateSyncStatus]);\n\n  const updateTemplate = useCallback(async (id: string, updates: Partial<CommunicationTemplate>) => {\n    await communicationSync.updateTemplate(id, updates);\n    updateSyncStatus();\n  }, [updateSyncStatus]);\n\n  const deleteTemplate = useCallback(async (id: string) => {\n    await communicationSync.deleteTemplate(id);\n    updateSyncStatus();\n  }, [updateSyncStatus]);\n\n  const getTemplates = useCallback((filters?: {\n    type?: 'sms' | 'email';\n    category?: string;\n    active?: boolean;\n  }) => {\n    return communicationSync.getTemplates(filters);\n  }, []);\n\n  const forcSync = useCallback(async () => {\n    await communicationSync.syncOutbox();\n    await communicationSync.syncFromServer();\n    updateSyncStatus();\n  }, [updateSyncStatus]);\n\n  return {\n    syncStatus,\n    saveMessage,\n    updateMessage,\n    getMessages,\n    saveTemplate,\n    updateTemplate,\n    deleteTemplate,\n    getTemplates,\n    forcSync\n  };\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useConditionalFields.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[449,452],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[449,452],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1262,1265],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1262,1265],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1584,1587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1584,1587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2214,2217],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2214,2217],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2234,2237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2234,2237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'shouldShowSection'. Either include it or remove the dependency array.","line":99,"column":6,"nodeType":"ArrayExpression","endLine":99,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [schema.invoiceTypes, schema.fieldDefinitions, formData.invoiceType, shouldShowSection]","fix":{"range":[3196,3236],"text":"[schema.invoiceTypes, schema.fieldDefinitions, formData.invoiceType, shouldShowSection]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'shouldShowField'. Either include it or remove the dependency array.","line":113,"column":6,"nodeType":"ArrayExpression","endLine":113,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [visibleSections, formData, shouldShowField]","fix":{"range":[3650,3677],"text":"[visibleSections, formData, shouldShowField]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isVisible' is defined but never used.","line":250,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":250,"endColumn":68}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo, useState } from 'react';\nimport { \n  InvoiceFormSchema, \n  InvoiceFormData, \n  InvoiceFieldDefinition, \n  InvoiceFieldSection \n} from '../types/invoice-schema';\n\ninterface ConditionalFieldsHookResult {\n  visibleSections: InvoiceFieldSection[];\n  visibleFields: Record<string, InvoiceFieldDefinition[]>;\n  shouldShowSection: (section: InvoiceFieldSection) => boolean;\n  shouldShowField: (field: InvoiceFieldDefinition, sectionData: any) => boolean;\n  getFieldDependencies: (sectionName: string, fieldId: string) => string[];\n  validateDependencies: (formData: InvoiceFormData) => Record<string, string[]>;\n}\n\nexport const useConditionalFields = (\n  schema: InvoiceFormSchema,\n  formData: InvoiceFormData\n): ConditionalFieldsHookResult => {\n  \n  // Check if a section should be visible based on conditions\n  const shouldShowSection = (section: InvoiceFieldSection): boolean => {\n    if (!section.conditional) return true;\n\n    const { dependsOn, condition, value } = section.conditional;\n    const fieldValue = getNestedValue(formData, dependsOn);\n\n    return evaluateCondition(fieldValue, condition, value);\n  };\n\n  // Check if a field should be visible based on conditions\n  const shouldShowField = (field: InvoiceFieldDefinition, sectionData: any): boolean => {\n    if (!field.conditional) return true;\n\n    const { dependsOn, condition, value } = field.conditional;\n    const fieldValue = sectionData[dependsOn];\n\n    return evaluateCondition(fieldValue, condition, value);\n  };\n\n  // Evaluate condition based on type\n  const evaluateCondition = (\n    fieldValue: any, \n    condition: string, \n    expectedValue: string | number | boolean\n  ): boolean => {\n    switch (condition) {\n      case 'equals':\n        return fieldValue === expectedValue;\n      case 'not_equals':\n        return fieldValue !== expectedValue;\n      case 'contains':\n        return String(fieldValue).includes(String(expectedValue));\n      case 'greater_than':\n        return Number(fieldValue) > Number(expectedValue);\n      case 'less_than':\n        return Number(fieldValue) < Number(expectedValue);\n      default:\n        return true;\n    }\n  };\n\n  // Get nested value from form data\n  const getNestedValue = (data: any, path: string): any => {\n    if (path.includes('.')) {\n      const [section, field] = path.split('.');\n      return data[section]?.[field];\n    }\n    return data[path];\n  };\n\n  // Get visible sections based on invoice type and conditions\n  const visibleSections = useMemo(() => {\n    const invoiceTypeConfig = schema.invoiceTypes[formData.invoiceType];\n    \n    if (!invoiceTypeConfig) return [];\n\n    const sections: InvoiceFieldSection[] = [];\n    \n    // Add required sections\n    invoiceTypeConfig.requiredFields.forEach(sectionKey => {\n      const section = schema.fieldDefinitions[sectionKey];\n      if (section) {\n        sections.push(section);\n      }\n    });\n\n    // Add conditional sections that meet their conditions\n    invoiceTypeConfig.conditionalFields.forEach(sectionKey => {\n      const section = schema.fieldDefinitions[sectionKey];\n      if (section && shouldShowSection(section)) {\n        sections.push(section);\n      }\n    });\n\n    return sections;\n  }, [schema, formData.invoiceType, formData]);\n\n  // Get visible fields for each section\n  const visibleFields = useMemo(() => {\n    const result: Record<string, InvoiceFieldDefinition[]> = {};\n    \n    visibleSections.forEach(section => {\n      const sectionData = formData[section.name] || {};\n      result[section.name] = Object.values(section.fields).filter(field => \n        shouldShowField(field, sectionData)\n      );\n    });\n\n    return result;\n  }, [visibleSections, formData]);\n\n  // Get field dependencies for a specific field\n  const getFieldDependencies = (sectionName: string, fieldId: string): string[] => {\n    const dependencies: string[] = [];\n    \n    // Check section dependencies\n    const section = schema.fieldDefinitions[sectionName];\n    if (section?.conditional) {\n      dependencies.push(section.conditional.dependsOn);\n    }\n\n    // Check field dependencies\n    const field = section?.fields[fieldId];\n    if (field?.conditional) {\n      const depPath = field.conditional.dependsOn;\n      if (depPath.includes('.')) {\n        dependencies.push(depPath);\n      } else {\n        dependencies.push(`${sectionName}.${depPath}`);\n      }\n    }\n\n    return dependencies;\n  };\n\n  // Validate all dependencies and return missing ones\n  const validateDependencies = (data: InvoiceFormData): Record<string, string[]> => {\n    const missingDependencies: Record<string, string[]> = {};\n\n    visibleSections.forEach(section => {\n      const sectionData = data[section.name] || {};\n      \n      Object.values(section.fields).forEach(field => {\n        if (shouldShowField(field, sectionData) && field.conditional) {\n          const { dependsOn } = field.conditional;\n          const depValue = sectionData[dependsOn];\n          \n          if (depValue === undefined || depValue === null || depValue === '') {\n            const fieldKey = `${section.name}.${field.id}`;\n            if (!missingDependencies[fieldKey]) {\n              missingDependencies[fieldKey] = [];\n            }\n            missingDependencies[fieldKey].push(dependsOn);\n          }\n        }\n      });\n    });\n\n    return missingDependencies;\n  };\n\n  return {\n    visibleSections,\n    visibleFields,\n    shouldShowSection,\n    shouldShowField,\n    getFieldDependencies,\n    validateDependencies\n  };\n};\n\n// Hook for managing field visibility state\nexport const useFieldVisibility = (\n  schema: InvoiceFormSchema,\n  formData: InvoiceFormData\n) => {\n  const {\n    visibleSections,\n    visibleFields,\n    shouldShowSection,\n    shouldShowField\n  } = useConditionalFields(schema, formData);\n\n  // Get all visible field paths\n  const visibleFieldPaths = useMemo(() => {\n    const paths: string[] = [];\n    \n    visibleSections.forEach(section => {\n      const fields = visibleFields[section.name] || [];\n      fields.forEach(field => {\n        paths.push(`${section.name}.${field.id}`);\n      });\n    });\n\n    return paths;\n  }, [visibleSections, visibleFields]);\n\n  // Check if a specific field path is visible\n  const isFieldVisible = (sectionName: string, fieldId: string): boolean => {\n    return visibleFieldPaths.includes(`${sectionName}.${fieldId}`);\n  };\n\n  // Get section visibility status\n  const getSectionVisibility = () => {\n    const visibility: Record<string, boolean> = {};\n    \n    Object.keys(schema.fieldDefinitions).forEach(sectionKey => {\n      const section = schema.fieldDefinitions[sectionKey];\n      visibility[sectionKey] = shouldShowSection(section);\n    });\n\n    return visibility;\n  };\n\n  // Get field visibility status for a section\n  const getFieldVisibility = (sectionName: string) => {\n    const section = schema.fieldDefinitions[sectionName];\n    if (!section) return {};\n\n    const sectionData = formData[sectionName] || {};\n    const visibility: Record<string, boolean> = {};\n\n    Object.values(section.fields).forEach(field => {\n      visibility[field.id] = shouldShowField(field, sectionData);\n    });\n\n    return visibility;\n  };\n\n  return {\n    visibleSections,\n    visibleFields,\n    visibleFieldPaths,\n    isFieldVisible,\n    getSectionVisibility,\n    getFieldVisibility\n  };\n};\n\n// Hook for managing conditional field animations\nexport const useFieldAnimations = (\n  visibleFieldPaths: string[],\n  animationDuration: number = 300\n) => {\n  const [animatingFields, setAnimatingFields] = useState<Set<string>>(new Set());\n\n  const animateFieldChange = (fieldPath: string, isVisible: boolean) => {\n    setAnimatingFields((prev: Set<string>) => new Set(prev).add(fieldPath));\n    \n    setTimeout(() => {\n      setAnimatingFields((prev: Set<string>) => {\n        const newSet = new Set(prev);\n        newSet.delete(fieldPath);\n        return newSet;\n      });\n    }, animationDuration);\n  };\n\n  const isFieldAnimating = (fieldPath: string): boolean => {\n    return animatingFields.has(fieldPath);\n  };\n\n  return {\n    animateFieldChange,\n    isFieldAnimating\n  };\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useDashboardData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useErrorHandler.ts","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'axios' import is restricted from being used. Use generated API client from @x-ear/core instead of direct axios calls.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"pathWithCustomMessage","endLine":2,"endColumn":36},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[183,186],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[183,186],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback } from 'react';\nimport { AxiosError } from 'axios';\n\nexport interface AppError {\n  message: string;\n  code?: string;\n  statusCode?: number;\n  details?: any;\n  timestamp: Date;\n}\n\nexport const useErrorHandler = () => {\n  const [error, setError] = useState<AppError | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleError = useCallback((error: unknown) => {\n    console.error('Error caught by useErrorHandler:', error);\n\n    let appError: AppError;\n\n    if (error instanceof AxiosError) {\n      // API errors\n      appError = {\n        message: error.response?.data?.message || error.message || 'Bir API hatası oluştu',\n        code: error.code,\n        statusCode: error.response?.status,\n        details: error.response?.data,\n        timestamp: new Date()\n      };\n    } else if (error instanceof Error) {\n      // JavaScript errors\n      appError = {\n        message: error.message || 'Beklenmeyen bir hata oluştu',\n        details: error.stack,\n        timestamp: new Date()\n      };\n    } else if (typeof error === 'string') {\n      // String errors\n      appError = {\n        message: error,\n        timestamp: new Date()\n      };\n    } else {\n      // Unknown errors\n      appError = {\n        message: 'Bilinmeyen bir hata oluştu',\n        details: error,\n        timestamp: new Date()\n      };\n    }\n\n    setError(appError);\n  }, []);\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const withErrorHandling = useCallback(\n    async <T>(asyncFn: () => Promise<T>): Promise<T | null> => {\n      try {\n        setIsLoading(true);\n        setError(null);\n        const result = await asyncFn();\n        return result;\n      } catch (err) {\n        handleError(err);\n        return null;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [handleError]\n  );\n\n  const retry = useCallback(\n    async <T>(asyncFn: () => Promise<T>): Promise<T | null> => {\n      clearError();\n      return withErrorHandling(asyncFn);\n    },\n    [clearError, withErrorHandling]\n  );\n\n  return {\n    error,\n    isLoading,\n    handleError,\n    clearError,\n    withErrorHandling,\n    retry\n  };\n};\n\n// Utility functions for common error scenarios\nexport const getErrorMessage = (error: unknown): string => {\n  if (error instanceof AxiosError) {\n    return error.response?.data?.message || error.message || 'API hatası oluştu';\n  }\n  \n  if (error instanceof Error) {\n    return error.message;\n  }\n  \n  if (typeof error === 'string') {\n    return error;\n  }\n  \n  return 'Bilinmeyen bir hata oluştu';\n};\n\nexport const isNetworkError = (error: unknown): boolean => {\n  if (error instanceof AxiosError) {\n    return !error.response || error.code === 'NETWORK_ERROR';\n  }\n  return false;\n};\n\nexport const isUnauthorizedError = (error: unknown): boolean => {\n  if (error instanceof AxiosError) {\n    return error.response?.status === 401;\n  }\n  return false;\n};\n\nexport const isForbiddenError = (error: unknown): boolean => {\n  if (error instanceof AxiosError) {\n    return error.response?.status === 403;\n  }\n  return false;\n};\n\nexport const isNotFoundError = (error: unknown): boolean => {\n  if (error instanceof AxiosError) {\n    return error.response?.status === 404;\n  }\n  return false;\n};\n\nexport const isValidationError = (error: unknown): boolean => {\n  if (error instanceof AxiosError) {\n    return error.response?.status === 422 || error.response?.status === 400;\n  }\n  return false;\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useInvoiceValidation.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[732,735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[732,735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateOnChange' is assigned a value but never used.","line":29,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateOnBlur' is assigned a value but never used.","line":30,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'debounceMs' is assigned a value but never used.","line":31,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2122,2125],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2122,2125],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":136,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3910,3913],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3910,3913],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":174,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4874,4877],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4874,4877],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useMemo } from 'react';\nimport { InvoiceFormData, InvoiceValidation } from '../types/invoice';\nimport { InvoiceValidationService, ValidationContext } from '../services/InvoiceValidationService';\n\nexport interface UseInvoiceValidationOptions {\n  validateOnChange?: boolean;\n  validateOnBlur?: boolean;\n  debounceMs?: number;\n  skipOptionalFields?: boolean;\n}\n\nexport interface UseInvoiceValidationReturn {\n  validation: InvoiceValidation;\n  fieldErrors: Record<string, string>;\n  fieldWarnings: Record<string, string>;\n  isValidating: boolean;\n  validateForm: (formData: InvoiceFormData, context?: Partial<ValidationContext>) => Promise<InvoiceValidation>;\n  validateField: (fieldName: string, value: any, formData: InvoiceFormData) => Promise<string | null>;\n  clearFieldError: (fieldName: string) => void;\n  clearAllErrors: () => void;\n  hasErrors: boolean;\n  hasWarnings: boolean;\n}\n\nexport function useInvoiceValidation(\n  options: UseInvoiceValidationOptions = {}\n): UseInvoiceValidationReturn {\n  const {\n    validateOnChange = true,\n    validateOnBlur = true,\n    debounceMs = 300,\n    skipOptionalFields = false\n  } = options;\n\n  const [validation, setValidation] = useState<InvoiceValidation>({\n    isValid: true,\n    errors: {},\n    warnings: {}\n  });\n  \n  const [isValidating, setIsValidating] = useState(false);\n  const validationService = useMemo(() => InvoiceValidationService.getInstance(), []);\n\n  const validateForm = useCallback(async (\n    formData: InvoiceFormData,\n    context: Partial<ValidationContext> = {}\n  ): Promise<InvoiceValidation> => {\n    setIsValidating(true);\n    \n    try {\n      const validationContext: ValidationContext = {\n        formData,\n        isSubmitting: false,\n        isDraft: false,\n        skipOptionalFields,\n        ...context\n      };\n\n      const result = validationService.validateForm(validationContext);\n      setValidation(result);\n      return result;\n    } finally {\n      setIsValidating(false);\n    }\n  }, [validationService, skipOptionalFields]);\n\n  const validateField = useCallback(async (\n    fieldName: string,\n    value: any,\n    formData: InvoiceFormData\n  ): Promise<string | null> => {\n    const error = validationService.validateField(fieldName, value, formData);\n    \n    setValidation(prev => ({\n      ...prev,\n      errors: {\n        ...prev.errors,\n        [fieldName]: error || ''\n      }\n    }));\n\n    return error;\n  }, [validationService]);\n\n  const clearFieldError = useCallback((fieldName: string) => {\n    setValidation(prev => {\n      const newErrors = { ...prev.errors };\n      delete newErrors[fieldName];\n      \n      return {\n        ...prev,\n        errors: newErrors,\n        isValid: Object.keys(newErrors).length === 0\n      };\n    });\n  }, []);\n\n  const clearAllErrors = useCallback(() => {\n    setValidation({\n      isValid: true,\n      errors: {},\n      warnings: {}\n    });\n  }, []);\n\n  const fieldErrors = useMemo(() => validation.errors, [validation.errors]);\n  const fieldWarnings = useMemo(() => validation.warnings, [validation.warnings]);\n  const hasErrors = useMemo(() => Object.keys(validation.errors).length > 0, [validation.errors]);\n  const hasWarnings = useMemo(() => Object.keys(validation.warnings).length > 0, [validation.warnings]);\n\n  return {\n    validation,\n    fieldErrors,\n    fieldWarnings,\n    isValidating,\n    validateForm,\n    validateField,\n    clearFieldError,\n    clearAllErrors,\n    hasErrors,\n    hasWarnings\n  };\n}\n\n// Hook for real-time field validation with debouncing\nexport function useFieldValidation(\n  fieldName: string,\n  formData: InvoiceFormData,\n  debounceMs: number = 300\n) {\n  const [error, setError] = useState<string | null>(null);\n  const [isValidating, setIsValidating] = useState(false);\n  const validationService = useMemo(() => InvoiceValidationService.getInstance(), []);\n\n  const validateField = useCallback(\n    async (value: any) => {\n      setIsValidating(true);\n      \n      // Debounce validation\n      const timeoutId = setTimeout(async () => {\n        try {\n          const result = validationService.validateField(fieldName, value, formData);\n          setError(result);\n        } finally {\n          setIsValidating(false);\n        }\n      }, debounceMs);\n\n      return () => clearTimeout(timeoutId);\n    },\n    [fieldName, formData, validationService, debounceMs]\n  );\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  return {\n    error,\n    isValidating,\n    validateField,\n    clearError\n  };\n}\n\n// Hook for item validation in invoice forms\nexport function useItemValidation() {\n  const [itemErrors, setItemErrors] = useState<Record<string, Record<string, string>>>({});\n  const validationService = useMemo(() => InvoiceValidationService.getInstance(), []);\n\n  const validateItem = useCallback((\n    itemIndex: number,\n    fieldName: string,\n    value: any\n  ): string | null => {\n    const error = validationService.validateItemField(itemIndex, fieldName, value);\n    \n    setItemErrors(prev => ({\n      ...prev,\n      [itemIndex]: {\n        ...prev[itemIndex],\n        [fieldName]: error || ''\n      }\n    }));\n\n    return error;\n  }, [validationService]);\n\n  const clearItemError = useCallback((itemIndex: number, fieldName?: string) => {\n    setItemErrors(prev => {\n      const newErrors = { ...prev };\n      \n      if (fieldName) {\n        if (newErrors[itemIndex]) {\n          delete newErrors[itemIndex][fieldName];\n          if (Object.keys(newErrors[itemIndex]).length === 0) {\n            delete newErrors[itemIndex];\n          }\n        }\n      } else {\n        delete newErrors[itemIndex];\n      }\n      \n      return newErrors;\n    });\n  }, []);\n\n  const clearAllItemErrors = useCallback(() => {\n    setItemErrors({});\n  }, []);\n\n  const getItemError = useCallback((itemIndex: number, fieldName: string): string | null => {\n    return itemErrors[itemIndex]?.[fieldName] || null;\n  }, [itemErrors]);\n\n  const hasItemErrors = useCallback((itemIndex?: number): boolean => {\n    if (itemIndex !== undefined) {\n      return !!itemErrors[itemIndex] && Object.keys(itemErrors[itemIndex]).length > 0;\n    }\n    return Object.keys(itemErrors).length > 0;\n  }, [itemErrors]);\n\n  return {\n    itemErrors,\n    validateItem,\n    clearItemError,\n    clearAllItemErrors,\n    getItemError,\n    hasItemErrors\n  };\n}\n\nexport default useInvoiceValidation;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useInvoices.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'initialFilters' and 'loadInvoices'. Either include them or remove the dependency array.","line":38,"column":6,"nodeType":"ArrayExpression","endLine":38,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [initialFilters, loadInvoices]","fix":{"range":[1215,1217],"text":"[initialFilters, loadInvoices]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { \n  Invoice, \n  InvoiceFilters, \n  InvoiceSearchResult,\n  CreateInvoiceData,\n  UpdateInvoiceData\n} from '../types/invoice';\nimport { invoiceService } from '../services/invoice.service';\n\nexport interface UseInvoices {\n  // Data\n  invoices: Invoice[];\n  currentInvoice: Invoice | null;\n  loading: boolean;\n  error: string | null;\n  \n  // Actions\n  createInvoice: (data: CreateInvoiceData) => Promise<Invoice | null>;\n  updateInvoice: (id: string, updates: UpdateInvoiceData) => Promise<Invoice | null>;\n  deleteInvoice: (id: string) => Promise<boolean>;\n  loadInvoice: (id: string) => Promise<Invoice | null>;\n  searchInvoices: (filters: InvoiceFilters) => Promise<InvoiceSearchResult>;\n  \n  // Utility\n  refreshInvoices: () => Promise<void>;\n}\n\nexport function useInvoices(initialFilters?: InvoiceFilters): UseInvoices {\n  const [invoices, setInvoices] = useState<Invoice[]>([]);\n  const [currentInvoice, setCurrentInvoice] = useState<Invoice | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load initial data\n  useEffect(() => {\n    loadInvoices(initialFilters);\n  }, []);\n\n  // Listen for invoice updates\n  useEffect(() => {\n    const handleInvoiceUpdated = (event: CustomEvent) => {\n      const { invoice } = event.detail;\n      setInvoices(prev => prev.map(i => i.id === invoice.id ? invoice : i));\n      \n      if (currentInvoice && currentInvoice.id === invoice.id) {\n        setCurrentInvoice(invoice);\n      }\n    };\n\n    const handleInvoiceCreated = (event: CustomEvent) => {\n      const { invoice } = event.detail;\n      setInvoices(prev => [...prev, invoice]);\n    };\n\n    const handleInvoiceDeleted = (event: CustomEvent) => {\n      const { invoice } = event.detail;\n      setInvoices(prev => prev.filter(i => i.id !== invoice.id));\n      \n      if (currentInvoice && currentInvoice.id === invoice.id) {\n        setCurrentInvoice(null);\n      }\n    };\n\n    window.addEventListener('invoice:updated', handleInvoiceUpdated as EventListener);\n    window.addEventListener('invoice:created', handleInvoiceCreated as EventListener);\n    window.addEventListener('invoice:deleted', handleInvoiceDeleted as EventListener);\n\n    return () => {\n      window.removeEventListener('invoice:updated', handleInvoiceUpdated as EventListener);\n      window.removeEventListener('invoice:created', handleInvoiceCreated as EventListener);\n      window.removeEventListener('invoice:deleted', handleInvoiceDeleted as EventListener);\n    };\n  }, [currentInvoice]);\n\n  const loadInvoices = useCallback(async (filters?: InvoiceFilters) => {\n    try {\n      setLoading(true);\n      setError(null);\n      const result = await invoiceService.getInvoices(filters);\n      setInvoices(result.invoices);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load invoices');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const createInvoice = useCallback(async (data: CreateInvoiceData): Promise<Invoice | null> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const invoice = await invoiceService.createInvoice(data);\n      return invoice;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to create invoice');\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const updateInvoice = useCallback(async (id: string, updates: UpdateInvoiceData): Promise<Invoice | null> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const invoice = await invoiceService.updateInvoice(id, updates);\n      return invoice;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to update invoice');\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const deleteInvoice = useCallback(async (id: string): Promise<boolean> => {\n    try {\n      setLoading(true);\n      setError(null);\n      await invoiceService.deleteInvoice(id);\n      return true;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to delete invoice');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const loadInvoice = useCallback(async (id: string): Promise<Invoice | null> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const invoice = await invoiceService.getInvoice(id);\n      setCurrentInvoice(invoice);\n      return invoice;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load invoice');\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const searchInvoices = useCallback(async (filters: InvoiceFilters): Promise<InvoiceSearchResult> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const result = await invoiceService.getInvoices(filters);\n      setInvoices(result.invoices);\n      return result;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to search invoices');\n      return {\n        invoices: [],\n        total: 0,\n        page: 1,\n        pageSize: 0,\n        totalPages: 0,\n        hasMore: false,\n        filters: filters || {}\n      };\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const refreshInvoices = useCallback(async () => {\n    await loadInvoices();\n  }, [loadInvoices]);\n\n  return {\n    // Data\n    invoices,\n    currentInvoice,\n    loading,\n    error,\n    \n    // Actions\n    createInvoice,\n    updateInvoice,\n    deleteInvoice,\n    loadInvoice,\n    searchInvoices,\n    refreshInvoices\n  };\n}\n\n// Specialized hook for single invoice\nexport function useInvoice(id: string | null) {\n  const [invoice, setInvoice] = useState<Invoice | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!id) {\n      setInvoice(null);\n      return;\n    }\n\n    const loadInvoice = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        const invoiceData = await invoiceService.getInvoice(id);\n        setInvoice(invoiceData);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load invoice');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadInvoice();\n  }, [id]);\n\n  // Listen for updates to this specific invoice\n  useEffect(() => {\n    if (!id) return;\n\n    const handleInvoiceUpdated = (event: CustomEvent) => {\n      const { invoice: updatedInvoice } = event.detail;\n      if (updatedInvoice.id === id) {\n        setInvoice(updatedInvoice);\n      }\n    };\n\n    const handleInvoiceDeleted = (event: CustomEvent) => {\n      const { invoice: deletedInvoice } = event.detail;\n      if (deletedInvoice.id === id) {\n        setInvoice(null);\n      }\n    };\n\n    window.addEventListener('invoice:updated', handleInvoiceUpdated as EventListener);\n    window.addEventListener('invoice:deleted', handleInvoiceDeleted as EventListener);\n\n    return () => {\n      window.removeEventListener('invoice:updated', handleInvoiceUpdated as EventListener);\n      window.removeEventListener('invoice:deleted', handleInvoiceDeleted as EventListener);\n    };\n  }, [id]);\n\n  return { invoice, loading, error };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useOutbox.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/usePWA.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1090,1093],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1090,1093],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":252,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":252,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7312,7315],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7312,7315],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\n\ninterface BeforeInstallPromptEvent extends Event {\n  readonly platforms: string[];\n  readonly userChoice: Promise<{\n    outcome: 'accepted' | 'dismissed';\n    platform: string;\n  }>;\n  prompt(): Promise<void>;\n}\n\ninterface PWAState {\n  isInstallable: boolean;\n  isInstalled: boolean;\n  isOnline: boolean;\n  isUpdateAvailable: boolean;\n  installPrompt: BeforeInstallPromptEvent | null;\n}\n\ninterface PWAActions {\n  installApp: () => Promise<void>;\n  updateApp: () => Promise<void>;\n  checkForUpdates: () => Promise<void>;\n}\n\nexport const usePWA = (): PWAState & PWAActions => {\n  const [state, setState] = useState<PWAState>({\n    isInstallable: false,\n    isInstalled: false,\n    isOnline: navigator.onLine,\n    isUpdateAvailable: false,\n    installPrompt: null,\n  });\n\n  // Check if app is installed\n  const checkInstallStatus = useCallback(() => {\n    const isInstalled = \n      window.matchMedia('(display-mode: standalone)').matches ||\n      window.matchMedia('(display-mode: fullscreen)').matches ||\n      (window.navigator as any).standalone === true;\n    \n    setState(prev => ({ ...prev, isInstalled }));\n  }, []);\n\n  // Handle install prompt\n  const handleBeforeInstallPrompt = useCallback((e: BeforeInstallPromptEvent) => {\n    e.preventDefault();\n    setState(prev => ({\n      ...prev,\n      isInstallable: true,\n      installPrompt: e,\n    }));\n  }, []);\n\n  // Handle app installed\n  const handleAppInstalled = useCallback(() => {\n    setState(prev => ({\n      ...prev,\n      isInstallable: false,\n      isInstalled: true,\n      installPrompt: null,\n    }));\n  }, []);\n\n  // Handle online/offline status\n  const handleOnline = useCallback(() => {\n    setState(prev => ({ ...prev, isOnline: true }));\n  }, []);\n\n  const handleOffline = useCallback(() => {\n    setState(prev => ({ ...prev, isOnline: false }));\n  }, []);\n\n  // Install app\n  const installApp = useCallback(async () => {\n    if (!state.installPrompt) {\n      throw new Error('Install prompt not available');\n    }\n\n    try {\n      await state.installPrompt.prompt();\n      const { outcome } = await state.installPrompt.userChoice;\n      \n      if (outcome === 'accepted') {\n        setState(prev => ({\n          ...prev,\n          isInstallable: false,\n          installPrompt: null,\n        }));\n      }\n    } catch (error) {\n      console.error('Failed to install app:', error);\n      throw error;\n    }\n  }, [state.installPrompt]);\n\n  // Update app\n  const updateApp = useCallback(async () => {\n    if ('serviceWorker' in navigator) {\n      try {\n        const registration = await navigator.serviceWorker.getRegistration();\n        if (registration && registration.waiting) {\n          registration.waiting.postMessage({ type: 'SKIP_WAITING' });\n          window.location.reload();\n        }\n      } catch (error) {\n        console.error('Failed to update app:', error);\n        throw error;\n      }\n    }\n  }, []);\n\n  // Check for updates\n  const checkForUpdates = useCallback(async () => {\n    if ('serviceWorker' in navigator) {\n      try {\n        const registration = await navigator.serviceWorker.getRegistration();\n        if (registration) {\n          await registration.update();\n        }\n      } catch (error) {\n        console.error('Failed to check for updates:', error);\n        throw error;\n      }\n    }\n  }, []);\n\n  // Register service worker and set up event listeners\n  useEffect(() => {\n    // Register service worker\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register('/sw.js')\n        .then((registration) => {\n          console.log('Service Worker registered:', registration);\n          \n          // Check for updates\n          registration.addEventListener('updatefound', () => {\n            const newWorker = registration.installing;\n            if (newWorker) {\n              newWorker.addEventListener('statechange', () => {\n                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n                  setState(prev => ({ ...prev, isUpdateAvailable: true }));\n                }\n              });\n            }\n          });\n        })\n        .catch((error) => {\n          console.error('Service Worker registration failed:', error);\n        });\n\n      // Listen for service worker messages\n      navigator.serviceWorker.addEventListener('message', (event) => {\n        if (event.data && event.data.type === 'SYNC_STATUS') {\n          // Handle sync status updates\n          console.log('Sync status:', event.data.payload);\n        }\n      });\n    }\n\n    // Set up event listeners\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt as EventListener);\n    window.addEventListener('appinstalled', handleAppInstalled);\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    // Check initial install status\n    checkInstallStatus();\n\n    // Cleanup\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt as EventListener);\n      window.removeEventListener('appinstalled', handleAppInstalled);\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, [handleBeforeInstallPrompt, handleAppInstalled, handleOnline, handleOffline, checkInstallStatus]);\n\n  return {\n    ...state,\n    installApp,\n    updateApp,\n    checkForUpdates,\n  };\n};\n\n// Hook for managing PWA notifications\nexport const usePWANotifications = () => {\n  const [permission, setPermission] = useState<NotificationPermission>('default');\n  const [isSupported, setIsSupported] = useState(false);\n\n  useEffect(() => {\n    setIsSupported('Notification' in window);\n    if ('Notification' in window) {\n      setPermission(Notification.permission);\n    }\n  }, []);\n\n  const requestPermission = useCallback(async (): Promise<NotificationPermission> => {\n    if (!isSupported) {\n      throw new Error('Notifications not supported');\n    }\n\n    const result = await Notification.requestPermission();\n    setPermission(result);\n    return result;\n  }, [isSupported]);\n\n  const showNotification = useCallback(async (\n    title: string,\n    options?: NotificationOptions\n  ): Promise<void> => {\n    if (permission !== 'granted') {\n      throw new Error('Notification permission not granted');\n    }\n\n    if ('serviceWorker' in navigator) {\n      const registration = await navigator.serviceWorker.getRegistration();\n      if (registration) {\n        await registration.showNotification(title, {\n          icon: '/icons/icon-192x192.png',\n          badge: '/icons/icon-72x72.png',\n          ...options,\n        });\n      }\n    } else {\n      new Notification(title, {\n        icon: '/icons/icon-192x192.png',\n        ...options,\n      });\n    }\n  }, [permission]);\n\n  return {\n    isSupported,\n    permission,\n    requestPermission,\n    showNotification,\n  };\n};\n\n// Hook for managing app shortcuts\nexport const usePWAShortcuts = () => {\n  const addShortcut = useCallback(async (shortcut: {\n    name: string;\n    url: string;\n    description?: string;\n  }) => {\n    if ('navigator' in window && 'shortcuts' in navigator) {\n      try {\n        // This is a proposed API, may not be available in all browsers\n        await (navigator as any).shortcuts.add(shortcut);\n      } catch (error) {\n        console.warn('Shortcuts API not available:', error);\n      }\n    }\n  }, []);\n\n  return { addShortcut };\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/usePatient.simple.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[607,610],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[607,610],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1039,1042],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1039,1042],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1128,1131],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1128,1131],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1476,1479],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1476,1479],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Simplified usePatient hook\nimport { useState, useEffect } from 'react';\nimport { Patient } from '../types/patient';\nimport { apiClient } from '../api/client';\n\nexport const usePatient = (patientId?: string) => {\n  const [patient, setPatient] = useState<Patient | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (patientId) {\n      setLoading(true);\n      apiClient.getPatient(patientId)\n        .then(response => {\n          if (response.data?.patient) {\n            setPatient(response.data.patient as any);\n          }\n        })\n        .catch(err => setError(err.message))\n        .finally(() => setLoading(false));\n    }\n  }, [patientId]);\n\n  const updatePatient = async (updates: Partial<Patient>) => {\n    if (!patientId) return null;\n    \n    try {\n      setLoading(true);\n      const response = await apiClient.updatePatient(patientId, updates);\n      if (response.data?.patient) {\n        setPatient(response.data.patient as any);\n        return response.data.patient;\n      }\n      return null;\n    } catch (err: any) {\n      setError(err.message);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const deletePatient = async () => {\n    if (!patientId) return false;\n    \n    try {\n      setLoading(true);\n      const response = await apiClient.deletePatient(patientId);\n      return response.data?.success || false;\n    } catch (err: any) {\n      setError(err.message);\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return {\n    patient,\n    loading,\n    error,\n    updatePatient,\n    deletePatient,\n    // Mock implementations for compatibility\n    sales: [],\n    timeline: [],\n    sgk: [],\n    appointments: [],\n    hearingTests: [],\n    notes: [],\n    devices: [],\n    refreshPatient: () => Promise.resolve(),\n    createSale: () => Promise.resolve({}),\n    updateSale: () => Promise.resolve({}),\n    getSales: () => Promise.resolve({ data: [], success: true }),\n    getTimeline: () => Promise.resolve({ data: [], success: true }),\n    getSgk: () => Promise.resolve({ data: [], success: true }),\n    getAppointments: () => Promise.resolve({ data: [], success: true }),\n    getHearingTests: () => Promise.resolve({ data: [], success: true }),\n    getNotes: () => Promise.resolve({ data: [], success: true }),\n    createNote: () => Promise.resolve({}),\n    deleteNote: () => Promise.resolve(true),\n    bulkUpload: () => Promise.resolve(true),\n    exportCsv: () => Promise.resolve(true),\n    search: () => Promise.resolve({ data: [], success: true })\n  };\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/usePatient.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mockServices' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'options' is assigned a value but never used.","line":48,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":29},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'patient'. Either exclude it or remove the dependency array.","line":182,"column":6,"nodeType":"ArrayExpression","endLine":182,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[5544,5553],"text":"[]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has an unnecessary dependency: 'patient'. Either exclude it or remove the dependency array.","line":196,"column":6,"nodeType":"ArrayExpression","endLine":196,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[6022,6031],"text":"[]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'noteId' is defined but never used.","line":199,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":199,"endColumn":55}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { Patient, PatientDevice, PatientNote, PatientCommunication } from '../types/patient';\nimport { mockServices } from '../api/mock-services';\n\nexport interface UsePatientOptions {\n  enableRealTimeSync?: boolean;\n  cacheEnabled?: boolean;\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n}\n\nexport interface UsePatientReturn {\n  // Core state\n  patient: Patient | null;\n  isLoading: boolean;\n  isSaving: boolean;\n  isSyncing: boolean;\n  error: string | null;\n\n  // Core operations\n  updatePatient: (updates: Partial<Patient>) => Promise<Patient>;\n  deletePatient: () => Promise<void>;\n\n  // Device operations\n  addDevice: (device: Omit<PatientDevice, 'id'>) => Promise<PatientDevice>;\n  updateDevice: (deviceId: string, updates: Partial<PatientDevice>) => Promise<PatientDevice>;\n  removeDevice: (deviceId: string) => Promise<void>;\n\n  // Note operations\n  addNote: (noteText: string, type?: PatientNote['type']) => Promise<PatientNote>;\n  updateNote: (noteId: string, updates: Partial<PatientNote>) => Promise<PatientNote>;\n  removeNote: (noteId: string) => Promise<void>;\n\n  // Communication operations\n  addCommunication: (communication: Omit<PatientCommunication, 'id'>) => Promise<PatientCommunication>;\n\n  // Utility operations\n  refreshPatient: () => Promise<void>;\n  syncPatient: () => Promise<void>;\n\n  // Validation and scoring\n  validatePatient: (patientData?: Partial<Patient>) => { isValid: boolean; errors: string[] };\n  calculatePriorityScore: () => number;\n}\n\nexport const usePatient = (\n  patientId: string | null,\n  options: UsePatientOptions = {}\n): UsePatientReturn => {\n  const [patient, setPatient] = useState<Patient | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [isSyncing, setIsSyncing] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load patient data\n  useEffect(() => {\n    if (!patientId) {\n      setPatient(null);\n      return;\n    }\n\n    const loadPatient = async () => {\n      setIsLoading(true);\n      setError(null);\n      \n      try {\n        const mockPatient: Patient = {\n          id: patientId,\n          email: 'mock@example.com',\n          phone: '555-0123',\n          birthDate: '1990-01-01',\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n          tcNumber: '12345678901',\n          firstName: 'Mock',\n          lastName: 'Patient',\n          devices: []\n        };\n        setPatient(mockPatient);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load patient');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadPatient();\n  }, [patientId]);\n\n  // Update patient\n  const updatePatient = useCallback(async (updates: Partial<Patient>): Promise<Patient> => {\n    if (!patient) throw new Error('No patient loaded');\n    \n    setIsSaving(true);\n    setError(null);\n    \n    try {\n      const updatedPatient = { ...patient, ...updates };\n      setPatient(updatedPatient);\n      return updatedPatient;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to update patient');\n      throw err;\n    } finally {\n      setIsSaving(false);\n    }\n  }, [patient]);\n\n  // Delete patient\n  const deletePatient = useCallback(async (): Promise<void> => {\n    if (!patient) throw new Error('No patient loaded');\n    \n    setIsSaving(true);\n    setError(null);\n    \n    try {\n      setPatient(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to delete patient');\n      throw err;\n    } finally {\n      setIsSaving(false);\n    }\n  }, [patient]);\n\n  // Add device\n  const addDevice = useCallback(async (device: Omit<PatientDevice, 'id'>): Promise<PatientDevice> => {\n    if (!patient) throw new Error('No patient loaded');\n    \n    const newDevice: PatientDevice = {\n      ...device,\n      id: Date.now().toString()\n    };\n    \n    const updatedPatient = {\n      ...patient,\n      devices: [...(patient.devices || []), newDevice]\n    };\n    \n    setPatient(updatedPatient);\n    return newDevice;\n  }, [patient]);\n\n  // Update device\n  const updateDevice = useCallback(async (deviceId: string, updates: Partial<PatientDevice>): Promise<PatientDevice> => {\n    if (!patient) throw new Error('No patient loaded');\n    \n    const devices = patient.devices || [];\n    const deviceIndex = devices.findIndex(d => d.id === deviceId);\n    \n    if (deviceIndex === -1) throw new Error('Device not found');\n    \n    const updatedDevice = { ...devices[deviceIndex], ...updates };\n    const updatedDevices = [...devices];\n    updatedDevices[deviceIndex] = updatedDevice;\n    \n    setPatient({ ...patient, devices: updatedDevices });\n    return updatedDevice;\n  }, [patient]);\n\n  // Remove device\n  const removeDevice = useCallback(async (deviceId: string): Promise<void> => {\n    if (!patient) throw new Error('No patient loaded');\n    \n    const updatedDevices = (patient.devices || []).filter(d => d.id !== deviceId);\n    setPatient({ ...patient, devices: updatedDevices });\n  }, [patient]);\n\n  // Add note\n  const addNote = useCallback(async (noteText: string, type: PatientNote['type'] = 'general'): Promise<PatientNote> => {\n    const newNote: PatientNote = {\n      id: Date.now().toString(),\n      text: noteText,\n      date: new Date().toISOString(),\n      author: 'Current User',\n      type,\n      createdAt: new Date().toISOString()\n    };\n    \n    return newNote;\n  }, [patient]);\n\n  // Update note\n  const updateNote = useCallback(async (noteId: string, updates: Partial<PatientNote>): Promise<PatientNote> => {\n    const updatedNote: PatientNote = {\n      id: noteId,\n      text: updates.text || '',\n      date: updates.date || new Date().toISOString(),\n      author: updates.author || 'Current User',\n      type: updates.type || 'general',\n      createdAt: updates.createdAt || new Date().toISOString()\n    };\n    \n    return updatedNote;\n  }, [patient]);\n\n  // Remove note\n  const removeNote = useCallback(async (noteId: string): Promise<void> => {\n    // Mock implementation\n  }, []);\n\n  // Add communication\n  const addCommunication = useCallback(async (communication: Omit<PatientCommunication, 'id'>): Promise<PatientCommunication> => {\n    const newCommunication: PatientCommunication = {\n      ...communication,\n      id: Date.now().toString()\n    };\n    \n    return newCommunication;\n  }, []);\n\n  // Refresh patient\n  const refreshPatient = useCallback(async (): Promise<void> => {\n    if (!patientId) return;\n    \n    setIsLoading(true);\n    try {\n      // Mock refresh\n      await new Promise(resolve => setTimeout(resolve, 500));\n    } finally {\n      setIsLoading(false);\n    }\n  }, [patientId]);\n\n  // Sync patient\n  const syncPatient = useCallback(async (): Promise<void> => {\n    setIsSyncing(true);\n    try {\n      // Mock sync\n      await new Promise(resolve => setTimeout(resolve, 1000));\n    } finally {\n      setIsSyncing(false);\n    }\n  }, []);\n\n  // Validate patient\n  const validatePatient = useCallback((patientData?: Partial<Patient>) => {\n    const data = patientData || patient;\n    const errors: string[] = [];\n    \n    if (!data?.firstName) errors.push('First name is required');\n    if (!data?.lastName) errors.push('Last name is required');\n    if (!data?.email) errors.push('Email is required');\n    \n    return {\n      isValid: errors.length === 0,\n      errors\n    };\n  }, [patient]);\n\n  // Calculate priority score\n  const calculatePriorityScore = useCallback((): number => {\n    if (!patient) return 0;\n    \n    let score = 0;\n    // Use priorityScore if available, otherwise calculate based on other factors\n    if (patient.priorityScore) {\n      score = patient.priorityScore;\n    } else {\n      // Calculate based on status or other available properties\n      if (patient.status === 'LEAD') score += 1;\n      else if (patient.status === 'TRIAL') score += 2;\n      else if (patient.status === 'CUSTOMER') score += 3;\n    }\n    \n    return score;\n  }, [patient]);\n\n  return {\n    patient,\n    isLoading,\n    isSaving,\n    isSyncing,\n    error,\n    updatePatient,\n    deletePatient,\n    addDevice,\n    updateDevice,\n    removeDevice,\n    addNote,\n    updateNote,\n    removeNote,\n    addCommunication,\n    refreshPatient,\n    syncPatient,\n    validatePatient,\n    calculatePriorityScore\n  };\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/usePatientOfflineSync.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'refreshPatients' and 'updateSyncStatus'. Either include them or remove the dependency array.","line":71,"column":6,"nodeType":"ArrayExpression","endLine":71,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [refreshPatients, updateSyncStatus]","fix":{"range":[2059,2061],"text":"[refreshPatients, updateSyncStatus]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'refreshPatients' and 'updateSyncStatus'. Either include them or remove the dependency array.","line":87,"column":6,"nodeType":"ArrayExpression","endLine":87,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [isInitialized, refreshPatients, updateSyncStatus]","fix":{"range":[2391,2406],"text":"[isInitialized, refreshPatients, updateSyncStatus]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * React Hook for Patient Offline Sync\n * Provides reactive interface to patient offline sync operations\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { Patient } from '../types/patient';\nimport { patientOfflineSync } from '../services/offline/patientOfflineSync';\n\ninterface SyncStatus {\n  isOnline: boolean;\n  isSyncing: boolean;\n  lastSync: string | null;\n  pendingOperations: number;\n  totalPatients: number;\n}\n\ninterface UsePatientOfflineSyncReturn {\n  // Data\n  patients: Patient[];\n  syncStatus: SyncStatus;\n  \n  // Operations\n  savePatient: (patient: Omit<Patient, 'id'> & { id?: string }) => Promise<Patient>;\n  updatePatient: (id: string, updates: Partial<Patient>) => Promise<void>;\n  deletePatient: (id: string) => Promise<void>;\n  getPatient: (id: string) => Promise<Patient | null>;\n  searchPatients: (query: string) => Promise<Patient[]>;\n  \n  // Sync operations\n  syncWithServer: () => Promise<void>;\n  refreshPatients: () => Promise<void>;\n  \n  // Status\n  isInitialized: boolean;\n  error: string | null;\n}\n\nexport const usePatientOfflineSync = (): UsePatientOfflineSyncReturn => {\n  const [patients, setPatients] = useState<Patient[]>([]);\n  const [syncStatus, setSyncStatus] = useState<SyncStatus>({\n    isOnline: navigator.onLine,\n    isSyncing: false,\n    lastSync: null,\n    pendingOperations: 0,\n    totalPatients: 0\n  });\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Initialize the sync service\n  useEffect(() => {\n    const initialize = async () => {\n      try {\n        await patientOfflineSync.initialize();\n        setIsInitialized(true);\n        await refreshPatients();\n        await updateSyncStatus();\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to initialize offline sync');\n        console.error('Failed to initialize patient offline sync:', err);\n      }\n    };\n\n    initialize();\n\n    // Cleanup on unmount\n    return () => {\n      patientOfflineSync.destroy();\n    };\n  }, []);\n\n  // Setup sync status listener\n  useEffect(() => {\n    if (!isInitialized) return;\n\n    const handleSyncUpdate = () => {\n      updateSyncStatus();\n      refreshPatients();\n    };\n\n    patientOfflineSync.addListener(handleSyncUpdate);\n\n    return () => {\n      patientOfflineSync.removeListener(handleSyncUpdate);\n    };\n  }, [isInitialized]);\n\n  // Update sync status\n  const updateSyncStatus = useCallback(async () => {\n    try {\n      const status = await patientOfflineSync.getSyncStatus();\n      setSyncStatus(status);\n    } catch (err) {\n      console.error('Failed to get sync status:', err);\n    }\n  }, []);\n\n  // Refresh patients from local database\n  const refreshPatients = useCallback(async () => {\n    try {\n      const allPatients = await patientOfflineSync.getAllPatients();\n      setPatients(allPatients);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to refresh patients');\n      console.error('Failed to refresh patients:', err);\n    }\n  }, []);\n\n  // Patient operations\n  const savePatient = useCallback(async (patient: Omit<Patient, 'id'> & { id?: string }): Promise<Patient> => {\n    try {\n      setError(null);\n      const savedPatient = await patientOfflineSync.savePatient(patient);\n      await refreshPatients();\n      await updateSyncStatus();\n      return savedPatient;\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to save patient';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    }\n  }, [refreshPatients, updateSyncStatus]);\n\n  const updatePatient = useCallback(async (id: string, updates: Partial<Patient>): Promise<void> => {\n    try {\n      setError(null);\n      await patientOfflineSync.updatePatient(id, updates);\n      await refreshPatients();\n      await updateSyncStatus();\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to update patient';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    }\n  }, [refreshPatients, updateSyncStatus]);\n\n  const deletePatient = useCallback(async (id: string): Promise<void> => {\n    try {\n      setError(null);\n      await patientOfflineSync.deletePatient(id);\n      await refreshPatients();\n      await updateSyncStatus();\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to delete patient';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    }\n  }, [refreshPatients, updateSyncStatus]);\n\n  const getPatient = useCallback(async (id: string): Promise<Patient | null> => {\n    try {\n      setError(null);\n      return await patientOfflineSync.getPatient(id);\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to get patient';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    }\n  }, []);\n\n  const searchPatients = useCallback(async (query: string): Promise<Patient[]> => {\n    try {\n      setError(null);\n      return await patientOfflineSync.searchPatients(query);\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to search patients';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    }\n  }, []);\n\n  // Sync operations\n  const syncWithServer = useCallback(async (): Promise<void> => {\n    try {\n      setError(null);\n      await patientOfflineSync.syncWithServer();\n      await refreshPatients();\n      await updateSyncStatus();\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to sync with server';\n      setError(errorMessage);\n      throw new Error(errorMessage);\n    }\n  }, [refreshPatients, updateSyncStatus]);\n\n  return {\n    // Data\n    patients,\n    syncStatus,\n    \n    // Operations\n    savePatient,\n    updatePatient,\n    deletePatient,\n    getPatient,\n    searchPatients,\n    \n    // Sync operations\n    syncWithServer,\n    refreshPatients,\n    \n    // Status\n    isInitialized,\n    error\n  };\n};\n\nexport default usePatientOfflineSync;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/usePatients.old.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Communication' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'initialFilters', 'loadPatients', and 'loadStats'. Either include them or remove the dependency array.","line":63,"column":6,"nodeType":"ArrayExpression","endLine":63,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [initialFilters, loadPatients, loadStats]","fix":{"range":[2290,2292],"text":"[initialFilters, loadPatients, loadStats]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":281,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9959,9962],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9959,9962],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { \n  Patient, \n  PatientFilters, \n  PatientSearchResult, \n  PatientStats,\n  PatientDevice,\n  PatientNote,\n  PatientCommunication,\n  Communication,\n  PatientMatchCandidate,\n  PatientMatchRequest\n} from '../types/patient';\nimport { patientService } from '../services/patient.service';\n\nexport interface UsePatients {\n  // Data\n  patients: Patient[];\n  currentPatient: Patient | null;\n  stats: PatientStats | null;\n  loading: boolean;\n  error: string | null;\n  \n  // Actions\n  createPatient: (data: Omit<Patient, 'id' | 'createdAt' | 'updatedAt'>) => Promise<Patient | null>;\n  updatePatient: (id: string, updates: Partial<Patient>) => Promise<Patient | null>;\n  deletePatient: (id: string) => Promise<boolean>;\n  loadPatient: (id: string) => Promise<Patient | null>;\n  searchPatients: (filters: PatientFilters) => Promise<PatientSearchResult>;\n  refreshStats: () => Promise<void>;\n  \n  // Device management\n  addDevice: (patientId: string, device: Omit<PatientDevice, 'id'>) => Promise<PatientDevice | null>;\n  updateDevice: (patientId: string, deviceId: string, updates: Partial<PatientDevice>) => Promise<PatientDevice | null>;\n  \n  // Notes management\n  addNote: (patientId: string, text: string, type?: PatientNote['type']) => Promise<PatientNote | null>;\n  \n  // Communication\n  addCommunication: (patientId: string, communication: Omit<PatientCommunication, 'id'>) => Promise<PatientCommunication | null>;\n  // Export\n  exportPatient: (id: string) => Promise<string | null>;\n  \n  // Patient matching\n  findMatches: (request: PatientMatchRequest) => Promise<PatientMatchCandidate[]>;\n  \n  // Utility\n  validateTcNumber: (tcNumber: string, excludeId?: string) => Promise<boolean>;\n  getHighPriorityPatients: () => Promise<Patient[]>;\n}\n\nexport function usePatients(initialFilters?: PatientFilters): UsePatients {\n  const [patients, setPatients] = useState<Patient[]>([]);\n  const [currentPatient, setCurrentPatient] = useState<Patient | null>(null);\n  const [stats, setStats] = useState<PatientStats | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load initial data\n  useEffect(() => {\n    loadPatients(initialFilters);\n    loadStats();\n  }, []);\n\n  // Listen for patient updates\n  useEffect(() => {\n    const handlePatientUpdated = (event: CustomEvent) => {\n      const { patient } = event.detail;\n      setPatients(prev => prev.map(p => p.id === patient.id ? patient : p));\n      \n      if (currentPatient && currentPatient.id === patient.id) {\n        setCurrentPatient(patient);\n      }\n    };\n\n    const handlePatientCreated = (event: CustomEvent) => {\n      const { patient } = event.detail;\n      setPatients(prev => [...prev, patient]);\n    };\n\n    const handlePatientDeleted = (event: CustomEvent) => {\n      const { patient } = event.detail;\n      setPatients(prev => prev.filter(p => p.id !== patient.id));\n      \n      if (currentPatient && currentPatient.id === patient.id) {\n        setCurrentPatient(null);\n      }\n    };\n\n    window.addEventListener('patient:updated', handlePatientUpdated as EventListener);\n    window.addEventListener('patient:created', handlePatientCreated as EventListener);\n    window.addEventListener('patient:deleted', handlePatientDeleted as EventListener);\n\n    return () => {\n      window.removeEventListener('patient:updated', handlePatientUpdated as EventListener);\n      window.removeEventListener('patient:created', handlePatientCreated as EventListener);\n      window.removeEventListener('patient:deleted', handlePatientDeleted as EventListener);\n    };\n  }, [currentPatient]);\n\n  const loadPatients = useCallback(async (filters?: PatientFilters) => {\n    try {\n      setLoading(true);\n      setError(null);\n      const result = await patientService.getPatients(filters);\n      setPatients(result.patients);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load patients');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const loadStats = useCallback(async () => {\n    try {\n      const patientStats = await patientService.getPatientStats();\n      setStats(patientStats);\n    } catch (err) {\n      console.error('Failed to load patient stats:', err);\n    }\n  }, []);\n\n  const createPatient = useCallback(async (data: Omit<Patient, 'id' | 'createdAt' | 'updatedAt'>): Promise<Patient | null> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const patient = await patientService.createPatient(data);\n      await loadStats(); // Refresh stats\n      return patient;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to create patient');\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, [loadStats]);\n\n  const updatePatient = useCallback(async (id: string, updates: Partial<Patient>): Promise<Patient | null> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const patient = await patientService.updatePatient(id, updates);\n      await loadStats(); // Refresh stats\n      return patient;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to update patient');\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, [loadStats]);\n\n  const deletePatient = useCallback(async (id: string): Promise<boolean> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const success = await patientService.deletePatient(id);\n      if (success) {\n        await loadStats(); // Refresh stats\n      }\n      return success;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to delete patient');\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  }, [loadStats]);\n\n  const loadPatient = useCallback(async (id: string): Promise<Patient | null> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const patient = await patientService.getPatient(id);\n      setCurrentPatient(patient);\n      return patient;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load patient');\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const searchPatients = useCallback(async (filters: PatientFilters): Promise<PatientSearchResult> => {\n    try {\n      setLoading(true);\n      setError(null);\n      const result = await patientService.getPatients(filters);\n      setPatients(result.patients);\n      return result;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to search patients');\n      return {\n        patients: [],\n        total: 0,\n        page: 1,\n        pageSize: 0,\n        hasMore: false\n      };\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const refreshStats = useCallback(async () => {\n    await loadStats();\n  }, [loadStats]);\n\n  const addDevice = useCallback(async (patientId: string, device: Omit<PatientDevice, 'id'>): Promise<PatientDevice | null> => {\n    try {\n      setError(null);\n      const patient = patients.find(p => p.id === patientId);\n      if (!patient) {\n        throw new Error('Patient not found');\n      }\n      const updatedPatient = patientService.addDevice(patient, device);\n      // Update the patient in the list\n      setPatients(prev => prev.map(p => p.id === patientId ? updatedPatient : p));\n      // Return the newly added device\n      const newDevice = updatedPatient.devices?.find(d => !patient.devices?.some(pd => pd.id === d.id));\n      return newDevice || null;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to add device');\n      return null;\n    }\n  }, [patients]);\n\n  const updateDevice = useCallback(async (patientId: string, deviceId: string, updates: Partial<PatientDevice>): Promise<PatientDevice | null> => {\n    try {\n      setError(null);\n      const patient = patients.find(p => p.id === patientId);\n      if (!patient) {\n        throw new Error('Patient not found');\n      }\n      const updatedPatient = patientService.updateDevice(patient, deviceId, updates);\n      // Update the patient in the list\n      setPatients(prev => prev.map(p => p.id === patientId ? updatedPatient : p));\n      // Return the updated device\n      const updatedDevice = updatedPatient.devices?.find(d => d.id === deviceId);\n      return updatedDevice || null;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to update device');\n      return null;\n    }\n  }, [patients]);\n\n  const addNote = useCallback(async (patientId: string, text: string, type?: PatientNote['type']): Promise<PatientNote | null> => {\n    try {\n      setError(null);\n      const patient = patients.find(p => p.id === patientId);\n      if (!patient) {\n        throw new Error('Patient not found');\n      }\n      const noteData: Omit<PatientNote, 'id'> = {\n        text,\n        type: type || 'general',\n        date: new Date().toISOString(),\n        author: 'Current User', // This should come from auth context\n        isPrivate: false\n      };\n      const updatedPatient = patientService.addNote(patient, noteData);\n      // Update the patient in the list\n      setPatients(prev => prev.map(p => p.id === patientId ? updatedPatient : p));\n      // Return the newly added note\n      const newNote = updatedPatient.notes?.find(n => !patient.notes?.some(pn => pn.id === n.id));\n      return newNote || null;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to add note');\n      return null;\n    }\n  }, [patients]);\n\n  const addCommunication = useCallback(async (patientId: string, communication: Omit<PatientCommunication, 'id'>): Promise<PatientCommunication | null> => {\n    try {\n      setError(null);\n      const patient = patients.find(p => p.id === patientId);\n      if (!patient) {\n        throw new Error('Patient not found');\n      }\n      const updatedPatient = patientService.addCommunication(patient, communication as any);\n      // Update the patient in the list\n      setPatients(prev => prev.map(p => p.id === patientId ? updatedPatient : p));\n      // Return the newly added communication\n      const newCommunication = updatedPatient.communications?.find(c => !patient.communications?.some(pc => pc.id === c.id));\n      return newCommunication || null;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to add communication');\n      return null;\n    }\n  }, [patients]);\n\n  const exportPatient = useCallback(async (id: string): Promise<string | null> => {\n    try {\n      setError(null);\n      const patient = await patientService.getPatient(id);\n      if (!patient) return null;\n      return JSON.stringify(patient, null, 2);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to export patient');\n      return null;\n    }\n  }, []);\n\n  const findMatches = useCallback(async (request: PatientMatchRequest): Promise<PatientMatchCandidate[]> => {\n    try {\n      setError(null);\n      return await patientService.findMatches(request);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to find matches');\n      return [];\n    }\n  }, []);\n\n  const validateTcNumber = useCallback(async (tcNumber: string, excludeId?: string): Promise<boolean> => {\n    try {\n      return await patientService.validateTcNumber(tcNumber, excludeId);\n    } catch (err) {\n      console.error('TC number validation failed:', err);\n      return false;\n    }\n  }, []);\n\n  const getHighPriorityPatients = useCallback(async (): Promise<Patient[]> => {\n    try {\n      return await patientService.getHighPriorityPatients();\n    } catch (err) {\n      console.error('Failed to get high priority patients:', err);\n      return [];\n    }\n  }, []);\n\n  return {\n    // Data\n    patients,\n    currentPatient,\n    stats,\n    loading,\n    error,\n    \n    // Actions\n    createPatient,\n    updatePatient,\n    deletePatient,\n    loadPatient,\n    searchPatients,\n    refreshStats,\n    \n    // Device management\n    addDevice,\n    updateDevice,\n    \n    // Notes management\n    addNote,\n    \n    // Communication\n    addCommunication,\n  // Export\n  exportPatient,\n    \n    // Patient matching\n    findMatches,\n    \n    // Utility\n    validateTcNumber,\n    getHighPriorityPatients\n  };\n}\n\n// Specialized hooks for common use cases\nexport function usePatient(id: string | null) {\n  const [patient, setPatient] = useState<Patient | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!id) {\n      setPatient(null);\n      return;\n    }\n\n    const loadPatient = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        const patientData = await patientService.getPatient(id);\n        setPatient(patientData);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load patient');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadPatient();\n  }, [id]);\n\n  // Listen for updates to this specific patient\n  useEffect(() => {\n    if (!id) return;\n\n    const handlePatientUpdated = (event: CustomEvent) => {\n      const { patient: updatedPatient } = event.detail;\n      if (updatedPatient.id === id) {\n        setPatient(updatedPatient);\n      }\n    };\n\n    const handlePatientDeleted = (event: CustomEvent) => {\n      const { patient: deletedPatient } = event.detail;\n      if (deletedPatient.id === id) {\n        setPatient(null);\n      }\n    };\n\n    window.addEventListener('patient:updated', handlePatientUpdated as EventListener);\n    window.addEventListener('patient:deleted', handlePatientDeleted as EventListener);\n\n    return () => {\n      window.removeEventListener('patient:updated', handlePatientUpdated as EventListener);\n      window.removeEventListener('patient:deleted', handlePatientDeleted as EventListener);\n    };\n  }, [id]);\n\n  return { patient, loading, error };\n}\n\nexport function usePatientStats() {\n  const [stats, setStats] = useState<PatientStats | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  const refreshStats = useCallback(async () => {\n    try {\n      setLoading(true);\n      const patientStats = await patientService.getPatientStats();\n      setStats(patientStats);\n    } catch (err) {\n      console.error('Failed to load patient stats:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    refreshStats();\n  }, [refreshStats]);\n\n  // Listen for patient changes to refresh stats\n  useEffect(() => {\n    const handlePatientChange = () => {\n      refreshStats();\n    };\n\n    window.addEventListener('patient:created', handlePatientChange);\n    window.addEventListener('patient:updated', handlePatientChange);\n    window.addEventListener('patient:deleted', handlePatientChange);\n\n    return () => {\n      window.removeEventListener('patient:created', handlePatientChange);\n      window.removeEventListener('patient:updated', handlePatientChange);\n      window.removeEventListener('patient:deleted', handlePatientChange);\n    };\n  }, [refreshStats]);\n\n  return { stats, loading, refreshStats };\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/usePatients.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientFilters' is defined but never used.","line":10,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":45},{"ruleId":"no-extra-semi","severity":2,"message":"Unnecessary semicolon.","line":390,"column":2,"nodeType":"EmptyStatement","messageId":"unexpected","endLine":390,"endColumn":3,"fix":{"range":[12078,12080],"text":"}"}}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"// @ts-nocheck\n/**\n * usePatients Hook\n * @fileoverview Custom hook for managing patient data with caching, search, and real-time updates\n * @version 1.0.0\n */\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { Patient } from '../types/patient';\nimport { PatientSearchResult, PatientFilters } from '../types/patient/patient-search.types';\nimport { patientService } from '../services/patient.service';\nimport { patientSearchService } from '../services/patient/patient-search.service';\nimport { patientCacheService, SimpleCacheFilters } from '../services/patient/patient-cache.service';\nimport { patientValidationService } from '../services/patient/patient-validation.service';\nimport { patientSyncService } from '../services/patient/patient-sync.service';\n\nexport interface UsePatientsOptions {\n  enableRealTimeSync?: boolean;\n  cacheEnabled?: boolean;\n  autoRefresh?: boolean;\n  refreshInterval?: number; // milliseconds\n}\n\nexport interface UsePatientsReturn {\n  // Data\n  patients: Patient[];\n  searchResults: PatientSearchResult | null;\n  totalCount: number;\n  isLoading: boolean;\n  isSearching: boolean;\n  isSyncing: boolean;\n  error: string | null;\n  \n  // Search & Filter\n  searchPatients: (filters: SimpleCacheFilters) => Promise<void>;\n  clearSearch: () => void;\n  applyFilters: (filters: SimpleCacheFilters) => void;\n  \n  // CRUD Operations\n  createPatient: (patient: Omit<Patient, 'id' | 'createdAt' | 'updatedAt'>) => Promise<Patient>;\n  updatePatient: (id: string, updates: Partial<Patient>) => Promise<Patient>;\n  deletePatient: (id: string) => Promise<void>;\n  \n  // Data Management\n  refreshPatients: () => Promise<void>;\n  syncPatients: () => Promise<void>;\n  clearCache: () => Promise<void>;\n  \n  // Utilities\n  getPatientById: (id: string) => Patient | undefined;\n  validatePatient: (patient: Partial<Patient>) => { isValid: boolean; errors: string[] };\n}\n\nexport function usePatients(options: UsePatientsOptions = {}) {\n  const { \n    cacheEnabled = true, \n    autoRefresh = false, \n    refreshInterval = 300000, // 5 minutes instead of 30 seconds\n    enableRealTimeSync = false \n  } = options;\n\n  // State\n  const [patients, setPatients] = useState<Patient[]>([]);\n  const [searchResults, setSearchResults] = useState<PatientSearchResult | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSearching, setIsSearching] = useState(false);\n  const [isSyncing, setIsSyncing] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [currentFilters, setCurrentFilters] = useState<SimpleCacheFilters>({});\n\n  // Initialize patients data\n  useEffect(() => {\n    const initializePatients = async () => {\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // Load patients from cache first if enabled\n        if (cacheEnabled) {\n          const cachedPatients = await patientCacheService.getCachedPatients();\n          if (cachedPatients.length > 0) {\n            setPatients(cachedPatients);\n            setIsLoading(false);\n          }\n        }\n\n        // Load fresh data from service\n        const patientsResult = await patientService.getPatients({ limit: 10000 }); // Get all patients\n        setPatients(patientsResult.patients);\n\n      } catch (err) {\n        console.error('Failed to initialize patients:', err);\n        setError(err instanceof Error ? err.message : 'Failed to load patients');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    initializePatients();\n  }, [cacheEnabled]);\n\n  // Auto refresh setup\n  useEffect(() => {\n    if (!autoRefresh) return;\n\n    const interval = setInterval(async () => {\n      try {\n        const updatedPatientsResult = await patientService.getPatients({ limit: 10000 }); // Get all patients\n        setPatients(updatedPatientsResult.patients);\n      } catch (err) {\n        console.error('Auto refresh failed:', err);\n      }\n    }, refreshInterval);\n\n    return () => clearInterval(interval);\n  }, [autoRefresh, refreshInterval]);\n\n  // Real-time sync setup\n  useEffect(() => {\n    if (!enableRealTimeSync) return;\n\n    const handleStorageChange = (event: StorageEvent) => {\n      if (event.key?.startsWith('patient_')) {\n        // Reload patients when storage changes\n        patientService.getPatients().then(result => {\n          setPatients(result.patients);\n        });\n      }\n    };\n\n    window.addEventListener('storage', handleStorageChange);\n    return () => window.removeEventListener('storage', handleStorageChange);\n  }, [enableRealTimeSync]);\n\n  // Search patients\n  const searchPatients = useCallback(async (filters: SimpleCacheFilters) => {\n    try {\n      setIsSearching(true);\n      setError(null);\n      setCurrentFilters(filters);\n\n      let results: PatientSearchResult;\n\n      if (cacheEnabled && !filters.search) {\n        // Use cache for simple filtering\n        results = await patientCacheService.searchCachedPatients(filters);\n      } else {\n        // Use search service for complex queries\n        const patientFilters = {\n          search: filters.search,\n          status: filters.status as \"active\" | \"inactive\" | \"archived\" | undefined,\n          segment: filters.segment as \"new\" | \"trial\" | \"purchased\" | \"control\" | \"renewal\" | undefined,\n          labels: filters.label ? [filters.label[0]] : undefined,\n          hasDevice: filters.hasDevices,\n          page: filters.page,\n          limit: filters.limit\n        };\n        \n        results = await patientSearchService.searchPatients(patients, patientFilters);\n      }\n\n      setSearchResults(results);\n    } catch (err) {\n      console.error('Search failed:', err);\n      setError(err instanceof Error ? err.message : 'Search failed');\n    } finally {\n      setIsSearching(false);\n    }\n  }, [patients, cacheEnabled]);\n\n  // Clear search\n  const clearSearch = useCallback(() => {\n    setSearchResults(null);\n    setCurrentFilters({});\n  }, []);\n\n  // Apply filters\n  const applyFilters = useCallback((filters: SimpleCacheFilters) => {\n    setCurrentFilters(filters);\n    searchPatients(filters);\n  }, [searchPatients]);\n\n  // Create patient\n  const createPatient = useCallback(async (patientData: Omit<Patient, 'id' | 'createdAt' | 'updatedAt'>): Promise<Patient> => {\n    try {\n      setError(null);\n\n      // Validate patient data\n      const validation = patientValidationService.validatePatient(patientData);\n      if (!validation.isValid) {\n        throw new Error(`Validation failed: ${validation.errors.join(', ')}`);\n      }\n\n      // Create patient using service\n      const newPatient = await patientService.createPatient(patientData);\n\n      // Update local state\n      setPatients(prev => [...prev, newPatient]);\n\n      // Cache if enabled\n      if (cacheEnabled) {\n        await patientCacheService.updateCachedPatient(newPatient);\n      }\n\n      // Sync to server\n      if (enableRealTimeSync) {\n        await patientSyncService.syncSinglePatient(newPatient.id);\n      }\n\n      return newPatient;\n    } catch (err) {\n      console.error('Failed to create patient:', err);\n      setError(err instanceof Error ? err.message : 'Failed to create patient');\n      throw err;\n    }\n  }, [cacheEnabled, enableRealTimeSync]);\n\n  // Update patient\n  const updatePatient = useCallback(async (id: string, updates: Partial<Patient>): Promise<Patient> => {\n    try {\n      setError(null);\n\n      const existingPatient = patients.find(p => p.id === id);\n      if (!existingPatient) {\n        throw new Error('Patient not found');\n      }\n\n      const updatedPatient = await patientService.updatePatient(id, updates);\n      if (!updatedPatient) {\n        throw new Error('Failed to update patient');\n      }\n\n      // Update local state\n      setPatients(prev => prev.map(p => p.id === id ? updatedPatient : p));\n\n      // Update cache if enabled\n      if (cacheEnabled) {\n        await patientCacheService.updateCachedPatient(updatedPatient);\n      }\n\n      // Sync to server\n      if (enableRealTimeSync) {\n        await patientSyncService.syncSinglePatient(id);\n      }\n\n      return updatedPatient;\n    } catch (err) {\n      console.error('Failed to update patient:', err);\n      setError(err instanceof Error ? err.message : 'Failed to update patient');\n      throw err;\n    }\n  }, [patients, cacheEnabled, enableRealTimeSync]);\n\n  // Delete patient\n  const deletePatient = useCallback(async (id: string): Promise<void> => {\n    try {\n      setError(null);\n\n      const success = await patientService.deletePatient(id);\n      if (!success) {\n        throw new Error('Failed to delete patient');\n      }\n\n      // Remove from local state\n      setPatients(prev => prev.filter(p => p.id !== id));\n\n      // Remove from cache if enabled\n      if (cacheEnabled) {\n        await patientCacheService.removeCachedPatient(id);\n      }\n\n      // Sync deletion to server\n      if (enableRealTimeSync) {\n        // This would typically mark for deletion in outbox\n        console.log('Marking patient for deletion:', id);\n      }\n    } catch (err) {\n      console.error('Failed to delete patient:', err);\n      setError(err instanceof Error ? err.message : 'Failed to delete patient');\n      throw err;\n    }\n  }, [cacheEnabled, enableRealTimeSync]);\n\n  // Refresh patients\n  const refreshPatients = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const freshPatientsResult = await patientService.getPatients({ limit: 10000 }); // Get all patients\n      setPatients(freshPatientsResult.patients);\n\n      // Re-apply current filters if any\n      if (Object.keys(currentFilters).length > 0) {\n        await searchPatients(currentFilters);\n      }\n    } catch (err) {\n      console.error('Failed to refresh patients:', err);\n      setError(err instanceof Error ? err.message : 'Failed to refresh patients');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [currentFilters, searchPatients]);\n\n  // Sync patients\n  const syncPatients = useCallback(async () => {\n    try {\n      setIsSyncing(true);\n      setError(null);\n\n      const syncResult = await patientSyncService.syncPatients();\n      \n      if (syncResult.conflicts.length > 0) {\n        console.warn('Sync conflicts detected:', syncResult.conflicts);\n        // Handle conflicts - could show a modal or notification\n      }\n\n      // Refresh local data after sync\n      await refreshPatients();\n    } catch (err) {\n      console.error('Failed to sync patients:', err);\n      setError(err instanceof Error ? err.message : 'Failed to sync patients');\n    } finally {\n      setIsSyncing(false);\n    }\n  }, [refreshPatients]);\n\n  // Clear cache\n  const clearCache = useCallback(async () => {\n    try {\n      if (cacheEnabled) {\n        await patientCacheService.clearCache();\n        // Reload from API\n        await refreshPatients();\n      }\n    } catch (err) {\n      console.error('Failed to clear cache:', err);\n      setError(err instanceof Error ? err.message : 'Failed to clear cache');\n    }\n  }, [cacheEnabled, refreshPatients]);\n\n  // Get patient by ID\n  const getPatientById = useCallback((id: string): Patient | undefined => {\n    return patients.find(p => p.id === id);\n  }, [patients]);\n\n  // Validate patient\n  const validatePatient = useCallback((patient: Partial<Patient>) => {\n    const validation = patientValidationService.validatePatient(patient);\n    return {\n      isValid: validation.isValid,\n      errors: validation.errors.map(e => e.message)\n    };\n  }, []);\n\n  // Memoized total count\n  const totalCount = useMemo(() => {\n    return searchResults ? searchResults.totalCount : patients.length;\n  }, [searchResults, patients.length]);\n\n  return {\n    // Data\n    patients,\n    searchResults,\n    totalCount,\n    isLoading,\n    isSearching,\n    isSyncing,\n    error,\n    \n    // Search & Filter\n    searchPatients,\n    clearSearch,\n    applyFilters,\n    \n    // CRUD Operations\n    createPatient,\n    updatePatient,\n    deletePatient,\n    \n    // Data Management\n    refreshPatients,\n    syncPatients,\n    clearCache,\n    \n    // Utilities\n    getPatientById,\n    validatePatient\n  };\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useResponsive.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setDeviceInfo' is assigned a value but never used.","line":114,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":114,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\n\n// Tailwind CSS breakpoints\nconst breakpoints = {\n  sm: 640,\n  md: 768,\n  lg: 1024,\n  xl: 1280,\n  '2xl': 1536,\n} as const;\n\ntype Breakpoint = keyof typeof breakpoints;\n\ninterface ResponsiveState {\n  width: number;\n  height: number;\n  isMobile: boolean;\n  isTablet: boolean;\n  isDesktop: boolean;\n  isLandscape: boolean;\n  isPortrait: boolean;\n  breakpoint: Breakpoint | 'xs';\n}\n\nexport const useResponsive = (): ResponsiveState => {\n  const [state, setState] = useState<ResponsiveState>(() => {\n    if (typeof window === 'undefined') {\n      return {\n        width: 0,\n        height: 0,\n        isMobile: false,\n        isTablet: false,\n        isDesktop: true,\n        isLandscape: true,\n        isPortrait: false,\n        breakpoint: 'lg' as const,\n      };\n    }\n\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n    \n    return {\n      width,\n      height,\n      isMobile: width < breakpoints.md,\n      isTablet: width >= breakpoints.md && width < breakpoints.lg,\n      isDesktop: width >= breakpoints.lg,\n      isLandscape: width > height,\n      isPortrait: width <= height,\n      breakpoint: getBreakpoint(width),\n    };\n  });\n\n  useEffect(() => {\n    const handleResize = () => {\n      const width = window.innerWidth;\n      const height = window.innerHeight;\n      \n      setState({\n        width,\n        height,\n        isMobile: width < breakpoints.md,\n        isTablet: width >= breakpoints.md && width < breakpoints.lg,\n        isDesktop: width >= breakpoints.lg,\n        isLandscape: width > height,\n        isPortrait: width <= height,\n        breakpoint: getBreakpoint(width),\n      });\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  return state;\n};\n\nfunction getBreakpoint(width: number): Breakpoint | 'xs' {\n  if (width >= breakpoints['2xl']) return '2xl';\n  if (width >= breakpoints.xl) return 'xl';\n  if (width >= breakpoints.lg) return 'lg';\n  if (width >= breakpoints.md) return 'md';\n  if (width >= breakpoints.sm) return 'sm';\n  return 'xs';\n}\n\n// Hook for media queries\nexport const useMediaQuery = (query: string): boolean => {\n  const [matches, setMatches] = useState(() => {\n    if (typeof window === 'undefined') return false;\n    return window.matchMedia(query).matches;\n  });\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n\n    const mediaQuery = window.matchMedia(query);\n    const handleChange = (event: MediaQueryListEvent) => {\n      setMatches(event.matches);\n    };\n\n    mediaQuery.addEventListener('change', handleChange);\n    setMatches(mediaQuery.matches);\n\n    return () => mediaQuery.removeEventListener('change', handleChange);\n  }, [query]);\n\n  return matches;\n};\n\n// Hook for device detection\nexport const useDeviceDetection = () => {\n  const [deviceInfo, setDeviceInfo] = useState(() => {\n    if (typeof window === 'undefined') {\n      return {\n        isMobile: false,\n        isTablet: false,\n        isDesktop: true,\n        isTouchDevice: false,\n        userAgent: '',\n        platform: '',\n      };\n    }\n\n    const userAgent = navigator.userAgent;\n    const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n    \n    return {\n      isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent),\n      isTablet: /iPad|Android(?!.*Mobile)/i.test(userAgent),\n      isDesktop: !/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent),\n      isTouchDevice,\n      userAgent,\n      platform: navigator.platform,\n    };\n  });\n\n  return deviceInfo;\n};\n\n// Hook for viewport dimensions with debouncing\nexport const useViewport = (debounceMs: number = 100) => {\n  const [viewport, setViewport] = useState(() => {\n    if (typeof window === 'undefined') {\n      return { width: 0, height: 0 };\n    }\n    return {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n  });\n\n  useEffect(() => {\n    let timeoutId: NodeJS.Timeout;\n\n    const handleResize = () => {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(() => {\n        setViewport({\n          width: window.innerWidth,\n          height: window.innerHeight,\n        });\n      }, debounceMs);\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      clearTimeout(timeoutId);\n    };\n  }, [debounceMs]);\n\n  return viewport;\n};\n\n// Hook for safe area insets (for mobile devices with notches)\nexport const useSafeArea = () => {\n  const [safeArea, setSafeArea] = useState({\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n  });\n\n  useEffect(() => {\n    const updateSafeArea = () => {\n      const computedStyle = getComputedStyle(document.documentElement);\n      \n      setSafeArea({\n        top: parseInt(computedStyle.getPropertyValue('--safe-area-inset-top') || '0', 10),\n        right: parseInt(computedStyle.getPropertyValue('--safe-area-inset-right') || '0', 10),\n        bottom: parseInt(computedStyle.getPropertyValue('--safe-area-inset-bottom') || '0', 10),\n        left: parseInt(computedStyle.getPropertyValue('--safe-area-inset-left') || '0', 10),\n      });\n    };\n\n    // Set CSS custom properties for safe area insets\n    if ('CSS' in window && 'supports' in window.CSS) {\n      if (window.CSS.supports('padding: env(safe-area-inset-top)')) {\n        document.documentElement.style.setProperty('--safe-area-inset-top', 'env(safe-area-inset-top)');\n        document.documentElement.style.setProperty('--safe-area-inset-right', 'env(safe-area-inset-right)');\n        document.documentElement.style.setProperty('--safe-area-inset-bottom', 'env(safe-area-inset-bottom)');\n        document.documentElement.style.setProperty('--safe-area-inset-left', 'env(safe-area-inset-left)');\n      }\n    }\n\n    updateSafeArea();\n    window.addEventListener('resize', updateSafeArea);\n    window.addEventListener('orientationchange', updateSafeArea);\n\n    return () => {\n      window.removeEventListener('resize', updateSafeArea);\n      window.removeEventListener('orientationchange', updateSafeArea);\n    };\n  }, []);\n\n  return safeArea;\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/useVirtualScroll.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":173,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4276,4279],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4276,4279],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Custom hook for virtual scrolling functionality\n * Provides efficient rendering for large lists\n */\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\n\ninterface UseVirtualScrollOptions {\n  itemHeight: number;\n  containerHeight: number;\n  totalItems: number;\n  overscan?: number;\n}\n\ninterface VirtualScrollResult {\n  startIndex: number;\n  endIndex: number;\n  visibleItems: number;\n  offsetY: number;\n  totalHeight: number;\n}\n\nexport const useVirtualScroll = ({\n  itemHeight,\n  containerHeight,\n  totalItems,\n  overscan = 5\n}: UseVirtualScrollOptions): [VirtualScrollResult, (scrollTop: number) => void] => {\n  const [scrollTop, setScrollTop] = useState(0);\n\n  const virtualScrollResult = useMemo((): VirtualScrollResult => {\n    const visibleItems = Math.ceil(containerHeight / itemHeight);\n    const startIndex = Math.max(0, Math.floor(scrollTop / itemHeight) - overscan);\n    const endIndex = Math.min(totalItems - 1, startIndex + visibleItems + overscan * 2);\n    const offsetY = startIndex * itemHeight;\n    const totalHeight = totalItems * itemHeight;\n\n    return {\n      startIndex,\n      endIndex,\n      visibleItems,\n      offsetY,\n      totalHeight\n    };\n  }, [scrollTop, itemHeight, containerHeight, totalItems, overscan]);\n\n  const handleScroll = useCallback((newScrollTop: number) => {\n    setScrollTop(newScrollTop);\n  }, []);\n\n  return [virtualScrollResult, handleScroll];\n};\n\n/**\n * Hook for infinite scroll functionality\n */\ninterface UseInfiniteScrollOptions {\n  hasMore: boolean;\n  loading: boolean;\n  threshold?: number;\n  onLoadMore: () => void;\n}\n\nexport const useInfiniteScroll = ({\n  hasMore,\n  loading,\n  threshold = 200,\n  onLoadMore\n}: UseInfiniteScrollOptions) => {\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    const { scrollTop, scrollHeight, clientHeight } = e.currentTarget;\n    \n    if (hasMore && !loading && scrollTop + clientHeight >= scrollHeight - threshold) {\n      onLoadMore();\n    }\n  }, [hasMore, loading, threshold, onLoadMore]);\n\n  return { handleScroll };\n};\n\n/**\n * Hook for lazy loading with intersection observer\n */\ninterface UseLazyLoadingOptions {\n  threshold?: number;\n  rootMargin?: string;\n}\n\nexport const useLazyLoading = ({\n  threshold = 0.1,\n  rootMargin = '50px'\n}: UseLazyLoadingOptions = {}) => {\n  const [visibleItems, setVisibleItems] = useState<Set<string>>(new Set());\n\n  const observerRef = useCallback((node: HTMLElement | null, itemId: string) => {\n    if (!node) return;\n\n    const observer = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting) {\n          setVisibleItems(prev => new Set(prev).add(itemId));\n        } else {\n          setVisibleItems(prev => {\n            const newSet = new Set(prev);\n            newSet.delete(itemId);\n            return newSet;\n          });\n        }\n      },\n      { threshold, rootMargin }\n    );\n\n    observer.observe(node);\n\n    return () => {\n      observer.unobserve(node);\n    };\n  }, [threshold, rootMargin]);\n\n  const isVisible = useCallback((itemId: string) => {\n    return visibleItems.has(itemId);\n  }, [visibleItems]);\n\n  return { observerRef, isVisible, visibleItems };\n};\n\n/**\n * Hook for performance monitoring\n */\nexport const usePerformanceMonitor = () => {\n  const [metrics, setMetrics] = useState({\n    renderTime: 0,\n    scrollFPS: 0,\n    memoryUsage: 0\n  });\n\n  const measureRenderTime = useCallback((callback: () => void) => {\n    const start = performance.now();\n    callback();\n    const end = performance.now();\n    \n    setMetrics(prev => ({\n      ...prev,\n      renderTime: end - start\n    }));\n  }, []);\n\n  const measureScrollFPS = useCallback(() => {\n    let frameCount = 0;\n    let lastTime = performance.now();\n\n    const measureFrame = () => {\n      frameCount++;\n      const currentTime = performance.now();\n      \n      if (currentTime - lastTime >= 1000) {\n        setMetrics(prev => ({\n          ...prev,\n          scrollFPS: frameCount\n        }));\n        frameCount = 0;\n        lastTime = currentTime;\n      }\n      \n      requestAnimationFrame(measureFrame);\n    };\n\n    requestAnimationFrame(measureFrame);\n  }, []);\n\n  const measureMemoryUsage = useCallback(() => {\n    if ('memory' in performance) {\n      const memory = (performance as any).memory;\n      setMetrics(prev => ({\n        ...prev,\n        memoryUsage: memory.usedJSHeapSize / 1024 / 1024 // MB\n      }));\n    }\n  }, []);\n\n  useEffect(() => {\n    const interval = setInterval(measureMemoryUsage, 5000);\n    return () => clearInterval(interval);\n  }, [measureMemoryUsage]);\n\n  return {\n    metrics,\n    measureRenderTime,\n    measureScrollFPS,\n    measureMemoryUsage\n  };\n};\n\nexport default useVirtualScroll;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/uts/useUts.spec.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[386,389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[386,389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[470,473],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[470,473],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { vi, describe, it, expect } from 'vitest';\n\nvi.mock('@/services/uts/uts.service', () => ({\n  default: {\n    startBulkRegistration: vi.fn(() => Promise.resolve({ jobId: 'job-123' }))\n  }\n}));\n\nimport utsService from '@/services/uts/uts.service';\n\ndescribe('uts.service (mock)', () => {\n  it('startBulkRegistration is callable', async () => {\n    const res = await (utsService as any).startBulkRegistration({ rows: [{ serial: 's1' }] });\n    expect((utsService as any).startBulkRegistration).toHaveBeenCalled();\n    expect(res).toEqual({ jobId: 'job-123' });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/hooks/uts/useUts.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[232,235],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[232,235],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[464,467],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[464,467],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[906,909],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[906,909],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1178,1181],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1178,1181],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1252,1255],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1252,1255],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1479,1482],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1479,1482],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1519,1522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1519,1522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":8,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":11,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1623,1626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1623,1626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport utsService from '@/services/uts/uts.service';\n\nconst QUERY_KEY = ['uts', 'registrations'] as const;\n\nexport function useUtsRegistrations(params?: any) {\n  return useQuery({ queryKey: QUERY_KEY, queryFn: () => utsService.listRegistrations(params) });\n}\n\nexport function useStartBulkUtsRegistration() {\n  const qc = useQueryClient();\n  return useMutation({\n    mutationFn: (body: any) => utsService.startBulkRegistration(body),\n    onSuccess: () => qc.invalidateQueries({ queryKey: QUERY_KEY }),\n  });\n}\n\nexport function useUtsJobStatus(jobId: string) {\n  // Basic status query — useful for one-off checks\n  return useQuery({ queryKey: ['uts', 'job', jobId], queryFn: () => utsService.getJobStatus(jobId), enabled: !!jobId });\n}\n\nexport function usePollUtsJob(jobId: string, opts?: { interval?: number; onComplete?: (data:any)=>void }) {\n  // Poll the job status until terminal state\n  const interval = opts?.interval ?? 3000;\n  return useQuery(({\n    queryKey: ['uts', 'job', jobId, 'poll'],\n    queryFn: () => utsService.getJobStatus(jobId),\n    enabled: !!jobId,\n    refetchInterval: (data: any) => {\n      if (!data) return interval;\n      const status = (data as any).status;\n      // consider 'completed', 'failed', 'cancelled' as terminal\n      if (status === 'completed' || status === 'failed' || status === 'cancelled') return false;\n      return interval;\n    },\n    onSuccess: (data: any) => {\n      const status = (data as any)?.status;\n      if (status === 'completed' && opts?.onComplete) opts.onComplete(data);\n    }\n  } as any));\n}\n\nexport default useUtsRegistrations;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/InventoryPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_loading' is assigned a value but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":18},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":150,"column":21,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":156,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select } from '@x-ear/ui-web';\nimport React, { useState, useEffect } from 'react';\nimport { Plus, Filter, Download, Upload } from 'lucide-react';\nimport { InventoryList } from '../components/inventory/InventoryList';\nimport { InventoryStats } from '../components/inventory/InventoryStats';\nimport { inventoryService } from '../services/inventory.service';\nimport { InventoryFilters, InventoryCategory, InventoryStatus } from '../types/inventory';\n\nexport const InventoryPage: React.FC = () => {\n  const [_loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [filters, setFilters] = useState<InventoryFilters>({});\n  const [showFilters, setShowFilters] = useState(false);\n  const [enableFuzzySearch, setEnableFuzzySearch] = useState(true);\n\n  useEffect(() => {\n    // Initial load to check if service is working\n    const checkService = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        await inventoryService.getStats();\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Envanter servisi yüklenirken hata oluştu');\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    checkService();\n  }, []);\n\n  const handleFilterChange = (newFilters: Partial<InventoryFilters>) => {\n    setFilters(prev => ({ ...prev, ...newFilters }));\n  };\n\n  const clearFilters = () => {\n    setFilters({});\n  };\n\n  const exportInventory = async () => {\n    try {\n      // This would typically generate and download a CSV/Excel file\n      const data = await inventoryService.searchItems({});\n      console.log('Exporting inventory data:', data);\n      // Implementation for actual file download would go here\n    } catch (err) {\n      console.error('Export failed:', err);\n    }\n  };\n\n  const importInventory = () => {\n    // This would typically open a file picker and handle bulk import\n    console.log('Import inventory functionality');\n    // Implementation for file upload and bulk import would go here\n  };\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"bg-white p-8 rounded-lg shadow-md max-w-md w-full\">\n          <div className=\"text-center\">\n            <div className=\"text-red-500 mb-4\">\n              <svg className=\"w-16 h-16 mx-auto\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n            </div>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Hata Oluştu</h3>\n            <p className=\"text-gray-600 mb-4\">{error}</p>\n            <Button\n              onClick={() => setError(null)}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors\"\n              variant='default'>\n              Tekrar Dene\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex justify-between items-center\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900\">Envanter Yönetimi</h1>\n              <p className=\"text-gray-600 mt-2\">İşitme cihazları ve aksesuarları yönetin</p>\n            </div>\n            <div className=\"flex space-x-3\">\n              <Button\n                onClick={importInventory}\n                className=\"flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors\"\n                variant='default'>\n                <Upload className=\"h-4 w-4 mr-2\" />\n                İçe Aktar\n              </Button>\n              <Button\n                onClick={exportInventory}\n                className=\"flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors\"\n                variant='default'>\n                <Download className=\"h-4 w-4 mr-2\" />\n                Dışa Aktar\n              </Button>\n              <Button\n                onClick={() => setShowFilters(!showFilters)}\n                className={`flex items-center px-4 py-2 rounded-md shadow-sm text-sm font-medium transition-colors ${\n                  showFilters\n                    ? 'bg-blue-600 text-white hover:bg-blue-700'\n                    : 'border border-gray-300 text-gray-700 bg-white hover:bg-gray-50'\n                }`}\n                variant='default'>\n                <Filter className=\"h-4 w-4 mr-2\" />\n                Filtrele\n              </Button>\n              <Button\n                className=\"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md shadow-sm text-sm font-medium hover:bg-blue-700 transition-colors\"\n                variant='default'>\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Yeni Ürün\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Stats */}\n        <div className=\"mb-8\">\n          <InventoryStats />\n        </div>\n\n        {/* Filters */}\n        {showFilters && (\n          <div className=\"bg-white p-6 rounded-lg shadow mb-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Arama\n                </label>\n                <div className=\"space-y-2\">\n                  <Input\n                    type=\"text\"\n                    value={filters.search || ''}\n                    onChange={(e) => handleFilterChange({ search: e.target.value })}\n                    placeholder=\"Ürün adı, marka, model...\"\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                  <div className=\"flex items-center\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"fuzzy-search\"\n                      checked={enableFuzzySearch}\n                      onChange={(e) => setEnableFuzzySearch(e.target.checked)}\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                    />\n                    <label htmlFor=\"fuzzy-search\" className=\"ml-2 text-sm text-gray-600\">\n                      Akıllı Arama (Fuzzy Search)\n                    </label>\n                  </div>\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Kategori\n                </label>\n                <Select\n                  value={filters.category || ''}\n                  onChange={(e) => handleFilterChange({ category: e.target.value as InventoryCategory || undefined })}\n                  options={[\n                    { value: '', label: 'Tüm Kategoriler' },\n                    { value: 'hearing_aid', label: 'İşitme Cihazı' },\n                    { value: 'battery', label: 'Pil' },\n                    { value: 'accessory', label: 'Aksesuar' },\n                    { value: 'ear_mold', label: 'Kulak Kalıbı' },\n                    { value: 'cleaning_supplies', label: 'Temizlik Malzemeleri' },\n                    { value: 'amplifiers', label: 'Amplifikatör' }\n                  ]}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Durum\n                </label>\n                <Select\n                  value={filters.status || ''}\n                  onChange={(e) => handleFilterChange({ status: e.target.value as InventoryStatus || undefined })}\n                  options={[\n                    { value: '', label: 'Tüm Durumlar' },\n                    { value: 'available', label: 'Mevcut' },\n                    { value: 'assigned', label: 'Atanmış' },\n                    { value: 'maintenance', label: 'Bakımda' },\n                    { value: 'retired', label: 'Emekli' },\n                    { value: 'low_stock', label: 'Düşük Stok' },\n                    { value: 'out_of_stock', label: 'Tükendi' }\n                  ]}\n                  placeholder=\"Durum seçiniz\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Marka\n                </label>\n                <Input\n                  type=\"text\"\n                  value={filters.brand || ''}\n                  onChange={(e) => handleFilterChange({ brand: e.target.value })}\n                  placeholder=\"Marka adı...\"\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex justify-between items-center mt-4 pt-4 border-t border-gray-200\">\n              <div className=\"flex items-center space-x-4\">\n                <label className=\"flex items-center\">\n                  <Input\n                    type=\"checkbox\"\n                    checked={filters.lowStock || false}\n                    onChange={(e) => handleFilterChange({ lowStock: e.target.checked })}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"ml-2 text-sm text-gray-700\">Sadece düşük stok</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <Input\n                    type=\"checkbox\"\n                    checked={filters.outOfStock || false}\n                    onChange={(e) => handleFilterChange({ outOfStock: e.target.checked })}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"ml-2 text-sm text-gray-700\">Sadece tükenen</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <Input\n                    type=\"checkbox\"\n                    checked={filters.isMinistryTracked || false}\n                    onChange={(e) => handleFilterChange({ isMinistryTracked: e.target.checked })}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"ml-2 text-sm text-gray-700\">SGK takipli</span>\n                </label>\n              </div>\n              <Button\n                onClick={clearFilters}\n                className=\"text-sm text-blue-600 hover:text-blue-800 transition-colors\"\n                variant='default'>\n                Filtreleri Temizle\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {/* Inventory List */}\n        <div className=\"bg-white rounded-lg shadow\">\n          <InventoryList\n            filters={{...filters, enableFuzzySearch, maxResults: 100}}\n            onItemSelect={(item) => console.log('Selected item:', item)}\n            onItemEdit={(item) => console.log('Edit item:', item)}\n            onItemDelete={(item) => console.log('Delete item:', item)}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default InventoryPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/InvoiceManagementPage.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadInvoices'. Either include it or remove the dependency array.","line":56,"column":6,"nodeType":"ArrayExpression","endLine":56,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadInvoices]","fix":{"range":[1635,1637],"text":"[loadInvoices]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":266,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":266,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7446,7449],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7446,7449],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":286,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":286,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7941,7944],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7941,7944],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":363,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10709,10712],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10709,10712],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select } from '@x-ear/ui-web';\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Invoice, InvoiceFilters, InvoiceTemplate } from '../types/invoice';\n\nimport { InvoiceModal } from '../components/modals/InvoiceModal';\nimport { InvoiceBulkOperations } from '../components/invoice/InvoiceBulkOperations';\nimport { InvoiceTemplateManager } from '../components/templates/InvoiceTemplateManager';\nimport { EFaturaXMLGenerator } from '../components/invoice/EFaturaXMLGenerator';\n\ninterface InvoiceManagementPageProps {\n  className?: string;\n}\n\ninterface PageState {\n  invoices: Invoice[];\n  selectedInvoices: Invoice[];\n  isLoading: boolean;\n  error: string | null;\n  filters: InvoiceFilters;\n  currentView: 'list' | 'templates' | 'bulk' | 'xml';\n}\n\ninterface ModalState {\n  isOpen: boolean;\n  mode: 'create' | 'quick' | 'template';\n  invoice: Invoice | null;\n  template: InvoiceTemplate | null;\n}\n\nexport const InvoiceManagementPage: React.FC<InvoiceManagementPageProps> = ({\n  className = ''\n}) => {\n  const [state, setState] = useState<PageState>({\n    invoices: [],\n    selectedInvoices: [],\n    isLoading: true,\n    error: null,\n    filters: {},\n    currentView: 'list'\n  });\n\n  const [modalState, setModalState] = useState<ModalState>({\n    isOpen: false,\n    mode: 'create',\n    invoice: null,\n    template: null\n  });\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [typeFilter, setTypeFilter] = useState<string>('all');\n\n  // Load invoices on component mount\n  useEffect(() => {\n    loadInvoices();\n  }, []);\n\n  const loadInvoices = useCallback(async () => {\n    setState(prev => ({ ...prev, isLoading: true, error: null }));\n    \n    try {\n      // Mock data for demonstration\n      const mockInvoices: Invoice[] = [\n        {\n          id: '1',\n          invoiceNumber: 'INV-2024-001',\n          type: 'service',\n          status: 'sent',\n          patientName: 'Ahmet Yılmaz',\n          patientPhone: '+90 532 123 4567',\n          patientTcNumber: '12345678901',\n          billingAddress: {\n            name: 'Ahmet Yılmaz',\n            address: 'Atatürk Cad. No:123',\n            city: 'İstanbul',\n            district: 'Kadıköy',\n            postalCode: '34710',\n            country: 'Türkiye',\n            taxNumber: '1234567890',\n            taxOffice: 'Kadıköy Vergi Dairesi'\n          },\n          issueDate: '2024-01-15',\n          dueDate: '2024-02-15',\n          paymentMethod: 'credit_card',\n          items: [\n            {\n              id: '1',\n              name: 'Genel Muayene',\n              description: 'Rutin kontrol muayenesi',\n              quantity: 1,\n              unitPrice: 150,\n              discount: 0,\n              taxRate: 18,\n              taxAmount: 27,\n              totalPrice: 177\n            }\n          ],\n          subtotal: 150,\n          totalDiscount: 0,\n          taxes: [\n            {\n              type: 'kdv',\n              rate: 18,\n              baseAmount: 150,\n              taxAmount: 27\n            }\n          ],\n          totalTax: 27,\n          grandTotal: 177,\n          currency: 'TRY',\n          notes: 'Genel muayene hizmeti',\n          createdAt: '2024-01-15T10:00:00Z',\n          updatedAt: '2024-01-15T10:00:00Z',\n          createdBy: 'admin'\n        },\n        {\n          id: '2',\n          invoiceNumber: 'INV-2024-002',\n          type: 'service',\n          status: 'draft',\n          patientName: 'Fatma Demir',\n          patientPhone: '+90 533 987 6543',\n          billingAddress: {\n            name: 'Fatma Demir',\n            address: 'İnönü Bulvarı No:456',\n            city: 'Ankara',\n            district: 'Çankaya',\n            postalCode: '06100',\n            country: 'Türkiye'\n          },\n          issueDate: '2024-01-16',\n          dueDate: '2024-02-16',\n          items: [\n            {\n              id: '2',\n              name: 'Diş Tedavisi',\n              description: 'Kanal tedavisi',\n              quantity: 1,\n              unitPrice: 500,\n              discount: 50,\n              discountType: 'amount',\n              taxRate: 18,\n              taxAmount: 81,\n              totalPrice: 531\n            }\n          ],\n          subtotal: 500,\n          totalDiscount: 50,\n          taxes: [\n            {\n              type: 'kdv',\n              rate: 18,\n              baseAmount: 450,\n              taxAmount: 81\n            }\n          ],\n          totalTax: 81,\n          grandTotal: 531,\n          currency: 'TRY',\n          createdAt: '2024-01-16T14:30:00Z',\n          updatedAt: '2024-01-16T14:30:00Z',\n          createdBy: 'admin'\n        }\n      ];\n\n      setState(prev => ({\n        ...prev,\n        invoices: mockInvoices,\n        isLoading: false\n      }));\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : 'Faturalar yüklenirken hata oluştu',\n        isLoading: false\n      }));\n    }\n  }, []);\n\n  // Filter invoices based on search and filters\n  const filteredInvoices = React.useMemo(() => {\n    let filtered = state.invoices;\n\n    // Apply search filter\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      filtered = filtered.filter(invoice =>\n        invoice.invoiceNumber.toLowerCase().includes(query) ||\n        invoice.patientName.toLowerCase().includes(query) ||\n        invoice.patientPhone?.toLowerCase().includes(query)\n      );\n    }\n\n    // Apply status filter\n    if (statusFilter !== 'all') {\n      filtered = filtered.filter(invoice => invoice.status === statusFilter);\n    }\n\n    // Apply type filter\n    if (typeFilter !== 'all') {\n      filtered = filtered.filter(invoice => invoice.type === typeFilter);\n    }\n\n    return filtered;\n  }, [state.invoices, searchQuery, statusFilter, typeFilter]);\n\n  const handleCreateInvoice = useCallback(() => {\n    setModalState({\n      isOpen: true,\n      mode: 'create',\n      invoice: null,\n      template: null\n    });\n  }, []);\n\n  const handleQuickInvoice = useCallback(() => {\n    setModalState({\n      isOpen: true,\n      mode: 'quick',\n      invoice: null,\n      template: null\n    });\n  }, []);\n\n  const handleEditInvoice = useCallback((invoice: Invoice) => {\n    // For edit mode, we'll use create mode with initial data\n    setModalState({\n      isOpen: true,\n      mode: 'create',\n      invoice,\n      template: null\n    });\n  }, []);\n\n  const handleViewInvoice = useCallback((invoice: Invoice) => {\n    // For view mode, we'll show invoice details in a separate component\n    console.log('Viewing invoice:', invoice);\n    // TODO: Implement view modal or navigate to detail page\n  }, []);\n\n  const handleUseTemplate = useCallback((template: InvoiceTemplate) => {\n    setModalState({\n      isOpen: true,\n      mode: 'template',\n      invoice: null,\n      template\n    });\n  }, []);\n\n  const handleInvoiceSelect = useCallback((invoice: Invoice, selected: boolean) => {\n    setState(prev => ({\n      ...prev,\n      selectedInvoices: selected\n        ? [...prev.selectedInvoices, invoice]\n        : prev.selectedInvoices.filter(i => i.id !== invoice.id)\n    }));\n  }, []);\n\n  const handleSelectAll = useCallback((selected: boolean) => {\n    setState(prev => ({\n      ...prev,\n      selectedInvoices: selected ? [...filteredInvoices] : []\n    }));\n  }, [filteredInvoices]);\n\n  const handleBulkActionComplete = useCallback((action: string, results: any) => {\n    // Refresh invoices after bulk action\n    loadInvoices();\n    \n    // Clear selection\n    setState(prev => ({ ...prev, selectedInvoices: [] }));\n    \n    // Show success message\n    console.log(`Bulk action ${action} completed:`, results);\n  }, [loadInvoices]);\n\n  const closeModal = useCallback(() => {\n    setModalState({\n      isOpen: false,\n      mode: 'create',\n      invoice: null,\n      template: null\n    });\n  }, []);\n\n  const handleModalSubmit = useCallback(async (data: any) => {\n    try {\n      // Handle form submission based on mode\n      switch (modalState.mode) {\n        case 'create':\n          // Create new invoice or update existing if invoice is provided\n          if (modalState.invoice) {\n            console.log('Updating invoice:', data);\n          } else {\n            console.log('Creating invoice:', data);\n          }\n          break;\n        case 'quick':\n          // Create quick invoice\n          console.log('Creating quick invoice:', data);\n          break;\n        case 'template':\n          // Create invoice from template\n          console.log('Creating invoice from template:', data);\n          break;\n      }\n      \n      // Refresh invoices\n      await loadInvoices();\n      \n      // Close modal\n      closeModal();\n    } catch (error) {\n      console.error('Error submitting invoice:', error);\n    }\n  }, [modalState.mode, modalState.invoice, loadInvoices, closeModal]);\n\n  if (state.isLoading) {\n    return (\n      <div className={`invoice-management-loading ${className}`}>\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-600\">Faturalar yükleniyor...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`invoice-management-page ${className}`}>\n      {/* Header */}\n      <div className=\"page-header mb-6\">\n        <div className=\"flex justify-between items-center mb-4\">\n          <h1 className=\"text-3xl font-bold text-gray-900\">Fatura Yönetimi</h1>\n          \n          <div className=\"header-actions flex gap-3\">\n            <Button\n              onClick={handleQuickInvoice}\n              className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium\"\n              variant='default'>\n              ⚡ Hızlı Fatura\n            </Button>\n            <Button\n              onClick={handleCreateInvoice}\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium\"\n              variant='default'>\n              + Yeni Fatura\n            </Button>\n          </div>\n        </div>\n\n        {/* View Tabs */}\n        <div className=\"view-tabs border-b border-gray-200\">\n          <nav className=\"flex space-x-8\">\n            {[\n              { key: 'list', label: 'Fatura Listesi', icon: '📋' },\n              { key: 'templates', label: 'Şablonlar', icon: '📄' },\n              { key: 'bulk', label: 'Toplu İşlemler', icon: '⚡' },\n              { key: 'xml', label: 'E-Fatura XML', icon: '🏛️' }\n            ].map((tab) => (\n              <Button\n                key={tab.key}\n                onClick={() => setState(prev => ({ ...prev, currentView: tab.key as any }))}\n                className={`py-2 px-1 border-b-2 font-medium text-sm ${\n                  state.currentView === tab.key\n                    ? 'border-blue-500 text-blue-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                }`}\n                variant='default'>\n                {tab.icon} {tab.label}\n              </Button>\n            ))}\n          </nav>\n        </div>\n      </div>\n      {/* Error Display */}\n      {state.error && (\n        <div className=\"error-message bg-red-50 border border-red-200 rounded-lg p-4 mb-6\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <span className=\"text-red-400\">⚠️</span>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n              <p className=\"mt-1 text-sm text-red-700\">{state.error}</p>\n            </div>\n            <div className=\"ml-auto pl-3\">\n              <Button\n                onClick={() => setState(prev => ({ ...prev, error: null }))}\n                className=\"text-red-400 hover:text-red-600\"\n                variant='default'>\n                ✕\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n      {/* Content based on current view */}\n      {state.currentView === 'list' && (\n        <div className=\"invoice-list-view\">\n          {/* Filters */}\n          <div className=\"filters-section bg-gray-50 rounded-lg p-4 mb-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Arama\n                </label>\n                <Input\n                  type=\"text\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  placeholder=\"Fatura no, hasta adı...\"\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Durum\n                </label>\n                <Select\n                  value={statusFilter}\n                  onChange={(e) => setStatusFilter(e.target.value)}\n                  options={[\n                    { value: 'all', label: 'Tüm Durumlar' },\n                    { value: 'draft', label: 'Taslak' },\n                    { value: 'sent', label: 'Gönderildi' },\n                    { value: 'approved', label: 'Onaylandı' },\n                    { value: 'paid', label: 'Ödendi' },\n                    { value: 'cancelled', label: 'İptal' }\n                  ]}\n                  placeholder=\"Durum seçiniz\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Tip\n                </label>\n                <Select\n                  value={typeFilter}\n                  onChange={(e) => setTypeFilter(e.target.value)}\n                  options={[\n                    { value: 'all', label: 'Tüm Tipler' },\n                    { value: 'service', label: 'Hizmet' },\n                    { value: 'sale', label: 'Satış' },\n                    { value: 'proforma', label: 'Proforma' },\n                    { value: 'sgk', label: 'SGK' }\n                  ]}\n                  placeholder=\"Tip seçiniz\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div className=\"flex items-end\">\n                <Button\n                  onClick={loadInvoices}\n                  className=\"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700\"\n                  variant='default'>\n                  🔄 Yenile\n                </Button>\n              </div>\n            </div>\n          </div>\n\n          {/* Bulk Operations */}\n          {state.selectedInvoices.length > 0 && (\n            <div className=\"mb-6\">\n              <InvoiceBulkOperations\n                selectedInvoices={state.selectedInvoices}\n                onBulkActionComplete={handleBulkActionComplete}\n                onSelectionClear={() => setState(prev => ({ ...prev, selectedInvoices: [] }))}\n              />\n            </div>\n          )}\n\n          {/* Invoice Table */}\n          <div className=\"invoice-table bg-white rounded-lg shadow overflow-hidden\">\n            <div className=\"table-header bg-gray-50 px-6 py-3 border-b border-gray-200\">\n              <div className=\"flex items-center\">\n                <Input\n                  type=\"checkbox\"\n                  checked={state.selectedInvoices.length === filteredInvoices.length && filteredInvoices.length > 0}\n                  onChange={(e) => handleSelectAll(e.target.checked)}\n                  className=\"mr-3\"\n                />\n                <span className=\"font-medium text-gray-900\">\n                  {filteredInvoices.length} fatura\n                </span>\n              </div>\n            </div>\n\n            <div className=\"table-body\">\n              {filteredInvoices.length === 0 ? (\n                <div className=\"empty-state text-center py-12\">\n                  <div className=\"text-gray-400 text-6xl mb-4\">📄</div>\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                    Fatura bulunamadı\n                  </h3>\n                  <p className=\"text-gray-600 mb-4\">\n                    Arama kriterlerinizi değiştirin veya yeni fatura oluşturun\n                  </p>\n                  <Button\n                    onClick={handleCreateInvoice}\n                    className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium\"\n                    variant='default'>\n                    Yeni Fatura Oluştur\n                  </Button>\n                </div>\n              ) : (\n                filteredInvoices.map((invoice) => (\n                  <InvoiceRow\n                    key={invoice.id}\n                    invoice={invoice}\n                    selected={state.selectedInvoices.some(i => i.id === invoice.id)}\n                    onSelect={(selected) => handleInvoiceSelect(invoice, selected)}\n                    onEdit={() => handleEditInvoice(invoice)}\n                    onView={() => handleViewInvoice(invoice)}\n                  />\n                ))\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n      {state.currentView === 'templates' && (\n        <InvoiceTemplateManager\n          onTemplateSelect={handleUseTemplate}\n          onTemplateCreate={() => console.log('Template created')}\n          onTemplateUpdate={() => console.log('Template updated')}\n          onTemplateDelete={() => console.log('Template deleted')}\n        />\n      )}\n      {state.currentView === 'bulk' && (\n        <div className=\"bulk-operations-view\">\n          <div className=\"mb-6\">\n            <h2 className=\"text-xl font-bold text-gray-900 mb-2\">Toplu İşlemler</h2>\n            <p className=\"text-gray-600\">\n              Birden fazla fatura seçerek toplu işlemler gerçekleştirebilirsiniz.\n            </p>\n          </div>\n          \n          <InvoiceBulkOperations\n            selectedInvoices={state.selectedInvoices}\n            onBulkActionComplete={handleBulkActionComplete}\n            onSelectionClear={() => setState(prev => ({ ...prev, selectedInvoices: [] }))}\n          />\n        </div>\n      )}\n      {state.currentView === 'xml' && (\n        <div className=\"xml-generator-view\">\n          <div className=\"mb-6\">\n            <h2 className=\"text-xl font-bold text-gray-900 mb-2\">E-Fatura XML Oluşturucu</h2>\n            <p className=\"text-gray-600\">\n              Faturalarınızı e-fatura XML formatında oluşturun ve GİB'e gönderin.\n            </p>\n          </div>\n          \n          {state.selectedInvoices.length > 0 ? (\n            state.selectedInvoices.map(invoice => (\n              <div key={invoice.id} className=\"mb-6\">\n                <EFaturaXMLGenerator invoice={invoice} />\n              </div>\n            ))\n          ) : (\n            <div className=\"text-center py-12\">\n              <div className=\"text-gray-400 text-6xl mb-4\">🏛️</div>\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                XML oluşturmak için fatura seçin\n              </h3>\n              <p className=\"text-gray-600\">\n                Fatura listesinden XML oluşturmak istediğiniz faturaları seçin\n              </p>\n            </div>\n          )}\n        </div>\n      )}\n      {/* Invoice Modal */}\n      {modalState.isOpen && (\n        <InvoiceModal\n          isOpen={modalState.isOpen}\n          mode={modalState.mode}\n          onClose={closeModal}\n          onSuccess={handleModalSubmit}\n          initialData={modalState.invoice ? {\n            patientName: modalState.invoice.patientName,\n            invoiceNumber: modalState.invoice.invoiceNumber,\n            type: modalState.invoice.type,\n            issueDate: modalState.invoice.issueDate,\n            dueDate: modalState.invoice.dueDate,\n            items: modalState.invoice.items?.map(item => ({\n              name: item.name,\n              description: item.description,\n              quantity: item.quantity,\n              unitPrice: item.unitPrice,\n              discount: item.discount,\n              discountType: item.discountType,\n              taxRate: item.taxRate\n            })) || [],\n            notes: modalState.invoice.notes,\n            billingAddress: modalState.invoice.billingAddress\n          } : undefined}\n        />\n      )}\n    </div>\n  );\n};\n\n// Invoice Row Component\ninterface InvoiceRowProps {\n  invoice: Invoice;\n  selected: boolean;\n  onSelect: (selected: boolean) => void;\n  onEdit: () => void;\n  onView: () => void;\n}\n\nconst InvoiceRow: React.FC<InvoiceRowProps> = ({\n  invoice,\n  selected,\n  onSelect,\n  onEdit,\n  onView\n}) => {\n  const getStatusBadge = (status: string) => {\n    const statusConfig = {\n      draft: { label: 'Taslak', color: 'bg-gray-100 text-gray-800' },\n      sent: { label: 'Gönderildi', color: 'bg-blue-100 text-blue-800' },\n      approved: { label: 'Onaylandı', color: 'bg-green-100 text-green-800' },\n      rejected: { label: 'Reddedildi', color: 'bg-red-100 text-red-800' },\n      cancelled: { label: 'İptal', color: 'bg-red-100 text-red-800' },\n      paid: { label: 'Ödendi', color: 'bg-green-100 text-green-800' },\n      overdue: { label: 'Gecikmiş', color: 'bg-orange-100 text-orange-800' }\n    };\n\n    const config = statusConfig[status as keyof typeof statusConfig] || statusConfig.draft;\n    \n    return (\n      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${config.color}`}>\n        {config.label}\n      </span>\n    );\n  };\n\n  return (\n    <div className=\"invoice-row border-b border-gray-200 px-6 py-4 hover:bg-gray-50\">\n      <div className=\"flex items-center\">\n        <Input\n          type=\"checkbox\"\n          checked={selected}\n          onChange={(e) => onSelect(e.target.checked)}\n          className=\"mr-4\"\n        />\n        \n        <div className=\"flex-1 grid grid-cols-6 gap-4 items-center\">\n          <div>\n            <div className=\"font-medium text-gray-900\">{invoice.invoiceNumber}</div>\n            <div className=\"text-sm text-gray-500\">{invoice.issueDate}</div>\n          </div>\n          \n          <div>\n            <div className=\"font-medium text-gray-900\">{invoice.patientName}</div>\n            <div className=\"text-sm text-gray-500\">{invoice.patientPhone}</div>\n          </div>\n          \n          <div>\n            {getStatusBadge(invoice.status)}\n          </div>\n          \n          <div>\n            <span className=\"text-sm text-gray-500 capitalize\">{invoice.type}</span>\n          </div>\n          \n          <div className=\"text-right\">\n            <div className=\"font-medium text-gray-900\">\n              ₺{invoice.grandTotal?.toLocaleString('tr-TR', { minimumFractionDigits: 2 }) || '0.00'}\n            </div>\n            <div className=\"text-sm text-gray-500\">{invoice.currency}</div>\n          </div>\n          \n          <div className=\"flex justify-end space-x-2\">\n            <Button\n              onClick={onView}\n              className=\"p-1 text-gray-400 hover:text-blue-600\"\n              title=\"Görüntüle\"\n              variant='default'>\n              👁️\n            </Button>\n            <Button\n              onClick={onEdit}\n              className=\"p-1 text-gray-400 hover:text-blue-600\"\n              title=\"Düzenle\"\n              variant='default'>\n              ✏️\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default InvoiceManagementPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/InvoicesPage.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\n// This file has complex syntax issues that require major refactoring\n// Temporarily disabled TypeScript checking to maintain functionality\n\nimport React from 'react';\n\nexport function InvoicesPage() {\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold mb-6\">Invoices</h1>\n      <div className=\"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded\">\n        <p>⚠️ This page is temporarily disabled due to TypeScript refactoring.</p>\n        <p>Please check back later or contact the development team.</p>\n      </div>\n    </div>\n  );\n}\n\nexport default InvoicesPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/PatientDetailsPage.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AlertCircle' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'User' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Phone' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Mail' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MapPin' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatCurrency' is assigned a value but never used.","line":62,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":23},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":213,"column":9,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":219,"endColumn":18}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from '@tanstack/react-router';\nimport { \n  ArrowLeft, \n  AlertCircle, \n  Calendar, \n  Activity, \n  Shield, \n  CreditCard,\n  User,\n  Phone,\n  Mail,\n  MapPin\n} from 'lucide-react';\nimport { usePatient } from '../hooks/patient/usePatient';\nimport { usePatientDevices } from '../hooks/patient/usePatientDevices';\nimport { usePatientSales } from '../hooks/patient/usePatientSales';\nimport { usePatientTimeline } from '../hooks/patient/usePatientTimeline';\nimport { usePatientDocuments } from '../hooks/patient/usePatientDocuments';\nimport { PatientHeader } from '../components/patients/PatientHeader';\nimport { PatientTabs, type PatientTab } from '../components/patients/PatientTabs';\nimport { PatientTabContent } from '../components/patients/PatientTabContent';\nimport { ErrorMessage, NetworkError, NotFoundError } from '../components/ErrorMessage';\nimport { LoadingSpinner } from '../components/LoadingSpinner';\nimport { useGlobalError } from '../components/GlobalErrorHandler';\nimport { PATIENT_DETAILS_TAB_LEGACY } from '../constants/storage-keys';\nimport { ErrorBoundary } from '../components/common/ErrorBoundary';\n\nexport const PatientDetailsPage: React.FC = () => {\n  const { patientId } = useParams({ strict: false }) as { patientId?: string };\n  const navigate = useNavigate();\n  const { showError } = useGlobalError();\n  const [activeTab, setActiveTab] = useState<PatientTab>(() => {\n    const saved = localStorage.getItem(PATIENT_DETAILS_TAB_LEGACY);\n    return (saved as PatientTab) || 'general';\n  });\n\n  const { patient, isLoading, error } = usePatient(patientId);\n  const { devices } = usePatientDevices(patientId, patient?.devices);\n  const { sales } = usePatientSales(patientId);\n  const { timeline } = usePatientTimeline(patientId);\n  const { documents } = usePatientDocuments(patientId);\n\n  const tabCounts = {\n    devices: devices.length,\n    sales: sales.length,\n    timeline: timeline.length,\n    documents: documents.length,\n  };\n\n  // Utility functions\n  const formatDate = (dateString?: string) => {\n    if (!dateString) return 'Belirtilmemiş';\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const formatCurrency = (amount?: number) => {\n    if (!amount) return '₺0';\n    return `₺${amount.toLocaleString('tr-TR')}`;\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusMap: Record<string, { label: string; className: string }> = {\n      active: { label: 'Aktif', className: 'bg-green-100 text-green-800' },\n      inactive: { label: 'Pasif', className: 'bg-yellow-100 text-yellow-800' },\n      archived: { label: 'Arşiv', className: 'bg-gray-100 text-gray-800' },\n    };\n    const statusInfo = statusMap[status] || { label: status, className: 'bg-gray-100 text-gray-800' };\n    return (\n      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusInfo.className}`}>\n        {statusInfo.label}\n      </span>\n    );\n  };\n\n  useEffect(() => {\n    if (error) {\n      const errorMessage = typeof error === 'string' ? error : error?.message || 'Hasta bilgileri yüklenirken bir hata oluştu';\n      showError(errorMessage);\n    }\n  }, [error, showError]);\n\n  const handleTabChange = (tab: PatientTab) => {\n    setActiveTab(tab);\n    localStorage.setItem(PATIENT_DETAILS_TAB_LEGACY, tab);\n  };\n\n  const handleGoBack = () => {\n    navigate({ to: '/patients' });\n  };\n\n  const renderContent = () => {\n    if (!patientId) {\n      return <NotFoundError resource=\"hasta ID\" />;\n    }\n\n    if (isLoading) {\n      return <LoadingSpinner size=\"lg\" text=\"Hasta bilgileri yükleniyor...\" fullScreen />;\n    }\n\n    if (error) {\n      const errorMessage = typeof error === 'string' ? error : error.message || 'Hasta bilgileri yüklenirken bir hata oluştu';\n      const isNetworkError = errorMessage.includes('network') || errorMessage.includes('fetch');\n\n      if (isNetworkError) {\n        return <NetworkError onRetry={() => window.location.reload()} />;\n      }\n\n      return (\n        <ErrorMessage\n          type=\"error\"\n          title=\"Hasta Bulunamadı\"\n          message=\"Hasta bilgileri yüklenirken bir hata oluştu veya hasta bulunamadı.\"\n          onRetry={() => window.location.reload()}\n          onDismiss={handleGoBack}\n          retryText=\"Tekrar Dene\"\n        />\n      );\n    }\n\n    if (!patient) {\n      return (\n        <ErrorMessage\n          type=\"error\"\n          title=\"Hasta Bulunamadı\"\n          message=\"Belirtilen hasta bulunamadı.\"\n          onDismiss={handleGoBack}\n        />\n      );\n    }\n\n    return (\n      <>\n        {/* Patient Header */}\n        <PatientHeader patient={patient} isLoading={isLoading} />\n\n        {/* Quick Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 px-6\">\n          <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Calendar className=\"h-5 w-5 text-blue-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Kayıt Tarihi</p>\n                <p className=\"font-medium\">{formatDate(patient.createdAt)}</p>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Activity className=\"h-5 w-5 text-green-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Cihaz Sayısı</p>\n                <p className=\"font-medium\">{tabCounts.devices}</p>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Shield className=\"h-5 w-5 text-purple-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">SGK Durumu</p>\n                <p className=\"font-medium\">{patient.sgkInfo ? 'Var' : 'Yok'}</p>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <CreditCard className=\"h-5 w-5 text-red-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Durum</p>\n                <div className=\"mt-1\">{getStatusBadge(patient.status)}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Tabs */}\n        <ErrorBoundary>\n          <PatientTabs\n            patient={patient}\n            activeTab={activeTab}\n            onTabChange={handleTabChange}\n          />\n        </ErrorBoundary>\n\n        {/* Tab Content */}\n        <div className=\"bg-white\">\n          <ErrorBoundary>\n            <PatientTabContent\n              patient={patient}\n              activeTab={activeTab}\n              isLoading={isLoading}\n              tabCounts={tabCounts}\n            />\n          </ErrorBoundary>\n        </div>\n      </>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header with back button */}\n      <div className=\"bg-white border-b border-gray-200 px-6 py-4\">\n        <button\n          onClick={handleGoBack}\n          className=\"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700\"\n        >\n          <ArrowLeft className=\"w-4 h-4 mr-2\" />\n          Hasta Listesine Dön\n        </button>\n      </div>\n      {renderContent()}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/PatientsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientFilters' is defined but never used.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'filters' is assigned a value but never used.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleFiltersChange' is assigned a value but never used.","line":75,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleClearFilters' is assigned a value but never used.","line":79,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":27},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":233,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":241,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Select component from @x-ear/ui-web instead of raw <select> elements. Add data-allow-raw=\"true\" if raw select is intentional.","line":245,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":258,"endColumn":28},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":295,"column":25,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":305,"endColumn":27},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":326,"column":29,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":331,"endColumn":31}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * PatientsPage Component\n * @fileoverview Main patients management page with search, filters, and patient list\n * @version 1.0.0\n */\n\nimport React, { useState } from 'react';\nimport { Button, Input, Tabs, TabsContent, TabsList, TabsTrigger } from '@x-ear/ui-web';\nimport { useNavigate, Outlet, useParams } from '@tanstack/react-router';\nimport { usePatients } from '../hooks/usePatients';\nimport { Patient } from '../types/patient';\nimport { Users, CheckCircle, Flame, Headphones, Filter, Search, Plus, RefreshCw, Upload } from 'lucide-react';\nimport { PatientFormModal } from '../components/patients/PatientFormModal';\nimport { PatientSearchFilters } from '../components/patients/PatientSearch';\nimport { PatientFilters } from '../components/patients/PatientFilters';\nimport { Pagination } from '@x-ear/ui-web';\n\n\nexport function PatientsPage() {\n  const navigate = useNavigate();\n  const { patientId } = useParams({ strict: false }) as { patientId?: string };\n\n  // State\n  const [searchValue, setSearchValue] = useState('');\n  const [showFilters, setShowFilters] = useState(false);\n  const [selectedPatients, setSelectedPatients] = useState<string[]>([]);\n  const [showNewPatientModal, setShowNewPatientModal] = useState(false);\n  const [filters, setFilters] = useState<PatientSearchFilters>({});\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPage, setItemsPerPage] = useState(20);\n  const [statusFilter, setStatusFilter] = useState('');\n  const [segmentFilter, setSegmentFilter] = useState('');\n\n  // Hooks\n  const {\n    patients,\n    isLoading,\n    error\n  } = usePatients();\n\n  // Mock stats for now\n  const stats = {\n    total: patients?.length || 0,\n    active: patients?.filter(p => p.status === 'ACTIVE').length || 0,\n    inactive: patients?.filter(p => p.status === 'INACTIVE').length || 0,\n    withDevices: 0\n  };\n\n  // Handlers\n  const handleSearch = (value: string) => {\n    setSearchValue(value);\n  };\n\n  const handleRefresh = () => {\n    // refetch is not available in this hook, we'll use a different approach\n    window.location.reload();\n  };\n\n  const handleNewPatient = () => {\n    setShowNewPatientModal(true);\n  };\n\n  const handlePatientSelect = (patientId: string, selected: boolean) => {\n    if (selected) {\n      setSelectedPatients(prev => [...prev, patientId]);\n    } else {\n      setSelectedPatients(prev => prev.filter(id => id !== patientId));\n    }\n  };\n\n  const handleViewPatient = (patient: Patient) => {\n    navigate({ to: `/patients/${patient.id}` });\n  };\n\n  const handleFiltersChange = (newFilters: PatientSearchFilters) => {\n    setFilters(newFilters);\n  };\n\n  const handleClearFilters = () => {\n    setFilters({});\n    setSearchValue('');\n    setStatusFilter('');\n    setSegmentFilter('');\n  };\n\n  // Filtered patients based on search and filters\n  const filteredPatients = patients.filter(patient => {\n    // Search filter\n    if (searchValue) {\n      const searchLower = searchValue.toLowerCase();\n      const matchesSearch = (\n        patient.firstName?.toLowerCase().includes(searchLower) ||\n        patient.lastName?.toLowerCase().includes(searchLower) ||\n        patient.tcNumber?.includes(searchValue) ||\n        patient.phone?.includes(searchValue)\n      );\n      if (!matchesSearch) return false;\n    }\n\n    // Status filter\n    if (statusFilter && patient.status !== statusFilter) {\n      return false;\n    }\n\n    // Segment filter\n    if (segmentFilter && patient.segment !== segmentFilter) {\n      return false;\n    }\n\n    return true;\n  });\n\n  // Pagination calculations\n  const totalItems = filteredPatients.length;\n  const totalPages = Math.ceil(totalItems / itemsPerPage);\n  const startIndex = (currentPage - 1) * itemsPerPage;\n  const endIndex = startIndex + itemsPerPage;\n  const paginatedPatients = filteredPatients.slice(startIndex, endIndex);\n\n  // Pagination handlers\n  const handlePageChange = (page: number) => {\n    setCurrentPage(page);\n  };\n\n  const handleItemsPerPageChange = (newItemsPerPage: number) => {\n    setItemsPerPage(newItemsPerPage);\n    setCurrentPage(1); // Reset to first page when changing items per page\n  };\n\n  if (patientId) {\n    return <Outlet />;\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Hastalar</h1>\n          <p className=\"text-gray-600\">Hasta kayıtlarını yönetin</p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Button\n            variant=\"outline\"\n            onClick={handleRefresh}\n            disabled={isLoading}\n          >\n            <RefreshCw className={`w-4 h-4 mr-2 ${isLoading ? 'animate-spin' : ''}`} />\n            Yenile\n          </Button>\n          <Button onClick={handleNewPatient}>\n            <Plus className=\"w-4 h-4 mr-2\" />\n            Yeni Hasta\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <div className=\"bg-white p-4 rounded-lg border\">\n          <div className=\"flex items-center\">\n            <Users className=\"w-8 h-8 text-blue-500\" />\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-gray-600\">Toplam Hasta</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{stats.total}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"bg-white p-4 rounded-lg border\">\n          <div className=\"flex items-center\">\n            <CheckCircle className=\"w-8 h-8 text-green-500\" />\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-gray-600\">Aktif</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{stats.active}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"bg-white p-4 rounded-lg border\">\n          <div className=\"flex items-center\">\n            <Flame className=\"w-8 h-8 text-orange-500\" />\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-gray-600\">Pasif</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{stats.inactive}</p>\n            </div>\n          </div>\n        </div>\n        <div className=\"bg-white p-4 rounded-lg border\">\n          <div className=\"flex items-center\">\n            <Headphones className=\"w-8 h-8 text-purple-500\" />\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-gray-600\">Cihazlı</p>\n              <p className=\"text-2xl font-bold text-gray-900\">{stats.withDevices}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <Tabs defaultValue=\"list\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-1\">\n          <TabsTrigger value=\"list\">Hasta Listesi</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"list\" className=\"space-y-4\">\n          {/* Search and Filters */}\n          <div className=\"flex items-center gap-4\">\n            <div className=\"flex-1\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n                <Input\n                  placeholder=\"Hasta ara (ad, soyad, TC, telefon)...\"\n                  value={searchValue}\n                  onChange={(e) => handleSearch(e.target.value)}\n                  className=\"pl-10\"\n                />\n              </div>\n            </div>\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowFilters(!showFilters)}\n            >\n              <Filter className=\"w-4 h-4 mr-2\" />\n              Filtreler\n            </Button>\n          </div>\n\n          {/* Filters Panel */}\n          {showFilters && (\n            <div className=\"bg-white border border-gray-200 rounded-lg p-4 mb-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Durum</label>\n                  <select\n                    value={statusFilter}\n                    onChange={(e) => setStatusFilter(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  >\n                    <option value=\"\">Tümü</option>\n                    <option value=\"ACTIVE\">Aktif</option>\n                    <option value=\"INACTIVE\">Pasif</option>\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Segment</label>\n                  <select\n                    value={segmentFilter}\n                    onChange={(e) => setSegmentFilter(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  >\n                    <option value=\"\">Tümü</option>\n                    <option value=\"NEW\">Yeni</option>\n                    <option value=\"TRIAL\">Deneme</option>\n                    <option value=\"PURCHASED\">Satın Alınmış</option>\n                    <option value=\"CONTROL\">Kontrol</option>\n                    <option value=\"RENEWAL\">Yenileme</option>\n                    <option value=\"EXISTING\">Mevcut</option>\n                    <option value=\"VIP\">VIP</option>\n                  </select>\n                </div>\n                <div className=\"flex items-end\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => {\n                      setStatusFilter('');\n                      setSegmentFilter('');\n                    }}\n                    className=\"w-full\"\n                  >\n                    Filtreleri Temizle\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Patient List */}\n          <div className=\"bg-white rounded-lg border\">\n            {error && (\n              <div className=\"p-4 bg-red-50 border-b border-red-200\">\n                <p className=\"text-red-600\">Hata: {typeof error === 'string' ? error : 'Bir hata oluştu'}</p>\n              </div>\n            )}\n            \n            {isLoading ? (\n              <div className=\"p-8 text-center\">\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto\"></div>\n                <p className=\"mt-2 text-gray-600\">Hastalar yükleniyor...</p>\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-gray-50 border-b\">\n                    <tr>\n                      <th className=\"px-4 py-3 text-left\">\n                        <input\n                          type=\"checkbox\"\n                          className=\"rounded border-gray-300\"\n                          onChange={(e) => {\n                            if (e.target.checked) {\n                              setSelectedPatients(filteredPatients.map(p => p.id!));\n                            } else {\n                              setSelectedPatients([]);\n                            }\n                          }}\n                        />\n                      </th>\n                      <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-900\">Ad Soyad</th>\n                      <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-900\">TC Kimlik</th>\n                      <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-900\">Telefon</th>\n                      <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-900\">Durum</th>\n                      <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-900\">Kayıt Tarihi</th>\n                      <th className=\"px-4 py-3 text-right text-sm font-medium text-gray-900\">İşlemler</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y divide-gray-200\">\n                    {paginatedPatients.length === 0 ? (\n                      <tr>\n                        <td colSpan={7} className=\"px-4 py-8 text-center text-gray-500\">\n                          {searchValue ? 'Arama kriterlerine uygun hasta bulunamadı.' : 'Henüz hasta kaydı bulunmuyor.'}\n                        </td>\n                      </tr>\n                    ) : (\n                      paginatedPatients.map((patient) => (\n                        <tr key={patient.id} className=\"hover:bg-gray-50\">\n                          <td className=\"px-4 py-3\">\n                            <input\n                              type=\"checkbox\"\n                              className=\"rounded border-gray-300\"\n                              checked={selectedPatients.includes(patient.id!)}\n                              onChange={(e) => handlePatientSelect(patient.id!, e.target.checked)}\n                            />\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <div className=\"font-medium text-gray-900 cursor-pointer hover:text-blue-600\" onClick={() => handleViewPatient(patient)}>\n                              {patient.firstName} {patient.lastName}\n                            </div>\n                          </td>\n                          <td className=\"px-4 py-3 text-gray-600\">\n                            {patient.tcNumber}\n                          </td>\n                          <td className=\"px-4 py-3 text-gray-600\">\n                            {patient.phone}\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                              patient.status === 'ACTIVE' \n                                ? 'bg-green-100 text-green-800' \n                                : 'bg-gray-100 text-gray-800'\n                            }`}>\n                              {patient.status === 'ACTIVE' ? 'Aktif' : 'Pasif'}\n                            </span>\n                          </td>\n                          <td className=\"px-4 py-3 text-gray-600\">\n                            {patient.createdAt ? new Date(patient.createdAt).toLocaleDateString('tr-TR') : '-'}\n                          </td>\n                          <td className=\"px-4 py-3 text-right\">\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => handleViewPatient(patient)}\n                            >\n                              Görüntüle\n                            </Button>\n                          </td>\n                        </tr>\n                      ))\n                    )}\n                  </tbody>\n                </table>\n              </div>\n            )}\n\n            {/* Pagination */}\n            {totalItems > 0 && (\n              <div className=\"mt-6 flex items-center justify-between border-t border-gray-200 pt-4\">\n                <div className=\"text-sm text-gray-700\">\n                  {startIndex + 1}-{Math.min(endIndex, totalItems)} / {totalItems} hasta gösteriliyor\n                </div>\n                <Pagination\n                  currentPage={currentPage}\n                  totalPages={totalPages}\n                  totalItems={totalItems}\n                  itemsPerPage={itemsPerPage}\n                  onPageChange={handlePageChange}\n                  onItemsPerPageChange={handleItemsPerPageChange}\n                  showItemsPerPage={true}\n                  showTotalItems={false}\n                  itemsPerPageOptions={[10, 20, 50, 100]}\n                  size=\"md\"\n                />\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"bulk\" className=\"space-y-4\">\n          <div className=\"bg-white p-6 rounded-lg border\">\n            <h3 className=\"text-lg font-medium mb-4\">Toplu İşlemler</h3>\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  CSV Dosyası Yükle\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center\">\n                  <Upload className=\"mx-auto h-12 w-12 text-gray-400\" />\n                  <p className=\"mt-2 text-sm text-gray-600\">\n                    CSV dosyasını sürükleyip bırakın veya seçin\n                  </p>\n                  <Button variant=\"outline\" className=\"mt-2\">\n                    Dosya Seç\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </TabsContent>\n      </Tabs>\n\n      {/* New Patient Modal */}\n      <PatientFormModal\n        isOpen={showNewPatientModal}\n        onClose={() => setShowNewPatientModal(false)}\n        onSubmit={async (patientData) => {\n          try {\n            // Here you would typically call an API to create the patient\n            console.log('Creating new patient:', patientData);\n            // For now, just close the modal\n            setShowNewPatientModal(false);\n            // Optionally refresh the patient list\n            handleRefresh();\n            return null;\n          } catch (error) {\n            console.error('Error creating patient:', error);\n            return null;\n          }\n        }}\n        title=\"Yeni Hasta Ekle\"\n      />\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/PurchasesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleCreatePurchase' is assigned a value but never used.","line":17,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDate' is assigned a value but never used.","line":32,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatCurrency' is assigned a value but never used.","line":36,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getStatusColor' is assigned a value but never used.","line":43,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getStatusText' is assigned a value but never used.","line":55,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":22}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input, Select } from '@x-ear/ui-web';\nimport React, { useState } from 'react';\nimport { Purchase, PurchaseFilters, PurchaseStatus, PurchaseItem } from '../types/purchase';\nimport { PurchaseList } from '../components/purchases/PurchaseList';\n\nexport function PurchasesPage() {\n  const [selectedPurchase, setSelectedPurchase] = useState<Purchase | null>(null);\n  const [filters, setFilters] = useState<PurchaseFilters>({});\n  const [viewMode, setViewMode] = useState<'list' | 'form' | 'details'>('list');\n  const [showFilters, setShowFilters] = useState(false);\n\n  const handlePurchaseSelect = (purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    setViewMode('details');\n  };\n\n  const handleCreatePurchase = () => {\n    setSelectedPurchase(null);\n    setViewMode('form');\n  };\n\n  const handleEditPurchase = (purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    setViewMode('form');\n  };\n\n  const handleBackToList = () => {\n    setViewMode('list');\n    setSelectedPurchase(null);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const getStatusColor = (status: PurchaseStatus) => {\n    switch (status) {\n      case 'draft': return 'bg-gray-100 text-gray-800';\n      case 'sent': return 'bg-blue-100 text-blue-800';\n      case 'approved': return 'bg-green-100 text-green-800';\n      case 'rejected': return 'bg-red-100 text-red-800';\n      case 'paid': return 'bg-purple-100 text-purple-800';\n      case 'cancelled': return 'bg-gray-100 text-gray-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusText = (status: PurchaseStatus) => {\n    switch (status) {\n      case 'draft': return 'Taslak';\n      case 'sent': return 'Gönderildi';\n      case 'approved': return 'Onaylandı';\n      case 'rejected': return 'Reddedildi';\n      case 'paid': return 'Ödendi';\n      case 'cancelled': return 'İptal';\n      default: return status;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      {viewMode !== 'list' && (\n        <div className=\"bg-white shadow\">\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <div className=\"flex items-center justify-between h-16\">\n              <Button\n                onClick={handleBackToList}\n                className=\"flex items-center text-gray-600 hover:text-gray-900\"\n                variant='default'>\n                <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n                </svg>\n                Alışlar Listesine Dön\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n      {/* Page Header */}\n      {viewMode === 'list' && (\n        <div className=\"bg-white shadow\">\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n            <div className=\"md:flex md:items-center md:justify-between\">\n              <div className=\"flex-1 min-w-0\">\n                <div>\n                  <h1 className=\"text-2xl font-bold text-gray-900\">\n                    Alışlar\n                  </h1>\n                  <p className=\"mt-1 text-sm text-gray-500\">\n                    XML formatında gelen alış faturalarını yönetin ve takip edin\n                  </p>\n                </div>\n              </div>\n            </div>\n            \n            {/* Filter Toggle */}\n            <div className=\"mt-4 flex items-center justify-between\">\n              <Button\n                onClick={() => setShowFilters(!showFilters)}\n                className=\"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                variant='default'>\n                <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z\" />\n                </svg>\n                Filtreler\n                {showFilters ? (\n                  <svg className=\"w-4 h-4 ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 15l7-7 7 7\" />\n                  </svg>\n                ) : (\n                  <svg className=\"w-4 h-4 ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                  </svg>\n                )}\n              </Button>\n            </div>\n\n            {/* Filters Panel */}\n            {showFilters && (\n              <div className=\"mt-4 bg-gray-50 rounded-lg p-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Durum\n                    </label>\n                    <Select\n                      value={filters.status || ''}\n                      onChange={(e) => setFilters({ ...filters, status: e.target.value as PurchaseStatus || undefined })}\n                      options={[\n                        { value: '', label: 'Tümü' },\n                        { value: 'draft', label: 'Taslak' },\n                        { value: 'sent', label: 'Gönderildi' },\n                        { value: 'approved', label: 'Onaylandı' },\n                        { value: 'rejected', label: 'Reddedildi' },\n                        { value: 'paid', label: 'Ödendi' },\n                        { value: 'cancelled', label: 'İptal' }\n                      ]}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Tedarikçi\n                    </label>\n                    <Input\n                      type=\"text\"\n                      value={filters.supplierName || ''}\n                      onChange={(e) => setFilters({ ...filters, supplierName: e.target.value || undefined })}\n                      placeholder=\"Tedarikçi adı...\"\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Başlangıç Tarihi\n                    </label>\n                    <Input\n                      type=\"date\"\n                      value={filters.dateFrom || ''}\n                      onChange={(e) => setFilters({ ...filters, dateFrom: e.target.value || undefined })}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Bitiş Tarihi\n                    </label>\n                    <Input\n                      type=\"date\"\n                      value={filters.dateTo || ''}\n                      onChange={(e) => setFilters({ ...filters, dateTo: e.target.value || undefined })}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {viewMode === 'list' && (\n          <PurchaseList\n            onPurchaseSelect={handlePurchaseSelect}\n            filters={filters}\n            showActions={true}\n          />\n        )}\n\n        {viewMode === 'form' && (\n          <div className=\"bg-white shadow rounded-lg p-6\">\n            <div className=\"text-center py-12\">\n              <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n              </svg>\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Alış Faturası Formu</h3>\n              <p className=\"mt-1 text-sm text-gray-500\">\n                Alış faturası formu henüz hazır değil. XML import özelliği yakında eklenecek.\n              </p>\n            </div>\n          </div>\n        )}\n\n        {viewMode === 'details' && selectedPurchase && (\n          <PurchaseDetails\n            purchase={selectedPurchase}\n            onEdit={() => handleEditPurchase(selectedPurchase)}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\n// Purchase Details Component\ninterface PurchaseDetailsProps {\n  purchase: Purchase;\n  onEdit: () => void;\n}\n\nfunction PurchaseDetails({ purchase, onEdit }: PurchaseDetailsProps) {\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR');\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const getStatusColor = (status: PurchaseStatus) => {\n    switch (status) {\n      case 'draft': return 'bg-gray-100 text-gray-800';\n      case 'sent': return 'bg-blue-100 text-blue-800';\n      case 'approved': return 'bg-green-100 text-green-800';\n      case 'rejected': return 'bg-red-100 text-red-800';\n      case 'paid': return 'bg-purple-100 text-purple-800';\n      case 'cancelled': return 'bg-gray-100 text-gray-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusText = (status: PurchaseStatus) => {\n    switch (status) {\n      case 'draft': return 'Taslak';\n      case 'sent': return 'Gönderildi';\n      case 'approved': return 'Onaylandı';\n      case 'rejected': return 'Reddedildi';\n      case 'paid': return 'Ödendi';\n      case 'cancelled': return 'İptal';\n      default: return status;\n    }\n  };\n\n  return (\n    <div className=\"bg-white shadow overflow-hidden sm:rounded-lg\">\n      {/* Header */}\n      <div className=\"px-4 py-5 sm:px-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\n              Alış Faturası #{purchase.purchaseNumber}\n            </h3>\n            <p className=\"mt-1 max-w-2xl text-sm text-gray-500\">\n              {formatDate(purchase.createdAt)} tarihinde oluşturuldu\n            </p>\n          </div>\n          <div className=\"flex items-center space-x-3\">\n            <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(purchase.status)}`}>\n              {getStatusText(purchase.status)}\n            </span>\n            <Button\n              onClick={onEdit}\n              className=\"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n              variant='default'>\n              Düzenle\n            </Button>\n          </div>\n        </div>\n      </div>\n      {/* Content */}\n      <div className=\"px-4 py-5 sm:p-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Supplier Information */}\n          <div>\n            <h4 className=\"text-sm font-medium text-gray-900 mb-3\">Tedarikçi Bilgileri</h4>\n            <dl className=\"space-y-2\">\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Tedarikçi Adı</dt>\n                <dd className=\"text-sm text-gray-900\">{purchase.supplierName}</dd>\n              </div>\n              {purchase.supplierTaxNumber && (\n                <div>\n                  <dt className=\"text-sm font-medium text-gray-500\">Vergi No</dt>\n                  <dd className=\"text-sm text-gray-900\">{purchase.supplierTaxNumber}</dd>\n                </div>\n              )}\n              {purchase.supplierAddress && (\n                <div>\n                  <dt className=\"text-sm font-medium text-gray-500\">Adres</dt>\n                  <dd className=\"text-sm text-gray-900\">{purchase.supplierAddress}</dd>\n                </div>\n              )}\n            </dl>\n          </div>\n\n          {/* Purchase Information */}\n          <div>\n            <h4 className=\"text-sm font-medium text-gray-900 mb-3\">Fatura Bilgileri</h4>\n            <dl className=\"space-y-2\">\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Fatura Tarihi</dt>\n                <dd className=\"text-sm text-gray-900\">{formatDate(purchase.issueDate)}</dd>\n              </div>\n              {purchase.dueDate && (\n                <div>\n                  <dt className=\"text-sm font-medium text-gray-500\">Vade Tarihi</dt>\n                  <dd className=\"text-sm text-gray-900\">{formatDate(purchase.dueDate)}</dd>\n                </div>\n              )}\n              <div>\n                <dt className=\"text-sm font-medium text-gray-500\">Toplam Tutar</dt>\n                <dd className=\"text-sm text-gray-900 font-medium\">{formatCurrency(purchase.grandTotal)}</dd>\n              </div>\n            </dl>\n          </div>\n        </div>\n\n        {/* Purchase Items */}\n        <div className=\"mt-8\">\n          <h4 className=\"text-sm font-medium text-gray-900 mb-4\">Fatura Kalemleri</h4>\n          <div className=\"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg\">\n            <table className=\"min-w-full divide-y divide-gray-300\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Ürün/Hizmet\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Miktar\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Birim Fiyat\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    KDV\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Toplam\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {purchase.items.map((item: PurchaseItem) => (\n                  <tr key={item.id}>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div>\n                        <div className=\"text-sm font-medium text-gray-900\">{item.name}</div>\n                        {item.description && (\n                          <div className=\"text-sm text-gray-500\">{item.description}</div>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {item.quantity}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {formatCurrency(item.unitPrice)}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      %{item.taxRate}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {formatCurrency(item.totalPrice)}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/* Totals */}\n        <div className=\"mt-6 flex justify-end\">\n          <div className=\"w-full max-w-sm\">\n            <dl className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <dt className=\"text-sm text-gray-600\">Ara Toplam:</dt>\n                <dd className=\"text-sm text-gray-900\">{formatCurrency(purchase.subtotal)}</dd>\n              </div>\n              <div className=\"flex justify-between\">\n                <dt className=\"text-sm text-gray-600\">KDV:</dt>\n                <dd className=\"text-sm text-gray-900\">{formatCurrency(purchase.taxTotal)}</dd>\n              </div>\n              <div className=\"flex justify-between border-t border-gray-200 pt-2\">\n                <dt className=\"text-base font-medium text-gray-900\">Genel Toplam:</dt>\n                <dd className=\"text-base font-medium text-gray-900\">{formatCurrency(purchase.grandTotal)}</dd>\n              </div>\n            </dl>\n          </div>\n        </div>\n\n        {/* Notes */}\n        {purchase.notes && (\n          <div className=\"mt-6\">\n            <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Notlar</h4>\n            <p className=\"text-sm text-gray-600\">{purchase.notes}</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default PurchasesPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/ReportsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DatePicker' is defined but never used.","line":15,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used.","line":87,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":129,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3006,3009],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3006,3009],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Button component from @x-ear/ui-web instead of raw <button> elements. Add data-allow-raw=\"true\" if raw button is intentional.","line":274,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":285,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":276,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8399,8402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8399,8402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { \n  TrendingUp, \n  DollarSign, \n  Calendar, \n  Users, \n  CreditCard, \n  FileText,\n  Download,\n  Filter,\n  BarChart3,\n  PieChart,\n  Activity\n} from 'lucide-react';\nimport { Button, Input, Select, DatePicker } from '@x-ear/ui-web';\nimport { KPICard } from '../components/dashboard/KPICard';\n\ninterface ReportFilters {\n  dateRange: {\n    start: string;\n    end: string;\n  };\n  branch?: string;\n  paymentMethod?: string;\n  saleType?: string;\n  sgkStatus?: string;\n}\n\ninterface SalesMetrics {\n  totalRevenue: number;\n  totalSales: number;\n  averageOrderValue: number;\n  totalPaid: number;\n  totalPending: number;\n  sgkSupport: number;\n  completionRate: number;\n  paymentMethods: {\n    cash: number;\n    card: number;\n    installment: number;\n    transfer: number;\n    sgk: number;\n  };\n}\n\ninterface PaymentMetrics {\n  totalCollected: number;\n  pendingPayments: number;\n  overduePayments: number;\n  installmentPayments: number;\n  promissoryNotes: number;\n  collectionRate: number;\n}\n\nexport const ReportsPage: React.FC = () => {\n  const [activeTab, setActiveTab] = useState<'overview' | 'sales' | 'payments' | 'analytics'>('overview');\n  const [filters, setFilters] = useState<ReportFilters>({\n    dateRange: {\n      start: new Date(new Date().getFullYear(), new Date().getMonth(), 1).toISOString().split('T')[0],\n      end: new Date().toISOString().split('T')[0]\n    }\n  });\n  const [salesMetrics, setSalesMetrics] = useState<SalesMetrics>({\n    totalRevenue: 0,\n    totalSales: 0,\n    averageOrderValue: 0,\n    totalPaid: 0,\n    totalPending: 0,\n    sgkSupport: 0,\n    completionRate: 0,\n    paymentMethods: {\n      cash: 0,\n      card: 0,\n      installment: 0,\n      transfer: 0,\n      sgk: 0\n    }\n  });\n  const [paymentMetrics, setPaymentMetrics] = useState<PaymentMetrics>({\n    totalCollected: 0,\n    pendingPayments: 0,\n    overduePayments: 0,\n    installmentPayments: 0,\n    promissoryNotes: 0,\n    collectionRate: 0\n  });\n  const [loading, setLoading] = useState(false);\n\n  // Mock data for demonstration\n  useEffect(() => {\n    loadReportData();\n  }, [filters]);\n\n  const loadReportData = async () => {\n    setLoading(true);\n    \n    // Simulate API call with mock data\n    setTimeout(() => {\n      setSalesMetrics({\n        totalRevenue: 2450000,\n        totalSales: 156,\n        averageOrderValue: 15705,\n        totalPaid: 1890000,\n        totalPending: 560000,\n        sgkSupport: 980000,\n        completionRate: 77.1,\n        paymentMethods: {\n          cash: 450000,\n          card: 680000,\n          installment: 520000,\n          transfer: 240000,\n          sgk: 560000\n        }\n      });\n\n      setPaymentMetrics({\n        totalCollected: 1890000,\n        pendingPayments: 560000,\n        overduePayments: 125000,\n        installmentPayments: 340000,\n        promissoryNotes: 95000,\n        collectionRate: 77.1\n      });\n\n      setLoading(false);\n    }, 1000);\n  };\n\n  const handleFilterChange = (key: keyof ReportFilters, value: any) => {\n    setFilters(prev => ({\n      ...prev,\n      [key]: value\n    }));\n  };\n\n  const exportReport = (format: 'pdf' | 'excel' | 'csv') => {\n    console.log(`Exporting report as ${format}`);\n    // TODO: Implement actual export functionality\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY',\n      minimumFractionDigits: 0\n    }).format(amount);\n  };\n\n  const formatPercentage = (value: number) => {\n    return `%${value.toFixed(1)}`;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"md:flex md:items-center md:justify-between\">\n            <div className=\"flex-1 min-w-0\">\n              <h1 className=\"text-2xl font-bold text-gray-900\">Raporlar ve Analizler</h1>\n              <p className=\"mt-1 text-sm text-gray-500\">\n                Satış performansı ve ödeme takibi raporları\n              </p>\n            </div>\n            <div className=\"mt-4 flex md:mt-0 md:ml-4 space-x-3\">\n              <Button\n                onClick={() => exportReport('pdf')}\n                variant=\"outline\"\n                icon={<Download className=\"w-4 h-4\" />}\n              >\n                PDF İndir\n              </Button>\n              <Button\n                onClick={() => exportReport('excel')}\n                variant=\"outline\"\n                icon={<Download className=\"w-4 h-4\" />}\n              >\n                Excel İndir\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n        <div className=\"bg-white rounded-lg shadow p-6 mb-6\">\n          <div className=\"flex items-center mb-4\">\n            <Filter className=\"w-5 h-5 text-gray-500 mr-2\" />\n            <h3 className=\"text-lg font-medium text-gray-900\">Filtreler</h3>\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Başlangıç Tarihi\n              </label>\n              <Input\n                type=\"date\"\n                value={filters.dateRange.start}\n                onChange={(e) => handleFilterChange('dateRange', {\n                  ...filters.dateRange,\n                  start: e.target.value\n                })}\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Bitiş Tarihi\n              </label>\n              <Input\n                type=\"date\"\n                value={filters.dateRange.end}\n                onChange={(e) => handleFilterChange('dateRange', {\n                  ...filters.dateRange,\n                  end: e.target.value\n                })}\n              />\n            </div>\n            <div>\n              <Select\n                label=\"Şube\"\n                value={filters.branch || ''}\n                onChange={(e) => handleFilterChange('branch', e.target.value)}\n                options={[\n                  { value: '', label: 'Tüm Şubeler' },\n                  { value: 'merkez', label: 'Merkez Şube' },\n                  { value: 'kadikoy', label: 'Kadıköy Şube' },\n                  { value: 'besiktas', label: 'Beşiktaş Şube' }\n                ]}\n              />\n            </div>\n            <div>\n              <Select\n                label=\"Ödeme Yöntemi\"\n                value={filters.paymentMethod || ''}\n                onChange={(e) => handleFilterChange('paymentMethod', e.target.value)}\n                options={[\n                  { value: '', label: 'Tüm Yöntemler' },\n                  { value: 'cash', label: 'Nakit' },\n                  { value: 'card', label: 'Kart' },\n                  { value: 'installment', label: 'Taksit' },\n                  { value: 'transfer', label: 'Havale' },\n                  { value: 'sgk', label: 'SGK' }\n                ]}\n              />\n            </div>\n            <div>\n              <Select\n                label=\"SGK Durumu\"\n                value={filters.sgkStatus || ''}\n                onChange={(e) => handleFilterChange('sgkStatus', e.target.value)}\n                options={[\n                  { value: '', label: 'Tümü' },\n                  { value: 'with_sgk', label: 'SGK Destekli' },\n                  { value: 'without_sgk', label: 'SGK Desteksiz' }\n                ]}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Tabs */}\n        <div className=\"bg-white rounded-lg shadow mb-6\">\n          <div className=\"border-b border-gray-200\">\n            <nav className=\"-mb-px flex space-x-8 px-6\">\n              {[\n                { id: 'overview', label: 'Genel Bakış', icon: BarChart3 },\n                { id: 'sales', label: 'Satış Performansı', icon: TrendingUp },\n                { id: 'payments', label: 'Ödeme Takibi', icon: CreditCard },\n                { id: 'analytics', label: 'Detaylı Analiz', icon: PieChart }\n              ].map(tab => {\n                const Icon = tab.icon;\n                return (\n                  <button\n                    key={tab.id}\n                    onClick={() => setActiveTab(tab.id as any)}\n                    className={`${\n                      activeTab === tab.id\n                        ? 'border-blue-500 text-blue-600'\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                    } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`}\n                  >\n                    <Icon className=\"w-4 h-4 mr-2\" />\n                    {tab.label}\n                  </button>\n                );\n              })}\n            </nav>\n          </div>\n\n          {/* Tab Content */}\n          <div className=\"p-6\">\n            {activeTab === 'overview' && (\n              <div className=\"space-y-6\">\n                {/* KPI Cards */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                  <KPICard\n                    title=\"Toplam Ciro\"\n                    value={formatCurrency(salesMetrics.totalRevenue)}\n                    icon={DollarSign}\n                    color=\"green\"\n                    trend={{ value: \"+12.5%\", direction: \"up\" }}\n                  />\n                  <KPICard\n                    title=\"Toplam Satış\"\n                    value={salesMetrics.totalSales}\n                    icon={FileText}\n                    color=\"blue\"\n                    trend={{ value: \"+8.3%\", direction: \"up\" }}\n                  />\n                  <KPICard\n                    title=\"Tahsilat Oranı\"\n                    value={formatPercentage(paymentMetrics.collectionRate)}\n                    icon={Activity}\n                    color=\"purple\"\n                    trend={{ value: \"+2.1%\", direction: \"up\" }}\n                  />\n                  <KPICard\n                    title=\"Ortalama Satış\"\n                    value={formatCurrency(salesMetrics.averageOrderValue)}\n                    icon={TrendingUp}\n                    color=\"yellow\"\n                    trend={{ value: \"+5.7%\", direction: \"up\" }}\n                  />\n                </div>\n\n                {/* Quick Stats */}\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                  <div className=\"bg-gray-50 rounded-lg p-6\">\n                    <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Satış Özeti</h3>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Toplam Ciro:</span>\n                        <span className=\"font-medium\">{formatCurrency(salesMetrics.totalRevenue)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Tahsil Edilen:</span>\n                        <span className=\"font-medium text-green-600\">{formatCurrency(salesMetrics.totalPaid)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Bekleyen:</span>\n                        <span className=\"font-medium text-yellow-600\">{formatCurrency(salesMetrics.totalPending)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">SGK Desteği:</span>\n                        <span className=\"font-medium text-blue-600\">{formatCurrency(salesMetrics.sgkSupport)}</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-gray-50 rounded-lg p-6\">\n                    <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Ödeme Yöntemleri</h3>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Nakit:</span>\n                        <span className=\"font-medium\">{formatCurrency(salesMetrics.paymentMethods.cash)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Kart:</span>\n                        <span className=\"font-medium\">{formatCurrency(salesMetrics.paymentMethods.card)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Taksit:</span>\n                        <span className=\"font-medium\">{formatCurrency(salesMetrics.paymentMethods.installment)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Havale:</span>\n                        <span className=\"font-medium\">{formatCurrency(salesMetrics.paymentMethods.transfer)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">SGK:</span>\n                        <span className=\"font-medium\">{formatCurrency(salesMetrics.paymentMethods.sgk)}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'sales' && (\n              <div className=\"space-y-6\">\n                <h3 className=\"text-lg font-medium text-gray-900\">Satış Performansı Analizi</h3>\n                \n                {/* Sales Performance Cards */}\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                  <div className=\"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6\">\n                    <div className=\"flex items-center\">\n                      <TrendingUp className=\"w-8 h-8 text-blue-600 mr-3\" />\n                      <div>\n                        <p className=\"text-sm text-blue-600\">Aylık Büyüme</p>\n                        <p className=\"text-2xl font-bold text-blue-900\">+12.5%</p>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-6\">\n                    <div className=\"flex items-center\">\n                      <Users className=\"w-8 h-8 text-green-600 mr-3\" />\n                      <div>\n                        <p className=\"text-sm text-green-600\">Yeni Müşteriler</p>\n                        <p className=\"text-2xl font-bold text-green-900\">47</p>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-6\">\n                    <div className=\"flex items-center\">\n                      <Calendar className=\"w-8 h-8 text-purple-600 mr-3\" />\n                      <div>\n                        <p className=\"text-sm text-purple-600\">Günlük Ortalama</p>\n                        <p className=\"text-2xl font-bold text-purple-900\">{formatCurrency(salesMetrics.totalRevenue / 30)}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Sales Chart Placeholder */}\n                <div className=\"bg-white border-2 border-dashed border-gray-300 rounded-lg p-8 text-center\">\n                  <BarChart3 className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                  <h4 className=\"text-lg font-medium text-gray-900 mb-2\">Satış Trendi Grafiği</h4>\n                  <p className=\"text-gray-500\">Günlük, haftalık ve aylık satış trendlerini görüntüleyin</p>\n                  <Button className=\"mt-4\" variant=\"outline\">\n                    Grafik Görünümü\n                  </Button>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'payments' && (\n              <div className=\"space-y-6\">\n                <h3 className=\"text-lg font-medium text-gray-900\">Ödeme Takibi ve Tahsilat</h3>\n                \n                {/* Payment Metrics */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                  <div className=\"bg-green-50 rounded-lg p-6\">\n                    <div className=\"flex items-center\">\n                      <DollarSign className=\"w-6 h-6 text-green-500 mr-3\" />\n                      <div>\n                        <p className=\"text-sm text-green-600\">Tahsil Edilen</p>\n                        <p className=\"text-xl font-bold text-green-900\">\n                          {formatCurrency(paymentMetrics.totalCollected)}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"bg-yellow-50 rounded-lg p-6\">\n                    <div className=\"flex items-center\">\n                      <Calendar className=\"w-6 h-6 text-yellow-500 mr-3\" />\n                      <div>\n                        <p className=\"text-sm text-yellow-600\">Bekleyen Ödemeler</p>\n                        <p className=\"text-xl font-bold text-yellow-900\">\n                          {formatCurrency(paymentMetrics.pendingPayments)}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"bg-red-50 rounded-lg p-6\">\n                    <div className=\"flex items-center\">\n                      <Activity className=\"w-6 h-6 text-red-500 mr-3\" />\n                      <div>\n                        <p className=\"text-sm text-red-600\">Geciken Ödemeler</p>\n                        <p className=\"text-xl font-bold text-red-900\">\n                          {formatCurrency(paymentMetrics.overduePayments)}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"bg-blue-50 rounded-lg p-6\">\n                    <div className=\"flex items-center\">\n                      <CreditCard className=\"w-6 h-6 text-blue-500 mr-3\" />\n                      <div>\n                        <p className=\"text-sm text-blue-600\">Taksitli Ödemeler</p>\n                        <p className=\"text-xl font-bold text-blue-900\">\n                          {formatCurrency(paymentMetrics.installmentPayments)}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Payment Details */}\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                  <div className=\"bg-white border rounded-lg p-6\">\n                    <h4 className=\"text-lg font-medium text-gray-900 mb-4\">Tahsilat Durumu</h4>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-gray-600\">Tahsilat Oranı</span>\n                        <span className=\"text-lg font-semibold text-green-600\">\n                          {formatPercentage(paymentMetrics.collectionRate)}\n                        </span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div \n                          className=\"bg-green-600 h-2 rounded-full\" \n                          style={{ width: `${paymentMetrics.collectionRate}%` }}\n                        ></div>\n                      </div>\n                      <div className=\"text-sm text-gray-500\">\n                        Hedef: %85 (Mevcut: {formatPercentage(paymentMetrics.collectionRate)})\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"bg-white border rounded-lg p-6\">\n                    <h4 className=\"text-lg font-medium text-gray-900 mb-4\">Senet Takibi</h4>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Toplam Senet:</span>\n                        <span className=\"font-medium\">{formatCurrency(paymentMetrics.promissoryNotes)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Vadesi Gelen:</span>\n                        <span className=\"font-medium text-yellow-600\">{formatCurrency(45000)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Vadesi Geçen:</span>\n                        <span className=\"font-medium text-red-600\">{formatCurrency(15000)}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'analytics' && (\n              <div className=\"space-y-6\">\n                <h3 className=\"text-lg font-medium text-gray-900\">Detaylı Analiz ve İstatistikler</h3>\n                \n                {/* Analytics Placeholder */}\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                  <div className=\"bg-white border-2 border-dashed border-gray-300 rounded-lg p-8 text-center\">\n                    <PieChart className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                    <h4 className=\"text-lg font-medium text-gray-900 mb-2\">Ürün Kategorisi Analizi</h4>\n                    <p className=\"text-gray-500\">En çok satan ürün kategorilerini görüntüleyin</p>\n                  </div>\n                  \n                  <div className=\"bg-white border-2 border-dashed border-gray-300 rounded-lg p-8 text-center\">\n                    <BarChart3 className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                    <h4 className=\"text-lg font-medium text-gray-900 mb-2\">Müşteri Segmentasyonu</h4>\n                    <p className=\"text-gray-500\">Müşteri gruplarına göre satış analizi</p>\n                  </div>\n                </div>\n\n                {/* Advanced Metrics */}\n                <div className=\"bg-gray-50 rounded-lg p-6\">\n                  <h4 className=\"text-lg font-medium text-gray-900 mb-4\">Gelişmiş Metrikler</h4>\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"text-center\">\n                      <p className=\"text-2xl font-bold text-blue-600\">4.2</p>\n                      <p className=\"text-sm text-gray-600\">Ortalama Müşteri Puanı</p>\n                    </div>\n                    <div className=\"text-center\">\n                      <p className=\"text-2xl font-bold text-green-600\">68%</p>\n                      <p className=\"text-sm text-gray-600\">Müşteri Memnuniyeti</p>\n                    </div>\n                    <div className=\"text-center\">\n                      <p className=\"text-2xl font-bold text-purple-600\">23%</p>\n                      <p className=\"text-sm text-gray-600\">Tekrar Satış Oranı</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ReportsPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/SGKPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_setFilters' is assigned a value but never used.","line":24,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_value' is defined but never used.","line":112,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":112,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_documentId' is defined but never used.","line":234,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_status' is defined but never used.","line":234,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":54}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// SGK Page Component\n// Main page for SGK document management, workflow, and e-receipt processing\n\nimport React, { useState, useEffect } from 'react';\nimport { \n  SGKDocument, \n  SGKStats, \n  SGKDocumentFilters,\n  SGKWorkflow as SGKWorkflowType\n} from '../types/sgk';\nimport { sgkService } from '../services/sgk.service';\nimport { SGKDocumentList } from '../components/SGKDocumentList';\nimport { SGKWorkflow } from '../components/SGKWorkflow';\nimport { SGKUpload } from '../components/SGKUpload';\nimport { Button } from '@x-ear/ui-web';\n\ntype TabType = 'documents' | 'upload' | 'stats' | 'workflow';\n\nexport const SGKPage: React.FC = () => {\n  const [activeTab, setActiveTab] = useState<TabType>('documents');\n  const [stats, setStats] = useState<SGKStats | null>(null);\n  const [selectedDocument, setSelectedDocument] = useState<SGKDocument | null>(null);\n  const [selectedWorkflow, setSelectedWorkflow] = useState<SGKWorkflowType | null>(null);\n  const [filters, _setFilters] = useState<SGKDocumentFilters>({});\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [refreshKey, setRefreshKey] = useState(0);\n\n  useEffect(() => {\n    loadStats();\n  }, [refreshKey]);\n\n  const loadStats = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const statsData = await sgkService.getStats();\n      setStats(statsData);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load stats');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDocumentSelect = async (document: SGKDocument) => {\n    setSelectedDocument(document);\n    \n    // Load workflow for the document\n    try {\n      const workflow = await sgkService.getWorkflow(document.id);\n      setSelectedWorkflow(workflow);\n      setActiveTab('workflow');\n    } catch (err) {\n      console.error('Failed to load workflow:', err);\n    }\n  };\n\n  const handleUploadComplete = (document: SGKDocument) => {\n    setRefreshKey(prev => prev + 1);\n    setSelectedDocument(document);\n    setActiveTab('documents');\n  };\n\n  const handleUploadError = (error: string) => {\n    setError(error);\n  };\n\n  const handleWorkflowUpdate = (workflow: SGKWorkflowType) => {\n    setSelectedWorkflow(workflow);\n    setRefreshKey(prev => prev + 1);\n  };\n\n  const getTabIcon = (tab: TabType) => {\n    switch (tab) {\n      case 'documents':\n        return (\n          <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n          </svg>\n        );\n      case 'upload':\n        return (\n          <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\" />\n          </svg>\n        );\n      case 'stats':\n        return (\n          <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\n          </svg>\n        );\n      case 'workflow':\n        return (\n          <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4\" />\n          </svg>\n        );\n      default:\n        return null;\n    }\n  };\n\n  const formatCurrency = (amount: number): string => {\n    return new Intl.NumberFormat('tr-TR', {\n      style: 'currency',\n      currency: 'TRY'\n    }).format(amount);\n  };\n\n  const getStatusColor = (status: string, _value: number): string => {\n    if (status === 'rejected' || status === 'cancelled') return 'text-red-600';\n    if (status === 'approved' || status === 'completed') return 'text-green-600';\n    if (status === 'under_review' || status === 'submitted') return 'text-yellow-600';\n    if (status === 'paid') return 'text-purple-600';\n    return 'text-gray-600';\n  };\n\n  if (loading && !stats) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n        <span className=\"ml-3 text-lg text-gray-600\">SGK verileri yükleniyor...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center py-6\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900\">SGK Yönetimi</h1>\n              <p className=\"mt-1 text-sm text-gray-500\">\n                Belge yönetimi, iş akışı ve e-reçete işlemleri\n              </p>\n            </div>\n            \n            {/* Quick Stats */}\n            {stats && (\n              <div className=\"flex space-x-6\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-blue-600\">{stats.totalDocuments}</div>\n                  <div className=\"text-xs text-gray-500\">Toplam Belge</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-yellow-600\">{stats.pendingApprovals}</div>\n                  <div className=\"text-xs text-gray-500\">Bekleyen Onay</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-green-600\">{formatCurrency(stats.totalValue)}</div>\n                  <div className=\"text-xs text-gray-500\">Toplam Değer</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-purple-600\">{Math.round(stats.approvalRate)}%</div>\n                  <div className=\"text-xs text-gray-500\">Onay Oranı</div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n      {/* Error Banner */}\n      {error && (\n        <div className=\"bg-red-50 border-l-4 border-red-400 p-4\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm text-red-700\">{error}</p>\n            </div>\n            <div className=\"ml-auto pl-3\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setError(null)}\n                className=\"text-red-400 hover:text-red-600\"\n              >\n                <svg className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                </svg>\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n      {/* Navigation Tabs */}\n      <div className=\"bg-white border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <nav className=\"-mb-px flex space-x-8\">\n            {[\n              { id: 'documents', label: 'Belgeler' },\n              { id: 'upload', label: 'Yükle' },\n              { id: 'workflow', label: 'İş Akışı' },\n              { id: 'stats', label: 'İstatistikler' }\n            ].map((tab) => (\n              <Button\n                key={tab.id}\n                variant=\"ghost\"\n                onClick={() => setActiveTab(tab.id as TabType)}\n                className={`${\n                  activeTab === tab.id\n                    ? 'border-blue-500 text-blue-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2`}\n              >\n                {getTabIcon(tab.id as TabType)}\n                <span>{tab.label}</span>\n              </Button>\n            ))}\n          </nav>\n        </div>\n      </div>\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {activeTab === 'documents' && (\n          <div className=\"space-y-6\">\n            <SGKDocumentList\n              filters={filters}\n              onDocumentSelect={handleDocumentSelect}\n              onDocumentEdit={(document) => {\n                setSelectedDocument(document);\n                // Could open edit modal here\n              }}\n              onDocumentDelete={() => {\n                setRefreshKey(prev => prev + 1);\n              }}\n              onWorkflowUpdate={(_documentId, _status) => {\n                setRefreshKey(prev => prev + 1);\n              }}\n            />\n          </div>\n        )}\n\n        {activeTab === 'upload' && (\n          <div className=\"max-w-2xl mx-auto\">\n            <div className=\"bg-white shadow rounded-lg p-6\">\n              <h2 className=\"text-lg font-medium text-gray-900 mb-6\">Yeni Belge Yükle</h2>\n              <SGKUpload\n                onUploadComplete={handleUploadComplete}\n                onUploadError={handleUploadError}\n                autoProcess={true}\n              />\n            </div>\n          </div>\n        )}\n\n        {activeTab === 'workflow' && (\n          <div className=\"space-y-6\">\n            {selectedDocument ? (\n              <div>\n                <div className=\"bg-white shadow rounded-lg p-6 mb-6\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div>\n                      <h2 className=\"text-lg font-medium text-gray-900\">\n                        İş Akışı: {selectedDocument.filename}\n                      </h2>\n                      <p className=\"text-sm text-gray-500\">\n                        Belge ID: {selectedDocument.id}\n                      </p>\n                    </div>\n                    <Button\n                      onClick={() => {\n                        setSelectedDocument(null);\n                        setSelectedWorkflow(null);\n                      }}\n                      className=\"text-gray-400 hover:text-gray-600\"\n                      variant='default'>\n                      <svg className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                      </svg>\n                    </Button>\n                  </div>\n                  \n                  <SGKWorkflow\n                    document={selectedDocument}\n                    workflow={selectedWorkflow || undefined}\n                    onWorkflowUpdate={handleWorkflowUpdate}\n                  />\n                </div>\n              </div>\n            ) : (\n              <div className=\"bg-white shadow rounded-lg p-12\">\n                <div className=\"text-center\">\n                  <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4\" />\n                  </svg>\n                  <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Belge seçilmedi</h3>\n                  <p className=\"mt-1 text-sm text-gray-500\">\n                    İş akışını görüntülemek için bir belge seçin.\n                  </p>\n                  <div className=\"mt-6\">\n                    <Button\n                      onClick={() => setActiveTab('documents')}\n                      className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                      variant='default'>\n                      Belgelere Git\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {activeTab === 'stats' && stats && (\n          <div className=\"space-y-6\">\n            {/* Overview Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <div className=\"bg-white overflow-hidden shadow rounded-lg\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <svg className=\"h-6 w-6 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                      </svg>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Toplam Belge</dt>\n                        <dd className=\"text-lg font-medium text-gray-900\">{stats.totalDocuments}</dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-white overflow-hidden shadow rounded-lg\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <svg className=\"h-6 w-6 text-yellow-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Bekleyen Onay</dt>\n                        <dd className=\"text-lg font-medium text-gray-900\">{stats.pendingApprovals}</dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-white overflow-hidden shadow rounded-lg\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <svg className=\"h-6 w-6 text-green-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1\" />\n                      </svg>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Toplam Değer</dt>\n                        <dd className=\"text-lg font-medium text-gray-900\">{formatCurrency(stats.totalValue)}</dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-white overflow-hidden shadow rounded-lg\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <svg className=\"h-6 w-6 text-purple-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\n                      </svg>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Onay Oranı</dt>\n                        <dd className=\"text-lg font-medium text-gray-900\">{Math.round(stats.approvalRate)}%</dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Document Types */}\n            <div className=\"bg-white shadow rounded-lg\">\n              <div className=\"px-4 py-5 sm:p-6\">\n                <h3 className=\"text-lg leading-6 font-medium text-gray-900 mb-4\">\n                  Belge Türleri\n                </h3>\n                <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4\">\n                  {Object.entries(stats.byType).map(([type, count]) => (\n                    <div key={type} className=\"text-center\">\n                      <div className=\"text-2xl font-bold text-blue-600\">{count}</div>\n                      <div className=\"text-sm text-gray-500 capitalize\">\n                        {type === 'recete' ? 'E-Reçete' :\n                         type === 'rapor' ? 'Rapor' :\n                         type === 'belge' ? 'Belge' :\n                         type === 'fatura' ? 'Fatura' :\n                         type === 'teslim' ? 'Teslim' :\n                         type === 'iade' ? 'İade' : type}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* Status Distribution */}\n            <div className=\"bg-white shadow rounded-lg\">\n              <div className=\"px-4 py-5 sm:p-6\">\n                <h3 className=\"text-lg leading-6 font-medium text-gray-900 mb-4\">\n                  Durum Dağılımı\n                </h3>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4\">\n                  {Object.entries(stats.byStatus).map(([status, count]) => (\n                    <div key={status} className=\"text-center\">\n                      <div className={`text-2xl font-bold ${getStatusColor(status, count)}`}>\n                        {count}\n                      </div>\n                      <div className=\"text-sm text-gray-500 capitalize\">\n                        {status === 'draft' ? 'Taslak' :\n                         status === 'submitted' ? 'Gönderildi' :\n                         status === 'under_review' ? 'İnceleniyor' :\n                         status === 'approved' ? 'Onaylandı' :\n                         status === 'rejected' ? 'Reddedildi' :\n                         status === 'paid' ? 'Ödendi' :\n                         status === 'completed' ? 'Tamamlandı' :\n                         status === 'cancelled' ? 'İptal' : status}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/TestPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'index' is defined but never used.","line":82,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Input } from '@x-ear/ui-web';\nimport React from 'react';\nimport { useFuzzySearch, useFileUpload } from '@x-ear/core';\n\ninterface TestItem {\n  id: string;\n  name: string;\n  category: string;\n  description: string;\n}\n\nconst sampleData: TestItem[] = [\n  { id: '1', name: 'iPhone 14 Pro', category: 'Telefon', description: 'Apple iPhone 14 Pro 128GB' },\n  { id: '2', name: 'Samsung Galaxy S23', category: 'Telefon', description: 'Samsung Galaxy S23 256GB' },\n  { id: '3', name: 'MacBook Air M2', category: 'Laptop', description: 'Apple MacBook Air M2 13 inç' },\n  { id: '4', name: 'Dell XPS 13', category: 'Laptop', description: 'Dell XPS 13 Intel i7' },\n  { id: '5', name: 'iPad Pro', category: 'Tablet', description: 'Apple iPad Pro 11 inç' },\n  { id: '6', name: 'AirPods Pro', category: 'Kulaklık', description: 'Apple AirPods Pro 2. nesil' },\n  { id: '7', name: 'Sony WH-1000XM4', category: 'Kulaklık', description: 'Sony WH-1000XM4 Kablosuz Kulaklık' },\n  { id: '8', name: 'Nintendo Switch', category: 'Oyun Konsolu', description: 'Nintendo Switch OLED Model' },\n];\n\nexport const TestPage: React.FC = () => {\n  // Fuzzy search hook'unu test et\n  const { results, query, setQuery, isSearching } = useFuzzySearch(sampleData, {\n    keys: ['name', 'category', 'description'],\n    threshold: 0.3,\n    includeScore: true,\n  });\n\n  // File upload hook'unu test et\n  const { state: fileState, actions: fileActions } = useFileUpload({\n    maxFileSize: 5 * 1024 * 1024, // 5MB\n    allowedTypes: ['.csv', '.xlsx', '.xls'],\n    parseOptions: {\n      hasHeaders: true,\n      delimiter: ',',\n      encoding: 'utf-8'\n    }\n  });\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      fileActions.uploadFile(file);\n    }\n  };\n\n  const previewData = fileActions.getPreviewData(5);\n\n  return (\n    <div className=\"container mx-auto px-4 py-8 max-w-6xl\">\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">\n        Core Paket Test Sayfası\n      </h1>\n      {/* Fuzzy Search Test */}\n      <div className=\"bg-white rounded-lg shadow-md p-6 mb-8\">\n        <h2 className=\"text-2xl font-semibold text-gray-800 mb-4\">\n          Fuzzy Search Testi\n        </h2>\n        \n        <div className=\"mb-4\">\n          <label htmlFor=\"search\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Ürün Ara\n          </label>\n          <Input\n            id=\"search\"\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            placeholder=\"iPhone, Samsung, MacBook...\"\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n          />\n        </div>\n\n        {isSearching && (\n          <div className=\"text-blue-600 mb-4\">Aranıyor...</div>\n        )}\n\n        <div className=\"space-y-3\">\n          {results.length > 0 ? (\n            results.map((result, index) => (\n              <div key={result.item.id} className=\"border border-gray-200 rounded-lg p-4 hover:bg-gray-50\">\n                <div className=\"flex justify-between items-start\">\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900\">{result.item.name}</h3>\n                    <p className=\"text-sm text-gray-600\">{result.item.category}</p>\n                    <p className=\"text-sm text-gray-500 mt-1\">{result.item.description}</p>\n                  </div>\n                  {result.score && (\n                    <span className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded\">\n                      Skor: {((1 - result.score) * 100).toFixed(0)}%\n                    </span>\n                  )}\n                </div>\n              </div>\n            ))\n          ) : query ? (\n            <div className=\"text-gray-500 text-center py-8\">\n              \"{query}\" için sonuç bulunamadı\n            </div>\n          ) : (\n            <div className=\"text-gray-500 text-center py-8\">\n              Arama yapmak için yukarıdaki kutuya yazın\n            </div>\n          )}\n        </div>\n      </div>\n      {/* File Upload Test */}\n      <div className=\"bg-white rounded-lg shadow-md p-6\">\n        <h2 className=\"text-2xl font-semibold text-gray-800 mb-4\">\n          File Upload Testi\n        </h2>\n\n        <div className=\"mb-6\">\n          <label htmlFor=\"file-upload\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n            CSV/Excel Dosyası Seç\n          </label>\n          <Input\n            id=\"file-upload\"\n            type=\"file\"\n            accept=\".csv,.xlsx,.xls\"\n            onChange={handleFileSelect}\n            className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\n          />\n        </div>\n\n        {/* File State Display */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n          <div>\n            <h3 className=\"text-lg font-medium text-gray-800 mb-3\">Dosya Durumu</h3>\n            <div className=\"space-y-2 text-sm\">\n              <div>\n                <span className=\"font-medium\">Durum:</span>{' '}\n                <span className={`px-2 py-1 rounded text-xs ${\n                  !fileState.file ? 'bg-gray-100 text-gray-800' :\n                  fileState.isProcessing ? 'bg-yellow-100 text-yellow-800' :\n                  fileState.parsedData ? 'bg-green-100 text-green-800' :\n                  'bg-red-100 text-red-800'\n                }`}>\n                  {!fileState.file ? 'Bekliyor' :\n                   fileState.isProcessing ? 'İşleniyor' :\n                   fileState.parsedData ? 'Başarılı' : 'Hata'}\n                </span>\n              </div>\n              {fileState.file && (\n                <>\n                  <div><span className=\"font-medium\">Dosya:</span> {fileState.file.name}</div>\n                  <div><span className=\"font-medium\">Boyut:</span> {(fileState.file.size / 1024).toFixed(1)} KB</div>\n                </>\n              )}\n              {fileState.parsedData && (\n                <>\n                  <div><span className=\"font-medium\">Satır Sayısı:</span> {fileState.parsedData.rows.length}</div>\n                  <div><span className=\"font-medium\">Sütun Sayısı:</span> {fileState.parsedData.headers.length}</div>\n                </>\n              )}\n            </div>\n          </div>\n\n          <div>\n            <h3 className=\"text-lg font-medium text-gray-800 mb-3\">Sütun Tipleri</h3>\n            {fileState.columnTypes && (\n              <div className=\"space-y-1 text-sm\">\n                {fileState.columnTypes.map((columnInfo, index) => (\n                  <div key={index}>\n                    <span className=\"font-medium\">{fileState.parsedData?.headers[index]}:</span>{' '}\n                    <span className=\"text-blue-600\">{columnInfo.detectedType}</span>\n                    {columnInfo.confidence && (\n                      <span className=\"text-gray-500 ml-1\">\n                        ({(columnInfo.confidence * 100).toFixed(0)}%)\n                      </span>\n                    )}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Error Display */}\n        {fileState.error && (\n          <div className=\"bg-red-50 border border-red-200 rounded-md p-4 mb-6\">\n            <h4 className=\"text-red-800 font-medium mb-2\">Hata</h4>\n            <p className=\"text-red-700 text-sm\">{fileState.error}</p>\n          </div>\n        )}\n\n        {/* Preview Data */}\n        {previewData.length > 0 && (\n          <div>\n            <h3 className=\"text-lg font-medium text-gray-800 mb-3\">\n              Veri Önizlemesi (İlk 5 satır)\n            </h3>\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full divide-y divide-gray-200 border border-gray-200 rounded-lg\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    {fileState.parsedData?.headers.map((header, index) => (\n                      <th\n                        key={index}\n                        className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                      >\n                        {header}\n                      </th>\n                    ))}\n                  </tr>\n                </thead>\n                <tbody className=\"bg-white divide-y divide-gray-200\">\n                  {previewData.map((row, rowIndex) => (\n                    <tr key={rowIndex} className=\"hover:bg-gray-50\">\n                      {row.map((cell, cellIndex) => (\n                        <td\n                          key={cellIndex}\n                          className=\"px-4 py-2 text-sm text-gray-900 whitespace-nowrap\"\n                        >\n                          {String(cell)}\n                        </td>\n                      ))}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        {fileState.parsedData && (\n          <div className=\"mt-6 flex gap-3\">\n            <Button\n              onClick={() => fileActions.processFile()}\n              disabled={fileState.isProcessing}\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              variant='default'>\n              {fileState.isProcessing ? 'İşleniyor...' : 'Yeniden İşle'}\n            </Button>\n            <Button\n              onClick={() => fileActions.reset()}\n              className=\"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700\"\n              variant='default'>\n              Temizle\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default TestPage;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/appointments.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_filters' is assigned a value but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_setFilters' is assigned a value but never used.","line":14,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":31}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from '@x-ear/ui-web';\nimport { useState } from 'react';\nimport { AppointmentList, AppointmentCalendar, AppointmentModal } from '../components/appointments';\nimport { useAppointments } from '../hooks/useAppointments';\nimport { AppointmentFilters } from '../types/appointment';\n\ntype ViewMode = 'list' | 'calendar';\n\nexport default function AppointmentsPage() {\n  const { error, stats } = useAppointments();\n  const [viewMode, setViewMode] = useState<ViewMode>('calendar');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [selectedDate, setSelectedDate] = useState<string | undefined>();\n  const [_filters, _setFilters] = useState<AppointmentFilters>({});\n\n  const handleDateClick = (date: string) => {\n    setSelectedDate(date);\n  };\n\n  const handleCreateAppointment = () => {\n    setShowCreateModal(true);\n  };\n\n  const handleModalClose = () => {\n    setShowCreateModal(false);\n    setSelectedDate(undefined);\n  };\n\n  const getStatsCards = () => {\n    if (!stats) return null;\n\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                </svg>\n              </div>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Toplam Randevu</p>\n              <p className=\"text-2xl font-semibold text-gray-900\">{stats.total}</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-5 h-5 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                </svg>\n              </div>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Tamamlanan</p>\n              <p className=\"text-2xl font-semibold text-gray-900\">{stats.completed || 0}</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-5 h-5 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                </svg>\n              </div>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Bekleyen</p>\n              <p className=\"text-2xl font-semibold text-gray-900\">\n                {(stats.scheduled || 0) + (stats.confirmed || 0)}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-5 h-5 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </div>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">İptal/Gelmedi</p>\n              <p className=\"text-2xl font-semibold text-gray-900\">\n                {(stats.cancelled || 0) + (stats.no_show || 0)}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Page Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900\">Randevular</h1>\n              <p className=\"mt-2 text-sm text-gray-600\">\n                Hasta randevularını yönetin ve takip edin\n              </p>\n            </div>\n            <Button\n              onClick={handleCreateAppointment}\n              className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n              variant='default'>\n              <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n              </svg>\n              Yeni Randevu\n            </Button>\n          </div>\n        </div>\n\n        {/* Error State */}\n        {error && (\n          <div className=\"mb-6 bg-red-50 border border-red-200 rounded-md p-4\">\n            <div className=\"flex\">\n              <div className=\"flex-shrink-0\">\n                <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                </svg>\n              </div>\n              <div className=\"ml-3\">\n                <h3 className=\"text-sm font-medium text-red-800\">Hata</h3>\n                <div className=\"mt-2 text-sm text-red-700\">{error}</div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Stats Cards */}\n        {getStatsCards()}\n\n        {/* View Mode Toggle */}\n        <div className=\"mb-6\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex bg-gray-100 rounded-lg p-1\">\n              <Button\n                onClick={() => setViewMode('calendar')}\n                className={`px-4 py-2 text-sm font-medium rounded-md transition-colors ${\n                  viewMode === 'calendar'\n                    ? 'bg-white text-gray-900 shadow-sm'\n                    : 'text-gray-600 hover:text-gray-900'\n                }`}\n                variant='default'>\n                <svg className=\"w-4 h-4 mr-2 inline\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                </svg>\n                Takvim\n              </Button>\n              <Button\n                onClick={() => setViewMode('list')}\n                className={`px-4 py-2 text-sm font-medium rounded-md transition-colors ${\n                  viewMode === 'list'\n                    ? 'bg-white text-gray-900 shadow-sm'\n                    : 'text-gray-600 hover:text-gray-900'\n                }`}\n                variant='default'>\n                <svg className=\"w-4 h-4 mr-2 inline\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 10h16M4 14h16M4 18h16\" />\n                </svg>\n                Liste\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Main Content */}\n        <div className=\"space-y-6\">\n          {viewMode === 'calendar' ? (\n            <AppointmentCalendar\n              onDateClick={handleDateClick}\n              className=\"w-full\"\n            />\n          ) : (\n            <AppointmentList\n              className=\"w-full\"\n            />\n          )}\n        </div>\n\n        {/* Create Appointment Modal */}\n        <AppointmentModal\n          isOpen={showCreateModal}\n          onClose={handleModalClose}\n          mode=\"create\"\n          initialDate={selectedDate}\n        />\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/appointments/AppointmentsPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[417,420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[417,420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[602,605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[602,605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1000,1003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1000,1003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { AppointmentFormModal } from '@/components/appointments/AppointmentFormModal';\nimport { useAppointmentsList } from '@/hooks/appointments/useAppointments';\nimport { Button } from '@x-ear/ui-web';\n\nexport function AppointmentsPage() {\n  const { data, isLoading } = useAppointmentsList();\n  const [open, setOpen] = React.useState(false);\n  const [editing, setEditing] = React.useState<any | null>(null);\n\n  function close() {\n    setOpen(false);\n    setEditing(null);\n  }\n\n  function openNew() {\n    setEditing(null);\n    setOpen(true);\n  }\n\n  function handleEdit(item: any) {\n    setEditing(item);\n    setOpen(true);\n  }\n\n  return (\n    <div className=\"p-4\">\n      <div className=\"flex justify-between items-center mb-4\">\n        <h1 className=\"text-xl font-bold\">Appointments</h1>\n        <Button onClick={openNew}>New</Button>\n      </div>\n\n      {isLoading ? (\n        <div>Loading...</div>\n      ) : (\n        <div className=\"space-y-2\">\n          {data?.map((a: any) => (\n            <div key={a.id} className=\"p-2 border rounded flex justify-between\">\n              <div>\n                <div className=\"font-medium\">{a.title}</div>\n                <div className=\"text-sm text-gray-500\">{a.date}</div>\n              </div>\n              <div>\n                <Button variant=\"ghost\" onClick={() => handleEdit(a)}>\n                  Edit\n                </Button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      <AppointmentFormModal\n        open={open}\n        onClose={close}\n        onSubmit={(data) => {\n          // TODO: wire create/update\n          console.log('submit', data);\n          close();\n        }}\n        initialData={editing ?? undefined}\n      />\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/InventoryPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BarChart3' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronLeft' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronRight' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronsLeft' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ChevronsRight' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AdvancedFilters' is defined but never used.","line":19,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StockUpdateModal' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StockUpdateData' is defined but never used.","line":24,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is assigned a value but never used.","line":37,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'editId' is assigned a value but never used.","line":38,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setEditId' is assigned a value but never used.","line":38,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'open' is assigned a value but never used.","line":39,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setOpen' is assigned a value but never used.","line":39,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isBulkModalOpen' is assigned a value but never used.","line":44,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isBulkUploadModalOpen' is assigned a value but never used.","line":45,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setIsBulkUploadModalOpen' is assigned a value but never used.","line":45,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isStockModalOpen' is assigned a value but never used.","line":48,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setIsStockModalOpen' is assigned a value but never used.","line":48,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'stats' is assigned a value but never used.","line":62,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'paginatedItems' is assigned a value but never used.","line":213,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":213,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleExportCSV' is assigned a value but never used.","line":215,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":215,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleExportExcel' is assigned a value but never used.","line":219,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":219,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handlePrintBarcodes' is assigned a value but never used.","line":227,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":227,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleViewDetails' is assigned a value but never used.","line":237,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":237,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleBulkOperation' is assigned a value but never used.","line":242,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":242,"endColumn":28},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":327,"column":11,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":327,"endColumn":70},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleFiltersChange' is assigned a value but never used.","line":395,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":395,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleClearFilters' is assigned a value but never used.","line":399,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":399,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleSelectionChange' is assigned a value but never used.","line":408,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":408,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handlePrintReport' is assigned a value but never used.","line":505,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":505,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getStatusBadgeVariant' is assigned a value but never used.","line":509,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":509,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getStatusLabel' is assigned a value but never used.","line":521,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":521,"endColumn":23}],"suppressedMessages":[],"errorCount":33,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Card, Button } from '@x-ear/ui-web';\nimport { \n  Plus, \n  Download, \n  Upload, \n  BarChart3, \n  Package, \n  AlertTriangle, \n  Printer,\n  TrendingUp,\n  XCircle,\n  ChevronLeft,\n  ChevronRight,\n  ChevronsLeft,\n  ChevronsRight\n} from 'lucide-react';\nimport InventoryFilters from './components/InventoryFilters';\nimport AdvancedFilters from './components/AdvancedFilters';\nimport InventoryTable from './components/InventoryTable';\nimport { ProductForm } from './components/ProductForm';\nimport ProductDetailsModal from './components/ProductDetailsModal';\nimport { BulkOperation } from './components/BulkOperationsModal';\nimport { StockUpdateModal, StockUpdateData } from './components/StockUpdateModal';\nimport { DeleteConfirmModal } from './components/DeleteConfirmModal';\nimport BulkUpload from './components/BulkUpload';\nimport { inventoryService } from '../../services/inventory.service';\nimport { InventoryItem, InventoryFilters as IInventoryFilters, InventoryFormData, InventoryStats, InventoryCategory, InventoryStatus } from '../../types/inventory';\nimport { exportInventoryToCSV, exportInventoryToExcel, printInventoryReport } from '../../utils/exportUtils';\nimport { printBarcodeLabels } from '../../utils/barcodeUtils';\n\n// Mock data'yı kaldırıp service kullanacak şekilde güncelliyorum\nconst InventoryPage: React.FC = () => {\n  const [items, setItems] = useState<InventoryItem[]>([]);\n  const [filteredItems, setFilteredItems] = useState<InventoryItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [editId, setEditId] = useState<string | null>(null);\n  const [open, setOpen] = useState(false);\n  \n  // New state for enhanced features\n  const [selectedItems, setSelectedItems] = useState<string[]>([]);\n  const [isDetailsModalOpen, setIsDetailsModalOpen] = useState(false);\n  const [isBulkModalOpen, setIsBulkModalOpen] = useState(false);\n  const [isBulkUploadModalOpen, setIsBulkUploadModalOpen] = useState(false);\n  const [isBulkUploadOpen, setIsBulkUploadOpen] = useState(false);\n  const [isFormModalOpen, setIsFormModalOpen] = useState(false);\n  const [isStockModalOpen, setIsStockModalOpen] = useState(false);\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n  const [selectedItem, setSelectedItem] = useState<InventoryItem | null>(null);\n  const [formMode, setFormMode] = useState<'create' | 'edit'>('create');\n  \n  // Pagination state\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPage, setItemsPerPage] = useState(10);\n  const [filters, setFilters] = useState<IInventoryFilters>({\n    search: '',\n    category: undefined,\n    brand: '',\n    status: undefined,\n  });\n  const [stats, setStats] = useState<InventoryStats>({\n    total: 0,\n    available: 0,\n    lowStock: 0,\n    outOfStock: 0,\n    totalValue: 0,\n    activeTrials: 0,\n    byCategory: {} as Record<InventoryCategory, number>,\n    byBrand: {},\n    byStatus: {} as Record<InventoryStatus, number>,\n    recentlyUpdated: 0,\n  });\n\n  // Load data from service\n  useEffect(() => {\n    loadInventoryData();\n  }, []);\n\n  const loadInventoryData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const [itemsData, statsData] = await Promise.all([\n        inventoryService.getAllItems(),\n        inventoryService.getStats()\n      ]);\n      \n      setItems(itemsData);\n      setStats(statsData);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Veri yüklenirken hata oluştu');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter items based on current filters\n  useEffect(() => {\n    let filtered = [...items];\n\n    // Basic search filter\n    if (filters.search && filters.search.trim()) {\n      const searchTerm = filters.search.toLowerCase();\n      filtered = filtered.filter(item =>\n        item.name.toLowerCase().includes(searchTerm) ||\n        item.brand.toLowerCase().includes(searchTerm) ||\n        (item.model && item.model.toLowerCase().includes(searchTerm)) ||\n        (item.barcode && item.barcode.toLowerCase().includes(searchTerm))\n      );\n    }\n\n    // Category filter\n    if (filters.category) {\n      filtered = filtered.filter(item => item.category === filters.category);\n    }\n\n    // Brand filter\n    if (filters.brand && filters.brand.trim()) {\n      filtered = filtered.filter(item => item.brand === filters.brand);\n    }\n\n    // Status filter\n    if (filters.status) {\n      filtered = filtered.filter(item => item.status === filters.status);\n    }\n\n    // Advanced filters\n    // Price range filter\n    if (filters.priceRange?.min !== undefined) {\n      filtered = filtered.filter(item => item.price >= filters.priceRange!.min!);\n    }\n    if (filters.priceRange?.max !== undefined) {\n      filtered = filtered.filter(item => item.price <= filters.priceRange!.max!);\n    }\n\n    // Date range filter (using lastUpdated)\n    if (filters.dateRange?.start) {\n      const startDate = new Date(filters.dateRange.start);\n      filtered = filtered.filter(item => {\n        const itemDate = new Date(item.lastUpdated || '');\n        return itemDate >= startDate;\n      });\n    }\n    if (filters.dateRange?.end) {\n      const endDate = new Date(filters.dateRange.end);\n      filtered = filtered.filter(item => {\n        const itemDate = new Date(item.lastUpdated || '');\n        return itemDate <= endDate;\n      });\n    }\n\n    // Stock status filter\n    if (filters.stockStatus && filters.stockStatus !== 'all') {\n      filtered = filtered.filter(item => {\n        switch (filters.stockStatus) {\n          case 'in_stock':\n            return item.availableInventory > item.reorderLevel;\n          case 'low_stock':\n            return item.availableInventory <= item.reorderLevel && item.availableInventory > 0;\n          case 'out_of_stock':\n            return item.availableInventory === 0;\n          case 'on_trial':\n            // Check if item has onTrial count > 0\n            return (item.onTrial || 0) > 0;\n          default:\n            return true;\n        }\n      });\n    }\n\n    // Supplier filter\n    if (filters.supplier && filters.supplier.trim()) {\n      filtered = filtered.filter(item => \n        item.supplier && item.supplier.toLowerCase().includes(filters.supplier!.toLowerCase())\n      );\n    }\n\n    // Warranty period filter\n    if (filters.warrantyPeriod && filters.warrantyPeriod.trim()) {\n      filtered = filtered.filter(item => {\n        const warrantyMonths = item.warranty || 0;\n        switch (filters.warrantyPeriod) {\n          case '0-12':\n            return warrantyMonths <= 12;\n          case '12-24':\n            return warrantyMonths > 12 && warrantyMonths <= 24;\n          case '24+':\n            return warrantyMonths > 24;\n          default:\n            return warrantyMonths === parseInt(filters.warrantyPeriod!);\n        }\n      });\n    }\n\n    // Features filter\n    if (filters.features && filters.features.length > 0) {\n      filtered = filtered.filter(item => {\n        if (!item.features || !Array.isArray(item.features)) return false;\n        return filters.features!.some(feature => \n          item.features!.includes(feature)\n        );\n      });\n    }\n\n    setFilteredItems(filtered);\n  }, [items, filters]);\n\n  // Pagination calculations\n  const startIndex = (currentPage - 1) * itemsPerPage;\n  const endIndex = startIndex + itemsPerPage;\n  const paginatedItems = filteredItems.slice(startIndex, endIndex);\n\n  const handleExportCSV = () => {\n    exportInventoryToCSV(filteredItems);\n  };\n\n  const handleExportExcel = () => {\n    exportInventoryToExcel(filteredItems);\n  };\n\n  const handlePrint = () => {\n    printInventoryReport(filteredItems);\n  };\n\n  const handlePrintBarcodes = () => {\n    if (selectedItems.length === 0) {\n      alert('Lütfen barkod yazdırmak için ürün seçin');\n      return;\n    }\n    \n    const selectedProducts = items.filter(item => selectedItems.includes(item.id));\n    printBarcodeLabels(selectedProducts);\n  };\n\n  const handleViewDetails = (item: InventoryItem) => {\n    setSelectedItem(item);\n    setIsDetailsModalOpen(true);\n  };\n\n  const handleBulkOperation = async (operation: BulkOperation) => {\n    try {\n      const selectedItemsData = items.filter(item => selectedItems.includes(item.id));\n      \n      switch (operation.type) {\n        case 'delete':\n          // Bulk delete operation\n          for (const itemId of selectedItems) {\n            await inventoryService.deleteItem(itemId);\n          }\n          setItems(prev => prev.filter(item => !selectedItems.includes(item.id)));\n          break;\n\n        case 'update_stock':\n          // Bulk stock update\n          if (operation.data?.stock !== undefined) {\n            for (const itemId of selectedItems) {\n              await inventoryService.updateStock({\n                itemId,\n                operation: 'set',\n                quantity: operation.data.stock,\n                reason: operation.data.reason || 'Bulk stock update'\n              });\n            }\n            setItems(prev => prev.map(item => \n              selectedItems.includes(item.id) \n                ? { ...item, availableInventory: operation.data!.stock! }\n                : item\n            ));\n          }\n          break;\n\n        case 'change_category':\n          // Bulk category change\n          if (operation.data?.category) {\n            for (const itemId of selectedItems) {\n              await inventoryService.updateItem(itemId, { \n                id: itemId,\n                category: operation.data.category \n              });\n            }\n            setItems(prev => prev.map(item => \n              selectedItems.includes(item.id) \n                ? { ...item, category: operation.data!.category! }\n                : item\n            ));\n          }\n          break;\n\n        case 'change_status':\n          // Bulk status change\n          if (operation.data?.status) {\n            for (const itemId of selectedItems) {\n              await inventoryService.updateItem(itemId, { \n                id: itemId,\n                status: operation.data.status \n              });\n            }\n            setItems(prev => prev.map(item => \n              selectedItems.includes(item.id) \n                ? { ...item, status: operation.data!.status! }\n                : item\n            ));\n          }\n          break;\n\n        case 'update_price':\n          // Bulk price update\n          if (operation.data?.price !== undefined) {\n            for (const itemId of selectedItems) {\n              await inventoryService.updateItem(itemId, { \n                id: itemId,\n                price: operation.data.price \n              });\n            }\n            setItems(prev => prev.map(item => \n              selectedItems.includes(item.id) \n                ? { ...item, price: operation.data!.price! }\n                : item\n            ));\n          }\n          break;\n\n        case 'export':\n          // Export selected items\n          const exportFormat = operation.data?.exportFormat || 'csv';\n          if (exportFormat === 'csv') {\n            exportInventoryToCSV(selectedItemsData);\n          } else if (exportFormat === 'excel') {\n            exportInventoryToExcel(selectedItemsData);\n          } else if (exportFormat === 'pdf') {\n            printInventoryReport(selectedItemsData);\n          }\n          break;\n\n        case 'update_supplier':\n          // Bulk supplier update\n          if (operation.data?.supplier) {\n            for (const itemId of selectedItems) {\n              await inventoryService.updateItem(itemId, { \n                id: itemId,\n                supplier: operation.data.supplier \n              });\n            }\n            setItems(prev => prev.map(item => \n              selectedItems.includes(item.id) \n                ? { ...item, supplier: operation.data!.supplier! }\n                : item\n            ));\n          }\n          break;\n\n        case 'add_features':\n          // Bulk features addition\n          if (operation.data?.features && operation.data.features.length > 0) {\n            for (const itemId of selectedItems) {\n              const currentItem = items.find(item => item.id === itemId);\n              if (currentItem) {\n                const updatedFeatures = [...(currentItem.features || []), ...operation.data.features];\n                const uniqueFeatures = [...new Set(updatedFeatures)];\n                await inventoryService.updateItem(itemId, { \n                  id: itemId,\n                  features: uniqueFeatures \n                });\n              }\n            }\n            setItems(prev => prev.map(item => {\n              if (selectedItems.includes(item.id)) {\n                const updatedFeatures = [...(item.features || []), ...operation.data!.features!];\n                const uniqueFeatures = [...new Set(updatedFeatures)];\n                return { ...item, features: uniqueFeatures };\n              }\n              return item;\n            }));\n          }\n          break;\n\n        default:\n          console.warn('Unknown bulk operation type:', operation.type);\n      }\n\n      // Show success message\n      console.log(`Bulk operation ${operation.type} completed successfully for ${selectedItems.length} items`);\n      \n    } catch (error) {\n      console.error('Bulk operation failed:', error);\n      // Show error message to user\n    } finally {\n      setIsBulkModalOpen(false);\n      setSelectedItems([]);\n    }\n  };\n\n  const handleFiltersChange = (newFilters: IInventoryFilters) => {\n    setFilters(newFilters);\n  };\n\n  const handleClearFilters = () => {\n    setFilters({\n      search: '',\n      category: undefined,\n      brand: '',\n      status: undefined,\n    });\n  };\n\n  const handleSelectionChange = (itemIds: string[]) => {\n    setSelectedItems(itemIds);\n  };\n\n  // Handler functions for InventoryTable\n  const handleSelectItem = (id: string) => {\n    setSelectedItems(prev => \n      prev.includes(id) \n        ? prev.filter(itemId => itemId !== id)\n        : [...prev, id]\n    );\n  };\n\n  const handleSelectAll = (selected: boolean) => {\n    if (selected) {\n      setSelectedItems(filteredItems.map(item => item.id));\n    } else {\n      setSelectedItems([]);\n    }\n  };\n\n  const handleAddProduct = () => {\n    setSelectedItem(null);\n    setIsFormModalOpen(true);\n    setFormMode('create');\n  };\n\n  const handleEdit = (item: InventoryItem) => {\n    setSelectedItem(item);\n    setIsFormModalOpen(true);\n    setFormMode('edit');\n  };\n\n  const handleView = (item: InventoryItem) => {\n    setSelectedItem(item);\n    setIsDetailsModalOpen(true);\n  };\n\n  const handleDelete = (item: InventoryItem) => {\n    setSelectedItem(item);\n    setIsDeleteModalOpen(true);\n  };\n\n  const handleBulkUpload = () => {\n    setIsBulkUploadOpen(true);\n  };\n\n  const handleUpdateStock = (item: InventoryItem) => {\n    // Update stock logic here\n    console.log('Updating stock for', item.name);\n  };\n\n  const handleGenerateBarcode = (item: InventoryItem) => {\n    // Generate barcode logic here\n    console.log('Generating barcode for', item.name);\n  };\n\n  const handleConfirmDelete = async () => {\n    if (!selectedItem) return;\n    \n    try {\n      // Delete logic here\n      console.log('Deleting item:', selectedItem.name);\n      setIsDeleteModalOpen(false);\n      setSelectedItem(null);\n    } catch (error) {\n      console.error('Error deleting item:', error);\n    }\n  };\n\n  const handleFormSubmit = async (data: InventoryFormData) => {\n    try {\n      if (formMode === 'create') {\n        console.log('Creating new item:', data);\n      } else {\n        console.log('Updating item:', data);\n      }\n      setIsFormModalOpen(false);\n      setSelectedItem(null);\n    } catch (error) {\n      console.error('Error submitting form:', error);\n    }\n  };\n\n  const handleBulkUploadSubmit = async (items: Partial<InventoryItem>[]) => {\n    try {\n      console.log('Bulk uploading items:', items);\n      setIsBulkUploadOpen(false);\n    } catch (error) {\n      console.error('Error bulk uploading:', error);\n    }\n  };\n\n  const handleExport = () => {\n    console.log('Exporting inventory data...');\n  };\n\n  const handlePrintReport = () => {\n    console.log('Printing inventory report...');\n  };\n\n  const getStatusBadgeVariant = (status: InventoryStatus | string) => {\n    switch (String(status)) {\n      case 'available': return 'success';\n      case 'assigned': return 'warning';\n      case 'maintenance': return 'secondary';\n      case 'retired': return 'destructive';\n      case 'low_stock': return 'warning';\n      case 'out_of_stock': return 'destructive';\n      default: return 'secondary';\n    }\n  };\n\n  const getStatusLabel = (status: InventoryStatus | string) => {\n    switch (String(status)) {\n      case 'available': return 'Mevcut';\n      case 'assigned': return 'Atanmış';\n      case 'maintenance': return 'Bakımda';\n      case 'retired': return 'Emekli';\n      case 'low_stock': return 'Düşük Stok';\n      case 'out_of_stock': return 'Stok Tükendi';\n      default: return String(status);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">\n            Stok Yönetimi\n          </h1>\n          <p className=\"text-gray-600 dark:text-gray-400\">\n            Ürün stoklarını yönetin ve takip edin\n          </p>\n        </div>\n        \n        <div className=\"flex items-center gap-3\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleExport}\n            className=\"flex items-center gap-2\"\n          >\n            <Download className=\"w-4 h-4\" />\n            Dışa Aktar\n          </Button>\n          \n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handlePrint}\n            className=\"flex items-center gap-2\"\n          >\n            <Printer className=\"w-4 h-4\" />\n            Yazdır\n          </Button>\n          \n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleBulkUpload}\n            className=\"flex items-center gap-2\"\n          >\n            <Upload className=\"w-4 h-4\" />\n            Toplu Yükleme\n          </Button>\n          \n          <Button\n            onClick={handleAddProduct}\n            className=\"flex items-center gap-2\"\n          >\n            <Plus className=\"w-4 h-4\" />\n            Yeni Ürün\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">\n                Toplam Ürün\n              </p>\n              <p className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">\n                {filteredItems.length}\n              </p>\n            </div>\n            <div className=\"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center\">\n              <Package className=\"w-4 h-4 text-blue-600 dark:text-blue-400\" />\n            </div>\n          </div>\n        </Card>\n\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">\n                Düşük Stok\n              </p>\n              <p className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\n                {filteredItems.filter(item => item.availableInventory <= item.reorderLevel).length}\n              </p>\n            </div>\n            <div className=\"w-8 h-8 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center\">\n              <AlertTriangle className=\"w-4 h-4 text-orange-600 dark:text-orange-400\" />\n            </div>\n          </div>\n        </Card>\n\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">\n                Stok Tükendi\n              </p>\n              <p className=\"text-2xl font-bold text-red-600 dark:text-red-400\">\n                {filteredItems.filter(item => item.availableInventory === 0).length}\n              </p>\n            </div>\n            <div className=\"w-8 h-8 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center\">\n              <XCircle className=\"w-4 h-4 text-red-600 dark:text-red-400\" />\n            </div>\n          </div>\n        </Card>\n\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">\n                Toplam Değer\n              </p>\n              <p className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n                ₺{filteredItems.reduce((sum, item) => sum + (item.price * item.availableInventory), 0).toLocaleString('tr-TR')}\n              </p>\n            </div>\n            <div className=\"w-8 h-8 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center\">\n              <TrendingUp className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Filters */}\n      <InventoryFilters\n        filters={filters}\n        onFiltersChange={setFilters}\n        onClearFilters={() => setFilters({\n          search: '',\n          category: undefined,\n          brand: '',\n          status: undefined,\n          lowStock: false,\n          outOfStock: false,\n          supplier: '',\n          minPrice: undefined,\n          maxPrice: undefined,\n          hasSerials: false,\n          isMinistryTracked: false,\n          priceRange: { min: 0, max: 10000 },\n          dateRange: { start: '', end: '' },\n          stockStatus: 'all',\n          features: [],\n          warrantyPeriod: ''\n        })}\n      />\n\n      {/* Table */}\n      <Card>\n        <InventoryTable\n          items={filteredItems}\n          selectedItems={selectedItems}\n          onSelectItem={handleSelectItem}\n          onSelectAll={handleSelectAll}\n          onEdit={handleEdit}\n          onView={handleView}\n          onDelete={handleDelete}\n          onUpdateStock={handleUpdateStock}\n          onGenerateBarcode={handleGenerateBarcode}\n          currentPage={currentPage}\n          itemsPerPage={itemsPerPage}\n          onPageChange={setCurrentPage}\n          onItemsPerPageChange={setItemsPerPage}\n        />\n      </Card>\n\n      {/* Modals */}\n      <ProductForm\n        isOpen={isFormModalOpen}\n        onClose={() => setIsFormModalOpen(false)}\n        onSubmit={handleFormSubmit}\n        initialData={selectedItem}\n        mode={formMode}\n      />\n\n      <ProductDetailsModal\n        isOpen={isDetailsModalOpen}\n        onClose={() => setIsDetailsModalOpen(false)}\n        product={selectedItem}\n        onEdit={handleEdit}\n        onStockUpdate={handleUpdateStock}\n      />\n\n      <DeleteConfirmModal\n        isOpen={isDeleteModalOpen}\n        onClose={() => setIsDeleteModalOpen(false)}\n        items={selectedItem ? [selectedItem] : []}\n        onConfirm={handleConfirmDelete}\n      />\n\n      <BulkUpload\n        isOpen={isBulkUploadOpen}\n        onClose={() => setIsBulkUploadOpen(false)}\n        onUpload={handleBulkUploadSubmit}\n      />\n    </div>\n  );\n};\n\nexport default InventoryPage;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/InventoryTable/InventoryRow.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/InventoryTable/InventoryTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/AdvancedFilters.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onClearFilters' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'categories' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'brands' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleWarrantyPeriodChange' is assigned a value but never used.","line":70,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleFeatureChange' is assigned a value but never used.","line":78,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":28},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":106,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":106,"endColumn":65},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":132,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3722,3725],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3722,3725],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":136,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3860,3863],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3860,3863],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardHeader, CardTitle, CardContent, Input, Select, Button, Checkbox, Badge } from '@x-ear/ui-web';\nimport { ChevronDown, ChevronUp, X } from 'lucide-react';\nimport { InventoryFilters as IInventoryFilters } from '../../../types/inventory';\n\ninterface AdvancedFiltersProps {\n  filters: IInventoryFilters;\n  onFiltersChange: (filters: IInventoryFilters) => void;\n  onClearFilters: () => void;\n  categories: string[];\n  brands: string[];\n  suppliers: string[];\n  isExpanded?: boolean;\n  onToggleExpanded?: () => void;\n}\n\nconst AdvancedFilters: React.FC<AdvancedFiltersProps> = ({\n  filters,\n  onFiltersChange,\n  onClearFilters,\n  categories,\n  brands,\n  suppliers,\n  isExpanded = false,\n  onToggleExpanded\n}) => {\n  const [localExpanded, setLocalExpanded] = useState(isExpanded);\n\n  const handlePriceRangeChange = (field: 'min' | 'max', value: string) => {\n    const numValue = value === '' ? undefined : parseFloat(value);\n    onFiltersChange({\n      ...filters,\n      priceRange: {\n        ...filters.priceRange,\n        [field]: numValue\n      }\n    });\n  };\n\n  const handleDateRangeChange = (field: 'start' | 'end', value: string) => {\n    onFiltersChange({\n      ...filters,\n      dateRange: {\n        ...filters.dateRange,\n        [field]: value || undefined\n      }\n    });\n  };\n\n  const handleFeatureToggle = (feature: string) => {\n    const currentFeatures = filters.features || [];\n    const newFeatures = currentFeatures.includes(feature)\n      ? currentFeatures.filter((f: string) => f !== feature)\n      : [...currentFeatures, feature];\n    \n    onFiltersChange({\n      ...filters,\n      features: newFeatures\n    });\n  };\n\n  const handleStockStatusChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const value = event.target.value;\n    onFiltersChange({\n      ...filters,\n      stockStatus: value as 'all' | 'in_stock' | 'low_stock' | 'out_of_stock' | 'on_trial'\n    });\n  };\n\n  const handleWarrantyPeriodChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const value = event.target.value;\n    onFiltersChange({\n      ...filters,\n      warrantyPeriod: value\n    });\n  };\n\n  const handleFeatureChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const value = event.target.value;\n    const currentFeatures = filters.features || [];\n    const updatedFeatures = currentFeatures.includes(value)\n      ? currentFeatures.filter(f => f !== value)\n      : [...currentFeatures, value];\n    \n    onFiltersChange({\n      ...filters,\n      features: updatedFeatures\n    });\n  };\n\n  const applyDatePreset = (preset: string) => {\n    const now = new Date();\n    let start: Date;\n    \n    switch (preset) {\n      case 'today':\n        start = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n        break;\n      case 'week':\n        start = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n        break;\n      case 'month':\n        start = new Date(now.getFullYear(), now.getMonth(), 1);\n        break;\n      case 'quarter':\n        const quarterStart = Math.floor(now.getMonth() / 3) * 3;\n        start = new Date(now.getFullYear(), quarterStart, 1);\n        break;\n      case 'year':\n        start = new Date(now.getFullYear(), 0, 1);\n        break;\n      default:\n        return;\n    }\n    \n    onFiltersChange({\n      ...filters,\n      dateRange: {\n        start: start.toISOString().split('T')[0],\n        end: now.toISOString().split('T')[0]\n      }\n    });\n  };\n\n  const clearFilters = () => {\n    onFiltersChange({});\n  };\n\n  const activeFilterCount = Object.keys(filters).filter(key => {\n    const value = filters[key as keyof IInventoryFilters];\n    if (key === 'priceRange') {\n      const range = value as any;\n      return range?.min !== undefined || range?.max !== undefined;\n    }\n    if (key === 'dateRange') {\n      const range = value as any;\n      return range?.start || range?.end;\n    }\n    if (key === 'features') {\n      return Array.isArray(value) && value.length > 0;\n    }\n    return value !== undefined && value !== '' && value !== 'all';\n  }).length;\n\n  const stockStatusOptions = [\n    { value: 'all', label: 'Tüm Durumlar' },\n    { value: 'in_stock', label: 'Stokta Var' },\n    { value: 'low_stock', label: 'Düşük Stok' },\n    { value: 'out_of_stock', label: 'Stok Yok' },\n    { value: 'on_trial', label: 'Denemede' }\n  ];\n\n  const commonFeatures = [\n    'Bluetooth', 'Şarj Edilebilir', 'Su Geçirmez', 'Gürültü Engelleme',\n    'Tinnitus Maskeleme', 'Telecoil', 'Yönlü Mikrofon', 'Feedback Engelleme'\n  ];\n\n  const warrantyOptions = [\n    { value: '', label: 'Tüm Garantiler' },\n    { value: '1', label: '1 Yıl' },\n    { value: '2', label: '2 Yıl' },\n    { value: '3', label: '3 Yıl' },\n    { value: '5', label: '5 Yıl' }\n  ];\n\n  return (\n    <Card className=\"mb-6\">\n      <CardHeader>\n        <div className=\"flex justify-between items-center\">\n          <CardTitle className=\"text-lg font-semibold\">Gelişmiş Filtreler</CardTitle>\n          <div className=\"flex items-center gap-2\">\n            {activeFilterCount > 0 && (\n              <Badge variant=\"secondary\">\n                {activeFilterCount} filtre aktif\n              </Badge>\n            )}\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onToggleExpanded || (() => setLocalExpanded(!localExpanded))}\n            >\n              {(isExpanded || localExpanded) ? (\n                <>\n                  <ChevronUp className=\"w-4 h-4 mr-1\" />\n                  Daralt\n                </>\n              ) : (\n                <>\n                  <ChevronDown className=\"w-4 h-4 mr-1\" />\n                  Genişlet\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n\n      {(isExpanded || localExpanded) && (\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {/* Price Range Filter */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-gray-900\">Fiyat Aralığı</h4>\n              <div className=\"flex gap-2\">\n                <Input\n                  type=\"number\"\n                  placeholder=\"Min\"\n                  value={filters.priceRange?.min || ''}\n                  onChange={(e) => handlePriceRangeChange('min', e.target.value)}\n                  className=\"flex-1\"\n                />\n                <Input\n                  type=\"number\"\n                  placeholder=\"Max\"\n                  value={filters.priceRange?.max || ''}\n                  onChange={(e) => handlePriceRangeChange('max', e.target.value)}\n                  className=\"flex-1\"\n                />\n              </div>\n            </div>\n\n            {/* Date Range Filter */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-gray-900\">Tarih Aralığı</h4>\n              <div className=\"flex gap-2\">\n                <Input\n                  type=\"date\"\n                  value={filters.dateRange?.start || ''}\n                  onChange={(e) => handleDateRangeChange('start', e.target.value)}\n                  className=\"flex-1\"\n                />\n                <Input\n                  type=\"date\"\n                  value={filters.dateRange?.end || ''}\n                  onChange={(e) => handleDateRangeChange('end', e.target.value)}\n                  className=\"flex-1\"\n                />\n              </div>\n              <div className=\"flex flex-wrap gap-1\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => applyDatePreset('today')}\n                >\n                  Bugün\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => applyDatePreset('week')}\n                >\n                  Bu Hafta\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => applyDatePreset('month')}\n                >\n                  Bu Ay\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => applyDatePreset('quarter')}\n                >\n                  Bu Çeyrek\n                </Button>\n              </div>\n            </div>\n\n            {/* Stock Status Filter */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-gray-900\">Stok Durumu</h4>\n              <Select\n               value={filters.stockStatus || 'all'}\n               onChange={handleStockStatusChange}\n               options={stockStatusOptions}\n             />\n            </div>\n\n            {/* Supplier Filter */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-gray-900\">Tedarikçi</h4>\n              <Select\n                value={filters.supplier || ''}\n                onChange={(e) => onFiltersChange({ ...filters, supplier: e.target.value || undefined })}\n                options={[\n                  { value: '', label: 'Tüm Tedarikçiler' },\n                  ...suppliers.map(supplier => ({ value: supplier, label: supplier }))\n                ]}\n              />\n            </div>\n\n            {/* Warranty Period Filter */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-gray-900\">Garanti Süresi</h4>\n              <Select\n                value={filters.warrantyPeriod || ''}\n                onChange={(e) => onFiltersChange({ ...filters, warrantyPeriod: e.target.value || undefined })}\n                options={warrantyOptions}\n              />\n            </div>\n\n            {/* Features Filter */}\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium text-gray-900\">Özellikler</h4>\n              <div className=\"grid grid-cols-2 gap-2\">\n                {commonFeatures.map(feature => (\n                  <label key={feature} className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      checked={filters.features?.includes(feature) || false}\n                      onChange={() => handleFeatureToggle(feature)}\n                    />\n                    <span className=\"text-sm\">{feature}</span>\n                  </label>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex justify-between items-center pt-6 border-t border-gray-200 mt-6\">\n            <Button\n              variant=\"outline\"\n              onClick={clearFilters}\n              disabled={activeFilterCount === 0}\n            >\n              <X className=\"w-4 h-4 mr-2\" />\n              Filtreleri Temizle\n            </Button>\n            \n            <div className=\"flex items-center gap-2\">\n              {activeFilterCount > 0 && (\n                <Badge variant=\"secondary\">\n                  {activeFilterCount} filtre aktif\n                </Badge>\n              )}\n            </div>\n          </div>\n        </CardContent>\n      )}\n    </Card>\n  );\n};\n\nexport default AdvancedFilters;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/BulkOperationsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/BulkSerialUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Input' is defined but never used.","line":2,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1076,1079],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1076,1079],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1161,1164],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1161,1164],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":204,"column":19,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":211,"endColumn":21}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef } from 'react';\nimport { Button, Card, Textarea, Input } from '@x-ear/ui-web';\nimport Papa from 'papaparse';\n\ninterface BulkSerialUploadProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onUpload: (serialNumbers: string[]) => Promise<void>;\n  productName?: string;\n}\n\nexport const BulkSerialUpload: React.FC<BulkSerialUploadProps> = ({\n  isOpen,\n  onClose,\n  onUpload,\n  productName = ''\n}) => {\n  const [serialNumbers, setSerialNumbers] = useState<string[]>([]);\n  const [isUploading, setIsUploading] = useState(false);\n  const [dragActive, setDragActive] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleFileUpload = (file: File) => {\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      try {\n        const text = e.target?.result as string;\n        \n        if (file.name.endsWith('.csv')) {\n          // Parse CSV\n          Papa.parse(text, {\n            complete: (results) => {\n              const serials = results.data\n                .flat()\n                .filter((item: any) => item && typeof item === 'string' && item.trim())\n                .map((item: any) => item.toString().trim());\n              \n              setSerialNumbers([...new Set(serials)]); // Remove duplicates\n            },\n            header: false\n          });\n        } else {\n          // For Excel files, treat as text and parse line by line\n          const serials = text\n            .split(/[\\n\\r]+/)\n            .map(line => line.trim())\n            .filter(line => line.length > 0);\n          \n          setSerialNumbers([...new Set(serials)]);\n        }\n      } catch (error) {\n        console.error('File parsing error:', error);\n        alert('Dosya okuma hatası. Lütfen geçerli bir CSV dosyası seçin.');\n      }\n    };\n    \n    if (file.name.endsWith('.csv')) {\n      reader.readAsText(file);\n    } else {\n      reader.readAsText(file);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    setDragActive(false);\n    \n    const files = Array.from(e.dataTransfer.files);\n    const file = files[0];\n    \n    if (file && (file.type.includes('csv') || file.name.endsWith('.csv') || file.name.endsWith('.txt'))) {\n      handleFileUpload(file);\n    } else {\n      alert('Lütfen CSV (.csv) veya metin (.txt) dosyası seçin.');\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      handleFileUpload(file);\n    }\n  };\n\n  const handleTextInput = (text: string) => {\n    const serials = text\n      .split(/[\\n,;]/)\n      .map(s => s.trim())\n      .filter(s => s.length > 0);\n    \n    setSerialNumbers([...new Set(serials)]);\n  };\n\n  const handleSubmit = async () => {\n    if (serialNumbers.length === 0) {\n      alert('Lütfen en az bir seri numarası ekleyin.');\n      return;\n    }\n\n    setIsUploading(true);\n    try {\n      await onUpload(serialNumbers);\n      onClose();\n      setSerialNumbers([]);\n    } catch (error) {\n      console.error('Upload error:', error);\n      alert('Yükleme sırasında hata oluştu.');\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const removeSerial = (index: number) => {\n    setSerialNumbers(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const downloadTemplate = () => {\n    const csvContent = 'Seri Numarası\\nSN001\\nSN002\\nSN003';\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', 'seri_numarasi_sablonu.csv');\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 overflow-y-auto\">\n      <div className=\"flex items-start justify-center min-h-screen p-4 py-8\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full my-8\">\n          {/* Modal Header */}\n          <div className=\"px-6 py-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-gray-800 dark:to-gray-700\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center\">\n                  <svg className=\"w-5 h-5 text-green-600 dark:text-green-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clipRule=\"evenodd\"/>\n                  </svg>\n                </div>\n                <div>\n                  <h3 className=\"text-xl font-semibold text-gray-900 dark:text-gray-100\">\n                    Toplu Seri Numarası Yükleme\n                  </h3>\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    {productName ? `${productName} için seri numaraları` : 'CSV/TXT dosyası ile toplu yükleme'}\n                  </p>\n                </div>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={onClose}\n                className=\"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n              >\n                <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\"/>\n                </svg>\n              </Button>\n            </div>\n          </div>\n\n          {/* Modal Body */}\n          <div className=\"p-6 space-y-6\">\n            {/* Upload Methods */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              {/* File Upload */}\n              <Card className=\"p-4\">\n                <h4 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center\">\n                  <svg className=\"w-5 h-5 text-blue-600 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z\" clipRule=\"evenodd\"/>\n                  </svg>\n                  Dosya Yükleme\n                </h4>\n                \n                <div\n                  className={`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${\n                    dragActive \n                      ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/20' \n                      : 'border-gray-300 dark:border-gray-600 hover:border-gray-400'\n                  }`}\n                  onDragEnter={(e) => { e.preventDefault(); setDragActive(true); }}\n                  onDragLeave={(e) => { e.preventDefault(); setDragActive(false); }}\n                  onDragOver={(e) => e.preventDefault()}\n                  onDrop={handleDrop}\n                >\n                  <svg className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z\" clipRule=\"evenodd\"/>\n                  </svg>\n                  <p className=\"text-gray-600 dark:text-gray-400 mb-2\">\n                    CSV/TXT dosyasını buraya sürükleyin veya\n                  </p>\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => fileInputRef.current?.click()}\n                    className=\"mb-4\"\n                  >\n                    Dosya Seç\n                  </Button>\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".csv,.txt\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                    data-allow-raw=\"true\"\n                  />\n                  <p className=\"text-xs text-gray-500\">\n                    Desteklenen formatlar: .csv, .txt\n                  </p>\n                </div>\n\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={downloadTemplate}\n                  className=\"mt-3 w-full\"\n                >\n                  <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\" clipRule=\"evenodd\"/>\n                  </svg>\n                  Şablon İndir\n                </Button>\n              </Card>\n\n              {/* Manual Input */}\n              <Card className=\"p-4\">\n                <h4 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center\">\n                  <svg className=\"w-5 h-5 text-green-600 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\"/>\n                  </svg>\n                  Manuel Giriş\n                </h4>\n                \n                <Textarea\n                  placeholder=\"Seri numaralarını her satıra bir tane gelecek şekilde yazın veya virgülle ayırın&#10;&#10;Örnek:&#10;SN001&#10;SN002&#10;SN003\"\n                  onChange={(e) => handleTextInput(e.target.value)}\n                  className=\"resize-none\"\n                />\n                \n                <p className=\"text-xs text-gray-500 mt-2\">\n                  Her satıra bir seri numarası yazın veya virgülle ayırın\n                </p>\n              </Card>\n            </div>\n\n            {/* Preview */}\n            {serialNumbers.length > 0 && (\n              <Card className=\"p-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h4 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center\">\n                    <svg className=\"w-5 h-5 text-purple-600 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clipRule=\"evenodd\"/>\n                    </svg>\n                    Seri Numaraları Önizleme\n                  </h4>\n                  <span className=\"text-sm text-gray-500\">\n                    {serialNumbers.length} adet\n                  </span>\n                </div>\n                \n                <div className=\"max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-lg\">\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 p-3\">\n                    {serialNumbers.map((serial, index) => (\n                      <div\n                        key={index}\n                        className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 px-3 py-2 rounded-lg\"\n                      >\n                        <span className=\"text-sm font-mono text-gray-900 dark:text-gray-100\">\n                          {serial}\n                        </span>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => removeSerial(index)}\n                          className=\"text-red-500 hover:text-red-700 ml-2 p-1 h-auto\"\n                        >\n                          <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\"/>\n                          </svg>\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </Card>\n            )}\n          </div>\n\n          {/* Modal Footer */}\n          <div className=\"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50\">\n            <div className=\"flex items-center justify-end space-x-3\">\n              <Button\n                variant=\"outline\"\n                onClick={onClose}\n                disabled={isUploading}\n              >\n                İptal\n              </Button>\n              <Button\n                onClick={handleSubmit}\n                disabled={isUploading || serialNumbers.length === 0}\n                className=\"bg-green-600 hover:bg-green-700\"\n              >\n                {isUploading ? 'Yükleniyor...' : `${serialNumbers.length} Seri Numarası Yükle`}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/BulkUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Input' is defined but never used.","line":2,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":36},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3453,3456],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3453,3456],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":116,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":116,"endColumn":45},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":126,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":126,"endColumn":48},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":134,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":134,"endColumn":47},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":143,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":143,"endColumn":46},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":155,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":155,"endColumn":48},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":275,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":275,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8573,8576],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8573,8576],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":284,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":284,"endColumn":45},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":289,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":289,"endColumn":48},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":294,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":294,"endColumn":47},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":299,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":299,"endColumn":46},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":308,"column":15,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":308,"endColumn":48},{"ruleId":"no-restricted-syntax","severity":2,"message":"Use Input component from @x-ear/ui-web instead of raw <input> elements. Add data-allow-raw=\"true\" if raw input is intentional.","line":438,"column":15,"nodeType":"JSXElement","messageId":"restrictedSyntax","endLine":445,"endColumn":17}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef } from 'react';\nimport { Card, Button, Badge, Input } from '@x-ear/ui-web';\nimport { Upload, Download, FileText, AlertCircle, CheckCircle, X } from 'lucide-react';\nimport { InventoryItem } from '../../../types/inventory';\n\ninterface BulkUploadProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onUpload: (items: Partial<InventoryItem>[]) => Promise<void>;\n}\n\ninterface UploadResult {\n  success: number;\n  errors: number;\n  errorDetails: string[];\n}\n\ninterface PreviewItem {\n  row: number;\n  data: Partial<InventoryItem>;\n  errors: string[];\n  isValid: boolean;\n}\n\nexport const BulkUpload: React.FC<BulkUploadProps> = ({\n  isOpen,\n  onClose,\n  onUpload\n}) => {\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadResult, setUploadResult] = useState<UploadResult | null>(null);\n  const [previewData, setPreviewData] = useState<PreviewItem[]>([]);\n  const [showPreview, setShowPreview] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  if (!isOpen) return null;\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    const isValidFile = file.type === 'text/csv' || \n                       file.name.endsWith('.csv') ||\n                       file.type === 'application/vnd.ms-excel' ||\n                       file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ||\n                       file.name.endsWith('.xlsx') ||\n                       file.name.endsWith('.xls');\n\n    if (!isValidFile) {\n      alert('Lütfen CSV veya Excel dosyası seçin');\n      return;\n    }\n\n    setSelectedFile(file);\n    setUploadResult(null);\n    setShowPreview(false);\n\n    // For CSV files, show preview\n    if (file.type === 'text/csv' || file.name.endsWith('.csv')) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const csvContent = e.target?.result as string;\n        previewCSV(csvContent);\n      };\n      reader.readAsText(file);\n    }\n  };\n\n  const previewCSV = (csvContent: string) => {\n    try {\n      const lines = csvContent.split('\\n').filter(line => line.trim());\n      if (lines.length < 2) {\n        alert('CSV dosyası en az 2 satır içermelidir (başlık + veri)');\n        return;\n      }\n\n      const headers = lines[0].split(',').map(h => h.trim().toLowerCase());\n      const dataLines = lines.slice(1);\n\n      const preview: PreviewItem[] = dataLines.slice(0, 10).map((line, index) => {\n        const cells = line.split(',').map(cell => cell.trim().replace(/\"/g, ''));\n        const item: Partial<InventoryItem> = {};\n        const errors: string[] = [];\n\n        // Map CSV columns to item properties\n        headers.forEach((header, headerIndex) => {\n          const value = cells[headerIndex] || '';\n          \n          switch (header) {\n            case 'name':\n            case 'ürün adı':\n            case 'product name':\n              item.name = value;\n              if (!value) errors.push('Ürün adı gerekli');\n              break;\n            case 'brand':\n            case 'marka':\n              item.brand = value;\n              break;\n            case 'model':\n              item.model = value;\n              break;\n            case 'category':\n            case 'kategori':\n              item.category = value as any;\n              break;\n            case 'barcode':\n            case 'barkod':\n              item.barcode = value;\n              break;\n            case 'stock':\n            case 'stok':\n            case 'inventory':\n              const stock = parseInt(value);\n              if (!isNaN(stock)) {\n                item.availableInventory = stock;\n              } else if (value) {\n                errors.push('Stok sayısı geçersiz');\n              }\n              break;\n            case 'min stock':\n            case 'min stok':\n            case 'minimum stock':\n              const minStock = parseInt(value);\n              if (!isNaN(minStock)) {\n                item.reorderLevel = minStock;\n              }\n              break;\n            case 'price':\n            case 'fiyat':\n            case 'unit price':\n              const price = parseFloat(value);\n              if (!isNaN(price)) {\n                item.price = price;\n              } else if (value) {\n                errors.push('Fiyat geçersiz');\n              }\n              break;\n            case 'cost':\n            case 'maliyet':\n              const cost = parseFloat(value);\n              if (!isNaN(cost)) {\n                item.cost = cost;\n              }\n              break;\n            case 'supplier':\n            case 'tedarikçi':\n              item.supplier = value;\n              break;\n            case 'warranty':\n            case 'garanti':\n            case 'warranty period':\n              const warranty = parseInt(value);\n              if (!isNaN(warranty)) {\n                item.warranty = warranty;\n              }\n              break;\n            case 'description':\n            case 'açıklama':\n              item.description = value;\n              break;\n            case 'location':\n            case 'konum':\n              item.location = value;\n              break;\n            case 'sgk code':\n            case 'sgk kodu':\n              item.sgkCode = value;\n              break;\n          }\n        });\n\n        return {\n          row: index + 2, // +2 because we skip header and use 1-based indexing\n          data: item,\n          errors,\n          isValid: errors.length === 0 && !!item.name\n        };\n      });\n\n      setPreviewData(preview);\n      setShowPreview(true);\n    } catch (error) {\n      console.error('CSV preview error:', error);\n      alert('CSV dosyası önizlenirken hata oluştu');\n    }\n  };\n\n  const handleUpload = async () => {\n    if (!selectedFile) return;\n\n    setIsUploading(true);\n    setUploadResult(null);\n\n    try {\n      let csvContent: string;\n\n      if (selectedFile.type === 'text/csv' || selectedFile.name.endsWith('.csv')) {\n        csvContent = await readFileAsText(selectedFile);\n      } else {\n        // For Excel files, we would need a library like xlsx to parse\n        // For now, show an error message\n        throw new Error('Excel dosyası desteği henüz eklenmedi. Lütfen CSV dosyası kullanın.');\n      }\n\n      const result = await processBulkUpload(csvContent);\n      setUploadResult(result);\n\n      if (result.success > 0) {\n        // Refresh the inventory list\n        window.location.reload();\n      }\n\n    } catch (error) {\n      console.error('Bulk upload error:', error);\n      setUploadResult({\n        success: 0,\n        errors: 1,\n        errorDetails: [error instanceof Error ? error.message : 'Bilinmeyen hata']\n      });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const readFileAsText = (file: File): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = (e) => resolve(e.target?.result as string);\n      reader.onerror = () => reject(new Error('Dosya okunamadı'));\n      reader.readAsText(file);\n    });\n  };\n\n  const processBulkUpload = async (csvContent: string): Promise<UploadResult> => {\n    const lines = csvContent.split('\\n').filter(line => line.trim());\n    const headers = lines[0].split(',').map(h => h.trim().toLowerCase());\n    const dataLines = lines.slice(1);\n\n    let successCount = 0;\n    let errorCount = 0;\n    const errorDetails: string[] = [];\n    const validItems: Partial<InventoryItem>[] = [];\n\n    for (let i = 0; i < dataLines.length; i++) {\n      try {\n        const cells = dataLines[i].split(',').map(cell => cell.trim().replace(/\"/g, ''));\n        const item: Partial<InventoryItem> = {\n          id: `bulk_${Date.now()}_${i}`,\n          createdAt: new Date().toISOString(),\n          lastUpdated: new Date().toISOString()\n        };\n\n        // Map CSV columns to item properties\n        headers.forEach((header, index) => {\n          const value = cells[index] || '';\n          \n          switch (header) {\n            case 'name':\n            case 'ürün adı':\n            case 'product name':\n              item.name = value;\n              break;\n            case 'brand':\n            case 'marka':\n              item.brand = value;\n              break;\n            case 'model':\n              item.model = value;\n              break;\n            case 'category':\n            case 'kategori':\n              item.category = value as any;\n              break;\n            case 'barcode':\n            case 'barkod':\n              item.barcode = value;\n              break;\n            case 'stock':\n            case 'stok':\n            case 'inventory':\n              const stock = parseInt(value);\n              if (!isNaN(stock)) item.availableInventory = stock;\n              break;\n            case 'min stock':\n            case 'min stok':\n              const minStock = parseInt(value);\n              if (!isNaN(minStock)) item.reorderLevel = minStock;\n              break;\n            case 'price':\n            case 'fiyat':\n              const price = parseFloat(value);\n              if (!isNaN(price)) item.price = price;\n              break;\n            case 'cost':\n            case 'maliyet':\n              const cost = parseFloat(value);\n              if (!isNaN(cost)) item.cost = cost;\n              break;\n            case 'supplier':\n            case 'tedarikçi':\n              item.supplier = value;\n              break;\n            case 'warranty':\n            case 'garanti':\n              const warranty = parseInt(value);\n              if (!isNaN(warranty)) item.warranty = warranty;\n              break;\n            case 'description':\n            case 'açıklama':\n              item.description = value;\n              break;\n            case 'location':\n            case 'konum':\n              item.location = value;\n              break;\n            case 'sgk code':\n            case 'sgk kodu':\n              item.sgkCode = value;\n              break;\n          }\n        });\n\n        // Validate required fields\n        if (!item.name) {\n          errorDetails.push(`Satır ${i + 2}: Ürün adı gerekli`);\n          errorCount++;\n          continue;\n        }\n\n        validItems.push(item);\n        successCount++;\n\n      } catch (error) {\n        errorDetails.push(`Satır ${i + 2}: ${error instanceof Error ? error.message : 'Bilinmeyen hata'}`);\n        errorCount++;\n      }\n    }\n\n    // Upload valid items\n    if (validItems.length > 0) {\n      await onUpload(validItems);\n    }\n\n    return {\n      success: successCount,\n      errors: errorCount,\n      errorDetails\n    };\n  };\n\n  const downloadSampleFile = () => {\n    const sampleData = [\n      ['Ürün Adı', 'Marka', 'Model', 'Kategori', 'Barkod', 'Stok', 'Min Stok', 'Fiyat', 'Maliyet', 'Tedarikçi', 'Garanti', 'Açıklama', 'Konum', 'SGK Kodu'],\n      ['Örnek Ürün 1', 'Marka A', 'Model X', 'Elektronik', '1234567890123', '100', '10', '299.99', '199.99', 'Tedarikçi A', '2 yıl', 'Örnek açıklama', 'Depo A', 'SGK123'],\n      ['Örnek Ürün 2', 'Marka B', 'Model Y', 'Aksesuar', '9876543210987', '50', '5', '49.99', '29.99', 'Tedarikçi B', '1 yıl', 'Başka açıklama', 'Depo B', 'SGK456']\n    ];\n\n    const csvContent = sampleData.map(row => row.map(cell => `\"${cell}\"`).join(',')).join('\\n');\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    \n    link.setAttribute('href', url);\n    link.setAttribute('download', 'ornek_urun_listesi.csv');\n    link.style.visibility = 'hidden';\n    \n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const clearFile = () => {\n    setSelectedFile(null);\n    setPreviewData([]);\n    setShowPreview(false);\n    setUploadResult(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n          <div className=\"flex items-center space-x-3\">\n            <Upload className=\"w-6 h-6 text-blue-600\" />\n            <h2 className=\"text-xl font-semibold text-gray-900 dark:text-gray-100\">\n              Toplu Ürün Yükleme\n            </h2>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={onClose}\n            className=\"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n          >\n            <X className=\"w-6 h-6\" />\n          </Button>\n        </div>\n\n        {/* Body */}\n        <div className=\"p-6 space-y-6 overflow-y-auto max-h-[calc(90vh-140px)]\">\n          {/* Instructions */}\n          <Card className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800\">\n            <div className=\"flex items-start space-x-3\">\n              <FileText className=\"w-5 h-5 text-blue-600 mt-0.5\" />\n              <div>\n                <h4 className=\"text-sm font-medium text-blue-900 dark:text-blue-100\">\n                  Dosya Formatı\n                </h4>\n                <p className=\"text-sm text-blue-700 dark:text-blue-200 mt-1\">\n                  CSV dosyanız şu sütunları içermelidir: Ürün Adı, Marka, Model, Kategori, Barkod, Stok, Min Stok, Fiyat, Maliyet, Tedarikçi, Garanti, Açıklama, Konum, SGK Kodu\n                </p>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={downloadSampleFile}\n                  className=\"mt-2 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300\"\n                >\n                  <Download className=\"w-4 h-4 mr-2\" />\n                  Örnek Dosyayı İndir\n                </Button>\n              </div>\n            </div>\n          </Card>\n\n          {/* File Upload */}\n          <div className=\"space-y-4\">\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n              CSV/Excel Dosyası Seç\n            </label>\n            <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center hover:border-gray-400 dark:hover:border-gray-500 transition-colors\">\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\".csv,.xlsx,.xls\"\n                onChange={handleFileSelect}\n                className=\"hidden\"\n                data-allow-raw=\"true\"\n              />\n              <Upload className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\n              <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\n                Dosyayı sürükleyip bırakın veya seçmek için tıklayın\n              </p>\n              <Button\n                variant=\"outline\"\n                onClick={() => fileInputRef.current?.click()}\n              >\n                Dosya Seç\n              </Button>\n            </div>\n\n            {/* Selected File Info */}\n            {selectedFile && (\n              <div className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                <div className=\"flex items-center space-x-3\">\n                  <FileText className=\"w-5 h-5 text-gray-500\" />\n                  <div>\n                    <p className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">\n                      {selectedFile.name}\n                    </p>\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                      {(selectedFile.size / 1024).toFixed(1)} KB\n                    </p>\n                  </div>\n                </div>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={clearFile}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/* Preview */}\n          {showPreview && previewData.length > 0 && (\n            <div className=\"space-y-4\">\n              <h4 className=\"text-lg font-medium text-gray-900 dark:text-gray-100\">\n                Önizleme (İlk 10 satır)\n              </h4>\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                  <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                    <tr>\n                      <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        Satır\n                      </th>\n                      <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        Ürün Adı\n                      </th>\n                      <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        Marka\n                      </th>\n                      <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        Stok\n                      </th>\n                      <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        Fiyat\n                      </th>\n                      <th className=\"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">\n                        Durum\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                    {previewData.map((item, index) => (\n                      <tr key={index}>\n                        <td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {item.row}\n                        </td>\n                        <td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {item.data.name || '-'}\n                        </td>\n                        <td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {item.data.brand || '-'}\n                        </td>\n                        <td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {item.data.availableInventory || '-'}\n                        </td>\n                        <td className=\"px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100\">\n                          {item.data.price ? `₺${item.data.price}` : '-'}\n                        </td>\n                        <td className=\"px-3 py-2 whitespace-nowrap\">\n                          {item.isValid ? (\n                            <Badge variant=\"success\" className=\"flex items-center\">\n                              <CheckCircle className=\"w-3 h-3 mr-1\" />\n                              Geçerli\n                            </Badge>\n                          ) : (\n                            <Badge variant=\"danger\" className=\"flex items-center\">\n                              <AlertCircle className=\"w-3 h-3 mr-1\" />\n                              Hata\n                            </Badge>\n                          )}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n\n          {/* Upload Result */}\n          {uploadResult && (\n            <Card className=\"p-4\">\n              <h4 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-3\">\n                Yükleme Sonucu\n              </h4>\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center space-x-2\">\n                  <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    {uploadResult.success} ürün başarıyla yüklendi\n                  </span>\n                </div>\n                {uploadResult.errors > 0 && (\n                  <div className=\"flex items-center space-x-2\">\n                    <AlertCircle className=\"w-5 h-5 text-red-600\" />\n                    <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                      {uploadResult.errors} hatada ürün yüklenemedi\n                    </span>\n                  </div>\n                )}\n                {uploadResult.errorDetails.length > 0 && (\n                  <div className=\"mt-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg\">\n                    <h5 className=\"text-sm font-medium text-red-800 dark:text-red-200 mb-2\">\n                      Hata Detayları:\n                    </h5>\n                    <ul className=\"text-xs text-red-700 dark:text-red-300 space-y-1\">\n                      {uploadResult.errorDetails.slice(0, 10).map((error, index) => (\n                        <li key={index}>• {error}</li>\n                      ))}\n                      {uploadResult.errorDetails.length > 10 && (\n                        <li>... ve {uploadResult.errorDetails.length - 10} hata daha</li>\n                      )}\n                    </ul>\n                  </div>\n                )}\n              </div>\n            </Card>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700\">\n          <Button variant=\"outline\" onClick={onClose}>\n            İptal\n          </Button>\n          <Button\n            onClick={handleUpload}\n            disabled={!selectedFile || isUploading}\n            loading={isUploading}\n          >\n            {isUploading ? 'Yükleniyor...' : 'Ürünleri Yükle'}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default BulkUpload;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/DeleteConfirmModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/FeatureTagInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/InventoryFilters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/InventoryForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1579,1582],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1579,1582],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { InventoryItem, InventoryCategory, InventoryType, EarDirection } from '../../../types/inventory';\nimport { Button, Input, Select, Textarea, Checkbox } from '@x-ear/ui-web';\n\ninterface InventoryFormProps {\n  item?: InventoryItem | null;\n  onSubmit: (data: Partial<InventoryItem>) => void;\n  onCancel: () => void;\n  isLoading?: boolean;\n}\n\nconst InventoryForm: React.FC<InventoryFormProps> = ({\n  item,\n  onSubmit,\n  onCancel,\n  isLoading = false,\n}) => {\n  const [formData, setFormData] = useState({\n    name: item?.name || '',\n    brand: item?.brand || '',\n    model: item?.model || '',\n    category: item?.category || 'hearing_aid' as InventoryCategory,\n    type: item?.type || 'digital_programmable' as InventoryType,\n    barcode: item?.barcode || '',\n    supplier: item?.supplier || '',\n    description: item?.description || '',\n    availableInventory: item?.availableInventory || 0,\n    totalInventory: item?.totalInventory || 0,\n    reorderLevel: item?.reorderLevel || 5,\n    price: item?.price || 0,\n    cost: item?.cost || 0,\n    wholesalePrice: item?.wholesalePrice || 0,\n    retailPrice: item?.retailPrice || 0,\n    features: item?.features?.join(', ') || '',\n    ear: item?.ear || 'both' as EarDirection,\n    sgkCode: item?.sgkCode || '',\n    isMinistryTracked: item?.isMinistryTracked || false,\n    warranty: item?.warranty || 24,\n    location: item?.location || '',\n    notes: item?.notes || '',\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  const handleChange = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.name.trim()) {\n      newErrors.name = 'Ürün adı zorunludur';\n    }\n    if (!formData.brand.trim()) {\n      newErrors.brand = 'Marka zorunludur';\n    }\n    if (!formData.category) {\n      newErrors.category = 'Kategori seçimi zorunludur';\n    }\n    if (formData.price <= 0) {\n      newErrors.price = 'Fiyat 0\\'dan büyük olmalıdır';\n    }\n    if (formData.availableInventory < 0) {\n      newErrors.availableInventory = 'Stok miktarı negatif olamaz';\n    }\n    if (formData.reorderLevel < 0) {\n      newErrors.reorderLevel = 'Minimum stok seviyesi negatif olamaz';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    const submitData = {\n      ...formData,\n      features: formData.features ? formData.features.split(',').map(f => f.trim()).filter(f => f) : [],\n      totalInventory: Math.max(formData.totalInventory, formData.availableInventory),\n      usedInventory: Math.max(0, formData.totalInventory - formData.availableInventory),\n    };\n\n    onSubmit(submitData);\n  };\n\n  const categoryOptions = [\n    { value: 'hearing_aid', label: 'İşitme Cihazı' },\n    { value: 'battery', label: 'Pil' },\n    { value: 'accessory', label: 'Aksesuar' },\n    { value: 'ear_mold', label: 'Kulak Kalıbı' },\n    { value: 'cleaning_supplies', label: 'Temizlik Malzemeleri' },\n    { value: 'amplifiers', label: 'Amplifikatör' },\n  ];\n\n  const typeOptions = [\n    { value: 'digital_programmable', label: 'Dijital Programlanabilir' },\n    { value: 'rechargeable_digital', label: 'Şarj Edilebilir Dijital' },\n    { value: 'zinc_air', label: 'Çinko Hava' },\n    { value: 'custom_silicone', label: 'Özel Silikon' },\n    { value: 'maintenance_kit', label: 'Bakım Kiti' },\n    { value: 'wireless_amplifier', label: 'Kablosuz Amplifikatör' },\n  ];\n\n  const earOptions = [\n    { value: 'left', label: 'Sol' },\n    { value: 'right', label: 'Sağ' },\n    { value: 'both', label: 'Her İkisi' },\n  ];\n\n  const brandOptions = [\n    { value: '', label: 'Marka seçin' },\n    { value: 'Phonak', label: 'Phonak' },\n    { value: 'Oticon', label: 'Oticon' },\n    { value: 'Widex', label: 'Widex' },\n    { value: 'Signia', label: 'Signia' },\n    { value: 'ReSound', label: 'ReSound' },\n    { value: 'Starkey', label: 'Starkey' },\n    { value: 'Unitron', label: 'Unitron' },\n    { value: 'Bernafon', label: 'Bernafon' }\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-6\">\n      {/* Basic Information */}\n      <div className=\"bg-gray-50 p-4 rounded-lg\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Temel Bilgiler</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Ürün Adı *\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.name}\n              onChange={(e) => handleChange('name', e.target.value)}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.name ? 'border-red-500' : 'border-gray-300'\n              }`}\n              placeholder=\"Ürün adını girin\"\n            />\n            {errors.name && <p className=\"text-red-500 text-sm mt-1\">{errors.name}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Marka *\n            </label>\n            <Select\n              value={formData.brand}\n              onChange={(e) => handleChange('brand', e.target.value)}\n              options={brandOptions}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.brand ? 'border-red-500' : 'border-gray-300'\n              }`}\n            />\n            {errors.brand && <p className=\"text-red-500 text-sm mt-1\">{errors.brand}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Model\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.model}\n              onChange={(e) => handleChange('model', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"Model adını girin\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Kategori *\n            </label>\n            <Select\n              value={formData.category}\n              onChange={(e) => handleChange('category', e.target.value)}\n              options={categoryOptions}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.category ? 'border-red-500' : 'border-gray-300'\n              }`}\n            />\n            {errors.category && <p className=\"text-red-500 text-sm mt-1\">{errors.category}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Tip\n            </label>\n            <Select\n              value={formData.type}\n              onChange={(e) => handleChange('type', e.target.value)}\n              options={typeOptions}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Kulak\n            </label>\n            <Select\n              value={formData.ear}\n              onChange={(e) => handleChange('ear', e.target.value)}\n              options={earOptions}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Inventory Information */}\n      <div className=\"bg-gray-50 p-4 rounded-lg\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Stok Bilgileri</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Mevcut Stok *\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              value={formData.availableInventory}\n              onChange={(e) => handleChange('availableInventory', parseInt(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.availableInventory ? 'border-red-500' : 'border-gray-300'\n              }`}\n            />\n            {errors.availableInventory && <p className=\"text-red-500 text-sm mt-1\">{errors.availableInventory}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Toplam Stok\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              value={formData.totalInventory}\n              onChange={(e) => handleChange('totalInventory', parseInt(e.target.value) || 0)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Minimum Stok Seviyesi *\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              value={formData.reorderLevel}\n              onChange={(e) => handleChange('reorderLevel', parseInt(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.reorderLevel ? 'border-red-500' : 'border-gray-300'\n              }`}\n            />\n            {errors.reorderLevel && <p className=\"text-red-500 text-sm mt-1\">{errors.reorderLevel}</p>}\n          </div>\n        </div>\n      </div>\n\n      {/* Pricing Information */}\n      <div className=\"bg-gray-50 p-4 rounded-lg\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Fiyat Bilgileri</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Satış Fiyatı (₺) *\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.price}\n              onChange={(e) => handleChange('price', parseFloat(e.target.value) || 0)}\n              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${\n                errors.price ? 'border-red-500' : 'border-gray-300'\n              }`}\n            />\n            {errors.price && <p className=\"text-red-500 text-sm mt-1\">{errors.price}</p>}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Maliyet (₺)\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.cost}\n              onChange={(e) => handleChange('cost', parseFloat(e.target.value) || 0)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Toptan Fiyat (₺)\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.wholesalePrice}\n              onChange={(e) => handleChange('wholesalePrice', parseFloat(e.target.value) || 0)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Perakende Fiyat (₺)\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.retailPrice}\n              onChange={(e) => handleChange('retailPrice', parseFloat(e.target.value) || 0)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Additional Information */}\n      <div className=\"bg-gray-50 p-4 rounded-lg\">\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Ek Bilgiler</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Barkod\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.barcode}\n              onChange={(e) => handleChange('barcode', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"Barkod numarası\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Tedarikçi\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.supplier}\n              onChange={(e) => handleChange('supplier', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"Tedarikçi adı\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              SGK Kodu\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.sgkCode}\n              onChange={(e) => handleChange('sgkCode', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"SGK kodu\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Garanti (Ay)\n            </label>\n            <Input\n              type=\"number\"\n              min=\"0\"\n              value={formData.warranty}\n              onChange={(e) => handleChange('warranty', parseInt(e.target.value) || 0)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Konum\n            </label>\n            <Input\n              type=\"text\"\n              value={formData.location}\n              onChange={(e) => handleChange('location', e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"Depo konumu\"\n            />\n          </div>\n\n          <div className=\"flex items-center\">\n            <Checkbox\n              checked={formData.isMinistryTracked}\n              onChange={(e) => handleChange('isMinistryTracked', e.target.checked)}\n            />\n            <label htmlFor=\"isMinistryTracked\" className=\"ml-2 block text-sm text-gray-900\">\n              Bakanlık takipli\n            </label>\n          </div>\n        </div>\n\n        <div className=\"mt-4\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Özellikler\n          </label>\n          <Input\n            type=\"text\"\n            value={formData.features}\n            onChange={(e) => handleChange('features', e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            placeholder=\"Özellikleri virgülle ayırın (örn: Bluetooth, Su geçirmez, Şarj edilebilir)\"\n          />\n        </div>\n\n        <div className=\"mt-4\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Açıklama\n          </label>\n          <Textarea\n            value={formData.description}\n            onChange={(e) => handleChange('description', e.target.value)}\n            rows={3}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            placeholder=\"Ürün açıklaması\"\n          />\n        </div>\n\n        <div className=\"mt-4\">\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Notlar\n          </label>\n          <Textarea\n            value={formData.notes}\n            onChange={(e) => handleChange('notes', e.target.value)}\n            rows={2}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            placeholder=\"Ek notlar\"\n          />\n        </div>\n      </div>\n\n      {/* Form Actions */}\n      <div className=\"flex justify-end space-x-3 pt-6 border-t\">\n        <Button\n          type=\"button\"\n          variant=\"secondary\"\n          onClick={onCancel}\n          disabled={isLoading}\n        >\n          İptal\n        </Button>\n        <Button\n          type=\"submit\"\n          disabled={isLoading}\n        >\n          {isLoading ? 'Kaydediliyor...' : (item ? 'Güncelle' : 'Kaydet')}\n        </Button>\n      </div>\n    </form>\n  );\n};\n\nexport default InventoryForm;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/InventoryTable.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'someSelected' is assigned a value but never used.","line":117,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":117,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport { InventoryItem } from '../../../types/inventory';\nimport { Button, Checkbox, Select } from '@x-ear/ui-web';\nimport { \n  ChevronUp, \n  ChevronDown, \n  Edit, \n  Trash2, \n  Eye,\n  Printer,\n  Copy,\n  ToggleLeft,\n  ToggleRight\n} from 'lucide-react';\n\ninterface InventoryTableProps {\n  items: InventoryItem[];\n  selectedItems: string[];\n  onSelectItem: (id: string) => void;\n  onSelectAll: (selected: boolean) => void;\n  onEdit: (item: InventoryItem) => void;\n  onDelete: (item: InventoryItem) => void;\n  onView: (item: InventoryItem) => void;\n  onUpdateStock: (item: InventoryItem) => void;\n  onGenerateBarcode: (item: InventoryItem) => void;\n  onDuplicate?: (item: InventoryItem) => void;\n  onToggleStatus?: (item: InventoryItem) => void;\n  currentPage: number;\n  itemsPerPage: number;\n  onPageChange: (page: number) => void;\n  onItemsPerPageChange?: (itemsPerPage: number) => void;\n}\n\ntype SortField = keyof InventoryItem;\ntype SortDirection = 'asc' | 'desc';\n\nconst InventoryTable: React.FC<InventoryTableProps> = ({\n  items,\n  selectedItems,\n  onSelectItem,\n  onSelectAll,\n  onEdit,\n  onDelete,\n  onView,\n  onUpdateStock,\n  onGenerateBarcode,\n  onDuplicate,\n  onToggleStatus,\n  currentPage,\n  itemsPerPage,\n  onPageChange,\n  onItemsPerPageChange,\n}) => {\n  const [sortField, setSortField] = useState<SortField>('name');\n  const [sortDirection, setSortDirection] = useState<SortDirection>('asc');\n\n  const sortedItems = useMemo(() => {\n    return [...items].sort((a, b) => {\n      const aValue = a[sortField];\n      const bValue = b[sortField];\n      \n      if (aValue === bValue) return 0;\n      if (aValue == null) return 1;\n      if (bValue == null) return -1;\n      \n      const comparison = aValue < bValue ? -1 : 1;\n      return sortDirection === 'asc' ? comparison : -comparison;\n    });\n  }, [items, sortField, sortDirection]);\n\n  const paginatedItems = useMemo(() => {\n    const startIndex = (currentPage - 1) * itemsPerPage;\n    return sortedItems.slice(startIndex, startIndex + itemsPerPage);\n  }, [sortedItems, currentPage, itemsPerPage]);\n\n  const totalPages = Math.ceil(items.length / itemsPerPage);\n\n  const handleSort = (field: SortField) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const getSortIcon = (field: SortField) => {\n    if (sortField !== field) return null;\n    return sortDirection === 'asc' ? \n      <ChevronUp className=\"w-4 h-4\" /> : \n      <ChevronDown className=\"w-4 h-4\" />;\n  };\n\n  const getStockStatus = (item: InventoryItem) => {\n    if (item.availableInventory === 0) {\n      return { label: 'Stok Yok', color: 'bg-red-100 text-red-800' };\n    } else if (item.availableInventory <= item.reorderLevel) {\n      return { label: 'Düşük Stok', color: 'bg-yellow-100 text-yellow-800' };\n    } else {\n      return { label: 'Stokta', color: 'bg-green-100 text-green-800' };\n    }\n  };\n\n  const getCategoryLabel = (category: string) => {\n    const categoryMap: Record<string, string> = {\n      'hearing_aid': 'İşitme Cihazı',\n      'battery': 'Pil',\n      'accessory': 'Aksesuar',\n      'ear_mold': 'Kulak Kalıbı',\n      'cleaning_supplies': 'Temizlik Malzemeleri',\n      'amplifiers': 'Amplifikatör',\n    };\n    return categoryMap[category] || category;\n  };\n\n  const allSelected = selectedItems.length === paginatedItems.length && paginatedItems.length > 0;\n  const someSelected = selectedItems.length > 0 && selectedItems.length < paginatedItems.length;\n\n  const itemsPerPageOptions = [\n    { value: '10', label: '10 / sayfa' },\n    { value: '20', label: '20 / sayfa' },\n    { value: '50', label: '50 / sayfa' },\n    { value: '100', label: '100 / sayfa' }\n  ];\n\n  return (\n    <div className=\"bg-white shadow-sm rounded-lg overflow-hidden\">\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-6 py-3 text-left\">\n                <Checkbox\n                  checked={allSelected}\n                  onChange={(e) => onSelectAll(e.target.checked)}\n                  className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                />\n              </th>\n              \n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('name')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Ürün Adı</span>\n                  {getSortIcon('name')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('brand')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Marka</span>\n                  {getSortIcon('brand')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('model')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Model</span>\n                  {getSortIcon('model')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('category')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Kategori</span>\n                  {getSortIcon('category')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('barcode')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Barkod</span>\n                  {getSortIcon('barcode')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('availableInventory')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Stok</span>\n                  {getSortIcon('availableInventory')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('reorderLevel')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Min. Stok</span>\n                  {getSortIcon('reorderLevel')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('price')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Fiyat</span>\n                  {getSortIcon('price')}\n                </div>\n              </th>\n\n              <th \n                className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100\"\n                onClick={() => handleSort('status')}\n              >\n                <div className=\"flex items-center space-x-1\">\n                  <span>Durum</span>\n                  {getSortIcon('status')}\n                </div>\n              </th>\n\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                İşlemler\n              </th>\n            </tr>\n          </thead>\n          \n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {paginatedItems.map((item) => {\n              const stockStatus = getStockStatus(item);\n              const isSelected = selectedItems.includes(item.id);\n              \n              return (\n                <tr \n                  key={item.id} \n                  className={`hover:bg-gray-50 ${isSelected ? 'bg-blue-50' : ''}`}\n                >\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <Checkbox\n                      checked={isSelected}\n                      onChange={() => onSelectItem(item.id)}\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                    />\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div \n                      className=\"text-sm font-medium text-gray-900 cursor-pointer hover:text-blue-600 hover:underline\"\n                      onClick={() => onView(item)}\n                    >\n                      {item.name}\n                    </div>\n                    {item.description && (\n                      <div className=\"text-sm text-gray-500 truncate max-w-xs\">\n                        {item.description}\n                      </div>\n                    )}\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {item.brand}\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {item.model || '-'}\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className=\"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800\">\n                      {getCategoryLabel(item.category)}\n                    </span>\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-mono\">\n                    {item.barcode || '-'}\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    <div className=\"flex flex-col\">\n                      <span className=\"font-medium\">{item.availableInventory}</span>\n                      <span className=\"text-xs text-gray-500\">/ {item.totalInventory}</span>\n                    </div>\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {item.reorderLevel}\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    ₺{item.price.toLocaleString('tr-TR', { minimumFractionDigits: 2 })}\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${stockStatus.color}`}>\n                      {stockStatus.label}\n                    </span>\n                  </td>\n                  \n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Button\n                        variant=\"ghost\"\n                       \n                        onClick={() => onView(item)}\n                        className=\"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-100\"\n                        title=\"Detayları Görüntüle\"\n                      >\n                        <Eye className=\"w-4 h-4\" />\n                      </Button>\n                      \n                      <Button\n                        variant=\"ghost\"\n                       \n                        onClick={() => onEdit(item)}\n                        className=\"text-indigo-600 hover:text-indigo-900 p-1 rounded hover:bg-indigo-100\"\n                        title=\"Düzenle\"\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      \n                      {onDuplicate && (\n                        <Button\n                          variant=\"ghost\"\n                         \n                          onClick={() => onDuplicate(item)}\n                          className=\"text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-100\"\n                          title=\"Kopyala\"\n                        >\n                          <Copy className=\"w-4 h-4\" />\n                        </Button>\n                      )}\n                      \n                      <Button\n                        variant=\"ghost\"\n                       \n                        onClick={() => onUpdateStock(item)}\n                        className=\"text-orange-600 hover:text-orange-900 p-1 rounded hover:bg-orange-100\"\n                        title=\"Stok Güncelle\"\n                      >\n                        <Printer className=\"w-4 h-4\" />\n                      </Button>\n                      \n                      <Button\n                        variant=\"ghost\"\n                       \n                        onClick={() => onGenerateBarcode(item)}\n                        className=\"text-purple-600 hover:text-purple-900 p-1 rounded hover:bg-purple-100\"\n                        title=\"Barkod Oluştur\"\n                      >\n                        <Printer className=\"w-4 h-4\" />\n                      </Button>\n                      \n                      {onToggleStatus && (\n                        <Button\n                          variant=\"ghost\"\n                         \n                          onClick={() => onToggleStatus(item)}\n                          className={`p-1 rounded ${\n                            item.status === 'available' \n                              ? 'text-green-600 hover:text-green-900 hover:bg-green-100' \n                              : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'\n                          }`}\n                          title={item.status === 'available' ? 'Pasif Yap' : 'Aktif Yap'}\n                        >\n                          {item.status === 'available' ? (\n                            <ToggleRight className=\"w-4 h-4\" />\n                          ) : (\n                            <ToggleLeft className=\"w-4 h-4\" />\n                          )}\n                        </Button>\n                      )}\n                      \n                      <Button\n                        variant=\"ghost\"\n                       \n                        onClick={() => onDelete(item)}\n                        className=\"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-100\"\n                        title=\"Sil\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6\">\n          <div className=\"flex-1 flex justify-between sm:hidden\">\n            <Button\n              variant=\"secondary\"\n              onClick={() => onPageChange(currentPage - 1)}\n              disabled={currentPage === 1}\n            >\n              Önceki\n            </Button>\n            <Button\n              variant=\"secondary\"\n              onClick={() => onPageChange(currentPage + 1)}\n              disabled={currentPage === totalPages}\n            >\n              Sonraki\n            </Button>\n          </div>\n          \n          <div className=\"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between\">\n            <div className=\"flex items-center space-x-4\">\n              <p className=\"text-sm text-gray-700\">\n                Toplam <span className=\"font-medium\">{items.length}</span> üründen{' '}\n                <span className=\"font-medium\">{(currentPage - 1) * itemsPerPage + 1}</span> -{' '}\n                <span className=\"font-medium\">\n                  {Math.min(currentPage * itemsPerPage, items.length)}\n                </span>{' '}\n                arası gösteriliyor\n              </p>\n              \n              {onItemsPerPageChange && (\n                <Select\n                  value={itemsPerPage.toString()}\n                  onChange={(e) => onItemsPerPageChange(Number(e.target.value))}\n                  options={itemsPerPageOptions}\n                  className=\"px-2 py-1 border border-gray-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              )}\n            </div>\n            \n            <div>\n              <nav className=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\">\n                {/* First page button */}\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => onPageChange(1)}\n                  disabled={currentPage === 1}\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"İlk sayfa\"\n                >\n                  İlk\n                </Button>\n                \n                {/* Previous page button */}\n                <Button\n                  variant=\"ghost\"\n                 \n                  onClick={() => onPageChange(currentPage - 1)}\n                  disabled={currentPage === 1}\n                  className=\"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Önceki\n                </Button>\n                \n                {/* Page numbers with ellipsis */}\n                {(() => {\n                  const getVisiblePages = () => {\n                    const maxVisible = 5;\n                    const pages: number[] = [];\n                    \n                    if (totalPages <= maxVisible) {\n                      for (let i = 1; i <= totalPages; i++) {\n                        pages.push(i);\n                      }\n                    } else {\n                      const start = Math.max(1, currentPage - Math.floor(maxVisible / 2));\n                      const end = Math.min(totalPages, start + maxVisible - 1);\n                      \n                      for (let i = start; i <= end; i++) {\n                        pages.push(i);\n                      }\n                      \n                      // Add ellipsis if needed\n                      if (start > 1) {\n                        pages.unshift(-1); // -1 represents ellipsis\n                        pages.unshift(1);\n                      }\n                      if (end < totalPages) {\n                        pages.push(-2); // -2 represents ellipsis\n                        pages.push(totalPages);\n                      }\n                    }\n                    \n                    return pages;\n                  };\n                  \n                  const visiblePages = getVisiblePages();\n                  \n                  return visiblePages.map((page, index) => {\n                    if (page === -1 || page === -2) {\n                      return (\n                        <span key={`ellipsis-${index}`} className=\"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-400\">\n                          ...\n                        </span>\n                      );\n                    }\n                    \n                    return (\n                      <Button\n                        key={page}\n                        variant=\"ghost\"\n                       \n                        onClick={() => onPageChange(page)}\n                        className={`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${\n                          page === currentPage\n                            ? 'z-10 bg-blue-50 border-blue-500 text-blue-600'\n                            : 'bg-white border-gray-300 text-gray-500 hover:bg-gray-50'\n                        }`}\n                      >\n                        {page}\n                      </Button>\n                    );\n                  });\n                })()}\n                \n                {/* Next page button */}\n                <Button\n                  variant=\"ghost\"\n                 \n                  onClick={() => onPageChange(currentPage + 1)}\n                  disabled={currentPage === totalPages}\n                  className=\"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Sonraki\n                </Button>\n                \n                {/* Last page button */}\n                <Button\n                  variant=\"ghost\"\n                 \n                  onClick={() => onPageChange(totalPages)}\n                  disabled={currentPage === totalPages}\n                  className=\"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title=\"Son sayfa\"\n                >\n                  Son\n                </Button>\n              </nav>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {items.length === 0 && (\n        <div className=\"text-center py-12\">\n          <div className=\"text-gray-500\">\n            <svg className=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-4m-4 0H9m-4 0h4m0 0V9a2 2 0 012-2h2a2 2 0 012 2v4.01\" />\n            </svg>\n            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Ürün bulunamadı</h3>\n            <p className=\"mt-1 text-sm text-gray-500\">Henüz hiç ürün eklenmemiş.</p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default InventoryTable;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/ProductDetailsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/ProductForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TYPES' is assigned a value but never used.","line":30,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":55},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":173,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5393,5396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5393,5396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":186,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5677,5680],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5677,5680],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button, Input, Select, Textarea, Checkbox, Radio } from '@x-ear/ui-web';\nimport { InventoryFormData, InventoryCategory, InventoryType, EarDirection, InventoryItem } from '../../../types/inventory';\n\nimport { FeatureTagInput } from './FeatureTagInput';\nimport { SupplierAutocomplete } from './SupplierAutocomplete';\n\ninterface ProductFormProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSubmit: (data: InventoryFormData) => Promise<void>;\n  initialData?: InventoryItem | null;\n  mode: 'create' | 'edit';\n}\n\nconst BRANDS = [\n  'Phonak', 'Oticon', 'Widex', 'Signia', 'ReSound', \n  'Starkey', 'Unitron', 'Bernafon', 'Hansaton', 'Sonic'\n];\n\nconst CATEGORIES: { value: InventoryCategory; label: string; icon: string }[] = [\n  { value: 'hearing_aid', label: 'İşitme Cihazı', icon: '🦻' },\n  { value: 'battery', label: 'Pil', icon: '🔋' },\n  { value: 'accessory', label: 'Aksesuar', icon: '🔌' },\n  { value: 'ear_mold', label: 'Kulak Kalıbı', icon: '👂' },\n  { value: 'cleaning_supplies', label: 'Temizlik Malzemesi', icon: '🧽' },\n  { value: 'amplifiers', label: 'Amplifikatör', icon: '📢' }\n];\n\nconst TYPES: { value: InventoryType; label: string }[] = [\n  { value: 'digital_programmable', label: 'Dijital Programlanabilir' },\n  { value: 'rechargeable_digital', label: 'Şarjlı Dijital' },\n  { value: 'zinc_air', label: 'Çinko Hava' },\n  { value: 'custom_silicone', label: 'Özel Silikon' },\n  { value: 'maintenance_kit', label: 'Bakım Kiti' },\n  { value: 'wireless_amplifier', label: 'Kablosuz Amplifikatör' }\n];\n\nconst EAR_DIRECTIONS: { value: EarDirection; label: string }[] = [\n  { value: 'left', label: 'Sol' },\n  { value: 'right', label: 'Sağ' },\n  { value: 'both', label: 'Her İki Kulak' }\n];\n\nconst VAT_RATES = [\n  { value: '0', label: '%0' },\n  { value: '1', label: '%1' },\n  { value: '8', label: '%8' },\n  { value: '18', label: '%18' },\n  { value: '20', label: '%20' }\n];\n\nexport const ProductForm: React.FC<ProductFormProps> = ({\n  isOpen,\n  onClose,\n  onSubmit,\n  initialData,\n  mode\n}) => {\n  const [formData, setFormData] = useState<InventoryFormData>({\n    name: '',\n    brand: '',\n    model: '',\n    category: 'hearing_aid',\n    type: 'digital_programmable',\n    supplier: '',\n    description: '',\n    availableInventory: 0,\n    reorderLevel: 5,\n    price: 0,\n    cost: 0,\n    features: [],\n    ear: 'both',\n    sgkCode: '',\n    isMinistryTracked: false,\n    warranty: 12,\n    location: '',\n    notes: '',\n    barcode: ''\n  });\n\n  const [extendedData, setExtendedData] = useState({\n    serialNumbers: [] as string[],\n    onTrialQuantity: 0,\n    vatRate: '18',\n    priceWithVat: 0,\n    totalInventoryValue: 0\n  });\n\n  // Calculate price with VAT\n  useEffect(() => {\n    const vatMultiplier = 1 + (parseFloat(extendedData.vatRate) / 100);\n    setExtendedData(prev => ({\n      ...prev,\n      priceWithVat: formData.price * vatMultiplier\n    }));\n  }, [formData.price, extendedData.vatRate]);\n\n  // Calculate total inventory value\n  useEffect(() => {\n    setExtendedData(prev => ({\n      ...prev,\n      totalInventoryValue: extendedData.priceWithVat * formData.availableInventory\n    }));\n  }, [extendedData.priceWithVat, formData.availableInventory]);\n\n  // Initialize form data when modal opens or initialData changes\n  useEffect(() => {\n    if (isOpen) {\n      if (initialData && mode === 'edit') {\n        setFormData({\n          name: initialData.name || '',\n          brand: initialData.brand || '',\n          model: initialData.model || '',\n          category: initialData.category || 'hearing_aid',\n          type: initialData.type || 'digital_programmable',\n          supplier: initialData.supplier || '',\n          description: initialData.description || '',\n          availableInventory: initialData.availableInventory || 0,\n          reorderLevel: initialData.reorderLevel || 5,\n          price: initialData.price || 0,\n          cost: initialData.cost || 0,\n          features: initialData.features || [],\n          ear: initialData.ear || 'both',\n          sgkCode: initialData.sgkCode || '',\n          isMinistryTracked: initialData.isMinistryTracked || false,\n          warranty: initialData.warranty || 12,\n          location: initialData.location || '',\n          notes: initialData.notes || '',\n          barcode: initialData.barcode || ''\n        });\n        setExtendedData({\n          serialNumbers: [],\n          onTrialQuantity: 0,\n          vatRate: '18',\n          priceWithVat: 0,\n          totalInventoryValue: 0\n        });\n      } else {\n        // Reset form for create mode\n        setFormData({\n          name: '',\n          brand: '',\n          model: '',\n          category: 'hearing_aid',\n          type: 'digital_programmable',\n          supplier: '',\n          description: '',\n          availableInventory: 0,\n          reorderLevel: 5,\n          price: 0,\n          cost: 0,\n          features: [],\n          ear: 'both',\n          sgkCode: '',\n          isMinistryTracked: false,\n          warranty: 12,\n          location: '',\n          notes: '',\n          barcode: ''\n        });\n        setExtendedData({\n          serialNumbers: [],\n          onTrialQuantity: 0,\n          vatRate: '18',\n          priceWithVat: 0,\n          totalInventoryValue: 0\n        });\n      }\n    }\n  }, [isOpen, initialData, mode]);\n\n  const handleInputChange = (field: keyof InventoryFormData, value: any) => {\n    setFormData(prev => {\n      // Eğer değer değişmemişse state'i güncelleme\n      if (prev[field] === value) {\n        return prev;\n      }\n      return {\n        ...prev,\n        [field]: value\n      };\n    });\n  };\n\n  const handleExtendedChange = (field: string, value: any) => {\n    setExtendedData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  };\n\n  const handleFeaturesChange = (features: string[]) => {\n    setFormData(prev => ({\n      ...prev,\n      features\n    }));\n  };\n\n  const validateForm = (): boolean => {\n    if (!formData.name.trim()) {\n      alert('Ürün adı gereklidir');\n      return false;\n    }\n    if (!formData.brand.trim()) {\n      alert('Marka gereklidir');\n      return false;\n    }\n    return true;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    try {\n      await onSubmit(formData);\n      onClose();\n    } catch (error) {\n      console.error('Form submission error:', error);\n      alert('Kayıt sırasında hata oluştu');\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-gray-100\">\n            {mode === 'create' ? 'Yeni Ürün Ekle' : 'Ürün Düzenle'}\n          </h2>\n          <Button\n            onClick={onClose}\n            variant=\"ghost\"\n            size=\"sm\"\n          >\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </Button>\n        </div>\n\n        {/* Form Body */}\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-8\">\n          {/* Temel Bilgiler */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2\">\n              Temel Bilgiler\n            </h3>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div>\n                <Select\n                  label=\"Kategori\"\n                  value={formData.category}\n                  onChange={(e) => handleInputChange('category', e.target.value as InventoryCategory)}\n                  options={CATEGORIES.map(cat => ({ value: cat.value, label: `${cat.icon} ${cat.label}` }))}\n                  required\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Ürün Adı *\n                </label>\n                <Input\n                  key=\"product-name\"\n                  type=\"text\"\n                  value={formData.name}\n                  onChange={(e) => handleInputChange('name', e.target.value)}\n                  placeholder=\"Ürün adını girin\"\n                  className=\"w-full\"\n                  required\n                />\n              </div>\n\n              <div>\n                <Select\n                  label=\"Marka\"\n                  value={formData.brand}\n                  onChange={(e) => handleInputChange('brand', e.target.value)}\n                  options={[{ value: '', label: 'Marka seçin' }, ...BRANDS.map(brand => ({ value: brand, label: brand }))]}\n                  required\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Model\n                </label>\n                <Input\n                  key=\"product-model\"\n                  type=\"text\"\n                  value={formData.model}\n                  onChange={(e) => handleInputChange('model', e.target.value)}\n                  placeholder=\"Model adını girin\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Barkod No\n                </label>\n                <Input\n                  key=\"product-barcode\"\n                  type=\"text\"\n                  value={formData.barcode}\n                  onChange={(e) => handleInputChange('barcode', e.target.value)}\n                  placeholder=\"Barkod numarasını girin\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Cihaz Yönü\n                </label>\n                <div className=\"flex gap-4\">\n                  {EAR_DIRECTIONS.map(direction => (\n                    <Radio\n                      key={direction.value}\n                      name=\"ear\"\n                      value={direction.value}\n                      checked={formData.ear === direction.value}\n                      onChange={(e) => handleInputChange('ear', e.target.value as EarDirection)}\n                      label={direction.label}\n                    />\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Özellikler ve Tedarikçi */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2\">\n              Ek Bilgiler\n            </h3>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Özellikler\n                </label>\n                <FeatureTagInput\n                  value={formData.features || []}\n                  onChange={handleFeaturesChange}\n                  placeholder=\"Özellik ekleyin ve Enter'a basın\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Tedarikçi\n                </label>\n                <SupplierAutocomplete\n                  value={formData.supplier || ''}\n                  onChange={(value) => handleInputChange('supplier', value)}\n                  placeholder=\"Tedarikçi seçin veya ekleyin\"\n                />\n              </div>\n\n              <div className=\"md:col-span-2\">\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Seri Numaraları\n                </label>\n                <div className=\"flex items-center gap-2\">\n                  <Input\n                    type=\"text\"\n                    placeholder=\"Seri numaraları buraya eklenecek\"\n                    className=\"flex-1\"\n                    disabled\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => {\n                      // Open serial numbers modal\n                      console.log('Open serial numbers modal');\n                    }}\n                  >\n                    Liste Aç\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"md:col-span-2\">\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Açıklama\n                </label>\n                <Textarea\n                  value={formData.description}\n                  onChange={(e) => handleInputChange('description', e.target.value)}\n                  placeholder=\"Ürün açıklamasını girin\"\n                  rows={3}\n                  className=\"w-full\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Stok Bilgileri */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2\">\n              Stok Bilgileri\n            </h3>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Mevcut Stok\n                </label>\n                <Input\n                  key=\"available-inventory\"\n                  type=\"number\"\n                  value={formData.availableInventory}\n                  onChange={(e) => handleInputChange('availableInventory', parseInt(e.target.value) || 0)}\n                  min=\"0\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Minimum Stok\n                </label>\n                <Input\n                  key=\"reorder-level\"\n                  type=\"number\"\n                  value={formData.reorderLevel}\n                  onChange={(e) => handleInputChange('reorderLevel', parseInt(e.target.value) || 0)}\n                  min=\"0\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Denemede\n                </label>\n                <Input\n                  key=\"on-trial-quantity\"\n                  type=\"number\"\n                  value={extendedData.onTrialQuantity}\n                  onChange={(e) => handleExtendedChange('onTrialQuantity', parseInt(e.target.value) || 0)}\n                  min=\"0\"\n                  className=\"w-full\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Fiyat Bilgileri */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2\">\n              Fiyat Bilgileri\n            </h3>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Birim Fiyat (₺)\n                </label>\n                <Input\n                  key=\"unit-price\"\n                  type=\"number\"\n                  value={formData.price}\n                  onChange={(e) => handleInputChange('price', parseFloat(e.target.value) || 0)}\n                  min=\"0\"\n                  step=\"0.01\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <Select\n                  label=\"KDV Oranı\"\n                  value={extendedData.vatRate}\n                  onChange={(e) => handleExtendedChange('vatRate', e.target.value)}\n                  options={VAT_RATES.map(rate => ({ value: rate.value, label: rate.label }))}\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  KDV Dahil Birim Fiyat (₺)\n                </label>\n                <Input\n                  type=\"number\"\n                  value={extendedData.priceWithVat.toFixed(2)}\n                  disabled\n                  className=\"w-full bg-gray-50 dark:bg-gray-700\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Toplam Stok Değeri (₺)\n                </label>\n                <Input\n                  type=\"number\"\n                  value={extendedData.totalInventoryValue.toFixed(2)}\n                  disabled\n                  className=\"w-full bg-gray-50 dark:bg-gray-700\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Garanti Bilgileri */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 border-b border-gray-200 dark:border-gray-700 pb-2\">\n              Garanti Bilgileri\n            </h3>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Garanti Süresi (Ay)\n                </label>\n                <Input\n                  key=\"warranty-period\"\n                  type=\"number\"\n                  value={formData.warranty}\n                  onChange={(e) => handleInputChange('warranty', parseInt(e.target.value) || 0)}\n                  min=\"0\"\n                  max=\"120\"\n                  className=\"w-full\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  SGK Kodu\n                </label>\n                <Input\n                  key=\"sgk-code\"\n                  type=\"text\"\n                  value={formData.sgkCode}\n                  onChange={(e) => handleInputChange('sgkCode', e.target.value)}\n                  placeholder=\"SGK kodunu girin\"\n                  className=\"w-full\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center\">\n              <Checkbox\n                id=\"isMinistryTracked\"\n                checked={formData.isMinistryTracked}\n                onChange={(e) => handleInputChange('isMinistryTracked', e.target.checked)}\n                className=\"mr-2\"\n              />\n              <label htmlFor=\"isMinistryTracked\" className=\"text-sm text-gray-700 dark:text-gray-300\">\n                Bakanlık takipli ürün\n              </label>\n            </div>\n          </div>\n\n          {/* Form Actions */}\n          <div className=\"flex justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={onClose}\n            >\n              İptal\n            </Button>\n            <Button\n              type=\"submit\"\n              className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n            >\n              {mode === 'create' ? 'Kaydet' : 'Güncelle'}\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/ProductModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isLoading' is assigned a value but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":12}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Modal } from '@x-ear/ui-web';\nimport { ProductForm } from './ProductForm';\nimport { InventoryItem, InventoryFormData } from '../../../types/inventory';\n\ninterface ProductModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  product?: InventoryItem;\n  onSave: (data: InventoryFormData) => Promise<void>;\n  isLoading?: boolean;\n}\n\nexport const ProductModal: React.FC<ProductModalProps> = ({\n  isOpen,\n  onClose,\n  product,\n  onSave,\n  isLoading = false\n}) => {\n  const title = product ? 'Ürün Düzenle' : 'Yeni Ürün Ekle';\n  const mode = product ? 'edit' : 'create';\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title={title}\n      size=\"lg\"\n    >\n      <ProductForm\n        isOpen={isOpen}\n        onClose={onClose}\n        onSubmit={onSave}\n        initialData={product}\n        mode={mode}\n      />\n    </Modal>\n  );\n};\n\nexport default ProductModal;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/StockUpdateModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/components/SupplierAutocomplete.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'commonSuppliers'. Either include it or remove the dependency array.","line":73,"column":6,"nodeType":"ArrayExpression","endLine":73,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [value, isOpen, commonSuppliers]","fix":{"range":[1979,1994],"text":"[value, isOpen, commonSuppliers]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect } from 'react';\nimport { Input, Button } from '@x-ear/ui-web';\n\ninterface SupplierAutocompleteProps {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  label?: string;\n  className?: string;\n  error?: string;\n  required?: boolean;\n}\n\nexport const SupplierAutocomplete: React.FC<SupplierAutocompleteProps> = ({\n  value,\n  onChange,\n  placeholder = \"Tedarikçi adı\",\n  label = \"Tedarikçi\",\n  className = '',\n  error,\n  required = false\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [filteredSuppliers, setFilteredSuppliers] = useState<string[]>([]);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Common suppliers in hearing aid industry\n  const commonSuppliers = [\n    'Phonak Turkey',\n    'Oticon Türkiye',\n    'Widex Türkiye',\n    'Signia Türkiye',\n    'ReSound Türkiye',\n    'Starkey Türkiye',\n    'Unitron Türkiye',\n    'Bernafon Türkiye',\n    'Hansaton Türkiye',\n    'Sonic Türkiye',\n    'GN Hearing Türkiye',\n    'Amplifon Türkiye',\n    'Audika Türkiye',\n    'Hear Clear Türkiye',\n    'Beltone Türkiye',\n    'Miracle-Ear Türkiye',\n    'Connect Hearing Türkiye',\n    'Audiology Türkiye',\n    'Hearing Life Türkiye',\n    'HearingPlanet Türkiye',\n    'Medikal Cihaz Ltd.',\n    'Sağlık Teknolojileri A.Ş.',\n    'Tıbbi Cihaz İthalat Ltd.',\n    'Audiomed Türkiye',\n    'Hearing Solutions Ltd.',\n    'Medical Devices Turkey',\n    'Healthcare Tech Ltd.',\n    'Auditory Systems Turkey',\n    'Sound Solutions Ltd.',\n    'Hearing Care Turkey'\n  ];\n\n  useEffect(() => {\n    if (value && isOpen) {\n      const filtered = commonSuppliers.filter(supplier =>\n        supplier.toLowerCase().includes(value.toLowerCase())\n      );\n      setFilteredSuppliers(filtered.slice(0, 8)); // Limit to 8 results\n    } else if (isOpen) {\n      setFilteredSuppliers(commonSuppliers.slice(0, 8));\n    } else {\n      setFilteredSuppliers([]);\n    }\n  }, [value, isOpen]);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        dropdownRef.current &&\n        !dropdownRef.current.contains(event.target as Node) &&\n        inputRef.current &&\n        !inputRef.current.contains(event.target as Node)\n      ) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newValue = e.target.value;\n    onChange(newValue);\n    if (!isOpen) {\n      setIsOpen(true);\n    }\n  };\n\n  const handleInputFocus = () => {\n    setIsOpen(true);\n  };\n\n  const handleSupplierSelect = (supplier: string) => {\n    onChange(supplier);\n    setIsOpen(false);\n    inputRef.current?.blur();\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Escape') {\n      setIsOpen(false);\n      inputRef.current?.blur();\n    } else if (e.key === 'ArrowDown' && filteredSuppliers.length > 0) {\n      e.preventDefault();\n      // Focus first dropdown item (could be enhanced with keyboard navigation)\n      const firstItem = dropdownRef.current?.querySelector('button');\n      firstItem?.focus();\n    }\n  };\n\n  return (\n    <div className={`relative ${className}`}>\n      <div className=\"relative\">\n        <Input\n          ref={inputRef}\n          label={label}\n          value={value}\n          onChange={handleInputChange}\n          onFocus={handleInputFocus}\n          onKeyDown={handleKeyDown}\n          placeholder={placeholder}\n          required={required}\n          error={error}\n          className=\"pr-8\"\n        />\n        \n        {/* Dropdown arrow */}\n        <div className=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none mt-6\">\n          <svg\n            className={`w-4 h-4 text-gray-400 transition-transform ${\n              isOpen ? 'rotate-180' : ''\n            }`}\n            fill=\"currentColor\"\n            viewBox=\"0 0 20 20\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\"\n              clipRule=\"evenodd\"\n            />\n          </svg>\n        </div>\n      </div>\n\n      {/* Dropdown */}\n      {isOpen && filteredSuppliers.length > 0 && (\n        <div\n          ref={dropdownRef}\n          className=\"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-y-auto\"\n        >\n          {filteredSuppliers.map((supplier, index) => (\n            <Button\n              key={index}\n              variant=\"ghost\"\n              size=\"sm\"\n              type=\"button\"\n              onClick={() => handleSupplierSelect(supplier)}\n              className=\"w-full px-4 py-3 text-left text-sm text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none first:rounded-t-lg last:rounded-b-lg transition-colors\"\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' || e.key === ' ') {\n                  e.preventDefault();\n                  handleSupplierSelect(supplier);\n                } else if (e.key === 'Escape') {\n                  setIsOpen(false);\n                  inputRef.current?.focus();\n                }\n              }}\n            >\n              <div className=\"flex items-center\">\n                <svg className=\"w-4 h-4 text-gray-400 mr-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z\" clipRule=\"evenodd\"/>\n                  <path d=\"M6 8h8v2H6V8zm0 4h8v2H6v-2z\"/>\n                </svg>\n                <span>{supplier}</span>\n              </div>\n            </Button>\n          ))}\n          \n          {/* Add new supplier option */}\n          {value && !commonSuppliers.some(s => s.toLowerCase() === value.toLowerCase()) && (\n            <div className=\"border-t border-gray-200 dark:border-gray-600\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                type=\"button\"\n                onClick={() => handleSupplierSelect(value)}\n                className=\"w-full px-4 py-3 text-left text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 focus:bg-blue-50 dark:focus:bg-blue-900/20 focus:outline-none rounded-b-lg transition-colors\"\n              >\n                <div className=\"flex items-center\">\n                  <svg className=\"w-4 h-4 mr-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z\" clipRule=\"evenodd\"/>\n                  </svg>\n                  <span>\"{value}\" olarak ekle</span>\n                </div>\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/inventory/utils/csvUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/patients/PatientDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MapPin' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Settings' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Heart' is defined but never used.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckCircle' is defined but never used.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Clock' is defined but never used.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Download' is defined but never used.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":11},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadPatient'. Either include it or remove the dependency array.","line":67,"column":6,"nodeType":"ArrayExpression","endLine":67,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [loadPatient, patientId]","fix":{"range":[1488,1499],"text":"[loadPatient, patientId]"}}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from '@tanstack/react-router';\nimport { \n  Button, \n  Badge, \n  Tabs,\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  Spinner,\n  Alert\n} from '@x-ear/ui-web';\nimport { \n  ArrowLeft,\n  Edit,\n  Trash2,\n  Phone,\n  Mail,\n  Calendar,\n  MapPin,\n  User,\n  CreditCard,\n  Activity,\n  FileText,\n  Settings,\n  Heart,\n  Shield,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  Download,\n  Upload,\n  Plus\n} from 'lucide-react';\nimport { PatientSearchItem } from '../../types/patient/patient-search.types';\nimport { usePatients } from '../../hooks/usePatients';\n\ninterface PatientDetailProps {\n  patientId?: string;\n}\n\n/**\n * PatientDetail Page\n * Displays comprehensive patient information with tabs for different sections\n */\nexport function PatientDetail({ patientId: propPatientId }: PatientDetailProps) {\n  const { id: paramPatientId } = useParams({ strict: false }) as { id?: string };\n  const navigate = useNavigate();\n  const patientId = propPatientId || paramPatientId;\n  \n  const [activeTab, setActiveTab] = useState('overview');\n  const [patient, setPatient] = useState<PatientSearchItem | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  const { searchPatients } = usePatients();\n\n  useEffect(() => {\n    if (!patientId) {\n      setError('Hasta ID bulunamadı');\n      setLoading(false);\n      return;\n    }\n\n    loadPatient();\n  }, [patientId]);\n\n  const loadPatient = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      // Search for the specific patient by ID\n      const result = (await searchPatients({ search: patientId })) as unknown as { patients?: PatientSearchItem[] } | undefined;\n      const foundPatient = result?.patients?.find(p => p.id === patientId) ?? null;\n      \n      if (foundPatient) {\n        setPatient(foundPatient);\n      } else {\n        setError('Hasta bulunamadı');\n      }\n    } catch (err) {\n      setError('Hasta bilgileri yüklenirken hata oluştu');\n      console.error('Error loading patient:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleEdit = () => {\n    navigate({ to: `/patients/${patientId}/edit` });\n  };\n\n  const handleDelete = () => {\n    if (window.confirm('Bu hastayı silmek istediğinizden emin misiniz?')) {\n      // TODO: Implement delete functionality\n      console.log('Delete patient:', patientId);\n      navigate({ to: '/patients' });\n    }\n  };\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'active':\n        return <Badge variant=\"success\">Aktif</Badge>;\n      case 'inactive':\n        return <Badge variant=\"warning\">Pasif</Badge>;\n      case 'archived':\n        return <Badge variant=\"secondary\">Arşiv</Badge>;\n      default:\n        return <Badge variant=\"secondary\">{status}</Badge>;\n    }\n  };\n\n  const getSegmentColor = (segment: string) => {\n    switch (segment) {\n      case 'premium':\n        return 'bg-purple-100 text-purple-800 border-purple-200';\n      case 'standard':\n        return 'bg-blue-100 text-blue-800 border-blue-200';\n      case 'basic':\n        return 'bg-gray-100 text-gray-800 border-gray-200';\n      default:\n        return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const formatCurrency = (amount: number) => {\n    return `₺${amount.toLocaleString('tr-TR')}`;\n  };\n\n  const getInitials = (firstName: string, lastName: string) => {\n    return `${firstName.charAt(0)}${lastName.charAt(0)}`.toUpperCase();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Spinner size=\"lg\" />\n      </div>\n    );\n  }\n\n  if (error || !patient) {\n    return (\n      <div className=\"max-w-4xl mx-auto p-6\">\n        <Alert variant=\"error\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <div>\n            <h4 className=\"font-medium\">Hasta bulunamadı</h4>\n            <p className=\"text-sm mt-1\">Aradığınız hasta mevcut değil veya silinmiş olabilir.</p>\n          </div>\n        </Alert>\n        \n        <div className=\"mt-6\">\n          <Button onClick={() => navigate({ to: '/patients' })} variant=\"outline\">\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\n            Hasta Listesine Dön\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-6 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          <Button \n            onClick={() => navigate({ to: '/patients' })} \n            variant=\"secondary\" \n            size=\"sm\"\n          >\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\n            Geri Dön\n          </Button>\n          \n          <div className=\"h-16 w-16 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white text-xl font-medium\">\n            {getInitials(patient.firstName, patient.lastName)}\n          </div>\n          \n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">\n              {patient.firstName} {patient.lastName}\n            </h1>\n            \n            <div className=\"flex items-center space-x-3 mt-1\">\n              {getStatusBadge(patient.status)}\n              \n              <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border ${\n                getSegmentColor(patient.segment)\n              }`}>\n                {patient.segment}\n              </span>\n              \n              {patient.priority > 0 && (\n                <Badge variant=\"warning\">\n                  <AlertCircle className=\"h-3 w-3 mr-1\" />\n                  Yüksek Öncelik ({patient.priority})\n                </Badge>\n              )}\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-2\">\n          <Button onClick={handleEdit} variant=\"outline\">\n            <Edit className=\"h-4 w-4 mr-2\" />\n            Düzenle\n          </Button>\n          \n          <Button onClick={handleDelete} variant=\"outline\" className=\"text-red-600 hover:text-red-700\">\n            <Trash2 className=\"h-4 w-4 mr-2\" />\n            Sil\n          </Button>\n        </div>\n      </div>\n\n      {/* Quick Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Calendar className=\"h-5 w-5 text-blue-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Kayıt Tarihi</p>\n                <p className=\"font-medium\">{formatDate(patient.registrationDate)}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        \n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Activity className=\"h-5 w-5 text-green-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Cihaz Sayısı</p>\n                <p className=\"font-medium\">{patient.deviceCount}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        \n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Shield className=\"h-5 w-5 text-purple-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Sigorta</p>\n                <p className=\"font-medium\">{patient.hasInsurance ? 'Var' : 'Yok'}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        \n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center space-x-2\">\n              <CreditCard className=\"h-5 w-5 text-red-500\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Bakiye</p>\n                <p className={`font-medium ${patient.outstandingBalance > 0 ? 'text-red-600' : 'text-green-600'}`}>\n                  {patient.outstandingBalance > 0 ? formatCurrency(patient.outstandingBalance) : 'Temiz'}\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Tabs */}\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\n        <Tabs.List className=\"grid w-full grid-cols-6\">\n          <Tabs.Trigger value=\"overview\">Genel Bakış</Tabs.Trigger>\n          <Tabs.Trigger value=\"contact\">İletişim</Tabs.Trigger>\n          <Tabs.Trigger value=\"devices\">Cihazlar</Tabs.Trigger>\n          <Tabs.Trigger value=\"appointments\">Randevular</Tabs.Trigger>\n          <Tabs.Trigger value=\"notes\">Notlar</Tabs.Trigger>\n          <Tabs.Trigger value=\"documents\">Belgeler</Tabs.Trigger>\n        </Tabs.List>\n\n        <Tabs.Content value=\"overview\" className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            {/* Personal Information */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center\">\n                  <User className=\"h-5 w-5 mr-2\" />\n                  Kişisel Bilgiler\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium text-gray-600\">Ad Soyad</label>\n                  <p className=\"text-gray-900\">{patient.firstName} {patient.lastName}</p>\n                </div>\n                \n                {patient.tcNumber && (\n                  <div>\n                    <label className=\"text-sm font-medium text-gray-600\">TC Kimlik No</label>\n                    <p className=\"text-gray-900\">{patient.tcNumber}</p>\n                  </div>\n                )}\n                \n                <div>\n                  <label className=\"text-sm font-medium text-gray-600\">Durum</label>\n                  <div className=\"mt-1\">{getStatusBadge(patient.status)}</div>\n                </div>\n                \n                <div>\n                  <label className=\"text-sm font-medium text-gray-600\">Segment</label>\n                  <p className=\"text-gray-900 capitalize\">{patient.segment}</p>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Labels & Tags */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Etiketler</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {patient.labels && patient.labels.length > 0 ? (\n                  <div className=\"flex flex-wrap gap-2\">\n                    {patient.labels.map((label, index) => (\n                      <Badge key={index} variant=\"secondary\">\n                        {label}\n                      </Badge>\n                    ))}\n                  </div>\n                ) : (\n                  <p className=\"text-gray-500 text-sm\">Henüz etiket eklenmemiş</p>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </Tabs.Content>\n\n        <Tabs.Content value=\"contact\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center\">\n                <Phone className=\"h-5 w-5 mr-2\" />\n                İletişim Bilgileri\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {patient.phone && (\n                <div className=\"flex items-center space-x-3\">\n                  <Phone className=\"h-4 w-4 text-gray-400\" />\n                  <div>\n                    <label className=\"text-sm font-medium text-gray-600\">Telefon</label>\n                    <p className=\"text-gray-900\">{patient.phone}</p>\n                  </div>\n                </div>\n              )}\n              \n              {patient.email && (\n                <div className=\"flex items-center space-x-3\">\n                  <Mail className=\"h-4 w-4 text-gray-400\" />\n                  <div>\n                    <label className=\"text-sm font-medium text-gray-600\">E-posta</label>\n                    <p className=\"text-gray-900\">{patient.email}</p>\n                  </div>\n                </div>\n              )}\n              \n              {!patient.phone && !patient.email && (\n                <p className=\"text-gray-500 text-sm\">İletişim bilgisi bulunmuyor</p>\n              )}\n            </CardContent>\n          </Card>\n        </Tabs.Content>\n\n        <Tabs.Content value=\"devices\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <Activity className=\"h-5 w-5 mr-2\" />\n                  Cihazlar ({patient.deviceCount})\n                </div>\n                <Button size=\"sm\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Cihaz Ekle\n                </Button>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {patient.deviceCount > 0 ? (\n                <div className=\"text-center py-8\">\n                  <Activity className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <p className=\"text-gray-500\">Cihaz detayları yükleniyor...</p>\n                </div>\n              ) : (\n                <div className=\"text-center py-8\">\n                  <Activity className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <p className=\"text-gray-500\">Henüz cihaz kaydı bulunmuyor</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </Tabs.Content>\n\n        <Tabs.Content value=\"appointments\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <Calendar className=\"h-5 w-5 mr-2\" />\n                  Randevular\n                </div>\n                <Button size=\"sm\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Randevu Ekle\n                </Button>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-center py-8\">\n                <Calendar className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-gray-500\">Randevu geçmişi yükleniyor...</p>\n              </div>\n            </CardContent>\n          </Card>\n        </Tabs.Content>\n\n        <Tabs.Content value=\"notes\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <FileText className=\"h-5 w-5 mr-2\" />\n                  Notlar\n                </div>\n                <Button size=\"sm\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Not Ekle\n                </Button>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-center py-8\">\n                <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-gray-500\">Henüz not bulunmuyor</p>\n              </div>\n            </CardContent>\n          </Card>\n        </Tabs.Content>\n\n        <Tabs.Content value=\"documents\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <FileText className=\"h-5 w-5 mr-2\" />\n                  Belgeler\n                </div>\n                <Button size=\"sm\">\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                  Belge Yükle\n                </Button>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-center py-8\">\n                <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-gray-500\">Henüz belge yüklenmemiş</p>\n              </div>\n            </CardContent>\n          </Card>\n        </Tabs.Content>\n      </Tabs>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/patients/PatientDetailPage.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Patient' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1473,1476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1473,1476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'success' is assigned a value but never used.","line":71,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":261,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":261,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9231,9234],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9231,9234],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { useParams, useNavigate } from '@tanstack/react-router';\nimport { usePatient } from '../../hooks/patient/usePatient';\nimport { usePatientMutations } from '../../hooks/patient/usePatientMutations';\nimport { Patient } from '../../types/patient';\nimport { PatientFormModal } from '../../components/patients/PatientFormModal';\nimport { Button } from '@x-ear/ui-web';\n\ninterface PatientDetailPageProps {\n  className?: string;\n}\n\n/**\n * PatientDetailPage Component\n * Displays detailed patient information with tabs for different sections\n * Follows 500 LOC limit and single responsibility principle\n */\nexport function PatientDetailPage({ className = '' }: PatientDetailPageProps) {\n  const { patientId } = useParams({ strict: false });\n  const navigate = useNavigate();\n  \n  // Hooks\n  const {\n    patient,\n    loading,\n    error,\n    isOnline,\n    refresh\n  } = usePatient(patientId as string);\n\n  const {\n    updatePatient,\n    deletePatient,\n    loading: mutationLoading,\n    error: mutationError,\n    clearError: clearMutationError\n  } = usePatientMutations();\n\n  // Local state\n  const [activeTab, setActiveTab] = useState('general');\n  const [showEditModal, setShowEditModal] = useState(false);\n\n  // Computed values\n  const isLoading = loading || mutationLoading;\n  const currentError = error || mutationError;\n\n  // Handlers\n  const handleUpdatePatient = useCallback(async (updates: any) => {\n    if (!patient) return null;\n    \n    const result = await updatePatient(patient.id, updates, {\n      onSuccess: () => {\n        setShowEditModal(false);\n        refresh();\n      },\n      onError: (error) => {\n        console.error('Failed to update patient:', error);\n      }\n    });\n    return result;\n  }, [patient, updatePatient, refresh]);\n\n  const handleDeletePatient = useCallback(async () => {\n    if (!patient) return;\n    \n    if (!confirm(`${patient.name} adlı hastayı silmek istediğinizden emin misiniz?`)) {\n      return;\n    }\n\n    const success = await deletePatient(patient.id, {\n      onSuccess: () => {\n        navigate({ to: '/patients' });\n      },\n      onError: (error) => {\n        console.error('Failed to delete patient:', error);\n      }\n    });\n  }, [patient, deletePatient, navigate]);\n\n  const handleRefresh = useCallback(() => {\n    clearMutationError();\n    refresh();\n  }, [clearMutationError, refresh]);\n\n  // Tab configuration\n  const tabs = useMemo(() => [\n    { id: 'general', label: 'Genel Bilgiler', icon: '👤' },\n    { id: 'devices', label: 'Cihazlar', icon: '🎧', count: patient?.devices?.length },\n    { id: 'appointments', label: 'Randevular', icon: '📅', count: patient?.appointments?.length },\n    { id: 'sales', label: 'Satışlar', icon: '💰', count: patient?.sales?.length },\n    { id: 'sgk', label: 'SGK', icon: '🏥' },\n    { id: 'notes', label: 'Notlar', icon: '📝', count: patient?.notes?.length },\n    { id: 'timeline', label: 'Zaman Çizelgesi', icon: '📊' }\n  ], [patient]);\n\n  // Format helpers\n  const formatPhone = (phone: string) => {\n    if (!phone) return '';\n    const cleaned = phone.replace(/\\D/g, '');\n    if (cleaned.length === 10) {\n      return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(6)}`;\n    }\n    return phone;\n  };\n\n  const formatDate = (date: string | Date) => {\n    if (!date) return '';\n    const d = new Date(date);\n    return d.toLocaleDateString('tr-TR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'bg-green-100 text-green-800';\n      case 'inactive': return 'bg-gray-100 text-gray-800';\n      case 'archived': return 'bg-red-100 text-red-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  // Render helpers\n  const renderHeader = () => {\n    if (!patient) return null;\n\n    return (\n      <div className=\"bg-white border-b border-gray-200 px-6 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <Button\n              onClick={() => navigate({ to: '/patients' })}\n              variant=\"ghost\"\n              size=\"sm\"\n              title=\"Hasta listesine dön\"\n            >\n              ←\n            </Button>\n            \n            <div>\n              <div className=\"flex items-center gap-3\">\n                <h1 className=\"text-2xl font-bold text-gray-900\">{patient.name}</h1>\n                <span className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusColor(patient.status)}`}>\n                  {patient.status}\n                </span>\n                {!isOnline && (\n                  <span className=\"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full\">\n                    Çevrimdışı\n                  </span>\n                )}\n              </div>\n              <div className=\"flex items-center gap-4 mt-1 text-sm text-gray-500\">\n                <span>📞 {formatPhone(patient.phone)}</span>\n                {patient.email && <span>✉️ {patient.email}</span>}\n                <span>📅 {formatDate(patient.createdAt)}</span>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <Button\n              onClick={handleRefresh}\n              disabled={isLoading}\n              variant=\"outline\"\n            >\n              {isLoading ? 'Yenileniyor...' : 'Yenile'}\n            </Button>\n            \n            <Button\n              onClick={() => setShowEditModal(true)}\n            >\n              Düzenle\n            </Button>\n            \n            <Button\n              onClick={handleDeletePatient}\n              variant=\"destructive\"\n            >\n              Sil\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  const renderTabs = () => (\n    <div className=\"bg-white border-b border-gray-200\">\n      <div className=\"px-6\">\n        <nav className=\"flex space-x-8\">\n          {tabs.map((tab) => (\n            <Button\n              key={tab.id}\n              onClick={() => setActiveTab(tab.id)}\n              variant=\"ghost\"\n              className={`\n                flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors\n                ${activeTab === tab.id\n                  ? 'border-blue-500 text-blue-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                }\n              `}\n            >\n              <span>{tab.icon}</span>\n              <span>{tab.label}</span>\n              {tab.count !== undefined && tab.count > 0 && (\n                <span className=\"ml-1 px-2 py-0.5 text-xs bg-gray-100 text-gray-600 rounded-full\">\n                  {tab.count}\n                </span>\n              )}\n            </Button>\n          ))}\n        </nav>\n      </div>\n    </div>\n  );\n\n  const renderGeneralTab = () => {\n    if (!patient) return null;\n\n    return (\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Personal Information */}\n        <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Kişisel Bilgiler</h3>\n          <div className=\"space-y-3\">\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">Ad Soyad:</span>\n              <span className=\"text-sm text-gray-900\">{patient.name}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">TC Kimlik No:</span>\n              <span className=\"text-sm text-gray-900\">{patient.tcNumber || '-'}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">Doğum Tarihi:</span>\n              <span className=\"text-sm text-gray-900\">{patient.birthDate ? formatDate(patient.birthDate) : '-'}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">Telefon:</span>\n              <span className=\"text-sm text-gray-900\">{formatPhone(patient.phone)}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">E-posta:</span>\n              <span className=\"text-sm text-gray-900\">{patient.email || '-'}</span>\n            </div>\n            {patient.address && (\n              <div>\n                <span className=\"text-sm font-medium text-gray-500\">Adres:</span>\n                <p className=\"text-sm text-gray-900 mt-1\">\n                  {(() => {\n                    // Handle address as object or string\n                    const address = patient.address || patient.addressFull;\n                    if (typeof address === 'string') {\n                      return address || 'Adres bilgisi yok';\n                    } else if (typeof address === 'object' && address !== null) {\n                      // Handle address object with city, district, fullAddress\n                      const addressObj = address as any;\n                      return addressObj.fullAddress || \n                             `${addressObj.district || ''} ${addressObj.city || ''}`.trim() ||\n                             'Adres bilgisi yok';\n                    }\n                    return 'Adres bilgisi yok';\n                  })()}\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Classification */}\n        <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Sınıflandırma</h3>\n          <div className=\"space-y-3\">\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">Durum:</span>\n              <span className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusColor(patient.status)}`}>\n                {patient.status}\n              </span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">Segment:</span>\n              <span className=\"text-sm text-gray-900\">{patient.segment}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">Etiket:</span>\n              <span className=\"text-sm text-gray-900\">{patient.label}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-sm font-medium text-gray-500\">Kazanım Türü:</span>\n              <span className=\"text-sm text-gray-900\">{patient.acquisitionType}</span>\n            </div>\n            {patient.priorityScore && (\n              <div className=\"flex justify-between\">\n                <span className=\"text-sm font-medium text-gray-500\">Öncelik Skoru:</span>\n                <span className=\"text-sm text-gray-900\">{patient.priorityScore}</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Tags */}\n        {patient.tags && patient.tags.length > 0 && (\n          <div className=\"bg-white rounded-lg border border-gray-200 p-6 lg:col-span-2\">\n            <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Etiketler</h3>\n            <div className=\"flex flex-wrap gap-2\">\n              {patient.tags.map((tag, index) => (\n                <span key={index} className=\"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-full\">\n                  {tag}\n                </span>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const renderTabContent = () => {\n    switch (activeTab) {\n      case 'general':\n        return renderGeneralTab();\n      case 'devices':\n        return <div className=\"p-6 text-center text-gray-500\">Cihaz bilgileri yakında eklenecek</div>;\n      case 'appointments':\n        return <div className=\"p-6 text-center text-gray-500\">Randevu bilgileri yakında eklenecek</div>;\n      case 'sales':\n        return <div className=\"p-6 text-center text-gray-500\">Satış bilgileri yakında eklenecek</div>;\n      case 'sgk':\n        return <div className=\"p-6 text-center text-gray-500\">SGK bilgileri yakında eklenecek</div>;\n      case 'notes':\n        return <div className=\"p-6 text-center text-gray-500\">Not bilgileri yakında eklenecek</div>;\n      case 'timeline':\n        return <div className=\"p-6 text-center text-gray-500\">Zaman çizelgesi yakında eklenecek</div>;\n      default:\n        return renderGeneralTab();\n    }\n  };\n\n  const renderError = () => {\n    if (!currentError) return null;\n\n    return (\n      <div className=\"mx-6 mt-6 p-4 bg-red-50 border border-red-200 rounded-lg\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center\">\n            <span className=\"text-red-600 mr-2\">⚠️</span>\n            <span className=\"text-sm text-red-700\">{currentError}</span>\n          </div>\n          <Button\n            onClick={clearMutationError}\n            variant=\"ghost\"\n            size=\"sm\"\n          >\n            ✕\n          </Button>\n        </div>\n      </div>\n    );\n  };\n\n  // Loading state\n  if (loading && !patient) {\n    return (\n      <div className={`min-h-screen bg-gray-50 ${className}`}>\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n            <p className=\"text-gray-500\">Hasta bilgileri yükleniyor...</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error && !patient) {\n    return (\n      <div className={`min-h-screen bg-gray-50 ${className}`}>\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"text-center\">\n            <div className=\"text-red-600 text-4xl mb-4\">⚠️</div>\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Hasta bulunamadı</h3>\n            <p className=\"text-gray-500 mb-4\">{error}</p>\n            <Button\n              onClick={() => navigate({ to: '/patients' })}\n            >\n              Hasta Listesine Dön\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`min-h-screen bg-gray-50 ${className}`}>\n      {renderHeader()}\n      {renderError()}\n      {renderTabs()}\n      \n      <div className=\"p-6\">\n        {renderTabContent()}\n      </div>\n\n      {/* Edit Modal */}\n      {showEditModal && patient && (\n        <PatientFormModal\n          isOpen={showEditModal}\n          onClose={() => setShowEditModal(false)}\n          onSubmit={handleUpdatePatient}\n          initialData={patient}\n          title=\"Hasta Düzenle\"\n        />\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/patients/PatientListPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1888,1891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1888,1891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3987,3990],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3987,3990],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":129,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4371,4374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4371,4374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback } from 'react';\nimport { useNavigate } from '@tanstack/react-router';\nimport { usePatients } from '../../hooks/patient/usePatients';\nimport { usePatientMutations } from '../../hooks/patient/usePatientMutations';\nimport { Patient } from '../../types/patient';\nimport { PatientSegment, PatientLabel } from '../../types/patient/patient-base.types';\nimport { PatientStatus } from '../../generated/orval-types';\nimport { PatientSearchItem } from '../../types/patient/patient-search.types';\nimport { PatientCard } from '../../components/patients/PatientCard';\nimport { PatientSearch } from '../../components/patients/PatientSearch';\nimport { PatientFilters } from '../../components/patients/PatientFilters';\nimport { PatientFormModal } from '../../components/patients/PatientFormModal';\nimport { Button } from '@x-ear/ui-web';\n\ninterface PatientListPageProps {\n  className?: string;\n}\n\n/**\n * PatientListPage Component\n * Main page for displaying and managing patient list with offline-first approach\n * Follows 500 LOC limit and single responsibility principle\n */\nexport function PatientListPage({ className = '' }: PatientListPageProps) {\n  // Hooks\n  const navigate = useNavigate();\n  const patientsQuery = usePatients();\n  const {\n    data: patientsData,\n    isLoading: loading,\n    error,\n    refetch: refresh\n  } = patientsQuery;\n\n  const {\n    createPatient,\n    updatePatient,\n    deletePatient,\n    loading: mutationLoading,\n    error: mutationError,\n    isOnline,\n    clearError: clearMutationError\n  } = usePatientMutations();\n\n  // Extract data from query result\n  const patients = patientsData?.patients || [];\n  const totalCount = patientsData?.total || 0;\n  const hasMore = patientsData?.hasMore || false;\n\n  // Local state for search and filters\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filters, setFilters] = useState<any>({});\n  const [currentPage, setCurrentPage] = useState(1);\n\n  // Computed pagination\n  const pagination = {\n    page: currentPage,\n    pageSize: 20,\n    total: totalCount,\n    hasMore\n  };\n\n  // Handlers\n  const loadMore = useCallback(() => {\n    if (hasMore) {\n      setCurrentPage(prev => prev + 1);\n    }\n  }, [hasMore]);\n\n  const clearFilters = useCallback(() => {\n    setFilters({});\n    setSearchTerm('');\n  }, []);\n\n  // Helper function to convert Patient to PatientSearchItem\n  const convertToSearchItem = useCallback((patient: Patient): PatientSearchItem => ({\n    id: patient.id || '',\n    firstName: patient.firstName || '',\n    lastName: patient.lastName || '',\n    tcNumber: patient.tcNumber,\n    phone: patient.phone,\n    email: patient.email,\n    status: (patient.status as PatientStatus) || PatientStatus.ACTIVE,\n    segment: patient.segment as PatientSegment || 'NEW',\n    labels: patient.label ? [patient.label as PatientLabel] : [],\n    registrationDate: patient.createdAt || '',\n    lastVisitDate: patient.updatedAt || '',\n    deviceCount: patient.devices?.length || 0,\n    hasInsurance: !!patient.sgkInfo,\n    outstandingBalance: 0, // This would need to be calculated\n    priority: patient.priorityScore || 0\n  }), []);\n  const [selectedPatients, setSelectedPatients] = useState<Set<string>>(new Set());\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [editingPatient, setEditingPatient] = useState<Patient | null>(null);\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n\n  // Computed values\n  const hasSelectedPatients = selectedPatients.size > 0;\n  const isLoading = loading || mutationLoading;\n  const currentError = error || mutationError;\n\n  // Handlers\n  const handleSelectPatient = useCallback((patientId: string, selected: boolean) => {\n    setSelectedPatients(prev => {\n      const newSet = new Set(prev);\n      if (selected) {\n        newSet.add(patientId);\n      } else {\n        newSet.delete(patientId);\n      }\n      return newSet;\n    });\n  }, []);\n\n  const handleCreatePatient = useCallback(async (patientData: any) => {\n    const result = await createPatient(patientData, {\n      onSuccess: () => {\n        setShowCreateModal(false);\n        refresh();\n      },\n      onError: (error) => {\n        console.error('Failed to create patient:', error);\n      }\n    });\n    return result;\n  }, [createPatient, refresh]);\n\n  const handleUpdatePatient = useCallback(async (patientId: string, updates: any) => {\n    const result = await updatePatient(patientId, updates, {\n      onSuccess: () => {\n        setEditingPatient(null);\n        refresh();\n      },\n      onError: (error) => {\n        console.error('Failed to update patient:', error);\n      }\n    });\n    return result;\n  }, [updatePatient, refresh]);\n\n  const handleDeletePatient = useCallback(async (patientId: string) => {\n    if (!confirm('Bu hastayı silmek istediğinizden emin misiniz?')) {\n      return;\n    }\n\n    await deletePatient(patientId, {\n      onSuccess: () => {\n        setSelectedPatients(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(patientId);\n          return newSet;\n        });\n        refresh();\n      },\n      onError: (error) => {\n        console.error('Failed to delete patient:', error);\n      }\n    });\n  }, [deletePatient, refresh]);\n\n  const handlePatientClick = useCallback((patient: PatientSearchItem) => {\n    navigate({ \n      to: '/patients/$patientId', \n      params: { patientId: patient.id } \n    });\n  }, [navigate]);\n\n  const handleBulkDelete = useCallback(async () => {\n    if (!confirm(`${selectedPatients.size} hastayı silmek istediğinizden emin misiniz?`)) {\n      return;\n    }\n\n    const promises = Array.from(selectedPatients).map(patientId =>\n      deletePatient(patientId)\n    );\n\n    await Promise.allSettled(promises);\n    setSelectedPatients(new Set());\n    refresh();\n  }, [selectedPatients, deletePatient, refresh]);\n\n  const clearError = useCallback(() => {\n    // Clear query error by refetching\n    refresh();\n    clearMutationError();\n  }, [refresh, clearMutationError]);\n\n  const handleRefresh = useCallback(() => {\n    clearError();\n    clearMutationError();\n    refresh();\n  }, [clearError, clearMutationError, refresh]);\n\n  // Render helpers\n  const renderHeader = () => (\n    <div className=\"flex flex-col gap-4 mb-6\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">\n            Hastalar ({patients.length})\n          </h1>\n          {!isOnline && (\n            <span className=\"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full\">\n              Çevrimdışı\n            </span>\n          )}\n        </div>\n        \n        <div className=\"flex items-center gap-2\">\n          <Button\n            onClick={() => setViewMode(viewMode === 'grid' ? 'list' : 'grid')}\n            variant=\"ghost\"\n            size=\"sm\"\n            title={`${viewMode === 'grid' ? 'Liste' : 'Kart'} görünümüne geç`}\n          >\n            {viewMode === 'grid' ? '☰' : '⊞'}\n          </Button>\n          \n          <Button\n            onClick={handleRefresh}\n            disabled={isLoading}\n            variant=\"outline\"\n          >\n            {isLoading ? 'Yenileniyor...' : 'Yenile'}\n          </Button>\n          \n          <Button\n            onClick={() => setShowCreateModal(true)}\n          >\n            Yeni Hasta\n          </Button>\n        </div>\n      </div>\n\n      {hasSelectedPatients && (\n        <div className=\"flex items-center gap-4 p-4 bg-blue-50 rounded-lg\">\n          <span className=\"text-sm text-blue-700\">\n            {selectedPatients.size} hasta seçildi\n          </span>\n          <Button\n            onClick={handleBulkDelete}\n            variant=\"ghost\"\n            className=\"text-red-600 hover:text-red-700 hover:bg-red-50\"\n          >\n            Seçilenleri Sil\n          </Button>\n          <Button\n            onClick={() => setSelectedPatients(new Set())}\n            variant=\"ghost\"\n            className=\"text-gray-600 hover:text-gray-700 hover:bg-gray-100\"\n          >\n            Seçimi Temizle\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n\n  const renderFilters = () => (\n    <div className=\"flex flex-col gap-4 mb-6\">\n      <PatientSearch\n        value={searchTerm}\n        onChange={setSearchTerm}\n        placeholder=\"Hasta ara (isim, telefon, TC)...\"\n        className=\"flex-1\"\n      />\n      \n            <PatientFilters\n        filters={filters}\n        onChange={setFilters}\n        onClearFilters={clearFilters}\n        patientCount={totalCount}\n      />\n    </div>\n  );\n\n  const renderPatientList = () => {\n    if (patients.length === 0) {\n      return (\n        <div className=\"text-center py-12\">\n          <div className=\"text-gray-400 text-6xl mb-4\">👥</div>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n            {searchTerm || Object.keys(filters).length > 0 \n              ? 'Arama kriterlerine uygun hasta bulunamadı'\n              : 'Henüz hasta eklenmemiş'\n            }\n          </h3>\n          <p className=\"text-gray-500 mb-4\">\n            {searchTerm || Object.keys(filters).length > 0\n              ? 'Farklı arama terimleri veya filtreler deneyin'\n              : 'İlk hastanızı ekleyerek başlayın'\n            }\n          </p>\n          {!searchTerm && Object.keys(filters).length === 0 && (\n            <Button\n              onClick={() => setShowCreateModal(true)}\n            >\n              Yeni Hasta Ekle\n            </Button>\n          )}\n        </div>\n      );\n    }\n\n    return (\n      <div className={`\n        ${viewMode === 'grid' \n          ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4' \n          : 'space-y-2'\n        }\n      `}>\n        {patients.map((patient) => (\n          <PatientCard\n            key={patient.id}\n            patient={convertToSearchItem(patient)}\n            selected={selectedPatients.has(patient.id)}\n            onSelect={(patientId) => handleSelectPatient(patientId, !selectedPatients.has(patientId))}\n            onClick={handlePatientClick}\n            onEdit={() => setEditingPatient(patient)}\n            onDelete={() => handleDeletePatient(patient.id)}\n            className=\"hover:shadow-md transition-shadow\"\n          />\n        ))}\n      </div>\n    );\n  };\n\n  const renderLoadMore = () => {\n    if (!pagination.hasMore) return null;\n\n    return (\n      <div className=\"text-center mt-8\">\n        <Button\n          onClick={loadMore}\n          disabled={isLoading}\n          variant=\"outline\"\n        >\n          {isLoading ? 'Yükleniyor...' : 'Daha Fazla Göster'}\n        </Button>\n      </div>\n    );\n  };\n\n  const renderError = () => {\n    if (!currentError) return null;\n\n    return (\n      <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center\">\n            <span className=\"text-red-600 mr-2\">⚠️</span>\n            <span className=\"text-sm text-red-700\">{currentError instanceof Error ? currentError.message : currentError}</span>\n          </div>\n          <Button\n            onClick={() => {\n              clearError();\n              clearMutationError();\n            }}\n            variant=\"ghost\"\n            size=\"sm\"\n          >\n            ✕\n          </Button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={`min-h-screen bg-gray-50 p-6 ${className}`}>\n      <div className=\"max-w-7xl mx-auto\">\n        {renderHeader()}\n        {renderError()}\n        {renderFilters()}\n        {renderPatientList()}\n        {renderLoadMore()}\n      </div>\n\n      {/* Modals */}\n      {showCreateModal && (\n        <PatientFormModal\n          isOpen={showCreateModal}\n          onClose={() => setShowCreateModal(false)}\n          onSubmit={handleCreatePatient}\n          title=\"Yeni Hasta Ekle\"\n        />\n      )}\n\n      {editingPatient && (\n        <PatientFormModal\n          isOpen={!!editingPatient}\n          onClose={() => setEditingPatient(null)}\n          onSubmit={(data) => handleUpdatePatient(editingPatient.id || '', data)}\n          initialData={editingPatient}\n          title=\"Hasta Düzenle\"\n        />\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/patients/PatientsPage.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Suspense' is defined but never used.","line":2,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientStats' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is assigned a value but never used.","line":22,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mockStats' is assigned a value but never used.","line":33,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2000,2003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2000,2003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2321,2324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2321,2324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3826,3829],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3826,3829],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport React, { Suspense, useState } from 'react';\nimport { PatientList } from '@/components/patients/PatientList';\nimport { PatientSearch, PatientSearchFilters } from '@/components/patients/PatientSearch';\nimport { PatientFilters } from '@/components/patients/PatientFilters';\nimport { PatientBulkActions } from '@/components/patients/PatientBulkActions';\nimport { PatientStats } from '@/components/patients/stats/PatientStats';\nimport { PatientCSVUpload } from '@/components/patients/csv/PatientCSVUpload';\nimport { PatientSavedViews } from '@/components/patients/views/PatientSavedViews';\nimport { PatientBulkOperations } from '@/components/patients/PatientBulkOperations';\nimport { PatientAdvancedSearch } from '@/components/patients/PatientAdvancedSearch';\nimport { PatientMatching } from '@/components/patients/PatientMatching';\nimport { Tabs } from '@x-ear/ui-web';\nimport { usePatients } from '../../hooks/patient/usePatients';\n\nexport function PatientsPage() {\n  const [searchValue, setSearchValue] = useState('');\n  const [filters, setFilters] = useState<PatientSearchFilters>({});\n  const [selectedPatients, setSelectedPatients] = useState<Patient[]>([]);\n\n  // Use the patients hook to fetch data\n  const { data: patientsData, isLoading, error } = usePatients({\n    page: 1,\n    per_page: 50, // Show more patients per page\n    search: searchValue || undefined,\n    status: filters.status || undefined\n  });\n\n  const patients = patientsData?.patients || [];\n  const totalPatients = patientsData?.total || 0;\n\n  // Mock stats data until we have real stats\n  const mockStats = {\n    total: totalPatients,\n    active: patients?.filter(p => p.status === 'active')?.length || 0,\n    inactive: patients?.filter(p => p.status === 'inactive')?.length || 0,\n    newThisMonth: 0\n  };\n\n  const handleCSVUpload = async (file: File) => {\n    // TODO: Implement CSV upload logic\n    console.log('CSV upload:', file);\n  };\n\n  const handleSaveView = (name: string, filters: Record<string, any>) => {\n    // TODO: Implement save view logic\n    console.log('Save view:', name, filters);\n  };\n\n  const handleSelectView = (viewId: string) => {\n    // TODO: Implement select view logic\n    console.log('Select view:', viewId);\n  };\n\n  const handleUpdateView = (viewId: string, name: string, filters: Record<string, any>) => {\n    // TODO: Implement update view logic\n    console.log('Update view:', viewId, name, filters);\n  };\n\n  const handleDeleteView = (viewId: string) => {\n    // TODO: Implement delete view logic\n    console.log('Delete view:', viewId);\n  };\n\n  const handleClearFilters = () => {\n    setFilters({});\n  };\n\n  // Bulk action handlers\n  const handleSelectAll = () => {\n    setSelectedPatients(patients.map(p => p.id));\n  };\n\n  const handleDeselectAll = () => {\n    setSelectedPatients([]);\n  };\n\n  const handleBulkAddTag = async (tag: string) => {\n    console.log('Bulk add tag:', tag, selectedPatients);\n  };\n\n  const handleBulkRemoveTag = async (tag: string) => {\n    console.log('Bulk remove tag:', tag, selectedPatients);\n  };\n\n  const handleBulkSendSMS = async (message: string, phoneNumbers: string[]) => {\n    console.log('Bulk send SMS:', message, phoneNumbers);\n  };\n\n  const handleBulkSendEmail = async (subject: string, message: string, emails: string[]) => {\n    console.log('Bulk send email:', subject, message, emails);\n  };\n\n  const handleBulkExport = async (format: 'csv' | 'excel' | 'pdf') => {\n    console.log('Bulk export:', format, selectedPatients);\n  };\n\n  const handleBulkStatusChange = async (status: 'active' | 'inactive' | 'archived') => {\n    console.log('Bulk status change:', status, selectedPatients);\n  };\n\n  const handleBulkDelete = async () => {\n    console.log('Bulk delete:', selectedPatients);\n  };\n\n  const handleBulkScheduleAppointment = async (appointmentData: any) => {\n    console.log('Bulk schedule appointment:', appointmentData, selectedPatients);\n  };\n\n  const handleBulkAssignToSegment = async (segment: string) => {\n    console.log('Bulk assign to segment:', segment, selectedPatients);\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center p-6 border-b\">\n        <h1 className=\"text-2xl font-semibold\">Hastalar</h1>\n        <PatientCSVUpload onUpload={handleCSVUpload} />\n      </div>\n\n      {/* Stats */}\n      {/* <PatientStats stats={mockStats} /> */}\n\n      {/* Phase 3 Features - Tabs */}\n      <Tabs defaultValue=\"list\" className=\"flex-1 flex flex-col\">\n        <Tabs.List className=\"px-6 pt-4\">\n          <Tabs.Trigger value=\"list\">Hasta Listesi</Tabs.Trigger>\n          <Tabs.Trigger value=\"bulk\">Toplu İşlemler</Tabs.Trigger>\n          <Tabs.Trigger value=\"search\">Gelişmiş Arama</Tabs.Trigger>\n          <Tabs.Trigger value=\"matching\">Hasta Eşleştirme</Tabs.Trigger>\n        </Tabs.List>\n\n        <Tabs.Content value=\"list\" className=\"flex-1 flex flex-col\">\n          {/* Filters & Search */}\n          <div className=\"p-6 space-y-4\">\n            <PatientSavedViews \n              savedViews={[]}\n              onSelectView={handleSelectView}\n              onSaveView={handleSaveView}\n              onUpdateView={handleUpdateView}\n              onDeleteView={handleDeleteView}\n              currentFilters={filters}\n            />\n            <PatientSearch \n              value={searchValue}\n              onChange={setSearchValue}\n            />\n            <PatientFilters \n              filters={filters}\n              onChange={setFilters}\n              onClearFilters={handleClearFilters}\n            />\n            <PatientBulkActions \n              selectedPatients={selectedPatients}\n              totalPatients={totalPatients}\n              onSelectAll={handleSelectAll}\n              onDeselectAll={handleDeselectAll}\n              onBulkAddTag={handleBulkAddTag}\n              onBulkRemoveTag={handleBulkRemoveTag}\n              onBulkSendSMS={handleBulkSendSMS}\n              onBulkSendEmail={handleBulkSendEmail}\n              onBulkExport={handleBulkExport}\n              onBulkStatusChange={handleBulkStatusChange}\n              onBulkDelete={handleBulkDelete}\n              onBulkScheduleAppointment={handleBulkScheduleAppointment}\n              onBulkAssignToSegment={handleBulkAssignToSegment}\n            />\n          </div>\n\n          {/* Patient List */}\n          <div className=\"flex-1 p-6\">\n            <PatientList \n              patients={patients || []} \n              loading={isLoading}\n            />\n          </div>\n        </Tabs.Content>\n\n        <Tabs.Content value=\"bulk\" className=\"flex-1 p-6\">\n          <PatientBulkOperations \n            selectedPatients={selectedPatients}\n            onClearSelection={() => setSelectedPatients([])}\n            onRefresh={() => {}}\n          />\n        </Tabs.Content>\n\n        <Tabs.Content value=\"search\" className=\"flex-1 p-6\">\n          <PatientAdvancedSearch \n            patients={patients || []}\n            onFilteredResults={(results) => setPatients(results)}\n            onClearFilters={() => setFilters({})}\n          />\n        </Tabs.Content>\n\n        <Tabs.Content value=\"matching\" className=\"flex-1 p-6\">\n          <PatientMatching \n            patients={patients || []}\n            onMergePatients={(patientIds, targetId) => console.log('Merge:', patientIds, targetId)}\n            onRefresh={() => {}}\n          />\n        </Tabs.Content>\n      </Tabs>\n    </div>\n  );\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/sgk/SGKPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[772,775],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[772,775],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1019,1022],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1019,1022],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleFileUpload' is assigned a value but never used.","line":33,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1509,1512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1509,1512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button, Tabs, TabsContent, TabsList, TabsTrigger } from '@x-ear/ui-web';\nimport { Camera, Upload } from 'lucide-react';\nimport BulkUploadModal from '../../components/sgk/BulkUploadModal';\nimport ProcessingResults from '../../components/sgk/ProcessingResults';\nimport CameraCapture from '../../components/sgk/CameraCapture';\nimport DocumentProcessor from '../../components/sgk/DocumentProcessor';\n\nexport const SGKPage: React.FC = () => {\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\n  const [isCameraCaptureOpen, setIsCameraCaptureOpen] = useState(false);\n  const [isDocumentProcessorOpen, setIsDocumentProcessorOpen] = useState(false);\n  const [processingResults, setProcessingResults] = useState<any[]>([]);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [capturedImages, setCapturedImages] = useState<File[]>([]);\n  const [uploadedFiles, setUploadedFiles] = useState<File[]>([]);\n\n  const handleUploadComplete = (results: any[]) => {\n    setProcessingResults(results);\n    setIsProcessing(false);\n  };\n\n  const handleStartProcessing = () => {\n    setIsProcessing(true);\n  };\n\n  const handleCameraCapture = (images: File[]) => {\n    setCapturedImages(images);\n    setIsCameraCaptureOpen(false);\n    setIsDocumentProcessorOpen(true);\n  };\n\n  const handleFileUpload = (files: File[]) => {\n    setUploadedFiles(files);\n    setIsDocumentProcessorOpen(true);\n  };\n\n  const handleDocumentProcessingComplete = (results: any[]) => {\n    setProcessingResults(results);\n    setIsDocumentProcessorOpen(false);\n    setCapturedImages([]);\n    setUploadedFiles([]);\n  };\n\n  return (\n    <div className=\"p-6 max-w-7xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h1 className=\"text-2xl font-semibold\">SGK Doküman İşleme</h1>\n        <div className=\"flex gap-3\">\n          <Button \n            onClick={() => setIsCameraCaptureOpen(true)}\n            className=\"flex items-center gap-2\"\n          >\n            <Camera size={16} />\n            Kamera ile Çek\n          </Button>\n          <Button \n            onClick={() => setIsUploadModalOpen(true)}\n            className=\"flex items-center gap-2\"\n          >\n            <Upload size={16} />\n            Dosya Yükle\n          </Button>\n        </div>\n      </div>\n\n      <Tabs defaultValue=\"results\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-2\">\n          <TabsTrigger value=\"results\">İşleme Sonuçları</TabsTrigger>\n          <TabsTrigger value=\"upload\">Yeni Yükleme</TabsTrigger>\n        </TabsList>\n        \n        <TabsContent value=\"results\" className=\"mt-6\">\n          {processingResults.length > 0 ? (\n            <ProcessingResults\n              results={processingResults}\n              isProcessing={isProcessing}\n              onRetry={() => setIsUploadModalOpen(true)}\n            />\n          ) : (\n            <div className=\"text-center py-12\">\n              <div className=\"text-gray-500 mb-4\">\n                Henüz işlenmiş doküman bulunmuyor\n              </div>\n              <div className=\"flex gap-3 justify-center\">\n                <Button \n                  onClick={() => setIsCameraCaptureOpen(true)}\n                  className=\"flex items-center gap-2\"\n                >\n                  <Camera size={16} />\n                  Kamera ile Başla\n                </Button>\n                <Button \n                  onClick={() => setIsUploadModalOpen(true)}\n                  className=\"flex items-center gap-2\"\n                >\n                  <Upload size={16} />\n                  Dosya Yükle\n                </Button>\n              </div>\n            </div>\n          )}\n        </TabsContent>\n        \n        <TabsContent value=\"upload\" className=\"mt-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors\">\n              <Camera size={48} className=\"mx-auto mb-4 text-gray-400\" />\n              <h3 className=\"text-lg font-medium mb-2\">Kamera ile Çekim</h3>\n              <p className=\"text-gray-500 mb-4\">\n                Kamera ile arka arkaya fotoğraf çekerek belgeleri yükleyin\n              </p>\n              <Button \n                onClick={() => setIsCameraCaptureOpen(true)}\n                className=\"w-full\"\n              >\n                Kamerayı Aç\n              </Button>\n            </div>\n            \n            <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors\">\n              <Upload size={48} className=\"mx-auto mb-4 text-gray-400\" />\n              <h3 className=\"text-lg font-medium mb-2\">Dosya Yükleme</h3>\n              <p className=\"text-gray-500 mb-4\">\n                Bilgisayarınızdan görsel dosyalarını seçerek yükleyin\n              </p>\n              <Button \n                onClick={() => setIsUploadModalOpen(true)}\n                className=\"w-full\"\n              >\n                Dosya Seç\n              </Button>\n            </div>\n          </div>\n        </TabsContent>\n      </Tabs>\n\n      {/* Camera Capture Modal */}\n      <CameraCapture\n        isOpen={isCameraCaptureOpen}\n        onClose={() => setIsCameraCaptureOpen(false)}\n        onCapture={handleCameraCapture}\n      />\n\n      {/* File Upload Modal */}\n      <BulkUploadModal\n        isOpen={isUploadModalOpen}\n        onClose={() => setIsUploadModalOpen(false)}\n        onUploadStart={handleStartProcessing}\n        onUploadComplete={handleUploadComplete}\n      />\n\n      {/* Document Processor Modal */}\n      <DocumentProcessor\n        isOpen={isDocumentProcessorOpen}\n        onClose={() => setIsDocumentProcessorOpen(false)}\n        images={capturedImages.length > 0 ? capturedImages : uploadedFiles}\n        onProcessingComplete={handleDocumentProcessingComplete}\n      />\n    </div>\n  );\n};\n\nexport default SGKPage;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/pages/uts/UTSPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1292,1295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1292,1295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1324,1327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1324,1327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1592,1595],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1592,1595],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2161,2164],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2161,2164],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { useState } from 'react';\nimport useUtsRegistrations, { useStartBulkUtsRegistration, usePollUtsJob } from '@/hooks/uts/useUts';\nimport { Button, Textarea } from '@x-ear/ui-web';\nimport UTSBulkUpload from '@/components/uts/UTSBulkUpload';\nimport UTSRegisterModal from '@/components/uts/UTSRegisterModal';\n\nexport const UTSPage: React.FC = () => {\n  const { data, isLoading } = useUtsRegistrations();\n  const startBulk = useStartBulkUtsRegistration();\n  const [csv, setCsv] = useState<string>('');\n  const [openModal, setOpenModal] = useState(false);\n  const [jobId, setJobId] = useState<string | null>(null);\n  const jobStatus = usePollUtsJob(jobId || '', { interval: 10000, onComplete: (data) => console.log('job completed', data) }); // Changed from 3000 (3s) to 10000 (10s)\n\n  const handleStart = () => {\n    // Simple scaffold: parse CSV externally; here we send raw CSV as payload for server to parse\n    startBulk.mutate({ csv });\n  };\n\n  return (\n    <div>\n      <h2>ÜTS Kayıtları</h2>\n      <div style={{ margin: '1rem 0' }}>\n        <Textarea value={csv} onChange={(e) => setCsv(e.target.value)} rows={8} style={{ width: '100%' }} />\n        <div style={{ marginTop: '0.5rem' }}>\n          <Button onClick={handleStart} disabled={(startBulk as any).isLoading || (startBulk as any).isMutating}>\n            Toplu Kayıt Başlat\n          </Button>\n        </div>\n      </div>\n\n      <section>\n        <h3>Geçmiş Kayıtlar</h3>\n        {isLoading ? (\n          <div>Yükleniyor...</div>\n        ) : (\n          <ul>\n            {(data || []).map((r: any) => (\n              <li key={r.id}>{r.id} - {r.status}</li>\n            ))}\n          </ul>\n        )}\n      </section>\n\n      <section style={{ marginTop: 24 }}>\n        <h3>Toplu Kayıt (CSV)</h3>\n        <div style={{ marginBottom: 8 }}>\n          <Button onClick={() => setOpenModal(true)}>Toplu Kayıt Başlat</Button>\n        </div>\n        <UTSBulkUpload onStarted={(id) => setJobId(id)} />\n        {jobId && (\n          <div style={{ marginTop: 12 }}>\n            <strong>İş ID:</strong> {jobId} <br />\n            <strong>Durum:</strong> {(jobStatus?.data as any)?.status || (jobStatus.isFetching ? 'Çalışıyor' : 'Bekleniyor')}\n          </div>\n        )}\n      </section>\n\n      <UTSRegisterModal open={openModal} onClose={() => setOpenModal(false)} />\n    </div>\n  );\n};\n\nexport default UTSPage;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routeTree.gen.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":3,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":3,"endColumn":15,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1474,1477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1474,1477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1600,1603],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1600,1603],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1722,1725],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1722,1725],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1860,1863],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1860,1863],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2002,2005],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2002,2005],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2144,2147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2144,2147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2290,2293],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2290,2293],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2448,2451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2448,2451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2568,2571],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2568,2571],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":76,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2702,2705],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2702,2705],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2836,2839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2836,2839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2998,3001],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2998,3001],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3158,3161],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3158,3161],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3294,3297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3294,3297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/__root.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/appointments.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/index.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1877,1880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1877,1880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2015,2018],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2015,2018],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button, Select } from '@x-ear/ui-web';\nimport { createFileRoute } from '@tanstack/react-router'\nimport React, { useState } from 'react';\nimport { RefreshCw } from 'lucide-react';\nimport { DashboardStats } from '../components/dashboard/DashboardStats';\nimport { QuickStatsCard } from '../components/dashboard/QuickStatsCard';\nimport { CashRegisterCard } from '../components/dashboard/CashRegisterCard';\nimport { PricingCalculatorCard } from '../components/dashboard/PricingCalculatorCard';\nimport { CashRegisterModal } from '../components/dashboard/CashRegisterModal';\nimport { PricingCalculatorModal } from '../components/dashboard/PricingCalculatorModal';\nimport { useDashboardData } from '../hooks/useDashboardData';\n\nexport const Route = createFileRoute('/')({\n  component: Dashboard,\n})\n\nfunction Dashboard() {\n  const { stats, lastTransaction, lastCalculation, loading, error } = useDashboardData();\n  const [dateRange, setDateRange] = useState('week');\n  const [isCashRegisterModalOpen, setIsCashRegisterModalOpen] = useState(false);\n  const [isPricingCalculatorModalOpen, setIsPricingCalculatorModalOpen] = useState(false);\n\n  const handleCardClick = (cardType: string) => {\n    switch (cardType) {\n      case 'patients':\n        window.location.href = '/patients';\n        break;\n      case 'trials':\n        // Navigate to patients with trial filter\n        window.location.href = '/patients?filter=trial';\n        break;\n      case 'revenue':\n        // Navigate to reports\n        window.location.href = '/reports';\n        break;\n      case 'appointments':\n        window.location.href = '/appointments';\n        break;\n    }\n  };\n\n  const handleCashRegisterClick = () => {\n    setIsCashRegisterModalOpen(true);\n  };\n\n  const handlePricingCalculatorClick = () => {\n    setIsPricingCalculatorModalOpen(true);\n  };\n\n  const handleCashRegisterSubmit = (data: any) => {\n    console.log('Cash register data:', data);\n    // TODO: Save to backend\n  };\n\n  const handlePricingCalculatorSubmit = (data: any) => {\n    console.log('Pricing calculation data:', data);\n    // TODO: Save to backend\n  };\n\n  const handleRefresh = () => {\n    window.location.reload();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n        <p className=\"text-red-600\">Hata: {error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Dashboard Controls */}\n      <div className=\"bg-white border-b border-gray-200 px-6 py-4 rounded-lg shadow-sm\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <Select \n              value={dateRange}\n              onChange={(e) => setDateRange(e.target.value)}\n              className=\"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              options={[\n                { value: \"today\", label: \"Bugün\" },\n                { value: \"week\", label: \"Son 1 Hafta\" },\n                { value: \"month\", label: \"Son 1 Ay\" },\n                { value: \"quarter\", label: \"Son Çeyrek\" }\n              ]}\n            />\n            <Button\n              onClick={handleRefresh}\n              className=\"p-2 text-gray-600 hover:text-gray-900 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n              variant='secondary'>\n              <RefreshCw className=\"w-5 h-5\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n      {/* KPI Cards */}\n      <DashboardStats \n        stats={{\n          totalPatients: stats.totalPatients,\n          todayAppointments: stats.todayAppointments,\n          monthlyRevenue: stats.monthlyRevenue,\n          activeTrials: stats.activeTrials,\n        }}\n        onCardClick={handleCardClick}\n      />\n      {/* Cash Register Card and Charts Row */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Cash Register Card */}\n        <CashRegisterCard\n          lastTransaction={lastTransaction}\n          onClick={handleCashRegisterClick}\n        />\n\n        {/* Pricing Calculator Card */}\n        <PricingCalculatorCard\n          lastCalculation={lastCalculation}\n          onClick={handlePricingCalculatorClick}\n        />\n\n        {/* Quick Stats Card */}\n        <QuickStatsCard\n          stats={{\n            activePatients: stats.activePatients,\n            dailyRevenue: stats.dailyRevenue,\n            pendingAppointments: stats.pendingAppointments,\n            endingTrials: stats.endingTrials,\n          }}\n        />\n      </div>\n      {/* Charts and Analytics Placeholder */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Trend Analizi</h3>\n          <div className=\"h-64 bg-gray-50 rounded-lg flex items-center justify-center\">\n            <p className=\"text-gray-500\">Chart component will be implemented here</p>\n          </div>\n        </div>\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Hasta Dağılımı</h3>\n          <div className=\"h-64 bg-gray-50 rounded-lg flex items-center justify-center\">\n            <p className=\"text-gray-500\">Chart component will be implemented here</p>\n          </div>\n        </div>\n      </div>\n      {/* Secondary Charts */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Cihaz Dağılımı</h3>\n          <div className=\"h-64 bg-gray-50 rounded-lg flex items-center justify-center\">\n            <p className=\"text-gray-500\">Device distribution chart</p>\n          </div>\n        </div>\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Son Aktiviteler</h3>\n          <div className=\"h-64 bg-gray-50 rounded-lg flex items-center justify-center\">\n            <p className=\"text-gray-500\">Recent activities list</p>\n          </div>\n        </div>\n      </div>\n      {/* Modals */}\n      <CashRegisterModal\n        isOpen={isCashRegisterModalOpen}\n        onClose={() => setIsCashRegisterModalOpen(false)}\n        onSubmit={handleCashRegisterSubmit}\n      />\n      <PricingCalculatorModal\n        isOpen={isPricingCalculatorModalOpen}\n        onClose={() => setIsPricingCalculatorModalOpen(false)}\n        onCalculate={handlePricingCalculatorSubmit}\n      />\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/inventory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/invoices.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/invoices/index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/invoices/new.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { createFileRoute } from '@tanstack/react-router'\nimport { InvoicesPage } from '../../pages/InvoicesPage'\n\nexport const Route = createFileRoute('/invoices/new')({\n  component: NewInvoice,\n})\n\nfunction NewInvoice() {\n  return <InvoicesPage initialViewMode=\"form\" />\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/invoices/purchases.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/patients.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/patients/$patientId.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/patients/index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/reports.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/sgk.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/routes/uts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/EFaturaXMLService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EFATURA_CURRENCY_CODES' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2241,2244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2241,2244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2267,2270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2267,2270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":206,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6112,6115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6112,6115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":206,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6138,6141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6138,6141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":215,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":215,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6465,6468],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6465,6468],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":219,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6600,6603],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6600,6603],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":221,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":221,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6657,6660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6657,6660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":224,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6752,6755],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6752,6755],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":225,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6852,6855],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6852,6855],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'unitPrice' is defined but never used.","line":481,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":481,"endColumn":45}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Invoice } from '../types/invoice';\nimport {\n  EFaturaXMLData,\n  EFaturaXMLOptions,\n  EFaturaXMLResult,\n  EFaturaInvoice,\n  EFaturaParty,\n  EFaturaInvoiceLine,\n  EFaturaTaxTotal,\n  EFaturaLegalMonetaryTotal,\n  EFATURA_INVOICE_TYPE_CODES,\n  EFATURA_CURRENCY_CODES,\n  EFATURA_UNIT_CODES,\n  EFATURA_TAX_SCHEME_CODES\n} from '../types/efatura';\n\nexport class EFaturaXMLService {\n  private static instance: EFaturaXMLService;\n\n  private constructor() {}\n\n  public static getInstance(): EFaturaXMLService {\n    if (!EFaturaXMLService.instance) {\n      EFaturaXMLService.instance = new EFaturaXMLService();\n    }\n    return EFaturaXMLService.instance;\n  }\n\n  /**\n   * Generate E-Fatura XML from invoice data\n   */\n  public async generateXML(\n    invoice: Invoice,\n    options: EFaturaXMLOptions = {}\n  ): Promise<EFaturaXMLResult> {\n    try {\n      // Convert invoice to E-Fatura format\n      const efaturaData = this.convertInvoiceToEFatura(invoice);\n      \n      // Generate XML content\n      const xmlContent = this.buildXMLContent(efaturaData, options);\n      \n      // Validate XML if requested\n      let validationResult;\n      if (options.validateXML) {\n        validationResult = this.validateXML(xmlContent);\n        if (!validationResult.isValid) {\n          return {\n            success: false,\n            errors: validationResult.errors,\n            warnings: validationResult.warnings,\n            validationResult\n          };\n        }\n      }\n\n      // Generate ETTN (E-Fatura Takip Numarası)\n      const ettn = this.generateETTN();\n      \n      // Generate file name\n      const fileName = this.generateFileName(invoice, ettn);\n\n      return {\n        success: true,\n        xmlContent,\n        fileName,\n        ettn,\n        validationResult\n      };\n    } catch (error) {\n      return {\n        success: false,\n        errors: [error instanceof Error ? error.message : 'XML oluşturma hatası']\n      };\n    }\n  }\n\n  /**\n   * Convert Invoice to E-Fatura format\n   */\n  private convertInvoiceToEFatura(invoice: Invoice): EFaturaXMLData {\n  const now = new Date();\n  const issueDate = invoice.issueDate ? new Date(invoice.issueDate) : new Date();\n\n    // Convert invoice basic info\n  const items = Array.isArray((invoice as any).items) ? (invoice as any).items : [];\n\n    const efaturaInvoice: EFaturaInvoice = {\n      id: invoice.invoiceNumber || (`inv-${Date.now()}`),\n      uuid: this.generateUUID(),\n      issueDate: this.formatDate(issueDate),\n      issueTime: this.formatTime(now),\n      invoiceTypeCode: this.mapInvoiceTypeToEFatura(invoice.type),\n      note: invoice.notes || undefined,\n      documentCurrencyCode: invoice.currency || 'TRY',\n      lineCountNumeric: items.length\n    };\n\n    // Convert supplier (always the clinic/company)\n    const supplier: EFaturaParty = {\n      partyIdentification: {\n        id: '1234567890', // This should come from company settings\n        schemeID: 'VKN'\n      },\n      partyName: {\n        name: 'X-Ear Klinik' // This should come from company settings\n      },\n      postalAddress: {\n        streetName: 'Klinik Adresi', // This should come from company settings\n        cityName: 'İstanbul',\n        country: {\n          identificationCode: 'TR',\n          name: 'Türkiye'\n        }\n      },\n      partyTaxScheme: {\n        taxScheme: {\n          name: 'Beşiktaş Vergi Dairesi' // This should come from company settings\n        }\n      }\n    };\n\n    // Convert customer\n    const customer: EFaturaParty = {\n      partyIdentification: {\n        id: (invoice.billingAddress && invoice.billingAddress.taxNumber) || invoice.patientTcNumber || '11111111111',\n        schemeID: (invoice.billingAddress && invoice.billingAddress.taxNumber) ? 'VKN' : 'TCKN'\n      },\n      partyName: {\n        name: (invoice.billingAddress && invoice.billingAddress.name) || invoice.patientName || ''\n      },\n      postalAddress: {\n        streetName: invoice.billingAddress?.address || '',\n        cityName: invoice.billingAddress?.city || '',\n        postalZone: invoice.billingAddress?.postalCode || undefined,\n        country: {\n          identificationCode: 'TR',\n          name: 'Türkiye'\n        }\n      },\n      partyTaxScheme: invoice.billingAddress?.taxOffice ? {\n        taxScheme: {\n          name: invoice.billingAddress!.taxOffice\n        }\n      } : undefined,\n      contact: {\n        telephone: invoice.patientPhone || undefined,\n        electronicMail: undefined // Add email field to invoice if needed\n      }\n    };\n\n    // Convert invoice lines\n    const invoiceLines: EFaturaInvoiceLine[] = items.map((item, index) => ({\n      id: (index + 1).toString(),\n      invoicedQuantity: {\n        unitCode: this.mapUnitToEFatura(item.unitPrice),\n        value: item.quantity\n      },\n      lineExtensionAmount: {\n        currencyID: invoice.currency || 'TRY',\n        value: (Number(item.totalPrice || 0) - Number(item.taxAmount || 0))\n      },\n      taxTotal: {\n        taxAmount: {\n          currencyID: invoice.currency || 'TRY',\n          value: Number(item.taxAmount || 0)\n        },\n        taxSubtotals: [{\n          taxableAmount: {\n            currencyID: invoice.currency || 'TRY',\n            value: (Number(item.totalPrice || 0) - Number(item.taxAmount || 0))\n          },\n          taxAmount: {\n            currencyID: invoice.currency || 'TRY',\n            value: Number(item.taxAmount || 0)\n          },\n          percent: item.taxRate,\n          taxCategory: {\n            taxScheme: {\n              name: 'KDV',\n              taxTypeCode: EFATURA_TAX_SCHEME_CODES.KDV\n            }\n          }\n        }]\n      },\n      item: {\n        name: item.name,\n        description: item.description,\n        sellersItemIdentification: item.productId ? {\n          id: item.productId\n        } : undefined\n      },\n      price: {\n        priceAmount: {\n          currencyID: invoice.currency || 'TRY',\n          value: item.unitPrice\n        },\n        baseQuantity: {\n          unitCode: this.mapUnitToEFatura(item.unitPrice),\n          value: 1\n        }\n      }\n    }));\n\n    // Convert tax totals\n  const taxes = Array.isArray((invoice as any).taxes) ? (invoice as any).taxes : [];\n    const taxTotals: EFaturaTaxTotal[] = [{\n      taxAmount: {\n        currencyID: invoice.currency || 'TRY',\n        value: Number(invoice.totalTax || 0)\n      },\n      taxSubtotals: taxes.map(tax => ({\n        taxableAmount: {\n          currencyID: invoice.currency || 'TRY',\n          value: Number((tax as any).baseAmount || 0)\n        },\n        taxAmount: {\n          currencyID: invoice.currency || 'TRY',\n          value: Number((tax as any).taxAmount || 0)\n        },\n        percent: (tax as any).rate || 0,\n        taxCategory: {\n          taxScheme: {\n            name: String((tax as any).type || 'KDV').toUpperCase(),\n            taxTypeCode: EFATURA_TAX_SCHEME_CODES[String((tax as any).type || 'KDV').toUpperCase() as keyof typeof EFATURA_TAX_SCHEME_CODES] || EFATURA_TAX_SCHEME_CODES.KDV\n          }\n        }\n      }))\n    }];\n\n    // Convert legal monetary total\n    const subtotal = Number(invoice.subtotal || 0);\n    const totalDiscount = Number(invoice.totalDiscount || 0);\n    const totalTax = Number(invoice.totalTax || 0);\n    const grandTotal = Number(invoice.grandTotal || subtotal - totalDiscount + totalTax);\n\n    const legalMonetaryTotal: EFaturaLegalMonetaryTotal = {\n      lineExtensionAmount: {\n        currencyID: invoice.currency || 'TRY',\n        value: subtotal\n      },\n      taxExclusiveAmount: {\n        currencyID: invoice.currency || 'TRY',\n        value: subtotal - totalDiscount\n      },\n      taxInclusiveAmount: {\n        currencyID: invoice.currency || 'TRY',\n        value: grandTotal\n      },\n      allowanceTotalAmount: totalDiscount > 0 ? {\n        currencyID: invoice.currency || 'TRY',\n        value: totalDiscount\n      } : undefined,\n      payableAmount: {\n        currencyID: invoice.currency || 'TRY',\n        value: grandTotal\n      }\n    };\n\n    return {\n      invoice: efaturaInvoice,\n      supplier,\n      customer,\n      invoiceLines,\n      taxTotals,\n      legalMonetaryTotal\n    };\n  }\n\n  /**\n   * Build XML content from E-Fatura data\n   */\n  private buildXMLContent(data: EFaturaXMLData, options: EFaturaXMLOptions): string {\n    const encoding = options.encoding || 'UTF-8';\n    const schemaLocation = options.schemaLocation || 'urn:oasis:names:specification:ubl:schema:xsd:Invoice-2 UBL-Invoice-2.1.xsd';\n\n    let xml = `<?xml version=\"1.0\" encoding=\"${encoding}\"?>\\n`;\n    xml += `<Invoice xmlns=\"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2\"\\n`;\n    xml += `         xmlns:cac=\"urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2\"\\n`;\n    xml += `         xmlns:cbc=\"urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2\"\\n`;\n    xml += `         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\\n`;\n    xml += `         xsi:schemaLocation=\"${schemaLocation}\">\\n`;\n\n    // UBL Version\n    xml += `  <cbc:UBLVersionID>2.1</cbc:UBLVersionID>\\n`;\n    xml += `  <cbc:CustomizationID>TR1.2</cbc:CustomizationID>\\n`;\n    xml += `  <cbc:ProfileID>TICARIFATURA</cbc:ProfileID>\\n`;\n\n    // Invoice basic info\n    xml += `  <cbc:ID>${this.escapeXML(data.invoice.id)}</cbc:ID>\\n`;\n    xml += `  <cbc:CopyIndicator>false</cbc:CopyIndicator>\\n`;\n    xml += `  <cbc:UUID>${data.invoice.uuid}</cbc:UUID>\\n`;\n    xml += `  <cbc:IssueDate>${data.invoice.issueDate}</cbc:IssueDate>\\n`;\n    xml += `  <cbc:IssueTime>${data.invoice.issueTime}</cbc:IssueTime>\\n`;\n    xml += `  <cbc:InvoiceTypeCode>${data.invoice.invoiceTypeCode}</cbc:InvoiceTypeCode>\\n`;\n    \n    if (data.invoice.note) {\n      xml += `  <cbc:Note>${this.escapeXML(data.invoice.note)}</cbc:Note>\\n`;\n    }\n\n    xml += `  <cbc:DocumentCurrencyCode>${data.invoice.documentCurrencyCode}</cbc:DocumentCurrencyCode>\\n`;\n    xml += `  <cbc:LineCountNumeric>${data.invoice.lineCountNumeric}</cbc:LineCountNumeric>\\n`;\n\n    // Supplier Party\n    xml += this.buildPartyXML(data.supplier, 'AccountingSupplierParty');\n\n    // Customer Party\n    xml += this.buildPartyXML(data.customer, 'AccountingCustomerParty');\n\n    // Tax Total\n    xml += this.buildTaxTotalXML(data.taxTotals[0]);\n\n    // Legal Monetary Total\n    xml += this.buildLegalMonetaryTotalXML(data.legalMonetaryTotal);\n\n    // Invoice Lines\n    data.invoiceLines.forEach(line => {\n      xml += this.buildInvoiceLineXML(line);\n    });\n\n    xml += `</Invoice>`;\n\n    return options.formatXML ? this.formatXML(xml) : xml;\n  }\n\n  private buildPartyXML(party: EFaturaParty, elementName: string): string {\n    let xml = `  <cac:${elementName}>\\n`;\n    xml += `    <cac:Party>\\n`;\n    \n    // Party Identification\n    xml += `      <cac:PartyIdentification>\\n`;\n    xml += `        <cbc:ID schemeID=\"${party.partyIdentification.schemeID}\">${party.partyIdentification.id}</cbc:ID>\\n`;\n    xml += `      </cac:PartyIdentification>\\n`;\n\n    // Party Name\n    if (party.partyName) {\n      xml += `      <cac:PartyName>\\n`;\n      xml += `        <cbc:Name>${this.escapeXML(party.partyName.name)}</cbc:Name>\\n`;\n      xml += `      </cac:PartyName>\\n`;\n    }\n\n    // Postal Address\n    xml += `      <cac:PostalAddress>\\n`;\n    xml += `        <cbc:StreetName>${this.escapeXML(party.postalAddress.streetName)}</cbc:StreetName>\\n`;\n    if (party.postalAddress.buildingNumber) {\n      xml += `        <cbc:BuildingNumber>${this.escapeXML(party.postalAddress.buildingNumber)}</cbc:BuildingNumber>\\n`;\n    }\n    if (party.postalAddress.citySubdivisionName) {\n      xml += `        <cbc:CitySubdivisionName>${this.escapeXML(party.postalAddress.citySubdivisionName)}</cbc:CitySubdivisionName>\\n`;\n    }\n    xml += `        <cbc:CityName>${this.escapeXML(party.postalAddress.cityName)}</cbc:CityName>\\n`;\n    if (party.postalAddress.postalZone) {\n      xml += `        <cbc:PostalZone>${this.escapeXML(party.postalAddress.postalZone)}</cbc:PostalZone>\\n`;\n    }\n    xml += `        <cac:Country>\\n`;\n    xml += `          <cbc:IdentificationCode>${party.postalAddress.country.identificationCode}</cbc:IdentificationCode>\\n`;\n    xml += `          <cbc:Name>${this.escapeXML(party.postalAddress.country.name)}</cbc:Name>\\n`;\n    xml += `        </cac:Country>\\n`;\n    xml += `      </cac:PostalAddress>\\n`;\n\n    // Party Tax Scheme\n    if (party.partyTaxScheme) {\n      xml += `      <cac:PartyTaxScheme>\\n`;\n      xml += `        <cac:TaxScheme>\\n`;\n      xml += `          <cbc:Name>${this.escapeXML(party.partyTaxScheme.taxScheme.name)}</cbc:Name>\\n`;\n      xml += `        </cac:TaxScheme>\\n`;\n      xml += `      </cac:PartyTaxScheme>\\n`;\n    }\n\n    // Contact\n    if (party.contact) {\n      xml += `      <cac:Contact>\\n`;\n      if (party.contact.telephone) {\n        xml += `        <cbc:Telephone>${this.escapeXML(party.contact.telephone)}</cbc:Telephone>\\n`;\n      }\n      if (party.contact.electronicMail) {\n        xml += `        <cbc:ElectronicMail>${this.escapeXML(party.contact.electronicMail)}</cbc:ElectronicMail>\\n`;\n      }\n      xml += `      </cac:Contact>\\n`;\n    }\n\n    xml += `    </cac:Party>\\n`;\n    xml += `  </cac:${elementName}>\\n`;\n\n    return xml;\n  }\n\n  private buildTaxTotalXML(taxTotal: EFaturaTaxTotal): string {\n    let xml = `  <cac:TaxTotal>\\n`;\n    xml += `    <cbc:TaxAmount currencyID=\"${taxTotal.taxAmount.currencyID}\">${taxTotal.taxAmount.value.toFixed(2)}</cbc:TaxAmount>\\n`;\n    \n    taxTotal.taxSubtotals.forEach(subtotal => {\n      xml += `    <cac:TaxSubtotal>\\n`;\n      xml += `      <cbc:TaxableAmount currencyID=\"${subtotal.taxableAmount.currencyID}\">${subtotal.taxableAmount.value.toFixed(2)}</cbc:TaxableAmount>\\n`;\n      xml += `      <cbc:TaxAmount currencyID=\"${subtotal.taxAmount.currencyID}\">${subtotal.taxAmount.value.toFixed(2)}</cbc:TaxAmount>\\n`;\n      if (subtotal.percent !== undefined) {\n        xml += `      <cbc:Percent>${subtotal.percent}</cbc:Percent>\\n`;\n      }\n      xml += `      <cac:TaxCategory>\\n`;\n      xml += `        <cac:TaxScheme>\\n`;\n      xml += `          <cbc:Name>${this.escapeXML(subtotal.taxCategory.taxScheme.name)}</cbc:Name>\\n`;\n      xml += `          <cbc:TaxTypeCode>${subtotal.taxCategory.taxScheme.taxTypeCode}</cbc:TaxTypeCode>\\n`;\n      xml += `        </cac:TaxScheme>\\n`;\n      xml += `      </cac:TaxCategory>\\n`;\n      xml += `    </cac:TaxSubtotal>\\n`;\n    });\n\n    xml += `  </cac:TaxTotal>\\n`;\n    return xml;\n  }\n\n  private buildLegalMonetaryTotalXML(total: EFaturaLegalMonetaryTotal): string {\n    let xml = `  <cac:LegalMonetaryTotal>\\n`;\n    xml += `    <cbc:LineExtensionAmount currencyID=\"${total.lineExtensionAmount.currencyID}\">${total.lineExtensionAmount.value.toFixed(2)}</cbc:LineExtensionAmount>\\n`;\n    xml += `    <cbc:TaxExclusiveAmount currencyID=\"${total.taxExclusiveAmount.currencyID}\">${total.taxExclusiveAmount.value.toFixed(2)}</cbc:TaxExclusiveAmount>\\n`;\n    xml += `    <cbc:TaxInclusiveAmount currencyID=\"${total.taxInclusiveAmount.currencyID}\">${total.taxInclusiveAmount.value.toFixed(2)}</cbc:TaxInclusiveAmount>\\n`;\n    \n    if (total.allowanceTotalAmount) {\n      xml += `    <cbc:AllowanceTotalAmount currencyID=\"${total.allowanceTotalAmount.currencyID}\">${total.allowanceTotalAmount.value.toFixed(2)}</cbc:AllowanceTotalAmount>\\n`;\n    }\n    \n    if (total.chargeTotalAmount) {\n      xml += `    <cbc:ChargeTotalAmount currencyID=\"${total.chargeTotalAmount.currencyID}\">${total.chargeTotalAmount.value.toFixed(2)}</cbc:ChargeTotalAmount>\\n`;\n    }\n    \n    xml += `    <cbc:PayableAmount currencyID=\"${total.payableAmount.currencyID}\">${total.payableAmount.value.toFixed(2)}</cbc:PayableAmount>\\n`;\n    xml += `  </cac:LegalMonetaryTotal>\\n`;\n    \n    return xml;\n  }\n\n  private buildInvoiceLineXML(line: EFaturaInvoiceLine): string {\n    let xml = `  <cac:InvoiceLine>\\n`;\n    xml += `    <cbc:ID>${line.id}</cbc:ID>\\n`;\n    xml += `    <cbc:InvoicedQuantity unitCode=\"${line.invoicedQuantity.unitCode}\">${line.invoicedQuantity.value}</cbc:InvoicedQuantity>\\n`;\n    xml += `    <cbc:LineExtensionAmount currencyID=\"${line.lineExtensionAmount.currencyID}\">${line.lineExtensionAmount.value.toFixed(2)}</cbc:LineExtensionAmount>\\n`;\n\n    // Tax Total for line\n    if (line.taxTotal) {\n      xml += `    <cac:TaxTotal>\\n`;\n      xml += `      <cbc:TaxAmount currencyID=\"${line.taxTotal.taxAmount.currencyID}\">${line.taxTotal.taxAmount.value.toFixed(2)}</cbc:TaxAmount>\\n`;\n      xml += `    </cac:TaxTotal>\\n`;\n    }\n\n    // Item\n    xml += `    <cac:Item>\\n`;\n    xml += `      <cbc:Name>${this.escapeXML(line.item.name)}</cbc:Name>\\n`;\n    if (line.item.description) {\n      xml += `      <cbc:Description>${this.escapeXML(line.item.description)}</cbc:Description>\\n`;\n    }\n    if (line.item.sellersItemIdentification) {\n      xml += `      <cac:SellersItemIdentification>\\n`;\n      xml += `        <cbc:ID>${this.escapeXML(line.item.sellersItemIdentification.id)}</cbc:ID>\\n`;\n      xml += `      </cac:SellersItemIdentification>\\n`;\n    }\n    xml += `    </cac:Item>\\n`;\n\n    // Price\n    xml += `    <cac:Price>\\n`;\n    xml += `      <cbc:PriceAmount currencyID=\"${line.price.priceAmount.currencyID}\">${line.price.priceAmount.value.toFixed(2)}</cbc:PriceAmount>\\n`;\n    if (line.price.baseQuantity) {\n      xml += `      <cbc:BaseQuantity unitCode=\"${line.price.baseQuantity.unitCode}\">${line.price.baseQuantity.value}</cbc:BaseQuantity>\\n`;\n    }\n    xml += `    </cac:Price>\\n`;\n\n    xml += `  </cac:InvoiceLine>\\n`;\n    return xml;\n  }\n\n  // Helper methods\n  private mapInvoiceTypeToEFatura(type: string): string {\n    const mapping: Record<string, string> = {\n      'sale': EFATURA_INVOICE_TYPE_CODES.SATIS,\n      'service': EFATURA_INVOICE_TYPE_CODES.SATIS,\n      'return': EFATURA_INVOICE_TYPE_CODES.IADE,\n      'sgk': EFATURA_INVOICE_TYPE_CODES.SATIS\n    };\n    return mapping[type] || EFATURA_INVOICE_TYPE_CODES.SATIS;\n  }\n\n  private mapUnitToEFatura(unitPrice: number): string {\n    // Default to piece (C62) - this could be enhanced based on product type\n    return EFATURA_UNIT_CODES.C62;\n  }\n\n  private generateUUID(): string {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      const r = Math.random() * 16 | 0;\n      const v = c === 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);\n    });\n  }\n\n  private generateETTN(): string {\n    // Generate 36-character ETTN\n    return this.generateUUID();\n  }\n\n  private generateFileName(invoice: Invoice, ettn: string): string {\n    const date = invoice.issueDate ? new Date(invoice.issueDate) : new Date();\n    const dateStr = date.toISOString().split('T')[0].replace(/-/g, '');\n    const invNumber = invoice.invoiceNumber || `inv-${dateStr}`;\n    return `${invNumber}_${dateStr}_${ettn.substring(0, 8)}.xml`;\n  }\n\n  private formatDate(date: Date): string {\n    return date.toISOString().split('T')[0];\n  }\n\n  private formatTime(date: Date): string {\n    return date.toTimeString().split(' ')[0];\n  }\n\n  private escapeXML(text: string): string {\n    return text\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  private formatXML(xml: string): string {\n    // Simple XML formatting - could be enhanced with proper XML formatter\n    return xml.replace(/></g, '>\\n<');\n  }\n\n  private validateXML(xml: string): { isValid: boolean; errors: string[]; warnings: string[] } {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    // Basic XML validation\n    try {\n      // Check for basic XML structure\n      if (!xml.includes('<?xml')) {\n        errors.push('XML declaration missing');\n      }\n      \n      if (!xml.includes('<Invoice')) {\n        errors.push('Invoice root element missing');\n      }\n\n      // Check for required elements\n      const requiredElements = [\n        'cbc:ID',\n        'cbc:IssueDate',\n        'cbc:InvoiceTypeCode',\n        'cac:AccountingSupplierParty',\n        'cac:AccountingCustomerParty',\n        'cac:LegalMonetaryTotal'\n      ];\n\n      requiredElements.forEach(element => {\n        if (!xml.includes(element)) {\n          errors.push(`Required element ${element} missing`);\n        }\n      });\n\n    } catch (error) {\n      errors.push(`XML validation error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n}\n\nexport default EFaturaXMLService;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/InvoiceTemplateService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/InvoiceValidationService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[246,249],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[246,249],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":253,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":253,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8401,8404],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8401,8404],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":261,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":261,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8701,8704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8701,8704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":267,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8963,8966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8963,8966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":267,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8983,8986],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8983,8986],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":297,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":297,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9951,9954],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9951,9954],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":303,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10123,10126],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10123,10126],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { InvoiceFormData, InvoiceValidation, InvoiceItem } from '../types/invoice';\nimport { InvoiceValidationUtils } from '../utils/invoice-validation';\n\nexport interface ValidationRule {\n  field: string;\n  message: string;\n  validator: (value: any, formData: InvoiceFormData) => boolean;\n}\n\nexport interface ValidationContext {\n  formData: InvoiceFormData;\n  isSubmitting: boolean;\n  isDraft: boolean;\n  skipOptionalFields?: boolean;\n}\n\nexport class InvoiceValidationService {\n  private static instance: InvoiceValidationService;\n  private validationRules: ValidationRule[] = [];\n\n  private constructor() {\n    this.initializeValidationRules();\n  }\n\n  public static getInstance(): InvoiceValidationService {\n    if (!InvoiceValidationService.instance) {\n      InvoiceValidationService.instance = new InvoiceValidationService();\n    }\n    return InvoiceValidationService.instance;\n  }\n\n  private initializeValidationRules(): void {\n    this.validationRules = [\n      // Patient Information Validation\n      {\n        field: 'patientName',\n        message: 'Hasta adı gereklidir',\n        validator: (value: string) => !!value && value.trim().length >= 2\n      },\n      {\n        field: 'patientTcNumber',\n        message: 'Geçerli bir T.C. kimlik numarası giriniz',\n        validator: (value: string) => !value || InvoiceValidationUtils.validateTCKN(value)\n      },\n      {\n        field: 'patientPhone',\n        message: 'Geçerli bir telefon numarası giriniz',\n        validator: (value: string) => !value || InvoiceValidationUtils.validateTurkishPhone(value)\n      },\n\n      // Billing Address Validation\n      {\n        field: 'billingAddress.name',\n        message: 'Fatura adresi adı gereklidir',\n        validator: (value: string) => !!value && value.trim().length >= 2\n      },\n      {\n        field: 'billingAddress.address',\n        message: 'Fatura adresi gereklidir',\n        validator: (value: string) => !!value && value.trim().length >= 10\n      },\n      {\n        field: 'billingAddress.city',\n        message: 'Şehir bilgisi gereklidir',\n        validator: (value: string) => !!value && value.trim().length >= 2\n      },\n      {\n        field: 'billingAddress.taxNumber',\n        message: 'Geçerli bir vergi numarası giriniz',\n        validator: (value: string) => !value || InvoiceValidationUtils.validateTurkishTaxNumber(value)\n      },\n      {\n        field: 'billingAddress.postalCode',\n        message: 'Geçerli bir posta kodu giriniz',\n        validator: (value: string) => !value || InvoiceValidationUtils.validateTurkishPostalCode(value)\n      },\n\n      // Date Validation\n      {\n        field: 'issueDate',\n        message: 'Fatura tarihi gereklidir',\n        validator: (value: string) => !!value && InvoiceValidationUtils.validateInvoiceDate(value)\n      },\n      {\n        field: 'dueDate',\n        message: 'Vade tarihi fatura tarihinden sonra olmalıdır',\n        validator: (value: string, formData: InvoiceFormData) => \n          !value || InvoiceValidationUtils.validateDueDate(value, formData.issueDate)\n      },\n\n      // Items Validation\n      {\n        field: 'items',\n        message: 'En az bir fatura kalemi gereklidir',\n        validator: (value: InvoiceItem[]) => Array.isArray(value) && value.length > 0\n      },\n\n      // Amount Validation\n      {\n        field: 'grandTotal',\n        message: 'Toplam tutar 0\\'dan büyük olmalıdır',\n        validator: (value: number) => typeof value === 'number' && value > 0\n      }\n    ];\n  }\n\n  public validateForm(context: ValidationContext): InvoiceValidation {\n    const { formData, isSubmitting, isDraft, skipOptionalFields } = context;\n    const errors: Record<string, string> = {};\n    const warnings: Record<string, string> = {};\n\n    // Skip validation for drafts unless submitting\n    if (isDraft && !isSubmitting) {\n      return { isValid: true, errors: {}, warnings: {} };\n    }\n\n    // Apply validation rules\n    for (const rule of this.validationRules) {\n      const fieldValue = this.getNestedValue(formData, rule.field);\n      \n      // Skip optional field validation if requested\n      if (skipOptionalFields && this.isOptionalField(rule.field)) {\n        continue;\n      }\n\n      if (!rule.validator(fieldValue, formData)) {\n        errors[rule.field] = rule.message;\n      }\n    }\n\n    // Validate items in detail\n    if (formData.items && formData.items.length > 0) {\n      formData.items.forEach((item, index) => {\n        const itemErrors = this.validateInvoiceItem(item, index);\n        Object.assign(errors, itemErrors);\n      });\n    }\n\n    // Business logic validations\n    const businessErrors = this.validateBusinessLogic(formData);\n    Object.assign(errors, businessErrors);\n\n    // Generate warnings\n    const validationWarnings = this.generateWarnings(formData);\n    Object.assign(warnings, validationWarnings);\n\n    return {\n      isValid: Object.keys(errors).length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  private validateInvoiceItem(item: InvoiceItem, index: number): Record<string, string> {\n    const errors: Record<string, string> = {};\n    const prefix = `items[${index}]`;\n\n    if (!item.name || item.name.trim().length < 2) {\n      errors[`${prefix}.name`] = `${index + 1}. kalem adı gereklidir`;\n    }\n\n    if (!item.quantity || item.quantity <= 0) {\n      errors[`${prefix}.quantity`] = `${index + 1}. kalem miktarı 0'dan büyük olmalıdır`;\n    }\n\n    if (!item.unitPrice || item.unitPrice <= 0) {\n      errors[`${prefix}.unitPrice`] = `${index + 1}. kalem birim fiyatı 0'dan büyük olmalıdır`;\n    }\n\n    if (item.taxRate < 0 || item.taxRate > 100) {\n      errors[`${prefix}.taxRate`] = `${index + 1}. kalem vergi oranı 0-100 arasında olmalıdır`;\n    }\n\n    // Validate discount\n    if (item.discount && item.discount < 0) {\n      errors[`${prefix}.discount`] = `${index + 1}. kalem indirimi negatif olamaz`;\n    }\n\n    if (item.discountType === 'percentage' && item.discount && item.discount > 100) {\n      errors[`${prefix}.discount`] = `${index + 1}. kalem yüzde indirimi 100'den fazla olamaz`;\n    }\n\n    return errors;\n  }\n\n  private validateBusinessLogic(formData: InvoiceFormData): Record<string, string> {\n    const errors: Record<string, string> = {};\n\n    // Corporate invoice must have tax number\n    if (formData.type === 'service' && !formData.billingAddress.taxNumber) {\n      errors['billingAddress.taxNumber'] = 'Hizmet faturası için vergi numarası gereklidir';\n    }\n\n    // SGK invoice validations\n    if (formData.type === 'sgk') {\n      if (!formData.patientTcNumber) {\n        errors['patientTcNumber'] = 'SGK faturası için T.C. kimlik numarası gereklidir';\n      }\n\n      // Check if all items have SGK codes\n      formData.items.forEach((item, index) => {\n        if (!item.sgkCode) {\n          errors[`items[${index}].sgkCode`] = `${index + 1}. kalem için SGK kodu gereklidir`;\n        }\n      });\n    }\n\n    // Payment method validations\n    if (formData.paymentMethod === 'installment' && !formData.dueDate) {\n      errors['dueDate'] = 'Taksitli ödeme için vade tarihi gereklidir';\n    }\n\n    // Currency validations\n    if (formData.currency !== 'TRY' && !formData.exchangeRate) {\n      errors['exchangeRate'] = 'Yabancı para birimi için döviz kuru gereklidir';\n    }\n\n    return errors;\n  }\n\n  private generateWarnings(formData: InvoiceFormData): Record<string, string> {\n    const warnings: Record<string, string> = {};\n\n    // High amount warning\n    if (formData.grandTotal > 50000) {\n      warnings['grandTotal'] = 'Yüksek tutarlı fatura - onay gerekebilir';\n    }\n\n    // Future date warning\n    const issueDate = new Date(formData.issueDate);\n    const today = new Date();\n    if (issueDate > today) {\n      warnings['issueDate'] = 'Gelecek tarihli fatura oluşturuyorsunuz';\n    }\n\n    // Missing optional but recommended fields\n    if (!formData.referenceNumber) {\n      warnings['referenceNumber'] = 'Referans numarası eklemeniz önerilir';\n    }\n\n    if (!formData.notes && formData.items.some(item => item.discount && item.discount > 0)) {\n      warnings['notes'] = 'İndirimli kalemler için açıklama eklemeniz önerilir';\n    }\n\n    // Tax office warning for corporate customers\n    if (formData.billingAddress.taxNumber && !formData.billingAddress.taxOffice) {\n      warnings['billingAddress.taxOffice'] = 'Vergi dairesi bilgisi eklemeniz önerilir';\n    }\n\n    return warnings;\n  }\n\n  public validateField(fieldName: string, value: any, formData: InvoiceFormData): string | null {\n    const rule = this.validationRules.find(r => r.field === fieldName);\n    if (rule && !rule.validator(value, formData)) {\n      return rule.message;\n    }\n    return null;\n  }\n\n  public validateItemField(itemIndex: number, fieldName: string, value: any): string | null {\n    const item = { [fieldName]: value } as Partial<InvoiceItem>;\n    const errors = this.validateInvoiceItem(item as InvoiceItem, itemIndex);\n    return errors[`items[${itemIndex}].${fieldName}`] || null;\n  }\n\n  private getNestedValue(obj: any, path: string): any {\n    return path.split('.').reduce((current, key) => {\n      if (key.includes('[') && key.includes(']')) {\n        const arrayKey = key.substring(0, key.indexOf('['));\n        const index = parseInt(key.substring(key.indexOf('[') + 1, key.indexOf(']')));\n        const property = key.substring(key.indexOf('].') + 2);\n        return current?.[arrayKey]?.[index]?.[property];\n      }\n      return current?.[key];\n    }, obj);\n  }\n\n  private isOptionalField(fieldName: string): boolean {\n    const optionalFields = [\n      'patientPhone',\n      'patientTcNumber',\n      'dueDate',\n      'referenceNumber',\n      'orderNumber',\n      'notes',\n      'internalNotes',\n      'billingAddress.taxNumber',\n      'billingAddress.taxOffice',\n      'billingAddress.postalCode'\n    ];\n    return optionalFields.includes(fieldName);\n  }\n\n  // Real-time validation for form fields\n  public createFieldValidator(fieldName: string, formData: InvoiceFormData) {\n    return (value: any) => {\n      return this.validateField(fieldName, value, formData);\n    };\n  }\n\n  // Batch validation for multiple fields\n  public validateFields(fields: Record<string, any>, formData: InvoiceFormData): Record<string, string> {\n    const errors: Record<string, string> = {};\n    \n    Object.entries(fields).forEach(([fieldName, value]) => {\n      const error = this.validateField(fieldName, value, formData);\n      if (error) {\n        errors[fieldName] = error;\n      }\n    });\n\n    return errors;\n  }\n\n  // Custom validation rule registration\n  public addValidationRule(rule: ValidationRule): void {\n    this.validationRules.push(rule);\n  }\n\n  public removeValidationRule(fieldName: string): void {\n    this.validationRules = this.validationRules.filter(rule => rule.field !== fieldName);\n  }\n}\n\nexport default InvoiceValidationService;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/apiClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/appointment.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/appointments/appointments.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/communicationOfflineSync.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1238,1241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1238,1241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":340,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":340,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9785,9788],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9785,9788],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":490,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":490,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14154,14157],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14154,14157],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":520,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":520,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15029,15032],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15029,15032],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\nimport { openDB, DBSchema, IDBPDatabase } from 'idb';\n\n// Database schema interfaces\ninterface CommunicationMessage {\n  id: string;\n  type: 'sms' | 'email';\n  recipient: string;\n  recipientName?: string;\n  patientId?: string;\n  subject?: string;\n  content: string;\n  templateId?: string;\n  scheduledAt?: string;\n  sentAt?: string;\n  deliveredAt?: string;\n  status: 'draft' | 'scheduled' | 'sent' | 'delivered' | 'failed';\n  errorMessage?: string;\n  campaignId?: string;\n  messageType: 'manual' | 'appointment_reminder' | 'campaign' | 'automated';\n  createdAt: string;\n  updatedAt?: string;\n  syncStatus: 'synced' | 'pending' | 'failed';\n  lastSyncAttempt?: string;\n}\n\ninterface CommunicationTemplate {\n  id: string;\n  name: string;\n  description?: string;\n  templateType: 'sms' | 'email';\n  category?: string;\n  subject?: string;\n  bodyText: string;\n  bodyHtml?: string;\n  variables: string[];\n  isActive: boolean;\n  isSystem: boolean;\n  usageCount: number;\n  createdAt: string;\n  updatedAt: string;\n  syncStatus: 'synced' | 'pending' | 'failed';\n  lastSyncAttempt?: string;\n}\n\ninterface OutboxItem {\n  id: string;\n  action: 'create' | 'update' | 'delete';\n  entityType: 'message' | 'template';\n  entityId: string;\n  data: any;\n  createdAt: string;\n  retryCount: number;\n  lastRetryAt?: string;\n  error?: string;\n}\n\ninterface SyncMetadata {\n  id: string;\n  entityType: 'messages' | 'templates';\n  lastSyncTimestamp: string;\n  lastSyncId?: string;\n}\n\n// IndexedDB Schema\ninterface CommunicationDB extends DBSchema {\n  messages: {\n    key: string;\n    value: CommunicationMessage;\n    indexes: {\n      'by-type': string;\n      'by-status': string;\n      'by-sync-status': string;\n      'by-created-at': string;\n      'by-patient-id': string;\n    };\n  };\n  templates: {\n    key: string;\n    value: CommunicationTemplate;\n    indexes: {\n      'by-type': string;\n      'by-category': string;\n      'by-sync-status': string;\n      'by-active': boolean;\n    };\n  };\n  outbox: {\n    key: string;\n    value: OutboxItem;\n    indexes: {\n      'by-entity-type': string;\n      'by-created-at': string;\n      'by-retry-count': number;\n    };\n  };\n  syncMetadata: {\n    key: string;\n    value: SyncMetadata;\n  };\n}\n\nclass CommunicationOfflineSync {\n  private db: IDBPDatabase<CommunicationDB> | null = null;\n  private readonly dbName = 'CommunicationDB';\n  private readonly dbVersion = 1;\n  private syncInProgress = false;\n  private retryTimeouts: Map<string, NodeJS.Timeout> = new Map();\n\n  async initialize(): Promise<void> {\n    try {\n      this.db = await openDB<CommunicationDB>(this.dbName, this.dbVersion, {\n        upgrade(db) {\n          // Messages store\n          if (!db.objectStoreNames.contains('messages')) {\n            const messagesStore = db.createObjectStore('messages', { keyPath: 'id' });\n            messagesStore.createIndex('by-type', 'type');\n            messagesStore.createIndex('by-status', 'status');\n            messagesStore.createIndex('by-sync-status', 'syncStatus');\n            messagesStore.createIndex('by-created-at', 'createdAt');\n            messagesStore.createIndex('by-patient-id', 'patientId');\n          }\n\n          // Templates store\n          if (!db.objectStoreNames.contains('templates')) {\n            const templatesStore = db.createObjectStore('templates', { keyPath: 'id' });\n            templatesStore.createIndex('by-type', 'templateType');\n            templatesStore.createIndex('by-category', 'category');\n            templatesStore.createIndex('by-sync-status', 'syncStatus');\n            templatesStore.createIndex('by-active', 'isActive');\n          }\n\n          // Outbox store\n          if (!db.objectStoreNames.contains('outbox')) {\n            const outboxStore = db.createObjectStore('outbox', { keyPath: 'id' });\n            outboxStore.createIndex('by-entity-type', 'entityType');\n            outboxStore.createIndex('by-created-at', 'createdAt');\n            outboxStore.createIndex('by-retry-count', 'retryCount');\n          }\n\n          // Sync metadata store\n          if (!db.objectStoreNames.contains('syncMetadata')) {\n            db.createObjectStore('syncMetadata', { keyPath: 'id' });\n          }\n        },\n      });\n\n      // Start periodic sync\n      this.startPeriodicSync();\n      \n      // Listen for online/offline events\n      window.addEventListener('online', () => this.handleOnline());\n      window.addEventListener('offline', () => this.handleOffline());\n\n    } catch (error) {\n      console.error('Failed to initialize CommunicationOfflineSync:', error);\n      throw error;\n    }\n  }\n\n  // Messages CRUD operations\n  async saveMessage(message: Omit<CommunicationMessage, 'syncStatus'>): Promise<void> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const messageWithSync: CommunicationMessage = {\n      ...message,\n      syncStatus: navigator.onLine ? 'pending' : 'pending',\n      updatedAt: new Date().toISOString()\n    };\n\n    await this.db.put('messages', messageWithSync);\n\n    // Add to outbox for sync\n    await this.addToOutbox('create', 'message', message.id, messageWithSync);\n\n    // Attempt immediate sync if online\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async updateMessage(id: string, updates: Partial<CommunicationMessage>): Promise<void> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const existing = await this.db.get('messages', id);\n    if (!existing) throw new Error('Message not found');\n\n    const updated: CommunicationMessage = {\n      ...existing,\n      ...updates,\n      syncStatus: 'pending',\n      updatedAt: new Date().toISOString()\n    };\n\n    await this.db.put('messages', updated);\n\n    // Add to outbox for sync\n    await this.addToOutbox('update', 'message', id, updates);\n\n    // Attempt immediate sync if online\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async getMessage(id: string): Promise<CommunicationMessage | undefined> {\n    if (!this.db) throw new Error('Database not initialized');\n    return await this.db.get('messages', id);\n  }\n\n  async getMessages(filters?: {\n    type?: 'sms' | 'email';\n    status?: string;\n    patientId?: string;\n    limit?: number;\n    offset?: number;\n  }): Promise<CommunicationMessage[]> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    let messages = await this.db.getAll('messages');\n\n    // Apply filters\n    if (filters?.type) {\n      messages = messages.filter(m => m.type === filters.type);\n    }\n    if (filters?.status) {\n      messages = messages.filter(m => m.status === filters.status);\n    }\n    if (filters?.patientId) {\n      messages = messages.filter(m => m.patientId === filters.patientId);\n    }\n\n    // Sort by created date (newest first)\n    messages.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n\n    // Apply pagination\n    if (filters?.offset || filters?.limit) {\n      const start = filters.offset || 0;\n      const end = filters.limit ? start + filters.limit : undefined;\n      messages = messages.slice(start, end);\n    }\n\n    return messages;\n  }\n\n  // Templates CRUD operations\n  async saveTemplate(template: Omit<CommunicationTemplate, 'syncStatus'>): Promise<void> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const templateWithSync: CommunicationTemplate = {\n      ...template,\n      syncStatus: 'pending'\n    };\n\n    await this.db.put('templates', templateWithSync);\n\n    // Add to outbox for sync\n    await this.addToOutbox('create', 'template', template.id, templateWithSync);\n\n    // Attempt immediate sync if online\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async updateTemplate(id: string, updates: Partial<CommunicationTemplate>): Promise<void> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const existing = await this.db.get('templates', id);\n    if (!existing) throw new Error('Template not found');\n\n    const updated: CommunicationTemplate = {\n      ...existing,\n      ...updates,\n      syncStatus: 'pending',\n      updatedAt: new Date().toISOString()\n    };\n\n    await this.db.put('templates', updated);\n\n    // Add to outbox for sync\n    await this.addToOutbox('update', 'template', id, updates);\n\n    // Attempt immediate sync if online\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async deleteTemplate(id: string): Promise<void> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    await this.db.delete('templates', id);\n\n    // Add to outbox for sync\n    await this.addToOutbox('delete', 'template', id, null);\n\n    // Attempt immediate sync if online\n    if (navigator.onLine) {\n      this.syncOutbox();\n    }\n  }\n\n  async getTemplate(id: string): Promise<CommunicationTemplate | undefined> {\n    if (!this.db) throw new Error('Database not initialized');\n    return await this.db.get('templates', id);\n  }\n\n  async getTemplates(filters?: {\n    type?: 'sms' | 'email';\n    category?: string;\n    active?: boolean;\n  }): Promise<CommunicationTemplate[]> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    let templates = await this.db.getAll('templates');\n\n    // Apply filters\n    if (filters?.type) {\n      templates = templates.filter(t => t.templateType === filters.type);\n    }\n    if (filters?.category) {\n      templates = templates.filter(t => t.category === filters.category);\n    }\n    if (filters?.active !== undefined) {\n      templates = templates.filter(t => t.isActive === filters.active);\n    }\n\n    // Sort by name\n    templates.sort((a, b) => a.name.localeCompare(b.name));\n\n    return templates;\n  }\n\n  // Outbox management\n  private async addToOutbox(\n    action: 'create' | 'update' | 'delete',\n    entityType: 'message' | 'template',\n    entityId: string,\n    data: any\n  ): Promise<void> {\n    if (!this.db) return;\n\n    const outboxItem: OutboxItem = {\n      id: `${entityType}_${action}_${entityId}_${Date.now()}`,\n      action,\n      entityType,\n      entityId,\n      data,\n      createdAt: new Date().toISOString(),\n      retryCount: 0\n    };\n\n    await this.db.put('outbox', outboxItem);\n  }\n\n  // Sync operations\n  async syncOutbox(): Promise<void> {\n    if (!this.db || this.syncInProgress || !navigator.onLine) return;\n\n    this.syncInProgress = true;\n\n    try {\n      const outboxItems = await this.db.getAll('outbox');\n      \n      for (const item of outboxItems) {\n        try {\n          await this.syncOutboxItem(item);\n          await this.db.delete('outbox', item.id);\n        } catch (error) {\n          console.error('Failed to sync outbox item:', item.id, error);\n          \n          // Update retry count and schedule retry\n          item.retryCount++;\n          item.lastRetryAt = new Date().toISOString();\n          item.error = error instanceof Error ? error.message : 'Unknown error';\n          \n          await this.db.put('outbox', item);\n          \n          // Schedule retry with exponential backoff\n          this.scheduleRetry(item);\n        }\n      }\n    } finally {\n      this.syncInProgress = false;\n    }\n  }\n\n  private async syncOutboxItem(item: OutboxItem): Promise<void> {\n    const baseUrl = '/api/communications';\n    \n    switch (item.entityType) {\n      case 'message':\n        await this.syncMessageItem(item, baseUrl);\n        break;\n      case 'template':\n        await this.syncTemplateItem(item, baseUrl);\n        break;\n    }\n  }\n\n  private async syncMessageItem(item: OutboxItem, baseUrl: string): Promise<void> {\n    const url = item.action === 'create' \n      ? `${baseUrl}/messages`\n      : `${baseUrl}/messages/${item.entityId}`;\n    \n    const method = item.action === 'create' ? 'POST' : \n                   item.action === 'update' ? 'PUT' : 'DELETE';\n\n    const response = await fetch(url, {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n        'Idempotency-Key': `offline_${item.id}`\n      },\n      body: item.action !== 'delete' ? JSON.stringify(item.data) : undefined\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n\n    // Update local sync status\n    if (this.db && item.action !== 'delete') {\n      const entity = await this.db.get('messages', item.entityId);\n      if (entity) {\n        entity.syncStatus = 'synced';\n        await this.db.put('messages', entity);\n      }\n    }\n  }\n\n  private async syncTemplateItem(item: OutboxItem, baseUrl: string): Promise<void> {\n    const url = item.action === 'create' \n      ? `${baseUrl}/templates`\n      : `${baseUrl}/templates/${item.entityId}`;\n    \n    const method = item.action === 'create' ? 'POST' : \n                   item.action === 'update' ? 'PUT' : 'DELETE';\n\n    const response = await fetch(url, {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n        'Idempotency-Key': `offline_${item.id}`\n      },\n      body: item.action !== 'delete' ? JSON.stringify(item.data) : undefined\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n\n    // Update local sync status\n    if (this.db && item.action !== 'delete') {\n      const entity = await this.db.get('templates', item.entityId);\n      if (entity) {\n        entity.syncStatus = 'synced';\n        await this.db.put('templates', entity);\n      }\n    }\n  }\n\n  // Sync from server\n  async syncFromServer(): Promise<void> {\n    if (!this.db || !navigator.onLine) return;\n\n    try {\n      await Promise.all([\n        this.syncMessagesFromServer(),\n        this.syncTemplatesFromServer()\n      ]);\n    } catch (error) {\n      console.error('Failed to sync from server:', error);\n    }\n  }\n\n  private async syncMessagesFromServer(): Promise<void> {\n    if (!this.db) return;\n\n    const metadata = await this.db.get('syncMetadata', 'messages');\n    const since = metadata?.lastSyncTimestamp || new Date(0).toISOString();\n\n    const response = await fetch(`/api/communications/messages?since=${since}&limit=1000`);\n    if (!response.ok) return;\n\n    const result = await response.json();\n    if (!result.success) return;\n\n    const messages: CommunicationMessage[] = result.data.map((msg: any) => ({\n      ...msg,\n      syncStatus: 'synced' as const\n    }));\n\n    // Update local storage\n    for (const message of messages) {\n      await this.db.put('messages', message);\n    }\n\n    // Update sync metadata\n    await this.db.put('syncMetadata', {\n      id: 'messages',\n      entityType: 'messages',\n      lastSyncTimestamp: new Date().toISOString()\n    });\n  }\n\n  private async syncTemplatesFromServer(): Promise<void> {\n    if (!this.db) return;\n\n    const metadata = await this.db.get('syncMetadata', 'templates');\n    const since = metadata?.lastSyncTimestamp || new Date(0).toISOString();\n\n    const response = await fetch(`/api/communications/templates?since=${since}&limit=1000`);\n    if (!response.ok) return;\n\n    const result = await response.json();\n    if (!result.success) return;\n\n    const templates: CommunicationTemplate[] = result.data.map((tmpl: any) => ({\n      ...tmpl,\n      syncStatus: 'synced' as const\n    }));\n\n    // Update local storage\n    for (const template of templates) {\n      await this.db.put('templates', template);\n    }\n\n    // Update sync metadata\n    await this.db.put('syncMetadata', {\n      id: 'templates',\n      entityType: 'templates',\n      lastSyncTimestamp: new Date().toISOString()\n    });\n  }\n\n  // Retry management\n  private scheduleRetry(item: OutboxItem): void {\n    const delay = Math.min(1000 * Math.pow(2, item.retryCount), 300000); // Max 5 minutes\n    \n    const timeoutId = setTimeout(() => {\n      this.syncOutbox();\n      this.retryTimeouts.delete(item.id);\n    }, delay);\n\n    this.retryTimeouts.set(item.id, timeoutId);\n  }\n\n  // Event handlers\n  private handleOnline(): void {\n    console.log('Connection restored, syncing...');\n    this.syncOutbox();\n    this.syncFromServer();\n  }\n\n  private handleOffline(): void {\n    console.log('Connection lost, switching to offline mode');\n    // Clear retry timeouts\n    this.retryTimeouts.forEach(timeout => clearTimeout(timeout));\n    this.retryTimeouts.clear();\n  }\n\n  // Periodic sync\n  private startPeriodicSync(): void {\n    setInterval(() => {\n      if (navigator.onLine) {\n        this.syncOutbox();\n        this.syncFromServer();\n      }\n    }, 30000); // Sync every 30 seconds when online\n  }\n\n  // Utility methods\n  async getPendingSyncCount(): Promise<{ messages: number; templates: number; outbox: number }> {\n    if (!this.db) return { messages: 0, templates: 0, outbox: 0 };\n\n    const [pendingMessages, pendingTemplates, outboxItems] = await Promise.all([\n      this.db.getAllFromIndex('messages', 'by-sync-status', 'pending'),\n      this.db.getAllFromIndex('templates', 'by-sync-status', 'pending'),\n      this.db.getAll('outbox')\n    ]);\n\n    return {\n      messages: pendingMessages.length,\n      templates: pendingTemplates.length,\n      outbox: outboxItems.length\n    };\n  }\n\n  async clearAllData(): Promise<void> {\n    if (!this.db) return;\n\n    const tx = this.db.transaction(['messages', 'templates', 'outbox', 'syncMetadata'], 'readwrite');\n    await Promise.all([\n      tx.objectStore('messages').clear(),\n      tx.objectStore('templates').clear(),\n      tx.objectStore('outbox').clear(),\n      tx.objectStore('syncMetadata').clear()\n    ]);\n  }\n\n  isOnline(): boolean {\n    return navigator.onLine;\n  }\n\n  isSyncInProgress(): boolean {\n    return this.syncInProgress;\n  }\n}\n\n// Export singleton instance\nexport const communicationOfflineSync = new CommunicationOfflineSync();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/device-replacement.service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":283,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":283,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8964,8967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8964,8967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getXEarCRMAPIAutoGenerated } from '../api/generated/xEarCRMAPIAutoGenerated';\nimport type { \n  DeviceReplacementRequest, \n  DeviceReplacementResponse,\n  DeviceInfo,\n  DeviceReplacementHistory\n} from '../types/device-replacement';\n\nexport class DeviceReplacementService {\n  private readonly STORAGE_KEY = 'xear_device_replacements';\n  private api = getXEarCRMAPIAutoGenerated();\n\n  /**\n   * Create a new device replacement record\n   */\n  async createReplacement(request: DeviceReplacementRequest): Promise<DeviceReplacementResponse> {\n    try {\n      // Generate replacement ID\n      const replacementId = `REPL-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n      \n      // Create replacement history record\n      const replacement: DeviceReplacementHistory = {\n        id: replacementId,\n        patientId: request.patientId,\n        oldDeviceId: request.oldDeviceId,\n        newDeviceId: request.newInventoryId || `NEW-${Date.now()}`,\n        oldDeviceInfo: await this.getDeviceInfo(request.oldDeviceId),\n        newDeviceInfo: request.newDeviceInfo as DeviceInfo || await this.getInventoryDeviceInfo(request.newInventoryId!),\n        replacementReason: request.replacementReason,\n        replacementDate: new Date().toISOString(),\n        replacedBy: 'current_user', // TODO: Get from auth context\n        status: 'pending',\n        notes: request.notes,\n        returnInvoiceId: request.createReturnInvoice ? `INV-${Date.now()}` : undefined,\n        returnInvoiceStatus: request.createReturnInvoice ? 'pending' : undefined,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n      };\n\n      // Try to save to backend first\n      try {\n        // Note: These API endpoints may not exist yet, using mock structure\n        const mockResponse = {\n          success: true,\n          data: { id: replacement.id }\n        };\n        console.log('Mock API call for replacement creation:', mockResponse);\n      } catch (apiError) {\n        console.warn('Backend API unavailable, using local storage:', apiError);\n      }\n\n      // Save to local storage as backup/fallback\n      await this.saveToLocalStorage(replacement);\n\n      // If return invoice is requested, create it\n      if (request.createReturnInvoice) {\n        await this.createReturnInvoice(replacement, request.invoiceType || 'individual');\n      }\n\n      return {\n        success: true,\n        data: replacement,\n        timestamp: new Date().toISOString()\n      };\n\n    } catch (error) {\n      console.error('Error creating device replacement:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error occurred',\n        timestamp: new Date().toISOString()\n      };\n    }\n  }\n\n  /**\n   * Get replacement history for a patient\n   */\n  async getPatientReplacements(patientId: string): Promise<DeviceReplacementHistory[]> {\n    try {\n      // Try to fetch from backend first\n      try {\n        // Note: API endpoint may not exist yet, using mock\n        const mockResponse = { success: false };\n        console.log('Mock API call for patient replacements:', mockResponse);\n      } catch (apiError) {\n        console.warn('Backend API unavailable, using local storage:', apiError);\n      }\n\n      // Fallback to local storage\n      return this.getFromLocalStorage().filter(r => r.patientId === patientId);\n    } catch (error) {\n      console.error('Error fetching patient replacements:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get all replacement history\n   */\n  async getAllReplacements(): Promise<DeviceReplacementHistory[]> {\n    try {\n      // Try to fetch from backend first\n      try {\n        // Note: API endpoint may not exist yet, using mock\n        const mockResponse = { success: false };\n        console.log('Mock API call for all replacements:', mockResponse);\n      } catch (apiError) {\n        console.warn('Backend API unavailable, using local storage:', apiError);\n      }\n\n      // Fallback to local storage\n      return this.getFromLocalStorage();\n    } catch (error) {\n      console.error('Error fetching all replacements:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Update replacement status\n   */\n  async updateReplacementStatus(\n    replacementId: string, \n    status: DeviceReplacementHistory['status'],\n    notes?: string\n  ): Promise<DeviceReplacementResponse> {\n    try {\n      // Update in backend\n      try {\n        // Note: API endpoint may not exist yet, using mock\n        console.log('Mock API call for update replacement:', { replacementId, status, notes });\n      } catch (apiError) {\n        console.warn('Backend API unavailable, updating local storage:', apiError);\n      }\n\n      // Update in local storage\n      const replacements = this.getFromLocalStorage();\n      const index = replacements.findIndex(r => r.id === replacementId);\n      \n      if (index !== -1) {\n        replacements[index].status = status;\n        replacements[index].updatedAt = new Date().toISOString();\n        if (notes) {\n          replacements[index].notes = notes;\n        }\n        \n        localStorage.setItem(this.STORAGE_KEY, JSON.stringify(replacements));\n        \n        return {\n          success: true,\n          data: replacements[index],\n          timestamp: new Date().toISOString()\n        };\n      }\n\n      throw new Error('Replacement not found');\n    } catch (error) {\n      console.error('Error updating replacement status:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error occurred',\n        timestamp: new Date().toISOString()\n      };\n    }\n  }\n\n  /**\n   * Create return invoice for replacement\n   */\n  private async createReturnInvoice(\n    replacement: DeviceReplacementHistory, \n    invoiceType: 'individual' | 'corporate' | 'e_archive'\n  ): Promise<void> {\n    try {\n      // Simulate return invoice creation\n      const returnInvoice = {\n        id: `RET-INV-${Date.now()}`,\n        replacementId: replacement.id,\n        patientId: replacement.patientId,\n        deviceInfo: replacement.oldDeviceInfo,\n        amount: replacement.oldDeviceInfo.price,\n        invoiceType,\n        status: 'created',\n        createdAt: new Date().toISOString()\n      };\n\n      // Update replacement with invoice information\n      replacement.returnInvoiceId = returnInvoice.id;\n      replacement.returnInvoiceStatus = 'created';\n      \n      console.log('Return invoice created:', returnInvoice);\n    } catch (error) {\n      console.error('Error creating return invoice:', error);\n      replacement.returnInvoiceStatus = 'pending';\n    }\n  }\n\n  /**\n   * Get device information\n   */\n  private async getDeviceInfo(deviceId: string): Promise<DeviceInfo> {\n    try {\n      // Try to get from API - using mock for now since exact API structure is unclear\n      console.log('Mock device info fetch for:', deviceId);\n    } catch (error) {\n      console.warn('Could not fetch device info from API:', error);\n    }\n\n    // Fallback to mock data\n    return {\n      brand: 'Unknown',\n      model: 'Unknown',\n      serialNumber: deviceId,\n      deviceType: 'hearing_aid',\n      price: 0\n    };\n  }\n\n  /**\n   * Get device information from inventory\n   */\n  private async getInventoryDeviceInfo(inventoryId: string): Promise<DeviceInfo> {\n    try {\n      // Try to get from API\n      const response = await this.api.inventoryGetInventoryItem(inventoryId);\n      if (response.data?.data) {\n        const item = response.data.data;\n        return {\n          brand: item.brand || '',\n          model: item.model || '',\n          serialNumber: item.availableSerials?.[0] || '',\n          deviceType: item.category || '',\n          price: item.price || 0\n        };\n      }\n    } catch (error) {\n      console.warn('Could not fetch inventory info from API:', error);\n    }\n\n    // Fallback to mock data\n    return {\n      brand: 'Unknown',\n      model: 'Unknown',\n      serialNumber: '',\n      deviceType: 'Unknown',\n      price: 0\n    };\n  }\n\n  /**\n   * Save replacement to local storage\n   */\n  private async saveToLocalStorage(replacement: DeviceReplacementHistory): Promise<void> {\n    const replacements = this.getFromLocalStorage();\n    const existingIndex = replacements.findIndex(r => r.id === replacement.id);\n    \n    if (existingIndex !== -1) {\n      replacements[existingIndex] = replacement;\n    } else {\n      replacements.push(replacement);\n    }\n    \n    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(replacements));\n  }\n\n  /**\n   * Get replacements from local storage\n   */\n  private getFromLocalStorage(): DeviceReplacementHistory[] {\n    try {\n      const stored = localStorage.getItem(this.STORAGE_KEY);\n      return stored ? JSON.parse(stored) : [];\n    } catch (error) {\n      console.error('Error reading from local storage:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Normalize replacement data from API\n   */\n  private normalizeReplacementData(data: any): DeviceReplacementHistory {\n    return {\n      id: data.id,\n      patientId: data.patient_id || data.patientId,\n      oldDeviceId: data.old_device_id || data.oldDeviceId,\n      newDeviceId: data.new_device_id || data.newDeviceId,\n      oldDeviceInfo: typeof data.old_device_info === 'string' \n        ? JSON.parse(data.old_device_info) \n        : data.old_device_info || data.oldDeviceInfo,\n      newDeviceInfo: typeof data.new_device_info === 'string' \n        ? JSON.parse(data.new_device_info) \n        : data.new_device_info || data.newDeviceInfo,\n      replacementReason: data.replacement_reason || data.replacementReason || 'other',\n      replacementDate: data.replacement_date || data.replacementDate || new Date().toISOString(),\n      status: data.status || 'pending',\n      priceDifference: data.price_difference || data.priceDifference || 0,\n      notes: data.notes,\n      replacedBy: data.replaced_by || data.replacedBy || 'unknown',\n      createdAt: data.created_at || data.createdAt || new Date().toISOString(),\n      updatedAt: data.updated_at || data.updatedAt || new Date().toISOString(),\n      returnInvoiceId: data.return_invoice?.id || data.returnInvoiceId,\n      returnInvoiceStatus: data.return_invoice?.status || data.returnInvoiceStatus || 'pending'\n    };\n  }\n}\n\nexport const deviceReplacementService = new DeviceReplacementService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/inventory.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'FuzzySearchResult' is defined but never used.","line":22,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":43}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Inventory Service for X-Ear CRM\n// Modern TypeScript service for inventory management\n\nimport {\n  InventoryItem,\n  CreateInventoryData,\n  UpdateInventoryData,\n  InventoryFilters,\n  InventoryStats,\n  InventoryStatus,\n  InventoryMovement,\n  StockUpdate,\n  InventorySearchResult,\n  SerialNumberAssignment,\n  InventoryCategory,\n  LowStockAlert,\n  BulkInventoryOperation,\n  BulkOperationResult\n} from '../types/inventory';\nimport { INVENTORY_DATA } from '../constants/storage-keys';\nimport { outbox } from '../utils/outbox';\nimport { searchProducts, FuzzySearchResult } from '../utils/fuzzy-search';\nimport { searchAnalytics } from '../utils/search-analytics';\n\nexport class InventoryService {\n  private storageKey = INVENTORY_DATA;\n  private listeners: Set<(items: InventoryItem[]) => void> = new Set();\n\n  constructor() {\n    this.setupStorageListener();\n  }\n\n  private setupStorageListener(): void {\n    window.addEventListener('storage', (event) => {\n      if (event.key === this.storageKey) {\n        const items = this.loadInventory();\n        this.notifyListeners(items);\n      }\n    });\n  }\n\n  private notifyListeners(items: InventoryItem[]): void {\n    this.listeners.forEach(listener => listener(items));\n  }\n\n  public subscribe(listener: (items: InventoryItem[]) => void): () => void {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n\n  private loadInventory(): InventoryItem[] {\n    try {\n      const stored = localStorage.getItem(this.storageKey);\n      return stored ? JSON.parse(stored) : [];\n    } catch (error) {\n      console.error('Failed to load inventory from storage:', error);\n      return [];\n    }\n  }\n\n  private saveInventory(items: InventoryItem[]): void {\n    try {\n      localStorage.setItem(this.storageKey, JSON.stringify(items));\n      this.notifyListeners(items);\n    } catch (error) {\n      console.error('Failed to save inventory to storage:', error);\n      throw new Error('Failed to save inventory data');\n    }\n  }\n\n  // CRUD Operations\n  async getAllItems(): Promise<InventoryItem[]> {\n    return this.loadInventory();\n  }\n\n  async getItemById(id: string): Promise<InventoryItem | null> {\n    const items = this.loadInventory();\n    return items.find(item => item.id === id) || null;\n  }\n\n  async createItem(data: CreateInventoryData): Promise<InventoryItem> {\n    const items = this.loadInventory();\n    \n    // Check for duplicate barcode\n    if (data.barcode && items.some(item => item.barcode === data.barcode)) {\n      throw new Error('Barcode already exists');\n    }\n\n    const newItem: InventoryItem = {\n      ...data,\n      id: `inv_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      totalInventory: data.availableInventory,\n      usedInventory: 0,\n      status: data.availableInventory > 0 ? 'available' : 'out_of_stock',\n      createdAt: new Date().toISOString(),\n      lastUpdated: new Date().toISOString()\n    };\n\n    items.push(newItem);\n    this.saveInventory(items);\n\n    // Queue for sync\n    await outbox.addOperation({\n      method: 'POST',\n      endpoint: '/api/inventory',\n      data: newItem,\n      headers: {\n        'Idempotency-Key': `create-inventory-${newItem.id}-${Date.now()}`\n      }\n    });\n\n    return newItem;\n  }\n\n  async updateItem(id: string, data: UpdateInventoryData): Promise<InventoryItem> {\n    const items = this.loadInventory();\n    const index = items.findIndex(item => item.id === id);\n    \n    if (index === -1) {\n      throw new Error('Inventory item not found');\n    }\n\n    // Check for duplicate barcode (if changed)\n    if (data.barcode && data.barcode !== items[index].barcode) {\n      if (items.some(item => item.id !== id && item.barcode === data.barcode)) {\n        throw new Error('Barcode already exists');\n      }\n    }\n\n    const updatedItem: InventoryItem = {\n      ...items[index],\n      ...data,\n      lastUpdated: new Date().toISOString()\n    };\n\n    // Update status based on stock levels\n    if (data.availableInventory !== undefined) {\n      if (data.availableInventory === 0) {\n        updatedItem.status = 'out_of_stock';\n      } else if (data.availableInventory <= updatedItem.reorderLevel) {\n        updatedItem.status = 'low_stock';\n      } else {\n        updatedItem.status = 'available';\n      }\n    }\n\n    items[index] = updatedItem;\n    this.saveInventory(items);\n\n    // Queue for sync\n    await outbox.addOperation({\n      method: 'PUT',\n      endpoint: `/api/inventory/${id}`,\n      data: updatedItem,\n      headers: {\n        'Idempotency-Key': `update-inventory-${id}-${Date.now()}`\n      }\n    });\n\n    return updatedItem;\n  }\n\n  async deleteItem(id: string): Promise<void> {\n    const items = this.loadInventory();\n    const index = items.findIndex(item => item.id === id);\n    \n    if (index === -1) {\n      throw new Error('Inventory item not found');\n    }\n\n    items.splice(index, 1);\n    this.saveInventory(items);\n\n    // Queue for sync\n    await outbox.addOperation({\n      method: 'DELETE',\n      endpoint: `/api/inventory/${id}`,\n      headers: {\n        'Idempotency-Key': `delete-inventory-${id}-${Date.now()}`\n      }\n    });\n  }\n\n  // Search and Filter\n  async searchItems(filters: InventoryFilters & { enableFuzzySearch?: boolean; maxResults?: number }): Promise<InventorySearchResult> {\n    const startTime = performance.now();\n    const allItems = this.loadInventory();\n    let filteredItems = [...allItems];\n\n    // Apply search filter with fuzzy search support\n    if (filters.search) {\n      if (filters.enableFuzzySearch) {\n        // Use fuzzy search for better matching\n        const fuzzyResults = searchProducts(filters.search, allItems, {\n          maxResults: filters.maxResults || 50,\n          threshold: 0.3,\n          enablePhonetic: true,\n          enableTypoTolerance: true,\n          weights: {\n            name: 0.4,\n            brand: 0.3,\n            model: 0.2,\n            barcode: 0.1\n          }\n        });\n        \n        // Extract items from fuzzy search results and maintain order by relevance\n        filteredItems = fuzzyResults.map(result => result.item as InventoryItem);\n        \n        // Track search analytics\n        const executionTime = performance.now() - startTime;\n        searchAnalytics.trackSearch({\n          query: filters.search,\n          resultCount: filteredItems.length,\n          searchType: 'fuzzy',\n          executionTime,\n          context: 'inventory'\n        });\n      } else {\n        // Fallback to basic string matching\n        const searchTerm = filters.search.toLowerCase();\n        filteredItems = filteredItems.filter(item =>\n          item.name.toLowerCase().includes(searchTerm) ||\n          item.brand.toLowerCase().includes(searchTerm) ||\n          item.model?.toLowerCase().includes(searchTerm) ||\n          item.supplier?.toLowerCase().includes(searchTerm) ||\n          item.barcode?.toLowerCase().includes(searchTerm)\n        );\n        \n        // Track search analytics\n        const executionTime = performance.now() - startTime;\n        searchAnalytics.trackSearch({\n          query: filters.search,\n          resultCount: filteredItems.length,\n          searchType: 'basic',\n          executionTime,\n          context: 'inventory'\n        });\n      }\n    }\n\n    if (filters.category) {\n      filteredItems = filteredItems.filter(item => item.category === filters.category);\n    }\n\n    if (filters.brand) {\n      filteredItems = filteredItems.filter(item => item.brand === filters.brand);\n    }\n\n    if (filters.status) {\n      filteredItems = filteredItems.filter(item => item.status === filters.status);\n    }\n\n    if (filters.lowStock) {\n      filteredItems = filteredItems.filter(item => \n        item.availableInventory <= item.reorderLevel\n      );\n    }\n\n    if (filters.outOfStock) {\n      filteredItems = filteredItems.filter(item => item.availableInventory === 0);\n    }\n\n    if (filters.supplier) {\n      filteredItems = filteredItems.filter(item => item.supplier === filters.supplier);\n    }\n\n    if (filters.minPrice !== undefined) {\n      filteredItems = filteredItems.filter(item => item.price >= filters.minPrice!);\n    }\n\n    if (filters.maxPrice !== undefined) {\n      filteredItems = filteredItems.filter(item => item.price <= filters.maxPrice!);\n    }\n\n    if (filters.hasSerials !== undefined) {\n      filteredItems = filteredItems.filter(item => \n        filters.hasSerials ? \n          (item.availableSerials && item.availableSerials.length > 0) :\n          (!item.availableSerials || item.availableSerials.length === 0)\n      );\n    }\n\n    if (filters.isMinistryTracked !== undefined) {\n      filteredItems = filteredItems.filter(item => \n        item.isMinistryTracked === filters.isMinistryTracked\n      );\n    }\n\n    const stats = this.calculateStats(allItems);\n\n    return {\n      items: filteredItems,\n      total: filteredItems.length,\n      filters,\n      stats\n    };\n  }\n\n  // Stock Management\n  async updateStock(update: StockUpdate): Promise<InventoryItem> {\n    const items = this.loadInventory();\n    const index = items.findIndex(item => item.id === update.itemId);\n    \n    if (index === -1) {\n      throw new Error('Inventory item not found');\n    }\n\n    const item = items[index];\n    let newQuantity: number;\n\n    switch (update.operation) {\n      case 'add':\n        newQuantity = item.availableInventory + update.quantity;\n        item.totalInventory += update.quantity;\n        break;\n      case 'subtract':\n        newQuantity = item.availableInventory - update.quantity;\n        item.usedInventory = (item.usedInventory || 0) + update.quantity;\n        break;\n      case 'set':\n        newQuantity = update.quantity;\n        item.totalInventory = update.quantity + (item.usedInventory || 0);\n        break;\n      default:\n        throw new Error('Invalid operation');\n    }\n\n    if (newQuantity < 0) {\n      throw new Error('Insufficient inventory');\n    }\n\n    item.availableInventory = newQuantity;\n    item.lastUpdated = new Date().toISOString();\n\n    // Update status based on new quantity\n    if (newQuantity === 0) {\n      item.status = 'out_of_stock';\n    } else if (newQuantity <= item.reorderLevel) {\n      item.status = 'low_stock';\n    } else {\n      item.status = 'available';\n    }\n\n    // Handle serial numbers if provided\n    if (update.serialNumbers && update.serialNumbers.length > 0) {\n      if (!item.availableSerials) {\n        item.availableSerials = [];\n      }\n\n      if (update.operation === 'add') {\n        item.availableSerials.push(...update.serialNumbers);\n      } else if (update.operation === 'subtract') {\n        update.serialNumbers.forEach(serial => {\n          const serialIndex = item.availableSerials!.indexOf(serial);\n          if (serialIndex > -1) {\n            item.availableSerials!.splice(serialIndex, 1);\n          }\n        });\n      }\n    }\n\n    items[index] = item;\n    this.saveInventory(items);\n\n    // Log the movement\n    await this.logMovement({\n      id: `mov_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      itemId: update.itemId,\n      type: update.operation === 'add' ? 'in' : 'out',\n      quantity: Math.abs(update.quantity),\n      reason: update.reason || 'Stock adjustment',\n      reference: update.notes,\n      serialNumbers: update.serialNumbers,\n      performedBy: 'system', // TODO: Get from auth context\n      createdAt: new Date().toISOString(),\n      notes: update.notes\n    });\n\n    // Queue for sync\n    await outbox.addOperation({\n      method: 'PUT',\n      endpoint: `/api/inventory/${update.itemId}/stock`,\n      data: update,\n      headers: {\n        'Idempotency-Key': `stock-update-${update.itemId}-${Date.now()}`\n      }\n    });\n\n    return item;\n  }\n\n  // Statistics and Analytics\n  async getStats(): Promise<InventoryStats> {\n    const items = this.loadInventory();\n    return this.calculateStats(items);\n  }\n\n  private calculateStats(items: InventoryItem[]): InventoryStats {\n    const stats: InventoryStats = {\n      total: items.length,\n      available: 0,\n      lowStock: 0,\n      outOfStock: 0,\n      totalValue: 0,\n      activeTrials: 0,\n      byCategory: {} as Record<InventoryCategory, number>,\n      byBrand: {},\n      byStatus: {} as Record<InventoryStatus, number>,\n      recentlyUpdated: 0\n    };\n\n    const oneWeekAgo = new Date();\n    oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\n\n    items.forEach(item => {\n      // Status counts\n      if (item.availableInventory > 0) {\n        stats.available++;\n      }\n      if (item.availableInventory <= item.reorderLevel) {\n        stats.lowStock++;\n      }\n      if (item.availableInventory === 0) {\n        stats.outOfStock++;\n      }\n\n      // Total value\n      stats.totalValue += item.availableInventory * item.price;\n\n      // Active trials count - sum up all items currently on trial\n      if (item.onTrial && item.onTrial > 0) {\n        stats.activeTrials += item.onTrial;\n      }\n\n      // By category\n      stats.byCategory[item.category] = (stats.byCategory[item.category] || 0) + 1;\n\n      // By brand\n      stats.byBrand[item.brand] = (stats.byBrand[item.brand] || 0) + 1;\n\n      // By status\n      const status = item.status || 'available';\n      stats.byStatus[status] = (stats.byStatus[status] || 0) + 1;\n\n      // Recently updated\n      if (new Date(item.lastUpdated) > oneWeekAgo) {\n        stats.recentlyUpdated++;\n      }\n    });\n\n    return stats;\n  }\n\n  // Low Stock Alerts\n  async getLowStockAlerts(): Promise<LowStockAlert[]> {\n    const items = this.loadInventory();\n    const alerts: LowStockAlert[] = [];\n\n    items.forEach(item => {\n      if (item.availableInventory <= item.reorderLevel) {\n        alerts.push({\n          item,\n          currentStock: item.availableInventory,\n          reorderLevel: item.reorderLevel,\n          suggestedOrderQuantity: Math.max(item.reorderLevel * 2, 10)\n        });\n      }\n    });\n\n    return alerts.sort((a, b) => a.currentStock - b.currentStock);\n  }\n\n  // Serial Number Management\n  async assignSerialNumber(itemId: string, serialNumber: string, patientId?: string): Promise<SerialNumberAssignment> {\n    const items = this.loadInventory();\n    const item = items.find(i => i.id === itemId);\n    \n    if (!item) {\n      throw new Error('Inventory item not found');\n    }\n\n    if (!item.availableSerials || !item.availableSerials.includes(serialNumber)) {\n      throw new Error('Serial number not available');\n    }\n\n    // Remove from available serials\n    const serialIndex = item.availableSerials.indexOf(serialNumber);\n    item.availableSerials.splice(serialIndex, 1);\n    \n    // Decrease available inventory\n    item.availableInventory--;\n    item.usedInventory = (item.usedInventory || 0) + 1;\n    item.lastUpdated = new Date().toISOString();\n\n    this.saveInventory(items);\n\n    const assignment: SerialNumberAssignment = {\n      serialNumber,\n      itemId,\n      patientId,\n      assignedAt: new Date().toISOString(),\n      status: patientId ? 'assigned' : 'trial'\n    };\n\n    // Queue for sync\n    await outbox.addOperation({\n      method: 'POST',\n      endpoint: `/api/inventory/${itemId}/serial`,\n      data: { serialNumber, patientId },\n      headers: {\n        'Idempotency-Key': `assign-serial-${itemId}-${serialNumber}-${Date.now()}`\n      }\n    });\n\n    return assignment;\n  }\n\n  // Movement Logging\n  private async logMovement(movement: InventoryMovement): Promise<void> {\n    // Store movements in a separate storage key\n    const movementsKey = `${this.storageKey}_movements`;\n    try {\n      const stored = localStorage.getItem(movementsKey);\n      const movements: InventoryMovement[] = stored ? JSON.parse(stored) : [];\n      movements.push(movement);\n      \n      // Keep only last 1000 movements\n      if (movements.length > 1000) {\n        movements.splice(0, movements.length - 1000);\n      }\n      \n      localStorage.setItem(movementsKey, JSON.stringify(movements));\n    } catch (error) {\n      console.error('Failed to log inventory movement:', error);\n    }\n  }\n\n  async getMovements(itemId?: string): Promise<InventoryMovement[]> {\n    const movementsKey = `${this.storageKey}_movements`;\n    try {\n      const stored = localStorage.getItem(movementsKey);\n      const movements: InventoryMovement[] = stored ? JSON.parse(stored) : [];\n      \n      if (itemId) {\n        return movements.filter(m => m.itemId === itemId);\n      }\n      \n      return movements;\n    } catch (error) {\n      console.error('Failed to load inventory movements:', error);\n      return [];\n    }\n  }\n\n  // Bulk Operations\n  async bulkOperation(operation: BulkInventoryOperation): Promise<BulkOperationResult> {\n    const result: BulkOperationResult = {\n      success: true,\n      processed: 0,\n      created: 0,\n      updated: 0,\n      failed: 0,\n      errors: []\n    };\n\n    for (let i = 0; i < operation.items.length; i++) {\n      const item = operation.items[i];\n      result.processed++;\n\n      try {\n        switch (operation.type) {\n          case 'import':\n            if (item.id && await this.getItemById(item.id)) {\n              if (operation.options?.updateExisting) {\n                await this.updateItem(item.id, item as UpdateInventoryData);\n                result.updated++;\n              } else {\n                throw new Error('Item already exists');\n              }\n            } else {\n              await this.createItem(item as CreateInventoryData);\n              result.created++;\n            }\n            break;\n          \n          case 'update':\n            if (!item.id) {\n              throw new Error('Item ID required for update');\n            }\n            await this.updateItem(item.id, item as UpdateInventoryData);\n            result.updated++;\n            break;\n          \n          case 'delete':\n            if (!item.id) {\n              throw new Error('Item ID required for delete');\n            }\n            await this.deleteItem(item.id);\n            break;\n          \n          default:\n            throw new Error('Unsupported operation type');\n        }\n      } catch (error) {\n        result.failed++;\n        result.errors.push({\n          index: i,\n          item,\n          error: error instanceof Error ? error.message : 'Unknown error'\n        });\n      }\n    }\n\n    result.success = result.failed === 0;\n    return result;\n  }\n\n  // Utility Methods\n  async getCategories(): Promise<InventoryCategory[]> {\n    const items = this.loadInventory();\n    const categories = new Set<InventoryCategory>();\n    items.forEach(item => categories.add(item.category));\n    return Array.from(categories);\n  }\n\n  async getBrands(): Promise<string[]> {\n    const items = this.loadInventory();\n    const brands = new Set<string>();\n    items.forEach(item => brands.add(item.brand));\n    return Array.from(brands).sort();\n  }\n\n  async getSuppliers(): Promise<string[]> {\n    const items = this.loadInventory();\n    const suppliers = new Set<string>();\n    items.forEach(item => {\n      if (item.supplier) {\n        suppliers.add(item.supplier);\n      }\n    });\n    return Array.from(suppliers).sort();\n  }\n}\n\n// Export singleton instance\nexport const inventoryService = new InventoryService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/invoice.service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5413,5416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5413,5416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":210,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7004,7007],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7004,7007],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9020,9023],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9020,9023],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":409,"column":101,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":409,"endColumn":104,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13417,13420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13417,13420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":561,"column":91,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":561,"endColumn":94,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18077,18080],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18077,18080],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { \n  Invoice, \n  InvoiceFilters, \n  InvoiceSearchResult, \n  InvoiceStats, \n  InvoiceItem, \n  InvoiceTemplate, \n  CreateInvoiceData, \n  UpdateInvoiceData, \n  InvoiceCalculation, \n  InvoiceValidation, \n  InvoicePayment, \n  InvoicePaymentPlan, \n  EFaturaSubmission, \n  EFaturaBulkSubmission, \n  InvoiceExportOptions, \n  InvoiceStatus, \n  InvoiceType, \n  PaymentMethod \n} from '../types/invoice';\nimport { INVOICES_DATA } from '../constants/storage-keys';\nimport { outbox } from '../utils/outbox';\nimport { getXEarCRMAPIAutoGenerated } from '../api/generated/api';\n\nexport class InvoiceService {\n  // Load invoices from localStorage\n  private async loadInvoices(): Promise<Invoice[]> {\n    try {\n      const data = localStorage.getItem(INVOICES_DATA);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error('Error loading invoices:', error);\n      return [];\n    }\n  }\n\n  // Save invoices to localStorage\n  private async saveInvoices(invoices: Invoice[]): Promise<void> {\n    try {\n      localStorage.setItem(INVOICES_DATA, JSON.stringify(invoices));\n    } catch (error) {\n      console.error('Error saving invoices:', error);\n      throw new Error('Faturalar kaydedilemedi');\n    }\n  }\n\n  // Generate sample invoice data\n  private generateSampleInvoices(): Invoice[] {\n    const sampleInvoices: Invoice[] = [];\n    const statuses: InvoiceStatus[] = ['draft', 'sent', 'paid', 'overdue', 'cancelled'];\n    const types: InvoiceType[] = ['standard' as InvoiceType, 'proforma' as InvoiceType, 'credit_note' as InvoiceType, 'debit_note' as InvoiceType];\n    \n    for (let i = 1; i <= 20; i++) {\n      const createdDate = new Date(Date.now() - Math.random() * 90 * 24 * 60 * 60 * 1000);\n      const dueDate = new Date(createdDate.getTime() + 30 * 24 * 60 * 60 * 1000);\n      \n      const items = this.generateInvoiceItems(Math.floor(Math.random() * 5) + 1);\n      const subtotal = items.reduce((sum, item) => sum + (item.unitPrice * item.quantity), 0);\n      const totalTax = items.reduce((sum, item) => sum + item.taxAmount, 0);\n      const totalAmount = subtotal + totalTax;\n\n      sampleInvoices.push({\n        id: `inv-${i.toString().padStart(3, '0')}`,\n        invoiceNumber: `2024-${i.toString().padStart(4, '0')}`,\n        customerId: `cust-${Math.floor(Math.random() * 100) + 1}`,\n        customerName: `Müşteri ${i}`,\n        patientName: `Hasta ${i}`,\n        customerTaxNumber: `${Math.floor(Math.random() * 9000000000) + 1000000000}`,\n        customerAddress: {\n          street: `Test Sokak No: ${i}`,\n          city: 'İstanbul',\n          postalCode: '34000',\n          country: 'Türkiye'\n        },\n        billingAddress: {\n          name: `Müşteri ${i}`,\n          address: `Fatura Sokak No: ${i}`,\n          city: 'İstanbul',\n          postalCode: '34000',\n          country: 'Türkiye',\n          taxNumber: `${Math.floor(Math.random() * 9000000000) + 1000000000}`\n        },\n        items,\n        subtotal,\n        taxes: [{\n          type: 'vat',\n          rate: 0.18,\n          amount: totalTax\n        }],\n        totalAmount,\n        status: statuses[Math.floor(Math.random() * statuses.length)],\n        type: types[Math.floor(Math.random() * types.length)],\n        paymentMethod: 'cash',\n        dueDate: dueDate.toISOString(),\n        createdAt: createdDate.toISOString(),\n        updatedAt: createdDate.toISOString(),\n        notes: `Örnek fatura ${i} notları`,\n        currency: 'TRY'\n      });\n    }\n\n    return sampleInvoices;\n  }\n\n  private generateInvoiceItems(count: number = 3): InvoiceItem[] {\n    const items: InvoiceItem[] = [];\n    const sampleProducts = [\n      { name: 'İşitme Cihazı Bakımı', price: 150 },\n      { name: 'Kulak Kalıbı', price: 200 },\n      { name: 'İşitme Testi', price: 100 },\n      { name: 'Cihaz Ayarı', price: 75 },\n      { name: 'Pil Değişimi', price: 25 }\n    ];\n\n    for (let i = 0; i < count; i++) {\n      const product = sampleProducts[i % sampleProducts.length];\n      const quantity = Math.floor(Math.random() * 3) + 1;\n      const unitPrice = product.price;\n      const taxRate = 0.18; // %18 KDV\n      const taxAmount = unitPrice * quantity * taxRate;\n      const totalPrice = (unitPrice * quantity) + taxAmount;\n\n      items.push({\n        id: `item-${Date.now()}-${i}`,\n        name: product.name,\n        description: product.name,\n        quantity,\n        unitPrice,\n        taxRate,\n        taxAmount,\n        totalPrice,\n        sgkCode: `SGK${1000 + i}`,\n        category: 'service'\n      });\n    }\n\n    return items;\n  }\n\n  // Initialize with sample data if empty\n  async initializeData(): Promise<void> {\n    const invoices = await this.loadInvoices();\n    if (invoices.length === 0) {\n      const sampleInvoices = this.generateSampleInvoices();\n      await this.saveInvoices(sampleInvoices);\n    }\n  }\n\n  // CRUD Operations\n  async createInvoice(invoiceData: CreateInvoiceData): Promise<Invoice> {\n    const invoices = await this.loadInvoices();\n    \n    // Calculate items with tax amounts and totals\n    const calculatedItems = invoiceData.items ? this.calculateInvoice(invoiceData.items).items : [];\n\n    const newInvoice: Invoice = {\n      id: `inv-${Date.now()}`,\n      invoiceNumber: invoiceData.invoiceNumber || `2024-${(invoices.length + 1).toString().padStart(4, '0')}`,\n      customerId: invoiceData.customerId,\n      customerName: invoiceData.customerName,\n      patientName: (invoiceData as any).patientName || invoiceData.customerName || '',\n      customerTaxNumber: invoiceData.customerTaxNumber,\n      customerAddress: invoiceData.customerAddress,\n      items: calculatedItems,\n      subtotal: invoiceData.subtotal,\n      taxes: invoiceData.taxes,\n      totalAmount: invoiceData.totalAmount,\n      status: invoiceData.status || 'draft',\n      type: invoiceData.type || 'standard',\n      paymentMethod: invoiceData.paymentMethod || 'cash',\n      dueDate: invoiceData.dueDate,\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      notes: invoiceData.notes,\n      attachments: invoiceData.attachments || [],\n      currency: 'TRY'\n    };\n\n    invoices.push(newInvoice);\n    await this.saveInvoices(invoices);\n\n    // Add to outbox for sync\n    await outbox.addOperation({\n      method: 'POST',\n      endpoint: '/api/invoices',\n      data: invoiceData,\n      priority: 'high'\n    });\n\n    return newInvoice;\n  }\n\n  async updateInvoice(id: string, updates: Partial<UpdateInvoiceData>): Promise<Invoice> {\n    const invoices = await this.loadInvoices();\n    const index = invoices.findIndex(inv => inv.id === id);\n    \n    if (index === -1) {\n      throw new Error('Fatura bulunamadı');\n    }\n\n    const existing = invoices[index];\n\n    // If items are provided in updates, recalculate complete item fields and totals\n    let items = existing.items;\n    let subtotal = existing.subtotal;\n    let taxes = existing.taxes;\n    let totalAmount = existing.totalAmount;\n\n    if (updates.items) {\n      const calc = this.calculateInvoice(updates.items as any);\n      items = calc.items as InvoiceItem[];\n      subtotal = calc.subtotal;\n      // Use calculated taxes if available, otherwise synthesize VAT entry from totalTax\n      taxes = calc.taxes && calc.taxes.length\n        ? calc.taxes\n        : [{ type: 'vat', rate: 0.18, amount: calc.totalTax }];\n      totalAmount = calc.grandTotal;\n    }\n\n    const updatedInvoice: Invoice = {\n      ...existing,\n      ...updates,\n      items,\n      subtotal,\n      taxes,\n      totalAmount,\n      updatedAt: new Date().toISOString()\n    };\n\n    invoices[index] = updatedInvoice;\n    await this.saveInvoices(invoices);\n\n    // Add to outbox for sync\n    await outbox.addOperation({\n      method: 'PUT',\n      endpoint: `/api/invoices/${id}`,\n      data: { id, ...updates },\n      priority: 'normal'\n    });\n\n    return updatedInvoice;\n  }\n\n  async deleteInvoice(id: string): Promise<void> {\n    const invoices = await this.loadInvoices();\n    const filteredInvoices = invoices.filter(inv => inv.id !== id);\n    \n    if (filteredInvoices.length === invoices.length) {\n      throw new Error('Fatura bulunamadı');\n    }\n\n    await this.saveInvoices(filteredInvoices);\n\n    // Add to outbox for sync\n    await outbox.addOperation({\n      method: 'DELETE',\n      endpoint: `/api/invoices/${id}`,\n      priority: 'normal'\n    });\n  }\n\n  async getInvoice(id: string): Promise<Invoice | null> {\n    const invoices = await this.loadInvoices();\n    return invoices.find(inv => inv.id === id) || null;\n  }\n\n  async getInvoices(filters?: InvoiceFilters): Promise<InvoiceSearchResult> {\n    let invoices = await this.loadInvoices();\n\n    // Apply filters\n    if (filters) {\n      if (filters.status && filters.status.length > 0) {\n        invoices = invoices.filter(inv => filters.status!.includes(inv.status));\n      }\n      if (filters.type && filters.type.length > 0) {\n        // cast inv.type to any to allow comparisons with legacy/other enums from filters\n        invoices = invoices.filter(inv => filters.type!.includes(inv.type as any));\n      }\n      if (filters.customerId) {\n        invoices = invoices.filter(inv => inv.customerId === filters.customerId);\n      }\n      if (filters.issueDateFrom) {\n        const from = new Date(filters.issueDateFrom!);\n        invoices = invoices.filter(inv => inv.createdAt ? new Date(inv.createdAt) >= from : false);\n      }\n      if (filters.issueDateTo) {\n        const to = new Date(filters.issueDateTo!);\n        invoices = invoices.filter(inv => inv.createdAt ? new Date(inv.createdAt) <= to : false);\n      }\n      if (filters.search) {\n        const searchLower = filters.search.toLowerCase();\n        invoices = invoices.filter(inv => \n          inv.invoiceNumber.toLowerCase().includes(searchLower) ||\n          (inv.customerName && inv.customerName.toLowerCase().includes(searchLower)) ||\n          (inv.customerTaxNumber && inv.customerTaxNumber.includes(searchLower))\n        );\n      }\n    }\n\n    // Apply pagination\n    const page = filters?.page || 1;\n    const limit = filters?.limit || 10;\n    const startIndex = (page - 1) * limit;\n    const endIndex = startIndex + limit;\n    const paginatedInvoices = invoices.slice(startIndex, endIndex);\n\n    return {\n      invoices: paginatedInvoices,\n      total: invoices.length,\n      page,\n      limit,\n      totalPages: Math.ceil(invoices.length / limit),\n      hasMore: (page * limit) < invoices.length,\n      filters: filters || {}\n    };\n  }\n\n  async getInvoiceStats(): Promise<InvoiceStats> {\n    const invoices = await this.loadInvoices();\n    \n    const stats: InvoiceStats = {\n      total: invoices.length,\n      draft: invoices.filter(inv => inv.status === 'draft').length,\n      sent: invoices.filter(inv => inv.status === 'sent').length,\n      paid: invoices.filter(inv => inv.status === 'paid').length,\n      overdue: invoices.filter(inv => inv.status === 'overdue').length,\n      cancelled: invoices.filter(inv => inv.status === 'cancelled').length,\n      totalAmount: invoices.reduce((sum, inv) => sum + (inv.totalAmount || 0), 0),\n      paidAmount: invoices\n        .filter(inv => inv.status === 'paid')\n        .reduce((sum, inv) => sum + (inv.totalAmount || 0), 0),\n      pendingAmount: invoices\n        .filter(inv => ['sent', 'overdue'].includes(inv.status))\n        .reduce((sum, inv) => sum + (inv.totalAmount || 0), 0)\n    };\n\n    return stats;\n  }\n\n  // Invoice Actions\n  async sendInvoice(id: string): Promise<Invoice> {\n    const invoice = await this.getInvoice(id);\n    if (!invoice) {\n      throw new Error('Fatura bulunamadı');\n    }\n\n    if (invoice.status === 'sent') {\n      throw new Error('Fatura zaten gönderilmiş');\n    }\n\n    return this.updateInvoice(id, {\n      id,\n      status: 'sent' as InvoiceStatus,\n      gibSentDate: new Date().toISOString()\n    });\n  }\n\n  async cancelInvoice(id: string, reason?: string): Promise<Invoice> {\n    const invoice = await this.getInvoice(id);\n    if (!invoice) {\n      throw new Error('Fatura bulunamadı');\n    }\n\n    if (invoice.status === 'cancelled') {\n      throw new Error('Fatura zaten iptal edilmiş');\n    }\n\n    return this.updateInvoice(id, {\n      id,\n      status: 'cancelled' as InvoiceStatus,\n      notes: reason ? `${invoice.notes || ''}\\nİptal nedeni: ${reason}` : invoice.notes\n    });\n  }\n\n  async markAsPaid(id: string, paymentMethod?: PaymentMethod): Promise<Invoice> {\n    return this.updateInvoice(id, {\n      id,\n      status: 'paid' as InvoiceStatus,\n      paymentDate: new Date().toISOString(),\n      paymentMethod\n    });\n  }\n\n  // E-Fatura Operations\n  async submitEFatura(submission: EFaturaSubmission): Promise<{ success: boolean; ettn?: string; error?: string }> {\n    try {\n      // Update invoice with GIB status\n      await this.updateInvoice(submission.invoiceId, {\n        id: submission.invoiceId,\n        status: 'sent' as InvoiceStatus,\n        ettn: submission.ettn,\n        gibSentDate: new Date().toISOString()\n      });\n\n      // Add to outbox for sync\n      await outbox.addOperation({\n        method: 'POST',\n        endpoint: '/api/invoices/efatura/submit',\n        data: submission,\n        priority: 'high'\n      });\n\n      return { success: true, ettn: submission.ettn };\n    } catch (error) {\n      return { success: false, error: error instanceof Error ? error.message : 'Bilinmeyen hata' };\n    }\n  }\n\n  async submitBulkEFatura(submission: EFaturaBulkSubmission): Promise<{ success: boolean; results?: any[]; error?: string }> {\n    try {\n      const results: Array<{ invoiceId: string; success: boolean; ettn?: string; error?: string }> = [];\n      \n      for (const invoiceId of submission.invoiceIds) {\n        const result = await this.submitEFatura({\n          invoiceId,\n          ettn: `ETTN-${Date.now()}-${invoiceId}`,\n          submissionDate: submission.submissionDate,\n          status: 'pending'\n        });\n        results.push({ invoiceId, ...result });\n      }\n\n      return { success: true, results };\n    } catch (error) {\n      return { success: false, error: error instanceof Error ? error.message : 'Toplu gönderim hatası' };\n    }\n  }\n\n  // Template Operations\n  async getTemplates(): Promise<InvoiceTemplate[]> {\n    // Mock templates for now\n    return [\n      {\n        id: 'template-1',\n        name: 'Standart Fatura',\n        type: 'sale' as InvoiceType,\n        description: 'Genel kullanım için standart fatura şablonu',\n        category: 'general',\n        isDefault: true,\n        fields: ['customerName', 'items', 'totalAmount'],\n        templateData: {},\n        items: [],\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString(),\n        createdBy: 'system'\n      },\n      {\n        id: 'template-2',\n        name: 'Proforma Fatura',\n        type: 'proforma' as InvoiceType,\n        description: 'Proforma fatura şablonu',\n        category: 'proforma',\n        isDefault: false,\n        fields: ['customerName', 'items', 'totalAmount', 'validUntil'],\n        templateData: {},\n        items: [],\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString(),\n        createdBy: 'system'\n      }\n    ];\n  }\n\n  // Calculation Helpers\n  calculateInvoice(items: Omit<InvoiceItem, 'id' | 'taxAmount' | 'totalPrice'>[]): InvoiceCalculation {\n    let subtotal = 0;\n    let totalTax = 0;\n    \n    const calculatedItems = items.map(item => {\n      const lineTotal = item.quantity * item.unitPrice;\n      const taxAmount = lineTotal * (item.taxRate || 0);\n      const totalPrice = lineTotal + taxAmount;\n      \n      subtotal += lineTotal;\n      totalTax += taxAmount;\n      \n      return {\n        ...item,\n        id: `temp-${Date.now()}-${Math.random()}`,\n        taxAmount,\n        totalPrice\n      };\n    });\n\n    return {\n      items: calculatedItems,\n      subtotal,\n      totalTax,\n      totalDiscount: 0,\n      grandTotal: subtotal + totalTax,\n      taxes: []\n    };\n  }\n\n  // Validation\n  validateInvoice(invoice: Partial<CreateInvoiceData>): InvoiceValidation {\n    const errors: Record<string, string> = {};\n    const warnings: Record<string, string> = {};\n    let errorIndex = 0;\n    let warningIndex = 0;\n\n    if (!invoice.customerName?.trim()) {\n      errors[`error_${errorIndex++}`] = 'Müşteri adı gereklidir';\n    }\n\n    if (!invoice.items || invoice.items.length === 0) {\n      errors[`error_${errorIndex++}`] = 'En az bir kalem gereklidir';\n    }\n\n    if (invoice.items) {\n      invoice.items.forEach((item, index) => {\n        if (!item.description?.trim()) {\n          errors[`error_${errorIndex++}`] = `${index + 1}. kalem açıklaması gereklidir`;\n        }\n        if (!item.quantity || item.quantity <= 0) {\n          errors[`error_${errorIndex++}`] = `${index + 1}. kalem miktarı geçerli olmalıdır`;\n        }\n        if (!item.unitPrice || item.unitPrice <= 0) {\n          errors[`error_${errorIndex++}`] = `${index + 1}. kalem birim fiyatı geçerli olmalıdır`;\n        }\n      });\n    }\n\n    if (!invoice.dueDate) {\n      warnings[`warning_${warningIndex++}`] = 'Vade tarihi belirtilmemiş';\n    } else if (new Date(invoice.dueDate) < new Date()) {\n      warnings[`warning_${warningIndex++}`] = 'Vade tarihi geçmişte';\n    }\n\n    return {\n      isValid: Object.keys(errors).length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  // Payment Operations\n  async addPayment(invoiceId: string, payment: Omit<InvoicePayment, 'id' | 'createdAt'>): Promise<InvoicePayment> {\n    const newPayment: InvoicePayment = {\n      ...payment,\n      id: `payment-${Date.now()}`,\n      createdAt: new Date().toISOString()\n    };\n\n    // In a real app, this would be stored separately\n    // For now, we'll just return the payment object\n    return newPayment;\n  }\n\n  async createPaymentPlan(invoiceId: string, plan: Omit<InvoicePaymentPlan, 'id' | 'createdAt'>): Promise<InvoicePaymentPlan> {\n    const newPlan: InvoicePaymentPlan = {\n      ...plan,\n      id: `plan-${Date.now()}`,\n      createdAt: new Date().toISOString()\n    };\n\n    return newPlan;\n  }\n\n  // Export Operations\n  async exportInvoices(options: InvoiceExportOptions): Promise<{ success: boolean; data?: any; error?: string }> {\n    try {\n      const result = await this.getInvoices(options.filters);\n      \n      // Mock export logic\n      const exportData = {\n        invoices: result.invoices,\n        format: options.format,\n        exportedAt: new Date().toISOString(),\n        total: result.total\n      };\n\n      return { success: true, data: exportData };\n    } catch (error) {\n      return { success: false, error: error instanceof Error ? error.message : 'Dışa aktarım hatası' };\n    }\n  }\n\n  /**\n   * Generate PDF for an invoice\n   */\n  async generateInvoicePdf(invoiceId: string): Promise<{ success: boolean; data?: Blob; error?: string }> {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.invoicesGenerateInvoicePdf(invoiceId);\n      \n      return {\n        success: true,\n        data: response.data\n      };\n    } catch (error) {\n      console.error('Error generating invoice PDF:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'PDF oluşturulurken bir hata oluştu'\n      };\n    }\n  }\n\n  /**\n   * Generate PDF for a sale invoice\n   */\n  async generateSaleInvoicePdf(saleId: string): Promise<{ success: boolean; data?: Blob; error?: string }> {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.salesGenerateSaleInvoicePdf(saleId);\n      \n      return {\n        success: true,\n        data: response.data\n      };\n    } catch (error) {\n      console.error('Error generating sale invoice PDF:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Satış faturası PDF\\'i oluşturulurken bir hata oluştu'\n      };\n    }\n  }\n\n  /**\n   * Download PDF as file\n   */\n  downloadPdfBlob(blob: Blob, filename: string): void {\n    const url = window.URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    window.URL.revokeObjectURL(url);\n  }\n\n  /**\n   * Open PDF in new tab for preview\n   */\n  previewPdfBlob(blob: Blob): void {\n    const url = window.URL.createObjectURL(blob);\n    window.open(url, '_blank');\n  }\n}\n\nexport const invoiceService = new InvoiceService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/offline/patientOfflineSync.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'syncStatus' is assigned a value but never used.","line":149,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":149,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'syncStatus' is assigned a value but never used.","line":158,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":158,"endColumn":25},{"ruleId":"prefer-const","severity":2,"message":"'patients' is never reassigned. Use 'const' instead.","line":234,"column":11,"nodeType":"Identifier","messageId":"useConst","endLine":234,"endColumn":30,"fix":{"range":[7144,7173],"text":"const patients: Patient[] = [];"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":302,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":302,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10039,10042],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10039,10042],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":305,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10209,10212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10209,10212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":315,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":315,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10587,10590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10587,10590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Patient Offline Sync Service\n * Handles offline patient operations with IndexedDB and outbox pattern\n */\n\nimport { openDB, IDBPDatabase, DBSchema } from 'idb';\nimport type { Patient } from '../../types/patient';\nimport { outbox } from '../../utils/outbox';\n\ninterface PatientDB extends DBSchema {\n  patients: {\n    key: string;\n    value: Patient & { syncStatus: 'synced' | 'pending' | 'failed' };\n    indexes: {\n      'by-sync-status': string;\n      'by-updated-at': string;\n      'by-name': string;\n      'by-phone': string;\n    };\n  };\n  syncMetadata: {\n    key: string;\n    value: {\n      id: string;\n      lastSync: string;\n      totalPatients: number;\n      pendingOperations: number;\n    };\n  };\n}\n\nexport class PatientOfflineSync {\n  private db: IDBPDatabase<PatientDB> | null = null;\n  private readonly dbName = 'PatientDB';\n  private readonly dbVersion = 1;\n  private syncInProgress = false;\n  private listeners: Set<() => void> = new Set();\n\n  async initialize(): Promise<void> {\n    try {\n      this.db = await openDB<PatientDB>(this.dbName, this.dbVersion, {\n        upgrade(db) {\n          // Patients store\n          if (!db.objectStoreNames.contains('patients')) {\n            const patientsStore = db.createObjectStore('patients', { keyPath: 'id' });\n            patientsStore.createIndex('by-sync-status', 'syncStatus');\n            patientsStore.createIndex('by-updated-at', 'updatedAt');\n            patientsStore.createIndex('by-name', 'name');\n            patientsStore.createIndex('by-phone', 'phone');\n          }\n\n          // Sync metadata store\n          if (!db.objectStoreNames.contains('syncMetadata')) {\n            db.createObjectStore('syncMetadata', { keyPath: 'id' });\n          }\n        },\n      });\n\n      // Setup online/offline listeners\n      window.addEventListener('online', () => this.handleOnline());\n      window.addEventListener('offline', () => this.handleOffline());\n\n      console.log('Patient offline sync initialized');\n    } catch (error) {\n      console.error('Failed to initialize patient offline sync:', error);\n      throw error;\n    }\n  }\n\n  // Patient CRUD operations\n  async savePatient(patient: Omit<Patient, 'id'> & { id?: string }): Promise<Patient> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const patientId = patient.id || `patient_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const patientWithSync: Patient & { syncStatus: 'synced' | 'pending' | 'failed' } = {\n      ...patient,\n      id: patientId,\n      syncStatus: 'pending',\n      updatedAt: new Date().toISOString()\n    };\n\n    await this.db.put('patients', patientWithSync);\n\n    // Add to outbox for sync\n    await outbox.addOperation({\n      method: 'POST',\n      endpoint: '/api/patients',\n      data: patient,\n      headers: {\n        'Idempotency-Key': `patient_create_${patientId}`\n      }\n    });\n\n    this.notifyListeners();\n    return patientWithSync;\n  }\n\n  async updatePatient(id: string, updates: Partial<Patient>): Promise<void> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const existing = await this.db.get('patients', id);\n    if (!existing) throw new Error('Patient not found');\n\n    const updated = {\n      ...existing,\n      ...updates,\n      syncStatus: 'pending' as const,\n      updatedAt: new Date().toISOString()\n    };\n\n    await this.db.put('patients', updated);\n\n    // Add to outbox for sync\n    await outbox.addOperation({\n      method: 'PUT',\n      endpoint: `/api/patients/${id}`,\n      data: updates,\n      headers: {\n        'Idempotency-Key': `patient_update_${id}_${Date.now()}`\n      }\n    });\n\n    this.notifyListeners();\n  }\n\n  async deletePatient(id: string): Promise<void> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    await this.db.delete('patients', id);\n\n    // Add to outbox for sync\n    await outbox.addOperation({\n      method: 'DELETE',\n      endpoint: `/api/patients/${id}`,\n      headers: {\n        'Idempotency-Key': `patient_delete_${id}_${Date.now()}`\n      }\n    });\n\n    this.notifyListeners();\n  }\n\n  async getPatient(id: string): Promise<Patient | null> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const patient = await this.db.get('patients', id);\n    if (!patient) return null;\n    \n    const { syncStatus, ...patientData } = patient;\n    return patientData;\n  }\n\n  async getAllPatients(): Promise<Patient[]> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const patients = await this.db.getAll('patients');\n    return patients.map(p => {\n      const { syncStatus, ...patient } = p;\n      return patient;\n    });\n  }\n\n  async searchPatients(query: string): Promise<Patient[]> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const allPatients = await this.db.getAll('patients');\n    const searchTerm = query.toLowerCase();\n\n    return allPatients\n      .filter(patient => {\n        const patientName = patient.firstName && patient.lastName ? `${patient.firstName} ${patient.lastName}` : '';\n        return patientName.toLowerCase().includes(searchTerm) ||\n               patient.phone?.includes(searchTerm) ||\n               patient.email?.toLowerCase().includes(searchTerm);\n      })\n      .map(p => ({ ...p, syncStatus: undefined }));\n  }\n\n  async getPendingPatients(): Promise<(Patient & { syncStatus: string })[]> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    return await this.db.getAllFromIndex('patients', 'by-sync-status', 'pending');\n  }\n\n  // Sync operations\n  async syncWithServer(): Promise<void> {\n    if (!navigator.onLine || this.syncInProgress) return;\n\n    this.syncInProgress = true;\n    this.notifyListeners();\n\n    try {\n      // First, sync pending operations via outbox\n      await this.syncPendingOperations();\n\n      // Then, fetch latest data from server\n      await this.fetchLatestPatients();\n\n      // Update sync metadata\n      await this.updateSyncMetadata();\n\n      console.log('Patient sync completed successfully');\n    } catch (error) {\n      console.error('Patient sync failed:', error);\n      throw error;\n    } finally {\n      this.syncInProgress = false;\n      this.notifyListeners();\n    }\n  }\n\n  private async syncPendingOperations(): Promise<void> {\n    // The outbox will handle the actual sync operations\n    // We just need to update local sync status based on outbox results\n    const pendingPatients = await this.getPendingPatients();\n    \n    for (const patient of pendingPatients) {\n      // Check if the operation was successfully synced by checking outbox\n      // This is a simplified approach - in a real implementation,\n      // you'd want to correlate outbox operations with local records\n      const updatedPatient = { ...patient, syncStatus: 'synced' as const };\n      await this.db!.put('patients', updatedPatient);\n    }\n  }\n\n  private async fetchLatestPatients(): Promise<void> {\n    try {\n      // Check if there are active API calls to prevent conflicts\n      if (this.hasActiveApiCalls()) {\n        console.log('Patient sync: Skipping background sync due to active API calls');\n        return;\n      }\n\n      let patients: Patient[] = [];\n      let cursor: string | null = null;\n      let hasMore = true;\n      let requestCount = 0;\n      const maxRequests = 5; // Further reduced to prevent resource exhaustion\n\n      while (hasMore && requestCount < maxRequests) {\n        // Use even smaller page size for background sync\n        const url = cursor ? `/api/patients?per_page=10&cursor=${cursor}` : '/api/patients?per_page=10';\n        \n        // Add longer delay between requests to prevent resource exhaustion\n        if (requestCount > 0) {\n          await new Promise(resolve => setTimeout(resolve, 1000)); // Increased to 1000ms delay\n        }\n        \n        try {\n          const response = await fetch(url);\n          if (!response.ok) {\n            console.warn(`Background sync request failed: ${response.status}`);\n            break; // Stop on error instead of throwing\n          }\n\n          const data = await response.json();\n          patients.push(...(data.data || []));\n          cursor = data.meta?.nextCursor;\n          hasMore = !!cursor;\n          requestCount++;\n\n          // Log progress for debugging\n          console.log(`Background sync: fetched ${data.data?.length || 0} patients (batch ${requestCount})`);\n        } catch (fetchError) {\n          console.warn('Background sync fetch error:', fetchError);\n          break; // Stop on network error\n        }\n      }\n\n      // Update local database with server data (only if we got some data)\n      if (patients.length > 0) {\n        for (const serverPatient of patients) {\n          if (!serverPatient.id) continue; // Skip patients without ID\n          \n          const localPatient = await this.db!.get('patients', serverPatient.id);\n          \n          // Only update if server version is newer or local doesn't exist\n          if (!localPatient || (serverPatient.updatedAt && localPatient.updatedAt && new Date(serverPatient.updatedAt) > new Date(localPatient.updatedAt))) {\n            await this.db!.put('patients', {\n              ...serverPatient,\n              syncStatus: 'synced'\n            });\n          }\n        }\n        console.log(`Background sync: updated ${patients.length} patients in local DB`);\n      }\n\n      // If we hit the request limit, schedule another sync for much later\n      if (hasMore && requestCount >= maxRequests) {\n        console.log('Patient sync: Partial sync completed, scheduling continuation in 2 minutes');\n        setTimeout(() => this.syncWithServer(), 120000); // Continue in 2 minutes instead of 30 seconds\n      }\n    } catch (error) {\n      console.warn('Failed to fetch latest patients:', error);\n      // Don't throw - offline mode should still work\n    }\n  }\n\n  // Check if there are active API calls that might conflict with background sync\n  private hasActiveApiCalls(): boolean {\n    // Check for active React Query requests\n    const queryClient = (window as any).__REACT_QUERY_CLIENT__;\n    if (queryClient) {\n      const queries = queryClient.getQueryCache().getAll();\n      const activePatientQueries = queries.filter((query: any) => \n        query.queryKey?.[0] === 'patients' && query.state.fetchStatus === 'fetching'\n      );\n      if (activePatientQueries.length > 0) {\n        return true;\n      }\n    }\n\n    // Check for ongoing fetch requests (basic heuristic)\n    const performanceEntries = performance.getEntriesByType('navigation');\n    const recentRequests = performanceEntries.filter((entry: any) => \n      entry.name?.includes('/api/patients') && \n      (Date.now() - entry.startTime) < 5000 // Within last 5 seconds\n    );\n    \n    return recentRequests.length > 0;\n  }\n\n  private async updateSyncMetadata(): Promise<void> {\n    if (!this.db) return;\n\n    const totalPatients = await this.db.count('patients');\n    const pendingOperations = (await outbox.getStats()).pending;\n\n    await this.db.put('syncMetadata', {\n      id: 'main',\n      lastSync: new Date().toISOString(),\n      totalPatients,\n      pendingOperations\n    });\n  }\n\n  // Event handlers\n  private async handleOnline(): Promise<void> {\n    console.log('Patient sync: Going online, starting sync...');\n    try {\n      await this.syncWithServer();\n    } catch (error) {\n      console.error('Auto-sync on online failed:', error);\n    }\n  }\n\n  private handleOffline(): void {\n    console.log('Patient sync: Going offline, operations will be queued');\n    this.notifyListeners();\n  }\n\n  // Listener management\n  addListener(listener: () => void): void {\n    this.listeners.add(listener);\n  }\n\n  removeListener(listener: () => void): void {\n    this.listeners.delete(listener);\n  }\n\n  private notifyListeners(): void {\n    this.listeners.forEach(listener => {\n      try {\n        listener();\n      } catch (error) {\n        console.error('Error in sync listener:', error);\n      }\n    });\n  }\n\n  // Status getters\n  get isOnline(): boolean {\n    return navigator.onLine;\n  }\n\n  get isSyncing(): boolean {\n    return this.syncInProgress;\n  }\n\n  async getSyncStatus(): Promise<{\n    isOnline: boolean;\n    isSyncing: boolean;\n    lastSync: string | null;\n    pendingOperations: number;\n    totalPatients: number;\n  }> {\n    if (!this.db) throw new Error('Database not initialized');\n\n    const metadata = await this.db.get('syncMetadata', 'main');\n    const stats = await outbox.getStats();\n\n    return {\n      isOnline: this.isOnline,\n      isSyncing: this.isSyncing,\n      lastSync: metadata?.lastSync || null,\n      pendingOperations: stats.pending,\n      totalPatients: metadata?.totalPatients || 0\n    };\n  }\n\n  // Cleanup\n  async destroy(): Promise<void> {\n    this.listeners.clear();\n    window.removeEventListener('online', this.handleOnline);\n    window.removeEventListener('offline', this.handleOffline);\n    \n    if (this.db) {\n      this.db.close();\n      this.db = null;\n    }\n  }\n}\n\n// Create and export singleton instance\nexport const patientOfflineSync = new PatientOfflineSync();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'OrvalPatient' is defined but never used.","line":13,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PaginationInfo' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":17},{"ruleId":"no-restricted-imports","severity":2,"message":"'axios' import is restricted from being used. Use generated API client from @x-ear/core instead of direct axios calls.","line":21,"column":1,"nodeType":"ImportDeclaration","messageId":"pathWithCustomMessage","endLine":21,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CorePatientService' is defined but never used.","line":22,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'convertOrvalToLegacyPatient' is defined but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":37},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2686,2689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2686,2689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'no-await-in-loop').","line":92,"column":9,"severity":2,"nodeType":null,"fix":{"range":[2798,2842],"text":" "}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":94,"column":109,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":112,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3001,3004],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3001,3004],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":118,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3758,3761],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3758,3761],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"no-constant-condition","severity":2,"message":"Unexpected constant condition.","line":85,"column":14,"nodeType":"Literal","messageId":"unexpected","endLine":85,"endColumn":18,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { \n  PatientFilters, \n  PatientSearchResult, \n  PatientStats, \n  PatientDevice, \n  PatientNote,\n  PatientMatchCandidate,\n  PatientMatchRequest,\n  Communication,\n  Patient\n} from '../types/patient';\nimport { \n  Patient as OrvalPatient,\n  PaginationInfo,\n  PatientsGetPatients200\n} from \"../api/generated/xEarCRMAPIAutoGenerated.schemas\";\nimport { getXEarCRMAPIAutoGenerated } from \"../api/generated/xEarCRMAPIAutoGenerated\";\nimport { outbox } from '../utils/outbox';\nimport { PATIENTS_DATA } from '../constants/storage-keys';\nimport { indexedDBManager } from '../utils/indexeddb';\nimport { AxiosResponse } from 'axios';\nimport { PatientService as CorePatientService } from '@x-ear/core';\nimport { convertOrvalToLegacyPatient } from '../types/patient/patient-adapter';\n\nexport class PatientService {\n  private patients: Patient[] = [];\n  private initialized = false;\n\n  constructor() {\n    this.init();\n  }\n\n  private async init(): Promise<void> {\n    if (this.initialized) return;\n    \n    // Initialize IndexedDB\n    await indexedDBManager.init();\n    \n    await this.loadPatients();\n    this.initialized = true;\n    \n    // Listen for storage changes (localStorage fallback only)\n    window.addEventListener('storage', this.handleStorageChange.bind(this));\n  }\n\n  private handleStorageChange(event: StorageEvent): void {\n    if (event.key === PATIENTS_DATA) {\n      this.loadPatients();\n    }\n  }\n\n  // Data persistence\n  private async loadPatients(): Promise<void> {\n    // First try to load from IndexedDB cache\n    try {\n      const cachedPatients = await indexedDBManager.getPatients();\n      if (cachedPatients.length > 0) {\n        this.patients = cachedPatients;\n        console.log(`📦 Loaded ${cachedPatients.length} patients from IndexedDB cache`);\n        \n        // Optionally refresh from API in background\n        this.refreshFromAPI().catch(error => \n          console.warn('Background API refresh failed:', error)\n        );\n        return;\n      }\n    } catch (error) {\n      console.warn('Failed to load from IndexedDB, trying API:', error);\n    }\n\n    // If no cache, load from API\n    await this.refreshFromAPI();\n  }\n\n  private async refreshFromAPI(): Promise<void> {\n    // Try to page through backend API and aggregate patients into IndexedDB cache.\n    // If anything fails, fall back to localStorage.\n    try {\n      const aggregated: Patient[] = [];\n      let cursor: string | undefined;\n      const perPage = 100;\n\n      // Use cursor-based pagination for better performance with large datasets\n      // eslint-disable-next-line no-constant-condition\n      while (true) {\n        // Call generated API client with proper typing\n        const params: any = { per_page: perPage };\n        if (cursor) {\n          params.cursor = cursor;\n        }\n        \n        // eslint-disable-next-line no-await-in-loop\n        const api = getXEarCRMAPIAutoGenerated();\n        const resp: AxiosResponse<PatientsGetPatients200> = await api.patientsGetPatients(params).catch((e: any) => { throw e; });\n        const payload = resp?.data;\n        if (!payload || !Array.isArray(payload.data)) break;\n\n        const chunk = payload.data;\n        aggregated.push(...chunk);\n\n        // Check if there are more pages using cursor-based pagination\n        const pagination = payload.pagination;\n        if (!pagination?.hasNext || !pagination?.nextCursor) {\n          break;\n        }\n        \n        cursor = pagination.nextCursor;\n        \n        // Safety check to prevent infinite loops\n        if (chunk.length === 0) break;\n      }\n\n      if (aggregated.length > 0) {\n        // Use Patient directly\n        this.patients = aggregated;\n        \n        // Cache in IndexedDB\n        await indexedDBManager.savePatients(aggregated as any);\n        console.log(`🔄 Refreshed ${aggregated.length} patients from API and cached in IndexedDB`);\n      }\n    } catch (error) {\n      console.warn('API refresh failed, trying localStorage fallback:', error);\n      \n      // Fallback to localStorage\n      try {\n        const stored = localStorage.getItem(PATIENTS_DATA);\n        if (stored) {\n          const parsed = JSON.parse(stored);\n          this.patients = Array.isArray(parsed) ? parsed : [];\n          console.log(`📦 Loaded ${this.patients.length} patients from localStorage fallback`);\n        }\n      } catch (fallbackError) {\n        console.error('Both API and localStorage failed:', fallbackError);\n        this.patients = [];\n      }\n    }\n  }\n\n  private async savePatients(): Promise<void> {\n    try {\n      // Save to IndexedDB as primary cache\n      await indexedDBManager.savePatients(this.patients);\n\n      // Keep a small fallback in localStorage (just metadata, not full data)\n      const metadata = {\n        count: this.patients.length,\n        lastUpdated: new Date().toISOString(),\n        version: 1\n      };\n      await indexedDBManager.saveFallbackToLocalStorage(PATIENTS_DATA + '_meta', metadata);\n\n      // Dispatch event for other components\n      window.dispatchEvent(new CustomEvent('patients:updated', {\n        detail: { patients: this.patients }\n      }));\n    } catch (error) {\n      console.error('Failed to save patients to IndexedDB:', error);\n      \n      // Emergency fallback to localStorage (should be avoided)\n      try {\n        await indexedDBManager.saveFallbackToLocalStorage(PATIENTS_DATA, this.patients);\n        console.warn('Used localStorage emergency fallback for patient data');\n      } catch (fallbackError) {\n        console.error('Failed to save patients even to localStorage fallback:', fallbackError);\n      }\n    }\n  }\n\n  // CRUD Operations\n  async createPatient(patientData: Omit<Patient, 'id' | 'createdAt' | 'updatedAt'>): Promise<Patient> {\n    try {\n      await this.init();\n\n      // Validate required fields\n      if (!patientData.tcNumber?.trim()) {\n        throw new Error('TC number is required');\n      }\n      if (!patientData.firstName?.trim()) {\n        throw new Error('First name is required');\n      }\n      if (!patientData.lastName?.trim()) {\n        throw new Error('Last name is required');\n      }\n      if (!patientData.phone?.trim()) {\n        throw new Error('Patient phone is required');\n      }\n\n      // Validate TC number if provided\n      if (patientData.tcNumber) {\n        const isValidTc = await this.validateTcNumber(patientData.tcNumber);\n        if (!isValidTc) {\n          throw new Error('TC number already exists');\n        }\n      }\n\n      // Build patient object\n      const patient: Patient = {\n        id: this.generateId(),\n        ...patientData,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n      };\n\n      this.patients.push(patient);\n      this.savePatients();\n\n      // Queue for sync\n      try {\n        await outbox.addOperation({\n          method: 'POST',\n          endpoint: '/api/patients',\n          data: patient,\n          priority: 'high'\n        });\n      } catch (error) {\n        console.warn('Failed to queue patient creation for sync:', error);\n      }\n\n      // Dispatch events\n      window.dispatchEvent(new CustomEvent('patient:created', {\n        detail: { patient }\n      }));\n\n      return patient;\n    } catch (error) {\n      console.error('Failed to create patient:', error);\n      throw error instanceof Error ? error : new Error('Failed to create patient');\n    }\n  }\n\n  async updatePatient(id: string, updates: Partial<Patient>): Promise<Patient | null> {\n    try {\n      await this.init();\n\n      if (!id?.trim()) {\n        throw new Error('Patient ID is required');\n      }\n\n      const index = this.patients.findIndex(p => p.id === id);\n      if (index === -1) {\n        throw new Error('Patient not found');\n      }\n\n      // Validate TC number if being updated\n      if (updates.tcNumber && updates.tcNumber !== this.patients[index].tcNumber) {\n        const isValidTc = await this.validateTcNumber(updates.tcNumber, id);\n        if (!isValidTc) {\n          throw new Error('TC number already exists');\n        }\n      }\n\n      const oldPatient = { ...this.patients[index] };\n      const updatedPatient: Patient = {\n        ...this.patients[index],\n        ...updates,\n        id, // Ensure ID doesn't change\n        updatedAt: new Date().toISOString()\n      };\n\n      this.patients[index] = updatedPatient;\n      this.savePatients();\n\n      // Queue for sync with If-Match header for optimistic locking\n      try {\n        await outbox.addOperation({\n          method: 'PUT',\n          endpoint: `/api/patients/${id}`,\n          data: updates,\n          headers: {\n            'If-Match': oldPatient.updatedAt || new Date().toISOString()\n          },\n          priority: 'high'\n        });\n      } catch (error) {\n        console.warn('Failed to queue patient update for sync:', error);\n      }\n\n      // Dispatch events\n      window.dispatchEvent(new CustomEvent('patient:updated', {\n        detail: { patient: updatedPatient, oldPatient, changes: updates }\n      }));\n\n      return updatedPatient;\n    } catch (error) {\n      console.error('Failed to update patient:', error);\n      throw error instanceof Error ? error : new Error('Failed to update patient');\n    }\n  }\n\n  async deletePatient(id: string): Promise<boolean> {\n    try {\n      await this.init();\n\n      if (!id?.trim()) {\n        throw new Error('Patient ID is required');\n      }\n\n      const index = this.patients.findIndex(p => p.id === id);\n      if (index === -1) {\n        throw new Error('Patient not found');\n      }\n\n      const patient = this.patients[index];\n      this.patients.splice(index, 1);\n      this.savePatients();\n\n      // Queue for sync\n      try {\n        await outbox.addOperation({\n          method: 'DELETE',\n          endpoint: `/api/patients/${id}`,\n          priority: 'normal'\n        });\n      } catch (error) {\n        console.warn('Failed to queue patient deletion for sync:', error);\n      }\n\n      // Dispatch events\n      window.dispatchEvent(new CustomEvent('patient:deleted', {\n        detail: { patient }\n      }));\n\n      return true;\n    } catch (error) {\n      console.error('Failed to delete patient:', error);\n      throw error instanceof Error ? error : new Error('Failed to delete patient');\n    }\n  }\n\n  // Query operations\n  async getPatient(id: string): Promise<Patient | null> {\n    try {\n      await this.init();\n      \n      if (!id?.trim()) {\n        return null;\n      }\n      \n      return this.patients.find(p => p.id === id) || null;\n    } catch (error) {\n      console.error('Failed to get patient:', error);\n      return null;\n    }\n  }\n\n  async getPatients(filters: PatientFilters = {}): Promise<PatientSearchResult> {\n    try {\n      await this.init();\n\n      let filteredPatients = [...this.patients];\n\n      // Apply filters with error handling\n      if (filters.search?.trim()) {\n        const searchLower = filters.search.toLowerCase();\n        filteredPatients = filteredPatients.filter(p =>\n          (p.firstName && p.firstName.toLowerCase().includes(searchLower)) ||\n          (p.lastName && p.lastName.toLowerCase().includes(searchLower)) ||\n          p.phone.includes(filters.search!) ||\n          (p.tcNumber && p.tcNumber.includes(filters.search!)) ||\n          (p.email && p.email && p.email.toLowerCase().includes(searchLower))\n        );\n      }\n\n      if (filters.status) {\n        filteredPatients = filteredPatients.filter(p => p.status === filters.status);\n      }\n\n      if (filters.segment) {\n        filteredPatients = filteredPatients.filter(p => p.segment === filters.segment);\n      }\n\n      if (filters.acquisitionType) {\n        filteredPatients = filteredPatients.filter(p => p.acquisitionType === filters.acquisitionType);\n      }\n\n      if (filters.tags && filters.tags.length > 0) {\n        filteredPatients = filteredPatients.filter(p =>\n          p.tags && filters.tags!.some(tag => p.tags!.includes(tag))\n        );\n      }\n\n      if (filters.dateRange) {\n        try {\n          const start = new Date(filters.dateRange.start);\n          const end = new Date(filters.dateRange.end);\n          filteredPatients = filteredPatients.filter(p => {\n            const created = p.createdAt ? new Date(p.createdAt) : new Date(0);\n            return created >= start && created <= end;\n          });\n        } catch (error) {\n          console.warn('Invalid date range filter:', error);\n        }\n      }\n\n      // Sort by creation date (newest first)\n      filteredPatients.sort((a, b) => {\n        const dateA = new Date(a.createdAt || 0).getTime();\n        const dateB = new Date(b.createdAt || 0).getTime();\n        return dateB - dateA;\n      });\n\n      // Apply pagination\n      const page = filters.page || 1;\n      const pageSize = filters.limit || 20;\n      const startIndex = (page - 1) * pageSize;\n      const endIndex = startIndex + pageSize;\n      const paginatedPatients = filteredPatients.slice(startIndex, endIndex);\n      const hasMore = endIndex < filteredPatients.length;\n\n      return {\n        patients: paginatedPatients,\n        total: filteredPatients.length,\n        page: page,\n        pageSize: pageSize,\n        hasMore: hasMore\n      };\n    } catch (error) {\n      console.error('Failed to get patients:', error);\n      return {\n        patients: [],\n        total: 0,\n        page: 1,\n        pageSize: 0,\n        hasMore: false\n      };\n    }\n  }\n\n  async getPatientStats(): Promise<PatientStats> {\n    try {\n      await this.init();\n\n      const stats: PatientStats = {\n        total: this.patients.length,\n        byStatus: {},\n        bySegment: {}\n      };\n\n      this.patients.forEach(patient => {\n        try {\n          // Status counts\n          if (patient.status) {\n            stats.byStatus[patient.status] = (stats.byStatus[patient.status] || 0) + 1;\n          }\n\n          // Segment counts\n          if (patient.segment) {\n            stats.bySegment[patient.segment] = (stats.bySegment[patient.segment] || 0) + 1;\n          }\n        } catch (error) {\n          console.warn('Error processing patient stats for patient:', patient.id, error);\n        }\n      });\n\n      return stats;\n    } catch (error) {\n      console.error('Failed to get patient stats:', error);\n      // Return empty stats on error\n      return {\n        total: 0,\n        byStatus: {},\n        bySegment: {}\n      };\n    }\n  }\n\n  // Patient matching for OCR/document processing\n  async findMatches(request: PatientMatchRequest): Promise<PatientMatchCandidate[]> {\n    await this.init();\n\n    const candidates: PatientMatchCandidate[] = [];\n\n    for (const patient of this.patients) {\n      const matchResult = this.calculatePatientMatch(request, patient);\n      if (matchResult.score > 0.3) { // Minimum threshold\n        candidates.push(matchResult);\n      }\n    }\n\n    // Sort by score (highest first)\n    candidates.sort((a, b) => b.score - a.score);\n\n    return candidates.slice(0, 10); // Return top 10 matches\n  }\n\n  private calculatePatientMatch(request: PatientMatchRequest, patient: Patient): PatientMatchCandidate {\n    let score = 0;\n    const matchedFields: string[] = [];\n\n    // Exact TC number match (highest priority)\n    if (request.tcNo && patient.tcNumber && request.tcNo === patient.tcNumber) {\n      score += 0.8;\n      matchedFields.push('tcNumber');\n    }\n\n    // Name similarity\n    if (request.name && (patient.firstName || patient.lastName)) {\n      const patientName = `${patient.firstName || ''} ${patient.lastName || ''}`.trim();\n      const nameSimilarity = this.calculateStringSimilarity(request.name, patientName);\n      if (nameSimilarity > 0.6) {\n        score += nameSimilarity * 0.4;\n        matchedFields.push('name');\n      }\n    }\n\n    // Birth date match\n    if (request.birthDate && patient.birthDate) {\n      if (request.birthDate === patient.birthDate) {\n        score += 0.3;\n        matchedFields.push('birthDate');\n      }\n    }\n\n    // Phone number match\n    if (request.phone && patient.phone) {\n      const phoneSimilarity = this.calculateStringSimilarity(request.phone, patient.phone);\n      if (phoneSimilarity > 0.8) {\n        score += phoneSimilarity * 0.2;\n        matchedFields.push('phone');\n      }\n    }\n\n    // Determine confidence level\n    let confidence: 'high' | 'medium' | 'low' = 'low';\n    if (score >= 0.8) confidence = 'high';\n    else if (score >= 0.6) confidence = 'medium';\n\n    return {\n      patient,\n      score,\n      matchedFields,\n      confidence\n    };\n  }\n\n  private calculateStringSimilarity(str1: string, str2: string): number {\n    // Simple Levenshtein distance-based similarity\n    const longer = str1.length > str2.length ? str1 : str2;\n    const shorter = str1.length > str2.length ? str2 : str1;\n    \n    if (longer.length === 0) return 1.0;\n    \n    const distance = this.levenshteinDistance(longer, shorter);\n    return (longer.length - distance) / longer.length;\n  }\n\n  private levenshteinDistance(str1: string, str2: string): number {\n    const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));\n    \n    for (let i = 0; i <= str1.length; i++) matrix[0][i] = i;\n    for (let j = 0; j <= str2.length; j++) matrix[j][0] = j;\n    \n    for (let j = 1; j <= str2.length; j++) {\n      for (let i = 1; i <= str1.length; i++) {\n        const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;\n        matrix[j][i] = Math.min(\n          matrix[j][i - 1] + 1,\n          matrix[j - 1][i] + 1,\n          matrix[j - 1][i - 1] + indicator\n        );\n      }\n    }\n    \n    return matrix[str2.length][str1.length];\n  }\n\n  // Utility methods\n  private generateId(): string {\n    return `patient_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  async validateTcNumber(tcNumber: string, excludePatientId?: string): Promise<boolean> {\n    try {\n      await this.init();\n      \n      if (!tcNumber?.trim()) {\n        return false;\n      }\n\n      // Basic TC number validation (11 digits)\n      if (!/^\\d{11}$/.test(tcNumber)) {\n        return false;\n      }\n\n      // Check for duplicates\n      return !this.patients.some(p => \n        p.tcNumber === tcNumber && p.id !== excludePatientId\n      );\n    } catch (error) {\n      console.error('Failed to validate TC number:', error);\n      return false;\n    }\n  }\n\n  // Bulk operations\n  async bulkUpdatePatients(updates: Array<{ id: string; data: Partial<Patient> }>): Promise<Patient[]> {\n    const updatedPatients: Patient[] = [];\n    const errors: string[] = [];\n    \n    for (const update of updates) {\n      try {\n        if (!update.id?.trim()) {\n          errors.push('Missing patient ID in bulk update');\n          continue;\n        }\n\n        const patient = await this.updatePatient(update.id, update.data);\n        if (patient) {\n          updatedPatients.push(patient);\n        }\n      } catch (error) {\n        errors.push(`Failed to update patient ${update.id}: ${error}`);\n      }\n    }\n    \n    if (errors.length > 0) {\n      console.warn('Bulk update errors:', errors);\n    }\n    \n    return updatedPatients;\n  }\n\n  // Export/Import\n  async exportPatients(): Promise<string> {\n    try {\n      await this.init();\n      return JSON.stringify(this.patients, null, 2);\n    } catch (error) {\n      console.error('Failed to export patients:', error);\n      throw new Error('Failed to export patients');\n    }\n  }\n\n  async importPatients(data: string): Promise<{ success: number; errors: string[] }> {\n    try {\n      await this.init();\n      \n      const parsed = JSON.parse(data);\n      if (!Array.isArray(parsed)) {\n        throw new Error('Invalid data format');\n      }\n\n      const results = { success: 0, errors: [] as string[] };\n      \n      for (const patientData of parsed) {\n        try {\n          await this.createPatient(patientData);\n          results.success++;\n        } catch (error) {\n          results.errors.push(`Failed to import patient: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n      }\n\n      return results;\n    } catch (error) {\n      throw new Error(`Import failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * Calculate priority score for a patient\n   */\n  calculatePriorityScore(patient: Patient): number {\n    let score = 0;\n    \n    // Age factor (elderly patients get higher priority)\n    if (patient.birthDate) {\n      const age = new Date().getFullYear() - new Date(patient.birthDate).getFullYear();\n      if (age >= 65) score += 20;\n      else if (age >= 50) score += 10;\n    }\n    \n    // Missing information penalty\n    if (!patient.phone || !patient.email) score -= 15;\n    \n    return Math.max(0, Math.min(100, score));\n  }\n\n  /**\n   * Add a note to a patient\n   */\n  addNote(patient: Patient, note: Omit<PatientNote, 'id'>): Patient {\n    const newNote: PatientNote = {\n      ...note,\n      id: this.generateId()\n    };\n\n    return {\n      ...patient,\n      notes: [...(patient.notes || []), newNote]\n    };\n  }\n\n  /**\n   * Update a device for a patient\n   */\n  updateDevice(patient: Patient, deviceId: string, updates: Partial<PatientDevice>): Patient {\n    const devices = patient.devices || [];\n    const updatedDevices = devices.map(device => \n      device.id === deviceId ? { ...device, ...updates } : device\n    );\n\n    return {\n      ...patient,\n      devices: updatedDevices\n    };\n  }\n\n  /**\n   * Add communication to a patient\n   */\n  addCommunication(patient: Patient, communication: Omit<Communication, 'id'>): Patient {\n    const newCommunication = {\n      ...communication,\n      id: this.generateId(),\n      date: communication.timestamp || new Date().toISOString()\n    };\n\n    return {\n      ...patient,\n      communications: [...(patient.communications || []), newCommunication]\n    };\n  }\n\n  /**\n   * Add device to a patient\n   */\n  addDevice(patient: Patient, device: Omit<PatientDevice, 'id'>): Patient {\n    const newDevice: PatientDevice = {\n      ...device,\n      id: this.generateId()\n    };\n\n    return {\n      ...patient,\n      devices: [...(patient.devices || []), newDevice]\n    };\n  }\n\n  /**\n   * Get high priority patients\n   */\n  async getHighPriorityPatients(): Promise<Patient[]> {\n    const allPatients = await this.getPatients();\n    return allPatients.patients\n      .filter(patient => this.calculatePriorityScore(patient) >= 50)\n      .sort((a, b) => this.calculatePriorityScore(b) - this.calculatePriorityScore(a));\n  }\n}\n\n// Singleton instance\nexport const patientService = new PatientService();\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-analytics.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'sales' is assigned a value but never used.","line":89,"column":70,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":83}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Analytics Service\n * @fileoverview Handles patient analytics, statistics, and reporting\n * @version 1.0.0\n */\n\nimport { Patient, Device, Sale } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport { PatientStatus } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\n\nexport interface AnalyticsTimeRange {\n  start: string;\n  end: string;\n}\n\nexport interface PatientTrend {\n  date: string;\n  count: number;\n  newPatients: number;\n  activePatients: number;\n}\n\nexport interface DeviceAnalytics {\n  totalDevices: number;\n  devicesByType: Record<string, number>;\n  devicesBySide: Record<string, number>;\n  averageDevicesPerPatient: number;\n  patientsWithDevices: number;\n  patientsWithoutDevices: number;\n}\n\nexport interface SGKAnalytics {\n  totalWithSGK: number;\n  totalWithoutSGK: number;\n  sgkCoverageRate: number;\n  pendingSGKApplications: number;\n  approvedSGKApplications: number;\n  rejectedSGKApplications: number;\n}\n\nexport interface AgeDistribution {\n  ageGroup: string;\n  count: number;\n  percentage: number;\n}\n\nexport interface RevenueAnalytics {\n  totalRevenue: number;\n  averageRevenuePerPatient: number;\n  outstandingBalance: number;\n  collectionRate: number;\n  monthlyRevenue: Array<{\n    month: string;\n    revenue: number;\n  }>;\n}\n\nexport interface CityStats {\n  city: string;\n  count: number;\n  percentage: number;\n}\n\nexport interface StatusStats {\n  status: PatientStatus;\n  count: number;\n  percentage: number;\n}\n\nexport interface SegmentStats {\n  segment: string;\n  count: number;\n  percentage: number;\n}\n\nexport interface PatientStats {\n  totalPatients: number;\n  activePatients: number;\n  newThisMonth: number;\n  withDevices: number;\n  withInsurance: number;\n  averageAge: number;\n  topCities: CityStats[];\n  statusDistribution: StatusStats[];\n  segmentDistribution: SegmentStats[];\n}\n\nexport class PatientAnalyticsService {\n\n  calculatePatientStats(patients: Patient[], devices: Device[] = [], sales: Sale[] = []): PatientStats {\n    const totalPatients = patients.length;\n    const activePatients = patients.filter(p => p.status === 'ACTIVE').length;\n\n    // Calculate new patients this month\n    const thisMonth = new Date();\n    thisMonth.setDate(1);\n    thisMonth.setHours(0, 0, 0, 0);\n\n    const newThisMonth = patients.filter(p =>\n      p.createdAt && new Date(p.createdAt) >= thisMonth\n    ).length;\n\n    // Calculate patients with devices (from separate devices array)\n    const patientsWithDevices = new Set(devices.map(d => d.patientId).filter(Boolean)).size;\n\n    const withInsurance = patients.filter(p =>\n      p.sgkInfo && Object.keys(p.sgkInfo).length > 0\n    ).length;\n\n    // Calculate average age\n    const patientsWithBirthDate = patients.filter(p => p.birthDate);\n    const averageAge = patientsWithBirthDate.length > 0\n      ? patientsWithBirthDate.reduce((sum, p) => {\n          const age = this.calculateAge(p.birthDate!);\n          return sum + age;\n        }, 0) / patientsWithBirthDate.length\n      : 0;\n\n    const topCities = this.calculateTopCities(patients);\n    const statusDistribution = this.calculateStatusDistribution(patients);\n    const segmentDistribution = this.calculateSegmentDistribution(patients);\n\n    return {\n      totalPatients,\n      activePatients,\n      newThisMonth,\n      withDevices: patientsWithDevices,\n      withInsurance,\n      averageAge: Math.round(averageAge),\n      topCities,\n      statusDistribution,\n      segmentDistribution\n    };\n  }\n\n  calculateDeviceAnalytics(patients: Patient[], devices: Device[]): DeviceAnalytics {\n    const totalDevices = devices.length;\n\n    const devicesByType: Record<string, number> = {};\n    const devicesBySide: Record<string, number> = {};\n\n    devices.forEach(device => {\n      // Count by device type\n      const deviceType = device.deviceType || device.category || 'unknown';\n      devicesByType[deviceType] = (devicesByType[deviceType] || 0) + 1;\n\n      // Count by ear/side\n      const side = device.ear || 'unknown';\n      devicesBySide[side] = (devicesBySide[side] || 0) + 1;\n    });\n\n    // Calculate patients with devices\n    const patientsWithDevices = new Set(devices.map(d => d.patientId).filter(Boolean)).size;\n    const patientsWithoutDevices = patients.length - patientsWithDevices;\n\n    const averageDevicesPerPatient = patients.length > 0\n      ? totalDevices / patients.length\n      : 0;\n\n    return {\n      totalDevices,\n      devicesByType,\n      devicesBySide,\n      averageDevicesPerPatient: Math.round(averageDevicesPerPatient * 100) / 100,\n      patientsWithDevices,\n      patientsWithoutDevices\n    };\n  }\n\n  calculateSGKAnalytics(patients: Patient[]): SGKAnalytics {\n    const totalWithSGK = patients.filter(p =>\n      p.sgkInfo && Object.keys(p.sgkInfo).length > 0\n    ).length;\n\n    const totalWithoutSGK = patients.length - totalWithSGK;\n\n    const sgkCoverageRate = patients.length > 0\n      ? (totalWithSGK / patients.length) * 100\n      : 0;\n\n    // SGK workflow data would need to be fetched separately from SGK processing endpoints\n    // For now, return placeholder values\n    const pendingSGKApplications = 0;\n    const approvedSGKApplications = 0;\n    const rejectedSGKApplications = 0;\n\n    return {\n      totalWithSGK,\n      totalWithoutSGK,\n      sgkCoverageRate: Math.round(sgkCoverageRate * 100) / 100,\n      pendingSGKApplications,\n      approvedSGKApplications,\n      rejectedSGKApplications\n    };\n  }\n\n  calculateAgeDistribution(patients: Patient[]): AgeDistribution[] {\n    const ageGroups = {\n      '0-18': 0,\n      '19-30': 0,\n      '31-45': 0,\n      '46-60': 0,\n      '61-75': 0,\n      '76+': 0\n    };\n\n    const patientsWithBirthDate = patients.filter(p => p.birthDate);\n\n    patientsWithBirthDate.forEach(patient => {\n      const age = this.calculateAge(patient.birthDate!);\n\n      if (age <= 18) ageGroups['0-18']++;\n      else if (age <= 30) ageGroups['19-30']++;\n      else if (age <= 45) ageGroups['31-45']++;\n      else if (age <= 60) ageGroups['46-60']++;\n      else if (age <= 75) ageGroups['61-75']++;\n      else ageGroups['76+']++;\n    });\n\n    const total = patientsWithBirthDate.length;\n\n    return Object.entries(ageGroups).map(([ageGroup, count]) => ({\n      ageGroup,\n      count,\n      percentage: total > 0 ? Math.round((count / total) * 100 * 100) / 100 : 0\n    }));\n  }\n\n  calculatePatientTrends(patients: Patient[], timeRange: AnalyticsTimeRange): PatientTrend[] {\n    const startDate = new Date(timeRange.start);\n    const endDate = new Date(timeRange.end);\n    const trends: PatientTrend[] = [];\n\n    // Group patients by date\n    const patientsByDate: Record<string, Patient[]> = {};\n\n    patients.forEach(patient => {\n      const createdDate = patient.createdAt ? new Date(patient.createdAt) : new Date();\n      if (createdDate >= startDate && createdDate <= endDate) {\n        const dateKey = createdDate.toISOString().split('T')[0];\n        if (!patientsByDate[dateKey]) {\n          patientsByDate[dateKey] = [];\n        }\n        patientsByDate[dateKey].push(patient);\n      }\n    });\n\n    // Generate trend data for each day in range\n    const currentDate = new Date(startDate);\n    let cumulativeCount = 0;\n\n    while (currentDate <= endDate) {\n      const dateKey = currentDate.toISOString().split('T')[0];\n      const dayPatients = patientsByDate[dateKey] || [];\n      const newPatients = dayPatients.length;\n      const activePatients = dayPatients.filter(p => p.status === 'ACTIVE').length;\n\n      cumulativeCount += newPatients;\n\n      trends.push({\n        date: dateKey,\n        count: cumulativeCount,\n        newPatients,\n        activePatients\n      });\n\n      currentDate.setDate(currentDate.getDate() + 1);\n    }\n\n    return trends;\n  }\n\n  calculateRevenueAnalytics(patients: Patient[], sales: Sale[]): RevenueAnalytics {\n    let totalRevenue = 0;\n    let outstandingBalance = 0;\n\n    sales.forEach(sale => {\n      totalRevenue += sale.totalAmount;\n\n      // Estimate outstanding balance (placeholder logic)\n      if (Math.random() > 0.8) { // 20% chance of outstanding balance\n        outstandingBalance += sale.totalAmount * 0.3;\n      }\n    });\n\n    const averageRevenuePerPatient = patients.length > 0\n      ? totalRevenue / patients.length\n      : 0;\n\n    const collectionRate = totalRevenue > 0\n      ? ((totalRevenue - outstandingBalance) / totalRevenue) * 100\n      : 100;\n\n    // Generate monthly revenue (placeholder)\n    const monthlyRevenue = this.generateMonthlyRevenue(totalRevenue);\n\n    return {\n      totalRevenue: Math.round(totalRevenue * 100) / 100,\n      averageRevenuePerPatient: Math.round(averageRevenuePerPatient * 100) / 100,\n      outstandingBalance: Math.round(outstandingBalance * 100) / 100,\n      collectionRate: Math.round(collectionRate * 100) / 100,\n      monthlyRevenue\n    };\n  }\n\n  private calculateTopCities(patients: Patient[]): CityStats[] {\n    const cityCount: Record<string, number> = {};\n    const total = patients.length;\n\n    patients.forEach(patient => {\n      const city = patient.addressCity || 'Unknown';\n      cityCount[city] = (cityCount[city] || 0) + 1;\n    });\n\n    return Object.entries(cityCount)\n      .map(([city, count]) => ({\n        city,\n        count,\n        percentage: Math.round((count / total) * 100 * 100) / 100\n      }))\n      .sort((a, b) => b.count - a.count)\n      .slice(0, 10); // Top 10 cities\n  }\n\n  private calculateStatusDistribution(patients: Patient[]): StatusStats[] {\n    const statusCount: Record<string, number> = {};\n    const total = patients.length;\n\n    patients.forEach(patient => {\n      const status = patient.status || 'ACTIVE';\n      statusCount[status] = (statusCount[status] || 0) + 1;\n    });\n\n    const allowedStatuses: PatientStatus[] = ['ACTIVE', 'INACTIVE', 'LEAD', 'TRIAL', 'CUSTOMER'];\n    return Object.entries(statusCount).map(([status, count]) => {\n      const validStatus = allowedStatuses.includes(status as PatientStatus) ? status as PatientStatus : 'ACTIVE';\n      return {\n        status: validStatus,\n        count,\n        percentage: Math.round((count / total) * 100 * 100) / 100\n      };\n    });\n  }\n\n  private calculateSegmentDistribution(patients: Patient[]): SegmentStats[] {\n    const segmentCount: Record<string, number> = {};\n    const total = patients.length;\n\n    patients.forEach(patient => {\n      const segment = patient.segment || 'NEW';\n      segmentCount[segment] = (segmentCount[segment] || 0) + 1;\n    });\n\n    const allowedSegments: string[] = ['NEW', 'EXISTING', 'VIP'];\n    return Object.entries(segmentCount).map(([segment, count]) => {\n      const validSegment = allowedSegments.includes(segment) ? segment : 'NEW';\n      return {\n        segment: validSegment,\n        count,\n        percentage: Math.round((count / total) * 100 * 100) / 100\n      };\n    });\n  }\n\n  private calculateAge(birthDate: string): number {\n    const birth = new Date(birthDate);\n    const today = new Date();\n    let age = today.getFullYear() - birth.getFullYear();\n    const monthDiff = today.getMonth() - birth.getMonth();\n\n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {\n      age--;\n    }\n\n    return age;\n  }\n\n  private generateMonthlyRevenue(totalRevenue: number): Array<{ month: string; revenue: number }> {\n    const months: Array<{ month: string; revenue: number }> = [];\n    const currentDate = new Date();\n\n    // Generate last 12 months\n    for (let i = 11; i >= 0; i--) {\n      const date = new Date(currentDate.getFullYear(), currentDate.getMonth() - i, 1);\n      const monthName = date.toLocaleDateString('tr-TR', { year: 'numeric', month: 'long' });\n\n      // Distribute revenue randomly across months (placeholder)\n      const monthlyRevenue = Math.round((totalRevenue / 12) * (0.5 + Math.random()) * 100) / 100;\n\n      months.push({\n        month: monthName,\n        revenue: monthlyRevenue\n      });\n    }\n\n    return months;\n  }\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-api.service.ts","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'axios' import is restricted from being used. Use generated API client from @x-ear/core instead of direct axios calls.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"pathWithCustomMessage","endLine":2,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AxiosResponse' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PatientsGetPatients200' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PaginationInfo' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Sale' is defined but never used.","line":8,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":42},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SalesCreateSaleBody' is defined but never used.","line":8,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":63},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SalesUpdateSaleBody' is defined but never used.","line":8,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":84},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[705,708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[705,708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":119,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3488,3491],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3488,3491],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":206,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5851,5854],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5851,5854],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":206,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5865,5868],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5865,5868],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":228,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6429,6432],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6429,6432],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":228,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6443,6446],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6443,6446],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":250,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":250,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7018,7021],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7018,7021],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":269,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":269,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7575,7578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7575,7578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":276,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7825,7828],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7825,7828],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":289,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":289,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8189,8192],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8189,8192],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":298,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":298,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8627,8630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8627,8630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientId' is defined but never used.","line":316,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":316,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":316,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":316,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9131,9134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9131,9134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'patientId' is defined but never used.","line":336,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":336,"endColumn":35},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":336,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":336,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9842,9845],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9842,9845],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formData' is defined but never used.","line":356,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":356,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":356,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":356,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10473,10476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10473,10476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":356,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":356,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10487,10490],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10487,10490],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'searchParams' is defined but never used.","line":360,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":360,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":360,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":360,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10628,10631],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10628,10631],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":360,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":360,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10642,10645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10642,10645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'filters' is defined but never used.","line":364,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":364,"endColumn":31},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":364,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":364,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10776,10779],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10776,10779],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":364,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":364,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10790,10793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10790,10793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'filters' is defined but never used.","line":368,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":368,"endColumn":26},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":368,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":368,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10919,10922],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10919,10922],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":368,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":368,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10933,10936],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10933,10936],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":372,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":372,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":372,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":372,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11010,11013],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11010,11013],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":372,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":372,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11024,11027],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11024,11027],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":376,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":376,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11120,11123],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11120,11123],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":376,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":376,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11134,11137],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11134,11137],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":396,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":396,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11750,11753],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11750,11753],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":40,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Patient API Service - Simplified Version\nimport { AxiosResponse } from 'axios';\nimport { \n  PatientsGetPatients200,\n  PaginationInfo\n} from \"../../api/generated/xEarCRMAPIAutoGenerated.schemas\";\nimport { apiClient, Patient, CreatePatientRequest, UpdatePatientRequest } from '../../api/client';\nimport { getXEarCRMAPIAutoGenerated, Sale, SalesCreateSaleBody, SalesUpdateSaleBody } from '../../api/generated/api';\n\n// Request deduplication and caching\ninterface CacheEntry {\n  data: Patient[];\n  timestamp: number;\n  promise?: Promise<Patient[]>;\n}\n\nclass RequestThrottler {\n  private activeRequests = 0;\n  private readonly maxConcurrentRequests = 3;\n  private readonly requestQueue: Array<() => Promise<any>> = [];\n  private readonly requestDelay = 100;\n\n  async throttle<T>(requestFn: () => Promise<T>): Promise<T> {\n    return new Promise((resolve, reject) => {\n      this.requestQueue.push(async () => {\n        try {\n          this.activeRequests++;\n          const result = await requestFn();\n          resolve(result);\n        } catch (error) {\n          reject(error);\n        } finally {\n          this.activeRequests--;\n          setTimeout(() => this.processQueue(), this.requestDelay);\n        }\n      });\n      this.processQueue();\n    });\n  }\n\n  private processQueue() {\n    if (this.activeRequests < this.maxConcurrentRequests && this.requestQueue.length > 0) {\n      const nextRequest = this.requestQueue.shift();\n      if (nextRequest) {\n        nextRequest();\n      }\n    }\n  }\n\n  getActiveRequestCount(): number {\n    return this.activeRequests;\n  }\n\n  getQueueLength(): number {\n    return this.requestQueue.length;\n  }\n}\n\nexport class PatientApiService {\n  private cache: Map<string, CacheEntry> = new Map();\n  private readonly CACHE_TTL = 5 * 60 * 1000; // 5 minutes\n  private ongoingRequests: Map<string, Promise<Patient[]>> = new Map();\n  private throttler = new RequestThrottler();\n\n  /**\n   * Fetch all patients with caching\n   */\n  async fetchAllPatients(): Promise<Patient[]> {\n    const cacheKey = 'all_patients';\n    const cached = this.cache.get(cacheKey);\n    \n    if (cached && Date.now() - cached.timestamp < this.CACHE_TTL) {\n      console.log('📋 Returning cached patients data');\n      return cached.data;\n    }\n\n    if (this.ongoingRequests.has(cacheKey)) {\n      console.log('⏳ Waiting for ongoing request...');\n      return this.ongoingRequests.get(cacheKey)!;\n    }\n\n    const promise = this._fetchAllPatientsInternal();\n    this.ongoingRequests.set(cacheKey, promise);\n\n    try {\n      const data = await promise;\n      this.cache.set(cacheKey, { data, timestamp: Date.now() });\n      return data;\n    } finally {\n      this.ongoingRequests.delete(cacheKey);\n    }\n  }\n\n  /**\n   * Fetch all patients (simplified implementation)\n   */\n  private async _fetchAllPatientsInternal(): Promise<Patient[]> {\n    console.log('🔄 Starting to fetch all patients...');\n    \n    try {\n      const response = await apiClient.getPatients();\n      \n      if (response.data?.data?.patients) {\n        console.log(`✅ Successfully fetched ${response.data.data.patients.length} patients`);\n        return response.data.data.patients;\n      }\n      \n      console.warn('⚠️ No patients data in response:', response);\n      return [];\n    } catch (error) {\n      console.error('❌ Error fetching patients:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get patient sales using generated API client with throttling\n   */\n  async getSales(patientId: string): Promise<any> {\n    try {\n      const response = await this.throttler.throttle(async () => {\n        const api = getXEarCRMAPIAutoGenerated();\n        return await api.salesGetPatientSales(patientId);\n      });\n      \n      return {\n        data: response.data,\n        success: true,\n        message: 'Sales data retrieved successfully'\n      };\n    } catch (error) {\n      console.error('❌ Error fetching sales:', error);\n      return {\n        data: [],\n        success: false,\n        message: 'Failed to fetch sales data'\n      };\n    }\n  }\n\n  clearCache(): void {\n    this.cache.clear();\n    console.log('🗑️ Cache cleared');\n  }\n\n  invalidateCache(key: string = 'all_patients'): void {\n    this.cache.delete(key);\n    console.log(`🗑️ Cache invalidated for key: ${key}`);\n  }\n\n  async fetchPatient(id: string): Promise<Patient | null> {\n    try {\n      const response = await apiClient.getPatient(id);\n      if (response.data?.patient) {\n        return response.data.patient;\n      }\n      return null;\n    } catch (error) {\n      console.error(`❌ Error fetching patient ${id}:`, error);\n      throw error;\n    }\n  }\n\n  async createPatient(patientData: CreatePatientRequest): Promise<Patient> {\n    try {\n      const response = await apiClient.createPatient(patientData);\n      if (response.data?.patient) {\n        this.invalidateCache();\n        return response.data.patient;\n      }\n      throw new Error('Failed to create patient');\n    } catch (error) {\n      console.error('❌ Error creating patient:', error);\n      throw error;\n    }\n  }\n\n  async updatePatient(id: string, updates: UpdatePatientRequest): Promise<Patient | null> {\n    try {\n      const response = await apiClient.updatePatient(id, updates);\n      if (response.data?.patient) {\n        this.invalidateCache();\n        return response.data.patient;\n      }\n      return null;\n    } catch (error) {\n      console.error(`❌ Error updating patient ${id}:`, error);\n      throw error;\n    }\n  }\n\n  async deletePatient(id: string): Promise<boolean> {\n    try {\n      const response = await apiClient.deletePatient(id);\n      if (response.data?.success) {\n        this.invalidateCache();\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error(`❌ Error deleting patient ${id}:`, error);\n      throw error;\n    }\n  }\n\n  async createSale(patientId: string, saleData: any): Promise<any> {\n    try {\n      const response = await this.throttler.throttle(async () => {\n        const api = getXEarCRMAPIAutoGenerated();\n        return await api.salesCreateSale(saleData);\n      });\n      \n      return {\n        data: response.data,\n        success: true,\n        message: 'Sale created successfully'\n      };\n    } catch (error) {\n      console.error('❌ Error creating sale:', error);\n      return {\n        data: null,\n        success: false,\n        message: 'Failed to create sale'\n      };\n    }\n  }\n\n  async updateSale(saleId: string, updates: any): Promise<any> {\n    try {\n      const response = await this.throttler.throttle(async () => {\n        const api = getXEarCRMAPIAutoGenerated();\n        return await api.salesUpdateSale(saleId, updates);\n      });\n      \n      return {\n        data: response.data,\n        success: true,\n        message: 'Sale updated successfully'\n      };\n    } catch (error) {\n      console.error('❌ Error updating sale:', error);\n      return {\n        data: null,\n        success: false,\n        message: 'Failed to update sale'\n      };\n    }\n  }\n\n  async getTimeline(patientId: string): Promise<any> {\n    try {\n      const api = getXEarCRMAPIAutoGenerated();\n      const response = await api.timelineGetPatientTimeline(patientId);\n      return { \n        data: response.data?.data || [], \n        success: true, \n        meta: response.data?.meta \n      };\n    } catch (error) {\n      console.error('Failed to fetch patient timeline:', error);\n      return { \n        data: [], \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to fetch timeline' \n      };\n    }\n  }\n\n  async getSgk(patientId: string): Promise<any> {\n    try {\n      const response = await this.throttler.throttle(async () => {\n        const api = getXEarCRMAPIAutoGenerated();\n        return await api.sgkGetPatientSgkDocuments(patientId);\n      });\n      return { \n        data: (response as any)?.data || [], \n        success: true \n      };\n    } catch (error) {\n      console.error('Failed to fetch patient SGK documents:', error);\n      return { \n        data: [], \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to fetch SGK documents' \n      };\n    }\n  }\n\n  async getAppointments(patientId: string): Promise<any> {\n    try {\n      const response = await this.throttler.throttle(async () => {\n        const api = getXEarCRMAPIAutoGenerated();\n        return await api.appointmentsListAppointments();\n      });\n      \n      // Filter appointments by patient ID on the client side since the API doesn't support filtering\n      const allAppointments = response.data?.data || [];\n      const patientAppointments = allAppointments.filter((appointment: any) => \n        appointment.patientId === patientId || appointment.patient_id === patientId\n      );\n      \n      return { \n        data: patientAppointments, \n        success: true \n      };\n    } catch (error) {\n      console.error('Failed to fetch patient appointments:', error);\n      return { \n        data: [], \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to fetch appointments' \n      };\n    }\n  }\n\n  async getHearingTests(patientId: string): Promise<any> {\n    try {\n      // Note: There's no direct hearing tests endpoint in the generated client\n      // This would need to be implemented when the backend endpoint is available\n      console.warn('Hearing tests endpoint not yet available in generated client');\n      return { \n        data: [], \n        success: true, \n        message: 'Hearing tests endpoint not yet implemented in backend' \n      };\n    } catch (error) {\n      console.error('Failed to fetch patient hearing tests:', error);\n      return { \n        data: [], \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to fetch hearing tests' \n      };\n    }\n  }\n\n  async getNotes(patientId: string): Promise<any> {\n    try {\n      // Note: There's no direct get notes endpoint in the generated client\n      // Only create and delete are available\n      console.warn('Get notes endpoint not yet available in generated client');\n      return { \n        data: [], \n        success: true, \n        message: 'Get notes endpoint not yet implemented in backend' \n      };\n    } catch (error) {\n      console.error('Failed to fetch patient notes:', error);\n      return { \n        data: [], \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to fetch notes' \n      };\n    }\n  }\n\n  async bulkUpload(formData: any): Promise<any> {\n    return { data: [], success: true, message: 'Bulk upload not available in simplified version' };\n  }\n\n  async search(searchParams: any): Promise<any> {\n    return { data: [], success: true, message: 'Search not available in simplified version' };\n  }\n\n  async exportCsv(filters: any): Promise<any> {\n    return { data: [], success: true, message: 'Export not available in simplified version' };\n  }\n\n  async list(filters: any): Promise<any> {\n    return this.fetchAllPatients();\n  }\n\n  async getPatients(params?: any): Promise<any> {\n    return this.fetchAllPatients();\n  }\n\n  async createNote(patientId: string, noteData: any): Promise<any> {\n    try {\n      const response = await this.throttler.throttle(async () => {\n        const api = getXEarCRMAPIAutoGenerated();\n        return await api.patientSubresourcesCreatePatientNote(patientId, noteData);\n      });\n      return { \n        data: response.data, \n        success: true \n      };\n    } catch (error) {\n      console.error('Failed to create patient note:', error);\n      return { \n        data: null, \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to create note' \n      };\n    }\n  }\n\n  async deleteNote(patientId: string, noteId: string): Promise<any> {\n    try {\n      const response = await this.throttler.throttle(async () => {\n        const api = getXEarCRMAPIAutoGenerated();\n        return await api.patientSubresourcesDeletePatientNote(patientId, noteId);\n      });\n      return { \n        data: response.data, \n        success: true \n      };\n    } catch (error) {\n      console.error('Failed to delete patient note:', error);\n      return { \n        data: null, \n        success: false, \n        error: error instanceof Error ? error.message : 'Failed to delete note' \n      };\n    }\n  }\n\n  private generateId(): string {\n    return Math.random().toString(36).substr(2, 9);\n  }\n}\n\nexport const patientApiService = new PatientApiService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-cache.service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":219,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6782,6785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6782,6785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":330,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":330,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10298,10301],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10298,10301],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":330,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":330,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10318,10321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10318,10321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Cache Service\n * @fileoverview Handles patient data caching and offline storage\n * @version 1.0.0\n */\n\nimport { Patient } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport { indexedDBManager } from '../../utils/indexeddb';\n\nexport interface CacheStats {\n  totalPatients: number;\n  lastUpdated: string | null;\n  cacheSize: number;\n  oldestEntry: string | null;\n  newestEntry: string | null;\n}\n\nexport interface CacheOptions {\n  ttl?: number; // Time to live in milliseconds\n  maxSize?: number; // Maximum number of patients to cache\n  priority?: 'high' | 'normal' | 'low';\n}\n\nexport interface SimpleCacheFilters {\n  search?: string;\n  status?: string[];\n  segment?: string[];\n  tags?: string[];\n  acquisitionType?: string[];\n  page?: number;\n  limit?: number;\n}\n\nexport interface PatientSearchResult {\n  patients: PatientSearchItem[];\n  totalCount: number;\n  filteredCount: number;\n}\n\nexport interface PatientSearchItem {\n  id?: string;\n  firstName: string;\n  lastName: string;\n  tcNumber: string;\n  phone: string;\n  email?: string;\n  status?: string;\n  segment?: string;\n  registrationDate?: string;\n  lastVisitDate?: string;\n  deviceCount: number;\n  hasInsurance: boolean;\n  outstandingBalance: number;\n  priority: number;\n}\n\nexport class PatientCacheService {\n  private readonly CACHE_PREFIX = 'patient_cache_';\n  private readonly METADATA_KEY = 'patient_cache_metadata';\n  private readonly DEFAULT_TTL = 24 * 60 * 60 * 1000; // 24 hours\n  private readonly MAX_CACHE_SIZE = 10000;\n\n  async cachePatients(patients: Patient[], options: CacheOptions = {}): Promise<void> {\n    try {\n      // Store patients in IndexedDB\n      await indexedDBManager.savePatients(patients);\n      \n      // Update cache metadata\n      await this.updateCacheMetadata(patients.length);\n      \n      // Set individual cache entries with TTL\n      const ttl = options.ttl || this.DEFAULT_TTL;\n      const cachePromises = patients.map(patient => \n        indexedDBManager.setCache(\n          `${this.CACHE_PREFIX}${patient.id}`,\n          patient,\n          ttl\n        )\n      );\n      \n      await Promise.all(cachePromises);\n    } catch (error) {\n      console.error('Failed to cache patients:', error);\n      throw error;\n    }\n  }\n\n  async getCachedPatient(patientId: string): Promise<Patient | null> {\n    try {\n      // Try IndexedDB first\n      const patient = await indexedDBManager.getPatient(patientId);\n      if (patient) {\n        return patient;\n      }\n\n      // Fallback to cache\n      const cached = await indexedDBManager.getCache(`${this.CACHE_PREFIX}${patientId}`);\n      if (!cached) return null;\n\n      return cached as Patient;\n    } catch (error) {\n      console.error(`Failed to get cached patient ${patientId}:`, error);\n      return null;\n    }\n  }\n\n  async getCachedPatients(): Promise<Patient[]> {\n    try {\n      return await indexedDBManager.getPatients();\n    } catch (error) {\n      console.error('Failed to get cached patients:', error);\n      return [];\n    }\n  }\n\n  async searchCachedPatients(filters: SimpleCacheFilters): Promise<PatientSearchResult> {\n    try {\n      const allPatients = await this.getCachedPatients();\n      let filteredPatients = [...allPatients];\n\n      // Apply filters\n      if (filters.search) {\n        const searchTerm = filters.search.toLowerCase();\n        filteredPatients = filteredPatients.filter(patient =>\n          patient.firstName?.toLowerCase().includes(searchTerm) ||\n          patient.lastName?.toLowerCase().includes(searchTerm) ||\n          patient.phone?.includes(searchTerm) ||\n          patient.tcNumber?.includes(searchTerm) ||\n          patient.email?.toLowerCase().includes(searchTerm)\n        );\n      }\n\n      if (filters.status && filters.status.length > 0) {\n        filteredPatients = filteredPatients.filter(patient =>\n          patient.status && filters.status!.includes(patient.status)\n        );\n      }\n\n      if (filters.segment && filters.segment.length > 0) {\n        filteredPatients = filteredPatients.filter(patient =>\n          patient.segment && filters.segment!.includes(patient.segment)\n        );\n      }\n\n      if (filters.acquisitionType && filters.acquisitionType.length > 0) {\n        filteredPatients = filteredPatients.filter(patient =>\n          patient.acquisitionType && filters.acquisitionType!.includes(patient.acquisitionType)\n        );\n      }\n\n      if (filters.tags && filters.tags.length > 0) {\n        filteredPatients = filteredPatients.filter(patient =>\n          patient.tags?.some(tag => filters.tags!.includes(tag))\n        );\n      }\n\n      // Apply pagination\n      const page = filters.page || 1;\n      const limit = filters.limit || 50;\n      const offset = (page - 1) * limit;\n      const paginatedPatients = filteredPatients.slice(offset, offset + limit);\n\n      // Convert to PatientSearchItem format\n      const searchItems: PatientSearchItem[] = paginatedPatients.map(patient => ({\n        id: patient.id,\n        firstName: patient.firstName,\n        lastName: patient.lastName,\n        tcNumber: patient.tcNumber,\n        phone: patient.phone,\n        email: patient.email,\n        status: patient.status,\n        segment: patient.segment,\n        registrationDate: patient.createdAt,\n        lastVisitDate: patient.updatedAt,\n        deviceCount: 0, // Device count would need to be fetched separately\n        hasInsurance: !!(patient.sgkInfo && Object.keys(patient.sgkInfo).length > 0),\n        outstandingBalance: 0, // This would need to be calculated from actual data\n        priority: patient.priorityScore || 0\n      }));\n\n      return {\n        patients: searchItems,\n        totalCount: filteredPatients.length,\n        filteredCount: filteredPatients.length\n      };\n    } catch (error) {\n      console.error('Failed to search cached patients:', error);\n      return {\n        patients: [],\n        totalCount: 0,\n        filteredCount: 0\n      };\n    }\n  }\n\n  async updateCachedPatient(patient: Patient): Promise<void> {\n    try {\n      await indexedDBManager.updatePatient(patient);\n      await indexedDBManager.setCache(`${this.CACHE_PREFIX}${patient.id}`, patient);\n    } catch (error) {\n      console.error(`Failed to update cached patient ${patient.id}:`, error);\n      throw error;\n    }\n  }\n\n  async removeCachedPatient(patientId: string): Promise<void> {\n    try {\n      await indexedDBManager.deletePatient(patientId);\n      await indexedDBManager.deleteCache(`${this.CACHE_PREFIX}${patientId}`);\n    } catch (error) {\n      console.error(`Failed to remove cached patient ${patientId}:`, error);\n      throw error;\n    }\n  }\n\n  async getCacheStats(): Promise<CacheStats> {\n    try {\n      const patients = await this.getCachedPatients();\n      const metadata = await indexedDBManager.getCache(this.METADATA_KEY) as any;\n\n      const stats: CacheStats = {\n        totalPatients: patients.length,\n        lastUpdated: metadata?.lastUpdated || null,\n        cacheSize: this.calculateCacheSize(patients),\n        oldestEntry: null,\n        newestEntry: null\n      };\n\n      if (patients.length > 0) {\n        const patientsWithCreatedAt = patients.filter(p => p.createdAt);\n        if (patientsWithCreatedAt.length > 0) {\n          const sortedByCreated = [...patientsWithCreatedAt].sort((a, b) =>\n            new Date(a.createdAt!).getTime() - new Date(b.createdAt!).getTime()\n          );\n          stats.oldestEntry = sortedByCreated[0].createdAt!;\n          stats.newestEntry = sortedByCreated[sortedByCreated.length - 1].createdAt!;\n        }\n      }\n\n      return stats;\n    } catch (error) {\n      console.error('Failed to get cache stats:', error);\n      return {\n        totalPatients: 0,\n        lastUpdated: null,\n        cacheSize: 0,\n        oldestEntry: null,\n        newestEntry: null\n      };\n    }\n  }\n\n  async clearCache(): Promise<void> {\n    try {\n      // Clear all patients from IndexedDB\n      const patients = await this.getCachedPatients();\n      const deletePromises = patients\n        .filter(patient => patient.id)\n        .map(patient => this.removeCachedPatient(patient.id!));\n\n      await Promise.all(deletePromises);\n\n      // Clear metadata\n      await indexedDBManager.deleteCache(this.METADATA_KEY);\n    } catch (error) {\n      console.error('Failed to clear cache:', error);\n      throw error;\n    }\n  }\n\n  async optimizeCache(): Promise<void> {\n    try {\n      const patients = await this.getCachedPatients();\n\n      // Remove old entries if cache is too large\n      if (patients.length > this.MAX_CACHE_SIZE) {\n        const patientsWithUpdatedAt = patients.filter(p => p.updatedAt);\n        const sortedByUpdated = [...patientsWithUpdatedAt].sort((a, b) =>\n          new Date(a.updatedAt!).getTime() - new Date(b.updatedAt!).getTime()\n        );\n\n        const toRemove = sortedByUpdated.slice(0, patients.length - this.MAX_CACHE_SIZE);\n        const removePromises = toRemove\n          .filter(patient => patient.id)\n          .map(patient => this.removeCachedPatient(patient.id!));\n\n        await Promise.all(removePromises);\n      }\n    } catch (error) {\n      console.error('Failed to optimize cache:', error);\n    }\n  }\n\n  async isPatientCached(patientId: string): Promise<boolean> {\n    try {\n      const patient = await this.getCachedPatient(patientId);\n      return patient !== null;\n    } catch (error) {\n      console.error(`Failed to check if patient ${patientId} is cached:`, error);\n      return false;\n    }\n  }\n\n  async preloadPatients(patientIds: string[]): Promise<void> {\n    // This would typically fetch patients from API and cache them\n    // For now, it's a placeholder for the actual implementation\n    console.log('Preloading patients:', patientIds);\n  }\n\n  private async updateCacheMetadata(patientCount: number): Promise<void> {\n    try {\n      const metadata = {\n        lastUpdated: new Date().toISOString(),\n        patientCount,\n        version: '1.0.0'\n      };\n      \n      await indexedDBManager.setCache(this.METADATA_KEY, metadata);\n    } catch (error) {\n      console.error('Failed to update cache metadata:', error);\n    }\n  }\n\n  private calculateCacheSize(patients: Patient[]): number {\n    // Rough estimation of cache size in bytes\n    const jsonString = JSON.stringify(patients);\n    return new Blob([jsonString]).size;\n  }\n\n  private getNestedValue(obj: any, path: string): any {\n    return path.split('.').reduce((current, key) => current?.[key], obj);\n  }\n}\n\nexport const patientCacheService = new PatientCacheService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-mappers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-search.service.ts","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\(.","line":232,"column":62,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":232,"endColumn":63,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6947,6948],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6947,6947],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\).","line":232,"column":64,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":232,"endColumn":65,"suggestions":[{"messageId":"removeEscape","fix":{"range":[6949,6950],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[6949,6949],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Search Service\n * @fileoverview Handles patient search, filtering, and matching operations\n * @version 1.0.0\n */\n\nimport { Patient } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport { PatientFilters } from '../../types/patient';\nimport Fuse from 'fuse.js';\n\nexport interface PatientSearchResult {\n  patients: Patient[];\n  total: number;\n  page: number;\n  pageSize: number;\n  hasMore: boolean;\n}\n\nexport interface PatientMatchCandidate {\n  patient: Patient;\n  score: number;\n  matchedFields: string[];\n  confidence: 'high' | 'medium' | 'low';\n}\n\nexport interface PatientMatchRequest {\n  firstName?: string;\n  lastName?: string;\n  tcNo?: string;\n  phone?: string;\n  birthDate?: string;\n}\n\nexport class PatientSearchService {\n  private fuseInstance: Fuse<Patient> | null = null;\n\n  constructor() {\n    this.initializeFuse();\n  }\n\n  private initializeFuse(): void {\n    const fuseOptions = {\n      keys: [\n        { name: 'firstName', weight: 0.3 },\n        { name: 'lastName', weight: 0.3 },\n        { name: 'phone', weight: 0.2 },\n        { name: 'tcNumber', weight: 0.15 },\n        { name: 'email', weight: 0.1 },\n        { name: 'tags', weight: 0.05 }\n      ],\n      threshold: 0.3,\n      includeScore: true,\n      includeMatches: true,\n      minMatchCharLength: 2\n    };\n\n    this.fuseInstance = new Fuse([], fuseOptions);\n  }\n\n  updateSearchIndex(patients: Patient[]): void {\n    if (this.fuseInstance) {\n      this.fuseInstance.setCollection(patients);\n    }\n  }\n\n  searchPatients(patients: Patient[], filters: PatientFilters = {}): PatientSearchResult {\n    let filteredPatients = [...patients];\n\n    // Apply text search first\n    if (filters.search && filters.search.trim()) {\n      if (this.fuseInstance) {\n        const searchResults = this.fuseInstance.search(filters.search.trim());\n        filteredPatients = searchResults.map(result => result.item);\n      } else {\n        // Fallback to simple text search\n        const searchTerm = filters.search.toLowerCase();\n        filteredPatients = patients.filter(patient => \n          patient.firstName?.toLowerCase().includes(searchTerm) ||\n          patient.lastName?.toLowerCase().includes(searchTerm) ||\n          patient.phone?.includes(searchTerm) ||\n          patient.tcNumber?.includes(searchTerm) ||\n          patient.email?.toLowerCase().includes(searchTerm)\n        );\n      }\n    }\n\n    // Apply filters\n    filteredPatients = this.applyFilters(filteredPatients, filters);\n\n    // Apply pagination\n    const page = filters.page || 1;\n    const limit = filters.limit || 50;\n    const startIndex = (page - 1) * limit;\n    const endIndex = startIndex + limit;\n    const paginatedPatients = filteredPatients.slice(startIndex, endIndex);\n\n    return {\n      patients: paginatedPatients,\n      total: filteredPatients.length,\n      page,\n      pageSize: limit,\n      hasMore: endIndex < filteredPatients.length\n    };\n  }\n\n  private applyFilters(patients: Patient[], filters: PatientFilters): Patient[] {\n    return patients.filter(patient => {\n      // Status filter\n      if (filters.status && patient.status !== filters.status) {\n        return false;\n      }\n\n      // Segment filter\n      if (filters.segment && patient.segment !== filters.segment) {\n        return false;\n      }\n\n      // Acquisition type filter\n      if (filters.acquisitionType && patient.acquisitionType !== filters.acquisitionType) {\n        return false;\n      }\n\n      // Tags filter\n      if (filters.tags && filters.tags.length > 0) {\n        const hasMatchingTag = filters.tags.some(tag =>\n          patient.tags?.includes(tag)\n        );\n        if (!hasMatchingTag) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  }\n\n  findMatches(request: PatientMatchRequest, patients: Patient[]): PatientMatchCandidate[] {\n    const candidates: PatientMatchCandidate[] = [];\n\n    for (const patient of patients) {\n      const match = this.calculatePatientMatch(request, patient);\n      if (match.score > 0.3) { // Only include matches above threshold\n        candidates.push(match);\n      }\n    }\n\n    // Sort by score descending\n    return candidates.sort((a, b) => b.score - a.score);\n  }\n\n  private calculatePatientMatch(request: PatientMatchRequest, patient: Patient): PatientMatchCandidate {\n    let totalScore = 0;\n    let maxPossibleScore = 0;\n    const matchedFields: string[] = [];\n\n    // Name matching (weight: 0.4) - using firstName and lastName\n    if ((request.firstName || request.lastName) && (patient.firstName || patient.lastName)) {\n      const requestFullName = `${request.firstName || ''} ${request.lastName || ''}`.trim();\n      const patientFullName = `${patient.firstName || ''} ${patient.lastName || ''}`.trim();\n      const nameScore = this.calculateStringSimilarity(requestFullName, patientFullName);\n      totalScore += nameScore * 0.4;\n      maxPossibleScore += 0.4;\n      if (nameScore > 0.7) {\n        matchedFields.push('name');\n      }\n    }\n\n    // TC Number matching (weight: 0.3)\n    if (request.tcNo && patient.tcNumber) {\n      const tcScore = request.tcNo === patient.tcNumber ? 1 : 0;\n      totalScore += tcScore * 0.3;\n      maxPossibleScore += 0.3;\n      if (tcScore > 0) {\n        matchedFields.push('tcNumber');\n      }\n    }\n\n    // Phone matching (weight: 0.2)\n    if (request.phone && patient.phone) {\n      const phoneScore = this.calculatePhoneSimilarity(request.phone, patient.phone);\n      totalScore += phoneScore * 0.2;\n      maxPossibleScore += 0.2;\n      if (phoneScore > 0.8) {\n        matchedFields.push('phone');\n      }\n    }\n\n    // Birth date matching (weight: 0.1)\n    if (request.birthDate && patient.birthDate) {\n      const birthDateScore = request.birthDate === patient.birthDate ? 1 : 0;\n      totalScore += birthDateScore * 0.1;\n      maxPossibleScore += 0.1;\n      if (birthDateScore > 0) {\n        matchedFields.push('birthDate');\n      }\n    }\n\n    // Normalize score\n    const normalizedScore = maxPossibleScore > 0 ? totalScore / maxPossibleScore : 0;\n\n    // Determine confidence level\n    let confidence: 'high' | 'medium' | 'low' = 'low';\n    if (normalizedScore > 0.8) {\n      confidence = 'high';\n    } else if (normalizedScore > 0.6) {\n      confidence = 'medium';\n    }\n\n    return {\n      patient,\n      score: normalizedScore,\n      matchedFields,\n      confidence\n    };\n  }\n\n  private calculateStringSimilarity(str1: string, str2: string): number {\n    const s1 = str1.toLowerCase().trim();\n    const s2 = str2.toLowerCase().trim();\n    \n    if (s1 === s2) return 1;\n    \n    const maxLength = Math.max(s1.length, s2.length);\n    if (maxLength === 0) return 1;\n    \n    const distance = this.levenshteinDistance(s1, s2);\n    return 1 - (distance / maxLength);\n  }\n\n  private calculatePhoneSimilarity(phone1: string, phone2: string): number {\n    // Normalize phone numbers (remove spaces, dashes, parentheses)\n    const normalize = (phone: string) => phone.replace(/[\\s\\-\\(\\)]/g, '');\n    \n    const p1 = normalize(phone1);\n    const p2 = normalize(phone2);\n    \n    // Exact match\n    if (p1 === p2) return 1;\n    \n    // Check if one is a substring of the other (for international vs local format)\n    if (p1.includes(p2) || p2.includes(p1)) return 0.9;\n    \n    // Use string similarity as fallback\n    return this.calculateStringSimilarity(p1, p2);\n  }\n\n  private levenshteinDistance(str1: string, str2: string): number {\n    const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));\n\n    for (let i = 0; i <= str1.length; i++) {\n      matrix[0][i] = i;\n    }\n\n    for (let j = 0; j <= str2.length; j++) {\n      matrix[j][0] = j;\n    }\n\n    for (let j = 1; j <= str2.length; j++) {\n      for (let i = 1; i <= str1.length; i++) {\n        const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;\n        matrix[j][i] = Math.min(\n          matrix[j][i - 1] + 1, // deletion\n          matrix[j - 1][i] + 1, // insertion\n          matrix[j - 1][i - 1] + indicator // substitution\n        );\n      }\n    }\n\n    return matrix[str2.length][str1.length];\n  }\n}\n\nexport const patientSearchService = new PatientSearchService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-storage.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-sync.service.ts","messages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":139,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":139,"endColumn":90},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'batchSize' is assigned a value but never used.","line":217,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":217,"endColumn":22}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Sync Service\n * @fileoverview Handles patient data synchronization between local storage and API\n * @version 1.0.0\n */\n\nimport type { Patient as OrvalPatient } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\nimport { indexedDBManager } from '../../utils/indexeddb';\nimport { outbox, OutboxOperation } from '../../utils/outbox';\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/xEarCRMAPIAutoGenerated';\n\nexport interface SyncResult {\n  success: boolean;\n  synced: number;\n  failed: number;\n  conflicts: SyncConflict[];\n  lastSyncTime: string;\n}\n\nexport interface SyncConflict {\n  patientId: string;\n  localVersion: OrvalPatient;\n  remoteVersion: OrvalPatient;\n  conflictType: 'update' | 'delete' | 'create';\n  resolution?: 'local' | 'remote' | 'merge';\n}\n\nexport interface SyncOptions {\n  force?: boolean;\n  conflictResolution?: 'local' | 'remote' | 'prompt';\n  batchSize?: number;\n  since?: string;\n}\n\nexport class PatientSyncService {\n  private readonly SYNC_KEY = 'patient_last_sync';\n  private readonly BATCH_SIZE = 50;\n  private syncInProgress = false;\n  private api = getXEarCRMAPIAutoGenerated();\n\n  async syncPatients(options: SyncOptions = {}): Promise<SyncResult> {\n    if (this.syncInProgress) {\n      throw new Error('Sync already in progress');\n    }\n\n    this.syncInProgress = true;\n\n    try {\n      const result = await this.performSync(options);\n      await this.updateLastSyncTime();\n      return result;\n    } finally {\n      this.syncInProgress = false;\n    }\n  }\n\n  async syncSinglePatient(patientId: string, options: SyncOptions = {}): Promise<boolean> {\n    try {\n      // Get local patient\n      const localPatient = await indexedDBManager.getPatient(patientId);\n      if (!localPatient) {\n        throw new Error(`Patient ${patientId} not found locally`);\n      }\n\n      // Check if there are pending changes in outbox\n      const pendingOperations = await outbox.getPendingOperations();\n      const patientOperations = pendingOperations.filter(op =>\n        op.endpoint.includes(`/patients/${patientId}`) ||\n        (op.data && typeof op.data === 'object' && 'id' in op.data && op.data.id === patientId)\n      );\n\n      if (patientOperations.length > 0 && !options.force) {\n        // Push pending changes first\n        await this.pushPendingChanges([patientId]);\n      }\n\n      // Pull latest from server\n      await this.pullPatientFromServer(patientId);\n\n      return true;\n    } catch (error) {\n      console.error(`Failed to sync patient ${patientId}:`, error);\n      return false;\n    }\n  }\n\n  async getLastSyncTime(): Promise<string | null> {\n    try {\n      const lastSync = await indexedDBManager.getCache(this.SYNC_KEY);\n      return typeof lastSync === 'string' ? lastSync : null;\n    } catch (error) {\n      console.error('Failed to get last sync time:', error);\n      return null;\n    }\n  }\n\n  async getPendingSyncCount(): Promise<number> {\n    try {\n      const pendingOperations = await outbox.getPendingOperations();\n      return pendingOperations.filter(op => op.endpoint.includes('/patients')).length;\n    } catch (error) {\n      console.error('Failed to get pending sync count:', error);\n      return 0;\n    }\n  }\n\n  async hasPendingChanges(patientId?: string): Promise<boolean> {\n    try {\n      const pendingOperations = await outbox.getPendingOperations();\n\n      if (patientId) {\n        return pendingOperations.some(op =>\n          op.endpoint.includes(`/patients/${patientId}`) ||\n          (op.data && typeof op.data === 'object' && 'id' in op.data && op.data.id === patientId)\n        );\n      } else {\n        return pendingOperations.some(op => op.endpoint.includes('/patients'));\n      }\n    } catch (error) {\n      console.error('Failed to check pending changes:', error);\n      return false;\n    }\n  }\n\n  async resolveConflict(conflict: SyncConflict, resolution: 'local' | 'remote' | 'merge'): Promise<OrvalPatient> {\n    switch (resolution) {\n      case 'local':\n        // Keep local version, push to server\n        await this.pushPatientToServer(conflict.localVersion);\n        return conflict.localVersion;\n\n      case 'remote':\n        // Keep remote version, update local\n        await indexedDBManager.updatePatient(conflict.remoteVersion);\n        return conflict.remoteVersion;\n\n      case 'merge':\n        // Merge both versions (last-write-wins for most fields)\n        const merged = this.mergePatients(conflict.localVersion, conflict.remoteVersion);\n        await indexedDBManager.updatePatient(merged);\n        await this.pushPatientToServer(merged);\n        return merged;\n\n      default:\n        throw new Error(`Invalid conflict resolution: ${resolution}`);\n    }\n  }\n\n  private async performSync(options: SyncOptions): Promise<SyncResult> {\n    const result: SyncResult = {\n      success: false,\n      synced: 0,\n      failed: 0,\n      conflicts: [],\n      lastSyncTime: new Date().toISOString()\n    };\n\n    try {\n      // Step 1: Push pending changes\n      const pushResult = await this.pushPendingChanges();\n\n      // Step 2: Pull remote changes\n      const pullResult = await this.pullRemoteChanges(options);\n\n      result.synced = (pushResult.synced || 0) + (pullResult.synced || 0);\n      result.failed = (pushResult.failed || 0) + (pullResult.failed || 0);\n      result.conflicts = [...(pushResult.conflicts || []), ...(pullResult.conflicts || [])];\n      result.success = result.failed === 0 && result.conflicts.length === 0;\n\n      return result;\n    } catch (error) {\n      console.error('Sync failed:', error);\n      result.success = false;\n      return result;\n    }\n  }\n\n  private async pushPendingChanges(patientIds?: string[]): Promise<Partial<SyncResult>> {\n    const result = { synced: 0, failed: 0, conflicts: [] as SyncConflict[] };\n\n    try {\n      const pendingOperations = await outbox.getPendingOperations();\n      const patientOperations = pendingOperations.filter(op => {\n        if (patientIds) {\n          return patientIds.some(id =>\n            op.endpoint.includes(`/patients/${id}`) ||\n            (op.data && typeof op.data === 'object' && 'id' in op.data && op.data.id === id)\n          );\n        }\n        return op.endpoint.includes('/patients');\n      });\n\n      for (const operation of patientOperations) {\n        try {\n          await this.processPendingOperation(operation);\n          result.synced++;\n        } catch (error) {\n          console.error(`Failed to process operation ${operation.id}:`, error);\n          result.failed++;\n        }\n      }\n    } catch (error) {\n      console.error('Failed to push pending changes:', error);\n    }\n\n    return result;\n  }\n\n  private async pullRemoteChanges(options: SyncOptions): Promise<Partial<SyncResult>> {\n    const result: Partial<SyncResult> = {\n      synced: 0,\n      failed: 0,\n      conflicts: []\n    };\n\n    try {\n      const batchSize = options.batchSize || this.BATCH_SIZE;\n\n      // Use Orval generated API for fetching patients\n      const response = await this.api.patientsGetPatients();\n      const patients = response.data?.data;\n\n      if (patients && patients.length > 0) {\n        for (const remotePatient of patients) {\n          try {\n            const syncResult = await this.syncRemotePatient(remotePatient, options);\n            if (syncResult.conflict) {\n              result.conflicts!.push(syncResult.conflict);\n            } else {\n              result.synced!++;\n            }\n          } catch (error) {\n            console.error('Failed to sync patient:', error);\n            result.failed!++;\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Failed to pull remote changes:', error);\n    }\n\n    return result;\n  }\n\n  private async syncRemotePatient(remotePatient: OrvalPatient, options: SyncOptions): Promise<{ conflict?: SyncConflict }> {\n    if (!remotePatient.id) {\n      console.error('Remote patient missing ID, skipping sync');\n      return {};\n    }\n\n    const localPatient = await indexedDBManager.getPatient(remotePatient.id);\n\n    if (!localPatient) {\n      // New patient from server\n      await indexedDBManager.updatePatient(remotePatient);\n      return {};\n    }\n\n    // Check for conflicts\n    const hasLocalChanges = await this.hasPendingChanges(remotePatient.id);\n    const isLocalNewer = new Date(localPatient.updatedAt || '') > new Date(remotePatient.updatedAt || '');\n\n    if (hasLocalChanges || isLocalNewer) {\n      // Conflict detected\n      const conflict: SyncConflict = {\n        patientId: remotePatient.id,\n        localVersion: localPatient,\n        remoteVersion: remotePatient,\n        conflictType: 'update'\n      };\n\n      if (options.conflictResolution && options.conflictResolution !== 'prompt') {\n        await this.resolveConflict(conflict, options.conflictResolution);\n        return {};\n      }\n\n      return { conflict };\n    }\n\n    // No conflict, update local\n    await indexedDBManager.updatePatient(remotePatient);\n    return {};\n  }\n\n  private async processPendingOperation(operation: OutboxOperation): Promise<void> {\n    // This would typically involve making API calls based on the operation\n    // For now, we'll just log it as the actual API integration would be complex\n    console.log('Processing pending operation:', operation.id, operation.method, operation.endpoint);\n  }\n\n  private async pushPatientToServer(patient: OrvalPatient): Promise<void> {\n    // Add operation to outbox for sync\n    await outbox.addOperation({\n      method: 'PUT',\n      endpoint: `/api/patients/${patient.id}`,\n      data: patient,\n      headers: {\n        'Idempotency-Key': `update-patient-${patient.id}-${Date.now()}`\n      }\n    });\n  }\n\n  private async pullPatientFromServer(patientId: string): Promise<void> {\n    // Implementation would fetch patient from API\n    // This is a placeholder for the actual API integration\n    console.log('Pulling patient from server:', patientId);\n  }\n\n  private mergePatients(local: OrvalPatient, remote: OrvalPatient): OrvalPatient {\n    // Simple last-write-wins merge strategy\n    // In a real implementation, you might want more sophisticated merging\n    const localTime = new Date(local.updatedAt || '').getTime();\n    const remoteTime = new Date(remote.updatedAt || '').getTime();\n\n    if (localTime > remoteTime) {\n      return { ...remote, ...local, updatedAt: new Date().toISOString() };\n    } else {\n      return { ...local, ...remote, updatedAt: new Date().toISOString() };\n    }\n  }\n\n  private async updateLastSyncTime(): Promise<void> {\n    try {\n      await indexedDBManager.setCache(this.SYNC_KEY, new Date().toISOString());\n    } catch (error) {\n      console.error('Failed to update last sync time:', error);\n    }\n  }\n}\n\nexport const patientSyncService = new PatientSyncService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient-validation.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'warnings' is defined but never used.","line":167,"column":86,"nodeType":"Identifier","messageId":"unusedVar","endLine":167,"endColumn":115}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Validation Service\n * @fileoverview Handles patient data validation and business rules\n * @version 1.0.0\n */\n\nimport type { Patient as OrvalPatient } from '../../api/generated/xEarCRMAPIAutoGenerated.schemas';\n\nexport interface ValidationResult {\n  isValid: boolean;\n  errors: ValidationError[];\n  warnings: ValidationWarning[];\n}\n\nexport interface ValidationError {\n  field: string;\n  code: string;\n  message: string;\n  severity: 'error' | 'warning';\n}\n\nexport interface ValidationWarning {\n  field: string;\n  code: string;\n  message: string;\n  suggestion?: string;\n}\n\nexport class PatientValidationService {\n\n  validatePatient(patient: Partial<OrvalPatient>, existingPatients: OrvalPatient[] = []): ValidationResult {\n    const errors: ValidationError[] = [];\n    const warnings: ValidationWarning[] = [];\n\n    // Required field validations\n    this.validateRequiredFields(patient, errors);\n\n    // Format validations\n    this.validateFormats(patient, errors, warnings);\n\n    // Business rule validations\n    this.validateBusinessRules(patient, errors, warnings);\n\n    // Uniqueness validations\n    this.validateUniqueness(patient, existingPatients, errors);\n\n    return {\n      isValid: errors.filter(e => e.severity === 'error').length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  validateTcNumber(tcNumber: string, excludePatientId?: string, existingPatients: OrvalPatient[] = []): boolean {\n    // Basic format check\n    if (!tcNumber || tcNumber.length !== 11) {\n      return false;\n    }\n\n    // Must be all digits\n    if (!/^\\d{11}$/.test(tcNumber)) {\n      return false;\n    }\n\n    // TC Number algorithm validation\n    if (!this.isValidTcNumberAlgorithm(tcNumber)) {\n      return false;\n    }\n\n    // Check uniqueness\n    const existingPatient = existingPatients.find(p =>\n      p.tcNumber === tcNumber && p.id !== excludePatientId\n    );\n\n    return !existingPatient;\n  }\n\n  validatePhone(phone: string): boolean {\n    if (!phone) return false;\n\n    // Remove all non-digit characters\n    const cleanPhone = phone.replace(/\\D/g, '');\n\n    // Turkish phone number validation\n    // Mobile: 5XX XXX XX XX (10 digits starting with 5)\n    // Landline: 2XX XXX XX XX or 3XX XXX XX XX (10 digits starting with 2 or 3)\n    // With country code: +90 or 0090 prefix\n\n    if (cleanPhone.length === 10) {\n      // Local format: 5XXXXXXXXX or 2XXXXXXXXX or 3XXXXXXXXX\n      return /^[235]\\d{9}$/.test(cleanPhone);\n    } else if (cleanPhone.length === 11) {\n      // With leading 0: 05XXXXXXXXX or 02XXXXXXXXX or 03XXXXXXXXX\n      return /^0[235]\\d{9}$/.test(cleanPhone);\n    } else if (cleanPhone.length === 12) {\n      // With country code: 905XXXXXXXXX or 902XXXXXXXXX or 903XXXXXXXXX\n      return /^90[235]\\d{9}$/.test(cleanPhone);\n    } else if (cleanPhone.length === 13) {\n      // With 00 prefix: 0090XXXXXXXXXX\n      return /^0090[235]\\d{9}$/.test(cleanPhone);\n    }\n\n    return false;\n  }\n\n  validateEmail(email: string): boolean {\n    if (!email) return true; // Email is optional\n\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email);\n  }\n\n  validateBirthDate(birthDate: string): boolean {\n    if (!birthDate) return true; // Birth date is optional\n\n    const date = new Date(birthDate);\n    const now = new Date();\n\n    // Must be a valid date\n    if (isNaN(date.getTime())) {\n      return false;\n    }\n\n    // Must be in the past\n    if (date >= now) {\n      return false;\n    }\n\n    // Must be reasonable (not more than 120 years ago)\n    const maxAge = new Date();\n    maxAge.setFullYear(maxAge.getFullYear() - 120);\n\n    return date >= maxAge;\n  }\n\n  private validateRequiredFields(patient: Partial<OrvalPatient>, errors: ValidationError[]): void {\n    // Phone is required\n    if (!patient.phone || !patient.phone.trim()) {\n      errors.push({\n        field: 'phone',\n        code: 'REQUIRED',\n        message: 'Telefon numarası zorunludur',\n        severity: 'error'\n      });\n    }\n\n    // Name is required (firstName and lastName)\n    if (!patient.firstName || !patient.firstName.trim()) {\n      errors.push({\n        field: 'firstName',\n        code: 'REQUIRED',\n        message: 'Hasta adı zorunludur',\n        severity: 'error'\n      });\n    }\n\n    if (!patient.lastName || !patient.lastName.trim()) {\n      errors.push({\n        field: 'lastName',\n        code: 'REQUIRED',\n        message: 'Hasta soyadı zorunludur',\n        severity: 'error'\n      });\n    }\n  }\n\n  private validateFormats(patient: Partial<OrvalPatient>, errors: ValidationError[], warnings: ValidationWarning[]): void {\n    // Phone format validation\n    if (patient.phone && !this.validatePhone(patient.phone)) {\n      errors.push({\n        field: 'phone',\n        code: 'INVALID_FORMAT',\n        message: 'Geçersiz telefon numarası formatı',\n        severity: 'error'\n      });\n    }\n\n    // TC Number format validation\n    if (patient.tcNumber && !this.isValidTcNumberAlgorithm(patient.tcNumber)) {\n      errors.push({\n        field: 'tcNumber',\n        code: 'INVALID_FORMAT',\n        message: 'Geçersiz TC Kimlik Numarası',\n        severity: 'error'\n      });\n    }\n\n    // Email format validation\n    if (patient.email && !this.validateEmail(patient.email)) {\n      errors.push({\n        field: 'email',\n        code: 'INVALID_FORMAT',\n        message: 'Geçersiz e-posta adresi formatı',\n        severity: 'error'\n      });\n    }\n\n    // Birth date validation\n    if (patient.birthDate && !this.validateBirthDate(patient.birthDate)) {\n      errors.push({\n        field: 'birthDate',\n        code: 'INVALID_DATE',\n        message: 'Geçersiz doğum tarihi',\n        severity: 'error'\n      });\n    }\n  }\n\n  private validateBusinessRules(patient: Partial<OrvalPatient>, errors: ValidationError[], warnings: ValidationWarning[]): void {\n    // Age-related warnings\n    if (patient.birthDate) {\n      const age = this.calculateAge(patient.birthDate);\n\n      if (age < 18) {\n        warnings.push({\n          field: 'birthDate',\n          code: 'MINOR_PATIENT',\n          message: 'Hasta 18 yaşından küçük',\n          suggestion: 'Veli bilgilerini eklemeyi unutmayın'\n        });\n      }\n\n      if (age > 90) {\n        warnings.push({\n          field: 'birthDate',\n          code: 'ELDERLY_PATIENT',\n          message: 'Hasta 90 yaşından büyük',\n          suggestion: 'Yaş bilgisini kontrol edin'\n        });\n      }\n    }\n\n    // Status consistency checks - archived status no longer exists\n    // if (patient.status === 'archived' && patient.segment !== 'renewal') {\n    //   warnings.push({\n    //     field: 'status',\n    //     code: 'STATUS_SEGMENT_MISMATCH',\n    //     message: 'Arşivlenmiş hasta için segment uyumsuzluğu',\n    //     suggestion: 'Segment bilgisini kontrol edin'\n    //   });\n    // }\n\n    // Device-related validations are now handled separately\n    // These fields no longer exist in Orval Patient\n  }\n\n  private validateUniqueness(patient: Partial<OrvalPatient>, existingPatients: OrvalPatient[], errors: ValidationError[]): void {\n    // TC Number uniqueness\n    if (patient.tcNumber) {\n      const duplicate = existingPatients.find(p =>\n        p.tcNumber === patient.tcNumber && p.id !== patient.id\n      );\n\n      if (duplicate) {\n        const duplicateName = `${duplicate.firstName || ''} ${duplicate.lastName || ''}`.trim();\n        errors.push({\n          field: 'tcNumber',\n          code: 'DUPLICATE',\n          message: `Bu TC Kimlik Numarası başka bir hasta tarafından kullanılıyor: ${duplicateName}`,\n          severity: 'error'\n        });\n      }\n    }\n\n    // Phone uniqueness (warning only, as family members might share phones)\n    if (patient.phone) {\n      const duplicate = existingPatients.find(p =>\n        p.phone === patient.phone && p.id !== patient.id\n      );\n\n      if (duplicate) {\n        const duplicateName = `${duplicate.firstName || ''} ${duplicate.lastName || ''}`.trim();\n        errors.push({\n          field: 'phone',\n          code: 'DUPLICATE_WARNING',\n          message: `Bu telefon numarası başka bir hasta tarafından kullanılıyor: ${duplicateName}`,\n          severity: 'warning'\n        });\n      }\n    }\n  }\n\n  private isValidTcNumberAlgorithm(tcNumber: string): boolean {\n    if (!tcNumber || tcNumber.length !== 11) return false;\n\n    const digits = tcNumber.split('').map(Number);\n\n    // First digit cannot be 0\n    if (digits[0] === 0) return false;\n\n    // Calculate check digits\n    const oddSum = digits[0] + digits[2] + digits[4] + digits[6] + digits[8];\n    const evenSum = digits[1] + digits[3] + digits[5] + digits[7];\n\n    const check1 = ((oddSum * 7) - evenSum) % 10;\n    const check2 = (oddSum + evenSum + digits[9]) % 10;\n\n    return digits[9] === check1 && digits[10] === check2;\n  }\n\n  private calculateAge(birthDate: string): number {\n    const birth = new Date(birthDate);\n    const today = new Date();\n\n    let age = today.getFullYear() - birth.getFullYear();\n    const monthDiff = today.getMonth() - birth.getMonth();\n\n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {\n      age--;\n    }\n\n    return age;\n  }\n}\n\nexport const patientValidationService = new PatientValidationService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/patient/patient.api.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[458,461],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[458,461],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[647,650],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[647,650],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[845,848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[845,848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1057,1060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1057,1060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1179,1182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1179,1182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1425,1428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1425,1428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1575,1578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1575,1578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Thin API wrapper for patients that uses Orval generated client.\n// Purpose: single responsibility file that re-exports generated methods and\n// adapts shapes only when necessary. No manual fetch()\n\nimport { getXEarCRMAPIAutoGenerated } from '../../api/generated/xEarCRMAPIAutoGenerated';\nimport type { CreatePatientBody } from '../../types/patient/patient.types';\n\nconst api = getXEarCRMAPIAutoGenerated();\n\nexport const patientsApi = {\n  list: (params?: any) => api.patientsGetPatients(params),\n  create: (data: CreatePatientBody) => api.patientsCreatePatient(data),\n  delete: (id: string) => api.patientsDeletePatient(id),\n  search: (query?: any) => api.patientsSearchPatients(query),\n  \n  // Timeline operations\n  getTimeline: (patientId: string) => api.timelineGetPatientTimeline(patientId),\n  addTimelineEvent: (patientId: string, data: any) => api.timelineAddTimelineEvent(patientId, data),\n  deleteTimelineEvent: (patientId: string, eventId: string) => api.timelineDeleteTimelineEvent(patientId, eventId),\n  logActivity: (patientId: string, data: any) => api.timelineLogPatientActivity(patientId, data),\n  \n  // Notes operations\n  createNote: (patientId: string, data: any) => api.timelineAddTimelineEvent(patientId, data),\n  deleteNote: (patientId: string, noteId: string) => api.timelineDeleteTimelineEvent(patientId, noteId),\n  \n  // Sales operations\n  getSales: () => api.salesListSales(),\n  createSale: (data: any) => api.salesCreateSale(data),\n  deleteSale: (saleId: string) => api.salesDeleteSale(saleId),\n  \n  // SGK operations\n  uploadSgkDocument: (data?: any) => api.sgkUploadSgkDocument(data),\n  deleteSgkDocument: (documentId: string) => api.sgkDeleteSgkDocument(documentId),\n};\n\nexport default patientsApi;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/purchase.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'xmlData' is defined but never used.","line":313,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":313,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'fileName' is defined but never used.","line":313,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":313,"endColumn":67}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Purchase, PurchaseItem, PurchaseStatus, PurchaseFilters, PurchaseSearchResult, CreatePurchaseData, UpdatePurchaseData, PurchaseStats, PurchaseCalculation, PurchaseValidation } from '../types/purchase';\nimport { outbox } from '../utils/outbox';\nimport { PURCHASES_DATA } from '../constants/storage-keys';\n\nexport class PurchaseService {\n  // Storage methods\n  private async loadPurchases(): Promise<Purchase[]> {\n    try {\n      const data = localStorage.getItem(PURCHASES_DATA);\n      if (!data) {\n        const samplePurchases = this.createSamplePurchases();\n        await this.savePurchases(samplePurchases);\n        return samplePurchases;\n      }\n      return JSON.parse(data);\n    } catch (error) {\n      console.error('Error loading purchases:', error);\n      return [];\n    }\n  }\n\n  private async savePurchases(purchases: Purchase[]): Promise<void> {\n    try {\n      localStorage.setItem(PURCHASES_DATA, JSON.stringify(purchases));\n    } catch (error) {\n      console.error('Error saving purchases:', error);\n      throw error;\n    }\n  }\n\n  // Sample data creation\n  private createSamplePurchases(): Purchase[] {\n    return [\n      {\n        id: 'purchase-1',\n        purchaseNumber: 'AL202401001',\n        type: 'standard',\n        status: 'approved',\n        supplierName: 'ABC Medikal Ltd.',\n        supplierTaxNumber: '1234567890',\n        supplierAddress: 'İstanbul, Türkiye',\n        supplierPhone: '+90 212 123 45 67',\n        supplierEmail: 'info@abcmedikal.com',\n        issueDate: '2024-01-15',\n        dueDate: '2024-02-15',\n        paymentMethod: 'Kredi Kartı',\n        items: this.createSamplePurchaseItems(),\n        subtotal: 8500.00,\n        taxTotal: 1530.00,\n        grandTotal: 10030.00,\n        notes: 'Acil sipariş',\n        xmlData: '<xml>sample xml data</xml>',\n        xmlFileName: 'AL202401001.xml',\n        xmlImportDate: '2024-01-15T10:30:00Z',\n        createdAt: '2024-01-15T10:30:00Z'\n      }\n    ];\n  }\n\n  private createSamplePurchaseItems(): PurchaseItem[] {\n    return [\n      {\n        id: 'item-1',\n        name: 'Dijital Termometre',\n        description: 'Infrared dijital termometre',\n        quantity: 10,\n        unitPrice: 850.00,\n        taxRate: 18,\n        taxAmount: 153.00,\n        totalPrice: 1003.00,\n        unit: 'adet',\n        productCode: 'TERM001',\n        barcode: '1234567890123'\n      }\n    ];\n  }\n\n  // CRUD Operations\n  async createPurchase(data: CreatePurchaseData): Promise<Purchase> {\n    try {\n      // Calculate purchase items with proper IDs and totals\n      const calculatedItems: PurchaseItem[] = data.items.map(item => ({\n        ...item,\n        id: this.generateId(),\n        taxAmount: item.quantity * item.unitPrice * (item.taxRate / 100),\n        totalPrice: item.quantity * item.unitPrice * (1 + item.taxRate / 100)\n      }));\n\n      // Calculate totals\n      const calculation = this.calculatePurchase(calculatedItems);\n\n      const purchase: Purchase = {\n        id: this.generateId(),\n        purchaseNumber: this.generatePurchaseNumber(),\n        status: 'draft' as PurchaseStatus,\n        type: data.type,\n        supplierName: data.supplierName,\n        supplierTaxNumber: data.supplierTaxNumber,\n        supplierAddress: data.supplierAddress,\n        supplierPhone: data.supplierPhone,\n        supplierEmail: data.supplierEmail,\n        issueDate: data.issueDate,\n        dueDate: data.dueDate,\n        paymentMethod: data.paymentMethod,\n        items: calculatedItems,\n        subtotal: calculation.subtotal,\n        taxTotal: calculation.totalTax,\n        grandTotal: calculation.totalAmount,\n        notes: data.notes,\n        internalNotes: data.internalNotes,\n        referenceNumber: data.referenceNumber,\n        orderNumber: data.orderNumber,\n        xmlData: data.xmlData,\n        xmlFileName: data.xmlFileName,\n        xmlImportDate: data.xmlData ? new Date().toISOString() : undefined,\n        createdAt: new Date().toISOString()\n      };\n\n      const purchases = await this.loadPurchases();\n      purchases.push(purchase);\n      await this.savePurchases(purchases);\n\n      // Add to outbox for sync\n      await outbox.addOperation({\n        method: 'POST',\n        endpoint: '/api/purchases',\n        data: purchase\n      });\n\n      return purchase;\n    } catch (error) {\n      console.error('Error creating purchase:', error);\n      throw error;\n    }\n  }\n\n  async updatePurchase(id: string, data: UpdatePurchaseData): Promise<Purchase> {\n    try {\n      const purchases = await this.loadPurchases();\n      const index = purchases.findIndex(p => p.id === id);\n      \n      if (index === -1) {\n        throw new Error('Purchase not found');\n      }\n\n      // If items are being updated, calculate them properly\n      let calculatedItems = purchases[index].items;\n      if (data.items) {\n        calculatedItems = data.items.map(item => ({\n          ...item,\n          id: this.generateId(),\n          taxAmount: item.quantity * item.unitPrice * (item.taxRate / 100),\n          totalPrice: item.quantity * item.unitPrice * (1 + item.taxRate / 100)\n        }));\n      }\n\n      const updatedPurchase: Purchase = {\n        ...purchases[index],\n        ...data,\n        items: calculatedItems,\n        updatedAt: new Date().toISOString(),\n        updatedBy: 'current-user'\n      };\n\n      purchases[index] = updatedPurchase;\n      await this.savePurchases(purchases);\n\n      // Add to outbox for sync\n      await outbox.addOperation({\n        method: 'PUT',\n        endpoint: `/api/purchases/${id}`,\n        data: updatedPurchase\n      });\n\n      return updatedPurchase;\n    } catch (error) {\n      console.error('Error updating purchase:', error);\n      throw error;\n    }\n  }\n\n  async deletePurchase(id: string): Promise<void> {\n    try {\n      const purchases = await this.loadPurchases();\n      const filteredPurchases = purchases.filter(p => p.id !== id);\n      await this.savePurchases(filteredPurchases);\n\n      // Add to outbox for sync\n      await outbox.addOperation({\n        method: 'DELETE',\n        endpoint: `/api/purchases/${id}`,\n        data: { id }\n      });\n    } catch (error) {\n      console.error('Error deleting purchase:', error);\n      throw error;\n    }\n  }\n\n  // Query methods\n  async searchPurchases(filters: PurchaseFilters = {}): Promise<PurchaseSearchResult> {\n    try {\n      const purchases = await this.loadPurchases();\n      let filteredPurchases = [...purchases];\n\n      // Apply filters\n      if (filters.search) {\n        const searchLower = filters.search.toLowerCase();\n        filteredPurchases = filteredPurchases.filter(p =>\n          p.purchaseNumber.toLowerCase().includes(searchLower) ||\n          p.supplierName.toLowerCase().includes(searchLower) ||\n          p.notes?.toLowerCase().includes(searchLower)\n        );\n      }\n\n      if (filters.status) {\n        filteredPurchases = filteredPurchases.filter(p => p.status === filters.status);\n      }\n\n      if (filters.type) {\n        filteredPurchases = filteredPurchases.filter(p => p.type === filters.type);\n      }\n\n      if (filters.supplierName) {\n        filteredPurchases = filteredPurchases.filter(p => \n          p.supplierName.toLowerCase().includes(filters.supplierName!.toLowerCase())\n        );\n      }\n\n      if (filters.hasXmlData !== undefined) {\n        filteredPurchases = filteredPurchases.filter(p => \n          filters.hasXmlData ? !!p.xmlData : !p.xmlData\n        );\n      }\n\n      // Pagination\n      const page = filters.page || 1;\n      const limit = filters.limit || 10;\n      const startIndex = (page - 1) * limit;\n      const endIndex = startIndex + limit;\n      const paginatedPurchases = filteredPurchases.slice(startIndex, endIndex);\n\n      return {\n        purchases: paginatedPurchases,\n        total: filteredPurchases.length,\n        totalPages: Math.ceil(filteredPurchases.length / limit),\n        page,\n        pageSize: limit,\n        limit,\n        hasMore: endIndex < filteredPurchases.length,\n        filters\n      };\n    } catch (error) {\n      console.error('Error searching purchases:', error);\n      throw error;\n    }\n  }\n\n  async getPurchaseById(id: string): Promise<Purchase | null> {\n    try {\n      const purchases = await this.loadPurchases();\n      return purchases.find(p => p.id === id) || null;\n    } catch (error) {\n      console.error('Error getting purchase by ID:', error);\n      return null;\n    }\n  }\n\n  async getPurchaseStats(): Promise<PurchaseStats> {\n    try {\n      const purchases = await this.loadPurchases();\n      \n      const stats: PurchaseStats = {\n        total: purchases.length,\n        draft: purchases.filter(p => p.status === 'draft').length,\n        sent: purchases.filter(p => p.status === 'sent').length,\n        approved: purchases.filter(p => p.status === 'approved').length,\n        rejected: purchases.filter(p => p.status === 'rejected').length,\n        paid: purchases.filter(p => p.status === 'paid').length,\n        cancelled: purchases.filter(p => p.status === 'cancelled').length,\n        totalAmount: purchases.reduce((sum, p) => sum + p.grandTotal, 0),\n        xmlImported: purchases.filter(p => !!p.xmlData).length\n      };\n\n      return stats;\n    } catch (error) {\n      console.error('Error getting purchase stats:', error);\n      throw error;\n    }\n  }\n\n  // XML Import\n  async importFromXML(xmlData: string, fileName: string): Promise<Purchase> {\n    try {\n      // Parse XML and extract purchase data\n      const purchaseData = this.parseXMLToPurchaseData(xmlData, fileName);\n      \n      // Create purchase with XML data\n      const purchase = await this.createPurchase({\n        ...purchaseData,\n        xmlData,\n        xmlFileName: fileName,\n        xmlImportDate: new Date().toISOString()\n      });\n\n      return purchase;\n    } catch (error) {\n      console.error('Error importing from XML:', error);\n      throw error;\n    }\n  }\n\n  private parseXMLToPurchaseData(xmlData: string, fileName: string): CreatePurchaseData {\n    // Basic XML parsing - in real implementation, use proper XML parser\n    return {\n      type: 'standard',\n      supplierName: 'XML İçe Aktarılan Tedarikçi',\n      issueDate: new Date().toISOString().split('T')[0],\n      items: [\n        {\n          name: 'XML İçe Aktarılan Ürün',\n          quantity: 1,\n          unitPrice: 100,\n          taxRate: 18\n        }\n      ]\n    };\n  }\n\n  // Calculations\n  calculatePurchase(items: PurchaseItem[]): PurchaseCalculation {\n    const subtotal = items.reduce((sum, item) => sum + (item.quantity * item.unitPrice), 0);\n    const totalTax = items.reduce((sum, item) => sum + item.taxAmount, 0);\n    const totalAmount = subtotal + totalTax;\n\n    return {\n      items,\n      subtotal,\n      totalTax,\n      totalAmount\n    };\n  }\n\n  // Validation\n  validatePurchase(data: CreatePurchaseData): PurchaseValidation {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (!data.supplierName?.trim()) {\n      errors.push('Tedarikçi adı gereklidir');\n    }\n\n    if (!data.issueDate) {\n      errors.push('Fatura tarihi gereklidir');\n    }\n\n    if (!data.items || data.items.length === 0) {\n      errors.push('En az bir kalem gereklidir');\n    }\n\n    data.items?.forEach((item, index) => {\n      if (!item.name?.trim()) {\n        errors.push(`${index + 1}. kalem adı gereklidir`);\n      }\n      if (item.quantity <= 0) {\n        errors.push(`${index + 1}. kalem miktarı 0'dan büyük olmalıdır`);\n      }\n      if (item.unitPrice <= 0) {\n        errors.push(`${index + 1}. kalem birim fiyatı 0'dan büyük olmalıdır`);\n      }\n    });\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  // Utility methods\n  private generateId(): string {\n    return `purchase-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  private generatePurchaseNumber(): string {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, '0');\n    const day = String(date.getDate()).padStart(2, '0');\n    const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\n    return `AL${year}${month}${day}${random}`;\n  }\n}\n\nexport const purchaseService = new PurchaseService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/sgk.service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_patientId' is defined but never used.","line":593,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":593,"endColumn":45},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":692,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":692,"endColumn":84},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":698,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":698,"endColumn":90},{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":704,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":704,"endColumn":90},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":742,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":742,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21158,21161],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21158,21161],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":754,"column":108,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":754,"endColumn":111,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21583,21586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21583,21586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":769,"column":101,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":769,"endColumn":104,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22039,22042],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22039,22042],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":785,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":785,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22446,22449],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22446,22449],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// SGK Service for X-Ear CRM\n// Modern TypeScript service for SGK document management, workflow, and e-receipt processing\n\nimport {\n  SGKDocument,\n  SGKWorkflow,\n  SGKStatusEntry,\n  EReceipt,\n  UTSRecord,\n  SGKPatientInfo,\n  SGKDocumentFilters,\n  SGKSearchResult,\n  SGKStats,\n  OCRProcessingResult,\n  SGKDocumentFormData,\n  CreateSGKDocumentData,\n  UpdateSGKDocumentData,\n  CreateEReceiptData,\n  UpdateEReceiptData,\n  OCRProcessingRequest,\n  SGKWorkflowStatus,\n  EReceiptMaterial,\n  EReceiptFormData,\n  SGKValidation,\n  BulkSGKOperation,\n  BulkOperationResult\n} from '../types/sgk';\nimport { outbox, OutboxOperation } from '../utils/outbox';\nimport { SGK_DATA, SGK_DOCUMENTS } from '../constants/storage-keys';\nimport { getXEarCRMAPIAutoGenerated } from '../api/generated/api';\n\nexport class SGKService {\n  private documents: SGKDocument[] = [];\n  private workflows: SGKWorkflow[] = [];\n  private eReceipts: EReceipt[] = [];\n  private utsRecords: UTSRecord[] = [];\n  private initialized = false;\n  private api = getXEarCRMAPIAutoGenerated();\n\n  constructor() {\n    this.init();\n  }\n\n  private async init(): Promise<void> {\n    if (this.initialized) return;\n    \n    await this.loadData();\n    this.initialized = true;\n    \n    // Listen for storage changes\n    window.addEventListener('storage', this.handleStorageChange.bind(this));\n  }\n\n  private async loadData(): Promise<void> {\n    try {\n      // Load SGK documents\n      const documentsData = localStorage.getItem(SGK_DOCUMENTS);\n      if (documentsData) {\n        this.documents = JSON.parse(documentsData);\n      }\n\n      // Load workflows\n      const workflowsData = localStorage.getItem(SGK_DATA);\n      if (workflowsData) {\n        const data = JSON.parse(workflowsData);\n        this.workflows = data.workflows || [];\n        this.eReceipts = data.eReceipts || [];\n        this.utsRecords = data.utsRecords || [];\n      }\n\n      // Initialize with sample data if empty\n      if (this.documents.length === 0) {\n        await this.initializeSampleData();\n      }\n    } catch (error) {\n      console.error('Error loading SGK data:', error);\n      await this.initializeSampleData();\n    }\n  }\n\n  private async initializeSampleData(): Promise<void> {\n    const sampleDocuments: SGKDocument[] = [\n      {\n        id: 'sgk-doc-1',\n        patientId: 'patient-1',\n        filename: 'sgk-rapor-001.pdf',\n        documentType: 'rapor',\n        fileUrl: '/uploads/sgk-rapor-001.pdf',\n        fileSize: 245760,\n        mimeType: 'application/pdf',\n        ocrText: 'SGK Raporu - Hasta: Ahmet Yılmaz - TC: 12345678901',\n        extractedInfo: {\n          patientName: 'Ahmet Yılmaz',\n          tcNumber: '12345678901',\n          reportNumber: 'RPT-2024-001',\n          reportDate: '2024-01-15',\n          validityDate: '2024-07-15',\n          confidence: 0.95,\n          extractionMethod: 'ocr'\n        },\n        processingStatus: 'completed',\n        uploadedBy: 'user-1',\n        uploadedAt: '2024-01-15T10:00:00Z',\n        processedAt: '2024-01-15T10:05:00Z',\n        createdAt: '2024-01-15T10:00:00Z',\n        updatedAt: '2024-01-15T10:05:00Z'\n      }\n    ];\n\n    const sampleWorkflows: SGKWorkflow[] = [\n      {\n        id: 'workflow-1',\n        documentId: 'sgk-doc-1',\n        patientId: 'patient-1',\n        currentStatus: 'approved',\n        statusHistory: [\n          {\n            status: 'draft',\n            timestamp: '2024-01-15T10:00:00Z',\n            userId: 'user-1',\n            userName: 'Admin User'\n          },\n          {\n            status: 'submitted',\n            timestamp: '2024-01-15T11:00:00Z',\n            userId: 'user-1',\n            userName: 'Admin User'\n          },\n          {\n            status: 'approved',\n            timestamp: '2024-01-16T09:00:00Z',\n            systemGenerated: true\n          }\n        ],\n        submittedDate: '2024-01-15T11:00:00Z',\n        approvalDate: '2024-01-16T09:00:00Z',\n        deadline: '2024-02-15T23:59:59Z',\n        createdAt: '2024-01-15T10:00:00Z',\n        updatedAt: '2024-01-16T09:00:00Z',\n        createdBy: 'user-1'\n      }\n    ];\n\n    this.documents = sampleDocuments;\n    this.workflows = sampleWorkflows;\n    await this.saveData();\n  }\n\n  private async saveData(): Promise<void> {\n    try {\n      localStorage.setItem(SGK_DOCUMENTS, JSON.stringify(this.documents));\n      localStorage.setItem(SGK_DATA, JSON.stringify({\n        workflows: this.workflows,\n        eReceipts: this.eReceipts,\n        utsRecords: this.utsRecords\n      }));\n    } catch (error) {\n      console.error('Error saving SGK data:', error);\n    }\n  }\n\n  private handleStorageChange(event: StorageEvent): void {\n    if (event.key === SGK_DOCUMENTS || event.key === SGK_DATA) {\n      this.loadData();\n    }\n  }\n\n  // Document Management\n  async getDocuments(filters?: SGKDocumentFilters): Promise<SGKSearchResult> {\n    await this.init();\n\n    let filteredDocuments = [...this.documents];\n\n    if (filters) {\n      if (filters.patientId) {\n        filteredDocuments = filteredDocuments.filter(doc => doc.patientId === filters.patientId);\n      }\n\n      if (filters.documentType) {\n        filteredDocuments = filteredDocuments.filter(doc => doc.documentType === filters.documentType);\n      }\n\n      if (filters.status) {\n        filteredDocuments = filteredDocuments.filter(doc => {\n          const workflow = this.workflows.find(w => w.documentId === doc.id);\n          return workflow?.currentStatus === filters.status;\n        });\n      }\n\n      if (filters.processingStatus) {\n        filteredDocuments = filteredDocuments.filter(doc => doc.processingStatus === filters.processingStatus);\n      }\n\n      if (filters.search) {\n        const searchLower = filters.search.toLowerCase();\n        filteredDocuments = filteredDocuments.filter(doc =>\n          doc.filename.toLowerCase().includes(searchLower) ||\n          doc.ocrText?.toLowerCase().includes(searchLower) ||\n          doc.extractedInfo?.patientName?.toLowerCase().includes(searchLower)\n        );\n      }\n\n      if (filters.dateRange) {\n        const startDate = new Date(filters.dateRange.start);\n        const endDate = new Date(filters.dateRange.end);\n        filteredDocuments = filteredDocuments.filter(doc => {\n          const docDate = new Date(doc.createdAt);\n          return docDate >= startDate && docDate <= endDate;\n        });\n      }\n    }\n\n    // Sort by creation date (newest first)\n    filteredDocuments.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n\n    return {\n      documents: filteredDocuments,\n      total: filteredDocuments.length,\n      page: 1,\n      pageSize: filteredDocuments.length,\n      hasMore: false\n    };\n  }\n\n  async getDocument(id: string): Promise<SGKDocument | null> {\n    await this.init();\n    return this.documents.find(doc => doc.id === id) || null;\n  }\n\n  async createDocument(data: CreateSGKDocumentData): Promise<SGKDocument> {\n    await this.init();\n\n    const document: SGKDocument = {\n      ...data,\n      id: `sgk-doc-${Date.now()}`,\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString()\n    };\n\n    this.documents.push(document);\n    await this.saveData();\n\n    // Queue API call\n    const operation: OutboxOperation = {\n      method: 'POST',\n      endpoint: '/api/sgk/documents',\n      data: document,\n      headers: {\n        'Idempotency-Key': `create-sgk-doc-${document.id}-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n\n    return document;\n  }\n\n  async updateDocument(id: string, data: Partial<UpdateSGKDocumentData>): Promise<SGKDocument> {\n    await this.init();\n\n    const index = this.documents.findIndex(doc => doc.id === id);\n    if (index === -1) {\n      throw new Error('Document not found');\n    }\n\n    const updatedDocument = {\n      ...this.documents[index],\n      ...data,\n      updatedAt: new Date().toISOString()\n    };\n\n    this.documents[index] = updatedDocument;\n    await this.saveData();\n\n    // Queue API call\n    const operation: OutboxOperation = {\n      method: 'PUT',\n      endpoint: `/api/sgk/documents/${id}`,\n      data: updatedDocument,\n      headers: {\n        'Idempotency-Key': `update-sgk-doc-${id}-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n\n    return updatedDocument;\n  }\n\n  async deleteDocument(id: string): Promise<void> {\n    await this.init();\n\n    const index = this.documents.findIndex(doc => doc.id === id);\n    if (index === -1) {\n      throw new Error('Document not found');\n    }\n\n    this.documents.splice(index, 1);\n    \n    // Also remove associated workflow\n    const workflowIndex = this.workflows.findIndex(w => w.documentId === id);\n    if (workflowIndex !== -1) {\n      this.workflows.splice(workflowIndex, 1);\n    }\n\n    await this.saveData();\n\n    // Queue API call\n    const operation: OutboxOperation = {\n      method: 'DELETE',\n      endpoint: `/api/sgk/documents/${id}`,\n      headers: {\n        'Idempotency-Key': `delete-sgk-doc-${id}-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n  }\n\n  // OCR Processing\n  async processDocument(request: OCRProcessingRequest): Promise<OCRProcessingResult> {\n    await this.init();\n\n    // Queue OCR processing request\n    const operation: OutboxOperation = {\n      method: 'POST',\n      endpoint: '/api/ocr/process',\n      data: request,\n      headers: {\n        'Idempotency-Key': `ocr-process-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n\n    // Return mock result for offline functionality\n    return {\n      success: true,\n      extractedText: 'Mock OCR text extraction',\n      confidence: 0.85,\n      processingTime: 2500,\n      extractedInfo: {\n        patientName: 'Mock Patient',\n        confidence: 0.85,\n        extractionMethod: 'ocr'\n      }\n    };\n  }\n\n  // Legacy Workflow Management (kept for backward compatibility)\n  async getWorkflowLegacy(documentId: string): Promise<SGKWorkflow | null> {\n    await this.init();\n    return this.workflows.find(w => w.documentId === documentId) || null;\n  }\n\n  async updateWorkflowStatus(workflowId: string, status: SGKWorkflowStatus, notes?: string): Promise<SGKWorkflow> {\n    await this.init();\n\n    const index = this.workflows.findIndex(w => w.id === workflowId);\n    if (index === -1) {\n      throw new Error('Workflow not found');\n    }\n\n    const workflow = this.workflows[index];\n    const statusEntry: SGKStatusEntry = {\n      status,\n      timestamp: new Date().toISOString(),\n      notes,\n      userId: 'current-user',\n      userName: 'Current User'\n    };\n\n    workflow.currentStatus = status;\n    workflow.statusHistory.push(statusEntry);\n    workflow.updatedAt = new Date().toISOString();\n\n    // Update specific dates based on status\n    if (status === 'submitted') {\n      workflow.submittedDate = new Date().toISOString();\n    } else if (status === 'approved') {\n      workflow.approvalDate = new Date().toISOString();\n    } else if (status === 'paid') {\n      workflow.paymentDate = new Date().toISOString();\n    }\n\n    this.workflows[index] = workflow;\n    await this.saveData();\n\n    // Queue API call\n    const operation: OutboxOperation = {\n      method: 'PUT',\n      endpoint: `/api/sgk/workflows/${workflowId}/status`,\n      data: { status, notes },\n      headers: {\n        'Idempotency-Key': `update-workflow-${workflowId}-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n\n    return workflow;\n  }\n\n  // E-Receipt Management\n  async getEReceipts(patientId?: string): Promise<EReceipt[]> {\n    await this.init();\n\n    if (patientId) {\n      return this.eReceipts.filter(receipt => receipt.patientId === patientId);\n    }\n\n    return [...this.eReceipts];\n  }\n\n  async getEReceipt(id: string): Promise<EReceipt | null> {\n    await this.init();\n    return this.eReceipts.find(receipt => receipt.id === id) || null;\n  }\n\n  async createEReceipt(data: CreateEReceiptData): Promise<EReceipt> {\n    await this.init();\n\n    const eReceipt: EReceipt = {\n      ...data,\n      id: `ereceipt-${Date.now()}`,\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString()\n    };\n\n    this.eReceipts.push(eReceipt);\n    await this.saveData();\n\n    // Queue API call\n    const operation: OutboxOperation = {\n      method: 'POST',\n      endpoint: `/api/patients/${data.patientId}/ereceipts`,\n      data: eReceipt,\n      headers: {\n        'Idempotency-Key': `create-ereceipt-${eReceipt.id}-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n\n    return eReceipt;\n  }\n\n  async updateEReceipt(id: string, data: Partial<UpdateEReceiptData>): Promise<EReceipt> {\n    await this.init();\n\n    const index = this.eReceipts.findIndex(receipt => receipt.id === id);\n    if (index === -1) {\n      throw new Error('E-Receipt not found');\n    }\n\n    const updatedReceipt = {\n      ...this.eReceipts[index],\n      ...data,\n      updatedAt: new Date().toISOString()\n    };\n\n    this.eReceipts[index] = updatedReceipt;\n    await this.saveData();\n\n    // Queue API call\n    const operation: OutboxOperation = {\n      method: 'PUT',\n      endpoint: `/api/patients/${updatedReceipt.patientId}/ereceipts/${id}`,\n      data: updatedReceipt,\n      headers: {\n        'Idempotency-Key': `update-ereceipt-${id}-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n\n    return updatedReceipt;\n  }\n\n  async deliverMaterial(receiptId: string, materialId: string, deliveryData: {\n    ubbCompanyCode?: string;\n    deviceBarcode?: string;\n    deviceSerial?: string;\n    deliveryDate?: string;\n    notes?: string;\n  }): Promise<EReceiptMaterial> {\n    await this.init();\n\n    const receipt = this.eReceipts.find(r => r.id === receiptId);\n    if (!receipt) {\n      throw new Error('E-Receipt not found');\n    }\n\n    const materialIndex = receipt.materials.findIndex(m => m.id === materialId);\n    if (materialIndex === -1) {\n      throw new Error('Material not found');\n    }\n\n    const material = receipt.materials[materialIndex];\n    const updatedMaterial = {\n      ...material,\n      ...deliveryData,\n      deliveryStatus: 'delivered' as const,\n      deliveryDate: deliveryData.deliveryDate || new Date().toISOString(),\n      deliveredQuantity: material.quantity\n    };\n\n    receipt.materials[materialIndex] = updatedMaterial;\n    receipt.updatedAt = new Date().toISOString();\n\n    // Check if all materials are delivered\n    const allDelivered = receipt.materials.every(m => m.deliveryStatus === 'delivered');\n    if (allDelivered) {\n      receipt.status = 'completed';\n      receipt.deliveryStatus = 'delivered';\n    }\n\n    await this.saveData();\n\n    // Queue API call\n    const operation: OutboxOperation = {\n      method: 'PUT',\n      endpoint: `/api/patients/${receipt.patientId}/ereceipts/${receiptId}/materials/${materialId}/deliver`,\n      data: deliveryData,\n      headers: {\n        'Idempotency-Key': `deliver-material-${materialId}-${Date.now()}`\n      }\n    };\n    outbox.addOperation(operation);\n\n    return updatedMaterial;\n  }\n\n  // Statistics\n  async getStats(): Promise<SGKStats> {\n    await this.init();\n\n    const stats: SGKStats = {\n      totalDocuments: this.documents.length,\n      byType: {\n        recete: 0,\n        rapor: 0,\n        belge: 0,\n        fatura: 0,\n        teslim: 0,\n        iade: 0\n      },\n      byStatus: {\n        draft: 0,\n        submitted: 0,\n        under_review: 0,\n        approved: 0,\n        rejected: 0,\n        paid: 0,\n        completed: 0,\n        cancelled: 0\n      },\n      pendingApprovals: 0,\n      expiringSoon: 0,\n      totalValue: 0,\n      monthlySubmissions: 0,\n      approvalRate: 0\n    };\n\n    // Calculate document type statistics\n    this.documents.forEach(doc => {\n      stats.byType[doc.documentType]++;\n    });\n\n    // Calculate workflow status statistics\n    this.workflows.forEach(workflow => {\n      stats.byStatus[workflow.currentStatus]++;\n      \n      if (workflow.currentStatus === 'under_review') {\n        stats.pendingApprovals++;\n      }\n    });\n\n    // Calculate monthly submissions (current month)\n    const currentMonth = new Date().getMonth();\n    const currentYear = new Date().getFullYear();\n    stats.monthlySubmissions = this.workflows.filter(w => {\n      if (!w.submittedDate) return false;\n      const submittedDate = new Date(w.submittedDate);\n      return submittedDate.getMonth() === currentMonth && submittedDate.getFullYear() === currentYear;\n    }).length;\n\n    // Calculate approval rate\n    const totalSubmitted = this.workflows.filter(w => w.currentStatus !== 'draft').length;\n    const totalApproved = this.workflows.filter(w => w.currentStatus === 'approved' || w.currentStatus === 'paid' || w.currentStatus === 'completed').length;\n    stats.approvalRate = totalSubmitted > 0 ? (totalApproved / totalSubmitted) * 100 : 0;\n\n    // Calculate total value from e-receipts\n    stats.totalValue = this.eReceipts.reduce((sum, receipt) => sum + receipt.totalAmount, 0);\n\n    return stats;\n  }\n\n  // Patient SGK Info Management\n  async getPatientSGKInfo(_patientId: string): Promise<SGKPatientInfo | null> {\n    await this.init();\n\n    // This would typically come from the patient service\n    // For now, return a mock implementation\n    return {\n      hasInsurance: true,\n      insuranceNumber: '12345678901',\n      insuranceType: 'sgk',\n      coveragePercentage: 80,\n      deviceEntitlement: {\n        hasEntitlement: true,\n        validFrom: '2024-01-01',\n        validUntil: '2029-01-01',\n        maxQuantity: 2,\n        remainingQuantity: 1\n      },\n      batteryEntitlement: {\n        hasEntitlement: true,\n        validFrom: '2024-01-01',\n        validUntil: '2025-01-01',\n        maxQuantity: 12,\n        remainingQuantity: 8\n      },\n      currentStatus: 'approved'\n    };\n  }\n\n  // Validation\n  validateDocument(data: SGKDocumentFormData): SGKValidation {\n    const errors: Record<string, string> = {};\n    const warnings: Record<string, string> = {};\n\n    if (!data.patientId) {\n      errors.patientId = 'Patient is required';\n    }\n\n    if (!data.documentType) {\n      errors.documentType = 'Document type is required';\n    }\n\n    if (!data.file && !data.notes) {\n      errors.file = 'Either file or notes must be provided';\n    }\n\n    if (data.file && data.file.size > 10 * 1024 * 1024) {\n      errors.file = 'File size must be less than 10MB';\n    }\n\n    return {\n      isValid: Object.keys(errors).length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  validateEReceipt(data: EReceiptFormData): SGKValidation {\n    const errors: Record<string, string> = {};\n    const warnings: Record<string, string> = {};\n\n    if (!data.patientId) {\n      errors.patientId = 'Patient is required';\n    }\n\n    if (!data.tcNumber) {\n      errors.tcNumber = 'TC Number is required';\n    } else if (!/^\\d{11}$/.test(data.tcNumber)) {\n      errors.tcNumber = 'TC Number must be 11 digits';\n    }\n\n    if (!data.prescriptionNumber) {\n      errors.prescriptionNumber = 'Prescription number is required';\n    }\n\n    return {\n      isValid: Object.keys(errors).length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  // Bulk Operations\n  async bulkOperation(operation: BulkSGKOperation): Promise<BulkOperationResult> {\n    await this.init();\n\n    const result: BulkOperationResult = {\n      success: true,\n      processed: 0,\n      failed: 0,\n      errors: []\n    };\n\n    for (const documentId of operation.documentIds) {\n      try {\n        switch (operation.type) {\n          case 'process':\n            await this.processDocument({ imagePath: documentId });\n            break;\n          case 'approve':\n            const workflow = this.workflows.find(w => w.documentId === documentId);\n            if (workflow) {\n              await this.updateWorkflowStatus(workflow.id, 'approved', operation.data?.notes);\n            }\n            break;\n          case 'reject':\n            const rejectWorkflow = this.workflows.find(w => w.documentId === documentId);\n            if (rejectWorkflow) {\n              await this.updateWorkflowStatus(rejectWorkflow.id, 'rejected', operation.data?.rejectionReason);\n            }\n            break;\n          case 'submit':\n            const submitWorkflow = this.workflows.find(w => w.documentId === documentId);\n            if (submitWorkflow) {\n              await this.updateWorkflowStatus(submitWorkflow.id, 'submitted', operation.data?.notes);\n            }\n            break;\n        }\n        result.processed++;\n      } catch (error) {\n        result.failed++;\n        result.errors.push({\n          documentId,\n          error: error instanceof Error ? error.message : 'Unknown error'\n        });\n      }\n    }\n\n    result.success = result.failed === 0;\n    return result;\n  }\n\n  // E-reçete sorgulama\n  async queryEReceipt(receiptNumber: string, patientId?: string, tcNumber?: string) {\n    try {\n      // Using generated client for e-receipt query\n      const response = await this.api.patientSubresourcesCreatePatientEreceipt(patientId || '', {\n        receiptNumber,\n        patientId,\n        tcNumber\n      });\n\n      return response.data;\n    } catch (error) {\n      console.error('E-receipt query error:', error);\n      throw error;\n    }\n  }\n\n  // Hasta hakları sorgulama\n  async queryPatientRights(patientId: string): Promise<any> {\n    try {\n      // Using generated client for patient rights query\n      const response = await this.api.sgkGetPatientSgkDocuments(patientId);\n      return response.data;\n    } catch (error) {\n      console.error('Patient rights query error:', error);\n      throw error;\n    }\n  }\n\n  // SGK Workflow Management\n  async createWorkflow(patientId: string, documentId?: string, workflowType: string = 'approval'): Promise<any> {\n    try {\n      // Using generated client for workflow creation\n      const response = await this.api.automationTriggerSgkProcessing({ \n        patientId, \n        documentId, \n        workflowType \n      });\n      return response.data;\n    } catch (error) {\n      console.error('SGK workflow creation error:', error);\n      throw error;\n    }\n  }\n\n  async updateWorkflow(workflowId: string, stepId: string, status: string, notes?: string): Promise<any> {\n    try {\n      // Using generated client for workflow update\n      const response = await this.api.automationTriggerSgkProcessing({ \n        workflowId,\n        stepId, \n        status, \n        notes \n      });\n      return response.data;\n    } catch (error) {\n      console.error('SGK workflow update error:', error);\n      throw error;\n    }\n  }\n\n  async getWorkflow(workflowId: string): Promise<any> {\n    try {\n      // Using generated client for workflow retrieval\n      const response = await this.api.sgkGetPatientSgkDocuments(workflowId);\n      return response.data;\n    } catch (error) {\n      console.error('SGK workflow get error:', error);\n      throw error;\n    }\n  }\n}\n\n// Export singleton instance\nexport const sgkService = new SGKService();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/sgk/sgk.service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[396,399],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[396,399],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[408,411],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[408,411],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[524,527],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[524,527],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[657,660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[657,660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[751,754],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[751,754],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[763,766],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[763,766],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[858,861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[858,861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[870,873],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[870,873],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getXEarCRMAPIAutoGenerated } from '../../api/generated/xEarCRMAPIAutoGenerated';\n\nconst api = getXEarCRMAPIAutoGenerated();\nconst { sgkUploadSgkDocument, sgkDeleteSgkDocument, sgkProcessOcr, automationTriggerSgkProcessing, sgkGetPatientSgkDocuments } = api;\n\n// SGK Service - handles SGK document operations\nexport const sgkService = {\n  // Upload SGK document\n  uploadDocument: (body?: any, opts?: any) => sgkUploadSgkDocument(body, opts),\n  \n  // Delete SGK document\n  deleteDocument: (documentId: string, opts?: any) => sgkDeleteSgkDocument(documentId, opts),\n  \n  // List SGK documents for a patient\n  listDocuments: (patientId: string, opts?: any) => sgkGetPatientSgkDocuments(patientId, opts),\n  \n  // Process OCR\n  processOcr: (body?: any, opts?: any) => sgkProcessOcr(body, opts),\n  \n  // Trigger SGK processing\n  triggerProcessing: (body?: any, opts?: any) => automationTriggerSgkProcessing(body, opts),\n};\n\nexport default sgkService;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/services/uts/uts.service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[446,449],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[446,449],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[640,643],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[640,643],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[652,655],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[652,655],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// NOTE: Prefer Orval-generated client; fallback to direct fetch if Orval operation\n// names are not present in the generated client. Replace these with Orval calls\n// once OpenAPI includes the UTS paths.\n\nconst base = '/api/uts';\n\nasync function handleJson(resp: Response) {\n  if (!resp.ok) throw new Error(`UTS request failed: ${resp.status}`);\n  return resp.json();\n}\n\nexport const utsService = {\n  listRegistrations: (params?: Record<string, any>) => {\n    const query = params ? '?' + new URLSearchParams(params).toString() : '';\n    return fetch(`${base}/registrations${query}`).then(handleJson);\n  },\n  startBulkRegistration: (body: any, opts?: any) =>\n    fetch(`${base}/registrations/bulk`, { method: 'POST', body: JSON.stringify(body), headers: { 'Content-Type': 'application/json', ...(opts?.headers || {}) } }).then(handleJson),\n  getJobStatus: (jobId: string) => fetch(`${base}/jobs/${encodeURIComponent(jobId)}`).then(handleJson),\n  cancelJob: (jobId: string) => fetch(`${base}/jobs/${encodeURIComponent(jobId)}/cancel`, { method: 'POST' }).then(handleJson),\n};\n\nexport default utsService;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stores/authStore.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":167,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5344,5347],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5344,5347],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport { apiClient } from '../api/client';\nimport { DEV_CONFIG } from '../config/dev-config';\n\n// Extend Window interface to include __AUTH_TOKEN__\ndeclare global {\n  interface Window {\n    __AUTH_TOKEN__?: string;\n  }\n}\n\ninterface User {\n  id: string;\n  email: string;\n  name: string;\n  role?: string;\n}\n\ninterface AuthState {\n  user: User | null;\n  token: string | null;\n  refreshToken: string | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  error: string | null;\n}\n\ninterface AuthActions {\n  setAuth: (user: User, token: string) => void;\n  clearAuth: () => void;\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  login: (credentials: LoginCredentials) => Promise<void>;\n  logout: () => void;\n  refreshAuth: () => Promise<void>;\n  initializeAuth: () => Promise<void>;\n}\n\ninterface LoginCredentials {\n  username: string;\n  password: string;\n}\n\ntype AuthStore = AuthState & AuthActions;\n\nexport const useAuthStore = create<AuthStore>()(\n  persist(\n    (set, get) => ({\n      // Initial state\n      user: null,\n      token: null,\n      refreshToken: null,\n      isAuthenticated: false,\n      isLoading: false,\n      error: null,\n\n      // Actions\n      setAuth: (user: User, token: string) => {\n        set({\n          user,\n          token,\n          isAuthenticated: true,\n          error: null,\n        });\n\n        // Store token in localStorage for persistence\n        localStorage.setItem('auth_token', token);\n        \n        // Set global token for immediate use\n        if (typeof window !== 'undefined') {\n          window.__AUTH_TOKEN__ = token;\n        }\n      },\n\n      clearAuth: () => {\n        set({\n          user: null,\n          token: null,\n          refreshToken: null,\n          isAuthenticated: false,\n          error: null,\n        });\n\n        // Clear localStorage\n        localStorage.removeItem('auth_token');\n        localStorage.removeItem('refresh_token');\n        localStorage.removeItem('auth_token_timestamp');\n        \n        // Clear global token\n        if (typeof window !== 'undefined') {\n          delete window.__AUTH_TOKEN__;\n        }\n      },\n\n      setLoading: (loading: boolean) => {\n        set({ isLoading: loading });\n      },\n\n      setError: (error: string | null) => {\n        set({ error });\n      },\n\n      login: async (credentials: LoginCredentials) => {\n        const { setLoading, setError } = get();\n        \n        try {\n          setLoading(true);\n          setError(null);\n\n          console.log('Attempting login with credentials:', { username: credentials.username, password: '***' }); // Debug log\n\n          const response = await apiClient.login(credentials);\n          \n          console.log('Login response:', response); // Debug log\n          console.log('Response status:', response.status); // Debug log\n          console.log('Response data:', response.data); // Debug log\n          \n          if (response.status === 200 && response.data) {\n            // response.data is the backend response: { access_token, data: user, success, requestId, timestamp }\n            const responseData = response.data;\n            const { access_token: token, data: userData, success, refreshToken } = responseData;\n            \n            console.log('Parsed token:', token); // Debug log\n            console.log('Parsed userData:', userData); // Debug log\n            console.log('Success:', success); // Debug log\n            console.log('RefreshToken:', refreshToken); // Debug log\n            console.log('Full response data:', responseData); // Debug log\n            \n            if (success && token && userData) {\n              // Transform user data to match expected format\n              const transformedUser = {\n                    id: userData.id,\n                    email: userData.email,\n                    name: `${userData.firstName || ''} ${userData.lastName || ''}`.trim() || userData.username,\n                    role: userData.role\n                  };\n              \n              // Store tokens (now includes refresh token from backend)\n              set({\n                user: transformedUser,\n                token,\n                refreshToken: refreshToken || null,\n                isAuthenticated: true,\n                error: null,\n              });\n\n              // Store tokens in localStorage for persistence\n              localStorage.setItem('auth_token', token);\n              if (refreshToken) {\n                localStorage.setItem('refresh_token', refreshToken);\n              }\n              localStorage.setItem('auth_token_timestamp', Date.now().toString());\n              \n              // Set global token for immediate use\n              if (typeof window !== 'undefined') {\n                window.__AUTH_TOKEN__ = token;\n              }\n              \n              console.log('Login successful, user authenticated'); // Debug log\n            } else {\n              console.error('Missing required fields:', { success, token: !!token, userData: !!userData });\n              throw new Error('Invalid response from server - missing token or user');\n            }\n          } else if (response.status === 401) {\n            // Handle authentication error\n            const errorMessage = (response.data as any)?.error || 'Invalid credentials';\n            console.error('Authentication failed:', errorMessage);\n            throw new Error(errorMessage);\n          } else {\n            console.error('Invalid response structure:', { status: response.status, hasData: !!response.data });\n            throw new Error('Invalid response from server');\n          }\n        } catch (error) {\n          console.error('Login error:', error);\n          setError(error instanceof Error ? error.message : 'Login failed');\n        } finally {\n          setLoading(false);\n        }\n      },\n\n      logout: () => {\n        get().clearAuth();\n      },\n\n      refreshAuth: async () => {\n        try {\n          const { refreshToken, clearAuth } = get();\n          \n          if (!refreshToken) {\n            clearAuth();\n            return;\n          }\n\n          const response = await apiClient.refreshToken();\n          if (response.status === 200 && response.data) {\n            // Backend should return { access_token, data: user } format\n            const { access_token: newToken } = response.data;\n            set({ token: newToken });\n            localStorage.setItem('auth_token', newToken);\n            \n            if (typeof window !== 'undefined') {\n              window.__AUTH_TOKEN__ = newToken;\n            }\n          } else {\n            clearAuth();\n          }\n        } catch (error) {\n          console.error('Token refresh failed:', error);\n          get().clearAuth();\n        }\n      },\n\n      initializeAuth: async () => {\n        const { setLoading, login, isAuthenticated } = get();\n        \n        // Prevent multiple initialization calls\n        if (isAuthenticated) {\n          return;\n        }\n        \n        if (DEV_CONFIG.AUTO_LOGIN_ENABLED) {\n          const storedToken = localStorage.getItem('auth_token');\n          const storedRefreshToken = localStorage.getItem('refresh_token');\n          const tokenTimestamp = localStorage.getItem('auth_token_timestamp');\n          \n          if (storedToken && tokenTimestamp) {\n            const now = Date.now();\n            const tokenAge = now - parseInt(tokenTimestamp);\n            \n            if (tokenAge < DEV_CONFIG.TOKEN_PERSISTENCE_DURATION) {\n              // Token is still valid, restore auth state\n              try {\n                // Try to get user info with stored token\n                if (typeof window !== 'undefined') {\n                  window.__AUTH_TOKEN__ = storedToken;\n                }\n                \n                // Get current user info from API\n                const { usersGetCurrentUser } = await import('../api/generated/xEarCRMAPIAutoGenerated').then(module => module.getXEarCRMAPIAutoGenerated());\n                const userResponse = await usersGetCurrentUser();\n                \n                if (userResponse.status === 200 && userResponse.data) {\n                  const userData = userResponse.data;\n                  const transformedUser = {\n                    id: userData.id || '',\n                    email: userData.email || '',\n                    name: `${userData.firstName || ''} ${userData.lastName || ''}`.trim() || userData.username || '',\n                    role: userData.role || 'user'\n                  };\n                  \n                  // Set auth state with stored tokens and real user data\n                  set({\n                    user: transformedUser,\n                    token: storedToken,\n                    refreshToken: storedRefreshToken,\n                    isAuthenticated: true,\n                    error: null,\n                  });\n                  \n                  console.log('Auth state restored successfully with user:', transformedUser);\n                  return;\n                }\n              } catch (error) {\n                console.warn('Failed to restore auth state, will try auto-login:', error);\n                // Clear invalid token\n                localStorage.removeItem('auth_token');\n                localStorage.removeItem('refresh_token');\n                localStorage.removeItem('auth_token_timestamp');\n              }\n            }\n          }\n          \n          // No valid stored token or restoration failed, try auto-login\n          try {\n            setLoading(true);\n            await login(DEV_CONFIG.DEFAULT_CREDENTIALS);\n          } catch (error) {\n            console.warn('Auto-login failed:', error);\n          } finally {\n            setLoading(false);\n          }\n        }\n      },\n    }),\n    {\n      name: 'auth-storage',\n      partialize: (state) => ({\n        user: state.user,\n        token: state.token,\n        refreshToken: state.refreshToken,\n        isAuthenticated: state.isAuthenticated,\n      }),\n    }\n  )\n);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Alert.stories.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'React' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { Meta, StoryObj } from '@storybook/react';\nimport { Alert } from '@x-ear/ui-web';\nimport React from 'react';\n\nconst meta: Meta<typeof Alert> = {\n  title: 'UI/Alert',\n  component: Alert,\n  parameters: {\n    layout: 'centered',\n  },\n  tags: ['autodocs'],\n  argTypes: {\n    variant: {\n      control: { type: 'select' },\n      options: ['info', 'success', 'warning', 'error'],\n    },\n    title: {\n      control: { type: 'text' },\n    },\n    onClose: {\n      action: 'closed',\n    },\n  },\n};\n\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const Info: Story = {\n  args: {\n    variant: 'info',\n    title: 'Information',\n    children: 'This is an informational alert message.',\n  },\n};\n\nexport const Success: Story = {\n  args: {\n    variant: 'success',\n    title: 'Success',\n    children: 'Your action was completed successfully.',\n  },\n};\n\nexport const Warning: Story = {\n  args: {\n    variant: 'warning',\n    title: 'Warning',\n    children: 'Please review this important information.',\n  },\n};\n\nexport const Error: Story = {\n  args: {\n    variant: 'error',\n    title: 'Error',\n    children: 'An error occurred while processing your request.',\n  },\n};\n\nexport const WithoutTitle: Story = {\n  args: {\n    variant: 'info',\n    children: 'This alert has no title, just the message content.',\n  },\n};\n\nexport const Dismissible: Story = {\n  args: {\n    variant: 'warning',\n    title: 'Dismissible Alert',\n    children: 'This alert can be closed by clicking the X button.',\n    onClose: () => console.log('Alert closed'),\n  },\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Badge.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Button.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Card.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Checkbox.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/DocumentPreview.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Dropdown.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Input.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Modal.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/PatientTabContent.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/stories/Tooltip.stories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/test/setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/test/utils.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Move your component(s) to a separate file.","line":6,"column":7,"nodeType":"Identifier","messageId":"localComponents","endLine":6,"endColumn":22},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"This rule can't verify that `export *` only exports components.","line":27,"column":1,"nodeType":"ExportAllDeclaration","messageId":"exportAll","endLine":27,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { ReactElement } from 'react';\nimport { render, RenderOptions } from '@testing-library/react';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\n\n// Create a custom render function that includes providers\nconst AllTheProviders = ({ children }: { children: React.ReactNode }) => {\n  const queryClient = new QueryClient({\n    defaultOptions: {\n      queries: {\n        retry: false,\n      },\n    },\n  });\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      {children}\n    </QueryClientProvider>\n  );\n};\n\nconst customRender = (\n  ui: ReactElement,\n  options?: Omit<RenderOptions, 'wrapper'>\n) => render(ui, { wrapper: AllTheProviders, ...options });\n\nexport * from '@testing-library/react';\nexport { customRender as render };","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/tests/e2e/communication.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/appointment.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/deprecated.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/device-replacement.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/efatura.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/generated/api.ts","messages":[{"ruleId":"no-restricted-imports","severity":2,"message":"'axios' import is restricted from being used. Use generated API client from @x-ear/core instead of direct axios calls.","line":8,"column":1,"nodeType":"ImportDeclaration","messageId":"pathWithCustomMessage","endLine":8,"endColumn":27},{"ruleId":"no-restricted-imports","severity":2,"message":"'axios' import is restricted from being used. Use generated API client from @x-ear/core instead of direct axios calls.","line":9,"column":1,"nodeType":"ImportDeclaration","messageId":"pathWithCustomMessage","endLine":12,"endColumn":16},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":20,"column":1,"severity":2,"nodeType":null,"fix":{"range":[419,478],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":32,"column":1,"severity":2,"nodeType":null,"fix":{"range":[649,708],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":132,"column":1,"severity":2,"nodeType":null,"fix":{"range":[3395,3454],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":180,"column":1,"severity":2,"nodeType":null,"fix":{"range":[4554,4613],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":193,"column":1,"severity":2,"nodeType":null,"fix":{"range":[4816,4875],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":274,"column":1,"severity":2,"nodeType":null,"fix":{"range":[6928,6987],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":316,"column":1,"severity":2,"nodeType":null,"fix":{"range":[7883,7942],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":329,"column":1,"severity":2,"nodeType":null,"fix":{"range":[8183,8242],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":389,"column":1,"severity":2,"nodeType":null,"fix":{"range":[9678,9737],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":422,"column":1,"severity":2,"nodeType":null,"fix":{"range":[10380,10439],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":457,"column":1,"severity":2,"nodeType":null,"fix":{"range":[11150,11209],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":531,"column":1,"severity":2,"nodeType":null,"fix":{"range":[12842,12901],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":545,"column":1,"severity":2,"nodeType":null,"fix":{"range":[13158,13217],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":807,"column":1,"severity":2,"nodeType":null,"fix":{"range":[20450,20509],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":848,"column":1,"severity":2,"nodeType":null,"fix":{"range":[21705,21764],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":941,"column":1,"severity":2,"nodeType":null,"fix":{"range":[24720,24779],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":1023,"column":1,"severity":2,"nodeType":null,"fix":{"range":[26617,26676],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":1099,"column":1,"severity":2,"nodeType":null,"fix":{"range":[28134,28193],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":1141,"column":1,"severity":2,"nodeType":null,"fix":{"range":[29031,29090],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":1264,"column":1,"severity":2,"nodeType":null,"fix":{"range":[31957,32016],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":1337,"column":1,"severity":2,"nodeType":null,"fix":{"range":[33449,33508],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":1427,"column":1,"severity":2,"nodeType":null,"fix":{"range":[35457,35516],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-redeclare').","line":1578,"column":1,"severity":2,"nodeType":null,"fix":{"range":[39311,39370],"text":" "}}],"suppressedMessages":[],"errorCount":25,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":23,"fixableWarningCount":0,"source":"/**\n * Generated by orval v7.13.2 🍺\n * Do not edit manually.\n * X-Ear CRM API (auto-generated)\n * X-Ear CRM API for managing patients, devices, appointments, sales, and more\n * OpenAPI spec version: 0.0.0-auto\n */\nimport axios from 'axios';\nimport type {\n  AxiosRequestConfig,\n  AxiosResponse\n} from 'axios';\n\n/**\n * Patient's gender\n */\nexport type PatientGender = typeof PatientGender[keyof typeof PatientGender];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const PatientGender = {\n  M: 'M',\n  F: 'F',\n} as const;\n\n/**\n * Patient status\n */\nexport type PatientStatus = typeof PatientStatus[keyof typeof PatientStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const PatientStatus = {\n  ACTIVE: 'ACTIVE',\n  INACTIVE: 'INACTIVE',\n  LEAD: 'LEAD',\n  TRIAL: 'TRIAL',\n  CUSTOMER: 'CUSTOMER',\n} as const;\n\n/**\n * SGK information\n */\nexport type PatientSgkInfo = { [key: string]: unknown };\n\n/**\n * Custom patient data\n */\nexport type PatientCustomData = { [key: string]: unknown };\n\nexport interface Patient {\n  /** Unique patient identifier */\n  id?: string;\n  /** Turkish citizenship number */\n  tcNumber: string;\n  /** Turkish citizenship number (snake_case alias) */\n  tc_number?: string;\n  /** Identity number */\n  identityNumber?: string;\n  /** Identity number (snake_case alias) */\n  identity_number?: string;\n  /** Patient's first name */\n  firstName: string;\n  /** Patient's first name (snake_case alias) */\n  first_name?: string;\n  /** Patient's last name */\n  lastName: string;\n  /** Patient's last name (snake_case alias) */\n  last_name?: string;\n  /** Patient's phone number */\n  phone: string;\n  /** Patient's email address */\n  email?: string;\n  /** Patient's birth date */\n  birthDate?: string;\n  /** Patient's birth date (snake_case alias) */\n  birth_date?: string;\n  /** Patient's gender */\n  gender?: PatientGender;\n  /** Patient's city */\n  addressCity?: string;\n  /** Patient's city (snake_case alias) */\n  address_city?: string;\n  /** Patient's district */\n  addressDistrict?: string;\n  /** Patient's district (snake_case alias) */\n  address_district?: string;\n  /** Patient's full address */\n  addressFull?: string;\n  /** Patient's full address (snake_case alias) */\n  address_full?: string;\n  /** Patient status */\n  status?: PatientStatus;\n  /** Patient segment */\n  segment?: string;\n  /** How patient was acquired */\n  acquisitionType?: string;\n  /** How patient was acquired (snake_case alias) */\n  acquisition_type?: string;\n  /** Patient conversion step */\n  conversionStep?: string;\n  /** Patient conversion step (snake_case alias) */\n  conversion_step?: string;\n  /** Who referred the patient */\n  referredBy?: string;\n  /** Who referred the patient (snake_case alias) */\n  referred_by?: string;\n  /** Patient priority score */\n  priorityScore?: number;\n  /** Patient priority score (snake_case alias) */\n  priority_score?: number;\n  /** Patient tags */\n  tags?: string[];\n  /** SGK information */\n  sgkInfo?: PatientSgkInfo;\n  /** SGK information (snake_case alias) */\n  sgk_info?: PatientSgkInfo;\n  /** Custom patient data */\n  customData?: PatientCustomData;\n  /** Custom patient data (snake_case alias) */\n  custom_data?: PatientCustomData;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Appointment status\n */\nexport type AppointmentStatus = typeof AppointmentStatus[keyof typeof AppointmentStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const AppointmentStatus = {\n  SCHEDULED: 'SCHEDULED',\n  CONFIRMED: 'CONFIRMED',\n  COMPLETED: 'COMPLETED',\n  CANCELLED: 'CANCELLED',\n  NO_SHOW: 'NO_SHOW',\n} as const;\n\nexport interface Appointment {\n  /** Unique appointment identifier */\n  id?: string;\n  /** Patient ID */\n  patientId: string;\n  /** Patient ID (snake_case alias) */\n  patient_id?: string;\n  /** Clinician ID */\n  clinicianId?: string;\n  /** Clinician ID (snake_case alias) */\n  clinician_id?: string;\n  /** Branch ID */\n  branchId?: string;\n  /** Branch ID (snake_case alias) */\n  branch_id?: string;\n  /** Appointment date */\n  date: string;\n  /** Appointment time */\n  time: string;\n  /** Duration in minutes */\n  duration?: number;\n  /** Type of appointment */\n  appointmentType?: string;\n  /** Type of appointment (snake_case alias) */\n  appointment_type?: string;\n  /** Appointment status */\n  status?: AppointmentStatus;\n  /** Appointment notes */\n  notes?: string;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Which ear the device is for\n */\nexport type DeviceEar = typeof DeviceEar[keyof typeof DeviceEar];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const DeviceEar = {\n  LEFT: 'LEFT',\n  RIGHT: 'RIGHT',\n  BILATERAL: 'BILATERAL',\n} as const;\n\n/**\n * Device status\n */\nexport type DeviceStatus = typeof DeviceStatus[keyof typeof DeviceStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const DeviceStatus = {\n  IN_STOCK: 'IN_STOCK',\n  ASSIGNED: 'ASSIGNED',\n  TRIAL: 'TRIAL',\n  DEFECTIVE: 'DEFECTIVE',\n  LOST: 'LOST',\n  RETURNED: 'RETURNED',\n} as const;\n\nexport interface Device {\n  /** Unique device identifier */\n  id?: string;\n  /** Patient ID */\n  patientId?: string;\n  /** Patient ID (snake_case alias) */\n  patient_id?: string;\n  /** Inventory ID */\n  inventoryId?: string;\n  /** Inventory ID (snake_case alias) */\n  inventory_id?: string;\n  /** Device serial number */\n  serialNumber: string;\n  /** Device serial number (snake_case alias) */\n  serial_number?: string;\n  /** Device brand */\n  brand: string;\n  /** Device model */\n  model: string;\n  /** Type of device */\n  deviceType?: string;\n  /** Type of device (snake_case alias) */\n  device_type?: string;\n  /** Device category */\n  category?: string;\n  /** Which ear the device is for */\n  ear?: DeviceEar;\n  /** Device status */\n  status?: DeviceStatus;\n  /** Trial start date */\n  trialStartDate?: string;\n  /** Trial start date (snake_case alias) */\n  trial_start_date?: string;\n  /** Trial end date */\n  trialEndDate?: string;\n  /** Trial end date (snake_case alias) */\n  trial_end_date?: string;\n  /** Trial extended until date */\n  trialExtendedUntil?: string;\n  /** Trial extended until date (snake_case alias) */\n  trial_extended_until?: string;\n  /** Warranty start date */\n  warrantyStartDate?: string;\n  /** Warranty start date (snake_case alias) */\n  warranty_start_date?: string;\n  /** Warranty end date */\n  warrantyEndDate?: string;\n  /** Warranty end date (snake_case alias) */\n  warranty_end_date?: string;\n  /** Warranty terms */\n  warrantyTerms?: string;\n  /** Warranty terms (snake_case alias) */\n  warranty_terms?: string;\n  /** Device price */\n  price?: number;\n  /** Purchase date */\n  purchaseDate?: string;\n  /** Warranty expiry date */\n  warrantyExpiry?: string;\n  /** Device notes */\n  notes?: string;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Sale status\n */\nexport type SaleStatus = typeof SaleStatus[keyof typeof SaleStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const SaleStatus = {\n  PENDING: 'PENDING',\n  COMPLETED: 'COMPLETED',\n  CANCELLED: 'CANCELLED',\n} as const;\n\nexport interface Sale {\n  /** Unique sale identifier */\n  id?: string;\n  /** Patient ID */\n  patientId: string;\n  /** Product ID */\n  productId?: string;\n  /** Sale date */\n  saleDate?: string;\n  /** Total sale amount */\n  totalAmount: number;\n  /** List price total */\n  listPriceTotal?: number;\n  /** Discount amount */\n  discountAmount?: number;\n  /** SGK coverage amount */\n  sgkCoverage?: number;\n  /** Patient payment amount */\n  patientPayment?: number;\n  /** Payment method */\n  paymentMethod?: string;\n  /** Sale status */\n  status?: SaleStatus;\n  /** Sale notes */\n  notes?: string;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Hearing aid direction\n */\nexport type InventoryItemDirection = typeof InventoryItemDirection[keyof typeof InventoryItemDirection];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const InventoryItemDirection = {\n  LEFT: 'LEFT',\n  RIGHT: 'RIGHT',\n  BILATERAL: 'BILATERAL',\n} as const;\n\n/**\n * Legacy field for direction\n */\nexport type InventoryItemEar = typeof InventoryItemEar[keyof typeof InventoryItemEar];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const InventoryItemEar = {\n  LEFT: 'LEFT',\n  RIGHT: 'RIGHT',\n  BILATERAL: 'BILATERAL',\n} as const;\n\nexport interface InventoryItem {\n  /** Unique inventory item identifier */\n  id?: string;\n  /** Product name */\n  name: string;\n  /** Product brand */\n  brand: string;\n  /** Product model */\n  model?: string;\n  /** Product category */\n  category: string;\n  /** Product barcode */\n  barcode?: string;\n  /** Supplier name */\n  supplier?: string;\n  /** Product description */\n  description?: string;\n  /** Available inventory count */\n  availableInventory?: number;\n  /** Total inventory count */\n  totalInventory?: number;\n  /** Used inventory count */\n  usedInventory?: number;\n  /** Legacy field for available inventory */\n  inventory?: number;\n  /** Items currently on trial */\n  onTrial?: number;\n  /** Minimum stock level for reordering */\n  reorderLevel?: number;\n  /** Legacy field for reorder level */\n  minInventory?: number;\n  /** Available serial numbers */\n  availableSerials?: string[];\n  /** Product features */\n  features?: string[];\n  /** Unit price */\n  price: number;\n  /** Hearing aid direction */\n  direction?: InventoryItemDirection;\n  /** Legacy field for direction */\n  ear?: InventoryItemEar;\n  /** Warranty period in months */\n  warranty?: number;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Supplier status\n */\nexport type SupplierStatus = typeof SupplierStatus[keyof typeof SupplierStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const SupplierStatus = {\n  ACTIVE: 'ACTIVE',\n  INACTIVE: 'INACTIVE',\n} as const;\n\nexport interface Supplier {\n  /** Unique supplier identifier */\n  id?: string;\n  /** Supplier name */\n  name: string;\n  /** Contact person name */\n  contactPerson: string;\n  /** Supplier phone */\n  phone?: string;\n  /** Supplier email */\n  email?: string;\n  /** Supplier address */\n  address?: string;\n  /** Tax number */\n  taxNumber?: string;\n  /** Supplier status */\n  status?: SupplierStatus;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Campaign status\n */\nexport type CampaignStatus = typeof CampaignStatus[keyof typeof CampaignStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const CampaignStatus = {\n  DRAFT: 'DRAFT',\n  ACTIVE: 'ACTIVE',\n  PAUSED: 'PAUSED',\n  COMPLETED: 'COMPLETED',\n} as const;\n\nexport interface Campaign {\n  /** Unique campaign identifier */\n  id?: string;\n  /** Campaign name */\n  name: string;\n  /** Campaign description */\n  description?: string;\n  /** Campaign start date */\n  startDate: string;\n  /** Campaign end date */\n  endDate: string;\n  /** Campaign budget */\n  budget?: number;\n  /** Campaign status */\n  status?: CampaignStatus;\n  /** Target audience */\n  targetAudience?: string;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Notification type\n */\nexport type NotificationType = typeof NotificationType[keyof typeof NotificationType];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const NotificationType = {\n  INFO: 'INFO',\n  WARNING: 'WARNING',\n  ERROR: 'ERROR',\n  SUCCESS: 'SUCCESS',\n} as const;\n\nexport interface Notification {\n  /** Unique notification identifier */\n  id?: string;\n  /** User ID */\n  userId: string;\n  /** Notification title */\n  title: string;\n  /** Notification message */\n  message: string;\n  /** Notification type */\n  type?: NotificationType;\n  /** Read status */\n  isRead?: boolean;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Additional error details\n */\nexport type ErrorResponseDetails = { [key: string]: unknown };\n\nexport interface ErrorResponse {\n  /** Error message */\n  error: string;\n  /** Error code */\n  code?: number;\n  /** Additional error details */\n  details?: ErrorResponseDetails;\n}\n\n/**\n * Response data\n */\nexport type SuccessResponseData = { [key: string]: unknown };\n\nexport interface SuccessResponse {\n  /** Success message */\n  message: string;\n  /** Response data */\n  data?: SuccessResponseData;\n}\n\nexport interface PaginationInfo {\n  /** Current page number (offset-based pagination) */\n  page: number;\n  /** Items per page */\n  perPage: number;\n  /** Total number of items (offset-based pagination) */\n  total: number;\n  /** Total number of pages (offset-based pagination) */\n  totalPages: number;\n  /** Whether there are more items available */\n  hasNext?: boolean;\n  /** Cursor for next page (cursor-based pagination) */\n  nextCursor?: string;\n  /** Current cursor (cursor-based pagination) */\n  cursor?: string;\n}\n\n/**\n * Payment status\n */\nexport type PaymentRecordStatus = typeof PaymentRecordStatus[keyof typeof PaymentRecordStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const PaymentRecordStatus = {\n  PENDING: 'PENDING',\n  COMPLETED: 'COMPLETED',\n  CANCELLED: 'CANCELLED',\n  OVERDUE: 'OVERDUE',\n} as const;\n\n/**\n * Which ear\n */\nexport type PaymentRecordEar = typeof PaymentRecordEar[keyof typeof PaymentRecordEar];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const PaymentRecordEar = {\n  LEFT: 'LEFT',\n  RIGHT: 'RIGHT',\n  BILATERAL: 'BILATERAL',\n} as const;\n\nexport interface PaymentRecord {\n  /** Unique payment record identifier */\n  id?: string;\n  /** Patient ID */\n  patientId: string;\n  /** Patient ID (snake_case alias) */\n  patient_id?: string;\n  /** Sale ID */\n  saleId?: string;\n  /** Sale ID (snake_case alias) */\n  sale_id?: string;\n  /** Promissory note ID */\n  promissoryNoteId?: string;\n  /** Promissory note ID (snake_case alias) */\n  promissory_note_id?: string;\n  /** Payment amount */\n  amount: number;\n  /** Payment date */\n  paymentDate: string;\n  /** Payment date (snake_case alias) */\n  payment_date?: string;\n  /** Due date */\n  dueDate?: string;\n  /** Due date (snake_case alias) */\n  due_date?: string;\n  /** Payment method */\n  paymentMethod?: string;\n  /** Payment method (snake_case alias) */\n  payment_method?: string;\n  /** Payment type */\n  paymentType?: string;\n  /** Payment type (snake_case alias) */\n  payment_type?: string;\n  /** Payment status */\n  status?: PaymentRecordStatus;\n  /** Reference number */\n  referenceNumber?: string;\n  /** Reference number (snake_case alias) */\n  reference_number?: string;\n  /** Payment notes */\n  notes?: string;\n  /** Device ID */\n  deviceId?: string;\n  /** Device ID (snake_case alias) */\n  device_id?: string;\n  /** Which ear */\n  ear?: PaymentRecordEar;\n  /** Payment reason */\n  reason?: string;\n  /** From inventory flag */\n  fromInventory?: boolean;\n  /** From inventory flag (snake_case alias) */\n  from_inventory?: boolean;\n  /** List price */\n  listPrice?: number;\n  /** List price (snake_case alias) */\n  list_price?: number;\n  /** Sale price */\n  salePrice?: number;\n  /** Sale price (snake_case alias) */\n  sale_price?: number;\n  /** SGK scheme */\n  sgkScheme?: string;\n  /** SGK scheme (snake_case alias) */\n  sgk_scheme?: string;\n  /** SGK support amount */\n  sgkSupport?: number;\n  /** SGK support amount (snake_case alias) */\n  sgk_support?: number;\n  /** Discount type */\n  discountType?: string;\n  /** Discount type (snake_case alias) */\n  discount_type?: string;\n  /** Discount value */\n  discountValue?: number;\n  /** Discount value (snake_case alias) */\n  discount_value?: number;\n  /** Net payable amount */\n  netPayable?: number;\n  /** Net payable amount (snake_case alias) */\n  net_payable?: number;\n  /** Product ID */\n  productId?: string;\n  /** Product ID (snake_case alias) */\n  product_id?: string;\n  /** Sale date */\n  saleDate?: string;\n  /** Sale date (snake_case alias) */\n  sale_date?: string;\n  /** List price total */\n  listPriceTotal?: number;\n  /** List price total (snake_case alias) */\n  list_price_total?: number;\n  /** Total amount */\n  totalAmount?: number;\n  /** Total amount (snake_case alias) */\n  total_amount?: number;\n  /** Discount amount */\n  discountAmount?: number;\n  /** Discount amount (snake_case alias) */\n  discount_amount?: number;\n  /** Final amount */\n  finalAmount?: number;\n  /** Final amount (snake_case alias) */\n  final_amount?: number;\n  /** Paid amount */\n  paidAmount?: number;\n  /** Paid amount (snake_case alias) */\n  paid_amount?: number;\n  /** Right ear assignment ID */\n  rightEarAssignmentId?: string;\n  /** Right ear assignment ID (snake_case alias) */\n  right_ear_assignment_id?: string;\n  /** Left ear assignment ID */\n  leftEarAssignmentId?: string;\n  /** Left ear assignment ID (snake_case alias) */\n  left_ear_assignment_id?: string;\n  /** SGK coverage */\n  sgkCoverage?: number;\n  /** SGK coverage (snake_case alias) */\n  sgk_coverage?: number;\n  /** Patient payment */\n  patientPayment?: number;\n  /** Patient payment (snake_case alias) */\n  patient_payment?: number;\n  /** Payment plan name */\n  planName?: string;\n  /** Payment plan name (snake_case alias) */\n  plan_name?: string;\n  /** Number of installments */\n  installmentCount?: number;\n  /** Number of installments (snake_case alias) */\n  installment_count?: number;\n  /** Installment amount */\n  installmentAmount?: number;\n  /** Installment amount (snake_case alias) */\n  installment_amount?: number;\n  /** Current installment number */\n  installmentNumber?: number;\n  /** Current installment number (snake_case alias) */\n  installment_number?: number;\n  /** Remaining balance */\n  remainingBalance?: number;\n  /** Remaining balance (snake_case alias) */\n  remaining_balance?: number;\n  /** Interest rate */\n  interestRate?: number;\n  /** Interest rate (snake_case alias) */\n  interest_rate?: number;\n  /** Total interest */\n  totalInterest?: number;\n  /** Total interest (snake_case alias) */\n  total_interest?: number;\n  /** Processing fee amount */\n  processingFee?: number;\n  /** Processing fee amount (snake_case alias) */\n  processing_fee?: number;\n  /** Start date */\n  startDate?: string;\n  /** Start date (snake_case alias) */\n  start_date?: string;\n  /** Payment plan ID */\n  paymentPlanId?: string;\n  /** Payment plan ID (snake_case alias) */\n  payment_plan_id?: string;\n  /** Paid date */\n  paidDate?: string;\n  /** Paid date (snake_case alias) */\n  paid_date?: string;\n  /** Late fee amount */\n  lateFee?: number;\n  /** Late fee amount (snake_case alias) */\n  late_fee?: number;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Additional details\n */\nexport type UserDetails = { [key: string]: unknown };\n\nexport interface User {\n  /** Unique user identifier */\n  id?: string;\n  /** Username */\n  username: string;\n  /** User email */\n  email: string;\n  /** User phone number */\n  phone?: string;\n  /** Password hash */\n  passwordHash?: string;\n  /** Password hash (snake_case alias) */\n  password_hash?: string;\n  /** User first name */\n  firstName?: string;\n  /** User first name (snake_case alias) */\n  first_name?: string;\n  /** User last name */\n  lastName?: string;\n  /** User last name (snake_case alias) */\n  last_name?: string;\n  /** User role */\n  role?: string;\n  /** User active status */\n  isActive?: boolean;\n  /** User active status (snake_case alias) */\n  is_active?: boolean;\n  /** Last login date */\n  lastLogin?: string;\n  /** Last login date (snake_case alias) */\n  last_login?: string;\n  /** Password reset token */\n  passwordResetToken?: string;\n  /** Password reset token (snake_case alias) */\n  password_reset_token?: string;\n  /** Password reset expiry */\n  passwordResetExpires?: string;\n  /** Password reset expiry (snake_case alias) */\n  password_reset_expires?: string;\n  /** User ID for audit */\n  userId?: string;\n  /** User ID for audit (snake_case alias) */\n  user_id?: string;\n  /** User action */\n  action?: string;\n  /** Entity type */\n  entityType?: string;\n  /** Entity type (snake_case alias) */\n  entity_type?: string;\n  /** Entity ID */\n  entityId?: string;\n  /** Entity ID (snake_case alias) */\n  entity_id?: string;\n  /** IP address */\n  ipAddress?: string;\n  /** IP address (snake_case alias) */\n  ip_address?: string;\n  /** User agent */\n  userAgent?: string;\n  /** User agent (snake_case alias) */\n  user_agent?: string;\n  /** Additional details */\n  details?: UserDetails;\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n/**\n * Type of communication template\n */\nexport type CommunicationTemplateTemplateType = typeof CommunicationTemplateTemplateType[keyof typeof CommunicationTemplateTemplateType];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const CommunicationTemplateTemplateType = {\n  sms: 'sms',\n  email: 'email',\n} as const;\n\nexport interface CommunicationTemplate {\n  /** Unique template identifier */\n  id?: string;\n  /** Template name */\n  name?: string;\n  /** Template description */\n  description?: string;\n  /** Type of communication template */\n  templateType?: CommunicationTemplateTemplateType;\n  /** Type of communication template (snake_case alias) */\n  template_type?: CommunicationTemplateTemplateType;\n  /** Template category (appointment_reminder, payment_due, welcome, etc.) */\n  category?: string;\n  /** Email subject (for email templates) */\n  subject?: string;\n  /** Plain text content */\n  bodyText?: string;\n  /** Plain text content (snake_case alias) */\n  body_text?: string;\n  /** HTML content (for email templates) */\n  bodyHtml?: string;\n  /** HTML content (snake_case alias) */\n  body_html?: string;\n  /** Available template variables */\n  variables?: string[];\n  /** Whether template is active */\n  isActive?: boolean;\n}\n\n/**\n * Type of message (sms or email)\n */\nexport type CommunicationMessageMessageType = typeof CommunicationMessageMessageType[keyof typeof CommunicationMessageMessageType];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const CommunicationMessageMessageType = {\n  sms: 'sms',\n  email: 'email',\n} as const;\n\nexport interface CommunicationMessage {\n  /** Unique message identifier */\n  id?: string;\n  /** Type of message (sms or email) */\n  messageType?: CommunicationMessageMessageType;\n  /** Patient ID */\n  patientId?: string;\n  /** Patient ID (snake_case alias) */\n  patient_id?: string;\n  /** Campaign ID (if part of a campaign) */\n  campaignId?: string;\n  /** Campaign ID (snake_case alias) */\n  campaign_id?: string;\n  /** Template ID used for this message */\n  templateId?: string;\n  /** Template ID (snake_case alias) */\n  template_id?: string;\n  /** Message status (sent, delivered, failed, etc.) */\n  status?: string;\n  /** Phone number (for SMS messages) */\n  phoneNumber?: string;\n  /** Phone number (snake_case alias) */\n  phone_number?: string;\n  /** Recipient email address (for email messages) */\n  toEmail?: string;\n  /** Recipient email address (snake_case alias) */\n  to_email?: string;\n  /** Sender email address (for email messages) */\n  fromEmail?: string;\n  /** Sender email address (snake_case alias) */\n  from_email?: string;\n  /** Email subject (for email messages) */\n  subject?: string;\n  /** Message content (for SMS) */\n  message?: string;\n  /** Plain text content (for email) */\n  bodyText: string;\n  /** Plain text content (snake_case alias) */\n  body_text?: string;\n  /** HTML content (for email) */\n  bodyHtml?: string;\n  /** HTML content (snake_case alias) */\n  body_html?: string;\n  /** When the message was sent */\n  sentAt?: string;\n  /** When the message was sent (snake_case alias) */\n  sent_at?: string;\n  /** When the message was delivered */\n  deliveredAt?: string;\n  /** When the message was delivered (snake_case alias) */\n  delivered_at?: string;\n  /** Error message if sending failed */\n  errorMessage?: string;\n  /** Error message (snake_case alias) */\n  error_message?: string;\n  /** Cost of sending the message */\n  cost?: number;\n  /** Creation timestamp */\n  createdAt?: string;\n  /** Creation timestamp (snake_case alias) */\n  created_at?: string;\n  /** Last update timestamp */\n  updatedAt?: string;\n  /** Last update timestamp (snake_case alias) */\n  updated_at?: string;\n  /** Whether template is active (snake_case alias) */\n  is_active?: boolean;\n  /** Whether template is a system template */\n  isSystem?: boolean;\n  /** Whether template is a system template (snake_case alias) */\n  is_system?: boolean;\n  /** Number of times template has been used */\n  usageCount?: number;\n  /** Number of times template has been used (snake_case alias) */\n  usage_count?: number;\n  /** Last time template was used */\n  lastUsedAt?: string;\n  /** Last time template was used (snake_case alias) */\n  last_used_at?: string;\n}\n\n/**\n * Type of communication template\n */\nexport type CommunicationTemplateCreateTemplateType = typeof CommunicationTemplateCreateTemplateType[keyof typeof CommunicationTemplateCreateTemplateType];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const CommunicationTemplateCreateTemplateType = {\n  sms: 'sms',\n  email: 'email',\n} as const;\n\nexport interface CommunicationTemplateCreate {\n  /** Template name */\n  name: string;\n  /** Template description */\n  description?: string;\n  /** Type of communication template */\n  templateType: CommunicationTemplateCreateTemplateType;\n  /** Template category */\n  category?: string;\n  /** Email subject (for email templates) */\n  subject?: string;\n  /** Plain text content */\n  bodyText: string;\n  /** HTML content (for email templates) */\n  bodyHtml?: string;\n  /** Available template variables */\n  variables?: string[];\n  /** Whether template is active */\n  isActive?: boolean;\n}\n\nexport interface CommunicationTemplateUpdate {\n  /** Template name */\n  name?: string;\n  /** Template description */\n  description?: string;\n  /** Template category */\n  category?: string;\n  /** Email subject (for email templates) */\n  subject?: string;\n  /** Plain text content */\n  bodyText?: string;\n  /** HTML content (for email templates) */\n  bodyHtml?: string;\n  /** Available template variables */\n  variables?: string[];\n  /** Whether template is active */\n  isActive?: boolean;\n}\n\nexport type AppointmentsGetAppointmentsParams = {\n/**\n * Page number for pagination\n */\npage?: number;\n/**\n * Number of items per page (max 200)\n * @minimum 1\n * @maximum 200\n */\nper_page?: number;\n/**\n * Filter by patient ID\n */\npatient_id?: string;\n/**\n * Filter appointments from this date\n */\ndate_from?: string;\n/**\n * Filter appointments to this date\n */\ndate_to?: string;\n/**\n * Filter by appointment status\n */\nstatus?: AppointmentsGetAppointmentsStatus;\n/**\n * Filter by branch ID\n */\nbranch_id?: string;\n};\n\nexport type AppointmentsGetAppointmentsStatus = typeof AppointmentsGetAppointmentsStatus[keyof typeof AppointmentsGetAppointmentsStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const AppointmentsGetAppointmentsStatus = {\n  SCHEDULED: 'SCHEDULED',\n  CONFIRMED: 'CONFIRMED',\n  IN_PROGRESS: 'IN_PROGRESS',\n  COMPLETED: 'COMPLETED',\n  CANCELLED: 'CANCELLED',\n  NO_SHOW: 'NO_SHOW',\n  RESCHEDULED: 'RESCHEDULED',\n} as const;\n\nexport type AppointmentsCreateAppointmentBody = {\n  /** Patient ID */\n  patient_id: string;\n  /** Appointment date */\n  date: string;\n  /** Appointment time */\n  time: string;\n  /** Duration in minutes */\n  duration?: number;\n  /** Appointment type */\n  type?: string;\n  /** Additional notes */\n  notes?: string;\n};\n\nexport type AppointmentsCreateAppointment201 = {\n  success?: boolean;\n  data?: Appointment;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type CommunicationsListMessagesParams = {\n/**\n * Page number for pagination\n */\npage?: number;\n/**\n * Number of items per page (max 100)\n * @maximum 100\n */\nper_page?: number;\n/**\n * Filter by message type\n */\ntype?: CommunicationsListMessagesType;\n/**\n * Filter by message status\n */\nstatus?: string;\n/**\n * Filter by patient ID\n */\npatient_id?: string;\n/**\n * Filter by campaign ID\n */\ncampaign_id?: string;\n/**\n * Filter messages from this date\n */\ndate_from?: string;\n/**\n * Filter messages to this date\n */\ndate_to?: string;\n/**\n * Search in message content, phone number, or email\n */\nsearch?: string;\n};\n\nexport type CommunicationsListMessagesType = typeof CommunicationsListMessagesType[keyof typeof CommunicationsListMessagesType];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const CommunicationsListMessagesType = {\n  sms: 'sms',\n  email: 'email',\n} as const;\n\nexport type CommunicationsListMessages200Meta = {\n  total?: number;\n  page?: number;\n  perPage?: number;\n  totalPages?: number;\n};\n\nexport type CommunicationsListMessages200 = {\n  success?: boolean;\n  data?: CommunicationMessage[];\n  meta?: CommunicationsListMessages200Meta;\n  timestamp?: string;\n};\n\nexport type CommunicationsListTemplatesParams = {\n/**\n * Filter by template type\n */\ntype?: CommunicationsListTemplatesType;\n/**\n * Filter by template category\n */\ncategory?: string;\n/**\n * Filter by active status\n */\nactive?: boolean;\n/**\n * Search in template name and description\n */\nsearch?: string;\n};\n\nexport type CommunicationsListTemplatesType = typeof CommunicationsListTemplatesType[keyof typeof CommunicationsListTemplatesType];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const CommunicationsListTemplatesType = {\n  sms: 'sms',\n  email: 'email',\n} as const;\n\nexport type CommunicationsListTemplates200Meta = { [key: string]: unknown };\n\nexport type CommunicationsListTemplates200 = {\n  success?: boolean;\n  data?: CommunicationTemplate[];\n  meta?: CommunicationsListTemplates200Meta;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type CommunicationsCreateTemplate201 = {\n  success?: boolean;\n  data?: CommunicationTemplate;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type CommunicationsGetTemplate200 = {\n  success?: boolean;\n  data?: CommunicationTemplate;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type CommunicationsUpdateTemplate200 = {\n  success?: boolean;\n  data?: CommunicationTemplate;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type CommunicationsDeleteTemplate200Data = { [key: string]: unknown };\n\nexport type CommunicationsDeleteTemplate200 = {\n  success?: boolean;\n  data?: CommunicationsDeleteTemplate200Data;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type AppointmentsCancelAppointmentBody = { [key: string]: unknown };\n\nexport type AppointmentsCompleteAppointmentBody = { [key: string]: unknown };\n\nexport type AppointmentsRescheduleAppointmentBody = { [key: string]: unknown };\n\nexport type AppointmentsListAppointments200 = {\n  data?: Appointment[];\n  pagination?: PaginationInfo;\n};\n\nexport type AutomationTriggerBackupBody = { [key: string]: unknown };\n\nexport type AutomationTriggerSgkProcessingBody = { [key: string]: unknown };\n\nexport type CampaignsCreateCampaignBody = { [key: string]: unknown };\n\n/**\n * Monthly statistics\n */\nexport type DashboardGetDashboardData200MonthlyStats = {\n  patients?: number;\n  appointments?: number;\n  sales?: number;\n};\n\nexport type DashboardGetDashboardData200 = {\n  /** Total number of patients */\n  totalPatients?: number;\n  /** Total number of devices */\n  totalDevices?: number;\n  /** Total number of appointments */\n  totalAppointments?: number;\n  /** Total sales amount */\n  totalSales?: number;\n  /** Recent appointments */\n  recentAppointments?: Appointment[];\n  /** Recent sales */\n  recentSales?: Sale[];\n  /** Monthly statistics */\n  monthlyStats?: DashboardGetDashboardData200MonthlyStats;\n};\n\nexport type CampaignsSendCampaignBody = { [key: string]: unknown };\n\nexport type DevicesGetDevicesParams = {\n/**\n * Page number for pagination\n */\npage?: number;\n/**\n * Number of items per page (max 200)\n * @minimum 1\n * @maximum 200\n */\nper_page?: number;\n/**\n * Search term for filtering devices\n */\nsearch?: string;\n/**\n * Filter by device brand\n */\nbrand?: string;\n/**\n * Filter by device category\n */\ncategory?: string;\n/**\n * Filter by device status\n */\nstatus?: DevicesGetDevicesStatus;\n};\n\nexport type DevicesGetDevicesStatus = typeof DevicesGetDevicesStatus[keyof typeof DevicesGetDevicesStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const DevicesGetDevicesStatus = {\n  IN_STOCK: 'IN_STOCK',\n  ASSIGNED: 'ASSIGNED',\n  TRIAL: 'TRIAL',\n  DEFECTIVE: 'DEFECTIVE',\n  LOST: 'LOST',\n  RETURNED: 'RETURNED',\n} as const;\n\nexport type DevicesGetDevices200 = {\n  data?: Device[];\n  pagination?: PaginationInfo;\n};\n\nexport type DevicesCreateDeviceBody = { [key: string]: unknown };\n\nexport type DevicesUpdateDeviceStockBody = { [key: string]: unknown };\n\nexport type DevicesCreateDeviceBrandBody = {\n  /** Brand name */\n  name: string;\n};\n\nexport type DevicesCreateDeviceCategoryBody = {\n  /** Category name */\n  name: string;\n};\n\nexport type DevicesCreateDeviceCategory201Data = {\n  name?: string;\n};\n\nexport type DevicesCreateDeviceCategory201 = {\n  success?: boolean;\n  data?: DevicesCreateDeviceCategory201Data;\n  message?: string;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type InventoryGetInventoryItemsParams = {\n/**\n * Page number for pagination\n */\npage?: number;\n/**\n * Number of items per page (max 200)\n * @minimum 1\n * @maximum 200\n */\nper_page?: number;\n/**\n * Search term for filtering items\n */\nsearch?: string;\n/**\n * Filter by item category\n */\ncategory?: string;\n/**\n * Filter items with low stock\n */\nlowStock?: boolean;\n/**\n * Filter by item status\n */\nstatus?: InventoryGetInventoryItemsStatus;\n};\n\nexport type InventoryGetInventoryItemsStatus = typeof InventoryGetInventoryItemsStatus[keyof typeof InventoryGetInventoryItemsStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const InventoryGetInventoryItemsStatus = {\n  IN_STOCK: 'IN_STOCK',\n  ASSIGNED: 'ASSIGNED',\n  TRIAL: 'TRIAL',\n  DEFECTIVE: 'DEFECTIVE',\n  LOST: 'LOST',\n  RETURNED: 'RETURNED',\n} as const;\n\nexport type InventoryGetInventoryItems200 = {\n  data?: InventoryItem[];\n  pagination?: PaginationInfo;\n};\n\nexport type InventoryCreateInventoryItemBody = { [key: string]: unknown };\n\nexport type InventoryGetInventoryItem200 = {\n  success?: boolean;\n  data?: InventoryItem;\n};\n\nexport type InventoryAssignToPatientBody = { [key: string]: unknown };\n\nexport type InventoryAddSerialNumbersBody = { [key: string]: unknown };\n\nexport type InventoryGetCategories200Data = {\n  categories?: string[];\n};\n\nexport type InventoryGetCategories200Meta = {\n  total?: number;\n};\n\nexport type InventoryGetCategories200 = {\n  success?: boolean;\n  data?: InventoryGetCategories200Data;\n  meta?: InventoryGetCategories200Meta;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type InventoryCreateCategoryBody = {\n  /** Category name to create */\n  category: string;\n};\n\nexport type InventoryCreateCategory201Data = {\n  category?: string;\n};\n\nexport type InventoryCreateCategory201 = {\n  success?: boolean;\n  data?: InventoryCreateCategory201Data;\n  requestId?: string;\n  timestamp?: string;\n};\n\nexport type NotificationsMarkNotificationReadBody = { [key: string]: unknown };\n\nexport type SgkProcessOcrBody = { [key: string]: unknown };\n\nexport type PatientsGetPatientsParams = {\n/**\n * Page number for pagination\n */\npage?: number;\n/**\n * Number of items per page (max 200)\n * @minimum 1\n * @maximum 200\n */\nper_page?: number;\n/**\n * Cursor for cursor-based pagination (for large datasets)\n */\ncursor?: string;\n/**\n * Search term for filtering patients\n */\nsearch?: string;\n/**\n * Filter by patient status\n */\nstatus?: PatientsGetPatientsStatus;\n};\n\nexport type PatientsGetPatientsStatus = typeof PatientsGetPatientsStatus[keyof typeof PatientsGetPatientsStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const PatientsGetPatientsStatus = {\n  ACTIVE: 'ACTIVE',\n  INACTIVE: 'INACTIVE',\n  LEAD: 'LEAD',\n  TRIAL: 'TRIAL',\n  CUSTOMER: 'CUSTOMER',\n} as const;\n\nexport type PatientsGetPatients200 = {\n  data?: Patient[];\n  pagination?: PaginationInfo;\n};\n\nexport type PatientsCreatePatientBody = { [key: string]: unknown };\n\nexport type SalesAssignDevicesExtendedBody = { [key: string]: unknown };\n\nexport type PatientSubresourcesCreatePatientEreceiptBody = { [key: string]: unknown };\n\nexport type PatientSubresourcesAddPatientHearingTestBody = { [key: string]: unknown };\n\nexport type PatientSubresourcesCreatePatientNoteBody = { [key: string]: unknown };\n\nexport type TimelineGetPatientTimeline200DataItem = {\n  id?: string;\n  patientId?: string;\n  type?: string;\n  title?: string;\n  description?: string;\n  timestamp?: string;\n  user?: string;\n  source?: string;\n};\n\nexport type TimelineGetPatientTimeline200Meta = {\n  total?: number;\n  patient_id?: string;\n};\n\nexport type TimelineGetPatientTimeline200 = {\n  success?: boolean;\n  data?: TimelineGetPatientTimeline200DataItem[];\n  meta?: TimelineGetPatientTimeline200Meta;\n  timestamp?: string;\n};\n\n/**\n * Additional event details\n */\nexport type TimelineAddTimelineEventBodyDetails = { [key: string]: unknown };\n\nexport type TimelineAddTimelineEventBody = {\n  /** Event type (e.g., 'appointment', 'sale', 'note', 'device_assigned') */\n  type: string;\n  /** Event title */\n  title: string;\n  /** Event description */\n  description?: string;\n  /** Additional event details */\n  details?: TimelineAddTimelineEventBodyDetails;\n  /** Event timestamp (defaults to current time) */\n  timestamp?: string;\n  /** Event date in DD.MM.YYYY format */\n  date?: string;\n  /** Event time in HH:MM format */\n  time?: string;\n  /** User who created the event (defaults to 'system') */\n  user?: string;\n  /** FontAwesome icon class (defaults to 'fa-circle') */\n  icon?: string;\n  /** Event color (defaults to 'blue') */\n  color?: string;\n  /** Event category (defaults to 'general') */\n  category?: string;\n};\n\nexport type TimelineAddTimelineEvent201Data = {\n  id?: string;\n  patientId?: string;\n  type?: string;\n  title?: string;\n  description?: string;\n  timestamp?: string;\n};\n\nexport type TimelineAddTimelineEvent201 = {\n  success?: boolean;\n  data?: TimelineAddTimelineEvent201Data;\n  timestamp?: string;\n};\n\nexport type TimelineDeleteTimelineEvent200 = {\n  success?: boolean;\n  message?: string;\n  timestamp?: string;\n};\n\nexport type TimelineLogPatientActivityBodyDetails = { [key: string]: unknown };\n\nexport type TimelineLogPatientActivityBody = {\n  type: string;\n  title: string;\n  description?: string;\n  details?: TimelineLogPatientActivityBodyDetails;\n};\n\nexport type PatientsBulkUploadPatientsBody = { [key: string]: unknown };\n\nexport type SalesPricingPreviewBody = { [key: string]: unknown };\n\nexport type SuppliersAddProductSupplierBody = { [key: string]: unknown };\n\nexport type RegistrationRegisterPhoneBody = { [key: string]: unknown };\n\nexport type SalesCreateSaleBody = { [key: string]: unknown };\n\nexport type SalesUpdateSaleBody = { [key: string]: unknown };\n\nexport type SalesCreateSalePaymentPlanBody = { [key: string]: unknown };\n\nexport type UpdateSettingsBody = { [key: string]: unknown };\n\nexport type SgkUploadSgkDocumentBody = { [key: string]: unknown };\n\nexport type SuppliersGetSuppliersParams = {\n/**\n * Page number for pagination\n */\npage?: number;\n/**\n * Number of items per page\n */\nper_page?: number;\n/**\n * Search term for filtering suppliers\n */\nsearch?: string;\n/**\n * Filter by supplier status\n */\nstatus?: SuppliersGetSuppliersStatus;\n/**\n * Filter by supplier category\n */\ncategory?: string;\n};\n\nexport type SuppliersGetSuppliersStatus = typeof SuppliersGetSuppliersStatus[keyof typeof SuppliersGetSuppliersStatus];\n\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const SuppliersGetSuppliersStatus = {\n  ACTIVE: 'ACTIVE',\n  INACTIVE: 'INACTIVE',\n  PENDING: 'PENDING',\n} as const;\n\nexport type SuppliersGetSuppliers200 = {\n  data?: Supplier[];\n  pagination?: PaginationInfo;\n};\n\nexport type SuppliersCreateSupplierBody = { [key: string]: unknown };\n\nexport type RegistrationVerifyRegistrationOtpBody = { [key: string]: unknown };\n\nexport type UsersCreateUserBody = { [key: string]: unknown };\n\nexport type UsersUpdateUserBody = { [key: string]: unknown };\n\nexport type OcrExtractEntitiesBody = { [key: string]: unknown };\n\nexport type OcrExtractPatientNameBody = { [key: string]: unknown };\n\nexport type OcrInitDatabaseBody = { [key: string]: unknown };\n\nexport type OcrInitializeNlpEndpointBody = { [key: string]: unknown };\n\nexport type OcrProcessDocumentBody = { [key: string]: unknown };\n\nexport type OcrCalculateSimilarityBody = { [key: string]: unknown };\n\n/**\n * @summary Get list of appointments\n */\nexport const appointmentsGetAppointments = <TData = AxiosResponse<void>>(\n    params?: AppointmentsGetAppointmentsParams, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/appointments`,{\n    ...options,\n        params: {...params, ...options?.params},}\n    );\n  }\n\n/**\n * @summary Create a new appointment\n */\nexport const appointmentsCreateAppointment = <TData = AxiosResponse<AppointmentsCreateAppointment201>>(\n    appointmentsCreateAppointmentBody: AppointmentsCreateAppointmentBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/appointments`,\n      appointmentsCreateAppointmentBody,options\n    );\n  }\n\n/**\n * @summary Get list of communication messages (SMS and Email)\n */\nexport const communicationsListMessages = <TData = AxiosResponse<CommunicationsListMessages200>>(\n    params?: CommunicationsListMessagesParams, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/communications/messages`,{\n    ...options,\n        params: {...params, ...options?.params},}\n    );\n  }\n\n/**\n * @summary Get list of communication templates\n */\nexport const communicationsListTemplates = <TData = AxiosResponse<CommunicationsListTemplates200>>(\n    params?: CommunicationsListTemplatesParams, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/communications/templates`,{\n    ...options,\n        params: {...params, ...options?.params},}\n    );\n  }\n\n/**\n * @summary Create a new communication template\n */\nexport const communicationsCreateTemplate = <TData = AxiosResponse<CommunicationsCreateTemplate201>>(\n    communicationTemplateCreate: CommunicationTemplateCreate, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/communications/templates`,\n      communicationTemplateCreate,options\n    );\n  }\n\n/**\n * @summary Get a specific communication template\n */\nexport const communicationsGetTemplate = <TData = AxiosResponse<CommunicationsGetTemplate200>>(\n    templateId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/communications/templates/${templateId}`,options\n    );\n  }\n\n/**\n * @summary Update a communication template\n */\nexport const communicationsUpdateTemplate = <TData = AxiosResponse<CommunicationsUpdateTemplate200>>(\n    templateId: string,\n    communicationTemplateUpdate: CommunicationTemplateUpdate, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.put(\n      `/api/communications/templates/${templateId}`,\n      communicationTemplateUpdate,options\n    );\n  }\n\n/**\n * @summary Delete a communication template\n */\nexport const communicationsDeleteTemplate = <TData = AxiosResponse<CommunicationsDeleteTemplate200>>(\n    templateId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/communications/templates/${templateId}`,options\n    );\n  }\n\n/**\n * Delete an existing appointment by its unique identifier\n * @summary DELETE /api/appointments/{appointment_id}\n */\nexport const appointmentsDeleteAppointment = <TData = AxiosResponse<SuccessResponse>>(\n    appointmentId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/appointments/${appointmentId}`,options\n    );\n  }\n\n/**\n * Cancel an appointment and optionally provide cancellation reason\n * @summary POST /api/appointments/{appointment_id}/cancel\n */\nexport const appointmentsCancelAppointment = <TData = AxiosResponse<void>>(\n    appointmentId: string,\n    appointmentsCancelAppointmentBody?: AppointmentsCancelAppointmentBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/appointments/${appointmentId}/cancel`,\n      appointmentsCancelAppointmentBody,options\n    );\n  }\n\n/**\n * Mark an appointment as completed and add completion notes\n * @summary POST /api/appointments/{appointment_id}/complete\n */\nexport const appointmentsCompleteAppointment = <TData = AxiosResponse<void>>(\n    appointmentId: string,\n    appointmentsCompleteAppointmentBody?: AppointmentsCompleteAppointmentBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/appointments/${appointmentId}/complete`,\n      appointmentsCompleteAppointmentBody,options\n    );\n  }\n\n/**\n * Reschedule an existing appointment to a new date and time\n * @summary POST /api/appointments/{appointment_id}/reschedule\n */\nexport const appointmentsRescheduleAppointment = <TData = AxiosResponse<void>>(\n    appointmentId: string,\n    appointmentsRescheduleAppointmentBody?: AppointmentsRescheduleAppointmentBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/appointments/${appointmentId}/reschedule`,\n      appointmentsRescheduleAppointmentBody,options\n    );\n  }\n\n/**\n * Get available appointment slots for scheduling\n * @summary GET /api/appointments/availability\n */\nexport const appointmentsGetAvailability = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/appointments/availability`,options\n    );\n  }\n\n/**\n * Retrieve a list of appointments with optional filtering\n * @summary GET /api/appointments/list\n */\nexport const appointmentsListAppointments = <TData = AxiosResponse<AppointmentsListAppointments200>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/appointments/list`,options\n    );\n  }\n\n/**\n * Trigger automated system backup process\n * @summary Trigger system backup\n */\nexport const automationTriggerBackup = <TData = AxiosResponse<void>>(\n    automationTriggerBackupBody?: AutomationTriggerBackupBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/automation/backup`,\n      automationTriggerBackupBody,options\n    );\n  }\n\n/**\n * Retrieve logs from automated processes and tasks\n * @summary Get automation logs\n */\nexport const automationGetAutomationLogs = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/automation/logs`,options\n    );\n  }\n\n/**\n * Trigger automated SGK document processing workflow\n * @summary Trigger SGK document processing\n */\nexport const automationTriggerSgkProcessing = <TData = AxiosResponse<void>>(\n    automationTriggerSgkProcessingBody?: AutomationTriggerSgkProcessingBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/automation/sgk/process`,\n      automationTriggerSgkProcessingBody,options\n    );\n  }\n\n/**\n * Retrieve status information\n * @summary Get automation system status\n */\nexport const automationGetAutomationStatus = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/automation/status`,options\n    );\n  }\n\n/**\n * Create a new marketing campaign with target audience and content\n * @summary POST /api/campaigns\n */\nexport const campaignsCreateCampaign = <TData = AxiosResponse<Campaign>>(\n    campaignsCreateCampaignBody?: CampaignsCreateCampaignBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/campaigns`,\n      campaignsCreateCampaignBody,options\n    );\n  }\n\n/**\n * Retrieve dashboard overview data including statistics and recent activities\n * @summary Get dashboard data\n */\nexport const dashboardGetDashboardData = <TData = AxiosResponse<DashboardGetDashboardData200>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/dashboard`,options\n    );\n  }\n\n/**\n * Create new send\n * @summary POST /api/campaigns/{campaign_id}/send\n */\nexport const campaignsSendCampaign = <TData = AxiosResponse<void>>(\n    campaignId: string,\n    campaignsSendCampaignBody?: CampaignsSendCampaignBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/campaigns/${campaignId}/send`,\n      campaignsSendCampaignBody,options\n    );\n  }\n\n/**\n * Retrieve turnstile information\n * @summary GET /api/config/turnstile\n */\nexport const registrationGetTurnstileConfig = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/config/turnstile`,options\n    );\n  }\n\n/**\n * Retrieve patient-trends information\n * @summary GET /api/dashboard/charts/patient-trends\n */\nexport const dashboardPatientTrends = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/dashboard/charts/patient-trends`,options\n    );\n  }\n\n/**\n * Retrieve revenue-trends information\n * @summary GET /api/dashboard/charts/revenue-trends\n */\nexport const dashboardRevenueTrends = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/dashboard/charts/revenue-trends`,options\n    );\n  }\n\n/**\n * Retrieve kpis information\n * @summary GET /api/dashboard/kpis\n */\nexport const dashboardGetKpis = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/dashboard/kpis`,options\n    );\n  }\n\n/**\n * Retrieve recent-activity information\n * @summary GET /api/dashboard/recent-activity\n */\nexport const dashboardRecentActivity = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/dashboard/recent-activity`,options\n    );\n  }\n\n/**\n * Retrieve a list of devices with optional filtering and pagination\n * @summary Get list of devices\n */\nexport const devicesGetDevices = <TData = AxiosResponse<DevicesGetDevices200>>(\n    params?: DevicesGetDevicesParams, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/devices`,{\n    ...options,\n        params: {...params, ...options?.params},}\n    );\n  }\n\n/**\n * Register a new hearing aid device in the system\n * @summary Create a new device\n */\nexport const devicesCreateDevice = <TData = AxiosResponse<Device>>(\n    devicesCreateDeviceBody?: DevicesCreateDeviceBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/devices`,\n      devicesCreateDeviceBody,options\n    );\n  }\n\n/**\n * Remove a device from the system\n * @summary Delete a device\n */\nexport const devicesDeleteDevice = <TData = AxiosResponse<SuccessResponse>>(\n    deviceId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/devices/${deviceId}`,options\n    );\n  }\n\n/**\n * This endpoint is intentionally permissive for tests — real inventory logic\nshould live in a dedicated inventory table/service.\n * @summary Update device stock levels (simplified).\n */\nexport const devicesUpdateDeviceStock = <TData = AxiosResponse<void>>(\n    deviceId: string,\n    devicesUpdateDeviceStockBody?: DevicesUpdateDeviceStockBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/devices/${deviceId}/stock-update`,\n      devicesUpdateDeviceStockBody,options\n    );\n  }\n\n/**\n * Retrieve brands information\n * @summary Get available device brands\n */\nexport const devicesGetDeviceBrands = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/devices/brands`,options\n    );\n  }\n\n/**\n * Create a new device brand\n * @summary Create a new device brand\n */\nexport const devicesCreateDeviceBrand = <TData = AxiosResponse<void>>(\n    devicesCreateDeviceBrandBody: DevicesCreateDeviceBrandBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/devices/brands`,\n      devicesCreateDeviceBrandBody,options\n    );\n  }\n\n/**\n * Retrieve categories information\n * @summary Get available device categories\n */\nexport const devicesGetDeviceCategories = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/devices/categories`,options\n    );\n  }\n\n/**\n * Create a new device category\n * @summary Create a new device category\n */\nexport const devicesCreateDeviceCategory = <TData = AxiosResponse<DevicesCreateDeviceCategory201>>(\n    devicesCreateDeviceCategoryBody: DevicesCreateDeviceCategoryBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/devices/categories`,\n      devicesCreateDeviceCategoryBody,options\n    );\n  }\n\n/**\n * Retrieve low-stock information\n * @summary Get devices with low stock levels\n */\nexport const devicesGetLowStockDevices = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/devices/low-stock`,options\n    );\n  }\n\n/**\n * Returns 200 when read+write ok, 503 when write fails, and 500 when other errors occur.\n * @summary Health endpoint exposing overall status and DB read/write check results.\n */\nexport const healthCheck = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/health`,options\n    );\n  }\n\n/**\n * Retrieve a list of inventory items with optional filtering and pagination\n * @summary Get list of inventory items\n */\nexport const inventoryGetInventoryItems = <TData = AxiosResponse<InventoryGetInventoryItems200>>(\n    params?: InventoryGetInventoryItemsParams, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/inventory`,{\n    ...options,\n        params: {...params, ...options?.params},}\n    );\n  }\n\n/**\n * Add a new item to inventory with quantity and details\n * @summary Create a new inventory item\n */\nexport const inventoryCreateInventoryItem = <TData = AxiosResponse<InventoryItem>>(\n    inventoryCreateInventoryItemBody?: InventoryCreateInventoryItemBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/inventory`,\n      inventoryCreateInventoryItemBody,options\n    );\n  }\n\n/**\n * Retrieve a single inventory item by its ID\n * @summary Get a single inventory item by ID\n */\nexport const inventoryGetInventoryItem = <TData = AxiosResponse<InventoryGetInventoryItem200>>(\n    itemId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/inventory/${itemId}`,options\n    );\n  }\n\n/**\n * Remove an item from inventory\n * @summary Delete an inventory item\n */\nexport const inventoryDeleteInventoryItem = <TData = AxiosResponse<SuccessResponse>>(\n    itemId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/inventory/${itemId}`,options\n    );\n  }\n\n/**\n * Retrieve activity information\n * @summary Get activity log for an inventory item\n */\nexport const inventoryGetInventoryActivities = <TData = AxiosResponse<void>>(\n    itemId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/inventory/${itemId}/activity`,options\n    );\n  }\n\n/**\n * Create new assign\n * @summary Assign inventory item to a patient (reduces stock)\n */\nexport const inventoryAssignToPatient = <TData = AxiosResponse<void>>(\n    itemId: string,\n    inventoryAssignToPatientBody?: InventoryAssignToPatientBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/inventory/${itemId}/assign`,\n      inventoryAssignToPatientBody,options\n    );\n  }\n\n/**\n * Create new serials\n * @summary Add serial numbers to an inventory item\n */\nexport const inventoryAddSerialNumbers = <TData = AxiosResponse<void>>(\n    itemId: string,\n    inventoryAddSerialNumbersBody?: InventoryAddSerialNumbersBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/inventory/${itemId}/serials`,\n      inventoryAddSerialNumbersBody,options\n    );\n  }\n\n/**\n * Retrieve low-stock information\n * @summary Get all items with low stock levels\n */\nexport const inventoryGetLowStockItems = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/inventory/low-stock`,options\n    );\n  }\n\n/**\n * Get inventory statistics including low stock alerts\n * @summary Get inventory statistics\n */\nexport const inventoryGetInventoryStats = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/inventory/stats`,options\n    );\n  }\n\n/**\n * Get list of all available inventory categories\n * @summary Get all inventory categories\n */\nexport const inventoryGetCategories = <TData = AxiosResponse<InventoryGetCategories200>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/inventory/categories`,options\n    );\n  }\n\n/**\n * Create a new inventory category\n * @summary Create new inventory category\n */\nexport const inventoryCreateCategory = <TData = AxiosResponse<InventoryCreateCategory201>>(\n    inventoryCreateCategoryBody: InventoryCreateCategoryBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/inventory/categories`,\n      inventoryCreateCategoryBody,options\n    );\n  }\n\n/**\n * Retrieve notifications information\n * @summary GET /api/notifications\n */\nexport const notificationsListNotifications = <TData = AxiosResponse<Notification[]>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/notifications`,options\n    );\n  }\n\n/**\n * Delete a specific notification\n * @summary DELETE /api/notifications/{notification_id}\n */\nexport const notificationsDeleteNotification = <TData = AxiosResponse<SuccessResponse>>(\n    notificationId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/notifications/${notificationId}`,options\n    );\n  }\n\n/**\n * Update read information\n * @summary PUT /api/notifications/{notification_id}/read\n */\nexport const notificationsMarkNotificationRead = <TData = AxiosResponse<void>>(\n    notificationId: string,\n    notificationsMarkNotificationReadBody?: NotificationsMarkNotificationReadBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.put(\n      `/api/notifications/${notificationId}/read`,\n      notificationsMarkNotificationReadBody,options\n    );\n  }\n\n/**\n * Retrieve stats information\n * @summary GET /api/notifications/stats\n */\nexport const notificationsNotificationStats = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/notifications/stats`,options\n    );\n  }\n\n/**\n * Create new process\n * @summary POST /api/ocr/process\n */\nexport const sgkProcessOcr = <TData = AxiosResponse<void>>(\n    sgkProcessOcrBody?: SgkProcessOcrBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/ocr/process`,\n      sgkProcessOcrBody,options\n    );\n  }\n\n/**\n * Returns CORS headers so the static Swagger UI served from a different origin (e.g. localhost:8080)\ncan fetch the YAML without browser CORS errors.\n * @summary Serve the canonical OpenAPI contract for frontend/back-end sync and respond to CORS preflight.\n */\nexport const serveOpenapiYaml = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/openapi.yaml`,options\n    );\n  }\n\n/**\n * Retrieve a list of patients with optional filtering and pagination\n * @summary Get list of patients\n */\nexport const patientsGetPatients = <TData = AxiosResponse<PatientsGetPatients200>>(\n    params?: PatientsGetPatientsParams, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/patients`,{\n    ...options,\n        params: {...params, ...options?.params},}\n    );\n  }\n\n/**\n * Register a new patient with personal and medical information\n * @summary POST /api/patients\n */\nexport const patientsCreatePatient = <TData = AxiosResponse<Patient>>(\n    patientsCreatePatientBody?: PatientsCreatePatientBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients`,\n      patientsCreatePatientBody,options\n    );\n  }\n\n/**\n * Remove a patient record from the system\n * @summary DELETE /api/patients/{patient_id}\n */\nexport const patientsDeletePatient = <TData = AxiosResponse<SuccessResponse>>(\n    patientId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/patients/${patientId}`,options\n    );\n  }\n\n/**\n * Create new assign-devices-extended\n * @summary POST /api/patients/{patient_id}/assign-devices-extended\n */\nexport const salesAssignDevicesExtended = <TData = AxiosResponse<void>>(\n    patientId: string,\n    salesAssignDevicesExtendedBody?: SalesAssignDevicesExtendedBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients/${patientId}/assign-devices-extended`,\n      salesAssignDevicesExtendedBody,options\n    );\n  }\n\n/**\n * Create new ereceipts\n * @summary POST /api/patients/{patient_id}/ereceipts\n */\nexport const patientSubresourcesCreatePatientEreceipt = <TData = AxiosResponse<void>>(\n    patientId: string,\n    patientSubresourcesCreatePatientEreceiptBody?: PatientSubresourcesCreatePatientEreceiptBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients/${patientId}/ereceipts`,\n      patientSubresourcesCreatePatientEreceiptBody,options\n    );\n  }\n\n/**\n * Delete {ereceipt_id}\n * @summary DELETE /api/patients/{patient_id}/ereceipts/{ereceipt_id}\n */\nexport const patientSubresourcesDeletePatientEreceipt = <TData = AxiosResponse<void>>(\n    patientId: string,\n    ereceiptId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/patients/${patientId}/ereceipts/${ereceiptId}`,options\n    );\n  }\n\n/**\n * Create new hearing-tests\n * @summary POST /api/patients/{patient_id}/hearing-tests\n */\nexport const patientSubresourcesAddPatientHearingTest = <TData = AxiosResponse<void>>(\n    patientId: string,\n    patientSubresourcesAddPatientHearingTestBody?: PatientSubresourcesAddPatientHearingTestBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients/${patientId}/hearing-tests`,\n      patientSubresourcesAddPatientHearingTestBody,options\n    );\n  }\n\n/**\n * Delete {test_id}\n * @summary DELETE /api/patients/{patient_id}/hearing-tests/{test_id}\n */\nexport const patientSubresourcesDeletePatientHearingTest = <TData = AxiosResponse<void>>(\n    patientId: string,\n    testId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/patients/${patientId}/hearing-tests/${testId}`,options\n    );\n  }\n\n/**\n * Create new notes\n * @summary POST /api/patients/{patient_id}/notes\n */\nexport const patientSubresourcesCreatePatientNote = <TData = AxiosResponse<void>>(\n    patientId: string,\n    patientSubresourcesCreatePatientNoteBody?: PatientSubresourcesCreatePatientNoteBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients/${patientId}/notes`,\n      patientSubresourcesCreatePatientNoteBody,options\n    );\n  }\n\n/**\n * Delete {note_id}\n * @summary DELETE /api/patients/{patient_id}/notes/{note_id}\n */\nexport const patientSubresourcesDeletePatientNote = <TData = AxiosResponse<void>>(\n    patientId: string,\n    noteId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/patients/${patientId}/notes/${noteId}`,options\n    );\n  }\n\n/**\n * Retrieve sales information\n * @summary GET /api/patients/{patient_id}/sales\n */\nexport const salesGetPatientSales = <TData = AxiosResponse<void>>(\n    patientId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/patients/${patientId}/sales`,options\n    );\n  }\n\n/**\n * Retrieve sgk-documents information\n * @summary GET /api/patients/{patient_id}/sgk-documents\n */\nexport const sgkGetPatientSgkDocuments = <TData = AxiosResponse<void>>(\n    patientId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/patients/${patientId}/sgk-documents`,options\n    );\n  }\n\n/**\n * Retrieves all timeline events for a specific patient, including events from both custom data and activity logs\n * @summary Get timeline events for a patient\n */\nexport const timelineGetPatientTimeline = <TData = AxiosResponse<TimelineGetPatientTimeline200>>(\n    patientId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/patients/${patientId}/timeline`,options\n    );\n  }\n\n/**\n * Creates a new timeline event for a specific patient and logs it to both custom data and activity logs\n * @summary Add a new timeline event for a patient\n */\nexport const timelineAddTimelineEvent = <TData = AxiosResponse<TimelineAddTimelineEvent201>>(\n    patientId: string,\n    timelineAddTimelineEventBody: TimelineAddTimelineEventBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients/${patientId}/timeline`,\n      timelineAddTimelineEventBody,options\n    );\n  }\n\n/**\n * Removes a specific timeline event from a patient's timeline\n * @summary Delete a timeline event\n */\nexport const timelineDeleteTimelineEvent = <TData = AxiosResponse<TimelineDeleteTimelineEvent200>>(\n    patientId: string,\n    eventId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/patients/${patientId}/timeline/${eventId}`,options\n    );\n  }\n\n/**\n * Alternative endpoint for adding timeline events, provides the same functionality as POST /api/patients/{patient_id}/timeline\n * @summary Log an activity for a patient (alias for timeline event)\n */\nexport const timelineLogPatientActivity = <TData = AxiosResponse<void>>(\n    patientId: string,\n    timelineLogPatientActivityBody: TimelineLogPatientActivityBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients/${patientId}/activities`,\n      timelineLogPatientActivityBody,options\n    );\n  }\n\n/**\n * This endpoint is intentionally forgiving: it returns a summary of created/updated rows\nand reports per-row errors without aborting the entire batch.\nAuthentication is optional for uploads in many workflows; we still log the actor when present.\n * @summary Accept a multipart/form-data CSV file containing patients and upsert them into the DB.\n */\nexport const patientsBulkUploadPatients = <TData = AxiosResponse<void>>(\n    patientsBulkUploadPatientsBody?: PatientsBulkUploadPatientsBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/patients/bulk_upload`,\n      patientsBulkUploadPatientsBody,options\n    );\n  }\n\n/**\n * Supports optional query params: status, segment, q (search term).\n * @summary Export patients as CSV. Only admin users are allowed to perform exports.\n */\nexport const patientsExportPatientsCsv = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/patients/export`,options\n    );\n  }\n\n/**\n * Retrieve search information\n * @summary GET /api/patients/search\n */\nexport const patientsSearchPatients = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/patients/search`,options\n    );\n  }\n\n/**\n * Create new pricing-preview\n * @summary POST /api/pricing-preview\n */\nexport const salesPricingPreview = <TData = AxiosResponse<void>>(\n    salesPricingPreviewBody?: SalesPricingPreviewBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/pricing-preview`,\n      salesPricingPreviewBody,options\n    );\n  }\n\n/**\n * Delete {ps_id}\n * @summary Delete a product-supplier relationship\n */\nexport const suppliersDeleteProductSupplier = <TData = AxiosResponse<void>>(\n    psId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/product-suppliers/${psId}`,options\n    );\n  }\n\n/**\n * Create new suppliers\n * @summary Add a supplier to a product\n */\nexport const suppliersAddProductSupplier = <TData = AxiosResponse<void>>(\n    productId: string,\n    suppliersAddProductSupplierBody?: SuppliersAddProductSupplierBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/products/${productId}/suppliers`,\n      suppliersAddProductSupplierBody,options\n    );\n  }\n\n/**\n * Create new register-phone\n * @summary POST /api/register-phone\n */\nexport const registrationRegisterPhone = <TData = AxiosResponse<void>>(\n    registrationRegisterPhoneBody?: RegistrationRegisterPhoneBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/register-phone`,\n      registrationRegisterPhoneBody,options\n    );\n  }\n\n/**\n * Retrieve appointments information\n * @summary GET /api/reports/appointments\n */\nexport const reportsReportAppointments = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/reports/appointments`,options\n    );\n  }\n\n/**\n * Retrieve campaigns information\n * @summary Kampanya raporu\n */\nexport const reportsReportCampaigns = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/reports/campaigns`,options\n    );\n  }\n\n/**\n * Retrieve financial information\n * @summary Mali rapor\n */\nexport const reportsReportFinancial = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/reports/financial`,options\n    );\n  }\n\n/**\n * Retrieve overview information\n * @summary Genel rapor özeti\n */\nexport const reportsReportOverview = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/reports/overview`,options\n    );\n  }\n\n/**\n * Retrieve patients information\n * @summary Hasta analizi raporu\n */\nexport const reportsReportPatients = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/reports/patients`,options\n    );\n  }\n\n/**\n * Retrieve revenue information\n * @summary GET /api/reports/revenue\n */\nexport const reportsReportRevenue = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/reports/revenue`,options\n    );\n  }\n\n/**\n * Retrieve a list of all sales\n * @summary GET /api/sales\n */\nexport const salesListSales = <TData = AxiosResponse<Sale[]>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/sales`,options\n    );\n  }\n\n/**\n * Create a new sale\n * @summary POST /api/sales\n */\nexport const salesCreateSale = <TData = AxiosResponse<Sale>>(\n    salesCreateSaleBody: SalesCreateSaleBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/sales`,\n      salesCreateSaleBody,options\n    );\n  }\n\n/**\n * Get sale details by ID\n * @summary GET /api/sales/{sale_id}\n */\nexport const salesGetSale = <TData = AxiosResponse<Sale>>(\n    saleId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/sales/${saleId}`,options\n    );\n  }\n\n/**\n * Update sale information\n * @summary PUT /api/sales/{sale_id}\n */\nexport const salesUpdateSale = <TData = AxiosResponse<Sale>>(\n    saleId: string,\n    salesUpdateSaleBody: SalesUpdateSaleBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.put(\n      `/api/sales/${saleId}`,\n      salesUpdateSaleBody,options\n    );\n  }\n\n/**\n * Delete a sale\n * @summary DELETE /api/sales/{sale_id}\n */\nexport const salesDeleteSale = <TData = AxiosResponse<void>>(\n    saleId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/sales/${saleId}`,options\n    );\n  }\n\n/**\n * Create new payment-plan\n * @summary POST /api/sales/{sale_id}/payment-plan\n */\nexport const salesCreateSalePaymentPlan = <TData = AxiosResponse<PaymentRecord>>(\n    saleId: string,\n    salesCreateSalePaymentPlanBody?: SalesCreateSalePaymentPlanBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/sales/${saleId}/payment-plan`,\n      salesCreateSalePaymentPlanBody,options\n    );\n  }\n\n/**\n * Update settings information\n * @summary Update system settings\n */\nexport const updateSettings = <TData = AxiosResponse<void>>(\n    updateSettingsBody?: UpdateSettingsBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.put(\n      `/api/settings`,\n      updateSettingsBody,options\n    );\n  }\n\n/**\n * Create new documents\n * @summary POST /api/sgk/documents\n */\nexport const sgkUploadSgkDocument = <TData = AxiosResponse<void>>(\n    sgkUploadSgkDocumentBody?: SgkUploadSgkDocumentBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/sgk/documents`,\n      sgkUploadSgkDocumentBody,options\n    );\n  }\n\n/**\n * Delete {document_id}\n * @summary DELETE /api/sgk/documents/{document_id}\n */\nexport const sgkDeleteSgkDocument = <TData = AxiosResponse<void>>(\n    documentId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/sgk/documents/${documentId}`,options\n    );\n  }\n\n/**\n * Retrieve monitoring information\n * @summary GET /api/sms/monitoring\n */\nexport const smsMonitoring = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/sms/monitoring`,options\n    );\n  }\n\n/**\n * Retrieve a list of suppliers with optional filtering and pagination\n * @summary Get list of suppliers\n */\nexport const suppliersGetSuppliers = <TData = AxiosResponse<SuppliersGetSuppliers200>>(\n    params?: SuppliersGetSuppliersParams, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/suppliers`,{\n    ...options,\n        params: {...params, ...options?.params},}\n    );\n  }\n\n/**\n * Register a new supplier with contact and business information\n * @summary Create a new supplier\n */\nexport const suppliersCreateSupplier = <TData = AxiosResponse<Supplier>>(\n    suppliersCreateSupplierBody?: SuppliersCreateSupplierBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/suppliers`,\n      suppliersCreateSupplierBody,options\n    );\n  }\n\n/**\n * Remove a supplier from the system\n * @summary Delete a supplier (soft delete by setting is_active=False)\n */\nexport const suppliersDeleteSupplier = <TData = AxiosResponse<SuccessResponse>>(\n    supplierId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/suppliers/${supplierId}`,options\n    );\n  }\n\n/**\n * Get list of products available from a specific supplier\n * @summary Get all products for a specific supplier\n */\nexport const suppliersGetSupplierProducts = <TData = AxiosResponse<void>>(\n    supplierId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/suppliers/${supplierId}/products`,options\n    );\n  }\n\n/**\n * Get supplier statistics including order history\n * @summary Get supplier statistics\n */\nexport const suppliersGetSupplierStats = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/suppliers/stats`,options\n    );\n  }\n\n/**\n * Create new verify-registration-otp\n * @summary POST /api/verify-registration-otp\n */\nexport const registrationVerifyRegistrationOtp = <TData = AxiosResponse<void>>(\n    registrationVerifyRegistrationOtpBody?: RegistrationVerifyRegistrationOtpBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/verify-registration-otp`,\n      registrationVerifyRegistrationOtpBody,options\n    );\n  }\n\n/**\n * Retrieve a list of all users\n * @summary GET /api/users\n */\nexport const usersListUsers = <TData = AxiosResponse<User[]>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/users`,options\n    );\n  }\n\n/**\n * Create a new user\n * @summary POST /api/users\n */\nexport const usersCreateUser = <TData = AxiosResponse<User>>(\n    usersCreateUserBody: UsersCreateUserBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/api/users`,\n      usersCreateUserBody,options\n    );\n  }\n\n/**\n * Get user details by ID\n * @summary GET /api/users/{user_id}\n */\nexport const usersGetUser = <TData = AxiosResponse<User>>(\n    userId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/users/${userId}`,options\n    );\n  }\n\n/**\n * Update user information\n * @summary PUT /api/users/{user_id}\n */\nexport const usersUpdateUser = <TData = AxiosResponse<User>>(\n    userId: string,\n    usersUpdateUserBody: UsersUpdateUserBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.put(\n      `/api/users/${userId}`,\n      usersUpdateUserBody,options\n    );\n  }\n\n/**\n * Delete a user\n * @summary DELETE /api/users/{user_id}\n */\nexport const usersDeleteUser = <TData = AxiosResponse<void>>(\n    userId: string, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.delete(\n      `/api/users/${userId}`,options\n    );\n  }\n\n/**\n * Get current authenticated user information\n * @summary GET /api/users/me\n */\nexport const usersGetCurrentUser = <TData = AxiosResponse<User>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/api/users/me`,options\n    );\n  }\n\n/**\n * Create new entities\n * @summary Extract entities from image using OCR\n */\nexport const ocrExtractEntities = <TData = AxiosResponse<void>>(\n    ocrExtractEntitiesBody?: OcrExtractEntitiesBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/entities`,\n      ocrExtractEntitiesBody,options\n    );\n  }\n\n/**\n * Extract patient name from document image using OCR\n * @summary Extract patient name from image using OCR\n */\nexport const ocrExtractPatientName = <TData = AxiosResponse<void>>(\n    ocrExtractPatientNameBody?: OcrExtractPatientNameBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/extract_patient`,\n      ocrExtractPatientNameBody,options\n    );\n  }\n\n/**\n * Health check for OCR service availability\n * @summary Health check endpoint (moved from app.py)\n */\nexport const ocrHealthCheck = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/health`,options\n    );\n  }\n\n/**\n * Initialize OCR service database and create required tables\n * @summary Initialize database and create tables\n */\nexport const ocrInitDatabase = <TData = AxiosResponse<void>>(\n    ocrInitDatabaseBody?: OcrInitDatabaseBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/init-db`,\n      ocrInitDatabaseBody,options\n    );\n  }\n\n/**\n * Initialize NLP/OCR processing service\n * @summary Initialize NLP/OCR service\n */\nexport const ocrInitializeNlpEndpoint = <TData = AxiosResponse<void>>(\n    ocrInitializeNlpEndpointBody?: OcrInitializeNlpEndpointBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/initialize`,\n      ocrInitializeNlpEndpointBody,options\n    );\n  }\n\n/**\n * Process document using OCR to extract text and data\n * @summary Process document with OCR\n */\nexport const ocrProcessDocument = <TData = AxiosResponse<void>>(\n    ocrProcessDocumentBody?: OcrProcessDocumentBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/process`,\n      ocrProcessDocumentBody,options\n    );\n  }\n\n/**\n * Calculate similarity between documents using OCR text analysis\n * @summary Calculate similarity between two images using OCR text\n */\nexport const ocrCalculateSimilarity = <TData = AxiosResponse<void>>(\n    ocrCalculateSimilarityBody?: OcrCalculateSimilarityBody, options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.post(\n      `/similarity`,\n      ocrCalculateSimilarityBody,options\n    );\n  }\n\n/**\n * This helps local development: visit http://<backend-host>:<port>/swagger.html so the\nSwagger UI and `/api/openapi.yaml` are on the same origin and no CORS overrides are needed.\n * @summary Serve the static Swagger UI page from the repository `public/` folder.\n */\nexport const serveSwaggerUi = <TData = AxiosResponse<void>>(\n     options?: AxiosRequestConfig\n ): Promise<TData> => {\n    return axios.get(\n      `/swagger.html`,options\n    );\n  }\n\nexport type AppointmentsGetAppointmentsResult = AxiosResponse<void>\nexport type AppointmentsCreateAppointmentResult = AxiosResponse<AppointmentsCreateAppointment201>\nexport type CommunicationsListMessagesResult = AxiosResponse<CommunicationsListMessages200>\nexport type CommunicationsListTemplatesResult = AxiosResponse<CommunicationsListTemplates200>\nexport type CommunicationsCreateTemplateResult = AxiosResponse<CommunicationsCreateTemplate201>\nexport type CommunicationsGetTemplateResult = AxiosResponse<CommunicationsGetTemplate200>\nexport type CommunicationsUpdateTemplateResult = AxiosResponse<CommunicationsUpdateTemplate200>\nexport type CommunicationsDeleteTemplateResult = AxiosResponse<CommunicationsDeleteTemplate200>\nexport type AppointmentsDeleteAppointmentResult = AxiosResponse<SuccessResponse>\nexport type AppointmentsCancelAppointmentResult = AxiosResponse<void>\nexport type AppointmentsCompleteAppointmentResult = AxiosResponse<void>\nexport type AppointmentsRescheduleAppointmentResult = AxiosResponse<void>\nexport type AppointmentsGetAvailabilityResult = AxiosResponse<void>\nexport type AppointmentsListAppointmentsResult = AxiosResponse<AppointmentsListAppointments200>\nexport type AutomationTriggerBackupResult = AxiosResponse<void>\nexport type AutomationGetAutomationLogsResult = AxiosResponse<void>\nexport type AutomationTriggerSgkProcessingResult = AxiosResponse<void>\nexport type AutomationGetAutomationStatusResult = AxiosResponse<void>\nexport type CampaignsCreateCampaignResult = AxiosResponse<Campaign>\nexport type DashboardGetDashboardDataResult = AxiosResponse<DashboardGetDashboardData200>\nexport type CampaignsSendCampaignResult = AxiosResponse<void>\nexport type RegistrationGetTurnstileConfigResult = AxiosResponse<void>\nexport type DashboardPatientTrendsResult = AxiosResponse<void>\nexport type DashboardRevenueTrendsResult = AxiosResponse<void>\nexport type DashboardGetKpisResult = AxiosResponse<void>\nexport type DashboardRecentActivityResult = AxiosResponse<void>\nexport type DevicesGetDevicesResult = AxiosResponse<DevicesGetDevices200>\nexport type DevicesCreateDeviceResult = AxiosResponse<Device>\nexport type DevicesDeleteDeviceResult = AxiosResponse<SuccessResponse>\nexport type DevicesUpdateDeviceStockResult = AxiosResponse<void>\nexport type DevicesGetDeviceBrandsResult = AxiosResponse<void>\nexport type DevicesCreateDeviceBrandResult = AxiosResponse<void>\nexport type DevicesGetDeviceCategoriesResult = AxiosResponse<void>\nexport type DevicesCreateDeviceCategoryResult = AxiosResponse<DevicesCreateDeviceCategory201>\nexport type DevicesGetLowStockDevicesResult = AxiosResponse<void>\nexport type HealthCheckResult = AxiosResponse<void>\nexport type InventoryGetInventoryItemsResult = AxiosResponse<InventoryGetInventoryItems200>\nexport type InventoryCreateInventoryItemResult = AxiosResponse<InventoryItem>\nexport type InventoryGetInventoryItemResult = AxiosResponse<InventoryGetInventoryItem200>\nexport type InventoryDeleteInventoryItemResult = AxiosResponse<SuccessResponse>\nexport type InventoryGetInventoryActivitiesResult = AxiosResponse<void>\nexport type InventoryAssignToPatientResult = AxiosResponse<void>\nexport type InventoryAddSerialNumbersResult = AxiosResponse<void>\nexport type InventoryGetLowStockItemsResult = AxiosResponse<void>\nexport type InventoryGetInventoryStatsResult = AxiosResponse<void>\nexport type InventoryGetCategoriesResult = AxiosResponse<InventoryGetCategories200>\nexport type InventoryCreateCategoryResult = AxiosResponse<InventoryCreateCategory201>\nexport type NotificationsListNotificationsResult = AxiosResponse<Notification[]>\nexport type NotificationsDeleteNotificationResult = AxiosResponse<SuccessResponse>\nexport type NotificationsMarkNotificationReadResult = AxiosResponse<void>\nexport type NotificationsNotificationStatsResult = AxiosResponse<void>\nexport type SgkProcessOcrResult = AxiosResponse<void>\nexport type ServeOpenapiYamlResult = AxiosResponse<void>\nexport type PatientsGetPatientsResult = AxiosResponse<PatientsGetPatients200>\nexport type PatientsCreatePatientResult = AxiosResponse<Patient>\nexport type PatientsDeletePatientResult = AxiosResponse<SuccessResponse>\nexport type SalesAssignDevicesExtendedResult = AxiosResponse<void>\nexport type PatientSubresourcesCreatePatientEreceiptResult = AxiosResponse<void>\nexport type PatientSubresourcesDeletePatientEreceiptResult = AxiosResponse<void>\nexport type PatientSubresourcesAddPatientHearingTestResult = AxiosResponse<void>\nexport type PatientSubresourcesDeletePatientHearingTestResult = AxiosResponse<void>\nexport type PatientSubresourcesCreatePatientNoteResult = AxiosResponse<void>\nexport type PatientSubresourcesDeletePatientNoteResult = AxiosResponse<void>\nexport type SalesGetPatientSalesResult = AxiosResponse<void>\nexport type SgkGetPatientSgkDocumentsResult = AxiosResponse<void>\nexport type TimelineGetPatientTimelineResult = AxiosResponse<TimelineGetPatientTimeline200>\nexport type TimelineAddTimelineEventResult = AxiosResponse<TimelineAddTimelineEvent201>\nexport type TimelineDeleteTimelineEventResult = AxiosResponse<TimelineDeleteTimelineEvent200>\nexport type TimelineLogPatientActivityResult = AxiosResponse<void>\nexport type PatientsBulkUploadPatientsResult = AxiosResponse<void>\nexport type PatientsExportPatientsCsvResult = AxiosResponse<void>\nexport type PatientsSearchPatientsResult = AxiosResponse<void>\nexport type SalesPricingPreviewResult = AxiosResponse<void>\nexport type SuppliersDeleteProductSupplierResult = AxiosResponse<void>\nexport type SuppliersAddProductSupplierResult = AxiosResponse<void>\nexport type RegistrationRegisterPhoneResult = AxiosResponse<void>\nexport type ReportsReportAppointmentsResult = AxiosResponse<void>\nexport type ReportsReportCampaignsResult = AxiosResponse<void>\nexport type ReportsReportFinancialResult = AxiosResponse<void>\nexport type ReportsReportOverviewResult = AxiosResponse<void>\nexport type ReportsReportPatientsResult = AxiosResponse<void>\nexport type ReportsReportRevenueResult = AxiosResponse<void>\nexport type SalesListSalesResult = AxiosResponse<Sale[]>\nexport type SalesCreateSaleResult = AxiosResponse<Sale>\nexport type SalesGetSaleResult = AxiosResponse<Sale>\nexport type SalesUpdateSaleResult = AxiosResponse<Sale>\nexport type SalesDeleteSaleResult = AxiosResponse<void>\nexport type SalesCreateSalePaymentPlanResult = AxiosResponse<PaymentRecord>\nexport type UpdateSettingsResult = AxiosResponse<void>\nexport type SgkUploadSgkDocumentResult = AxiosResponse<void>\nexport type SgkDeleteSgkDocumentResult = AxiosResponse<void>\nexport type SmsMonitoringResult = AxiosResponse<void>\nexport type SuppliersGetSuppliersResult = AxiosResponse<SuppliersGetSuppliers200>\nexport type SuppliersCreateSupplierResult = AxiosResponse<Supplier>\nexport type SuppliersDeleteSupplierResult = AxiosResponse<SuccessResponse>\nexport type SuppliersGetSupplierProductsResult = AxiosResponse<void>\nexport type SuppliersGetSupplierStatsResult = AxiosResponse<void>\nexport type RegistrationVerifyRegistrationOtpResult = AxiosResponse<void>\nexport type UsersListUsersResult = AxiosResponse<User[]>\nexport type UsersCreateUserResult = AxiosResponse<User>\nexport type UsersGetUserResult = AxiosResponse<User>\nexport type UsersUpdateUserResult = AxiosResponse<User>\nexport type UsersDeleteUserResult = AxiosResponse<void>\nexport type UsersGetCurrentUserResult = AxiosResponse<User>\nexport type OcrExtractEntitiesResult = AxiosResponse<void>\nexport type OcrExtractPatientNameResult = AxiosResponse<void>\nexport type OcrHealthCheckResult = AxiosResponse<void>\nexport type OcrInitDatabaseResult = AxiosResponse<void>\nexport type OcrInitializeNlpEndpointResult = AxiosResponse<void>\nexport type OcrProcessDocumentResult = AxiosResponse<void>\nexport type OcrCalculateSimilarityResult = AxiosResponse<void>\nexport type ServeSwaggerUiResult = AxiosResponse<void>\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/global.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[403,406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[403,406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[429,432],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[429,432],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[456,459],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[456,459],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[480,483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[480,483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[504,507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[504,507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[521,524],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[521,524],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[541,544],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[541,544],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[565,568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[565,568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[673,676],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[673,676],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Temporary global type shims for triage\n// These are low-risk, reversible declarations to reduce noisy TS errors\n// while we systematically fix the real types. Remove or replace with\n// proper definitions as part of the type-cleanup work.\n\n// Minimal patient-related type shims used during triage.\n// Replace these with proper exports from `patient-communication.types.ts` later.\ntype Communication = any;\ntype PatientReport = any;\ntype EReceiptRecord = any;\ntype Appointment = any;\ntype Installment = any;\ntype Sale = any;\ntype SGKInfo = any;\ntype SGKWorkflow = any;\n\n// Allow importing JSON and other loose assets during triage\ndeclare module '*.json' {\n  const value: any;\n  export default value;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/inventory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/invoice-schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/invoice.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2323,2326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2323,2326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":281,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6337,6340],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6337,6340],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Invoice Types for X-Ear CRM\n// Based on legacy EFatura structure and OpenAPI schema\n\nexport type InvoiceStatus = \n  | 'draft'        // taslak\n  | 'sent'         // gonderildi\n  | 'approved'     // onaylandi\n  | 'rejected'     // reddedildi\n  | 'cancelled'    // iptal\n  | 'paid'         // odendi\n  | 'overdue';     // gecikmiş\n\nexport type InvoiceType = \n  | 'sale'         // satış faturası\n  | 'service'      // hizmet faturası\n  | 'proforma'     // proforma fatura\n  | 'return'       // iade faturası\n  | 'replacement'  // değişim faturası\n  | 'sgk';         // SGK faturası\n\n// Backwards-compatible aliases used in some legacy services\nexport type InvoiceTypeLegacy = InvoiceType | 'standard' | 'credit_note' | 'debit_note';\n\nexport type PaymentMethod = \n  | 'cash'         // nakit\n  | 'credit_card'  // kredi kartı\n  | 'bank_transfer'// havale\n  | 'installment'  // taksit\n  | 'sgk'          // SGK\n  | 'check';       // çek\n\nexport type TaxType = \n  | 'kdv'          // KDV\n  | 'otv'          // ÖTV\n  | 'tevkifat'     // Tevkifat\n  | 'stopaj';      // Stopaj\n\nexport interface InvoiceItem {\n  id: string;\n  productId?: string;\n  inventoryItemId?: string;\n  name: string;\n  description?: string;\n  quantity: number;\n  unitPrice: number;\n  discount?: number;\n  discountType?: 'percentage' | 'amount';\n  taxRate: number;\n  taxAmount: number;\n  totalPrice: number;\n  \n  // SGK specific fields\n  sgkCode?: string;\n  isMinistryTracked?: boolean;\n  \n  // Device specific fields\n  serialNumber?: string;\n  warrantyPeriod?: number;\n  // legacy/category used by some services\n  category?: string;\n}\n\nexport interface InvoiceAddress {\n  name: string;\n  address: string;\n  city: string;\n  district?: string;\n  postalCode?: string;\n  country?: string;\n  taxNumber?: string;\n  taxOffice?: string;\n}\n\nexport interface InvoiceTax {\n  type: TaxType;\n  rate: number;\n  baseAmount: number;\n  taxAmount: number;\n}\n\nexport interface Invoice {\n  id: string;\n  invoiceNumber: string;\n  type: InvoiceTypeLegacy;\n  status: InvoiceStatus;\n  \n  // Patient/Customer information\n  patientId?: string;\n  patientName: string;\n  patientPhone?: string;\n  patientTcNumber?: string;\n  // Legacy customer fields (some services use customer* names)\n  customerId?: string;\n  customerName?: string;\n  customerTaxNumber?: string;\n  customerAddress?: any;\n  \n  // Items\n  items?: InvoiceItem[];\n  \n  // Address information\n  billingAddress?: InvoiceAddress;\n  shippingAddress?: InvoiceAddress;\n  issueDate?: string;\n  dueDate?: string;\n  paymentDate?: string;\n  paymentMethod?: PaymentMethod;\n  \n  subtotal?: number;\n  totalDiscount?: number;\n  taxes?: InvoiceTax[] | Array<{ type: string; rate: number; amount: number }>;\n  totalTax?: number;\n  // legacy name used in some services\n  totalAmount?: number;\n  grandTotal?: number;\n  \n  // Currency\n  currency: string; // Default: 'TRY'\n  exchangeRate?: number;\n  \n  // Notes and references\n  notes?: string;\n  internalNotes?: string;\n  referenceNumber?: string;\n  orderNumber?: string;\n  \n  // E-Fatura specific fields\n  ettn?: string; // E-Fatura ETTN\n  gibStatus?: 'not_sent' | 'sent' | 'accepted' | 'rejected';\n  gibSentDate?: string;\n  gibResponseDate?: string;\n  gibErrorMessage?: string;\n  \n  // SGK specific fields\n  sgkSubmissionId?: string;\n  createdAt?: string;\n  updatedAt?: string;\n  createdBy?: string;\n  updatedBy?: string;\n  pdfUrl?: string;\n  xmlUrl?: string;\n  attachments?: InvoiceAttachment[];\n}\n\nexport interface InvoiceAttachment {\n  id: string;\n  name: string;\n  type: string;\n  size: number;\n  url: string;\n  uploadedAt: string;\n  uploadedBy: string;\n}\n\nexport interface InvoiceTemplate {\n  id: string;\n  name: string;\n  type: InvoiceType;\n  description?: string;\n  category: string;\n  isDefault?: boolean;\n  isActive?: boolean;\n  usageCount?: number;\n\n  // Template data\n  templateData: unknown; // Full invoice form data\n  items: Partial<InvoiceItem>[];\n  fields?: string[]; // Template fields\n  defaultPaymentMethod?: PaymentMethod;\n  defaultDueDays?: number;\n  defaultNotes?: string;\n\n  // Template settings\n  autoCalculateTax?: boolean;\n  requireApproval?: boolean;\n\n  // Metadata\n  createdAt: string;\n  updatedAt: string;\n  createdBy: string;\n}\n\nexport interface CreateInvoiceTemplateData {\n  name: string;\n  description?: string;\n  category: string;\n  templateData: unknown;\n  isActive?: boolean;\n}\n\nexport interface UpdateInvoiceTemplateData {\n  name?: string;\n  description?: string;\n  category?: string;\n  templateData?: unknown;\n  isActive?: boolean;\n}\n\nexport interface InvoiceFilters {\n  search?: string;\n  status?: InvoiceStatus[];\n  type?: InvoiceType[];\n  paymentMethod?: PaymentMethod[];\n  patientId?: string;\n  patientName?: string;\n  // legacy\n  customerId?: string;\n  customerName?: string;\n  invoiceNumber?: string;\n  \n  // Date filters\n  issueDateFrom?: string;\n  issueDateTo?: string;\n  dueDateFrom?: string;\n  dueDateTo?: string;\n  paymentDateFrom?: string;\n  paymentDateTo?: string;\n  \n  // Amount filters\n  amountMin?: number;\n  amountMax?: number;\n  \n  // Status filters\n  isPaid?: boolean;\n  isOverdue?: boolean;\n  hasSgkSubmission?: boolean;\n  gibStatus?: Invoice['gibStatus'];\n  \n  // Pagination\n  page?: number;\n  limit?: number;\n}\n\nexport interface InvoiceSearchResult {\n  invoices: Invoice[];\n  total: number;\n  totalPages: number;\n  page: number;\n  pageSize?: number;\n  limit?: number;\n  hasMore: boolean;\n  filters: InvoiceFilters;\n}\n\nexport interface InvoiceStats {\n  total: number;\n  // provide both structured and legacy keyed stats to match service returns\n  byStatus?: Partial<Record<string, number>>;\n  byType?: Partial<Record<string, number>>;\n  byPaymentMethod?: Partial<Record<string, number>>;\n\n  // Legacy individual status counts\n  draft?: number;\n  sent?: number;\n  paid?: number;\n  overdue?: number;\n  cancelled?: number;\n\n  // Financial stats (optional to allow legacy shapes)\n  totalAmount?: number;\n  paidAmount?: number;\n  pendingAmount?: number;\n  overdueAmount?: number;\n\n  // Monthly stats\n  monthlyRevenue?: number;\n  monthlyCount?: number;\n\n  // SGK stats\n  sgkSubmitted?: number;\n  sgkApproved?: number;\n  sgkPending?: number;\n}\n\nexport interface CreateInvoiceData {\n  type: InvoiceTypeLegacy | InvoiceType;\n  // Legacy customer fields\n  customerId?: string;\n  customerName?: string;\n  customerTaxNumber?: string;\n  customerAddress?: any;\n\n  patientId?: string;\n  patientName?: string;\n  patientPhone?: string;\n  patientTcNumber?: string;\n  deviceId?: string;\n\n  invoiceNumber?: string;\n  billingAddress?: InvoiceAddress;\n  shippingAddress?: InvoiceAddress;\n\n  issueDate?: string;\n  dueDate?: string;\n  paymentMethod?: PaymentMethod;\n\n  items?: Omit<InvoiceItem, 'id' | 'taxAmount' | 'totalPrice'>[];\n\n  // Legacy calculation fields\n  subtotal?: number;\n  taxes?: Array<{ type: string; rate: number; amount: number }>;\n  totalAmount?: number;\n  status?: InvoiceStatus;\n\n  notes?: string;\n  internalNotes?: string;\n  referenceNumber?: string;\n  orderNumber?: string;\n\n  currency?: string;\n  exchangeRate?: number;\n\n  // Attachments\n  attachments?: InvoiceAttachment[];\n\n  // Template options\n  templateId?: string;\n  saveAsTemplate?: boolean;\n  templateName?: string;\n}\n\nexport interface UpdateInvoiceData extends Partial<CreateInvoiceData> {\n  id: string;\n  status?: InvoiceStatus;\n  gibSentDate?: string;\n  paymentDate?: string;\n  ettn?: string;\n}\n\nexport interface InvoiceFormData {\n  type: InvoiceType;\n  patientId?: string;\n  patientName: string;\n  patientPhone?: string;\n  patientTcNumber?: string;\n  \n  // Address forms\n  billingAddress: InvoiceAddress;\n  shippingAddress?: InvoiceAddress;\n  sameAsbilling?: boolean;\n  \n  // Date and payment\n  issueDate: string;\n  dueDate?: string;\n  paymentMethod?: PaymentMethod;\n  \n  // Items\n  items: InvoiceItem[];\n  \n  // Calculations (computed)\n  subtotal: number;\n  totalDiscount: number;\n  totalTax: number;\n  grandTotal: number;\n  \n  // Notes\n  notes?: string;\n  internalNotes?: string;\n  referenceNumber?: string;\n  draft?: number;\n  sent?: number;\n  paid?: number;\n  overdue?: number;\n  orderNumber?: string;\n  \n  // Options\n  currency: string;\n  exchangeRate?: number;\n  autoCalculateTax: boolean;\n  \n  // Template\n  templateId?: string;\n  saveAsTemplate?: boolean;\n  templateName?: string;\n}\n\nexport interface InvoiceValidation {\n  isValid: boolean;\n  errors: Record<string, string>;\n  warnings: Record<string, string>;\n}\n\nexport interface InvoiceCalculation {\n  subtotal: number;\n  totalDiscount: number;\n  taxes: InvoiceTax[];\n  totalTax: number;\n  grandTotal: number;\n  items?: InvoiceItem[]; // Calculated items\n}\n\nexport interface InvoiceAction {\n  type: 'send' | 'cancel' | 'approve' | 'reject' | 'pay' | 'send_to_gib' | 'print' | 'download';\n  label: string;\n  icon?: string;\n  variant?: 'primary' | 'secondary' | 'danger' | 'success';\n  requiresConfirmation?: boolean;\n  confirmationMessage?: string;\n}\n\nexport interface InvoiceBulkAction {\n  type: 'send' | 'cancel' | 'send_to_gib' | 'export' | 'delete';\n  label: string;\n  icon?: string;\n  requiresConfirmation: boolean;\n  confirmationMessage: string;\n}\n\nexport interface InvoiceExportOptions {\n  format: 'pdf' | 'excel' | 'csv' | 'xml';\n  includeItems?: boolean;\n  includePayments?: boolean;\n  dateRange?: {\n    from: string;\n    to: string;\n  };\n  filters?: InvoiceFilters;\n}\n\n// E-Fatura Integration Types\nexport interface EFaturaSubmission {\n  invoiceId: string;\n  ettn: string;\n  submissionDate: string;\n  status: 'pending' | 'sent' | 'accepted' | 'rejected';\n  responseDate?: string;\n  errorMessage?: string;\n  xmlContent?: string;\n}\n\nexport interface EFaturaBulkSubmission {\n  invoiceIds: string[];\n  submissionDate: string;\n  results: Array<{\n    invoiceId: string;\n    success: boolean;\n    ettn?: string;\n    error?: string;\n  }>;\n}\n\n// Payment Integration Types\nexport interface InvoicePayment {\n  id: string;\n  invoiceId: string;\n  amount: number;\n  paymentMethod: PaymentMethod;\n  paymentDate: string;\n  referenceNumber?: string;\n  notes?: string;\n  \n  // Credit card specific\n  cardLast4?: string;\n  cardType?: string;\n  transactionId?: string;\n  \n  // Bank transfer specific\n  bankName?: string;\n  accountNumber?: string;\n  \n  // Installment specific\n  installmentNumber?: number;\n  totalInstallments?: number;\n  \n  createdAt: string;\n  createdBy: string;\n}\n\nexport interface InvoicePaymentPlan {\n  id?: string;\n  invoiceId: string;\n  totalAmount: number;\n  installments: Array<{\n    number: number;\n    amount: number;\n    dueDate: string;\n    paidDate?: string;\n    status: 'pending' | 'paid' | 'overdue';\n  }>;\n  createdAt: string;\n  updatedAt: string;\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/patient-adapter.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[309,312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[309,312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[357,360],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[357,360],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[385,388],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[385,388],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[434,437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[434,437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[557,560],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[557,560],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2144,2147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2144,2147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2899,2902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2899,2902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4119,4122],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4119,4122],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4974,4977],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4974,4977],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":154,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5876,5879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5876,5879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Adapter Types\n * @fileoverview Adapter types for converting between different patient data formats\n * @version 1.0.0\n */\n\nimport type { Patient } from './patient-base.types';\n\n// Adapter interface for converting between API and UI formats\nexport interface PatientAdapter {\n  fromApi: (apiData: any) => Patient;\n  toApi: (patient: Patient) => any;\n  fromForm: (formData: any) => Patient;\n  toForm: (patient: Patient) => any;\n}\n\n// Legacy conversion function for backward compatibility\nexport const convertOrvalToLegacyPatient = (orvalPatient: any): Patient => {\n  return {\n    id: orvalPatient.id,\n    tcNumber: orvalPatient.identityNumber || orvalPatient.identity_number || orvalPatient.tcNumber,\n    firstName: orvalPatient.firstName || orvalPatient.first_name,\n    lastName: orvalPatient.lastName || orvalPatient.last_name,\n    phone: orvalPatient.phone,\n    email: orvalPatient.email,\n    birthDate: orvalPatient.birthDate || orvalPatient.birth_date,\n    gender: orvalPatient.gender,\n    addressCity: orvalPatient.addressCity || orvalPatient.address_city,\n    addressDistrict: orvalPatient.addressDistrict || orvalPatient.address_district,\n    addressFull: orvalPatient.addressFull || orvalPatient.address_full,\n    status: orvalPatient.status,\n    segment: orvalPatient.segment,\n    acquisitionType: orvalPatient.acquisitionType || orvalPatient.acquisition_type,\n    conversionStep: orvalPatient.conversionStep || orvalPatient.conversion_step,\n    referredBy: orvalPatient.referredBy || orvalPatient.referred_by,\n    priorityScore: orvalPatient.priorityScore || orvalPatient.priority_score || 0,\n    tags: orvalPatient.tags || [],\n    sgkInfo: orvalPatient.sgkInfo || orvalPatient.sgk_info,\n    customData: orvalPatient.customData || orvalPatient.custom_data,\n    createdAt: orvalPatient.createdAt || orvalPatient.created_at,\n    updatedAt: orvalPatient.updatedAt || orvalPatient.updated_at,\n    devices: orvalPatient.devices || [],\n    notes: orvalPatient.notes || [],\n    communications: orvalPatient.communications || [],\n  };\n};\n\n// Create patient request function\nexport const createPatientRequest = (patient: Patient): any => {\n  return {\n    firstName: patient.firstName || '',\n    lastName: patient.lastName || '',\n    identityNumber: patient.tcNumber || '',\n    phone: patient.phone,\n    email: patient.email,\n    birthDate: patient.birthDate,\n    gender: patient.gender,\n    addressCity: patient.addressCity,\n    addressDistrict: patient.addressDistrict,\n    addressFull: patient.addressFull,\n    status: patient.status,\n    segment: patient.segment,\n    acquisitionType: patient.acquisitionType,\n    conversionStep: patient.conversionStep,\n    referredBy: patient.referredBy,\n    priorityScore: patient.priorityScore,\n    tags: patient.tags,\n  };\n};\n\n// Default patient adapter implementation\nexport const defaultPatientAdapter: PatientAdapter = {\n  fromApi: (apiData: any): Patient => {\n    return {\n      id: apiData.id,\n      tcNumber: apiData.tc_number || apiData.tcNumber,\n      firstName: apiData.first_name || apiData.firstName,\n      lastName: apiData.last_name || apiData.lastName,\n      phone: apiData.phone,\n      email: apiData.email,\n      birthDate: apiData.birth_date || apiData.birthDate,\n      gender: apiData.gender,\n      addressCity: apiData.address_city || apiData.addressCity,\n      addressDistrict: apiData.address_district || apiData.addressDistrict,\n      addressFull: apiData.address_full || apiData.addressFull,\n      status: apiData.status,\n      segment: apiData.segment,\n      acquisitionType: apiData.acquisition_type || apiData.acquisitionType,\n      conversionStep: apiData.conversion_step || apiData.conversionStep,\n      referredBy: apiData.referred_by || apiData.referredBy,\n      priorityScore: apiData.priority_score || apiData.priorityScore || 0,\n      tags: apiData.tags || [],\n      sgkInfo: apiData.sgk_info || apiData.sgkInfo,\n      customData: apiData.custom_data || apiData.customData,\n      createdAt: apiData.created_at || apiData.createdAt,\n      updatedAt: apiData.updated_at || apiData.updatedAt,\n    };\n  },\n\n  toApi: (patient: Patient): any => {\n    return {\n      id: patient.id,\n      tc_number: patient.tcNumber,\n      first_name: patient.firstName,\n      last_name: patient.lastName,\n      phone: patient.phone,\n      email: patient.email,\n      birth_date: patient.birthDate,\n      gender: patient.gender,\n      address_city: patient.addressCity,\n      address_district: patient.addressDistrict,\n      address_full: patient.addressFull,\n      status: patient.status,\n      segment: patient.segment,\n      acquisition_type: patient.acquisitionType,\n      conversion_step: patient.conversionStep,\n      referred_by: patient.referredBy,\n      priority_score: patient.priorityScore,\n      tags: patient.tags,\n      sgk_info: patient.sgkInfo,\n      custom_data: patient.customData,\n      created_at: patient.createdAt,\n      updated_at: patient.updatedAt,\n    };\n  },\n\n  fromForm: (formData: any): Patient => {\n    return {\n      id: formData.id,\n      tcNumber: formData.tcNumber,\n      firstName: formData.firstName,\n      lastName: formData.lastName,\n      phone: formData.phone,\n      email: formData.email,\n      birthDate: formData.birthDate,\n      gender: formData.gender,\n      addressCity: formData.addressCity,\n      addressDistrict: formData.addressDistrict,\n      addressFull: formData.addressFull,\n      status: formData.status || 'active',\n      segment: formData.segment,\n      acquisitionType: formData.acquisitionType,\n      conversionStep: formData.conversionStep,\n      referredBy: formData.referredBy,\n      priorityScore: formData.priorityScore || 0,\n      tags: formData.tags || [],\n      sgkInfo: formData.sgkInfo,\n      customData: formData.customData,\n      createdAt: formData.createdAt,\n      updatedAt: formData.updatedAt,\n    };\n  },\n\n  toForm: (patient: Patient): any => {\n    return {\n      id: patient.id,\n      tcNumber: patient.tcNumber,\n      firstName: patient.firstName,\n      lastName: patient.lastName,\n      phone: patient.phone,\n      email: patient.email,\n      birthDate: patient.birthDate,\n      gender: patient.gender,\n      addressCity: patient.addressCity,\n      addressDistrict: patient.addressDistrict,\n      addressFull: patient.addressFull,\n      status: patient.status,\n      segment: patient.segment,\n      acquisitionType: patient.acquisitionType,\n      conversionStep: patient.conversionStep,\n      referredBy: patient.referredBy,\n      priorityScore: patient.priorityScore,\n      tags: patient.tags,\n      sgkInfo: patient.sgkInfo,\n      customData: patient.customData,\n      createdAt: patient.createdAt,\n      updatedAt: patient.updatedAt,\n    };\n  },\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/patient-base.types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/patient-communication.types.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EReceiptStatus' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'InsuranceType' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1945,1948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1945,1948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient Communication Types\n * @fileoverview Communication, reports, and related data structures\n * @version 1.0.0\n */\n\nimport type { \n  CommunicationType, \n  CommunicationDirection, \n  CommunicationStatus,\n  ReportType,\n  AppointmentStatus,\n  PaymentMethod,\n  PaymentStatus,\n  SaleStatus,\n  EReceiptStatus,\n  InsuranceType\n} from './patient-base.types';\n\nexport interface Communication {\n  id: string;\n  type: CommunicationType;\n  direction: CommunicationDirection;\n  content: string;\n  timestamp: string;\n  status: CommunicationStatus;\n  templateId?: string;\n  variables?: Record<string, unknown>;\n}\n\nexport interface PatientReport {\n  id: string;\n  type: ReportType;\n  title: string;\n  content?: string;\n  fileUrl?: string;\n  createdAt: string;\n  createdBy: string;\n  validUntil?: string;\n}\n\nexport interface Appointment {\n  id: string;\n  date: string; // ISO date\n  note?: string;\n  status: AppointmentStatus;\n  createdAt: string;\n}\n\nexport interface Installment {\n  id: string;\n  amount: number;\n  dueDate: string;\n  paidDate?: string;\n  status: PaymentStatus;\n  notes?: string;\n}\n\nexport interface PaymentRecord {\n  id: string;\n  saleId?: string;\n  amount: number;\n  date: string; // ISO\n  method?: PaymentMethod | string;\n  status?: PaymentStatus;\n  note?: string;\n  createdAt?: string;\n}\n\nexport interface Sale {\n  id: string;\n  productId?: string;\n  patientId?: string;\n  saleDate?: string; // ISO\n  listPriceTotal?: number;\n  discountAmount?: number;\n  sgkCoverage?: number;\n  totalAmount: number;\n  paymentMethod?: string;\n  status?: SaleStatus;\n  notes?: string;\n  payments?: PaymentRecord[];\n  createdAt?: string;\n  updatedAt?: string;\n}\n\n// Communication types for patient management\nexport interface CommunicationRecord {\n  id: string;\n  patientId: string;\n  type: 'email' | 'sms' | 'call' | 'letter';\n  content: string;\n  timestamp: Date;\n  status: 'sent' | 'delivered' | 'failed' | 'pending';\n  metadata?: Record<string, any>;\n}\n\nexport interface CommunicationPreferences {\n  preferredMethod: 'call' | 'sms' | 'email' | 'whatsapp';\n  allowMarketing: boolean;\n  allowReminders: boolean;\n  allowEmergency: boolean;\n}\n\n// Commented out unused exports to fix linter errors\n// export enum EReceiptStatus {\n//   PENDING = 'pending',\n//   SENT = 'sent',\n//   DELIVERED = 'delivered',\n//   FAILED = 'failed'\n// }\n\n// export enum InsuranceType {\n//   SGK = 'sgk',\n//   PRIVATE = 'private',\n//   NONE = 'none'\n// }","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/patient-device.types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/patient-search.types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/patient-sgk.types.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SGKStatus' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'InsuranceType' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Patient SGK Types\n * @fileoverview SGK insurance and workflow related types\n * @version 1.0.0\n */\n\nimport type { \n  SGKStatus, \n  InsuranceType, \n  EReceiptStatus \n} from './patient-base.types';\n\nexport interface SGKInfo {\n  id: string;\n  patientId: string;\n  sgkNumber: string;\n  insuranceType: 'sgk' | 'private' | 'none';\n  isActive: boolean;\n  validUntil?: Date;\n  coverageDetails?: string;\n  lastUpdated: Date;\n  hasInsurance?: boolean;\n  insuranceNumber?: string;\n  coveragePercentage?: number;\n  approvalNumber?: string;\n  approvalDate?: string;\n  expiryDate?: string;\n}\n\n// Commented out unused type to fix linter error\n// export type SGKStatus = 'active' | 'inactive' | 'expired' | 'pending';\n\nexport interface SGKWorkflow {\n  currentStatus: string;\n  statusHistory: SGKStatusEntry[];\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface SGKStatusEntry {\n  status: string;\n  timestamp: string;\n  notes?: string;\n  userId?: string;\n}\n\nexport interface EReceiptRecord {\n  id: string;\n  receiptNumber: string;\n  date: string;\n  materials: EReceiptMaterial[];\n  totalAmount: number;\n  vatAmount: number;\n  status: EReceiptStatus;\n  sgkSubmissionId?: string;\n}\n\nexport interface EReceiptMaterial {\n  code: string;\n  name: string;\n  quantity: number;\n  unitPrice: number;\n  vatRate: number;\n  totalPrice: number;\n}\n\n// SGK Document Types\nexport interface SGKDocument {\n  id: string;\n  type: SGKDocumentType;\n  patientId: string;\n  fileName: string;\n  fileUrl: string;\n  uploadDate: string;\n  status: SGKDocumentStatus;\n  extractedData?: SGKExtractedData;\n  validationErrors?: string[];\n}\n\nexport type SGKDocumentType = \n  | 'rapor' \n  | 'recete' \n  | 'fatura' \n  | 'onay-belgesi' \n  | 'diger';\n\nexport type SGKDocumentStatus = \n  | 'uploaded' \n  | 'processing' \n  | 'validated' \n  | 'rejected' \n  | 'submitted';\n\nexport interface SGKExtractedData {\n  patientName?: string;\n  tcNumber?: string;\n  reportDate?: string;\n  doctorName?: string;\n  hospitalName?: string;\n  diagnosis?: string;\n  recommendedDevices?: string[];\n  approvalNumber?: string;\n  validUntil?: string;\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/patient/patient.types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/purchase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/sgk.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/shims-orval.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[102,105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[102,105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[118,121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[118,121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[168,171],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[168,171],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[204,207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[204,207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[216,219],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[216,219],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[232,235],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[232,235],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[280,283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[280,283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[292,295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[292,295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[308,311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[308,311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[357,360],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[357,360],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[373,376],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[373,376],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"declare module \"@/generated/orval\" {\n  export const appointmentsApi: {\n    getAppointments: (params?: any) => Promise<any>;\n    getAppointment: (id: string) => Promise<any>;\n    createAppointment: (body: any, opts?: any) => Promise<any>;\n    updateAppointment: (id: string, body: any, opts?: any) => Promise<any>;\n    deleteAppointment: (id: string, opts?: any) => Promise<any>;\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/types/shims-ui-web.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":2,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":2,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[59,62],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[59,62],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":3,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[87,90],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[87,90],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[114,117],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[114,117],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[141,144],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[141,144],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[173,176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[173,176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"declare module \"@/packages/ui-web\" {\n  export const Modal: any;\n  export const Button: any;\n  export const Input: any;\n  export const Table: any;\n  export const DatePicker: any;\n  export default any;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/barcodeUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/exportUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/fuzzy-search.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1062,1065],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1062,1065],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":111,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3059,3062],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3059,3062],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'includeScore' is assigned a value but never used.","line":119,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":119,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":272,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":272,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7289,7292],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7289,7292],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Advanced Fuzzy Search Utilities\n * Provides intelligent fuzzy string matching capabilities for patient and product search\n */\n\nexport interface FuzzySearchOptions {\n  threshold?: number; // Minimum similarity score (0-1)\n  caseSensitive?: boolean;\n  includeScore?: boolean;\n  keys?: string[]; // Object keys to search in\n  weights?: Record<string, number>; // Field weights for scoring\n  maxResults?: number; // Maximum number of results\n  enablePhonetic?: boolean; // Enable phonetic matching\n  enableTypoTolerance?: boolean; // Enable typo tolerance\n}\n\nexport interface FuzzySearchResult<T> {\n  item: T;\n  score: number;\n  matches: Array<{\n    key: string;\n    value: string;\n    score: number;\n    type: 'exact' | 'partial' | 'fuzzy' | 'phonetic';\n    startIndex?: number;\n    endIndex?: number;\n  }>;\n  relevance: 'high' | 'medium' | 'low';\n}\n\nexport interface SearchableItem {\n  id: string;\n  name: string;\n  brand?: string;\n  model?: string;\n  category?: string;\n  barcode?: string;\n  serialNumber?: string;\n  description?: string;\n  [key: string]: any;\n}\n\n/**\n * Calculate Levenshtein distance between two strings\n */\nexport function levenshteinDistance(str1: string, str2: string): number {\n  const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));\n\n  for (let i = 0; i <= str1.length; i++) {\n    matrix[0][i] = i;\n  }\n\n  for (let j = 0; j <= str2.length; j++) {\n    matrix[j][0] = j;\n  }\n\n  for (let j = 1; j <= str2.length; j++) {\n    for (let i = 1; i <= str1.length; i++) {\n      const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;\n      matrix[j][i] = Math.min(\n        matrix[j][i - 1] + 1, // deletion\n        matrix[j - 1][i] + 1, // insertion\n        matrix[j - 1][i - 1] + indicator // substitution\n      );\n    }\n  }\n\n  return matrix[str2.length][str1.length];\n}\n\n/**\n * Calculate similarity score between two strings (0-1)\n */\nexport function calculateSimilarity(str1: string, str2: string): number {\n  if (str1 === str2) return 1;\n  if (!str1 || !str2) return 0;\n\n  const maxLength = Math.max(str1.length, str2.length);\n  if (maxLength === 0) return 1;\n\n  const distance = levenshteinDistance(str1.toLowerCase(), str2.toLowerCase());\n  return 1 - distance / maxLength;\n}\n\n/**\n * Check if string contains substring with fuzzy matching\n */\nexport function fuzzyContains(haystack: string, needle: string, threshold = 0.6): boolean {\n  if (!haystack || !needle) return false;\n  \n  const haystackLower = haystack.toLowerCase();\n  const needleLower = needle.toLowerCase();\n  \n  // Exact substring match\n  if (haystackLower.includes(needleLower)) return true;\n  \n  // Fuzzy matching for each word in needle\n  const needleWords = needleLower.split(/\\s+/);\n  const haystackWords = haystackLower.split(/\\s+/);\n  \n  return needleWords.every(needleWord => {\n    return haystackWords.some(haystackWord => {\n      return calculateSimilarity(haystackWord, needleWord) >= threshold;\n    });\n  });\n}\n\n/**\n * Perform fuzzy search on array of objects\n */\nexport function fuzzySearch<T extends Record<string, any>>(\n  items: T[],\n  query: string,\n  options: FuzzySearchOptions = {}\n): FuzzySearchResult<T>[] {\n  const {\n    threshold = 0.3,\n    caseSensitive = false,\n    includeScore = true,\n    keys = []\n  } = options;\n\n  if (!query.trim()) return items.map(item => ({ \n    item, \n    score: 1, \n    matches: [], \n    relevance: 'high' as const \n  }));\n\n  const searchQuery = caseSensitive ? query : query.toLowerCase();\n  const results: FuzzySearchResult<T>[] = [];\n\n  for (const item of items) {\n    let maxScore = 0;\n    const matches: Array<{ \n      key: string; \n      value: string; \n      score: number; \n      type: 'exact' | 'partial' | 'fuzzy' | 'phonetic';\n      startIndex?: number;\n      endIndex?: number;\n    }> = [];\n\n    // Search in specified keys or all string properties\n    const searchKeys = keys.length > 0 ? keys : Object.keys(item).filter(key => \n      typeof item[key] === 'string'\n    );\n\n    for (const key of searchKeys) {\n      const value = item[key];\n      if (typeof value !== 'string') continue;\n\n      const searchValue = caseSensitive ? value : value.toLowerCase();\n      \n      // Calculate different types of matches\n      let score = 0;\n      let matchType: 'exact' | 'partial' | 'fuzzy' | 'phonetic' = 'fuzzy';\n      let startIndex = -1;\n      let endIndex = -1;\n      \n      // Exact match (highest score)\n      if (searchValue === searchQuery) {\n        score = 1;\n        matchType = 'exact';\n        startIndex = 0;\n        endIndex = searchQuery.length;\n      }\n      // Starts with (high score)\n      else if (searchValue.startsWith(searchQuery)) {\n        score = 0.9;\n        matchType = 'partial';\n        startIndex = 0;\n        endIndex = searchQuery.length;\n      }\n      // Contains (medium score)\n      else if (searchValue.includes(searchQuery)) {\n        score = 0.8;\n        matchType = 'partial';\n        startIndex = searchValue.indexOf(searchQuery);\n        endIndex = startIndex + searchQuery.length;\n      }\n      // Fuzzy similarity (variable score)\n      else {\n        score = calculateSimilarity(searchValue, searchQuery);\n        matchType = 'fuzzy';\n      }\n\n      if (score >= threshold) {\n        matches.push({ \n          key, \n          value, \n          score, \n          type: matchType,\n          startIndex: startIndex >= 0 ? startIndex : undefined,\n          endIndex: endIndex >= 0 ? endIndex : undefined\n        });\n        maxScore = Math.max(maxScore, score);\n      }\n    }\n\n    if (maxScore >= threshold) {\n      const relevance: 'high' | 'medium' | 'low' = \n        maxScore >= 0.8 ? 'high' : maxScore >= 0.5 ? 'medium' : 'low';\n      \n      results.push({ \n        item, \n        score: maxScore, \n        matches,\n        relevance\n      });\n    }\n  }\n\n  // Sort by score (descending)\n  results.sort((a, b) => b.score - a.score);\n\n  return results;\n}\n\n/**\n * Highlight matching parts in text\n */\nexport function highlightMatches(text: string, query: string, className = 'bg-yellow-200'): string {\n  if (!query.trim()) return text;\n  \n  const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')})`, 'gi');\n  return text.replace(regex, `<span class=\"${className}\">$1</span>`);\n}\n\n/**\n * Get search suggestions based on partial input\n */\n/**\n * Product-specific search function with enhanced fuzzy matching\n */\nexport function searchProducts<T extends SearchableItem>(\n  query: string,\n  products: T[],\n  options?: Partial<FuzzySearchOptions>\n): FuzzySearchResult<T>[] {\n  const productOptions: FuzzySearchOptions = {\n    threshold: 0.2,\n    maxResults: 20,\n    keys: ['name', 'brand', 'model', 'barcode', 'serialNumber', 'category', 'description'],\n    weights: {\n      name: 1.0,\n      brand: 0.9,\n      model: 0.9,\n      barcode: 1.0,\n      serialNumber: 1.0,\n      category: 0.7,\n      description: 0.5\n    },\n    enablePhonetic: true,\n    enableTypoTolerance: true,\n    ...options\n  };\n\n  const results = fuzzySearch(products, query, productOptions);\n  \n  // Apply maxResults limit if specified\n  if (productOptions.maxResults) {\n    return results.slice(0, productOptions.maxResults);\n  }\n  \n  return results;\n}\n\n/**\n * Get search suggestions based on partial input\n */\nexport function getSearchSuggestions<T extends Record<string, any>>(\n  items: T[],\n  partialQuery: string,\n  keys: string[] = [],\n  maxSuggestions = 5\n): string[] {\n  if (!partialQuery.trim()) return [];\n\n  const suggestions = new Set<string>();\n  const query = partialQuery.toLowerCase();\n\n  for (const item of items) {\n    const searchKeys = keys.length > 0 ? keys : Object.keys(item).filter(key => \n      typeof item[key] === 'string'\n    );\n\n    for (const key of searchKeys) {\n      const value = item[key];\n      if (typeof value !== 'string') continue;\n\n      const words = value.toLowerCase().split(/\\s+/);\n      for (const word of words) {\n        if (word.startsWith(query) && word.length > query.length) {\n          suggestions.add(word);\n        }\n      }\n    }\n\n    if (suggestions.size >= maxSuggestions) break;\n  }\n\n  return Array.from(suggestions).slice(0, maxSuggestions);\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/indexeddb.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":223,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7268,7271],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7268,7271],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":225,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":225,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7349,7352],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7349,7352],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8000,8003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8000,8003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// IndexedDB utility for patient data caching\n// Replaces localStorage usage to comply with rule: \"Large data/binary in localStorage ❌\"\n\nimport { Patient } from '../types/patient';\n\nconst DB_NAME = 'XEarPatientDB';\nconst DB_VERSION = 1;\nconst PATIENTS_STORE = 'patients';\nconst CACHE_STORE = 'cache';\nconst BLOBS_STORE = 'blobs';\n\ninterface CacheEntry {\n  key: string;\n  data: unknown;\n  timestamp: number;\n  ttl?: number; // Time to live in milliseconds\n}\n\nclass IndexedDBManager {\n  private db: IDBDatabase | null = null;\n  private initPromise: Promise<void> | null = null;\n\n  async init(): Promise<void> {\n    if (this.initPromise) {\n      return this.initPromise;\n    }\n\n    this.initPromise = new Promise((resolve, reject) => {\n      const request = indexedDB.open(DB_NAME, DB_VERSION);\n\n      request.onerror = () => {\n        reject(new Error('Failed to open IndexedDB'));\n      };\n\n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve();\n      };\n\n      request.onupgradeneeded = (event) => {\n        const db = (event.target as IDBOpenDBRequest).result;\n\n        // Create patients store\n        if (!db.objectStoreNames.contains(PATIENTS_STORE)) {\n          const patientsStore = db.createObjectStore(PATIENTS_STORE, { keyPath: 'id' });\n          patientsStore.createIndex('tcNumber', 'tcNumber', { unique: false });\n          patientsStore.createIndex('status', 'status', { unique: false });\n          patientsStore.createIndex('updatedAt', 'updatedAt', { unique: false });\n        }\n\n        // Create cache store for general caching\n        if (!db.objectStoreNames.contains(CACHE_STORE)) {\n          db.createObjectStore(CACHE_STORE, { keyPath: 'key' });\n        }\n        // Create blobs store for binary attachments\n        if (!db.objectStoreNames.contains(BLOBS_STORE)) {\n          const blobs = db.createObjectStore(BLOBS_STORE, { keyPath: 'id' });\n          blobs.createIndex('createdAt', 'createdAt', { unique: false });\n        }\n      };\n    });\n\n    return this.initPromise;\n  }\n\n  private async ensureDB(): Promise<IDBDatabase> {\n    if (!this.db) {\n      await this.init();\n    }\n    if (!this.db) {\n      throw new Error('IndexedDB not initialized');\n    }\n    return this.db;\n  }\n\n  // Patient-specific methods\n  async savePatients(patients: Patient[]): Promise<void> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([PATIENTS_STORE], 'readwrite');\n    const store = transaction.objectStore(PATIENTS_STORE);\n\n    // Clear existing patients\n    await new Promise<void>((resolve, reject) => {\n      const clearRequest = store.clear();\n      clearRequest.onsuccess = () => resolve();\n      clearRequest.onerror = () => reject(clearRequest.error);\n    });\n\n    // Add new patients\n    for (const patient of patients) {\n      await new Promise<void>((resolve, reject) => {\n        const addRequest = store.add(patient);\n        addRequest.onsuccess = () => resolve();\n        addRequest.onerror = () => reject(addRequest.error);\n      });\n    }\n\n    await new Promise<void>((resolve, reject) => {\n      transaction.oncomplete = () => resolve();\n      transaction.onerror = () => reject(transaction.error);\n    });\n  }\n\n  async getPatients(): Promise<Patient[]> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([PATIENTS_STORE], 'readonly');\n    const store = transaction.objectStore(PATIENTS_STORE);\n\n    return new Promise<Patient[]>((resolve, reject) => {\n      const request = store.getAll();\n      request.onsuccess = () => resolve(request.result || []);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async getPatient(id: string): Promise<Patient | null> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([PATIENTS_STORE], 'readonly');\n    const store = transaction.objectStore(PATIENTS_STORE);\n\n    return new Promise<Patient | null>((resolve, reject) => {\n      const request = store.get(id);\n      request.onsuccess = () => resolve(request.result || null);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async updatePatient(patient: Patient): Promise<void> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([PATIENTS_STORE], 'readwrite');\n    const store = transaction.objectStore(PATIENTS_STORE);\n\n    return new Promise<void>((resolve, reject) => {\n      const request = store.put(patient);\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async deletePatient(id: string): Promise<void> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([PATIENTS_STORE], 'readwrite');\n    const store = transaction.objectStore(PATIENTS_STORE);\n\n    return new Promise<void>((resolve, reject) => {\n      const request = store.delete(id);\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // General cache methods\n  async setCache(key: string, data: unknown, ttl?: number): Promise<void> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([CACHE_STORE], 'readwrite');\n    const store = transaction.objectStore(CACHE_STORE);\n\n    const entry: CacheEntry = {\n      key,\n      data,\n      timestamp: Date.now(),\n      ttl\n    };\n\n    return new Promise<void>((resolve, reject) => {\n      const request = store.put(entry);\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async getCache(key: string): Promise<unknown | null> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([CACHE_STORE], 'readonly');\n    const store = transaction.objectStore(CACHE_STORE);\n\n    return new Promise<unknown | null>((resolve, reject) => {\n      const request = store.get(key);\n      request.onsuccess = () => {\n        const entry = request.result as CacheEntry | undefined;\n        if (!entry) {\n          resolve(null);\n          return;\n        }\n\n        // Check TTL\n        if (entry.ttl && Date.now() - entry.timestamp > entry.ttl) {\n          // Expired, delete and return null\n          this.deleteCache(key);\n          resolve(null);\n          return;\n        }\n\n        resolve(entry.data);\n      };\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  async deleteCache(key: string): Promise<void> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([CACHE_STORE], 'readwrite');\n    const store = transaction.objectStore(CACHE_STORE);\n\n    return new Promise<void>((resolve, reject) => {\n      const request = store.delete(key);\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Save a file blob and return a generated id reference\n  async saveFileBlob(blob: Blob, meta: { filename?: string; mime?: string } = {}): Promise<string> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([BLOBS_STORE], 'readwrite');\n    const store = transaction.objectStore(BLOBS_STORE);\n\n    const id = `blob_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const entry = {\n      id,\n      blob,\n      filename: meta.filename || 'file',\n      mime: meta.mime || ((blob as any)?.type || 'application/octet-stream'),\n      createdAt: Date.now(),\n    } as any;\n\n    return new Promise<string>((resolve, reject) => {\n      const req = store.add(entry);\n      req.onsuccess = () => resolve(id);\n      req.onerror = () => reject(req.error);\n    });\n  }\n\n  // Retrieve a previously stored file blob by id\n  async getFileBlob(id: string): Promise<{ blob: Blob; filename: string; mime: string } | null> {\n    const db = await this.ensureDB();\n    const transaction = db.transaction([BLOBS_STORE], 'readonly');\n    const store = transaction.objectStore(BLOBS_STORE);\n\n    return new Promise((resolve, reject) => {\n      const req = store.get(id);\n      req.onsuccess = () => {\n        const result = req.result as any;\n        if (!result) return resolve(null);\n        resolve({ blob: result.blob, filename: result.filename, mime: result.mime });\n      };\n      req.onerror = () => reject(req.error);\n    });\n  }\n\n  // Fallback to localStorage for critical UI state only\n  async fallbackToLocalStorage(key: string): Promise<unknown | null> {\n    try {\n      const stored = localStorage.getItem(key);\n      return stored ? JSON.parse(stored) : null;\n    } catch (error) {\n      console.warn('Failed to read from localStorage fallback:', error);\n      return null;\n    }\n  }\n\n  async saveFallbackToLocalStorage(key: string, data: unknown): Promise<void> {\n    try {\n      localStorage.setItem(key, JSON.stringify(data));\n    } catch (error) {\n      console.warn('Failed to save to localStorage fallback:', error);\n    }\n  }\n}\n\nexport const indexedDBManager = new IndexedDBManager();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/invoice-validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/outbox.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":317,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":317,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10159,10162],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10159,10162],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":319,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":319,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10310,10313],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10310,10313],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":325,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":325,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10549,10552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10549,10552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":325,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":325,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10597,10600],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10597,10600],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":326,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":326,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10632,10635],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10632,10635],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":326,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":326,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10672,10675],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10672,10675],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * IndexedDB Outbox Implementation\n * Handles offline operations, retry logic, and data synchronization\n */\n\nexport interface OutboxOperation {\n  id?: string;\n  method: 'GET' | 'POST' | 'PUT' | 'PATCH' | 'DELETE';\n  endpoint: string;\n  data?: unknown;\n  headers?: Record<string, string>;\n  timestamp?: number;\n  status?: 'pending' | 'failed' | 'completed';\n  retryCount?: number;\n  maxRetries?: number;\n  priority?: 'high' | 'normal' | 'low';\n  createdAt?: string;\n  lastError?: string;\n  failedAt?: string;\n  nextRetryAt?: string;\n}\n\nexport interface OutboxStats {\n  total: number;\n  pending: number;\n  failed: number;\n  oldestPending: number | null;\n  newestPending: number | null;\n}\n\nexport interface OutboxEvent {\n  type: 'operation-added' | 'operation-updated' | 'operation-removed' | 'operation-succeeded' | 'operation-duplicate' | 'sync-started' | 'sync-completed' | 'sync-failed' | 'failed-operations-cleared';\n  data: unknown;\n  timestamp: number;\n}\n\nexport class IndexedDBOutbox {\n  private dbName = 'XEarOutbox';\n  private dbVersion = 1;\n  private storeName = 'operations';\n  private db: IDBDatabase | null = null;\n  private isOnline = navigator.onLine;\n  private syncInProgress = false;\n  private syncInterval: number | null = null;\n\n  constructor() {\n    this.initDB();\n    this.setupEventListeners();\n    this.startPeriodicSync();\n  }\n\n  private setupEventListeners(): void {\n    window.addEventListener('online', () => {\n      this.isOnline = true;\n      this.syncPendingOperations();\n    });\n\n    window.addEventListener('offline', () => {\n      this.isOnline = false;\n    });\n  }\n\n  private startPeriodicSync(): void {\n    this.syncInterval = window.setInterval(() => {\n      if (this.isOnline && !this.syncInProgress) {\n        this.syncPendingOperations();\n      }\n    }, 120000); // Changed from 30000 (30s) to 120000 (2 minutes) to reduce excessive requests\n  }\n\n  /**\n   * Initialize IndexedDB\n   */\n  private async initDB(): Promise<IDBDatabase> {\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, this.dbVersion);\n\n      request.onerror = () => reject(request.error);\n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve(this.db);\n      };\n\n      request.onupgradeneeded = (event) => {\n        const db = (event.target as IDBOpenDBRequest).result;\n\n        // Create operations store\n        if (!db.objectStoreNames.contains(this.storeName)) {\n          const store = db.createObjectStore(this.storeName, {\n            keyPath: 'id',\n            autoIncrement: true\n          });\n\n          // Create indexes\n          store.createIndex('timestamp', 'timestamp', { unique: false });\n          store.createIndex('endpoint', 'endpoint', { unique: false });\n          store.createIndex('status', 'status', { unique: false });\n          store.createIndex('priority', 'priority', { unique: false });\n        }\n      };\n    });\n  }\n\n  /**\n   * Add operation to outbox\n   */\n  async addOperation(operation: OutboxOperation): Promise<OutboxOperation> {\n    if (!this.db) await this.initDB();\n\n    const operationData: OutboxOperation = {\n      ...operation,\n      id: this.generateOperationId(),\n      timestamp: Date.now(),\n      status: 'pending',\n      retryCount: 0,\n      maxRetries: operation.maxRetries || 3,\n      priority: operation.priority || 'normal',\n      createdAt: new Date().toISOString()\n    };\n\n    // Deduplication: if Idempotency-Key provided and there is already a pending\n    // operation with same endpoint+method+idempotency key, return the existing one\n    try {\n      const idempotencyKey = operationData.headers?.['Idempotency-Key'] || \n                            operationData.headers?.['idempotency-key'] || \n                            operationData.headers?.['Idempotency-key'];\n      \n      if (idempotencyKey) {\n        const pendingOps = await this.getPendingOperations();\n        const existing = pendingOps.find(op => {\n          if (!op || !op.headers) return false;\n          const existingKey = op.headers['Idempotency-Key'] || \n                             op.headers['idempotency-key'] || \n                             op.headers['Idempotency-key'];\n          return op.endpoint === operationData.endpoint && \n                 (op.method || 'GET') === (operationData.method || 'GET') && \n                 existingKey === idempotencyKey;\n        });\n        \n        if (existing) {\n          this.emitOutboxEvent('operation-duplicate', existing);\n          return existing;\n        }\n      }\n    } catch (e) {\n      console.warn('Outbox deduplication check failed, proceeding to add operation:', e);\n    }\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.add(operationData);\n\n      request.onsuccess = () => {\n        this.emitOutboxEvent('operation-added', operationData);\n        resolve(operationData);\n      };\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  /**\n   * Get all pending operations\n   */\n  async getPendingOperations(): Promise<OutboxOperation[]> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const index = store.index('status');\n      const request = index.getAll('pending');\n\n      request.onsuccess = () => {\n        // Sort by priority and timestamp\n        const operations = request.result.sort((a: OutboxOperation, b: OutboxOperation) => {\n          const priorityOrder = { high: 3, normal: 2, low: 1 };\n          const aPriority = priorityOrder[a.priority || 'normal'];\n          const bPriority = priorityOrder[b.priority || 'normal'];\n\n          if (aPriority !== bPriority) {\n            return bPriority - aPriority; // Higher priority first\n          }\n          return (a.timestamp || 0) - (b.timestamp || 0); // Older first\n        });\n\n        resolve(operations);\n      };\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  /**\n   * Update operation status\n   */\n  async updateOperation(id: string, updates: Partial<OutboxOperation>): Promise<OutboxOperation> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      const getRequest = store.get(id);\n\n      getRequest.onsuccess = () => {\n        const operation = getRequest.result;\n        if (!operation) {\n          reject(new Error('Operation not found'));\n          return;\n        }\n\n        const updatedOperation = { ...operation, ...updates };\n        const putRequest = store.put(updatedOperation);\n\n        putRequest.onsuccess = () => {\n          this.emitOutboxEvent('operation-updated', updatedOperation);\n          resolve(updatedOperation);\n        };\n        putRequest.onerror = () => reject(putRequest.error);\n      };\n      getRequest.onerror = () => reject(getRequest.error);\n    });\n  }\n\n  /**\n   * Remove operation from outbox\n   */\n  async removeOperation(id: string): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.delete(id);\n\n      request.onsuccess = () => {\n        this.emitOutboxEvent('operation-removed', { id });\n        resolve();\n      };\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  /**\n   * Sync pending operations\n   */\n  async syncPendingOperations(): Promise<void> {\n    if (this.syncInProgress || !this.isOnline) return;\n\n    this.syncInProgress = true;\n    this.emitOutboxEvent('sync-started', {});\n\n    try {\n      const pendingOps = await this.getPendingOperations();\n      let successCount = 0;\n      let failureCount = 0;\n\n      for (const operation of pendingOps) {\n        try {\n          const result = await this.executeOperation(operation);\n          this.emitOutboxEvent('operation-succeeded', { operation, result });\n          await this.removeOperation(operation.id!);\n          successCount++;\n        } catch (error) {\n          console.error('Operation failed:', error);\n\n          // Update retry count\n          const retryCount = (operation.retryCount || 0) + 1;\n\n          if (retryCount >= (operation.maxRetries || 3)) {\n            // Mark as failed\n            await this.updateOperation(operation.id!, {\n              status: 'failed',\n              retryCount,\n              lastError: error instanceof Error ? error.message : String(error),\n              failedAt: new Date().toISOString()\n            });\n          } else {\n            // Schedule retry\n            await this.updateOperation(operation.id!, {\n              retryCount,\n              lastError: error instanceof Error ? error.message : String(error),\n              nextRetryAt: new Date(Date.now() + this.getRetryDelay(retryCount)).toISOString()\n            });\n          }\n\n          failureCount++;\n        }\n      }\n\n      this.emitOutboxEvent('sync-completed', {\n        total: pendingOps.length,\n        success: successCount,\n        failures: failureCount\n      });\n\n    } catch (error) {\n      console.error('Sync failed:', error);\n      this.emitOutboxEvent('sync-failed', error);\n    } finally {\n      this.syncInProgress = false;\n    }\n  }\n\n  /**\n   * Execute a single operation\n   */\n  private async executeOperation(operation: OutboxOperation): Promise<unknown> {\n    const { method, endpoint, data, headers = {} } = operation;\n\n    // Resolve relative endpoints against the correct API base URL\n    const API_BASE_URL = 'http://localhost:5003';\n    const resolvedEndpoint = endpoint.startsWith('http') \n      ? endpoint \n      : `${API_BASE_URL}${endpoint}`;\n\n    // If operation references a stored blob, retrieve it and send multipart/form-data\n    if (data && (data as any).blobId) {\n      const { indexedDBManager } = await import('@/utils/indexeddb');\n      const blobRef = await indexedDBManager.getFileBlob((data as any).blobId);\n      if (!blobRef) throw new Error('Blob not found for outbox operation');\n\n      const form = new FormData();\n      form.append('file', blobRef.blob, blobRef.filename || 'file');\n      // append metadata\n      if ((data as any).filename) form.append('filename', (data as any).filename);\n      if ((data as any).mime) form.append('mime', (data as any).mime);\n\n      try {\n        const response = await fetch(resolvedEndpoint, {\n          method,\n          headers: {\n            // Let the browser set Content-Type with boundary for FormData\n            ...headers\n          },\n          body: form\n        });\n\n        if (!response.ok) {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n\n        return await response.json();\n      } catch (error) {\n        if (error instanceof TypeError && error.message === 'Failed to fetch') {\n          throw new Error('Network error: Failed to fetch. Please check your connection and ensure the server is running.');\n        }\n        throw error;\n      }\n    }\n\n    try {\n      const response = await fetch(resolvedEndpoint, {\n        method,\n        headers: {\n          'Content-Type': 'application/json',\n          ...headers\n        },\n        body: data ? JSON.stringify(data) : undefined\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      if (error instanceof TypeError && error.message === 'Failed to fetch') {\n        throw new Error('Network error: Failed to fetch. Please check your connection and ensure the server is running.');\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Get retry delay based on retry count (exponential backoff)\n   */\n  private getRetryDelay(retryCount: number): number {\n    const baseDelay = 1000; // 1 second\n    const maxDelay = 60000; // 1 minute\n    const delay = Math.min(baseDelay * Math.pow(2, retryCount), maxDelay);\n\n    // Add jitter to prevent thundering herd\n    return delay + Math.random() * 1000;\n  }\n\n  /**\n   * Generate unique operation ID\n   */\n  private generateOperationId(): string {\n    return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Emit outbox events\n   */\n  private emitOutboxEvent(type: OutboxEvent['type'], data: unknown = {}): void {\n    window.dispatchEvent(new CustomEvent('outbox-event', {\n      detail: { type, data, timestamp: Date.now() }\n    }));\n  }\n\n  /**\n   * Get outbox statistics\n   */\n  async getStats(): Promise<OutboxStats> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([this.storeName], 'readonly');\n      const store = transaction.objectStore(this.storeName);\n      const request = store.getAll();\n\n      request.onsuccess = () => {\n        const operations: OutboxOperation[] = request.result;\n        const stats: OutboxStats = {\n          total: operations.length,\n          pending: operations.filter(op => op.status === 'pending').length,\n          failed: operations.filter(op => op.status === 'failed').length,\n          oldestPending: null,\n          newestPending: null\n        };\n\n        const pendingOps = operations.filter(op => op.status === 'pending');\n        if (pendingOps.length > 0) {\n          stats.oldestPending = Math.min(...pendingOps.map(op => op.timestamp || 0));\n          stats.newestPending = Math.max(...pendingOps.map(op => op.timestamp || 0));\n        }\n\n        resolve(stats);\n      };\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  /**\n   * Clear all failed operations\n   */\n  async clearFailedOperations(): Promise<number> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction([this.storeName], 'readwrite');\n      const store = transaction.objectStore(this.storeName);\n      const index = store.index('status');\n      const request = index.openCursor(IDBKeyRange.only('failed'));\n\n      let deletedCount = 0;\n\n      request.onsuccess = (event) => {\n        const cursor = (event.target as IDBRequest).result;\n        if (cursor) {\n          cursor.delete();\n          deletedCount++;\n          cursor.continue();\n        } else {\n          this.emitOutboxEvent('failed-operations-cleared', { count: deletedCount });\n          resolve(deletedCount);\n        }\n      };\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  /**\n   * Cleanup resources\n   */\n  destroy(): void {\n    if (this.syncInterval) {\n      clearInterval(this.syncInterval);\n      this.syncInterval = null;\n    }\n    if (this.db) {\n      this.db.close();\n      this.db = null;\n    }\n  }\n}\n\n// Create and export singleton instance\n/**\n * In-memory fallback outbox used in non-browser environments (tests / SSR)\n * Implements the minimal subset of the API used by the app so tests can run\n * without a real IndexedDB / window environment.\n */\nclass InMemoryOutbox {\n  private ops: OutboxOperation[] = [];\n\n  async addOperation(operation: OutboxOperation): Promise<OutboxOperation> {\n  const op: OutboxOperation = { ...operation, id: this.generateOperationId(), timestamp: Date.now(), status: 'pending', retryCount: 0, maxRetries: operation.maxRetries || 3 };\n    this.ops.push(op);\n    return op;\n  }\n\n  async getPendingOperations(): Promise<OutboxOperation[]> {\n    return this.ops.filter(op => op.status === 'pending');\n  }\n\n  async updateOperation(id: string, updates: Partial<OutboxOperation>): Promise<OutboxOperation> {\n    const idx = this.ops.findIndex(o => o.id === id);\n    if (idx === -1) throw new Error('Operation not found');\n    this.ops[idx] = { ...this.ops[idx], ...updates };\n    return this.ops[idx];\n  }\n\n  async removeOperation(id: string): Promise<void> {\n    this.ops = this.ops.filter(o => o.id !== id);\n  }\n\n  async syncPendingOperations(): Promise<void> {\n    // no-op in tests\n  }\n\n  async getStats(): Promise<OutboxStats> {\n    const total = this.ops.length;\n    const pending = this.ops.filter(op => op.status === 'pending').length;\n    const failed = this.ops.filter(op => op.status === 'failed').length;\n    return { total, pending, failed, oldestPending: null, newestPending: null };\n  }\n\n  async clearFailedOperations(): Promise<number> {\n    const before = this.ops.length;\n    this.ops = this.ops.filter(o => o.status !== 'failed');\n    return before - this.ops.length;\n  }\n\n  destroy(): void {\n    this.ops = [];\n  }\n\n  private generateOperationId(): string {\n    return `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n}\n\n// Export a browser IndexedDB-backed outbox when available, otherwise an in-memory noop used for tests/SSR\nexport const outbox = (typeof window !== 'undefined' && typeof indexedDB !== 'undefined') ? new IndexedDBOutbox() : new InMemoryOutbox();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/patient-matching.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/saved-queries.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[228,231],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[228,231],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1065,1068],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1065,1068],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1823,1826],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1823,1826],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":299,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7569,7572],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7569,7572],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":299,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7585,7588],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7585,7588],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":301,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":301,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7694,7697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7694,7697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Saved Queries Utilities\n * Manages saved search queries for patient search functionality\n */\n\nexport interface SavedQuery {\n  id: string;\n  name: string;\n  description?: string;\n  query: string;\n  filters: Record<string, any>;\n  createdAt: Date;\n  updatedAt: Date;\n  usageCount: number;\n  lastUsed?: Date;\n  isDefault?: boolean;\n  tags?: string[];\n}\n\nexport interface SavedQueryOptions {\n  maxQueries?: number;\n  storageKey?: string;\n}\n\nconst DEFAULT_OPTIONS: Required<SavedQueryOptions> = {\n  maxQueries: 50,\n  storageKey: 'patient-saved-queries'\n};\n\n/**\n * Saved Queries Manager Class\n */\nexport class SavedQueriesManager {\n  private options: Required<SavedQueryOptions>;\n\n  constructor(options: SavedQueryOptions = {}) {\n    this.options = { ...DEFAULT_OPTIONS, ...options };\n  }\n\n  /**\n   * Load all saved queries from localStorage\n   */\n  loadQueries(): SavedQuery[] {\n    try {\n      const stored = localStorage.getItem(this.options.storageKey);\n      if (!stored) return [];\n\n      const queries = JSON.parse(stored);\n      return queries.map((query: any) => ({\n        ...query,\n        createdAt: new Date(query.createdAt),\n        updatedAt: new Date(query.updatedAt),\n        lastUsed: query.lastUsed ? new Date(query.lastUsed) : undefined\n      }));\n    } catch (error) {\n      console.error('Failed to load saved queries:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Save queries to localStorage\n   */\n  private saveQueries(queries: SavedQuery[]): void {\n    try {\n      localStorage.setItem(this.options.storageKey, JSON.stringify(queries));\n    } catch (error) {\n      console.error('Failed to save queries:', error);\n      throw new Error('Sorgu kaydedilemedi');\n    }\n  }\n\n  /**\n   * Create a new saved query\n   */\n  createQuery(\n    name: string,\n    query: string,\n    filters: Record<string, any>,\n    options: {\n      description?: string;\n      isDefault?: boolean;\n      tags?: string[];\n    } = {}\n  ): SavedQuery {\n    const queries = this.loadQueries();\n    \n    // Check if name already exists\n    if (queries.some(q => q.name === name)) {\n      throw new Error('Bu isimde bir sorgu zaten mevcut');\n    }\n\n    // Remove oldest queries if limit exceeded\n    if (queries.length >= this.options.maxQueries) {\n      queries.sort((a, b) => a.lastUsed?.getTime() || 0 - (b.lastUsed?.getTime() || 0));\n      queries.splice(0, queries.length - this.options.maxQueries + 1);\n    }\n\n    const newQuery: SavedQuery = {\n      id: this.generateId(),\n      name,\n      description: options.description,\n      query,\n      filters,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      usageCount: 0,\n      isDefault: options.isDefault || false,\n      tags: options.tags || []\n    };\n\n    queries.push(newQuery);\n    this.saveQueries(queries);\n    \n    return newQuery;\n  }\n\n  /**\n   * Update an existing query\n   */\n  updateQuery(id: string, updates: Partial<Omit<SavedQuery, 'id' | 'createdAt' | 'usageCount'>>): SavedQuery {\n    const queries = this.loadQueries();\n    const index = queries.findIndex(q => q.id === id);\n    \n    if (index === -1) {\n      throw new Error('Sorgu bulunamadı');\n    }\n\n    const updatedQuery = {\n      ...queries[index],\n      ...updates,\n      updatedAt: new Date()\n    };\n\n    queries[index] = updatedQuery;\n    this.saveQueries(queries);\n    \n    return updatedQuery;\n  }\n\n  /**\n   * Delete a saved query\n   */\n  deleteQuery(id: string): void {\n    const queries = this.loadQueries();\n    const filteredQueries = queries.filter(q => q.id !== id);\n    \n    if (filteredQueries.length === queries.length) {\n      throw new Error('Sorgu bulunamadı');\n    }\n\n    this.saveQueries(filteredQueries);\n  }\n\n  /**\n   * Get a specific query by ID\n   */\n  getQuery(id: string): SavedQuery | null {\n    const queries = this.loadQueries();\n    return queries.find(q => q.id === id) || null;\n  }\n\n  /**\n   * Use a saved query (increment usage count and update last used)\n   */\n  useQuery(id: string): SavedQuery {\n    const queries = this.loadQueries();\n    const index = queries.findIndex(q => q.id === id);\n    \n    if (index === -1) {\n      throw new Error('Sorgu bulunamadı');\n    }\n\n    queries[index].usageCount++;\n    queries[index].lastUsed = new Date();\n    \n    this.saveQueries(queries);\n    return queries[index];\n  }\n\n  /**\n   * Get queries sorted by usage frequency\n   */\n  getPopularQueries(limit = 10): SavedQuery[] {\n    const queries = this.loadQueries();\n    return queries\n      .sort((a, b) => b.usageCount - a.usageCount)\n      .slice(0, limit);\n  }\n\n  /**\n   * Get recently used queries\n   */\n  getRecentQueries(limit = 10): SavedQuery[] {\n    const queries = this.loadQueries();\n    return queries\n      .filter(q => q.lastUsed)\n      .sort((a, b) => (b.lastUsed?.getTime() || 0) - (a.lastUsed?.getTime() || 0))\n      .slice(0, limit);\n  }\n\n  /**\n   * Get default queries\n   */\n  getDefaultQueries(): SavedQuery[] {\n    const queries = this.loadQueries();\n    return queries.filter(q => q.isDefault);\n  }\n\n  /**\n   * Search queries by name or description\n   */\n  searchQueries(searchTerm: string): SavedQuery[] {\n    const queries = this.loadQueries();\n    const term = searchTerm.toLowerCase();\n    \n    return queries.filter(q => \n      q.name.toLowerCase().includes(term) ||\n      (q.description && q.description.toLowerCase().includes(term)) ||\n      (q.tags && q.tags.some(tag => tag.toLowerCase().includes(term)))\n    );\n  }\n\n  /**\n   * Export queries as JSON\n   */\n  exportQueries(): string {\n    const queries = this.loadQueries();\n    return JSON.stringify(queries, null, 2);\n  }\n\n  /**\n   * Import queries from JSON\n   */\n  importQueries(jsonData: string, options: { merge?: boolean } = {}): void {\n    try {\n      const importedQueries: SavedQuery[] = JSON.parse(jsonData);\n      \n      if (!Array.isArray(importedQueries)) {\n        throw new Error('Geçersiz format');\n      }\n\n      const existingQueries = options.merge ? this.loadQueries() : [];\n      const allQueries = [...existingQueries];\n\n      for (const query of importedQueries) {\n        // Validate query structure\n        if (!query.id || !query.name || !query.query) {\n          continue;\n        }\n\n        // Check for duplicates\n        const existingIndex = allQueries.findIndex(q => q.id === query.id);\n        if (existingIndex !== -1) {\n          allQueries[existingIndex] = {\n            ...query,\n            createdAt: new Date(query.createdAt),\n            updatedAt: new Date(query.updatedAt),\n            lastUsed: query.lastUsed ? new Date(query.lastUsed) : undefined\n          };\n        } else {\n          allQueries.push({\n            ...query,\n            createdAt: new Date(query.createdAt),\n            updatedAt: new Date(query.updatedAt),\n            lastUsed: query.lastUsed ? new Date(query.lastUsed) : undefined\n          });\n        }\n      }\n\n      this.saveQueries(allQueries);\n    } catch (error) {\n      console.error('Failed to import queries:', error);\n      throw new Error('Sorgu içe aktarma başarısız');\n    }\n  }\n\n  /**\n   * Clear all saved queries\n   */\n  clearAllQueries(): void {\n    localStorage.removeItem(this.options.storageKey);\n  }\n\n  /**\n   * Generate unique ID for queries\n   */\n  private generateId(): string {\n    return `query_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n}\n\n// Default instance\nexport const savedQueriesManager = new SavedQueriesManager();\n\n// Utility functions for common operations\nexport const savedQueries = {\n  load: () => savedQueriesManager.loadQueries(),\n  create: (name: string, query: string, filters: Record<string, any>, options?: any) => \n    savedQueriesManager.createQuery(name, query, filters, options),\n  update: (id: string, updates: any) => savedQueriesManager.updateQuery(id, updates),\n  delete: (id: string) => savedQueriesManager.deleteQuery(id),\n  use: (id: string) => savedQueriesManager.useQuery(id),\n  getPopular: (limit?: number) => savedQueriesManager.getPopularQueries(limit),\n  getRecent: (limit?: number) => savedQueriesManager.getRecentQueries(limit),\n  search: (term: string) => savedQueriesManager.searchQueries(term)\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/search-analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/storage-migrator.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[983,986],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[983,986],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[991,994],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[991,994],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/uts-csv.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[241,244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[241,244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Papa from 'papaparse';\nimport mapCsvRowToUtsPayload from './uts-mapping';\n\nexport function parseAndMapCsv(content: string) {\n  const parsed = Papa.parse(content, { header: true, skipEmptyLines: true });\n  const rows = (parsed.data as any[]).filter(Boolean);\n\n  const mapped = rows.map((r) => ({ raw: r, mapped: mapCsvRowToUtsPayload(r) }));\n\n  // Simple validation: require serial and patientTc\n  const errors = mapped\n    .map((m, idx) => {\n      const e: string[] = [];\n      if (!m.mapped.serial) e.push('serial_missing');\n      if (!m.mapped.patientTc) e.push('patient_tc_missing');\n      return { row: idx, errors: e };\n    })\n    .filter((r) => r.errors.length > 0);\n\n  return { rows, mapped, errors };\n}\n\nexport default parseAndMapCsv;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/src/utils/uts-mapping.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/vite.config.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[324,327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[324,327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\nimport { TanStackRouterVite } from '@tanstack/router-vite-plugin'\nimport { VitePWA } from 'vite-plugin-pwa'\nimport path from 'path'\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [\n    react(),\n    TanStackRouterVite() as any,\n    VitePWA({\n      registerType: 'autoUpdate',\n      workbox: {\n        globPatterns: ['**/*.{js,css,html,ico,png,svg,woff2}']\n      },\n      includeAssets: ['favicon.ico', 'apple-touch-icon.png', 'masked-icon.svg'],\n      manifest: {\n        name: 'X-Ear Hasta Yönetim Sistemi',\n        short_name: 'X-Ear',\n        description: 'Kulak burun boğaz hasta yönetim ve takip sistemi',\n        theme_color: '#3b82f6',\n        background_color: '#ffffff',\n        display: 'standalone',\n        orientation: 'portrait-primary',\n        scope: '/',\n        start_url: '/',\n        lang: 'tr',\n        categories: ['medical', 'healthcare', 'productivity'],\n        icons: [\n          {\n            src: 'icons/icon-72x72.png',\n            sizes: '72x72',\n            type: 'image/png'\n          },\n          {\n            src: 'icons/icon-96x96.png',\n            sizes: '96x96',\n            type: 'image/png'\n          },\n          {\n            src: 'icons/icon-128x128.png',\n            sizes: '128x128',\n            type: 'image/png'\n          },\n          {\n            src: 'icons/icon-144x144.png',\n            sizes: '144x144',\n            type: 'image/png'\n          },\n          {\n            src: 'icons/icon-152x152.png',\n            sizes: '152x152',\n            type: 'image/png'\n          },\n          {\n            src: 'icons/icon-192x192.png',\n            sizes: '192x192',\n            type: 'image/png'\n          },\n          {\n            src: 'icons/icon-384x384.png',\n            sizes: '384x384',\n            type: 'image/png'\n          },\n          {\n            src: 'icons/icon-512x512.png',\n            sizes: '512x512',\n            type: 'image/png'\n          }\n        ]\n      }\n    })\n  ],\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n      '@x-ear/core': path.resolve(__dirname, '../../packages/core/src'),\n      '@x-ear/ui-web': path.resolve(__dirname, '../../packages/ui-web/src'),\n    },\n  },\n  server: {\n    port: 8080,\n    host: true,\n    proxy: {\n      '/api': {\n        target: 'http://localhost:5003',\n        changeOrigin: true,\n        secure: false,\n      },\n    },\n  },\n  build: {\n    outDir: 'dist',\n    sourcemap: true,\n  },\n})\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/Users/omerozmen/Desktop/x-ear web app/x-ear/apps/web/vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]
