openapi: 3.0.3
info:
  title: X-Ear CRM API (auto-generated)
  version: 0.0.0-auto
servers:
- url: http://localhost:5003
paths:
  /api/admin/features:
    get:
      summary: Return the current feature flags for admin UI.
      description: 'Requires JWT; access to the admin panel itself is verified client-side,
        but

        we still require a logged-in user to fetch flags.'
      operationId: admin_get_features
      tags:
      - Admin
      responses:
        '200':
          description: Success
    patch:
      summary: 'Patch feature flags. Body: { features: { ''integrations_ui'': true
        } }'
      description: 'Authorization: user must have `settings.update` or `features.toggle`.'
      operationId: admin_patch_features
      tags:
      - Admin
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
  /api/appointments:
    get:
      summary: GET /api/appointments
      operationId: appointments_get_appointments
      tags:
      - Appointments
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/appointments
      operationId: appointments_create_appointment
      tags:
      - Appointments
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/appointments/{appointment_id}:
    get:
      summary: GET /api/appointments/{appointment_id}
      operationId: appointments_get_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    patch:
      summary: Update appointment (PUT full update or PATCH partial update)
      operationId: appointments_update_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    put:
      summary: Update appointment (PUT full update or PATCH partial update)
      operationId: appointments_update_appointment_put
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/appointments/{appointment_id}
      operationId: appointments_delete_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/appointments/{appointment_id}/cancel:
    post:
      summary: POST /api/appointments/{appointment_id}/cancel
      operationId: appointments_cancel_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/appointments/{appointment_id}/complete:
    post:
      summary: POST /api/appointments/{appointment_id}/complete
      operationId: appointments_complete_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/appointments/{appointment_id}/reschedule:
    post:
      summary: POST /api/appointments/{appointment_id}/reschedule
      operationId: appointments_reschedule_appointment
      tags:
      - Appointments
      parameters:
      - name: appointment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/appointments/availability:
    get:
      summary: GET /api/appointments/availability
      operationId: appointments_get_availability
      tags:
      - Appointments
      responses:
        '200':
          description: Success
  /api/appointments/list:
    get:
      summary: GET /api/appointments/list
      operationId: appointments_list_appointments
      tags:
      - Appointments
      responses:
        '200':
          description: Success
  /api/apps:
    get:
      summary: GET /api/apps
      operationId: apps_list_apps
      tags:
      - Apps
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/apps
      operationId: apps_create_app
      tags:
      - Apps
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/apps/{app_id}:
    get:
      summary: GET /api/apps/{app_id}
      operationId: apps_get_app
      tags:
      - Apps
      parameters:
      - name: app_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    put:
      summary: PUT /api/apps/{app_id}
      operationId: apps_update_app
      tags:
      - Apps
      parameters:
      - name: app_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/apps/{app_id}
      operationId: apps_delete_app
      tags:
      - Apps
      parameters:
      - name: app_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/apps/{app_id}/assign:
    post:
      summary: POST /api/apps/{app_id}/assign
      operationId: apps_assign_role_to_user
      tags:
      - Apps
      parameters:
      - name: app_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/apps/{app_id}/transfer_ownership:
    post:
      summary: POST /api/apps/{app_id}/transfer_ownership
      operationId: apps_transfer_ownership
      tags:
      - Apps
      parameters:
      - name: app_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/audit:
    get:
      summary: GET /api/audit
      operationId: audit_list_audit
      tags:
      - Audit
      responses:
        '200':
          description: Success
  /api/automation/backup:
    post:
      summary: Trigger system backup
      operationId: automation_trigger_backup
      tags:
      - Automation
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/automation/logs:
    get:
      summary: Get automation logs
      operationId: automation_get_automation_logs
      tags:
      - Automation
      responses:
        '200':
          description: Success
  /api/automation/sgk/process:
    post:
      summary: Trigger SGK document processing
      operationId: automation_trigger_sgk_processing
      tags:
      - Automation
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/automation/status:
    get:
      summary: Get automation system status
      operationId: automation_get_automation_status
      tags:
      - Automation
      responses:
        '200':
          description: Success
  /api/campaigns:
    get:
      summary: Get Campaigns
      tags:
      - Campaigns
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      - name: status
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Campaign'
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      page:
                        type: integer
                      perPage:
                        type: integer
                      totalPages:
                        type: integer
    post:
      summary: Create Campaign
      tags:
      - Campaigns
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              - messageTemplate
              properties:
                name:
                  type: string
                description:
                  type: string
                targetSegment:
                  type: string
                  enum:
                  - all
                  - filter
                  - excel
                targetCriteria:
                  type: object
                messageTemplate:
                  type: string
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Campaign'
  /api/campaigns/{campaign_id}/send:
    post:
      summary: Send Campaign
      tags:
      - Campaigns
      parameters:
      - name: campaign_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                senderId:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/cash-records:
    get:
      summary: Return cash register records for cashflow.html consumption.
      description: 'Maps PaymentRecord rows to a simplified format:

        {

        id, date, transactionType, recordType, patientId, patientName, amount, description

        }

        Optional query params:

        - limit: max number of rows (default 200)

        - start_date, end_date: ISO date filters

        - status: filter by payment status (paid/pending/partial)'
      operationId: cash_records_get_cash_records
      tags:
      - Cash-records
      responses:
        '200':
          description: Success
    post:
      summary: Create a new cash record from cashflow.html form submission.
      operationId: cash_records_create_cash_record
      tags:
      - Cash-records
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/cash-records/{record_id}:
    delete:
      summary: Delete a cash record by ID.
      operationId: cash_records_delete_cash_record
      tags:
      - Cash-records
      parameters:
      - name: record_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/config:
    get:
      summary: GET /api/config
      operationId: config_get_config
      tags:
      - Config
      responses:
        '200':
          description: Success
  /api/config/turnstile:
    get:
      summary: GET /api/config/turnstile
      operationId: registration_get_turnstile_config
      tags:
      - Config
      responses:
        '200':
          description: Success
  /api/dashboard:
    get:
      summary: Main dashboard endpoint that returns all dashboard data
      operationId: dashboard_get_dashboard
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
  /api/dashboard/charts/patient-trends:
    get:
      summary: GET /api/dashboard/charts/patient-trends
      operationId: dashboard_patient_trends
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
  /api/dashboard/charts/revenue-trends:
    get:
      summary: GET /api/dashboard/charts/revenue-trends
      operationId: dashboard_revenue_trends
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
  /api/dashboard/kpis:
    get:
      summary: GET /api/dashboard/kpis
      operationId: dashboard_get_kpis
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
  /api/dashboard/recent-activity:
    get:
      summary: GET /api/dashboard/recent-activity
      operationId: dashboard_recent_activity
      tags:
      - Dashboard
      responses:
        '200':
          description: Success
  /api/devices:
    get:
      summary: Get devices with filtering
      operationId: devices_get_devices
      tags:
      - Devices
      responses:
        '200':
          description: Success
    post:
      summary: Create a new device
      operationId: devices_create_device
      tags:
      - Devices
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/devices/{device_id}:
    get:
      summary: Get a specific device
      operationId: devices_get_device
      tags:
      - Devices
      parameters:
      - name: device_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    patch:
      summary: Update a device (PUT full update or PATCH partial update)
      operationId: devices_update_device
      tags:
      - Devices
      parameters:
      - name: device_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    put:
      summary: Update a device (PUT full update or PATCH partial update)
      operationId: devices_update_device_put
      tags:
      - Devices
      parameters:
      - name: device_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: Delete a device
      operationId: devices_delete_device
      tags:
      - Devices
      parameters:
      - name: device_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/devices/{device_id}/stock-update:
    post:
      summary: Update device stock levels (simplified).
      description: "This endpoint is intentionally permissive for tests \u2014 real\
        \ inventory logic\nshould live in a dedicated inventory table/service."
      operationId: devices_update_device_stock
      tags:
      - Devices
      parameters:
      - name: device_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/devices/brands:
    get:
      summary: Get available device brands
      operationId: devices_get_device_brands
      tags:
      - Devices
      responses:
        '200':
          description: Success
  /api/devices/categories:
    get:
      summary: Get available device categories
      operationId: devices_get_device_categories
      tags:
      - Devices
      responses:
        '200':
          description: Success
  /api/devices/low-stock:
    get:
      summary: Get devices with low stock levels
      operationId: devices_get_low_stock_devices
      tags:
      - Devices
      responses:
        '200':
          description: Success
  /api/forgot-password:
    post:
      summary: POST /api/forgot-password
      operationId: auth_forgot_password
      tags:
      - Forgot-password
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/health:
    get:
      summary: Health endpoint exposing overall status and DB read/write check results.
      description: Returns 200 when read+write ok, 503 when write fails, and 500 when
        other errors occur.
      operationId: health_check
      tags:
      - Health
      responses:
        '200':
          description: Success
  /api/inventory:
    get:
      summary: Get all inventory items with optional filtering
      operationId: inventory_get_all_inventory
      tags:
      - Inventory
      parameters:
      - name: category
        in: query
        schema:
          type: string
      - name: search
        in: query
        schema:
          type: string
      - name: lowStock
        in: query
        schema:
          type: boolean
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      items:
                        type: array
                        items:
                          $ref: '#/components/schemas/InventoryItem'
                      total:
                        type: integer
                      page:
                        type: integer
                      perPage:
                        type: integer
                      totalPages:
                        type: integer
  /api/inventory/{item_id}:
    get:
      summary: Get a single inventory item by ID
      operationId: inventory_get_inventory_item
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    put:
      summary: Update an existing inventory item
      operationId: inventory_update_inventory_item
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: Delete an inventory item
      operationId: inventory_delete_inventory_item
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/inventory/{item_id}/activity:
    post:
      summary: Log an activity for an inventory item
      operationId: inventory_log_inventory_activity
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
    get:
      summary: Get activity log for an inventory item
      operationId: inventory_get_inventory_activities
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/inventory/{item_id}/assign:
    post:
      summary: Assign inventory item to a patient (reduces stock)
      operationId: inventory_assign_to_patient
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/inventory/{item_id}/serials:
    post:
      summary: Add serial numbers to an inventory item
      operationId: inventory_add_serial_numbers
      tags:
      - Inventory
      parameters:
      - name: item_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/inventory/low-stock:
    get:
      summary: Get all items with low stock levels
      operationId: inventory_get_low_stock_items
      tags:
      - Inventory
      responses:
        '200':
          description: Success
  /api/inventory/stats:
    get:
      summary: Get inventory statistics
      operationId: inventory_get_inventory_stats
      tags:
      - Inventory
      responses:
        '200':
          description: Success
  /api/inventory/search:
    get:
      summary: Advanced product search with filters
      operationId: inventory_advanced_search
      tags:
      - Inventory
      parameters:
      - name: q
        in: query
        description: Search query for product name, brand, model, barcode
        schema:
          type: string
      - name: category
        in: query
        description: Filter by product category
        schema:
          type: string
      - name: brand
        in: query
        description: Filter by brand
        schema:
          type: string
      - name: minPrice
        in: query
        description: Minimum price filter
        schema:
          type: number
      - name: maxPrice
        in: query
        description: Maximum price filter
        schema:
          type: number
      - name: inStock
        in: query
        description: Filter by stock availability
        schema:
          type: boolean
      - name: lowStock
        in: query
        description: Filter items with low stock
        schema:
          type: boolean
      - name: features
        in: query
        description: Filter by product features (comma-separated)
        schema:
          type: string
      - name: supplier
        in: query
        description: Filter by supplier
        schema:
          type: string
      - name: warrantyPeriod
        in: query
        description: Filter by warranty period (months)
        schema:
          type: integer
      - name: sortBy
        in: query
        description: Sort field
        schema:
          type: string
          enum:
          - name
          - price
          - stock
          - brand
          - category
          - createdAt
      - name: sortOrder
        in: query
        description: Sort order
        schema:
          type: string
          enum:
          - asc
          - desc
      - name: page
        in: query
        description: Page number for pagination
        schema:
          type: integer
          minimum: 1
      - name: limit
        in: query
        description: Items per page
        schema:
          type: integer
          minimum: 1
          maximum: 100
      responses:
        '200':
          description: Advanced search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      items:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                            name:
                              type: string
                            brand:
                              type: string
                            model:
                              type: string
                            category:
                              type: string
                            price:
                              type: number
                            stock:
                              type: integer
                            features:
                              type: array
                              items:
                                type: string
                            supplier:
                              type: string
                            warrantyPeriod:
                              type: integer
                            barcode:
                              type: string
                            status:
                              type: string
                            createdAt:
                              type: string
                            updatedAt:
                              type: string
                      pagination:
                        type: object
                        properties:
                          page:
                            type: integer
                          limit:
                            type: integer
                          total:
                            type: integer
                          totalPages:
                            type: integer
                      filters:
                        type: object
                        properties:
                          categories:
                            type: array
                            items:
                              type: string
                          brands:
                            type: array
                            items:
                              type: string
                          suppliers:
                            type: array
                            items:
                              type: string
                          priceRange:
                            type: object
                            properties:
                              min:
                                type: number
                              max:
                                type: number
                  requestId:
                    type: string
                  timestamp:
                    type: string
        '400':
          description: Invalid search parameters
  /api/inventory/categories:
    get:
      summary: Get all available product categories
      operationId: inventory_get_categories
      tags:
      - Inventory
      responses:
        '200':
          description: Product categories retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        name:
                          type: string
                        count:
                          type: integer
                        description:
                          type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
  /api/inventory/brands:
    get:
      summary: Get all available product brands
      operationId: inventory_get_brands
      tags:
      - Inventory
      responses:
        '200':
          description: Product brands retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        count:
                          type: integer
                        categories:
                          type: array
                          items:
                            type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
  /api/inventory/features:
    get:
      summary: Get all available product features
      operationId: inventory_get_features
      tags:
      - Inventory
      responses:
        '200':
          description: Product features retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        count:
                          type: integer
                        category:
                          type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
  /api/invoices:
    post:
      summary: Create a new invoice
      operationId: invoices_create_invoice
      tags:
      - Invoices
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/invoices/{invoice_id}:
    get:
      summary: Get a specific invoice
      operationId: invoices_get_invoice
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    delete:
      summary: Delete an invoice
      operationId: invoices_delete_invoice
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/invoices/{invoice_id}/pdf:
    get:
      summary: Generate PDF for invoice
      operationId: invoices_generate_invoice_pdf
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
        '404':
          description: Invoice not found
  /api/invoices/{invoice_id}/send-to-gib:
    post:
      summary: "Mark invoice as sent to G\u0130B"
      operationId: invoices_send_invoice_to_gib
      tags:
      - Invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/invoices/batch-generate:
    post:
      summary: Generate multiple invoices in batch
      operationId: invoices_batch_generate
      tags:
      - Invoices
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                saleIds:
                  type: array
                  items:
                    type: string
                invoiceType:
                  type: string
                  enum:
                  - sale
                  - proforma
                  - return
                customerInfo:
                  type: object
                  properties:
                    name:
                      type: string
                    taxId:
                      type: string
                    address:
                      type: string
                    phone:
                      type: string
                    email:
                      type: string
                settings:
                  type: object
                  properties:
                    includeVat:
                      type: boolean
                    vatRate:
                      type: number
                    discountRate:
                      type: number
                    notes:
                      type: string
              required:
              - saleIds
              - invoiceType
      responses:
        '201':
          description: Batch invoices created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoices:
                        type: array
                        items:
                          type: object
                      batchId:
                        type: string
                      totalCount:
                        type: integer
                      successCount:
                        type: integer
                      failedCount:
                        type: integer
                      errors:
                        type: array
                        items:
                          type: object
                  requestId:
                    type: string
                  timestamp:
                    type: string
        '400':
          description: Invalid request data
        '500':
          description: Server error
  /api/invoices/templates:
    get:
      summary: Get available invoice templates
      operationId: invoices_get_templates
      tags:
      - Invoices
      responses:
        '200':
          description: Invoice templates retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        name:
                          type: string
                        description:
                          type: string
                        fields:
                          type: array
                          items:
                            type: object
                        isDefault:
                          type: boolean
                  requestId:
                    type: string
                  timestamp:
                    type: string
    post:
      summary: Create custom invoice template
      operationId: invoices_create_template
      tags:
      - Invoices
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                fields:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                      type:
                        type: string
                      required:
                        type: boolean
                      defaultValue:
                        type: string
                layout:
                  type: object
                  properties:
                    header:
                      type: object
                    body:
                      type: object
                    footer:
                      type: object
              required:
              - name
              - fields
      responses:
        '201':
          description: Template created successfully
        '400':
          description: Invalid template data
  /api/invoices/print-queue:
    get:
      summary: Get invoice print queue status
      operationId: invoices_get_print_queue
      tags:
      - Invoices
      parameters:
      - name: status
        in: query
        schema:
          type: string
          enum:
          - pending
          - processing
          - completed
          - failed
      responses:
        '200':
          description: Print queue status retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      queue:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                            invoiceId:
                              type: string
                            status:
                              type: string
                            priority:
                              type: integer
                            createdAt:
                              type: string
                            processedAt:
                              type: string
                      totalCount:
                        type: integer
                      pendingCount:
                        type: integer
                  requestId:
                    type: string
                  timestamp:
                    type: string
    post:
      summary: Add invoices to print queue
      operationId: invoices_add_to_print_queue
      tags:
      - Invoices
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                invoiceIds:
                  type: array
                  items:
                    type: string
                priority:
                  type: integer
                  minimum: 1
                  maximum: 10
                printOptions:
                  type: object
                  properties:
                    copies:
                      type: integer
                    duplex:
                      type: boolean
                    colorMode:
                      type: string
                      enum:
                      - color
                      - grayscale
              required:
              - invoiceIds
      responses:
        '201':
          description: Invoices added to print queue
        '400':
          description: Invalid request data
  /api/login:
    post:
      summary: POST /api/login
      operationId: auth_login
      tags:
      - Login
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/notifications:
    get:
      summary: Get Notifications
      tags:
      - Notifications
      parameters:
      - name: user_id
        in: query
        required: true
        schema:
          type: string
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'
                  meta:
                    type: object
  /api/notifications/{notification_id}:
    delete:
      summary: DELETE /api/notifications/{notification_id}
      operationId: notifications_delete_notification
      tags:
      - Notifications
      parameters:
      - name: notification_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/notifications/{notification_id}/read:
    put:
      summary: Mark Notification Read
      tags:
      - Notifications
      parameters:
      - name: notification_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
  /api/notifications/settings:
    get:
      summary: GET /api/notifications/settings
      operationId: notifications_get_user_notification_settings
      tags:
      - Notifications
      responses:
        '200':
          description: Success
    put:
      summary: PUT /api/notifications/settings
      operationId: notifications_set_user_notification_settings
      tags:
      - Notifications
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
  /api/notifications/stats:
    get:
      summary: Get Notification Stats
      tags:
      - Notifications
      parameters:
      - name: user_id
        in: query
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      total:
                        type: integer
                      unread:
                        type: integer
  /api/ocr/process:
    post:
      summary: Process Document OCR
      operationId: processDocumentOcr
      tags:
      - OCR
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                image_path:
                  type: string
                text:
                  type: string
                type:
                  type: string
                auto_crop:
                  type: boolean
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  result:
                    type: object
  /api/openapi.yaml:
    get:
      summary: Serve the canonical OpenAPI contract for frontend/back-end sync and
        respond to CORS preflight.
      description: 'Returns CORS headers so the static Swagger UI served from a different
        origin (e.g. localhost:8080)

        can fetch the YAML without browser CORS errors.'
      operationId: serve_openapi_yaml
      tags:
      - Openapi.yaml
      responses:
        '200':
          description: Success
  /api/patients:
    get:
      summary: GET /api/patients
      operationId: patients_list_patients
      tags:
      - Patients
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/patients
      operationId: patients_create_patient
      tags:
      - Patients
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}:
    get:
      summary: GET /api/patients/{patient_id}
      operationId: patients_get_patient
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    patch:
      summary: PATCH /api/patients/{patient_id}
      operationId: patients_update_patient
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    put:
      summary: PUT /api/patients/{patient_id}
      operationId: patients_update_patient_put
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/patients/{patient_id}
      operationId: patients_delete_patient
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/patients/{patient_id}/activities:
    post:
      summary: Log an activity for a patient (alias for timeline event)
      operationId: timeline_log_patient_activity
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/assign-devices-extended:
    post:
      summary: POST /api/patients/{patient_id}/assign-devices-extended
      operationId: sales_assign_devices_extended
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/devices:
    get:
      summary: Get all devices assigned to a specific patient
      operationId: patients_get_patient_devices
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/documents:
    get:
      summary: Get all documents for a patient
      operationId: documents_get_patient_documents
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    post:
      summary: Add a new document to patient
      operationId: documents_add_patient_document
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/documents/{document_id}:
    get:
      summary: Get a specific document
      operationId: documents_get_patient_document
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: document_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    delete:
      summary: Delete a document
      operationId: documents_delete_patient_document
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: document_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/patients/{patient_id}/ereceipts:
    get:
      summary: GET /api/patients/{patient_id}/ereceipts
      operationId: patient_subresources_get_patient_ereceipts
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/patients/{patient_id}/ereceipts
      operationId: patient_subresources_create_patient_ereceipt
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/ereceipts/{ereceipt_id}:
    put:
      summary: PUT /api/patients/{patient_id}/ereceipts/{ereceipt_id}
      operationId: patient_subresources_update_patient_ereceipt
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: ereceipt_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/patients/{patient_id}/ereceipts/{ereceipt_id}
      operationId: patient_subresources_delete_patient_ereceipt
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: ereceipt_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/patients/{patient_id}/hearing-tests:
    get:
      summary: GET /api/patients/{patient_id}/hearing-tests
      operationId: patient_subresources_get_patient_hearing_tests
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/patients/{patient_id}/hearing-tests
      operationId: patient_subresources_add_patient_hearing_test
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/hearing-tests/{test_id}:
    put:
      summary: PUT /api/patients/{patient_id}/hearing-tests/{test_id}
      operationId: patient_subresources_update_patient_hearing_test
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: test_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/patients/{patient_id}/hearing-tests/{test_id}
      operationId: patient_subresources_delete_patient_hearing_test
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: test_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/patients/{patient_id}/invoices:
    get:
      summary: Get all invoices for a patient
      operationId: invoices_get_patient_invoices
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/notes:
    get:
      summary: GET /api/patients/{patient_id}/notes
      operationId: patient_subresources_get_patient_notes
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/patients/{patient_id}/notes
      operationId: patient_subresources_create_patient_note
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/notes/{note_id}:
    put:
      summary: PUT /api/patients/{patient_id}/notes/{note_id}
      operationId: patient_subresources_update_patient_note
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: note_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/patients/{patient_id}/notes/{note_id}
      operationId: patient_subresources_delete_patient_note
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: note_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/patients/{patient_id}/payment-records:
    get:
      summary: Get all payment records for a patient
      operationId: payments_get_patient_payment_records
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/product-sales:
    post:
      summary: Create a new product sale from inventory
      operationId: sales_create_product_sale
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/proformas:
    get:
      summary: Get all proformas for a patient
      operationId: proformas_get_patient_proformas
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/promissory-notes:
    get:
      summary: Get all promissory notes for a patient
      operationId: payments_get_patient_promissory_notes
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/replacements:
    get:
      summary: Get all device replacements for a patient
      operationId: replacements_get_patient_replacements
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    post:
      summary: Create a new device replacement
      operationId: replacements_create_replacement
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/sales:
    get:
      summary: GET /api/patients/{patient_id}/sales
      operationId: sales_get_patient_sales
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/sales/{sale_id}:
    patch:
      summary: Partially update a Sale resource. Supports updating status, notes,
        total_amount, and paid_amount.
      description: 'Expected payload: { "status": "cancelled", "total_amount": 1000.0,
        "paid_amount": 500.0, "notes": "Updated notes" }'
      operationId: sales_update_sale_partial
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/sgk-documents:
    get:
      summary: GET /api/patients/{patient_id}/sgk-documents
      operationId: sgk_get_patient_sgk_documents
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/patients/{patient_id}/timeline:
    get:
      summary: Get timeline events for a patient
      operationId: timeline_get_patient_timeline
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    post:
      summary: Add a new timeline event for a patient
      operationId: timeline_add_timeline_event
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/{patient_id}/timeline/{event_id}:
    delete:
      summary: Delete a timeline event
      operationId: timeline_delete_timeline_event
      tags:
      - Patients
      parameters:
      - name: patient_id
        in: path
        required: true
        schema:
          type: string
      - name: event_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/patients/bulk_upload:
    post:
      summary: Accept a multipart/form-data CSV file containing patients and upsert
        them into the DB.
      description: 'This endpoint is intentionally forgiving: it returns a summary
        of created/updated rows

        and reports per-row errors without aborting the entire batch.

        Authentication is optional for uploads in many workflows; we still log the
        actor when present.'
      operationId: patients_bulk_upload_patients
      tags:
      - Patients
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/patients/export:
    get:
      summary: Export patients as CSV. Only admin users are allowed to perform exports.
      description: 'Supports optional query params: status, segment, q (search term).'
      operationId: patients_export_patients_csv
      tags:
      - Patients
      responses:
        '200':
          description: Success
  /api/patients/search:
    get:
      summary: GET /api/patients/search
      operationId: patients_search_patients
      tags:
      - Patients
      responses:
        '200':
          description: Success
  /api/payment-records:
    post:
      summary: Create a new payment record
      operationId: payments_create_payment_record
      tags:
      - Payment-records
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/payment-records/{record_id}:
    patch:
      summary: Update a payment record
      operationId: payments_update_payment_record
      tags:
      - Payment-records
      parameters:
      - name: record_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
  /api/permissions:
    get:
      summary: List all permissions grouped by category
      operationId: permissions_list_permissions
      tags:
      - Permissions
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        category:
                          type: string
                        label:
                          type: string
                        icon:
                          type: string
                        permissions:
                          type: array
                          items:
                            $ref: '#/components/schemas/Permission'
                  all:
                    type: array
                    items:
                      $ref: '#/components/schemas/Permission'
    post:
      summary: POST /api/permissions
      operationId: permissions_create_permission
      tags:
      - Permissions
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/permissions/my:
    get:
      summary: Get current user permissions based on their role
      operationId: permissions_get_my_permissions
      tags:
      - Permissions
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      permissions:
                        type: array
                        items:
                          type: string
                      role:
                        type: string
                      isSuperAdmin:
                        type: boolean
  /api/permissions/role/{role_name}:
    get:
      summary: Get permissions for a specific role
      operationId: permissions_get_role_permissions
      tags:
      - Permissions
      parameters:
      - name: role_name
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      role:
                        $ref: '#/components/schemas/Role'
                      permissions:
                        type: array
                        items:
                          type: string
    put:
      summary: Update permissions for a role
      operationId: permissions_update_role_permissions
      tags:
      - Permissions
      parameters:
      - name: role_name
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                permissions:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      role:
                        $ref: '#/components/schemas/Role'
                      permissions:
                        type: array
                        items:
                          type: string
  /api/pricing-preview:
    post:
      summary: POST /api/pricing-preview
      operationId: sales_pricing_preview
      tags:
      - Pricing-preview
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/product-suppliers/{ps_id}:
    put:
      summary: Update a product-supplier relationship
      operationId: suppliers_update_product_supplier
      tags:
      - Product-suppliers
      parameters:
      - name: ps_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: Delete a product-supplier relationship
      operationId: suppliers_delete_product_supplier
      tags:
      - Product-suppliers
      parameters:
      - name: ps_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/products/{product_id}/suppliers:
    get:
      summary: Get all suppliers for a specific product
      operationId: suppliers_get_product_suppliers
      tags:
      - Products
      parameters:
      - name: product_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    post:
      summary: Add a supplier to a product
      operationId: suppliers_add_product_supplier
      tags:
      - Products
      parameters:
      - name: product_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/proformas:
    post:
      summary: Create a new proforma
      operationId: proformas_create_proforma
      tags:
      - Proformas
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/proformas/{proforma_id}:
    get:
      summary: Get a specific proforma
      operationId: proformas_get_proforma
      tags:
      - Proformas
      parameters:
      - name: proforma_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/proformas/{proforma_id}/convert:
    post:
      summary: 'Convert a proforma into a sale: create Sale and DeviceAssignment records
        and mark proforma converted.'
      operationId: proformas_convert_proforma_to_sale
      tags:
      - Proformas
      parameters:
      - name: proforma_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/promissory-notes:
    post:
      summary: Create multiple promissory notes
      operationId: payments_create_promissory_notes
      tags:
      - Promissory-notes
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/promissory-notes/{note_id}:
    patch:
      summary: Update a promissory note
      operationId: payments_update_promissory_note
      tags:
      - Promissory-notes
      parameters:
      - name: note_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
  /api/promissory-notes/{note_id}/collect:
    post:
      summary: Collect payment for a promissory note (full or partial)
      operationId: payments_collect_promissory_note
      tags:
      - Promissory-notes
      parameters:
      - name: note_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/register-phone:
    post:
      summary: POST /api/register-phone
      operationId: registration_register_phone
      tags:
      - Register-phone
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/replacements/{replacement_id}/invoice:
    post:
      summary: Create return invoice for a replacement
      operationId: replacements_create_return_invoice
      tags:
      - Replacements
      parameters:
      - name: replacement_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/reports/appointments:
    get:
      summary: GET /api/reports/appointments
      operationId: reports_report_appointments
      tags:
      - Reports
      responses:
        '200':
          description: Success
  /api/reports/campaigns:
    get:
      summary: Kampanya raporu
      operationId: reports_report_campaigns
      tags:
      - Reports
      responses:
        '200':
          description: Success
  /api/reports/financial:
    get:
      summary: Mali rapor
      operationId: reports_report_financial
      tags:
      - Reports
      responses:
        '200':
          description: Success
  /api/reports/overview:
    get:
      summary: "Genel rapor \xF6zeti"
      operationId: reports_report_overview
      tags:
      - Reports
      responses:
        '200':
          description: Success
  /api/reports/patients:
    get:
      summary: Hasta analizi raporu
      operationId: reports_report_patients
      tags:
      - Reports
      responses:
        '200':
          description: Success
  /api/reports/revenue:
    get:
      summary: GET /api/reports/revenue
      operationId: reports_report_revenue
      tags:
      - Reports
      responses:
        '200':
          description: Success
  /api/return-invoices/{invoice_id}/send-to-gib:
    post:
      summary: Mark invoice as sent to GIB
      operationId: replacements_send_invoice_to_gib
      tags:
      - Return-invoices
      parameters:
      - name: invoice_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/roles:
    get:
      summary: GET /api/roles
      operationId: roles_list_roles
      tags:
      - Roles
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/roles
      operationId: roles_create_role
      tags:
      - Roles
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/roles/{role_id}/permissions:
    post:
      summary: POST /api/roles/{role_id}/permissions
      operationId: roles_add_permission_to_role
      tags:
      - Roles
      parameters:
      - name: role_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/roles/{role_id}/permissions/{permission_id}:
    delete:
      summary: DELETE /api/roles/{role_id}/permissions/{permission_id}
      operationId: roles_remove_permission_from_role
      tags:
      - Roles
      parameters:
      - name: role_id
        in: path
        required: true
        schema:
          type: string
      - name: permission_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/sales:
    get:
      summary: Get all sales with pagination and filtering
      operationId: sales_get_sales
      tags:
      - Sales
      responses:
        '200':
          description: Success
  /api/sales/{sale_id}/invoice:
    post:
      summary: Create invoice for a sale
      operationId: invoices_create_sale_invoice
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
    get:
      summary: Get invoice for a sale
      operationId: invoices_get_sale_invoice
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/sales/{sale_id}/invoice/pdf:
    get:
      summary: Generate PDF for sale invoice
      operationId: sales_generate_sale_invoice_pdf
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
        '404':
          description: Invoice not found for this sale
  /api/sales/{sale_id}/payment-plan:
    post:
      summary: Create payment plan for a sale
      operationId: sales_create_sale_payment_plan
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                planType:
                  type: string
                  enum:
                  - standard
                  - custom
                  - installment
                installmentCount:
                  type: integer
                  minimum: 1
                  maximum: 36
                downPayment:
                  type: number
                  minimum: 0
                monthlyAmount:
                  type: number
                  minimum: 0
                startDate:
                  type: string
                  format: date
                interestRate:
                  type: number
                  minimum: 0
                notes:
                  type: string
              required:
              - planType
      responses:
        '201':
          description: Payment plan created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      saleId:
                        type: string
                      planType:
                        type: string
                      installmentCount:
                        type: integer
                      downPayment:
                        type: number
                      monthlyAmount:
                        type: number
                      totalAmount:
                        type: number
                      startDate:
                        type: string
                      endDate:
                        type: string
                      interestRate:
                        type: number
                      status:
                        type: string
                      createdAt:
                        type: string
                      installments:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                            installmentNumber:
                              type: integer
                            amount:
                              type: number
                            dueDate:
                              type: string
                            status:
                              type: string
                            paidDate:
                              type: string
                            paidAmount:
                              type: number
                  requestId:
                    type: string
                  timestamp:
                    type: string
        '400':
          description: Invalid payment plan data
        '404':
          description: Sale not found
    get:
      summary: Get payment plan for a sale
      operationId: sales_get_sale_payment_plan
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Payment plan retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      saleId:
                        type: string
                      planType:
                        type: string
                      installmentCount:
                        type: integer
                      downPayment:
                        type: number
                      monthlyAmount:
                        type: number
                      totalAmount:
                        type: number
                      startDate:
                        type: string
                      endDate:
                        type: string
                      interestRate:
                        type: number
                      status:
                        type: string
                      createdAt:
                        type: string
                      installments:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                            installmentNumber:
                              type: integer
                            amount:
                              type: number
                            dueDate:
                              type: string
                            status:
                              type: string
                            paidDate:
                              type: string
                            paidAmount:
                              type: number
                  requestId:
                    type: string
                  timestamp:
                    type: string
        '404':
          description: Payment plan not found
  /api/sales/{sale_id}/payments:
    get:
      summary: Get all payments for a sale
      operationId: sales_get_sale_payments
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Payments retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        saleId:
                          type: string
                        amount:
                          type: number
                        paymentMethod:
                          type: string
                        paymentDate:
                          type: string
                        installmentId:
                          type: string
                        notes:
                          type: string
                        status:
                          type: string
                        createdAt:
                          type: string
                  requestId:
                    type: string
                  timestamp:
                    type: string
    post:
      summary: Record a payment for a sale
      operationId: sales_create_sale_payment
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                amount:
                  type: number
                  minimum: 0
                paymentMethod:
                  type: string
                  enum:
                  - cash
                  - card
                  - bank_transfer
                  - check
                  - promissory_note
                paymentDate:
                  type: string
                  format: date
                installmentId:
                  type: string
                notes:
                  type: string
                checkNumber:
                  type: string
                bankName:
                  type: string
                accountNumber:
                  type: string
              required:
              - amount
              - paymentMethod
              - paymentDate
      responses:
        '201':
          description: Payment recorded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      saleId:
                        type: string
                      amount:
                        type: number
                      paymentMethod:
                        type: string
                      paymentDate:
                        type: string
                      installmentId:
                        type: string
                      notes:
                        type: string
                      status:
                        type: string
                      createdAt:
                        type: string
                      remainingBalance:
                        type: number
                  requestId:
                    type: string
                  timestamp:
                    type: string
        '400':
          description: Invalid payment data
        '404':
          description: Sale not found
  /api/sales/{sale_id}/installments/{installment_id}/pay:
    post:
      summary: Pay a specific installment
      operationId: sales_pay_installment
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      - name: installment_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                amount:
                  type: number
                  minimum: 0
                paymentMethod:
                  type: string
                  enum:
                  - cash
                  - card
                  - bank_transfer
                  - check
                  - promissory_note
                paymentDate:
                  type: string
                  format: date
                notes:
                  type: string
              required:
              - amount
              - paymentMethod
              - paymentDate
      responses:
        '200':
          description: Installment payment recorded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      installment:
                        type: object
                        properties:
                          id:
                            type: string
                          installmentNumber:
                            type: integer
                          amount:
                            type: number
                          dueDate:
                            type: string
                          status:
                            type: string
                          paidDate:
                            type: string
                          paidAmount:
                            type: number
                      payment:
                        type: object
                        properties:
                          id:
                            type: string
                          amount:
                            type: number
                          paymentMethod:
                            type: string
                          paymentDate:
                            type: string
                          notes:
                            type: string
                      remainingBalance:
                        type: number
                  requestId:
                    type: string
                  timestamp:
                    type: string
        '400':
          description: Invalid payment data
        '404':
          description: Sale or installment not found
  /api/sales/{sale_id}/promissory-notes:
    get:
      summary: Get all promissory notes for a specific sale
      operationId: payments_get_sale_promissory_notes
      tags:
      - Sales
      parameters:
      - name: sale_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/sales/logs:
    post:
      summary: Create a sales log entry for cashflow.html page
      operationId: sales_create_sales_log
      tags:
      - Sales
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/sales/recalc:
    post:
      summary: "Sat\u0131\u015F kay\u0131tlar\u0131n\u0131n SGK ve hasta \xF6deme\
        \ tutarlar\u0131n\u0131 yeniden hesaplarken kal\u0131c\u0131 olarak g\xFC\
        nceller."
      description: "\u0130ste\u011Fe ba\u011Fl\u0131 filtreler: body veya query i\xE7\
        inde `patientId`, `saleId`, `limit`."
      operationId: sales_recalc_sales
      tags:
      - Sales
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/settings:
    get:
      summary: Get system settings from database
      operationId: get_settings
      tags:
      - Settings
      responses:
        '200':
          description: Success
    put:
      summary: Update system settings
      operationId: update_settings
      tags:
      - Settings
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    post:
      summary: Save system settings
      operationId: save_settings
      tags:
      - Settings
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
    patch:
      summary: Apply partial updates to system settings using dot-path notation.
      description: 'Request body: { "updates": { "company.name": "New", "system.timezone":
        "Europe/London" } }'
      operationId: patch_settings
      tags:
      - Settings
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
  /api/settings/pricing:
    get:
      summary: Get pricing settings specifically
      operationId: get_pricing_settings
      tags:
      - Settings
      responses:
        '200':
          description: Success
  /api/sgk/documents:
    get:
      summary: GET /api/sgk/documents
      operationId: sgk_list_sgk_documents
      tags:
      - Sgk
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/sgk/documents
      operationId: sgk_upload_sgk_document
      tags:
      - Sgk
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/sgk/documents/{document_id}:
    get:
      summary: GET /api/sgk/documents/{document_id}
      operationId: sgk_get_sgk_document
      tags:
      - Sgk
      parameters:
      - name: document_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/sgk/documents/{document_id}
      operationId: sgk_delete_sgk_document
      tags:
      - Sgk
      parameters:
      - name: document_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/sgk/seed-test-patients:
    post:
      summary: 'Development helper: for each image in the repo images/ folder, run
        OCR, extract name and tc_partial,'
      description: 'then insert a Patient record with a generated valid TC that contains
        the partial substring.

        This endpoint is intended for local/dev only and makes a best-effort to avoid
        duplicate inserts.'
      operationId: sgk_seed_test_patients
      tags:
      - Sgk
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/sgk/upload:
    post:
      summary: Accept multipart/form-data uploads under the 'files' field (multiple
        allowed).
      description: 'Saves files to a secure temporary path, runs OCR (worker-first)
        with auto_crop=True

        and returns per-file OCR results including patient_info.'
      operationId: sgk_upload_and_process_files
      tags:
      - Sgk
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/sms/monitoring:
    get:
      summary: GET /api/sms/monitoring
      operationId: sms_monitoring
      tags:
      - Sms
      responses:
        '200':
          description: Success
  /api/suppliers:
    get:
      summary: Get all suppliers with optional filtering and pagination
      operationId: suppliers_get_suppliers
      tags:
      - Suppliers
      responses:
        '200':
          description: Success
    post:
      summary: Create a new supplier
      operationId: suppliers_create_supplier
      tags:
      - Suppliers
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/suppliers/{supplier_id}:
    get:
      summary: Get a single supplier by ID
      operationId: suppliers_get_supplier
      tags:
      - Suppliers
      parameters:
      - name: supplier_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
    put:
      summary: Update an existing supplier
      operationId: suppliers_update_supplier
      tags:
      - Suppliers
      parameters:
      - name: supplier_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: Delete a supplier (soft delete by setting is_active=False)
      operationId: suppliers_delete_supplier
      tags:
      - Suppliers
      parameters:
      - name: supplier_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/suppliers/{supplier_id}/products:
    get:
      summary: Get all products for a specific supplier
      operationId: suppliers_get_supplier_products
      tags:
      - Suppliers
      parameters:
      - name: supplier_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
  /api/suppliers/search:
    get:
      summary: Fast supplier search for autocomplete
      operationId: suppliers_search_suppliers
      tags:
      - Suppliers
      responses:
        '200':
          description: Success
  /api/suppliers/stats:
    get:
      summary: Get supplier statistics
      operationId: suppliers_get_supplier_stats
      tags:
      - Suppliers
      responses:
        '200':
          description: Success
  /api/unified-cash-records:
    get:
      summary: "Birle\u015Fik cash records endpoint'i - t\xFCm finansal kay\u0131\
        tlar\u0131 tek yerden d\xF6nd\xFCr\xFCr."
      description: "\u015Eu kaynak t\xFCrlerini birle\u015Ftirir:\n- Sales (sat\u0131\
        \u015Flar)\n- PaymentRecords (\xF6deme kay\u0131tlar\u0131)\n- Cash Records\
        \ (nakit kay\u0131tlar\u0131)\nQuery parametreleri:\n- limit: maksimum kay\u0131\
        t say\u0131s\u0131 (varsay\u0131lan: 200)\n- start_date, end_date: tarih filtreleri\
        \ (ISO format)\n- record_type: kay\u0131t t\xFCr\xFC filtresi (sale, payment,\
        \ cash)\n- patient_id: hasta ID filtresi\n- status: durum filtresi (paid,\
        \ pending, partial)"
      operationId: unified_cash_get_unified_cash_records
      tags:
      - Unified-cash-records
      responses:
        '200':
          description: Success
  /api/unified-cash-records/summary:
    get:
      summary: "Finansal \xF6zet bilgileri d\xF6nd\xFCr\xFCr."
      description: "Query parametreleri:\n- period: \xF6zet d\xF6nemi (today, week,\
        \ month, year)\n- start_date, end_date: \xF6zel tarih aral\u0131\u011F\u0131"
      operationId: unified_cash_get_cash_summary
      tags:
      - Unified-cash-records
      responses:
        '200':
          description: Success
  /api/users:
    get:
      summary: GET /api/users
      operationId: users_list_users
      tags:
      - Users
      responses:
        '200':
          description: Success
    post:
      summary: POST /api/users
      operationId: users_create_user
      tags:
      - Users
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/users/{user_id}:
    put:
      summary: PUT /api/users/{user_id}
      operationId: users_update_user
      tags:
      - Users
      parameters:
      - name: user_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
    delete:
      summary: DELETE /api/users/{user_id}
      operationId: users_delete_user
      tags:
      - Users
      parameters:
      - name: user_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '204':
          description: Success
  /api/users/me:
    put:
      summary: Update My Profile
      operationId: users_update_me
      tags:
      - Users
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                username:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/User'
  /api/verify-otp:
    post:
      summary: POST /api/verify-otp
      operationId: auth_verify_otp
      tags:
      - Verify-otp
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /api/verify-registration-otp:
    post:
      summary: POST /api/verify-registration-otp
      operationId: registration_verify_registration_otp
      tags:
      - Verify-registration-otp
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /debug_ner:
    post:
      summary: Debug endpoint to run HF NER and spaCy on provided text and return
        detailed outputs.
      description: 'Request JSON: { "text": "..." }

        Returns: { hf_ner: [...], spacy_entities: [...], tokens: [...] }'
      operationId: ocr_debug_ner
      tags:
      - Debug_ner
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /entities:
    post:
      summary: Extract entities from image using OCR
      operationId: ocr_extract_entities
      tags:
      - Entities
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /extract_patient:
    post:
      summary: Extract patient name from image using OCR
      operationId: ocr_extract_patient_name
      tags:
      - Extract_patient
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /health:
    get:
      summary: Health check endpoint (moved from app.py)
      operationId: ocr_health_check
      tags:
      - Health
      responses:
        '200':
          description: Success
  /init-db:
    post:
      summary: Initialize database and create tables
      operationId: ocr_init_database
      tags:
      - Init-db
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /initialize:
    post:
      summary: Initialize NLP/OCR service (non-blocking).
      description: 'Starts model initialization in a background thread so the HTTP
        request

        can return quickly and heavy imports/downloads happen asynchronously.'
      operationId: ocr_initialize_nlp_endpoint
      tags:
      - Initialize
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /process:
    post:
      summary: Process document with OCR
      description: 'Accepts either JSON with {''image_path'': ''/abs/path/to/file''}
        or

        {''text'': ''raw extracted text''} so frontend clients can send text-only

        NLP requests without uploading images to the backend.'
      operationId: ocr_process_document
      tags:
      - Process
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /similarity:
    post:
      summary: Calculate similarity between two images or between two pieces of text
      description: Accepts either {'image_path1':..., 'image_path2':...} or {'text1':...,
        'text2':...}
      operationId: ocr_calculate_similarity
      tags:
      - Similarity
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Success
  /swagger.html:
    get:
      summary: Serve the static Swagger UI page from the repository `public/` folder.
      description: 'This helps local development: visit http://<backend-host>:<port>/swagger.html
        so the

        Swagger UI and `/api/openapi.yaml` are on the same origin and no CORS overrides
        are needed.'
      operationId: serve_swagger_ui
      tags:
      - Swagger.html
      responses:
        '200':
          description: Success
  /api/sms/config:
    get:
      summary: Get SMS Provider Configuration
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/SMSProviderConfig'
    put:
      summary: Update SMS Provider Configuration
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                apiUsername:
                  type: string
                apiPassword:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSProviderConfig'
  /api/sms/headers:
    get:
      summary: List SMS Headers
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SMSHeaderRequest'
    post:
      summary: Request SMS Header
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - headerText
              - headerType
              properties:
                headerText:
                  type: string
                headerType:
                  type: string
                documents:
                  type: array
                  items:
                    type: string
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSHeaderRequest'
  /api/sms/packages:
    get:
      summary: List SMS Packages
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SMSPackage'
  /api/sms/credit:
    get:
      summary: Get Tenant SMS Credit
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantSMSCredit'
  /api/admin/sms/packages:
    get:
      summary: Admin List SMS Packages
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/SMSPackage'
    post:
      summary: Admin Create SMS Package
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              - smsCount
              - price
              properties:
                name:
                  type: string
                description:
                  type: string
                smsCount:
                  type: integer
                price:
                  type: number
                currency:
                  type: string
                isActive:
                  type: boolean
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSPackage'
  /api/admin/sms/packages/{pkg_id}:
    put:
      summary: Admin Update SMS Package
      tags:
      - Sms
      parameters:
      - name: pkg_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                smsCount:
                  type: integer
                price:
                  type: number
                isActive:
                  type: boolean
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSPackage'
  /api/admin/sms/headers:
    get:
      summary: Admin List SMS Headers
      tags:
      - Sms
      parameters:
      - name: status
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/SMSHeaderRequest'
  /api/admin/sms/headers/{header_id}/status:
    put:
      summary: Admin Update SMS Header Status
      tags:
      - Sms
      parameters:
      - name: header_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - status
              properties:
                status:
                  type: string
                  enum:
                  - pending
                  - approved
                  - rejected
                rejectionReason:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSHeaderRequest'
  /api/sms/upload:
    post:
      summary: Upload SMS Document
      tags:
      - Sms
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                  filename:
                    type: string
  /api/sms/audiences:
    get:
      summary: List Target Audiences
      tags:
      - Sms
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TargetAudience'
    post:
      summary: Create Target Audience
      tags:
      - Sms
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              - sourceType
              properties:
                name:
                  type: string
                sourceType:
                  type: string
                  enum:
                  - excel
                  - filter
                filePath:
                  type: string
                totalRecords:
                  type: integer
                filterCriteria:
                  type: object
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TargetAudience'
  /api/sms/audiences/upload:
    post:
      summary: Upload Audience Excel
      tags:
      - Sms
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/TargetAudience'
  /api/activity-logs:
    get:
      summary: Get Activity Logs
      tags:
      - Admin
      parameters:
      - name: entity_type
        in: query
        schema:
          type: string
      - name: entity_id
        in: query
        schema:
          type: string
      - name: user_id
        in: query
        schema:
          type: string
      - name: limit
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ActivityLog'
                  count:
                    type: integer
  /api/users/me/password:
    post:
      summary: Change Password
      operationId: users_change_password
      tags:
      - Users
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
              - currentPassword
              - newPassword
              properties:
                currentPassword:
                  type: string
                newPassword:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/birfatura/sync-invoices:
    post:
      summary: Sync invoices from BirFatura
      operationId: birfatura_sync_invoices
      tags:
      - BirFatura
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                start_date:
                  type: string
                  format: date-time
                end_date:
                  type: string
                  format: date-time
      responses:
        '200':
          description: Success
        '401':
          description: Unauthorized
        '500':
          description: Internal Server Error
  /api/communications/templates:
    get:
      summary: List Communication Templates
      operationId: communications_list_templates
      tags:
      - Communications
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: per_page
        in: query
        schema:
          type: integer
      - name: type
        in: query
        schema:
          type: string
      - name: category
        in: query
        schema:
          type: string
      - name: is_active
        in: query
        schema:
          type: string
      - name: search
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CommunicationTemplate'
                  meta:
                    type: object
    post:
      summary: Create Communication Template
      operationId: communications_create_template
      tags:
      - Communications
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommunicationTemplateCreateBody'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommunicationTemplate'
  /api/communications/templates/{template_id}:
    get:
      summary: Get Communication Template
      operationId: communications_get_template
      tags:
      - Communications
      parameters:
      - name: template_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommunicationTemplate'
    put:
      summary: Update Communication Template
      operationId: communications_update_template
      tags:
      - Communications
      parameters:
      - name: template_id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommunicationTemplateCreateBody'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommunicationTemplate'
    delete:
      summary: Delete Communication Template
      operationId: communications_delete_template
      tags:
      - Communications
      parameters:
      - name: template_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/sms/documents/upload:
    post:
      summary: Upload SMS Document to S3
      operationId: sms_upload_document
      tags:
      - Sms
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required:
              - file
              - documentType
              properties:
                file:
                  type: string
                  format: binary
                documentType:
                  type: string
                  enum:
                  - contract
                  - id_card
                  - residence
                  - tax_plate
                  - activity_cert
                  - signature_circular
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      type:
                        type: string
                      filename:
                        type: string
                      size:
                        type: integer
  /api/sms/documents/{documentType}/download:
    get:
      summary: Get presigned URL for document download
      operationId: sms_download_document
      tags:
      - Sms
      parameters:
      - name: documentType
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  url:
                    type: string
  /api/sms/documents/{documentType}:
    delete:
      summary: Delete SMS Document
      operationId: sms_delete_document
      tags:
      - Sms
      parameters:
      - name: documentType
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/admin/tenants:
    get:
      summary: List Tenants
      operationId: getAdminTenants
      tags:
      - Admin
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: limit
        in: query
        schema:
          type: integer
      - name: status
        in: query
        schema:
          type: string
      - name: search
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenants:
                        type: array
                        items: &id001
                          $ref: '#/components/schemas/Tenant'
                      pagination: &id002
                        $ref: '#/components/schemas/Pagination'
    post:
      summary: Create Tenant
      operationId: createTenant
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema: *id001
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema: *id001
  /api/admin/tenants/{id}:
    get:
      summary: Get Tenant
      operationId: getTenant
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tenant: *id001
    put:
      summary: Update Tenant
      operationId: updateTenant
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema: *id001
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema: *id001
  /api/admin/tenants/{id}/status:
    put:
      summary: Update Tenant Status
      operationId: updateTenantStatus
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema: *id001
  /api/admin/tenants/{id}/users:
    get:
      summary: Get Tenant Users
      operationId: getTenantUsers
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      users:
                        type: array
                        items: &id003
                          $ref: '#/components/schemas/User'
                      pagination: *id002
    post:
      summary: Create Tenant User
      operationId: createTenantUser
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema: *id003
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema: *id003
  /api/admin/tenants/{id}/subscribe:
    post:
      summary: Subscribe Tenant
      operationId: subscribeTenant
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                plan_id:
                  type: string
                billing_interval:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema: *id001
  /api/admin/tenants/{id}/addons:
    post:
      summary: Add Addon to Tenant
      operationId: addTenantAddon
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                addon_id:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema: *id001
  /api/admin/plans:
    get:
      summary: List Plans
      operationId: getAdminPlans
      tags:
      - Admin
      parameters:
      - name: limit
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      plans:
                        type: array
                        items: &id004
                          $ref: '#/components/schemas/Plan'
                      pagination: *id002
    post:
      summary: Create Plan
      operationId: createPlan
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlanInput'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema: *id004
  /api/admin/plans/{id}:
    get:
      summary: Get Plan
      operationId: getPlan
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema: *id004
    put:
      summary: Update Plan
      operationId: updatePlan
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlanInput'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema: *id004
    delete:
      summary: Delete Plan
      operationId: deletePlan
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/admin/addons:
    get:
      summary: List Addons
      operationId: getAdminAddons
      tags:
      - Admin
      parameters:
      - name: limit
        in: query
        schema:
          type: integer
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      addons:
                        type: array
                        items: &id005
                          $ref: '#/components/schemas/AddOn'
                      pagination: *id002
    post:
      summary: Create Addon
      operationId: createAdminAddon
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema: *id005
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema: *id005
  /api/admin/users:
    get:
      summary: List Admin Users
      operationId: getAdminUsers
      tags:
      - Admin
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: limit
        in: query
        schema:
          type: integer
      - name: search
        in: query
        schema:
          type: string
      - name: role
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      users:
                        type: array
                        items: &id006
                          $ref: '#/components/schemas/AdminUser'
                      pagination: *id002
    post:
      summary: Create Admin User
      operationId: createAdminUser
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema: *id006
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema: *id006
  /api/admin/users/all:
    get:
      summary: List All Tenant Users
      operationId: getAllTenantUsers
      tags:
      - Admin
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: limit
        in: query
        schema:
          type: integer
      - name: search
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      users:
                        type: array
                        items: *id006
                      pagination: *id002
  /api/admin/users/all/{id}:
    put:
      summary: Update Any Tenant User
      operationId: updateAnyTenantUser
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                isActive:
                  type: boolean
                email:
                  type: string
                first_name:
                  type: string
                last_name:
                  type: string
                role:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema: *id006
  /api/admin/addons/{id}:
    get:
      summary: Get Addon
      operationId: getAdminAddon
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      addon: *id005
    put:
      summary: Update Addon
      operationId: updateAdminAddon
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema: *id005
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      addon: *id005
    delete:
      summary: Delete Addon
      operationId: deleteAdminAddon
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
  /api/admin/tickets:
    get:
      summary: List Support Tickets
      operationId: getAdminTickets
      tags:
      - Admin
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: limit
        in: query
        schema:
          type: integer
      - name: search
        in: query
        schema:
          type: string
      - name: status
        in: query
        schema:
          type: string
      - name: priority
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      tickets:
                        type: array
                        items: &id007
                          $ref: '#/components/schemas/SupportTicket'
                      pagination: *id002
    post:
      summary: Create Support Ticket
      operationId: createAdminTicket
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                subject:
                  type: string
                description:
                  type: string
                priority:
                  type: string
                category:
                  type: string
                tenant_id:
                  type: string
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      ticket: *id007
  /api/admin/tickets/{id}:
    put:
      summary: Update Support Ticket
      operationId: updateAdminTicket
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                assigned_to:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      ticket: *id007
  /api/admin/settings:
    get:
      summary: Get System Settings
      operationId: getAdminSettings
      tags:
      - Admin
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      settings: &id008
                        $ref: '#/components/schemas/SystemSettings'
    post:
      summary: Update System Settings
      operationId: updateAdminSettings
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema: *id008
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      settings: *id008
    patch:
      summary: Patch System Settings
      operationId: patchAdminSettings
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                updates:
                  type: object
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      settings: *id008
  /api/admin/dashboard/metrics:
    get:
      summary: Get Dashboard Metrics
      operationId: getAdminDashboardMetrics
      tags:
      - Admin
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      metrics:
                        $ref: '#/components/schemas/DashboardMetrics'
  /api/admin/invoices:
    get:
      summary: List Invoices
      operationId: getAdminInvoices
      tags:
      - Admin
      parameters:
      - name: page
        in: query
        schema:
          type: integer
      - name: limit
        in: query
        schema:
          type: integer
      - name: search
        in: query
        schema:
          type: string
      - name: status
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoices:
                        type: array
                        items: &id009
                          $ref: '#/components/schemas/Invoice'
                      pagination: *id002
    post:
      summary: Create Invoice
      operationId: createAdminInvoice
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema: *id009
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoice: *id009
  /api/admin/invoices/{id}:
    get:
      summary: Get Invoice
      operationId: getAdminInvoice
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoice: *id009
  /api/admin/invoices/{id}/payment:
    post:
      summary: Record Payment
      operationId: recordAdminInvoicePayment
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                amount:
                  type: number
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      invoice: *id009
  /api/admin/invoices/{id}/pdf:
    get:
      summary: Get Invoice PDF
      operationId: getAdminInvoicePdf
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/pdf:
              schema:
                type: string
                format: binary
  /api/admin/analytics:
    get:
      summary: Get Analytics Data
      operationId: getAdminAnalytics
      tags:
      - Admin
      parameters:
      - name: start_date
        in: query
        schema:
          type: string
          format: date
      - name: end_date
        in: query
        schema:
          type: string
          format: date
      - name: metric
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/AnalyticsData'
  /api/upload/presigned:
    post:
      summary: Get Presigned Upload URL
      operationId: getPresignedUploadUrl
      tags:
      - Upload
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                filename:
                  type: string
                folder:
                  type: string
                content_type:
                  type: string
              required:
              - filename
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      url:
                        type: string
                      fields:
                        type: object
                      key:
                        type: string
  /api/upload/files:
    get:
      summary: List Files
      operationId: listFiles
      tags:
      - Upload
      parameters:
      - name: folder
        in: query
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      files:
                        type: array
                        items:
                          type: object
                          properties:
                            key:
                              type: string
                            filename:
                              type: string
                            size:
                              type: integer
                            last_modified:
                              type: string
                            url:
                              type: string
  /api/admin/tenants/{id}/users/{userId}:
    put:
      summary: Update Tenant User
      operationId: updateTenantUser
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      - name: userId
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema: *id003
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      user: *id003
  /api/admin/tickets/{id}/responses:
    post:
      summary: Create Ticket Response
      operationId: createTicketResponse
      tags:
      - Admin
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
      responses:
        '201':
          description: Response created
        '404':
          description: Ticket not found
  /api/admin/auth/login:
    post:
      summary: Admin Login
      operationId: adminLogin
      tags:
      - Admin
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
                mfa_token:
                  type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    $ref: '#/components/schemas/AdminUser'
                  requires_mfa:
                    type: boolean
components:
  schemas:
    Permission:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    Role:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        isSystem:
          type: boolean
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/Permission'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    SMSProviderConfig:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        apiUsername:
          type: string
        documentsEmail:
          type: string
        isActive:
          type: boolean
        documents:
          type: array
          items:
            type: object
    SMSHeaderRequest:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        headerText:
          type: string
        headerType:
          type: string
          enum:
          - company_title
          - trademark
          - domain
          - other
        status:
          type: string
          enum:
          - pending
          - approved
          - rejected
        rejectionReason:
          type: string
        documents:
          type: array
          items:
            type: string
        createdAt:
          type: string
          format: date-time
    SMSPackage:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        smsCount:
          type: integer
        price:
          type: number
        currency:
          type: string
        isActive:
          type: boolean
    TenantSMSCredit:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        balance:
          type: integer
        totalPurchased:
          type: integer
        totalUsed:
          type: integer
    Campaign:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        name:
          type: string
        description:
          type: string
        campaignType:
          type: string
        targetSegment:
          type: string
        targetCriteria:
          type: object
        messageTemplate:
          type: string
        status:
          type: string
        totalRecipients:
          type: integer
        successfulSends:
          type: integer
        failedSends:
          type: integer
        createdAt:
          type: string
          format: date-time
        sentAt:
          type: string
          format: date-time
    TargetAudience:
      type: object
      properties:
        id:
          type: string
        tenantId:
          type: string
        name:
          type: string
        sourceType:
          type: string
        totalRecords:
          type: integer
        filterCriteria:
          type: object
        createdAt:
          type: string
          format: date-time
    ActivityLog:
      type: object
      properties:
        id:
          type: string
        userId:
          type: string
        action:
          type: string
        entityType:
          type: string
        entityId:
          type: string
        details:
          type: string
        ipAddress:
          type: string
        userAgent:
          type: string
        createdAt:
          type: string
          format: date-time
    Notification:
      type: object
      properties:
        id:
          type: string
        userId:
          type: string
        title:
          type: string
        message:
          type: string
        type:
          type: string
        read:
          type: boolean
        createdAt:
          type: string
          format: date-time
    User:
      type: object
      properties:
        id:
          type: string
        username:
          type: string
        email:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        role:
          type: string
        phone:
          type: string
        isPhoneVerified:
          type: boolean
        isActive:
          type: boolean
        createdAt:
          type: string
          format: date-time
    CommunicationTemplate:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        templateType:
          type: string
          enum:
          - sms
          - email
        category:
          type: string
        subject:
          type: string
        bodyText:
          type: string
        bodyHtml:
          type: string
        variables:
          type: array
          items:
            type: string
        isActive:
          type: boolean
        isSystem:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CommunicationTemplateCreateBody:
      type: object
      required:
      - name
      - templateType
      - bodyText
      properties:
        name:
          type: string
        description:
          type: string
        templateType:
          type: string
          enum:
          - sms
          - email
        category:
          type: string
        subject:
          type: string
        bodyText:
          type: string
        bodyHtml:
          type: string
        variables:
          type: array
          items:
            type: string
        isActive:
          type: boolean
    InventoryItem:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        brand:
          type: string
        model:
          type: string
        category:
          type: string
        barcode:
          type: string
        stock:
          type: integer
        price:
          type: number
        currency:
          type: string
        minStockLevel:
          type: integer
        isActive:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    Tenant:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        slug:
          type: string
        owner_email:
          type: string
        billing_email:
          type: string
        status:
          type: string
          enum:
          - active
          - trial
          - suspended
          - cancelled
        current_plan:
          type: string
        current_plan_id:
          type: string
        max_users:
          type: integer
        current_users:
          type: integer
        subscription_start_date:
          type: string
          format: date-time
        subscription_end_date:
          type: string
          format: date-time
        feature_usage:
          type: object
        created_at:
          type: string
          format: date-time
    TenantStatus:
      type: string
      enum:
      - active
      - trial
      - suspended
      - cancelled
    Plan:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        plan_type:
          type: string
        price:
          type: number
        currency:
          type: string
        billing_interval:
          type: string
        features:
          type: object
        max_users:
          type: integer
        max_storage_gb:
          type: integer
        is_active:
          type: boolean
        is_public:
          type: boolean
        created_at:
          type: string
          format: date-time
    PlanInput:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        plan_type:
          type: string
        price:
          type: number
        billing_interval:
          type: string
        features:
          type: object
        max_users:
          type: integer
        max_storage_gb:
          type: integer
        is_active:
          type: boolean
    AddOn:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        slug:
          type: string
        description:
          type: string
        addon_type:
          type: string
          enum:
          - FLAT_FEE
          - PER_USER
          - USAGE_BASED
        price:
          type: number
        currency:
          type: string
        limit_amount:
          type: integer
        unit_name:
          type: string
        is_active:
          type: boolean
    AdminUser:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
        first_name:
          type: string
        last_name:
          type: string
        role:
          $ref: '#/components/schemas/AdminUserRole'
        is_active:
          type: boolean
        isActive:
          type: boolean
        last_login:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time
        tenant_id:
          type: string
        tenant_name:
          type: string
    AdminUserRole:
      type: string
      enum:
      - tenant_admin
      - admin
      - user
      - doctor
      - secretary
      - support
    Pagination:
      type: object
      properties:
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
        totalPages:
          type: integer
    SupportTicket:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        description:
          type: string
        status:
          type: string
          enum:
          - open
          - in_progress
          - resolved
          - closed
        priority:
          type: string
          enum:
          - low
          - medium
          - high
          - critical
        category:
          type: string
        tenant_id:
          type: string
        tenant_name:
          type: string
        created_by:
          type: string
        assigned_to:
          type: string
        assigned_admin_name:
          type: string
        created_at:
          type: string
          format: date-time
        sla_due_date:
          type: string
          format: date-time
    SystemSettings:
      type: object
      properties:
        siteName:
          type: string
        siteDescription:
          type: string
        timezone:
          type: string
        language:
          type: string
        currency:
          type: string
        maintenanceMode:
          type: boolean
        registrationEnabled:
          type: boolean
        emailNotifications:
          type: boolean
        autoBackup:
          type: boolean
        smtpHost:
          type: string
        smtpPort:
          type: string
        smtpUsername:
          type: string
        smtpPassword:
          type: string
        fromEmail:
          type: string
        fromName:
          type: string
        smtpSecure:
          type: boolean
        sessionTimeout:
          type: string
        maxLoginAttempts:
          type: string
        passwordMinLength:
          type: string
        jwtExpiry:
          type: string
        twoFactorAuth:
          type: boolean
        forcePasswordChange:
          type: boolean
        ipWhitelist:
          type: boolean
        auditLogging:
          type: boolean
        backupSchedule:
          type: string
        backupRetention:
          type: string
        backupLocation:
          type: string
        backupCompression:
          type: boolean
        backupEncryptionKey:
          type: string
        birFaturaApiKey:
          type: string
        birFaturaApiSecret:
          type: string
        smsProvider:
          type: string
        smsUsername:
          type: string
        smsPassword:
          type: string
        smsHeader:
          type: string
        paymentProvider:
          type: string
        paymentApiKey:
          type: string
        paymentSecretKey:
          type: string
    DashboardMetrics:
      type: object
      properties:
        overview:
          type: object
          properties:
            total_tenants:
              type: integer
            active_tenants:
              type: integer
            total_users:
              type: integer
            active_users:
              type: integer
            total_plans:
              type: integer
        revenue:
          type: object
          properties:
            monthly_recurring_revenue:
              type: number
        alerts:
          type: object
          properties:
            expiring_soon:
              type: integer
            high_churn:
              type: integer
            low_utilization:
              type: integer
        health_metrics:
          type: object
          properties:
            churn_rate_percent:
              type: number
            avg_seat_utilization_percent:
              type: number
        recent_activity:
          type: object
          properties:
            new_tenants_7d:
              type: integer
            expiring_memberships_30d:
              type: integer
    Invoice:
      type: object
      properties:
        id:
          type: string
        invoice_number:
          type: string
        tenant_id:
          type: string
        tenant_name:
          type: string
        status:
          type: string
          enum:
          - draft
          - open
          - paid
          - overdue
          - void
        total:
          type: number
        subtotal:
          type: number
        tax_total:
          type: number
        currency:
          type: string
        paid_amount:
          type: number
        issue_date:
          type: string
          format: date
        due_date:
          type: string
          format: date
        items:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              description:
                type: string
              quantity:
                type: integer
              unit_price:
                type: number
              total:
                type: number
    AnalyticsData:
      type: object
      properties:
        overview:
          type: object
          properties:
            total_revenue:
              type: number
            revenue_growth:
              type: number
            active_tenants:
              type: integer
            tenants_growth:
              type: number
            monthly_active_users:
              type: integer
            mau_growth:
              type: number
            churn_rate:
              type: number
            churn_growth:
              type: number
        revenue_trend:
          type: array
          items:
            type: object
            properties:
              month:
                type: string
              revenue:
                type: number
              growth:
                type: number
        user_engagement:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
              dau:
                type: integer
              wau:
                type: integer
              mau:
                type: integer
        plan_distribution:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              value:
                type: integer
              color:
                type: string
        top_tenants:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              revenue:
                type: number
              growth:
                type: number
              users:
                type: integer
